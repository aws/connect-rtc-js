(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
(function (global){(function (){
//===============================================
// By using these Developer Materials, you accept and agree to comply with
// the terms of the Cloud Software Group Developer Terms of Use found here
// (https://www.cloud.com/legal)
//===============================================



var $jscomp={scope:{},getGlobal:function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global?global:d}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.initSymbol=function(){$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol);$jscomp.initSymbol=function(){}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(d){return"jscomp_symbol_"+d+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};$jscomp.makeIterator=function(d){$jscomp.initSymbolIterator();if(d[$jscomp.global.Symbol.iterator])return d[$jscomp.global.Symbol.iterator]();var e=0;return{next:function(){return e==d.length?{done:!0}:{done:!1,value:d[e++]}}}};
$jscomp.arrayFromIterator=function(d){for(var e,k=[];!(e=d.next()).done;)k.push(e.value);return k};$jscomp.arrayFromIterable=function(d){return d instanceof Array?d:$jscomp.arrayFromIterator($jscomp.makeIterator(d))};
$jscomp.inherits=function(d,e){function k(){}k.prototype=e.prototype;d.prototype=new k;d.prototype.constructor=d;for(var b in e)if($jscomp.global.Object.defineProperties){var a=$jscomp.global.Object.getOwnPropertyDescriptor(e,b);a&&$jscomp.global.Object.defineProperty(d,b,a)}else d[b]=e[b]};$jscomp.array=$jscomp.array||{};$jscomp.array.done_=function(){return{done:!0,value:void 0}};
$jscomp.array.arrayIterator_=function(d,e){d instanceof String&&(d=String(d));var k=0;$jscomp.initSymbol();$jscomp.initSymbolIterator();var b={},a=(b.next=function(){if(k<d.length){var b=k++;return{value:e(b,d[b]),done:!1}}a.next=$jscomp.array.done_;return $jscomp.array.done_()},b[Symbol.iterator]=function(){return a},b);return a};
$jscomp.array.findInternal_=function(d,e,k){d instanceof String&&(d=String(d));for(var b=d.length,a=0;a<b;a++){var c=d[a];if(e.call(k,c,a,d))return{i:a,v:c}}return{i:-1,v:void 0}};
$jscomp.array.from=function(d,e,k){e=void 0===e?function(a){return a}:e;var b=[];$jscomp.initSymbol();$jscomp.initSymbolIterator();if(d[Symbol.iterator]){$jscomp.initSymbol();$jscomp.initSymbolIterator();d=d[Symbol.iterator]();for(var a;!(a=d.next()).done;)b.push(e.call(k,a.value))}else{a=d.length;for(var c=0;c<a;c++)b.push(e.call(k,d[c]))}return b};$jscomp.array.of=function(d){for(var e=[],k=0;k<arguments.length;++k)e[k-0]=arguments[k];return $jscomp.array.from(e)};
$jscomp.array.entries=function(){return $jscomp.array.arrayIterator_(this,function(d,e){return[d,e]})};$jscomp.array.entries$install=function(){Array.prototype.entries||(Array.prototype.entries=$jscomp.array.entries)};$jscomp.array.keys=function(){return $jscomp.array.arrayIterator_(this,function(d){return d})};$jscomp.array.keys$install=function(){Array.prototype.keys||(Array.prototype.keys=$jscomp.array.keys)};$jscomp.array.values=function(){return $jscomp.array.arrayIterator_(this,function(d,e){return e})};
$jscomp.array.values$install=function(){Array.prototype.values||(Array.prototype.values=$jscomp.array.values)};$jscomp.array.copyWithin=function(d,e,k){var b=this.length;d=Number(d);e=Number(e);k=Number(null!=k?k:b);if(d<e)for(k=Math.min(k,b);e<k;)e in this?this[d++]=this[e++]:(delete this[d++],e++);else for(k=Math.min(k,b+e-d),d+=k-e;k>e;)--k in this?this[--d]=this[k]:delete this[d];return this};$jscomp.array.copyWithin$install=function(){Array.prototype.copyWithin||(Array.prototype.copyWithin=$jscomp.array.copyWithin)};
$jscomp.array.fill=function(d,e,k){null!=k&&d.length||(k=this.length||0);k=Number(k);for(e=Number((void 0===e?0:e)||0);e<k;e++)this[e]=d;return this};$jscomp.array.fill$install=function(){Array.prototype.fill||(Array.prototype.fill=$jscomp.array.fill)};$jscomp.array.find=function(d,e){return $jscomp.array.findInternal_(this,d,e).v};$jscomp.array.find$install=function(){Array.prototype.find||(Array.prototype.find=$jscomp.array.find)};
$jscomp.array.findIndex=function(d,e){return $jscomp.array.findInternal_(this,d,e).i};$jscomp.array.findIndex$install=function(){Array.prototype.findIndex||(Array.prototype.findIndex=$jscomp.array.findIndex)};$jscomp.Map=function(d){d=void 0===d?[]:d;this.data_={};this.head_=$jscomp.Map.createHead_();this.size=0;if(d){d=$jscomp.makeIterator(d);for(var e=d.next();!e.done;e=d.next())e=e.value,this.set(e[0],e[1])}};
$jscomp.Map.checkBrowserConformance_=function(){var d=$jscomp.global.Map;if(!d||!d.prototype.entries||!Object.seal)return!1;try{var e=Object.seal({x:4}),k=new d($jscomp.makeIterator([[e,"s"]]));if("s"!=k.get(e)||1!=k.size||k.get({x:4})||k.set({x:4},"t")!=k||2!=k.size)return!1;var b=k.entries(),a=b.next();if(a.done||a.value[0]!=e||"s"!=a.value[1])return!1;a=b.next();return a.done||4!=a.value[0].x||"t"!=a.value[1]||!b.next().done?!1:!0}catch(c){return!1}};
$jscomp.Map.createHead_=function(){var d={};return d.previous=d.next=d.head=d};$jscomp.Map.getId_=function(d){if(!(d instanceof Object))return String(d);$jscomp.Map.key_ in d||d instanceof Object&&Object.isExtensible&&Object.isExtensible(d)&&$jscomp.Map.defineProperty_(d,$jscomp.Map.key_,++$jscomp.Map.index_);return $jscomp.Map.key_ in d?d[$jscomp.Map.key_]:" "+d};
$jscomp.Map.prototype.set=function(d,e){var k=this.maybeGetEntry_(d),b=k.id,a=k.list,k=k.entry;a||(a=this.data_[b]=[]);k?k.value=e:(k={next:this.head_,previous:this.head_.previous,head:this.head_,key:d,value:e},a.push(k),this.head_.previous.next=k,this.head_.previous=k,this.size++);return this};
$jscomp.Map.prototype["delete"]=function(d){var e=this.maybeGetEntry_(d);d=e.id;var k=e.list,b=e.index;return(e=e.entry)&&k?(k.splice(b,1),k.length||delete this.data_[d],e.previous.next=e.next,e.next.previous=e.previous,e.head=null,this.size--,!0):!1};$jscomp.Map.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=$jscomp.Map.createHead_();this.size=0};$jscomp.Map.prototype.has=function(d){return!!this.maybeGetEntry_(d).entry};
$jscomp.Map.prototype.get=function(d){return(d=this.maybeGetEntry_(d).entry)&&d.value};$jscomp.Map.prototype.maybeGetEntry_=function(d){var e=$jscomp.Map.getId_(d),k=this.data_[e];if(k)for(var b=0;b<k.length;b++){var a=k[b];if(d!==d&&a.key!==a.key||d===a.key)return{id:e,list:k,index:b,entry:a}}return{id:e,list:k,index:-1,entry:void 0}};$jscomp.Map.prototype.entries=function(){return this.iter_(function(d){return[d.key,d.value]})};$jscomp.Map.prototype.keys=function(){return this.iter_(function(d){return d.key})};
$jscomp.Map.prototype.values=function(){return this.iter_(function(d){return d.value})};$jscomp.Map.prototype.forEach=function(d,e){for(var k=$jscomp.makeIterator(this.entries()),b=k.next();!b.done;b=k.next())b=b.value,d.call(e,b[1],b[0],this)};
$jscomp.Map.prototype.iter_=function(d){var e=this,k=this.head_;$jscomp.initSymbol();$jscomp.initSymbolIterator();var b={};return b.next=function(){if(k){for(;k.head!=e.head_;)k=k.previous;for(;k.next!=k.head;)return k=k.next,{done:!1,value:d(k)};k=null}return{done:!0,value:void 0}},b[Symbol.iterator]=function(){return this},b};$jscomp.Map.index_=0;$jscomp.Map.defineProperty_=Object.defineProperty?function(d,e,k){Object.defineProperty(d,e,{value:String(k)})}:function(d,e,k){d[e]=String(k)};
$jscomp.Map.Entry_=function(){};$jscomp.Map.ASSUME_NO_NATIVE=!1;$jscomp.Map$install=function(){$jscomp.initSymbol();$jscomp.initSymbolIterator();!$jscomp.Map.ASSUME_NO_NATIVE&&$jscomp.Map.checkBrowserConformance_()?$jscomp.Map=$jscomp.global.Map:($jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Map.prototype[Symbol.iterator]=$jscomp.Map.prototype.entries,$jscomp.initSymbol(),$jscomp.Map.key_=Symbol("map-id-key"));$jscomp.Map$install=function(){}};$jscomp.math=$jscomp.math||{};
$jscomp.math.clz32=function(d){d=Number(d)>>>0;if(0===d)return 32;var e=0;0===(d&4294901760)&&(d<<=16,e+=16);0===(d&4278190080)&&(d<<=8,e+=8);0===(d&4026531840)&&(d<<=4,e+=4);0===(d&3221225472)&&(d<<=2,e+=2);0===(d&2147483648)&&e++;return e};$jscomp.math.imul=function(d,e){d=Number(d);e=Number(e);var k=d&65535,b=e&65535;return k*b+((d>>>16&65535)*b+k*(e>>>16&65535)<<16>>>0)|0};$jscomp.math.sign=function(d){d=Number(d);return 0===d||isNaN(d)?d:0<d?1:-1};
$jscomp.math.log10=function(d){return Math.log(d)/Math.LN10};$jscomp.math.log2=function(d){return Math.log(d)/Math.LN2};$jscomp.math.log1p=function(d){d=Number(d);if(.25>d&&-.25<d){for(var e=d,k=1,b=d,a=0,c=1;a!=b;)e*=d,c*=-1,b=(a=b)+c*e/++k;return b}return Math.log(1+d)};$jscomp.math.expm1=function(d){d=Number(d);if(.25>d&&-.25<d){for(var e=d,k=1,b=d,a=0;a!=b;)e*=d/++k,b=(a=b)+e;return b}return Math.exp(d)-1};$jscomp.math.cosh=function(d){d=Number(d);return(Math.exp(d)+Math.exp(-d))/2};
$jscomp.math.sinh=function(d){d=Number(d);return 0===d?d:(Math.exp(d)-Math.exp(-d))/2};$jscomp.math.tanh=function(d){d=Number(d);if(0===d)return d;var e=Math.exp(2*-Math.abs(d)),e=(1-e)/(1+e);return 0>d?-e:e};$jscomp.math.acosh=function(d){d=Number(d);return Math.log(d+Math.sqrt(d*d-1))};$jscomp.math.asinh=function(d){d=Number(d);if(0===d)return d;var e=Math.log(Math.abs(d)+Math.sqrt(d*d+1));return 0>d?-e:e};
$jscomp.math.atanh=function(d){d=Number(d);return($jscomp.math.log1p(d)-$jscomp.math.log1p(-d))/2};
$jscomp.math.hypot=function(d,e,k){for(var b=[],a=2;a<arguments.length;++a)b[a-2]=arguments[a];d=Number(d);e=Number(e);for(var c=Math.max(Math.abs(d),Math.abs(e)),I=$jscomp.makeIterator(b),a=I.next();!a.done;a=I.next())c=Math.max(c,Math.abs(a.value));if(1E100<c||1E-100>c){d/=c;e/=c;I=d*d+e*e;b=$jscomp.makeIterator(b);for(a=b.next();!a.done;a=b.next())a=a.value,a=Number(a)/c,I+=a*a;return Math.sqrt(I)*c}c=d*d+e*e;b=$jscomp.makeIterator(b);for(a=b.next();!a.done;a=b.next())a=a.value,a=Number(a),c+=
a*a;return Math.sqrt(c)};$jscomp.math.trunc=function(d){d=Number(d);if(isNaN(d)||Infinity===d||-Infinity===d||0===d)return d;var e=Math.floor(Math.abs(d));return 0>d?-e:e};$jscomp.math.cbrt=function(d){if(0===d)return d;d=Number(d);var e=Math.pow(Math.abs(d),1/3);return 0>d?-e:e};$jscomp.number=$jscomp.number||{};$jscomp.number.isFinite=function(d){return"number"!==typeof d?!1:!isNaN(d)&&Infinity!==d&&-Infinity!==d};
$jscomp.number.isInteger=function(d){return $jscomp.number.isFinite(d)?d===Math.floor(d):!1};$jscomp.number.isNaN=function(d){return"number"===typeof d&&isNaN(d)};$jscomp.number.isSafeInteger=function(d){return $jscomp.number.isInteger(d)&&Math.abs(d)<=$jscomp.number.MAX_SAFE_INTEGER};$jscomp.number.EPSILON=Math.pow(2,-52);$jscomp.number.MAX_SAFE_INTEGER=9007199254740991;$jscomp.number.MIN_SAFE_INTEGER=-9007199254740991;$jscomp.object=$jscomp.object||{};
$jscomp.object.assign=function(d,e){for(var k=[],b=1;b<arguments.length;++b)k[b-1]=arguments[b];k=$jscomp.makeIterator(k);for(b=k.next();!b.done;b=k.next())if(b=b.value)for(var a in b)Object.prototype.hasOwnProperty.call(b,a)&&(d[a]=b[a]);return d};$jscomp.object.is=function(d,e){return d===e?0!==d||1/d===1/e:d!==d&&e!==e};$jscomp.Set=function(d){d=void 0===d?[]:d;this.map_=new $jscomp.Map;if(d){d=$jscomp.makeIterator(d);for(var e=d.next();!e.done;e=d.next())this.add(e.value)}this.size=this.map_.size};
$jscomp.Set.checkBrowserConformance_=function(){var d=$jscomp.global.Set;if(!d||!d.prototype.entries||!Object.seal)return!1;var e=Object.seal({x:4}),d=new d($jscomp.makeIterator([e]));if(d.has(e)||1!=d.size||d.add(e)!=d||1!=d.size||d.add({x:4})!=d||2!=d.size)return!1;var d=d.entries(),k=d.next();if(k.done||k.value[0]!=e||k.value[1]!=e)return!1;k=d.next();return k.done||k.value[0]==e||4!=k.value[0].x||k.value[1]!=k.value[0]?!1:d.next().done};
$jscomp.Set.prototype.add=function(d){this.map_.set(d,d);this.size=this.map_.size;return this};$jscomp.Set.prototype["delete"]=function(d){d=this.map_["delete"](d);this.size=this.map_.size;return d};$jscomp.Set.prototype.clear=function(){this.map_.clear();this.size=0};$jscomp.Set.prototype.has=function(d){return this.map_.has(d)};$jscomp.Set.prototype.entries=function(){return this.map_.entries()};$jscomp.Set.prototype.values=function(){return this.map_.values()};
$jscomp.Set.prototype.forEach=function(d,e){var k=this;this.map_.forEach(function(b){return d.call(e,b,b,k)})};$jscomp.Set.ASSUME_NO_NATIVE=!1;$jscomp.Set$install=function(){!$jscomp.Set.ASSUME_NO_NATIVE&&$jscomp.Set.checkBrowserConformance_()?$jscomp.Set=$jscomp.global.Set:($jscomp.Map$install(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Set.prototype[Symbol.iterator]=$jscomp.Set.prototype.values);$jscomp.Set$install=function(){}};$jscomp.string=$jscomp.string||{};
$jscomp.string.noRegExp_=function(d,e){if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+e+" must not be a regular expression");};
$jscomp.string.fromCodePoint=function(d){for(var e=[],k=0;k<arguments.length;++k)e[k-0]=arguments[k];for(var k="",e=$jscomp.makeIterator(e),b=e.next();!b.done;b=e.next()){b=b.value;b=+b;if(0>b||1114111<b||b!==Math.floor(b))throw new RangeError("invalid_code_point "+b);65535>=b?k+=String.fromCharCode(b):(b-=65536,k+=String.fromCharCode(b>>>10&1023|55296),k+=String.fromCharCode(b&1023|56320))}return k};
$jscomp.string.repeat=function(d){var e=this.toString();if(0>d||1342177279<d)throw new RangeError("Invalid count value");d|=0;for(var k="";d;)if(d&1&&(k+=e),d>>>=1)e+=e;return k};$jscomp.string.repeat$install=function(){String.prototype.repeat||(String.prototype.repeat=$jscomp.string.repeat)};
$jscomp.string.codePointAt=function(d){var e=this.toString(),k=e.length;d=Number(d)||0;if(0<=d&&d<k){d|=0;var b=e.charCodeAt(d);if(55296>b||56319<b||d+1===k)return b;d=e.charCodeAt(d+1);return 56320>d||57343<d?b:1024*(b-55296)+d+9216}};$jscomp.string.codePointAt$install=function(){String.prototype.codePointAt||(String.prototype.codePointAt=$jscomp.string.codePointAt)};
$jscomp.string.includes=function(d,e){e=void 0===e?0:e;$jscomp.string.noRegExp_(d,"includes");return-1!==this.toString().indexOf(d,e)};$jscomp.string.includes$install=function(){String.prototype.includes||(String.prototype.includes=$jscomp.string.includes)};
$jscomp.string.startsWith=function(d,e){e=void 0===e?0:e;$jscomp.string.noRegExp_(d,"startsWith");var k=this.toString();d+="";for(var b=k.length,a=d.length,c=Math.max(0,Math.min(e|0,k.length)),I=0;I<a&&c<b;)if(k[c++]!=d[I++])return!1;return I>=a};$jscomp.string.startsWith$install=function(){String.prototype.startsWith||(String.prototype.startsWith=$jscomp.string.startsWith)};
$jscomp.string.endsWith=function(d,e){$jscomp.string.noRegExp_(d,"endsWith");var k=this.toString();d+="";void 0===e&&(e=k.length);for(var b=Math.max(0,Math.min(e|0,k.length)),a=d.length;0<a&&0<b;)if(k[--b]!=d[--a])return!1;return 0>=a};$jscomp.string.endsWith$install=function(){String.prototype.endsWith||(String.prototype.endsWith=$jscomp.string.endsWith)};
(function(d,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports.CitrixWebRTC=e():d.CitrixWebRTC=e()})(self,function(){return function(){function d(b){var a=k[b];if(void 0!==a)return a.exports;a=k[b]={exports:{}};e[b].call(a.exports,a,a.exports,d);return a.exports}var e={945:function(b,a,c){var d=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(a,"__esModule",{value:!0});var n=c(658),E=c(550),m=c(851),p=c(946);b=function(a){function b(){var c=a.call(this,null,E.class_id_t.AudioElement,0,n.ProxyMode.Local)||this;c.sinkId_="";c.srcObject_=null;return c}d(b,a);b.prototype.setSinkId=
function(a){var b=this;m.logger.log(this.user_friendly_id()+".setSinkId: set sinkId to "+a);return new Promise(function(c,d){b.waitUntilConnected("AudioElement.sinkId").then(function(){var d=b.remoteInvoke(!0,E.method_id_AudioElement_t.sinkId,a);p.getRedirector().getFeatureValue(E.FEATURE_ms_teams_pstn)||(b.sinkId_=a,c());return d}).then(function(){m.logger.log(b.user_friendly_id()+".setSinkId: success! resolving...");b.sinkId_=a;c()})["catch"](function(a){a=b.logRemoteInvokeError(a,".sinkId setter: failed to connect!");
d(a)})})};Object.defineProperty(b.prototype,"sinkId",{get:function(){return this.sinkId_},set:function(a){this.setSinkId(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"srcObject",{get:function(){return this.srcObject_},set:function(a){var b=this;m.logger.log(this.user_friendly_id()+".srcObject: set srcObject to "+JSON.stringify(a));if(a!==this.srcObject_){this.srcObject_=a;var c=null!==a&&void 0!==a?a.id:"null";this.waitUntilConnected("AudioElement.srcObject").then(function(){return b.remoteInvoke(!0,
E.method_id_AudioElement_t.srcObject,c)}).then(function(){m.logger.log(b.user_friendly_id()+".srcObject setter: remote success!")})["catch"](function(a){b.logRemoteInvokeError(a,".srcObject setter: failed to connect!")})}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"src",{get:function(){return this.src_},set:function(a){var b=this;m.logger.log(this.user_friendly_id()+".src: set src to "+a);this.src_=a;this.waitUntilConnected("AudioElement.src").then(function(){b.remoteInvoke(!0,
E.method_id_AudioElement_t.src,a)})["catch"](function(a){b.logRemoteInvokeError(a,".src setter: failed to connect!")})},enumerable:!0,configurable:!0});b.prototype.play=function(){var a=this;m.logger.log(this.user_friendly_id()+".play() called.");return new Promise(function(b,c){a.toggleAudio(!0);a.waitUntilConnected("AudioElement.play").then(function(){a.remoteInvoke(!1,E.method_id_AudioElement_t.play,[]).then(function(){b()})["catch"](function(b){a.logRemoteInvokeError(b,".play: failed to remote!");
c()})})["catch"](function(b){a.logRemoteInvokeError(b,".play: failed to connect!");c()})})};b.prototype.pause=function(){var a=this;m.logger.log(this.user_friendly_id()+".pause() called.");return new Promise(function(b,c){a.toggleAudio(!1);a.waitUntilConnected("AudioElement.pause").then(function(){a.remoteInvoke(!1,E.method_id_AudioElement_t.pause,[]).then(function(){b()})["catch"](function(b){a.logRemoteInvokeError(b,".pause: failed to remote!");c()})})["catch"](function(b){a.logRemoteInvokeError(b,
".pause: failed to connect!");c()})})};b.prototype.toggleAudio=function(a){this.srcObject_&&(m.logger.log(this.user_friendly_id()+".toggleAudio() toggle audio tracks:"+a),this.srcObject_.toggleAudio(a))};b.prototype.dispose=function(){m.logger.log(this.user_friendly_id()+".dispose()");this.src_=this.sinkId_="";this.srcObject_=null;this.release()};return b}(n.ProxyObject);a.AudioElement=b},9:function(b,a,c){var d=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(a,"__esModule",{value:!0});var n=c(550),E=c(946),m=c(658),p=c(851);(function(a){a[a.Webrpc=0]="Webrpc";a[a.WebrtcCodecs=1]="WebrtcCodecs";a[a.Receiver=2]="Receiver";a[a.Vda=3]="Vda";a[a.Endpoint=4]="Endpoint";a[a.TypeScript=5]="TypeScript";
a[a.Max=6]="Max"})(a.VersionType||(a.VersionType={}));b=function(a){function b(){return a.call(this,null,n.class_id_t.EngineControl,0,m.ProxyMode.Local)||this}d(b,a);b.prototype.bind=function(){p.logger.log(this.user_friendly_id()+".bind() called.");this.reconstructor(null,n.class_id_t.EngineControl,0)};b.prototype.syncBarrier=function(){var a=this;p.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.waitUntilConnected("EngineControl.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,
n.method_id_EngineControl_t.version,{major:0,minor:0,revision:0,build:0}),a.remoteInvoke(!1,n.method_id_EngineControl_t.feature_flags,[])])}).then(function(b){p.logger.log(a.user_friendly_id()+"received webrpc version and supported feature list.");b=b.map(function(b){return a.param0(b)});a.version_=b[0];a.features_=b[1];E.getRedirector().setFeatures(a.features_);b=[];for(var c=0,f=a.features_;c<f.length;c++){var d=f[c];"ms_teams_desktop_sharing"===d.name&&d.value?b.push(a.remoteInvoke(!1,n.method_id_EngineControl_t.version_info,
[])):"ms_teams_osinfo"===d.name&&d.value?b.push(a.remoteInvoke(!1,n.method_id_EngineControl_t.osinfo,{family:"",version:"",architecture:"",distro:"",edition:""})):"ms_teams_endpoint_id"===d.name&&d.value&&b.push(a.remoteInvoke(!1,n.method_id_EngineControl_t.endpoint_id,{machine_id:"",user_id:""}))}if(0<b.length)return Promise.all(b)}).then(function(c){if(void 0===c)p.logger.log(a.user_friendly_id()+"release-1905 client.");else{p.logger.log(a.user_friendly_id()+"release-1906 or later client: received detailed client version list.");
for(var d=0;d<c.length;d++){var f=c[d];f.hdr.proc.iid==n.class_id_t.EngineControl&&f.hdr.proc.methodid==n.method_id_EngineControl_t.version_info?a.versions_=a.param0(f):f.hdr.proc.iid==n.class_id_t.EngineControl&&f.hdr.proc.methodid==n.method_id_EngineControl_t.osinfo?a.osinfo_=a.param0(f):f.hdr.proc.iid==n.class_id_t.EngineControl&&f.hdr.proc.methodid==n.method_id_EngineControl_t.endpoint_id&&(a.endpointid_=a.param0(f))}}b(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,"failure to retrieve version/feature related client info.");
c(b)})})};return b}(m.ProxyObject);a.EngineControl=b},368:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});var d=c(851),n=c(946);b=function(){function a(){var b=this;this.running_=!1;this.elements_=[];this.clipRects=new Set;this.wheelEventHandler=function(a){setTimeout(function(){b.updateAll()},10)};this.keyupEventHandler=function(a){"Tab"!=a.code&&"ArrowUp"!=a.code&&"ArrowDown"!=a.code&&"ArrowLeft"!=a.code&&"ArrowRight"!=a.code&&"PageUp"!=a.code&&"PageDown"!=a.code&&"Home"!=a.code&&
"End"!=a.code||b.updateAll()};a.sendOverlayInfo();this.observer_=new MutationObserver(function(a){b.updateAll()})}a.sendOverlayInfo=function(){var a=window.getWindowHandleAsHex;if(void 0===a||null===a)d.logger.log("FrameTracker.sendOverlayInfo: getWindowHandle method is undefined or null");else{var b=n.getRedirector();Promise.all([a(),b.startRedirection(!1,"sendOverlayInfo")]).then(function(a){d.logger.log("FrameTracker.sendOverlayInfo: set window handle: "+a[0]);b.WSSendObject({v:"overlay",command:"window",
windowHandle:a[0]})})}};a.prototype.rectanglesIntersect=function(a,b){return a.x<b.x+b.width&&a.x+a.width>b.x&&a.y<b.y+b.height&&a.y+a.height>b.y?!0:!1};a.prototype.intersectingRect=function(a,b){var c=Math.max(a.left,b.left),d=Math.max(a.top,b.top);return new DOMRect(c,d,Math.min(a.right,b.right)-c,Math.min(a.bottom,b.bottom)-d)};a.prototype.pedigreeCount=function(a,b){for(var c=0,d=a.parentElement;null!=d&&d!=b;)c++,d=d.parentElement;return{isAncestor:null!=d,pedigree:c}};a.prototype.selectTopmost=
function(a,b){var c=a.getBoundingClientRect(),d=b.getBoundingClientRect(),c=this.intersectingRect(c,d),d=document.elementFromPoint(c.left+c.width/2,c.top+c.height/2);if(d==a)return a;if(d==b)return b;c=this.pedigreeCount(a,d);d=this.pedigreeCount(b,d);if(c.isAncestor&&d.isAncestor){if(c.pedigree<d.pedigree)return a;if(d.pedigree<c.pedigree)return b}else{if(c.isAncestor)return a;if(d.isAncestor)return b}};a.prototype.checkOverlappingVideos=function(a){var b=this,c=a.target.getBoundingClientRect();
a.overlaps.forEach(function(b){a.target.remoteVideoElement.removeClipRect(b.rect)});a.overlaps=[];this.elements_.forEach(function(d){if(d!=a){var n=d.overlaps.map(function(a){return a.element}).indexOf(a.target);-1!=n&&(n=d.overlaps.splice(n,1)[0],d.target.remoteVideoElement.removeClipRect(n.rect));n=d.target.getBoundingClientRect();if(b.rectanglesIntersect(c,n)){var v=b.selectTopmost(a.target,d.target);v==a.target?(d.overlaps.push({element:a.target,rect:c}),d.target.remoteVideoElement.addClipRect(c)):
v==d.target&&(a.overlaps.push({element:d.target,rect:n}),a.target.remoteVideoElement.addClipRect(n))}}})};a.prototype.updateAll=function(){var a=this;this.elements_.forEach(function(b){var c=b.target.getBoundingClientRect();if(void 0!==c){var d=b.clientRect;if(void 0===d||d.x!==c.x||d.y!==c.y||d.width!==c.width||d.height!==c.height)b.clientRect=c,b.callback(c),a.checkOverlappingVideos(b)}})};a.prototype.track=function(a,b){var c=this,g=a.getBoundingClientRect();d.logger.log("Track element frame",
a,JSON.stringify(g));console.log(a);this.elements_.push({target:a,clientRect:void 0,callback:b,overlaps:[]});try{d.logger.log("[HdxWebRTC.js] Initializing occlusion for new videoElement"),this.clipRects.forEach(function(b){c.applyOcclusion(a,JSON.parse(b))})}catch(n){d.logger.log("[HdxWebRTC.js] addOcclusionInit failed! "+n)}this.running_||(d.logger.log("Start FrameTracker observer..."),this.observer_.observe(document.body,{attributes:!0,childList:!0,subtree:!0}),window.addEventListener("wheel",this.wheelEventHandler),
window.addEventListener("keyup",this.keyupEventHandler),this.running_=!0);this.updateAll()};a.prototype.untrack=function(a){d.logger.log("Untrack element frame",a);var b=-1;this.elements_.forEach(function(c,d){c.target===a&&(b=d)});0<=b&&(this.elements_.splice(b,1),0===this.elements_.length&&(d.logger.log("Stop FrameTracker observer..."),this.observer_.disconnect(),window.removeEventListener("wheel",this.wheelEventHandler),window.removeEventListener("keyup",this.keyupEventHandler),this.running_=!1))};
a.prototype.applyOcclusion=function(a,b){var c=a.getBoundingClientRect();this.rectanglesIntersect(b,c)&&void 0!==a.remoteVideoElement&&a.remoteVideoElement.addClipRect(b)};a.prototype.addOcclusion=function(a){var b=this;d.logger.log("[HdxWebRTC.js] Adding occlusion "+JSON.stringify(a));d.logger.log("[HdxWebRTC.js] Tracking '"+this.elements_.length+"' elements.");this.clipRects.add(JSON.stringify(a));this.elements_.forEach(function(c){b.applyOcclusion(c.target,a)})};a.prototype.removeOcclusion=function(a){d.logger.log("[HdxWebRTC.js] Removing occlusion "+
JSON.stringify(a));d.logger.log("[HdxWebRTC.js] Tracking '"+this.elements_.length+"' elements.");this.clipRects["delete"](JSON.stringify(a));this.elements_.forEach(function(b){void 0!==b.target.remoteVideoElement&&b.target.remoteVideoElement.removeClipRect(a)})};return a}();a.FrameTracker=b},247:function(b,a){Object.defineProperty(a,"__esModule",{value:!0});var c=function(){function a(b){this.parent_=this.object_=null;this.children_=[];this.object_=b}a.prototype.addChild=function(a){a.parent_!=this&&
(a.parent_=this,this.children_.push(a))};a.prototype.removeChild=function(a){var b=this.children_.indexOf(a);this.children_.splice(b,1);a.parent_=null};return a}(),d=function(){function a(){this.root_=new c(null)}a.prototype.trackObject=function(a,b){void 0===b&&(b=null);if(null===this.findNode(a,this.root_)){var d=this.findNode(b,this.root_),n=new c(a);d?d.addChild(n):this.root_.addChild(n)}};a.prototype.releaseObject=function(a){a=this.findNode(a,this.root_);if(null===a||a===this.root_)return!1;
this.destroyNodeObjectRecurse(a);a.parent_.removeChild(a);return!0};a.prototype.destroyNodeObjectRecurse=function(a){for(var b=0,c=a.children_;b<c.length;b++)this.destroyNodeObjectRecurse(c[b]);a.object_.destroy()};a.prototype.setParent=function(a,b){var c=this.findNode(a,this.root_);if(null===c)return!1;var d=this.findNode(b,this.root_);if(null===d)return!1;if(c.parent_===d)return!0;c.parent_.removeChild(c);d.addChild(c);return!0};a.prototype.reset=function(){this.root_.children_=[]};a.prototype.findNode=
function(a,b){if(b.object_===a)return b;for(var c=null,d=0,g=b.children_;d<g.length&&(c=this.findNode(a,g[d]),null===c);d++);return c};return a}();a.GC=d;a.gc=new d},946:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});var d=c(658),n=c(851),E=c(550),m=c(545),p=c(394),l=c(509),g=function(){return function(a,b,c,d,g,n,t){this.resolve=a;this.reject=b;this.iid=c;this.oid=d;this.cbid=g;this.oneShot=n;this.mid=t}}(),e;(function(a){a[a.rpc_status_success=0]="rpc_status_success";a[a.rpc_status_unspecified_error=
1]="rpc_status_unspecified_error";a[a.rpc_status_unexpected=2]="rpc_status_unexpected";a[a.rpc_status_index_out_of_bounds=3]="rpc_status_index_out_of_bounds";a[a.rpc_status_missing_parameter=4]="rpc_status_missing_parameter";a[a.rpc_status_missing_return_value=5]="rpc_status_missing_return_value";a[a.rpc_status_invalid_object=6]="rpc_status_invalid_object";a[a.rpc_status_user_exception=7]="rpc_status_user_exception";a[a.rpc_status_system_error=8]="rpc_status_system_error"})(e=a.WebrpcStatusCode||
(a.WebrpcStatusCode={}));var v;(function(a){a[a.NotRedirected=0]="NotRedirected";a[a.Connecting=1]="Connecting";a[a.Binding=2]="Binding";a[a.Redirected=3]="Redirected"})(v=a.RedirectionStatus||(a.RedirectionStatus={}));b=function(){function a(){this.pingactive=!1;this.status=v.NotRedirected;this.reqs=[];this.cbs=[];this.deferredActions=[];this.telemetry_=new p.Telemetry;this.screenshare_=new l.ScreenShareUtil;this.stateChangeNotifcations=[];this.vdafeatures_=[]}Object.defineProperty(a.prototype,"telemetry",
{get:function(){return this.telemetry_},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"screenshare",{get:function(){return this.screenshare_},enumerable:!0,configurable:!0});a.prototype.stopAppshare=function(){var a=window.stopAppshare;a&&a()};a.prototype.setRemoteSessionInfoCb=function(a){this.remoteSessionInfoCb=a};a.prototype.setFeatures=function(a){this.features=a;this.screenshare.onInitComplete()};a.prototype.getFeatureValue=function(a){var b=this.features.find(function(b){return b.name===
a});return void 0!==b?b.value:!1};a.prototype.onRedirectionComplete=function(){for(;this.deferredActions&&0<this.deferredActions.length;)this.deferredActions.shift().post(this.status==v.Redirected)};a.prototype.connectToService=function(){n.logger.log("Redirection status: Connecting...");this.status=v.Connecting;return new Promise(function(a,b){var c=new WebSocket("wss://127.0.0.1:9002");c.onopen=function(){a(c)};c.onerror=function(a){n.logger.log("websocket connection error: "+a.type);b(a)}})};a.prototype.waitUntilRedirected=
function(a){var b=this;return new Promise(function(c,d){b.status==v.Redirected?c():0>=a?d():setTimeout(function(){n.logger.log("waitUntilRedirected() timeout. count="+a);b.status!=v.Redirected?b.waitUntilRedirected(--a).then(function(){c()})["catch"](function(){d()}):c()},2E3)})};a.prototype.handleRemoteSessionInfo=function(){var a=this;n.logger.log("handleRemoteSessionInfo called.");var b=this;b.remoteSessionInfoCb?b.remoteSessionInfoCb().then(function(c){n.logger.log("remoteSessionInfo success! info:"+
JSON.stringify(c));n.logger.log("Redirection status: Redirected");b.status=v.Redirected;b.pingConnectionEnd();(0,window.onVdiClientConnected)();a.telemetry.SendTelemetryInit();b.onRedirectionComplete()})["catch"](function(){n.logger.log("remoteSessionInfo failure!");b.suspendRedirection(!0);b.onRedirectionComplete()}):(n.logger.log("remoteSessionInfoCb is invalid!"),b.suspendRedirection(!0),b.onRedirectionComplete())};a.prototype.startRedirection=function(a,b){var c=this,g=window.onVdiClientDisconnected;
return new Promise(function(t,z){c.status!=v.Redirected?(n.logger.log("Attempting to start redirection: "+b),!1===a?c.deferredActions.push(new d.deferred_action(t,z,b)):c.connectToService().then(function(a){n.logger.log("Redirection status: Binding...");c.status=v.Binding;c.websocket=a;c.websocket.onmessage=function(a){c.onWSMessage(a)};c.websocket.onclose=function(a){c.onWSClose(a)};t();c.handleRemoteSessionInfo()})["catch"](function(a){n.logger.log("Unable to connect to websocket service!");z();
c.suspendRedirection(!0);c.onRedirectionComplete();g(!0)})):(n.logger.log("Redirection already started."),t())})};a.prototype.suspendRedirection=function(a){var b=this;n.logger.log("Suspending redirection.");(0,window.onVdiClientDisconnected)(!1);var c=!1;a=window.getCitrixMSTeamsRedir;var d=window.getCitrixWebrtcRedir,g;a?g=a:d&&(g=d);g&&g().then(function(a){n.logger.log("sucesss on disconnect"+a);"1"==a&&(c=!0,n.logger.log("Reg key exists while disconnecting"));b.status===v.Redirected&&1==c&&(n.logger.log("Calling ping not normal disconnect"),
b.pingConnectionBegin(!1));n.logger.log("Redirection status: NotRedirected");b.status=v.NotRedirected})["catch"](function(){n.logger.log("Failure to Read MS Teams redir Reg Key, not retrying...")});this.dispatchStateChangeNotifications()};a.prototype.onWSOpen=function(){};a.prototype.onWSClose=function(a){n.logger.log("disconnected from websocket service.");try{this.suspendRedirection(!0)}catch(b){n.logger.log("suspendRedirection(): exception closing WebSocket: "+b.message)}};a.prototype.onWSError=
function(){try{this.suspendRedirection(!0)}catch(a){n.logger.log("suspendRedirection(): exception on WebSocket error: "+a.message)}};a.prototype.WSSendObjectWrapper=function(a,b,c,d){var g=!0;b!=E.class_id_t.EngineControl||c!=E.method_id_EngineControl_t.ctor&&c!=E.method_id_EngineControl_t.version&&c!=E.method_id_EngineControl_t.feature_flags||(g=!1);var t=!0;if(g&&(t=!1,void 0!=this.features))for(var g=0,r=this.features;g<r.length;g++){var q=r[g];if(!0===q.value&&q.name==a){t=!0;break}}return 1==
t?this.WSSendObject(d):Promise.reject("Cannot invoke method that is not supported by webrpc: iid("+b+") mid("+c+")")};a.prototype.WSSendObject=function(a){var b=this;return new Promise(function(c,d){if("webrtc"==a.v){var t=a.hdr.proc.iid,z=a.hdr.proc.methodid,r=a.objref.oid;a.hdr.destroy||(t=new g(c,d,t,r,0,!0,z),b.reqs.push(t));t=JSON.stringify(a);n.logger.trace("WSSendObject: >>> "+E.WebrpcClassLibInfoUtil.composeClassInfoData(a)+" "+t);try{b.websocket.send(t)}catch(q){n.logger.log("WSSendObject(): exception: "+
q.message),d(q.message)}}else if("overlay"==a.v){t=JSON.stringify(a);n.logger.log("HDXMS: SendOverlayData: >>> "+t+"'");try{b.websocket.send(t)}catch(q){n.logger.log("WSSendObject(): exception: "+q.message),d(q.message)}}else if("telemetry"==a.v){t=JSON.stringify(a);n.logger.log("HDXMS: SendTelemetryData: >>> "+t+"'");try{b.websocket.send(t)}catch(q){n.logger.log("WSSendObject(): exception: "+q.message),d(q.message)}}else if("appsharing"==a.v){t=JSON.stringify(a);n.logger.log("HDXMS: SendScreenSharingData: >>> "+
t+"'");try{b.websocket.send(t)}catch(q){n.logger.log("WSSendObject(): exception: "+q.message),d(q.message)}}else n.logger.log("HDXMS: Unknown protocol: '"+JSON.stringify(a)+"'")})};a.prototype.webrpcStatusCodeToName=function(a){switch(a){case e.rpc_status_success:a="rpc_status_success";break;case e.rpc_status_unspecified_error:a="rpc_status_unspecified_error";break;case e.rpc_status_unexpected:a="rpc_status_unexpected";break;case e.rpc_status_index_out_of_bounds:a="rpc_status_index_out_of_bounds";
break;case e.rpc_status_missing_parameter:a="rpc_status_missing_parameter";break;case e.rpc_status_missing_return_value:a="rpc_status_missing_return_value";break;case e.rpc_status_invalid_object:a="rpc_status_invalid_object";break;case e.rpc_status_user_exception:a="rpc_status_user_exception";break;case e.rpc_status_system_error:a="rpc_status_system_error";break;default:a="unknown"}return a};a.prototype.parceWebrpcError=function(a,b){void 0===a&&(a=b&&0<b.length?b[0].category||b[0].code||b[0].message?
e.rpc_status_system_error:e.rpc_status_user_exception:e.rpc_status_unspecified_error);var c;switch(a){case e.rpc_status_unspecified_error:case e.rpc_status_unexpected:case e.rpc_status_index_out_of_bounds:case e.rpc_status_missing_parameter:case e.rpc_status_missing_return_value:case e.rpc_status_invalid_object:c=new DOMException(this.webrpcStatusCodeToName(a),this.webrpcStatusCodeToName(a));break;case e.rpc_status_user_exception:c=b&&0<b.length?new DOMException(b[0],this.webrpcStatusCodeToName(a)):
new DOMException(this.webrpcStatusCodeToName(a),this.webrpcStatusCodeToName(a));break;case e.rpc_status_system_error:if(b&&0<b.length){c=Object.create(DOMException);var d={value:null,writable:!0,enumerable:!1,Configurable:!0};d.value=b[0].category;Object.defineProperty(c,"name",d);d.value=b[0].code;Object.defineProperty(c,"code",d);d.value=b[0].message;Object.defineProperty(c,"message",d)}else c=new DOMException(this.webrpcStatusCodeToName(a),this.webrpcStatusCodeToName(a))}return c};a.prototype.onWSMessage=
function(a){var b=a.data,c;try{c=JSON.parse(b)}catch(q){console.log("invalid JSON!!!");console.log(q);console.log(b);return}if("webrtc"==c.v){n.logger.trace("onWSMessage: <<< "+E.WebrpcClassLibInfoUtil.composeClassInfoData(c)+" "+b);var d=c.hdr.proc.iid,g=c.hdr.proc.methodid,t=c.objref.oid;a=c.status;if(c.hdr.msg_type==m.WsJsonUtil.getMsgType(m.ws_msg_type_t.reply))b=this.reqs.findIndex(function(a){return a.iid==d&&a.oid==t&&a.mid==g}),0<=b?0==a?this.reqs.splice(b,1).shift().resolve(c):(c=this.parceWebrpcError(a,
c.params),this.reqs.splice(b,1).shift().reject(c)):(n.logger.log("HDXMS didnt find this one. (reqs)"),n.logger.log(this.reqs));else if(c.hdr.msg_type==m.WsJsonUtil.getMsgType(m.ws_msg_type_t.event_req)){var r=c.func.id,b=this.cbs.findIndex(function(a){return a.iid==d&&a.oid==t&&a.cbid==r>>16});0<=b?(0==(r&65535)?this.cbs[b].resolve(c):(c=this.parceWebrpcError(a,c.params),this.cbs[b].reject(c)),1==this.cbs[b].oneShot&&this.cbs.splice(b,1)):(n.logger.log("HDXMS didnt find this one. (cbs)"),n.logger.log(this.cbs))}else n.logger.log("HDXMS Received bogus message: "+
b+"'")}else if("telemetry"==c.v)0==c.status&&(a=c.hdr.command,2==(a&2147483647)&&(b=c.hdr.id,this.telemetry.onInitialized(b),n.logger.log("Telemetry init response received")));else if("features"==c.v){a=c.features;if("feature-support"==c.command)for(n.logger.log("features capabilities received, features:"+a),this.vdafeatures_=a,b=0;b<a.length;b++)if(a[b]===E.FEATURE_vda_app_sharing)this.screenshare.onInitialized(!0);this.clientViewportMode_=c.client_viewport_mode;n.logger.log("features client_viewport_mode value: "+
this.clientViewportMode_)}else"appsharing"==c.v?(a=c.status,0==a?(a=c.hdr.command,b=c.hdr.id,(a&2147483647)==l.sshare_cmd.GetSources?(n.logger.log("appsharing GetSources response received"),this.screenshare.onGetSources(b,c.data)):(a&2147483647)==l.sshare_cmd.SetActive?(n.logger.log("appsharing SetActive response received"),this.screenshare.onSetActive(b,c.data)):(a&2147483647)==l.sshare_cmd.TopologyChanged?(n.logger.log("appsharing Window topology changed cmd received"),this.screenshare.onToplogyChanged()):
(n.logger.log("invalid command reply:"+a),this.screenshare.onError(b))):(n.logger.log("invalid status reply:"+a),b=c.hdr.id,this.screenshare.onError(b))):n.logger.log("HDXMS: Unknown protocol: "+b+"'")};a.prototype.clearReqs=function(){n.logger.log("clearReqs()");this.reqs.forEach(function(a,b){a.reject()});this.reqs=[]};a.prototype.registerHandler=function(a,b,c){a=new g(c.resolve.bind(c),c.reject.bind(c),a,b,c.id,c.oneShot,0);this.cbs.push(a)};a.prototype.unregisterHandler=function(a,b,c){var d=
this.cbs.findIndex(function(d){return d.iid==a&&d.oid==b&&d.cbid==c});0<=d?this.cbs.splice(d,1):(n.logger.log("HDXMS Didnt find this callback in the list!"),console.log(this.cbs))};a.prototype.isRedirected=function(){return this.status===v.Redirected||this.status===v.Binding||this.status===v.Connecting};a.prototype.isConnected=function(){return this.status==v.Redirected};a.prototype.isPingActive=function(){return this.pingactive};a.prototype.pingConnectionBegin=function(a){n.logger.log("Started timer");
this.pingactive=!0;var b=window.onVdiClientDisconnectedTimer;1==a?(n.logger.log("checking if we are connected..."),b()):this.conntimer=setTimeout(function(){n.logger.log("checking if we are connected...");b()},15E3)};a.prototype.pingConnectionEnd=function(){this.pingactive=!1;clearTimeout(this.conntimer)};a.prototype.SendTelemetryData_Speaker=function(a){this.telemetry.SendTelemetryData(p.tel_cmd.Data,p.tel_key_SpeakerDeviceUsed,a,0)};a.prototype.registerStateChangeNotification=function(a){this.stateChangeNotifcations.push(a)};
a.prototype.unregisterStateChangeNotification=function(a){this.stateChangeNotifcations=this.stateChangeNotifcations.filter(function(b){return b!=a})};a.prototype.dispatchStateChangeNotifications=function(){this.stateChangeNotifcations.forEach(function(a){a()})};a.prototype.vdabufferNoLimit=function(){for(var a=!1,b=0,c=this.vdafeatures_;b<c.length;b++)if(c[b]===E.FEATURE_vda_service_no_buffer_limit){a=!0;break}return a};Object.defineProperty(a.prototype,"clientViewportMode",{get:function(){return this.clientViewportMode_||
"unknown"},enumerable:!0,configurable:!0});return a}();a.HdxMediaStream=b;var t=new b;a.getRedirector=function(){return t}},985:function(b,a,c){var d=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();
Object.defineProperty(a,"__esModule",{value:!0});var n=c(658),e=c(550),m=c(851);b=function(a){function b(c,d,n){for(var t=[],z=3;z<arguments.length;z++)t[z-3]=arguments[z];return a.apply(this,[c,e.class_id_t.RTCIceCandidate,d,n,null].concat(t))||this}d(b,a);Object.defineProperty(b.prototype,"candidate",{get:function(){return this.candidate_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sdpMid",{get:function(){return this.sdpMid_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"sdpMLineIndex",{get:function(){return this.sdpMLineIndex_},enumerable:!0,configurable:!0});b.prototype.syncBarrier=function(){var a=this;m.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.waitUntilConnected("IceCandidate.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,e.method_id_RTCIceCandidate_t.candidate,""),a.remoteInvoke(!1,e.method_id_RTCIceCandidate_t.sdpMid,""),a.remoteInvoke(!1,e.method_id_RTCIceCandidate_t.sdpMLineIndex,
0)])}).then(function(c){c=c.map(function(b){return a.param0(b)});a.candidate_=c[0];a.sdpMid_=c[1];a.sdpMLineIndex_=c[2];b(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier failed!");c(b)})})};return b}(n.ProxyObject);a.IceCandidate=b;b=function(a){function b(c,d){return a.call(this,c,e.class_id_t.RTCIceCandidatePair,d,n.ProxyMode.Remote)||this}d(b,a);Object.defineProperty(b.prototype,"local",{get:function(){return this.local_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"remote",{get:function(){return this.remote_},enumerable:!0,configurable:!0});b.prototype.syncBarrier=function(){var a=this;m.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.waitUntilConnected("IceCandidatePair.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,e.method_id_RTCIceCandidatePair_t.local,{}),a.remoteInvoke(!1,e.method_id_RTCIceCandidatePair_t.remote,{})])}).then(function(c){c=c.map(function(b){return a.param0(b)});a.local_=
c[0];a.remote_=c[1];b(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier failed!");c(b)})})};return b}(n.ProxyObject);a.IceCandidatePair=b},851:function(b,a){Object.defineProperty(a,"__esModule",{value:!0});var c=function(){function a(b){this.tracing=!1;this.mslogger_=void 0;this.tag=b;this.enabled=!0}a.prototype.setMSLogger=function(a){this.mslogger_=a};a.prototype.log=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.enabled&&(void 0!=this.mslogger_?this.mslogger_.info(this.tag+
" "+a):console.log(this.tag+" "+a))};a.prototype.trace=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.tracing&&this.log.apply(this,a)};return a}();a.Logger=c;a.logger=new c("[HdxWebRTC.js]");a.logger.enabled=!0},360:function(b,a,c){var d=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var h in b)b.hasOwnProperty(h)&&(a[h]=b[h])};return a(b,c)};return function(b,
c){function q(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(q.prototype=c.prototype,new q)}}(),n=this&&this.__awaiter||function(a,b,c,q){return new (c||(c=Promise))(function(d,f){function w(a){try{y(q.next(a))}catch(b){f(b)}}function r(a){try{y(q["throw"](a))}catch(b){f(b)}}function y(a){a.done?d(a.value):(new c(function(b){b(a.value)})).then(w,r)}y((q=q.apply(a,b||[])).next())})},e=this&&this.__generator||function(a,b){function c(a){return function(b){return q([a,b])}}function q(c){if(f)throw new TypeError("Generator is already executing.");
for(;d;)try{if(f=1,w&&(r=c[0]&2?w["return"]:c[0]?w["throw"]||((r=w["return"])&&r.call(w),0):w.next)&&!(r=r.call(w,c[1])).done)return r;if(w=0,r)c=[c[0]&2,r.value];switch(c[0]){case 0:case 1:r=c;break;case 4:return d.label++,{value:c[1],done:!1};case 5:d.label++;w=c[1];c=[0];continue;case 7:c=d.ops.pop();d.trys.pop();continue;default:if(!(r=d.trys,r=0<r.length&&r[r.length-1])&&(6===c[0]||2===c[0])){d=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3]))d.label=c[1];else if(6===c[0]&&d.label<r[1])d.label=
r[1],r=c;else if(r&&d.label<r[2])d.label=r[2],d.ops.push(c);else{r[2]&&d.ops.pop();d.trys.pop();continue}}c=b.call(a,d)}catch(J){c=[6,J],w=0}finally{f=r=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var d={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},f,w,r,y;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return y={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(y[Symbol.iterator]=function(){return this}),y};Object.defineProperty(a,
"__esModule",{value:!0});var m=c(946),p=c(144),l=c(589),g=c(658),k=c(985),v=c(377),t=c(650),z=c(24),u=c(550),f=c(851),A=c(517),x=c(394),D=function(a){function b(h,c,q){h=a.call(this,h,u.class_id_t.RTCIceCandidateEvent,c,g.ProxyMode.Remote)||this;h.target=q;h.type="icecandidate";return h}d(b,a);Object.defineProperty(b.prototype,"candidate",{get:function(){return this.candidate_},enumerable:!0,configurable:!0});b.prototype.syncBarrier=function(){var a=this;f.logger.log(this.user_friendly_id()+".syncBarrier() called.");
return new Promise(function(b,h){a.waitUntilConnected(a.user_friendly_id()+".syncBarrier").then(function(){return a.remoteInvoke(!1,u.method_id_RTCIceCandidateEvent_t.candidate,{oid:0})}).then(function(b){b=a.param0(b);return!1===b.is_null?(new k.IceCandidate(a,b.oid,g.ProxyMode.Remote)).syncBarrier():Promise.resolve(null)}).then(function(h){f.logger.log(a.user_friendly_id()+".onicecandidate: icecandidate available!");a.candidate_=h;b(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".onicecandidate() failed!");
h(b)})})};return b}(g.ProxyObject);a.IceCandidateEvent=D;var C=function(){function a(b){this.state_="new";this.candidates_=[];this.pc_=b}a.prototype.pushState=function(a){f.logger.log(this.pc_.user_friendly_id()+".onicegatheringstatechange: new state is "+a);this.state_=a;"gathering"==this.state_?(this.candidates_=[],this.postUpdate()):this.processRemaining()};a.prototype.addIceCandidate=function(a){var b=this;this.candidates_.push(a);a.syncBarrier().then(function(a){f.logger.log(b.pc_.user_friendly_id()+
".onicecandidate: icecandidate available!");return Promise.all([b.pc_.updateSdpDescription(!0),Promise.resolve(a)])}).then(function(a){b.postIceCandidate(a[1])})};a.prototype.postIceCandidate=function(a){f.logger.log(this.pc_.user_friendly_id()+".onicecandidate: posting ice candidate now!");if(null!=this.pc_.onicecandidate)this.pc_.onicecandidate(a);else f.logger.log(this.pc_.user_friendly_id()+"onicecandidate is NULL!!!");this.candidates_.shift();this.processRemaining()};a.prototype.postUpdate=function(){f.logger.log(this.pc_.user_friendly_id()+
".onicegatheringstatechange: posting event now!");var a=new w("onicegatheringstatechange",this.pc_);this.pc_.onicegatheringstatechange(a)};a.prototype.processRemaining=function(){0==this.candidates_.length&&"complete"==this.state_?(this.pc_.onicecandidate({candidate:null,target:this}),this.postUpdate()):f.logger.log(this.pc_.user_friendly_id()+".onicecandidate: candidates remaining=["+this.candidates_.map(function(a){return a.object_id()})+"], state="+this.state_)};return a}(),r=function(){return function(a,
b){this.sdp=b;this.type=a}}();a.SessionDescriptionInit=r;var q=function(a){function b(h,c,q){for(var d=[],w=3;w<arguments.length;w++)d[w-3]=arguments[w];return a.apply(this,[h,u.class_id_t.RTCSessionDescription,c,q,null].concat(d))||this}d(b,a);b.prototype.toJSON=function(){return{type:this.type_,sdp:this.sdp_}};Object.defineProperty(b.prototype,"sdp",{get:function(){return this.sdp_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"type",{get:function(){return this.type_},enumerable:!0,
configurable:!0});b.prototype.syncBarrier=function(){var a=this;f.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,h){a.waitUntilConnected(a.user_friendly_id()+".syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,u.method_id_RTCSessionDescription_t.type,0),a.remoteInvoke(!1,u.method_id_RTCSessionDescription_t.sdp,"")])}).then(function(h){a.type_=a.convertType(a.param0(h[0]));a.sdp_=a.param0(h[1]);b(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,
".syncBarrier() failed!");h(b)})})};b.prototype.convertType=function(a){return 0==a?"offer":1==a?"pranswer":2==a?"answer":"rollback"};b.convertC2H=function(a){return"offer"==a?0:"pranswer"==a?1:"answer"==a?2:3};return b}(g.ProxyObject);a.SessionDescription=q;var w=function(){return function(a,b){this.type=a;this.target=b}}(),B=function(){return function(){}}(),y=function(){function a(b,c){this.local=b;this.remote=c}Object.defineProperty(a.prototype,"active",{get:function(){var a=!1;if(1==this.local||
1==this.remote)a=!0;return a},enumerable:!0,configurable:!0});return a}();b=function(a){function b(c){var h=a.call(this,null,u.class_id_t.RTCPeerConnection,0,g.ProxyMode.Local,null,void 0!=c?c:{},{})||this;h.timeerstarted_=!1;h.firsttimeremoteoffer_=!1;h.firststable_=!1;h.firsttimelocaloffer_=!1;h.audiocall_=new y(!1,!1);h.videocall_=new y(!1,!1);h.screensharingcall_=new y(!1,!1);h.conferencecall_=!1;h.incomingcall_=!1;h.outgoingcall_=!1;c&&c.sdpSemantics&&(h.sdpSemantics_=c.sdpSemantics);f.logger.log(h.user_friendly_id()+
".constructor sdpSemantics="+h.sdpSemantics_);if(!u.BUILD_TYPE_SDK&&h.isUnified()&&!m.getRedirector().getFeatureValue(u.FEATURE_ms_teams_webrtc_1dot0))throw new DOMException("CWA client does not support unified sdpSemantic","createPeerConnection");h.pendingtransceiver_=!1;h.deferredOfferAnswers=[];h.localStreams=[];h.remoteStreams=[];h.onaddstream_=null;h.signalingState_="stable";h.iceConnectionState_="new";h.iceGatheringState_="new";h.iceQ_=new C(h);h.receivers_=[];h.senders_=[];h.transceivers_=
[];h.registerStateChangeNotification(h.onStateChange);h.localdatachannel_=null;h.remotedatachannel_=null;return h}d(b,a);b.prototype.dumpSdp=function(a){f.logger.log(this.user_friendly_id()+".dumpSdp");a&&(f.logger.log(this.user_friendly_id()+"  -- type: "+a.type),f.logger.log(this.user_friendly_id()+"  -- sdp: "+a.sdp))};Object.defineProperty(b.prototype,"localDescription",{get:function(){f.logger.log(this.user_friendly_id()+".get_localDescription() called.");return this.localDescription_},set:function(a){f.logger.log(this.user_friendly_id()+
".set_localDescription() called.");this.localDescription_=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"remoteDescription",{get:function(){f.logger.log(this.user_friendly_id()+".get_remoteDescription() called.");return this.remoteDescription_},set:function(a){f.logger.log(this.user_friendly_id()+".get_remoteDescription() called.");this.remoteDescription_=a},enumerable:!0,configurable:!0});b.prototype.isUnified=function(){return"unified"==this.sdpSemantics_||"unified-plan"==
this.sdpSemantics_};b.prototype.onStateChange=function(){var a=new w("iceconnectionstatechange",this);if(this.oniceconnectionstatechange_)this.oniceconnectionstatechange_(a)};b.prototype.addIceCandidate=function(a){var b=this;f.logger.log(this.user_friendly_id()+".addIceCandidate() called.");this.waitUntilConnected(this.user_friendly_id()+".addIceCandidate").then(function(){var c={candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex};if(void 0==c.candidate||null==c.candidate)c.candidate=
"";void 0==c.sdpMid&&(c.sdpMid=null);void 0==c.sdpMLineIndex&&(c.sdpMLineIndex=null);return(new k.IceCandidate(b,0,g.ProxyMode.Local,c)).syncBarrier()}).then(function(a){return b.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.addIceCandidate,{oid:a.object_id()},{})}).then(function(){f.logger.log(b.user_friendly_id()+".addIceCandidate() success.");return b.updateSdpDescription(!1)}).then(function(){f.logger.log(b.user_friendly_id()+".addIceCandidate() - sync remote sdp success.")})["catch"](function(a){b.logRemoteInvokeError(a,
".addIceCandidate() failed!")})};Object.defineProperty(b.prototype,"onicecandidate",{get:function(){return this.onicecandidate_},set:function(a){var b=this;f.logger.log(this.user_friendly_id()+".set_onicecandidate() called.");this.onicecandidate_=a;this.waitUntilConnected(this.user_friendly_id()+".onicecandidate").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),u.method_id_RTCPeerConnection_t.onicecandidate);c.then(function(a){f.logger.log(b.user_friendly_id()+".onicecandidate callback received!!!");
a=new D(b,b.param0(a).oid,b);null!=b.iceQ_&&b.iceQ_.addIceCandidate(a)});return b.remoteInvoke(!0,u.method_id_RTCPeerConnection_t.onicecandidate,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".set_onicecandidate() failed!")})},enumerable:!0,configurable:!0});b.prototype.convertIceConnectionState=function(a){return 0==a?"new":1==a?"checking":2==a?"connected":3==a?"completed":4==a?"failed":5==a?"disconnected":"closed"};b.prototype.convertConnectionState=function(a){if(0!=a){if(1==a)return"connecting";
if(2==a)return"connected";if(3==a)return"disconnected";if(4==a)return"failed";if(5==a)return"closed"}return"new"};Object.defineProperty(b.prototype,"onconnectionstatechange",{get:function(){return this.onconnectionstatechange_},set:function(a){var b=this;f.logger.log(this.user_friendly_id()+".set_onconnectionstatechange() called.");this.onconnectionstatechange_=a;this.waitUntilConnected(this.user_friendly_id()+".onconnectionstatechange").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),
u.method_id_RTCPeerConnection_t.onconnectionstatechange);c.then(function(a){f.logger.log(b.user_friendly_id()+".onconnectionstatechange(): success callback received!!!");b.connectionState_=b.convertConnectionState(b.param0(a));f.logger.log(b.user_friendly_id()+" connectionState=:"+b.connectionState_);a=new w("connectionstatechange",b);b.onconnectionstatechange_(a)});return b.remoteInvoke(!0,u.method_id_RTCPeerConnection_t.onconnectionstatechange,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,
".set_onconnectionstatechange() failed!")})},enumerable:!0,configurable:!0});b.prototype.get_connectionState=function(){f.logger.log(this.user_friendly_id()+".get_connectionState() called, value = "+this.connectionState_);return this.isRedirected()?this.connectionState_:"failed"};Object.defineProperty(b.prototype,"oniceconnectionstatechange",{get:function(){return this.oniceconnectionstatechange_},set:function(a){var b=this;f.logger.log(this.user_friendly_id()+".set_oniceconnectionstatechange() called.");
this.oniceconnectionstatechange_=a;this.waitUntilConnected(this.user_friendly_id()+".oniceconnectionstatechange").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),u.method_id_RTCPeerConnection_t.oniceconnectionstatechange);c.then(function(a){f.logger.log(b.user_friendly_id()+".oniceconnectionstatechange(): success callback received!!!");b.iceConnectionState_=b.convertIceConnectionState(b.param0(a));a=new w("iceconnectionstatechange",b);b.oniceconnectionstatechange_(a)});return b.remoteInvoke(!0,
u.method_id_RTCPeerConnection_t.oniceconnectionstatechange,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".set_oniceconnectionstatechange() failed!")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"iceConnectionState",{get:function(){f.logger.log(this.user_friendly_id()+".get_iceConnectionState() called, value = "+this.iceConnectionState_);return this.isRedirected()?this.iceConnectionState_:"failed"},enumerable:!0,configurable:!0});b.prototype.convertIceGatheringState=
function(a){return 0==a?"new":1==a?"gathering":"complete"};Object.defineProperty(b.prototype,"onicegatheringstatechange",{get:function(){return this.onicegatheringstatechange_},set:function(a){var b=this;f.logger.log(this.user_friendly_id()+".set_onicegatheringstatechange() called.");this.onicegatheringstatechange_=a;this.waitUntilConnected(this.user_friendly_id()+".onicegatheringstatechange").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),u.method_id_RTCPeerConnection_t.onicegatheringstatechange);
c.then(function(a){f.logger.log(b.user_friendly_id()+".onicegatheringstatechange(): callback received!!!");b.iceGatheringState_=b.convertIceGatheringState(b.param0(a));null!=b.iceQ_&&b.iceQ_.pushState(b.iceGatheringState_)});return b.remoteInvoke(!0,u.method_id_RTCPeerConnection_t.onicegatheringstatechange,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".set_onicegatheringstatechange() failed!")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"iceGatheringState",{get:function(){f.logger.log(this.user_friendly_id()+
".get_iceGatheringState() called, value = "+this.iceGatheringState_);return this.iceGatheringState_},enumerable:!0,configurable:!0});b.prototype.convertSignalState=function(a){return 0==a?"stable":1==a?"have-local-offer":2==a?"have-local-pranswer":3==a?"have-remote-offer":4==a?"have-remote-pranswer":"closed"};b.prototype.TelemtryReadings_=function(){"have-local-offer"==this.signalingState_&&0==this.firsttimelocaloffer_&&0==this.firsttimeremoteoffer_&&(this.outgoingcallstart_=(new Date).getTime(),
0==this.outgoingcall_&&(this.SendTelemetryData(x.tel_key_PerfCallState,x.tel_CallState.active,1),this.SendTelemetryData(x.tel_key_PerfCallDirection,x.tel_CallDirection.outgoing,1),this.outgoingcall_=!0),this.firsttimelocaloffer_=!0);"have-remote-offer"==this.signalingState_&&0==this.firsttimeremoteoffer_&&0==this.firsttimelocaloffer_&&(this.incomingcallstart_=(new Date).getTime(),0==this.incomingcall_&&(this.SendTelemetryData(x.tel_key_PerfCallState,x.tel_CallState.active,1),this.SendTelemetryData(x.tel_key_PerfCallDirection,
x.tel_CallDirection.incoming,1),this.incomingcall_=!0),this.firsttimeremoteoffer_=!0);"stable"==this.signalingState_&&0==this.firststable_&&(this.callstartTime_=(new Date).getTime(),this.firststable_=this.timeerstarted_=!0);if("stable"==this.signalingState_){for(var a=0,b=this.localStreams;a<b.length;a++){var c=b[a];1<=c.getAudioTracks().length&&0==this.audiocall_.local&&(this.SendTelemetryData(x.tel_key_PerfCallType,x.tel_CallType.audio,1),this.audiocall_.local=!0);c=c.getVideoTracks();if(1<=c.length)for(var h=
0,q=c;h<q.length;h++)c=q[h],1==c.getSettings().deviceId.includes("display")?0==this.screensharingcall_.local&&(this.SendTelemetryData(x.tel_key_PerfCallType,x.tel_CallType.dshare,1),this.screensharingcall_.local=!0):0==this.videocall_.local&&(this.SendTelemetryData(x.tel_key_PerfCallType,x.tel_CallType.video,1),this.videocall_.local=!0)}a=0;for(b=this.remoteStreams;a<b.length;a++)if(c=b[a],1<=c.getAudioTracks().length&&0==this.audiocall_.remote&&(this.SendTelemetryData(x.tel_key_PerfCallType,x.tel_CallType.audio,
1),this.audiocall_.remote=!0),h=c.getVideoTracks(),1<=h.length)for(c=0;c<h.length;c++)1==h[c].id.includes("applicationsharingVideo")?0==this.screensharingcall_.remote&&(this.SendTelemetryData(x.tel_key_PerfCallType,x.tel_CallType.dshare,1),this.screensharingcall_.remote=!0):0==this.videocall_.remote&&(this.SendTelemetryData(x.tel_key_PerfCallType,x.tel_CallType.video,1),this.videocall_.remote=!0);2<this.getReceivers().length&&0==this.conferencecall_&&(this.SendTelemetryData(x.tel_key_PerfCallType,
x.tel_CallType.multi,1),this.conferencecall_=!0)}};Object.defineProperty(b.prototype,"onsignalingstatechange",{set:function(a){var b=this;f.logger.log(this.user_friendly_id()+".set_onsignalingstatechange() called.");this.onsignalingstatechange_=a;this.waitUntilConnected(this.user_friendly_id()+".onsignalingstatechanged").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),u.method_id_RTCPeerConnection_t.onsignalingstatechange);c.then(function(a){f.logger.log(b.user_friendly_id()+".onsignalingstatechange(): callback received!!!");
b.signalingState_=b.convertSignalState(b.param0(a));a=new w("onsignalingstatechange",b);b.onsignalingstatechange_(a);b.TelemtryReadings_()});return b.remoteInvoke(!0,u.method_id_RTCPeerConnection_t.onsignalingstatechange,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".set_onsignalingstatechange() failed!")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onsignalingstatechanged",{get:function(){return this.onsignalingstatechange_},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"ontrack",{get:function(){return this.ontrack_},set:function(a){var b=this;f.logger.log(this.user_friendly_id()+".set_ontrack() called.");this.ontrack_=a;this.waitUntilConnected(this.user_friendly_id()+".ontrack").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),u.method_id_RTCPeerConnection_t.ontrack);c.then(function(a){return n(b,void 0,void 0,function(){var b,c,h,q,d,w,J,F,r,K,y,z=this;return e(this,function(n){f.logger.log(this.user_friendly_id()+
".ontrack(): callback received!!!");b=new B;c=[];h=this.param0(a);void 0!=h.track&&!1===h.track.is_null&&(f.logger.log(this.user_friendly_id()+" adding a RemoteMediaTrack with oid:"+h.track.oid),q=new p.RemoteMediaTrack(this,h.track.oid),c.push(q.syncBarrier()));b.track=q;void 0!=h.receiver&&!1===h.receiver.is_null&&(d=this.receivers_.find(function(a){return a.object_id()===h.receiver.oid}),void 0===d&&(f.logger.log(this.user_friendly_id()+" adding a RtpReceiver with oid:"+h.receiver.oid),d=new l.RtpReceiver(this,
h.receiver.oid,g.ProxyMode.Remote,this.isUnified(),q)),c.push(d.syncBarrier()));b.receiver=d;t.RemoteSession.isFeatureWebrtc1dot0Supported()&&void 0!=h.transceiver&&!1===h.transceiver.is_null&&(w=this.transceivers_.find(function(a){return a.object_id()===h.transceiver.oid}),void 0===w&&(f.logger.log(this.user_friendly_id()+" adding a RtpTransceiver with oid:"+h.transceiver.oid),w=new v.RtpTransceiver(this,h.transceiver.oid,g.ProxyMode.Remote,this.isUnified(),"inactive",d),this.transceivers_.push(w)),
c.push(w.syncBarrier()));b.transceiver=w;b.streams=[];if(void 0!=h.streams)for(J=function(a){var h=F.remoteStreams.find(function(b){return!1===a.is_null&&b.object_id()===a.oid});void 0===h&&(f.logger.log(F.user_friendly_id()+" adding a RemoteStream with oid:"+a.oid),h=new p.RemoteStream(F,a.oid,g.ProxyMode.Remote),F.remoteStreams.push(h));c.push(h.syncBarrier());b.streams.push(h)},F=this,r=0,K=h.streams;r<K.length;r++)y=K[r],J(y);f.logger.log(this.user_friendly_id()+".ontrack(): .prop.syncBarrier start");
Promise.all(c).then(function(){f.logger.log(z.user_friendly_id()+".ontrack(): notified!!! with evt: "+b);for(var a=0,c=b.streams;a<c.length;a++)c[a].toggleAudio(!1);z.ontrack_(b)})["catch"](function(a){z.logRemoteInvokeError(a,".ontrack(): .prop.syncBarrier failed.")});return[2]})})});return b.remoteInvoke(!0,u.method_id_RTCPeerConnection_t.ontrack,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".set_ontrack(): failed.")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"signalingState",{get:function(){f.logger.log(this.user_friendly_id()+".get_signalingState() called, value = "+this.signalingState_);return this.signalingState_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onnegotiationneeded",{get:function(){return this.onnegotiationneeded_},set:function(a){var b=this;f.logger.log(this.user_friendly_id()+".set_onnegotiationneeded() called.");this.onnegotiationneeded_=a;this.waitUntilConnected(this.user_friendly_id()+".onnegotiationneeded").then(function(){var c=
b.registerCallbacks(!1,b.isNullCallback(a),u.method_id_RTCPeerConnection_t.onnegotiationneeded);c.then(function(){f.logger.log(b.user_friendly_id()+".onnegotiationneeded(): callback received!!!");var a=new w("negotiationneeded",b);b.onnegotiationneeded_(a)});return b.remoteInvoke(!0,u.method_id_RTCPeerConnection_t.onnegotiationneeded,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".set_onnegotiationneeded(): failed.")})},enumerable:!0,configurable:!0});b.prototype.dumpConstraints=function(a){f.logger.log(this.user_friendly_id()+
"constraints: "+a);void 0!==a&&0!==Object.keys(a).length||f.logger.log(this.user_friendly_id()+"constraints either undefined or empty!");a&&(f.logger.log(this.user_friendly_id()+"  -- video: "+a.offerToReceiveVideo),f.logger.log(this.user_friendly_id()+"  -- audio: "+a.offerToReceiveAudio),f.logger.log(this.user_friendly_id()+"  -- iceRestart: "+a.iceRestart),f.logger.log(this.user_friendly_id()+"  -- voiceActivityDetection: "+a.voiceActivityDetection))};b.prototype.fix_constraints=function(a){this.dumpConstraints(a);
var b={};this.isUnified()||(b={audio:!0,video:!0});a&&(void 0!==a.video&&(b.video=a.offerToReceiveVideo),void 0!==a.audio&&(b.audio=a.offerToReceiveAudio),void 0!==a.iceRestart&&(b.iceRestart=a.iceRestart),void 0!==a.voiceActivityDetection&&(b.voiceActivityDetection=a.voiceActivityDetection));return b};b.prototype.createOffer=function(a,b,c){f.logger.log(this.user_friendly_id()+".createOffer() called.",JSON.stringify(a));return this.isUnified()?void 0==a?this.createOffer_v2():a?this.createOffer_v2(a):
this.createOffer_v1(a,b,c):this.createOffer_v1(a,b,c)};b.prototype.createOffer_v2=function(a){var b=this;f.logger.log(this.user_friendly_id()+".createOffer_v2() called.",JSON.stringify(a));return new Promise(function(c,h){b.createOffer_v1(function(a){f.logger.log(b.user_friendly_id()+".createOffer_v2(): got sdp!!!");a=new r(a.type,a.sdp);c(a)},function(a){void 0!=a&&(a=b.logRemoteInvokeError(a,".createOffer_v2() failed."),h(a))},a)})};b.prototype.createOffer_v1=function(a,b,c){var h=this;f.logger.log(this.user_friendly_id()+
".createOffer_v1().",JSON.stringify(c));var d=[this.waitUntilConnected(this.user_friendly_id()+".createOffer_v1"),this.waitTransceiverReady(this.user_friendly_id()+".createOffer_v1")];Promise.all(d).then(function(){var a=h.registerCallbacks(!0,!1,u.method_id_RTCPeerConnection_t.createOffer);h.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.createOffer,a.success,a.fail,h.fix_constraints(c));return a.prom()}).then(function(a){f.logger.log(h.user_friendly_id()+".createOffer_v1(): success callback received!!!");
return(new q(h,h.param0(a).oid,g.ProxyMode.Remote)).syncBarrier()}).then(function(b){a&&a(b)})["catch"](function(a){void 0!=a&&(a=h.logRemoteInvokeError(a,".createOffer_v1() failed."),b&&b(a))})};b.prototype.createAnswer=function(a,b,c){f.logger.log(this.user_friendly_id()+".createAnswer() called.",JSON.stringify(a));return this.isUnified()?void 0==a?this.createAnswer_v2():a?this.createAnswer_v2(a):this.createAnswer_v1(a,b,c):this.createAnswer_v1(a,b,c)};b.prototype.createAnswer_v2=function(a){var b=
this;f.logger.log(this.user_friendly_id()+".createAnswer_v2() called.",JSON.stringify(a));return new Promise(function(c,h){b.createAnswer_v1(function(a){f.logger.log(b.user_friendly_id()+".createAnswer_v2(): got sdp!!!");a=new r(a.type,a.sdp);c(a)},function(a){void 0!=a&&(a=b.logRemoteInvokeError(a,".createAnswer_v2() failed."),h(a))},a)})};b.prototype.createAnswer_v1=function(a,b,c){var h=this;f.logger.log(this.user_friendly_id()+".createAnswer_v1() called.",JSON.stringify(c));var d=[this.waitUntilConnected(this.user_friendly_id()+
".createAnswer_v1"),this.waitTransceiverReady(this.user_friendly_id()+".createAnswer_v1")];Promise.all(d).then(function(){var a=h.registerCallbacks(!0,!1,u.method_id_RTCPeerConnection_t.createAnswer);h.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.createAnswer,a.success,a.fail,h.fix_constraints(c),{});return a.prom()}).then(function(a){f.logger.log(h.user_friendly_id()+".createAnswer_v1(): success callback received!!!");return(new q(h,h.param0(a).oid,g.ProxyMode.Remote)).syncBarrier()}).then(function(b){a&&
a(b)})["catch"](function(a){a=h.logRemoteInvokeError(a,".createAnswer_v1() failed.");b&&b(a.message)})};b.prototype.updateSdpDescription=function(a){return n(this,void 0,void 0,function(){var b,c,h,d=this;return e(this,function(w){switch(w.label){case 0:return f.logger.log(this.user_friendly_id()+".updateSdpDescription() called."),1!=a?[3,2]:[4,this.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.localDescription,{oid:this.object_id()})];case 1:return b=w.sent(),[3,4];case 2:return[4,this.remoteInvoke(!1,
u.method_id_RTCPeerConnection_t.remoteDescription,{oid:this.object_id()})];case 3:b=w.sent(),w.label=4;case 4:return c=new q(this,this.param0(b).oid,g.ProxyMode.Remote),[4,c.syncBarrier()["catch"](function(a){d.logRemoteInvokeError(a,"sdp.syncBarrier() failed!");return null})];case 5:return h=w.sent(),1==a?this.localDescription_=h:this.remoteDescription_=h,[2]}})})};b.prototype.setLocalDescription=function(a,b,c){f.logger.log(this.user_friendly_id()+".setLocalDescription() called.",JSON.stringify(a));
if(a instanceof r)return this.setLocalDescription_v2(a);if(a instanceof RTCSessionDescription&&b)return this.setLocalDescription_v1(a,b,c);b=void 0;a?b=new r(a.type,a.sdp):(f.logger.log(this.user_friendly_id()+".setLocalDescription() empty param1, setting sdp type to rollback"),a=void 0,a="have-remote-offer"==this.signalingState_?"answer":"have-local-pranswer"==this.signalingState_||"have-remote-pranswer"==this.signalingState_?"pranswer":"offer",b=new r(a,""));return this.setLocalDescription_v2(b)};
b.prototype.setLocalDescription_v2=function(a){var b=this;f.logger.log(this.user_friendly_id()+".setLocalDescription_v2() called.",JSON.stringify(a));return new Promise(function(c,h){b.waitUntilConnected(b.user_friendly_id()+".setLocalDescription_v2").then(function(){return(new q(b,0,g.ProxyMode.Local,{type:q.convertC2H(a.type),sdp:a.sdp})).syncBarrier()}).then(function(d){var w=b.registerCallbacks(!0,!1,u.method_id_RTCPeerConnection_t.setLocalDescription_v2),r={type:q.convertC2H(a.type),sdp:a.sdp};
b.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.setLocalDescription_v2,r,w.success,w.fail);w.prom().then(function(){f.logger.log(b.user_friendly_id()+".setLocalDescription_v2(): success callback received!!!");b.localDescription_=d;f.logger.log(b.user_friendly_id()+".setLocalDescription_v2(): updated localDescription_");b.isUnified();Promise.all([]).then(function(){f.logger.log(b.user_friendly_id()+".setLocalDescription_v2() success.");c()})["catch"](function(a){a=b.logRemoteInvokeError(a,".prop.setLocalDescription_v2() failed!");
h(a)})})["catch"](function(a){a=b.logRemoteInvokeError(a,"setLocalDescription_v2() error callback received!");h(a)})})["catch"](function(a){a=b.logRemoteInvokeError(a,".setLocalDescription_v2() failed.");h(a)})})};b.prototype.setLocalDescription_v1=function(a,b,c){var h=this;f.logger.log(this.user_friendly_id()+".setLocalDescription_v1() called.");this.waitUntilConnected(this.user_friendly_id()+".setLocalDescription_v1").then(function(){return(new q(h,0,g.ProxyMode.Local,{type:q.convertC2H(a.type),
sdp:a.sdp})).syncBarrier()}).then(function(a){var q=h.registerCallbacks(!0,!1,u.method_id_RTCPeerConnection_t.setLocalDescription);h.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.setLocalDescription,{oid:a.object_id()},q.success,q.fail);q.prom().then(function(){f.logger.log(h.user_friendly_id()+".setLocalDescription_v1(): success callback received!!!");h.localDescription_=a;f.logger.log(h.user_friendly_id()+".setLocalDescription_v1(): updated localDescription_");h.isUnified();Promise.all([]).then(function(){f.logger.log(h.user_friendly_id()+
".setLocalDescription_v1() success.");b&&b()})["catch"](function(a){a=h.logRemoteInvokeError(a,".prop.setLocalDescription_v1() failed.");c&&c(a.message)})})["catch"](function(a){a=h.logRemoteInvokeError(a,".setLocalDescription_v1() error callback received.");c&&c(a.message)})})["catch"](function(a){a=h.logRemoteInvokeError(a,".setLocalDescription_v1() failed.");c&&c(a.message)})};b.prototype.setRemoteDescription=function(a,b,c){f.logger.log(this.user_friendly_id()+".setRemoteDescription() called.",
JSON.stringify(a));if(a instanceof r)return this.setRemoteDescription_v2(a);if(a instanceof RTCSessionDescription&&b)return this.setRemoteDescription_v1(a,b,c);b=void 0;a?b=new r(a.type,a.sdp):(f.logger.log(this.user_friendly_id()+".setRemoteDescription() empty param1, setting sdp type to rollback"),a=void 0,a="have-remote-offer"==this.signalingState_?"answer":"have-local-pranswer"==this.signalingState_||"have-remote-pranswer"==this.signalingState_?"pranswer":"offer",b=new r(a,""));return this.setRemoteDescription_v2(b)};
b.prototype.setRemoteDescription_v2=function(a){var b=this;f.logger.log(this.user_friendly_id()+".setRemoteDescription_v2() called.",JSON.stringify(a));return new Promise(function(c,h){b.waitUntilConnected(b.user_friendly_id()+".setRemoteDescription_v2").then(function(){return(new q(b,0,g.ProxyMode.Local,{type:q.convertC2H(a.type),sdp:a.sdp})).syncBarrier()}).then(function(d){var w=b.registerCallbacks(!0,!1,u.method_id_RTCPeerConnection_t.setRemoteDescription_v2),r={type:q.convertC2H(a.type),sdp:a.sdp};
b.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.setRemoteDescription_v2,r,w.success,w.fail);w.prom().then(function(){f.logger.log(b.user_friendly_id()+".setRemoteDescription_v2(): success callback received!!!");b.remoteDescription_=d;f.logger.log(b.user_friendly_id()+".setRemoteDescription_v2(): updated remoteDescription_");var a=[];b.isUnified()?a.push(b.getTransceiversAsync()):a.push(b.getSendersAsync());Promise.all(a).then(function(){f.logger.log(b.user_friendly_id()+".setRemoteDescription_v2(): success.");
c()})["catch"](function(a){a=b.logRemoteInvokeError(a,".prop.setRemoteDescription_v2() failed.");h(a)})})["catch"](function(a){a=b.logRemoteInvokeError(a,".setRemoteDescription_v2() error callback received.");h(a)})})["catch"](function(a){a=b.logRemoteInvokeError(a,".setRemoteDescription_v2() failed.");h(a)})})};b.prototype.setRemoteDescription_v1=function(a,b,c){var h=this;f.logger.log(this.user_friendly_id()+".setRemoteDescription_v1() called.");this.waitUntilConnected(this.user_friendly_id()+".setRemoteDescription_v1").then(function(){return(new q(h,
0,g.ProxyMode.Local,{type:q.convertC2H(a.type),sdp:a.sdp})).syncBarrier()}).then(function(a){var q=h.registerCallbacks(!0,!1,u.method_id_RTCPeerConnection_t.setRemoteDescription);h.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.setRemoteDescription,{oid:a.object_id()},q.success,q.fail);q.prom().then(function(){f.logger.log(h.user_friendly_id()+".setRemoteDescription_v1(): success callback received!!!");h.remoteDescription_=a;f.logger.log(h.user_friendly_id()+".setRemoteDescription_v1(): updated remoteDescription_");
var q=[];h.isUnified()?q.push(h.getTransceiversAsync()):q.push(h.getSendersAsync());Promise.all(q).then(function(){f.logger.log(h.user_friendly_id()+".setRemoteDescription_v1(): success.");b&&b()})["catch"](function(a){a=h.logRemoteInvokeError(a,".prop.setRemoteDescription_v1() failed.");c&&c(a.message)})})})["catch"](function(a){a=h.logRemoteInvokeError(a,".setRemoteDescription_v1() failed.");c&&c(a.message)})};b.prototype.getLocalStreams=function(){f.logger.log("PeerConnection.getLocalStreams() called. [oid="+
this.object_id()+"]");for(var a=0,b=this.localStreams;a<b.length;a++)f.logger.log(JSON.stringify(b[a]));return this.localStreams};b.prototype.getRemoteStreams=function(){f.logger.log(this.user_friendly_id()+".getRemoteStreams() called.");for(var a=0,b=this.remoteStreams;a<b.length;a++)f.logger.log(JSON.stringify(b[a]));return this.remoteStreams};b.prototype.addTrack=function(a,b){var c=this;f.logger.log(this.user_friendly_id()+".addTrack() called: "+JSON.stringify(b));var h=[];if(b instanceof p.RemoteStream)h.push(b.id),
this.localStreams.push(b);else for(var q=0;q<b.length;q++)h.push(b[q].id),this.localStreams.push(b[q]);var d=new l.RtpSender(this,0,g.ProxyMode.Pseudo,this.isUnified());this.senders_.push(d);this.waitUntilConnected(this.user_friendly_id()+".addTrack").then(function(){return c.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.addTrack,{oid:a.object_id()},h)}).then(function(a){f.logger.log(c.user_friendly_id()+".addTrack() success with oid: "+c.param0(a).oid);d.bind(c,c.param0(a).oid);d.syncBarrier().then(function(){f.logger.log(c.user_friendly_id()+
"sender.syncBarrier(): success");c.isUnified()&&c.getTransceiversAsync()})["catch"](function(a){c.logRemoteInvokeError(a,"sender.syncBarrier() failed!")})})["catch"](function(a){c.logRemoteInvokeError(a,"addTrack() failed!")});f.logger.log(this.user_friendly_id()+".addTrack() returning: "+d);return d};b.prototype.removeTrack=function(a){var b=this;f.logger.log(this.user_friendly_id()+".removeTrack() called.");for(var c=0;c<this.senders_.length;c++)this.senders_[c]==a&&this.senders_.splice(c,1);this.waitUntilConnected(this.user_friendly_id()+
".removeTrack").then(function(){return b.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.removeTrack,{oid:a.object_id()})}).then(function(){f.logger.log(b.user_friendly_id()+".removeTrack() success.");b.isUnified()&&b.getTransceiversAsync()})["catch"](function(a){b.logRemoteInvokeError(a,"removeTrack() failed!")})};b.prototype.addStream=function(a){var b=this;f.logger.log(this.user_friendly_id()+".addStream() called: "+JSON.stringify(a));this.localStreams.push(a);this.waitUntilConnected(this.user_friendly_id()+
".addStream").then(function(){return b.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.addStream,{oid:a.object_id()},{})}).then(function(){f.logger.log(b.user_friendly_id()+".addStream() success.")})["catch"](function(a){b.logRemoteInvokeError(a,"addStream() failed.")})};b.prototype.removeStream=function(a){var b=this;f.logger.log(this.user_friendly_id()+".removeStream() called: "+JSON.stringify(a));for(var c=0;c<this.localStreams.length;c++)this.localStreams[c]==a&&this.localStreams.splice(c,1);
this.waitUntilConnected(this.user_friendly_id()+".removeStream").then(function(){return b.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.removeStream,{oid:a.object_id()})}).then(function(){f.logger.log(b.user_friendly_id()+".removeStream() success.")})["catch"](function(a){b.logRemoteInvokeError(a,"removeStream() failed.")})};Object.defineProperty(b.prototype,"onaddstream",{get:function(){return this.onaddstream_},set:function(a){var b=this;f.logger.log(this.user_friendly_id()+".set_onaddstream() called.");
this.onaddstream_=a;this.waitUntilConnected(this.user_friendly_id()+".onaddstream").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),u.method_id_RTCPeerConnection_t.onaddstream);c.then(function(a){(new p.RemoteStreamEvent(b,b.param0(a).oid)).syncBarrier().then(function(a){f.logger.log(b.user_friendly_id()+".onaddstream callback received!");void 0===b.remoteStreams.find(function(b){return void 0!=a.stream&&b.object_id()===a.stream.object_id()})&&b.remoteStreams.push(a.stream);void 0!=
b.onaddstream_&&(f.logger.log(b.user_friendly_id()+".onaddstream notified!!! "+a.stream.id),b.onaddstream_(a))})});return b.remoteInvoke(!0,u.method_id_RTCPeerConnection_t.onaddstream,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,"set_onaddstream() failed!")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onremovestream",{get:function(){return this.onremovestream_},set:function(a){var b=this;f.logger.log(this.user_friendly_id()+".set_onremovestream() called.");this.onremovestream_=
a;this.waitUntilConnected(this.user_friendly_id()+".onremovestream").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),u.method_id_RTCPeerConnection_t.onremovestream);c.then(function(a){(new p.RemoteStreamEvent(b,b.param0(a).oid)).syncBarrier().then(function(a){f.logger.log(b.user_friendly_id()+".onremovestream callback received! "+a.stream.id);var c=b.remoteStreams.findIndex(function(b){return b.id==a.stream.id});0<=c&&b.remoteStreams.splice(c,1);b.onremovestream_(a)})});return b.remoteInvoke(!0,
u.method_id_RTCPeerConnection_t.onremovestream,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,"set_onremovestream() failed!")})},enumerable:!0,configurable:!0});b.prototype.getStats=function(a){var b=this;return new Promise(function(c,h){var q=this;b.isRedirected()?b.waitUntilConnected(b.user_friendly_id()+".getStats").then(function(){var h=b.registerCallbacks(!0,!1,u.method_id_RTCPeerConnection_t.getStats);h.then(function(b){void 0!==b.params&&0!==b.params.length&&(a?(a(A.StatsReport.fromJSON(JSON.parse(b.params[0]))),
c()):c(A.StatsReport.toRTCStatsReport(JSON.parse(b.params[0]))))});return a?b.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.getStats,h.success):b.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.getStats_v2,h.success)})["catch"](function(a){q&&(a=q.logRemoteInvokeError(a,".getStats() failed!"),h(a))}):(a({}),c())})};b.prototype.SendTelemetryData=function(a,b,c){m.getRedirector().telemetry.SendTelemetryData(x.tel_cmd.Data,a,b,c)};b.prototype.MillisecondstoDisplayformat_=function(a){var b,c;c=Math.floor(a/
1E3);b=Math.floor(c/60);a=Math.floor(b/60);f.logger.log(Math.floor(a/24)+":"+a%24+":"+b%60+":"+c%60)};b.prototype.CalculateCallDurationandType_=function(){if(1==this.timeerstarted_){this.timeerstarted_=!1;this.callendTime_=(new Date).getTime();var a=this.callendTime_-this.callstartTime_;this.MillisecondstoDisplayformat_(a);a=Math.round(a/1E3);f.logger.log("Call Duration "+a);1==this.conferencecall_?this.SendTelemetryData(x.tel_key_ConferenceCallDuration,a,1):(1==this.audiocall_.active&&this.SendTelemetryData(x.tel_key_AudioCallDuration,
a,1),1==this.videocall_.active&&this.SendTelemetryData(x.tel_key_VideoCallDuration,a,1),1==this.screensharingcall_.active&&this.SendTelemetryData(x.tel_key_ScreensharingCallDuration,a,1));var b;1==this.firsttimelocaloffer_&&(b=this.callstartTime_-this.outgoingcallstart_);1==this.firsttimeremoteoffer_&&(b=this.callstartTime_-this.incomingcallstart_);this.MillisecondstoDisplayformat_(b);b=Math.round(b/1E3);f.logger.log("Call Establish Time "+b);1==this.incomingcall_?this.SendTelemetryData(x.tel_key_CallEstIncoming,
b,1):1==this.outgoingcall_&&this.SendTelemetryData(x.tel_key_CallEstOutgoing,b,1);this.SendTelemetryData(x.tel_key_PerfCallState,x.tel_CallState.idle,1)}};b.prototype.close=function(){var a=this;f.logger.log(this.user_friendly_id()+".close() called.");this.CalculateCallDurationandType_();this.unregisterStateChangeNotification(this.onStateChange);this.onnegotiationneeded=this.onsignalingstatechange=this.onicegatheringstatechange=this.oniceconnectionstatechange=this.onicecandidate=this.onaddstream=
null;this.waitUntilConnected(this.user_friendly_id()+".close").then(function(){return a.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.close)}).then(function(){a.iceQ_=null;a.release();f.logger.log(a.user_friendly_id()+".close() success.")})["catch"](function(b){a.logRemoteInvokeError(b,".close() failed.");a.iceQ_=null;a.release()})};b.prototype.createDTMFSender=function(a){f.logger.log(this.user_friendly_id()+".createDTMFSender() called.");var b,c=this.senders_;if(void 0===c||0===c.length)c=this.getSenders();
void 0!=c&&(c=c.find(function(b){return b.track.id===a.id}),void 0!=c&&(f.logger.log(this.user_friendly_id()+" returning RtpSender with oid:"+c.object_id()),b=c.dtmf));return b};b.prototype.getSenders=function(){var a=this;f.logger.log(this.user_friendly_id()+".getSenders() called. ");if(this.isUnified()){for(var b=[],c=0,h=this.transceivers_;c<h.length;c++)b.push(h[c].sender);this.senders_=b}else this.getSendersAsync().then(function(){f.logger.log(a.user_friendly_id()+".getSenders() success.")})["catch"](function(b){a.logRemoteInvokeError(b,
".getSenders() failed!")});f.logger.log(this.user_friendly_id()+".getSenders() returning:"+this.senders_.length+" items");return this.senders_};b.prototype.getSendersAsync=function(){var a=this;f.logger.log(this.user_friendly_id()+".getSendersAsync() called. "+this.senders_);return new Promise(function(b,c){a.waitUntilConnected(a.user_friendly_id()+".getSendersAsync").then(function(){f.logger.log(a.user_friendly_id()+".getSendersAsync invoking remote");return a.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.getSenders,
[])}).then(function(c){f.logger.log(a.user_friendly_id()+".getSendersAsync remote success");var h=[],q=[];c.params[0].forEach(function(b){var c=a.senders_.find(function(a){return a.object_id()===b.oid});void 0===c&&(f.logger.log(a.user_friendly_id()+" adding a RtpSender with oid:"+b.oid),c=new l.RtpSender(a,b.oid,g.ProxyMode.Remote,a.isUnified()),q.push(c.syncBarrier()));h.push(c)});Promise.all(q).then(function(){a.senders_=h;f.logger.log(a.user_friendly_id()+".getSendersAsync: returning senders with ids ["+
a.senders_.map(function(a){return a.object_id()})+"]");b(a.senders_)})["catch"](function(c){a.logRemoteInvokeError(c,".prop.getSendersAsync() failed.");a.senders_=[];b(a.senders_)})})["catch"](function(c){a.logRemoteInvokeError(c,".getSendersAsync() failed.");a.senders_=[];b(a.senders_)})})};b.prototype.getReceivers=function(){var a=this;f.logger.log(this.user_friendly_id()+".getReceivers() called. ");if(this.isUnified()){for(var b=[],c=0,h=this.transceivers_;c<h.length;c++)b.push(h[c].receiver);
this.receivers_=b}else this.getReceiversAsync().then(function(){f.logger.log(a.user_friendly_id()+".getReceivers() success.")})["catch"](function(b){a.logRemoteInvokeError(b,".getReceivers() failed!")});f.logger.log(this.user_friendly_id()+".getReceivers() returning:"+this.receivers_.length+" items");return this.receivers_};b.prototype.getReceiversAsync=function(){var a=this;f.logger.log(this.user_friendly_id()+".getReceiversAsync() called. "+this.receivers_);return new Promise(function(b,c){a.waitUntilConnected(a.user_friendly_id()+
".getReceiversAsync").then(function(){return a.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.getReceivers,[])}).then(function(c){f.logger.log(a.user_friendly_id()+".getReceiversAsync: remote success.");var h=[],q=[];c.params[0].forEach(function(b){var c=a.receivers_.find(function(a){return a.object_id()===b.oid});void 0===c&&(f.logger.log(a.user_friendly_id()+" adding a RtpReceiver with oid:"+b.oid),c=new l.RtpReceiver(a,b.oid,g.ProxyMode.Remote,a.isUnified()),q.push(c.syncBarrier()));h.push(c)});
Promise.all(q).then(function(){a.receivers_=h;f.logger.log(a.user_friendly_id()+".getReceiversAsync: returning receiver with ids ["+a.receivers_.map(function(a){return a.object_id()})+"]");b(a.receivers_)})["catch"](function(c){a.logRemoteInvokeError(c,".prop.getReceiversAsync() failed!");a.receivers_=[];b(a.receivers_)})})["catch"](function(c){a.logRemoteInvokeError(c,".getReceiversAsync() failed!");a.receivers_=[];b(a.receivers_)})})};b.prototype.addTransceiver=function(a,b){var c=this;f.logger.log(this.user_friendly_id()+
".addTransceiver() called: "+JSON.stringify(a)+" init="+JSON.stringify(b));this.pendingtransceiver_=!0;var h="sendrecv";b&&b.direction&&(h=b.direction);var q=new v.RtpTransceiver(this,0,g.ProxyMode.Pseudo,this.isUnified(),h);this.transceivers_.push(q);this.waitUntilConnected(this.user_friendly_id()+".addTransceiver").then(function(){return"string"===typeof a?c.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.addTransceiverWithKind,a,b):c.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.addTransceiverWithTrack,
{oid:a.object_id()},b)}).then(function(a){f.logger.log(c.user_friendly_id()+".addTransceiver() success with oid: "+c.param0(a).oid);q.bind(c,c.param0(a).oid);q.syncBarrier().then(function(){f.logger.log(c.user_friendly_id()+".addTransceiver(): success");c.pendingtransceiver_=!1})["catch"](function(a){c.logRemoteInvokeError(a,".prop.addTransceiver() failed!");c.pendingtransceiver_=!1})})["catch"](function(a){c.logRemoteInvokeError(a,"addTransceiver() failed!");c.pendingtransceiver_=!1});f.logger.log(this.user_friendly_id()+
".addTransceiver() returning:");return q};b.prototype.waitTransceiverReady=function(a){var b=this;return new Promise(function(c,h){f.logger.trace(b.user_friendly_id()+".waitTransceiverReady(): pendingtransceiver_="+b.pendingtransceiver_);if(0==b.pendingtransceiver_){for(;b.deferredOfferAnswers&&0<b.deferredOfferAnswers.length;)b.deferredOfferAnswers.shift().post(!0);c()}else b.deferredOfferAnswers.push(new g.deferred_action(c,h,a)),b.checkTransceiver(15,1E3)})};b.prototype.checkTransceiver=function(a,
b){var c=this;if(0>=a)for(f.logger.log(".checkTransceiver() timeout waiting for transceiver ready!");this.deferredOfferAnswers&&0<this.deferredOfferAnswers.length;)this.deferredOfferAnswers.shift().post(!1);else setTimeout(function(){if(0==c.pendingtransceiver_)for(;c.deferredOfferAnswers&&0<c.deferredOfferAnswers.length;)c.deferredOfferAnswers.shift().post(!0);else f.logger.log('.checkTransceiver(): count= "'+a),c.checkTransceiver(--a,b)},b)};b.prototype.getTransceivers=function(){f.logger.log(this.user_friendly_id()+
".getTransceivers() called. ");f.logger.log(this.user_friendly_id()+".getTransceivers() returning:"+this.transceivers_.length+" items");return this.transceivers_};b.prototype.getTransceiversAsync=function(){var a=this;f.logger.log(this.user_friendly_id()+".getTransceiversAsync() called. ");return new Promise(function(b,c){a.waitUntilConnected(a.user_friendly_id()+".getTransceiversAsync").then(function(){return a.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.getTransceivers,[])}).then(function(c){f.logger.log(a.user_friendly_id()+
".getTransceiversAsync() remote success.");var h=[],q=[];c.params[0].forEach(function(b){var c=a.transceivers_.find(function(a){return a.object_id()===b.oid});void 0===c&&(f.logger.log(a.user_friendly_id()+" adding a RtpTransceiver with oid:"+b.oid),c=new v.RtpTransceiver(a,b.oid,g.ProxyMode.Remote,a.isUnified()),q.push(c.syncBarrier()));h.push(c)});Promise.all(q).then(function(){a.transceivers_=h;f.logger.log(a.user_friendly_id()+".prop.getTransceiversAsync: returning transceiver with ids ["+a.transceivers_.map(function(a){return a.object_id()})+
"]");b(a.transceivers_)})["catch"](function(c){a.logRemoteInvokeError(c,".prop.getTransceiversAsync() failed!");a.transceivers_=[];b(a.transceivers_)})})["catch"](function(c){a.logRemoteInvokeError(c,".getTransceiversAsync() failed!");a.transceivers_=[];b(a.transceivers_)})})};Object.defineProperty(b.prototype,"sctp",{get:function(){return this.sctp_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"ondatachannel",{get:function(){return this.ondatachannel_},set:function(a){var b=
this;f.logger.log(this.user_friendly_id()+".set_ondatachannel() called.");this.ondatachannel_=a;this.waitUntilConnected(this.user_friendly_id()+".ondatachannel").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),u.method_id_RTCPeerConnection_t.ondatachannel);c.then(function(a){f.logger.log(b.user_friendly_id()+".ondatachannel callback received!!!");if(null===b.remotedatachannel_||b.remotedatachannel_.object_id()!=b.param0(a).oid)b.remotedatachannel_=new z.RtcDataChannel(b,b.param0(a).oid,
g.ProxyMode.Remote),b.remotedatachannel_.syncBarrier().then(function(){f.logger.log(b.user_friendly_id()+"remotedatachannel_.syncBarrier(): success");var a=new Event("ondatachannel");a.channel=b.remotedatachannel_;if(b.localdatachannel_&&!b.localdatachannel_.isdestroyed())b.localdatachannel_.syncBarrier().then(function(){f.logger.log(b.user_friendly_id()+"ondatachannel(): notifying...");if(b.ondatachannel_)b.ondatachannel_(a)})["catch"](function(){f.logger.log(b.user_friendly_id()+"localdatachannel_.syncBarrier(): failed!")});
else if(f.logger.log(b.user_friendly_id()+"ondatachannel(): notifying..."),b.ondatachannel_)b.ondatachannel_(a)})["catch"](function(){f.logger.log(b.user_friendly_id()+"remotedatachannel_.syncBarrier(): failed!")})});return b.remoteInvoke(!0,u.method_id_RTCPeerConnection_t.ondatachannel,c.success)})["catch"](function(){f.logger.log(b.user_friendly_id()+".ondatachannel() failed.")})},enumerable:!0,configurable:!0});b.prototype.fixDataChannelConfig=function(a){f.logger.log(this.user_friendly_id()+".fixDataChannelConfig() called: "+
a);void 0==a&&(a={});void 0==a.negotiated&&void 0==a.id&&(a.negotiated=!1,a.id=-1);return a};b.prototype.createDataChannel=function(a,b){var c=this;f.logger.log(this.user_friendly_id()+".createDataChannel() called. label:"+a);this.localdatachannel_=new z.RtcDataChannel(this,0,g.ProxyMode.Pseudo);this.waitUntilConnected(this.user_friendly_id()+".createDataChannel").then(function(){return c.remoteInvoke(!1,u.method_id_RTCPeerConnection_t.createDataChannel,a,c.fixDataChannelConfig(b))}).then(function(a){f.logger.log(c.user_friendly_id()+
".createDataChannel() success with oid: "+c.param0(a).oid);c.localdatachannel_.bind(c,c.param0(a).oid);c.localdatachannel_.syncBarrier().then(function(){f.logger.log(c.user_friendly_id()+"channel.syncBarrier(): success")})["catch"](function(){f.logger.log(c.user_friendly_id()+"channel.syncBarrier(): failed!")})})["catch"](function(a){a=c.param0(a);f.logger.log(c.user_friendly_id()+".createDataChannel() failed with error: "+a)});f.logger.log(this.user_friendly_id()+".createDataChannel() returning: "+
this.localdatachannel_);return this.localdatachannel_};return b}(g.ProxyObject);a.PeerConnection=b},658:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});var d=c(946),n=c(851),e=c(545),m=c(247),p=c(550),l=function(){function a(b,c,d){this.resolve=b;this.reject=c;this.name_=d}Object.defineProperty(a.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0});a.prototype.post=function(a){1==a?(n.logger.log('deferred_action.post(): resolving "'+this.name_+'"'),
this.resolve()):(n.logger.log('deferred_action.post(): rejecting "'+this.name_+'"'),this.reject())};a.prototype.postWithResult=function(a,b){1==a?(n.logger.log('deferred_action.post(): resolving "'+this.name_+'"'),this.resolve(b)):(n.logger.log('deferred_action.post(): rejecting "'+this.name_+'"'),this.reject())};return a}();a.deferred_action=l;var g=function(){return function(a,b){this.id=a;this.is_null=b}}();a.rpc_callback=g;var k=function(){function a(b,c,d){this.success=new g(b<<16,c);this.fail=
new g(b<<16|1,c);this.id=b;this.oneShot=d}a.prototype.resolve=function(a){n.logger.trace("callback.resolve() called. [id="+this.id+"]");null!=this.handler&&this.handler(a)};a.prototype.reject=function(a){null!=this.err_handler&&this.err_handler(a)};a.prototype.then=function(a){this.handler=a};a.prototype.prom=function(){var a=this;return new Promise(function(b,c){a.handler=b;a.err_handler=c})};return a}();a.callback=k;var v;(function(a){a[a.NotConfigured=0]="NotConfigured";a[a.Configured=1]="Configured";
a[a.Error=2]="Error";a[a.Destroyed=3]="Destroyed"})(v||(v={}));var t;(function(a){a[a.Local=0]="Local";a[a.Remote=1]="Remote";a[a.Pseudo=2]="Pseudo"})(t=a.ProxyMode||(a.ProxyMode={}));b=function(){function a(b,c,g,l,k){void 0===k&&(k=null);for(var C=[],r=5;r<arguments.length;r++)C[r-5]=arguments[r];var q=this;this.hdxms=d.getRedirector();this.iid=c;this.oid=g;this.mode=l;this.proxystate=v.NotConfigured;this.deferredActions=[];this.cbs=new Map;l===t.Local?(r=!1,this.iid===p.class_id_t.EngineControl&&
(r=!0),this.hdxms.startRedirection(r,this.user_friendly_id()).then(function(){q.oid=a.nextId++;n.logger.log(q.user_friendly_id()+" assigned local oid:"+q.oid);var b=p.WebrpcClassLibInfoUtil.getMethodFeatureByid(c,0);return q.hdxms.WSSendObjectWrapper(b,c,0,e.WsJsonUtil.createMessageByid.apply(e.WsJsonUtil,[!1,!1,e.ws_msg_type_t.req,c,0,q.oid].concat(C)))}).then(function(a){n.logger.trace("ProxyObject: setting state to configured. (iid: "+q.iid+" oid: "+q.oid+")");var c=q.oid;q.proxystate=v.Configured;
q.oid=q.param0(a);n.logger.log(q.user_friendly_id()+" assigned remote oid for local oid:"+c);q.onConnected();k&&k();m.gc.trackObject(q,b)})["catch"](function(){q.proxystate=v.Error;q.onConnected()})):l===t.Remote&&(this.proxystate=v.Configured,m.gc.trackObject(this,b))}a.prototype.bind=function(a,b){n.logger.trace("ProxyObject: binding object. (iid: "+this.iid+" oid: "+b+" mode: "+this.mode+")");if(this.mode===t.Pseudo){this.proxystate=v.Configured;var c=this.oid;this.oid=b;n.logger.log(this.user_friendly_id()+
" assigned remote oid for local oid:"+c);this.onConnected();m.gc.trackObject(this,a);this.mode=t.Remote}else this.mode===t.Remote?n.logger.log("ProxyObject: binding already complete."):n.logger.log("ProxyObject: binding failure. incorrect mode!")};a.prototype.reconstructor=function(a,b,c){for(var d=this,t=[],g=3;g<arguments.length;g++)t[g-3]=arguments[g];this.proxystate=v.NotConfigured;this.deferredActions=[];g=p.WebrpcClassLibInfoUtil.getMethodFeatureByid(b,0);this.hdxms.WSSendObjectWrapper(g,b,
0,e.WsJsonUtil.createMessageByid.apply(e.WsJsonUtil,[!1,!1,e.ws_msg_type_t.req,b,0,this.oid].concat(t))).then(function(b){n.logger.trace("ProxyObject: setting state to configured. (iid: "+d.iid+" oid: "+d.oid+")");var c=d.oid;d.proxystate=v.Configured;d.oid=d.param0(b);n.logger.log(d.user_friendly_id()+" assigned remote oid for local oid:"+c);d.onConnected();m.gc.trackObject(d,a)})["catch"](function(){d.proxystate=v.Error;d.onConnected()})};a.prototype.setParent=function(a){m.gc.setParent(this,a)};
a.prototype.release=function(){n.logger.log(this.user_friendly_id()+".release() called.");m.gc.releaseObject(this)};a.prototype.destroy=function(){n.logger.log(this.user_friendly_id()+".destroy() called.");this.proxystate=v.Destroyed;var a=p.WebrpcClassLibInfoUtil.getMethodFeatureByid(this.iid,0);this.hdxms.WSSendObjectWrapper(a,this.iid,0,e.WsJsonUtil.createMessageByid(!1,!0,e.ws_msg_type_t.req,this.iid,0,this.oid))};a.prototype.isdestroyed=function(){return this.proxystate==v.Destroyed};a.prototype.onConnected=
function(){for(;this.deferredActions&&0<this.deferredActions.length;)this.deferredActions.shift().post(this.proxystate==v.Configured)};a.prototype.isPseudo=function(){return this.mode==t.Pseudo};a.prototype.checkState=function(a,b){var c=this;0>=a?(n.logger.log("ProxyObject.checkState() timeout waiting for connection response! failed. (iid: "+c.iid+" oid: "+c.oid+")"),c.onConnected()):setTimeout(function(){if(c.proxystate==v.Configured)c.onConnected();else if(c.proxystate==v.Error)c.onConnected();
else if(c.proxystate==v.Destroyed)c.onConnected();else n.logger.log('ProxyObject.checkState(): count= "'+a+'". (iid: '+c.iid+" oid: "+c.oid+")"),c.checkState(--a,b)},b)};a.prototype.waitUntilConnected=function(a){var b=this;return new Promise(function(c,d){b?(n.logger.trace("ProxyObject.waitUntilConnected(): readyState="+b.proxystate+". (iid: "+b.iid+" oid: "+b.oid+")"),b.proxystate==v.Destroyed?(b.onConnected(),n.logger.trace("rejecting already destroyed Object:"+b.user_friendly_id()),d("Object already destroyed :"+
b.user_friendly_id())):b.proxystate==v.Configured?(b.onConnected(),c()):b.proxystate==v.Error?(n.logger.trace("ProxyObject.waitUntilConnected(): readyState="+b.proxystate+". (iid: "+b.iid+" oid: "+b.oid+")"),b.onConnected(),d()):(n.logger.log('ProxyObject.waitUntilConnected(): deferring action "'+a+'". (iid: '+b.iid+" oid: "+b.oid+")"),b.deferredActions.push(new l(c,d,a)),b.checkState(15,1E3))):d("Invalid Object")})};a.prototype.remoteInvoke=function(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-
2]=arguments[d];if(this.proxystate==v.Destroyed)return n.logger.trace("rejecting already destroyed Object:"+this.user_friendly_id()),Promise.reject("Cannot invoke destroyed object :"+this.user_friendly_id());if(this.proxystate==v.Error)return n.logger.trace("rejecting already error state Object:"+this.user_friendly_id()),Promise.reject("Cannot invoke object in Error state:"+this.user_friendly_id());d=p.WebrpcClassLibInfoUtil.getMethodFeatureByid(this.iid,b);return this.hdxms.WSSendObjectWrapper(d,
this.iid,b,e.WsJsonUtil.createMessageByid.apply(e.WsJsonUtil,[a,!1,e.ws_msg_type_t.req,this.iid,b,this.oid].concat(c)))};a.prototype.logRemoteInvokeError=function(a,b){var c=a;c?n.logger.log(this.user_friendly_id()+b+" with error: "+c.message):this.param0?(n.logger.log(this.user_friendly_id()+b+" with error: "+this.param0(a)),c=new DOMException(b+" with error: "+this.param0(a),this.user_friendly_id())):(n.logger.log(this.user_friendly_id()+b),c=new DOMException(b,this.user_friendly_id()));return c};
a.prototype.registerCallbacks=function(b,c,d){this.unregisterCallbacks(d);var g=a.nextcbid++,t=new k(g,c,b);c||(b||this.cbs.set(d,g),this.hdxms.registerHandler(this.iid,this.oid,t));return t};a.prototype.unregisterCallbacks=function(a){this.cbs.has(a)?(this.hdxms.unregisterHandler(this.iid,this.oid,this.cbs.get(a)),this.cbs["delete"](a)):n.logger.trace(this.cbs)};a.prototype.object_id=function(){return this.oid};a.prototype.param0=function(a){var b={};a&&a.params&&(b=a.params[0]);return b};a.prototype.isNullCallback=
function(a){return void 0==a||null==a};a.prototype.user_friendly_id=function(){return this.constructor.name+"["+this.oid+"]"};a.prototype.isRedirected=function(){return this.hdxms.isRedirected()};a.prototype.isValid=function(){return!(this.proxystate===v.Error||this.proxystate===v.Destroyed)};a.prototype.registerStateChangeNotification=function(a){this.hdxms.registerStateChangeNotification(a)};a.prototype.unregisterStateChangeNotification=function(a){this.hdxms.unregisterStateChangeNotification(a)};
a.nextId=0;a.nextcbid=0;return a}();a.ProxyObject=b},144:function(b,a,c){function d(a){for(var b=[],c=0;c<a.length;c++)b.push({oid:a[c].object_id()});return b}var n=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,
new d)}}(),e=this&&this.__awaiter||function(a,b,c,d){return new (c||(c=Promise))(function(f,y){function g(a){try{t(d.next(a))}catch(b){y(b)}}function h(a){try{t(d["throw"](a))}catch(b){y(b)}}function t(a){a.done?f(a.value):(new c(function(b){b(a.value)})).then(g,h)}t((d=d.apply(a,b||[])).next())})},m=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(y)throw new TypeError("Generator is already executing.");for(;f;)try{if(y=1,g&&(h=c[0]&2?g["return"]:
c[0]?g["throw"]||((h=g["return"])&&h.call(g),0):g.next)&&!(h=h.call(g,c[1])).done)return h;if(g=0,h)c=[c[0]&2,h.value];switch(c[0]){case 0:case 1:h=c;break;case 4:return f.label++,{value:c[1],done:!1};case 5:f.label++;g=c[1];c=[0];continue;case 7:c=f.ops.pop();f.trys.pop();continue;default:if(!(h=f.trys,h=0<h.length&&h[h.length-1])&&(6===c[0]||2===c[0])){f=0;continue}if(3===c[0]&&(!h||c[1]>h[0]&&c[1]<h[3]))f.label=c[1];else if(6===c[0]&&f.label<h[1])f.label=h[1],h=c;else if(h&&f.label<h[2])f.label=
h[2],f.ops.push(c);else{h[2]&&f.ops.pop();f.trys.pop();continue}}c=b.call(a,f)}catch(q){c=[6,q],g=0}finally{y=h=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var f={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},y,g,h,t;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return t={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t};Object.defineProperty(a,"__esModule",{value:!0});
var p=c(550),l=c(658),g=c(851),k=c(946),v=c(394),t;a.enumerateddecices=t;var z=function(){return function(a,b){this.type=a;this.target=b}}(),u=function(){function a(){this.is_local_clone=!1;this.clone_id=this.clone_count=0}a.prototype.clone=function(){this.clone_count++;var b=new a;b.is_local_clone=!0;b.clone_id=this.clone_count;return b};a.prototype.synchronize=function(a){return e(this,void 0,void 0,function(){return m(this,function(b){return this.is_local_clone?[2,a.asyncClone()]:[2,a]})})};return a}(),
f=function(a){function b(c,d){var f=a.call(this,c,p.class_id_t.MediaStreamTrack,d,l.ProxyMode.Remote)||this;f.refCount_=0;f.refCount_++;f.clone_state=new u;return f}n(b,a);b.prototype.dumpInfo=function(){g.logger.log(this.user_friendly_id()+".dumpInfo() [id="+this.id+"] kind="+this.kind+" label="+this.label+" refcount="+this.refcount)};Object.defineProperty(b.prototype,"refcount",{get:function(){return this.refCount_},enumerable:!0,configurable:!0});b.prototype.addRef=function(){this.refCount_++;
g.logger.log(this.user_friendly_id()+".addRef() called. [id="+this.id+"] refcount="+this.refCount_)};Object.defineProperty(b.prototype,"onended",{get:function(){g.logger.log(this.user_friendly_id()+".get_onended() called. [id="+this.id+"]");return this.onended_},set:function(a){var b=this;g.logger.log(this.user_friendly_id()+".set_onended() called. [id="+this.id+"]");this.onended_=a;this.waitUntilConnected("MediaStreamTrack.onended").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),
p.method_id_MediaStreamTrack_t.onended);c.then(function(a){g.logger.log(b.user_friendly_id()+"onended event received!!!");a=new z("ended",b);b.readyState_="ended";b.onended_(a)});return b.remoteInvoke(!0,p.method_id_MediaStreamTrack_t.onended,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".onended failed!")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onmute",{get:function(){g.logger.log(this.user_friendly_id()+".get_onmute() called. [id="+this.id+"]");return this.onmute_},
set:function(a){var b=this;g.logger.log(this.user_friendly_id()+".set_onmute() called. [id="+this.id+"]");this.onmute_=a;this.waitUntilConnected("MediaStreamTrack.onmute").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),p.method_id_MediaStreamTrack_t.onmute);c.then(function(a){g.logger.log(b.user_friendly_id()+"onmute event received!!!");a=new z("mute",b);b.muted=!0;b.onmute_(a)});return b.remoteInvoke(!0,p.method_id_MediaStreamTrack_t.onmute,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,
".onmute failed!")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onunmute",{get:function(){g.logger.log(this.user_friendly_id()+".get_onunmute() called. [id="+this.id+"]");return this.onunmute_},set:function(a){var b=this;g.logger.log(this.user_friendly_id()+".set_onunmute() called. [id="+this.id+"]");this.onunmute_=a;this.waitUntilConnected("MediaStreamTrack.onunmute").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),p.method_id_MediaStreamTrack_t.onunmute);
c.then(function(a){g.logger.log("onunmute event received!!!");a=new z("unmute",b);b.muted=!1;b.onunmute_(a)});return b.remoteInvoke(!0,p.method_id_MediaStreamTrack_t.onunmute,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".onunmute failed!")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onstop",{set:function(a){this.onstop_=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"enabled",{get:function(){g.logger.log(this.user_friendly_id()+".get_enabled() called. [id="+
this.id+", value="+this.enabled_+"]");return this.enabled_},set:function(a){g.logger.log(this.user_friendly_id()+".set_enabled() called. [id="+this.id+", value="+a+"]");this.enabled_=a;this.remoteInvoke(!0,p.method_id_MediaStreamTrack_t.enabled,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"readyState",{get:function(){g.logger.log(this.user_friendly_id()+".get_readyState() called. [id="+this.id+"]");return this.readyState_},enumerable:!0,configurable:!0});b.prototype.asyncClone=
function(){return e(this,void 0,void 0,function(){var a,c,d;return m(this,function(f){switch(f.label){case 0:return[4,this.waitUntilConnected("RemoteMediaTrack.asyncClone")];case 1:return f.sent(),[4,this.remoteInvoke(!1,p.method_id_MediaStreamTrack_t.clone,[])];case 2:return a=f.sent(),c=this.param0(a),d=new b(this,c.oid),[2,d.syncBarrier()]}})})};b.prototype.clone=function(){g.logger.log(this.user_friendly_id()+".clone() called. [id="+this.id+"]");var a=this.clone_state.clone(),c=new b(this,this.object_id());
c.id=this.id+"."+a.clone_id.toString();c.label=this.label;c.kind=this.kind;c.enabled_=this.enabled_;c.muted=this.muted;c.readyState_=this.readyState_;c.trackSettings_=this.trackSettings_;c.clone_state=a;c.constraints_=this.constraints_;c.capabilities_=this.capabilities_;return c};b.prototype.stop=function(){var a=this;g.logger.log(this.user_friendly_id()+".stop() called. [id="+this.id+"] refcount="+this.refCount_);this.readyState_="ended";if(0<this.refCount_&&(this.refCount_--,0===this.refCount_&&
(g.logger.log(this.user_friendly_id()+".stop() called. [id="+this.id+"] remote invoking..."),this.remoteInvoke(!1,p.method_id_MediaStreamTrack_t.stop)["catch"](function(b){a.logRemoteInvokeError(b,".stop failed!")}),"video"==this.kind&&"remoteapp-track"==this.label&&k.getRedirector().stopAppshare(),null!==this.onstop_&&void 0!=this.onstop_)))this.onstop_()};b.prototype.getCapabilities=function(){return this.capabilities_};b.prototype.getConstraints=function(){return this.constraints_};b.prototype.getSettings=
function(){return"audio"==this.kind?function(a){return{deviceId:a.deviceId,echoCancellation:a.echoCancellation}}(this.trackSettings_):function(a){return{aspectRatio:a.aspectRatio,deviceId:a.deviceId,frameRate:a.frameRate,height:a.height,width:a.width}}(this.trackSettings_)};b.prototype.applyConstraints=function(a){var b=this;g.logger.log(this.user_friendly_id()+".applyConstraints() called.");return new Promise(function(c,d){b.waitUntilConnected("MediaStreamTrack.applyConstraints").then(function(){return Promise.all([b.remoteInvoke(!1,
p.method_id_MediaStreamTrack_t.applyConstraints,a),b.syncBarrier()])})["catch"](function(){d({name:"OverconstrainedError",message:"Failed to apply constraints."})}).then(function(){b.constraints_=a;return b.remoteInvoke(!1,p.method_id_MediaStreamTrack_t.getConstraints)}).then(function(a){b.constraints_=b.param0(a)})["catch"](function(a){b.logRemoteInvokeError(a,".syncBarrier() remote client does not support getConstraints method. Ignore it")}).then(function(){return c()})})};b.convertReadyState=function(a){return 0==
a?"live":"ended"};b.prototype.syncBarrier=function(){var a=this;g.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(c,d){a.waitUntilConnected("MediaStreamTrack.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,p.method_id_MediaStreamTrack_t.kind,""),a.remoteInvoke(!1,p.method_id_MediaStreamTrack_t.id,""),a.remoteInvoke(!1,p.method_id_MediaStreamTrack_t.label,""),a.remoteInvoke(!1,p.method_id_MediaStreamTrack_t.enabled,!1),a.remoteInvoke(!1,
p.method_id_MediaStreamTrack_t.muted,!1),a.remoteInvoke(!1,p.method_id_MediaStreamTrack_t.readyState,0),a.remoteInvoke(!1,p.method_id_MediaStreamTrack_t.getSettings),a.remoteInvoke(!1,p.method_id_MediaStreamTrack_t.getCapabilities)])}).then(function(d){var f=0;d=d.map(function(b){return a.param0(b)});a.kind=d[0];a.id=d[1];a.label=d[2];a.enabled_=d[3];a.muted=d[4];f=d[5];a.trackSettings_=d[6];a.capabilities_=d[7];a.readyState_=b.convertReadyState(f);c(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,
".syncBarrier() failed!");d(b)})})};return b}(l.ProxyObject);a.RemoteMediaTrack=f;var A=function(){return function(){}}(),x=function(a){function b(c,f,g,t){void 0===g&&(g=l.ProxyMode.Local);void 0===t&&(t=[]);c=a.call(this,c,p.class_id_t.MediaStream,f,g,null,d(t))||this;c.clone_state=new u;c.tracks_=t;return c}n(b,a);b.prototype.dumpInfo=function(){g.logger.log(this.user_friendly_id()+".dumpInfo() [id="+this.id+"] active="+this.active_+" num tracks="+this.tracks_.length);for(var a=0,b=this.tracks_;a<
b.length;a++){var c=b[a];c&&c.dumpInfo()}};b.prototype.toggleAudio=function(a){g.logger.log(this.user_friendly_id()+".toggleAudio() called: "+a);for(var b=0,c=this.getAudioTracks();b<c.length;b++)c[b].enabled=a};b.prototype.toJSON=function(){var a=new A;a.id=this.id;a.active=this.active_;a.oid=this.object_id();return"RemoteStream:"+JSON.stringify(a)};Object.defineProperty(b.prototype,"active",{get:function(){g.logger.log(this.user_friendly_id()+".get active() called. [id="+this.id+"] active="+this.active_);
return this.active_},enumerable:!0,configurable:!0});b.prototype.getAudioTracks=function(){g.logger.log(this.user_friendly_id()+".getAudioTracks() called. [id="+this.id+"]");for(var a=[],b=0,c=this.tracks_;b<c.length;b++){var d=c[b];"audio"==d.kind&&a.push(d)}return a};b.prototype.getVideoTracks=function(){g.logger.log(this.user_friendly_id()+".getVideoTracks() called. [id="+this.id+"]");for(var a=[],b=0,c=this.tracks_;b<c.length;b++){var d=c[b];"video"==d.kind&&a.push(d)}return a};b.prototype.getTracks=
function(){g.logger.log(this.user_friendly_id()+".getTracks() called. [id="+this.id+"]");return this.tracks_};b.prototype.getTrackById=function(a){g.logger.log(this.user_friendly_id()+".getTrackById() called. [id="+this.id+"]");for(var b=0,c=this.tracks_;b<c.length;b++){var d=c[b];if(d.id==a)return d}};b.prototype.addTrack=function(a){var b=this;g.logger.log(this.user_friendly_id()+".addTrack() called. [id="+this.id+"]");this.tracks_.push(a);a&&a.dumpInfo();var c=this;this.waitUntilConnected("MediaStream.addTrack").then(function(){g.logger.log(c.user_friendly_id()+
".addTrack remote invoking");return c.remoteInvoke(!1,p.method_id_MediaStream_t.addTrack,{oid:a.object_id()})}).then(function(){g.logger.log(c.user_friendly_id()+".addTrack success")})["catch"](function(a){b.logRemoteInvokeError(a,".addTrack failed!")})};b.prototype.removeTrack=function(a){var b=this;g.logger.log(this.user_friendly_id()+".removeTrack() called. [id="+this.id+"]");var c=this.tracks_.indexOf(a);this.tracks_.splice(c,1);var d=this;this.waitUntilConnected("MediaStream.removeTrack").then(function(){g.logger.log(d.user_friendly_id()+
".removeTrack remote invoking");return d.remoteInvoke(!1,p.method_id_MediaStream_t.removeTrack,{oid:a.object_id()})}).then(function(){g.logger.log(d.user_friendly_id()+".removeTrack success")})["catch"](function(a){b.logRemoteInvokeError(a,".removeTrack failed!")})};b.prototype.asyncClone=function(){return e(this,void 0,void 0,function(){var a,c,d;return m(this,function(f){switch(f.label){case 0:return g.logger.log(this.user_friendly_id()+".asyncClone() called. [id="+this.id+"]"),[4,this.waitUntilConnected("asyncClone")];
case 1:return f.sent(),[4,this.remoteInvoke(!1,p.method_id_MediaStream_t.clone,[])];case 2:return a=f.sent(),console.log(a),c=this.param0(a),d=new b(this,c.oid,l.ProxyMode.Remote),[2,d.syncBarrier()]}})})};b.prototype.clone=function(){g.logger.log(this.user_friendly_id()+".clone() called. [id="+this.id+"]");var a=this.clone_state.clone(),c=new b(this,this.object_id(),l.ProxyMode.Remote);c.id=this.id+"."+a.clone_id.toString();this.tracks_.forEach(function(a){a.addRef()});c.tracks_=this.tracks_;c.clone_state=
a;return c};b.prototype.syncBarrier=function(){var a=this;g.logger.log(this.user_friendly_id()+".syncBarrier() called. [id="+this.id+"]");return new Promise(function(b,c){a.waitUntilConnected("MediaStream.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,p.method_id_MediaStream_t.id,""),a.remoteInvoke(!1,p.method_id_MediaStream_t.active,!1),a.remoteInvoke(!1,p.method_id_MediaStream_t.getTracks,[])])}).then(function(b){g.logger.log(a.user_friendly_id()+".syncBarrier() remote success");
b=b.map(function(b){return a.param0(b)});a.id=b[0];a.active_=b[1];b=b[2];for(var c=[],h=function(b){var h=a.tracks_.find(function(a){return a.object_id()===b.oid});void 0===h&&(g.logger.log(a.user_friendly_id()+" adding a RemoteMediaTrack with oid:"+b.oid),h=new f(a,b.oid));c.push(h.syncBarrier())},d=0;d<b.length;d++)h(b[d]);return Promise.all(c)}).then(function(c){a.tracks_=[];c.forEach(function(b){b.onstop=function(){var b=!0;a.tracks_.forEach(function(a){"ended"!=a.readyState&&(b=!1)});b&&a.release()};
a.tracks_.push(b)});b(a)})["catch"](function(b){a.logRemoteInvokeError(b,".syncBarrier failed!");c()})})};return b}(l.ProxyObject);a.RemoteStream=x;b=function(a){function b(c,d){return a.call(this,c,p.class_id_t.MediaStreamEvent,d,l.ProxyMode.Remote)||this}n(b,a);b.prototype.syncBarrier=function(){var a=this;g.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.waitUntilConnected("MediaStreamEvent.syncBarrier").then(function(){return a.remoteInvoke(!1,p.method_id_MediaStreamEvent_t.stream,
{oid:0})}).then(function(b){return(new x(a,b.params[0].oid,l.ProxyMode.Remote)).syncBarrier()}).then(function(c){a.stream=c;b(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier() failed!");c(b)})})};return b}(l.ProxyObject);a.RemoteStreamEvent=b;var D=function(a){function b(c){return a.call(this,null,p.class_id_t.MediaDeviceInfo,c,l.ProxyMode.Remote)||this}n(b,a);b.prototype.convertKind=function(a){return 0==a?"audioinput":1==a?"audiooutput":"videoinput"};b.prototype.syncBarrier=function(){var a=
this;g.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.waitUntilConnected("RemoteDeviceInfo.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,p.method_id_MediaDeviceInfo_t.deviceId,""),a.remoteInvoke(!1,p.method_id_MediaDeviceInfo_t.kind,0),a.remoteInvoke(!1,p.method_id_MediaDeviceInfo_t.label,""),a.remoteInvoke(!1,p.method_id_MediaDeviceInfo_t.groupId,"")])}).then(function(c){a.kind=a.convertKind(a.param0(c.splice(1,1)[0]));c=c.map(function(b){return a.param0(b)});
a.deviceId=c[0];a.label=c[1];a.groupId=c[2];b(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier() failed!");c(b)})})};return b}(l.ProxyObject);a.RemoteDeviceInfo=D;b=function(b){function c(){var a=b.call(this,null,p.class_id_t.MediaDevices,0,l.ProxyMode.Local,function(){a.setDeviceChangeCallback()})||this;a.devices_=[];a.pendingEnumerateDevice_=[];return a}n(c,b);Object.defineProperty(c.prototype,"panelid",{set:function(a){this.panelid_=a},enumerable:!0,configurable:!0});c.prototype.clearPanelId=
function(){this.panelid_=-1};c.prototype.enumerateDevices=function(){var a=this;return 0<this.devices_.length&&0==this.pendingEnumerateDevice_.length?new Promise(function(b,c){g.logger.log(a.user_friendly_id()+".enumerateDevices: returning cached devices with ids ["+a.devices_.map(function(a){return a.object_id()})+"]");b(a.devices_)}):this.enumerateDevicesPrivate(!1)};c.prototype.postEnumerateDevicesResult=function(){for(var a=!0,b=0,c=0,d=this.pendingEnumerateDevice_;c<d.length;c++){var f=d[c];
if(0==a&&"enumerateDevicesPrivate-remote"==f.name)break;f.postWithResult(!0,this.devices_);b++;a=!1}0<b&&this.pendingEnumerateDevice_.splice(0,b)};c.prototype.enumerateDevicesPrivate=function(b){var c=this;g.logger.log(this.user_friendly_id()+".enumerateDevicesPrivate() called. refresh:"+b+" pending:"+this.pendingEnumerateDevice_.length);return new Promise(function(d,f){1==b||0==c.pendingEnumerateDevice_.length?(c.pendingEnumerateDevice_.push(new l.deferred_action(d,f,"enumerateDevicesPrivate-remote")),
c.waitUntilConnected("RemoteDevices.enumerateDevicesPrivate").then(function(){g.logger.log(c.user_friendly_id()+".enumerateDevicesPrivate() remote invoking...");return c.remoteInvoke(!1,p.method_id_MediaDevices_t.enumerateDevices,[])}).then(function(a){var b=[];a.params[0].forEach(function(a){var d=c.devices_.find(function(b){return b.object_id()===a.oid});void 0===d?(d=new D(a.oid),b.push(d.syncBarrier())):b.push(d)});return Promise.all(b)}).then(function(b){c.devices_.forEach(function(a){for(var c=
!0,d=0;d<b.length;d++){var q=b[d];if(a.object_id()===q.object_id()){c=!1;break}}c&&a.release()});c.devices_=b;a.enumerateddecices=t=b;g.logger.log(c.user_friendly_id()+".enumerateDevicesPrivate: resolving enumerated devices with ids ["+b.map(function(a){return a.object_id()})+"]");c.postEnumerateDevicesResult()})["catch"](function(b){c.devices_=[];a.enumerateddecices=t=[];c.logRemoteInvokeError(b,".enumerateDevicesPrivate() failed, resolving with empty list.");c.postEnumerateDevicesResult()})):(c.pendingEnumerateDevice_.push(new l.deferred_action(d,
f,"enumerateDevicesPrivate")),g.logger.log(c.user_friendly_id()+".enumerateDevicesPrivate() not remoting this call..."))})};c.prototype.getDisplayMedia=function(a){var b=this;return new Promise(function(c,d){b.waitUntilConnected("RemoteDevices.getDisplayMedia").then(function(){return b.IsPanelIdValid()}).then(function(){void 0!==a.video&&null!==a.video&&void 0!==b.panelid_&&(a.video.deviceId=b.panelid_);var c=b.prepareDisplayConstraints(a);return b.remoteInvoke(!1,p.method_id_MediaDevices_t.getDisplayMedia,
c)}).then(function(a){return(new x(null,a.params[0].oid,l.ProxyMode.Remote)).syncBarrier()}).then(function(a){c(a)})["catch"](function(a){a=b.logRemoteInvokeError(a,".getDisplayMedia() failed!");d(a)})})};c.prototype.setDeviceChangeCallback=function(){var a=this;g.logger.log(this.user_friendly_id()+".set_DeviceChangeCallback() called.");this.waitUntilConnected("MediaDevices.ondevicechange").then(function(){var b=a.registerCallbacks(!1,!1,p.method_id_MediaDevices_t.ondevicechange);b.then(function(){g.logger.log(a.user_friendly_id()+
".ondevicechange(): callback received!!!");a.enumerateDevicesPrivate(!0).then(function(){navigator.mediaDevices.dispatchEvent(new CustomEvent("devicechange"))})["catch"](function(){navigator.mediaDevices.dispatchEvent(new CustomEvent("devicechange"))})});return a.remoteInvoke(!0,p.method_id_MediaDevices_t.ondevicechange,b.success)})["catch"](function(b){a.logRemoteInvokeError(b,".set_ondevicechange() failed!")})};c.prototype.prepareDisplayConstraints=function(a){if(k.getRedirector().getFeatureValue(p.FEATURE_ms_teams_common_media_constraints))return a;
var b={frameRate:15,width:{max:1920},height:{max:1080}};void 0!==a.video&&null!==a.video&&(a=a.video,void 0!==a.frameRate&&void 0!==a.width&&void 0!==a.height&&(b.frameRate=a.frameRate,b.width.max=a.width.max||a.width,b.height.max=a.height.max||a.height));return{video:b}};c.prototype.IsPanelIdValid=function(){var a=this;return new Promise(function(b,c){if(-1!==a.panelid_)g.logger.log(a.user_friendly_id()+".IsPanelIdValid() resolving with panelid_:"+a.panelid_),b();else var d=0,f=setInterval(function(){g.logger.log(a.user_friendly_id()+
".IsPanelIdValid() waiting panelid_:"+a.panelid_);50<=d?(c(),clearInterval(f),g.logger.log(a.user_friendly_id()+".IsPanelIdValid(): PanelId is invalid.")):(++d,-1!=a.panelid_&&(b(),clearInterval(f),g.logger.log(a.user_friendly_id()+".IsPanelIdValid(): PanelId is valid.")))},10)})};return c}(l.ProxyObject);a.RemoteDevices=b;b=function(a){function b(){return a.call(this,null,p.class_id_t.NavigatorUserMedia,0,l.ProxyMode.Local)||this}n(b,a);b.getCapabilities=function(a){g.logger.log(this.constructor.name+
".getCapabilities() called:"+a+" caps:"+b.caps_);return b.caps_[a]};b.resetcaps=function(){b.caps_={}};b.prototype.getCapabilities=function(){var a=this;g.logger.log(this.user_friendly_id()+".getCapabilities() called: ");return new Promise(function(c,d){a.waitUntilConnected(a.user_friendly_id()+".getCapabilities").then(function(){return Promise.all([a.remoteInvoke(!1,p.method_id_NavigatorUserMedia_t.getCapabilities,"audio"),a.remoteInvoke(!1,p.method_id_NavigatorUserMedia_t.getCapabilities,"video")])}).then(function(d){b.caps_.audio=
a.param0(d[0]);b.caps_.video=a.param0(d[1]);c(b.caps_)})["catch"](function(b){b=a.logRemoteInvokeError(b,".getCapabilities() failed!");d(b)})})};b.prototype.setCodecCapabilities=function(a){var b=this;g.logger.log(this.user_friendly_id()+".setCodecCapabilities : set codecCapabilities to "+JSON.stringify(a));return new Promise(function(c,d){b.waitUntilConnected("NavigatorUserMedia.setCodecCapabilities").then(function(){return b.remoteInvoke(!1,p.method_id_NavigatorUserMedia_t.setCodecCapabilities,
a)}).then(function(){g.logger.log(b.user_friendly_id()+".setCodecCapabilities() success.");c(!0);b.getCapabilities()})["catch"](function(a){a=b.logRemoteInvokeError(a,".setCodecCapabilities() failed!");d(a)})})};b.prototype.webkitGetUserMedia=function(a,b,c){return this.getUserMedia(a,b,c)};b.prototype.LogTelemetryDevice_=function(a){try{if("undefined"!==typeof a.audio){var b=a.audio.deviceId,c;t.forEach(function(a){b==a.deviceId&&(c=a.label)});g.logger.log(c);this.SendTelemetryData(v.tel_key_AudioDeviceUsed,
c,0)}if("undefined"!==typeof a.video){var d=a.video.mandatory.sourceId,f;t.forEach(function(a){d==a.deviceId&&(f=a.label)});g.logger.log(f);this.SendTelemetryData(v.tel_key_VideoDeviceUsed,f,0)}}catch(h){g.logger.log(h)}};b.prototype.getUserMedia=function(a,b,c){g.logger.log(this.user_friendly_id()+".getUserMedia() called: "+JSON.stringify(a));return b&&c?this.getUserMedia_v1(a,b,c):this.getUserMedia_v2(a)};b.prototype.getUserMedia_v2=function(a){var b=this;g.logger.log(this.user_friendly_id()+".getUserMedia_v2() called: "+
JSON.stringify(a));return new Promise(function(c,d){b.getUserMediaPrivate(a,function(a){g.logger.log(b.user_friendly_id()+"getUserMedia_v2: resolving stream");c(a)},function(a){g.logger.log(b.user_friendly_id()+"getUserMedia_v2: rejecting stream");d(a)})})};b.prototype.getUserMedia_v1=function(a,b,c){g.logger.log(this.user_friendly_id()+".getUserMedia_v1() called: "+JSON.stringify(a));return this.getUserMediaPrivate(a,b,c)};b.prototype.getUserMediaPrivate=function(a,b,c){var d=this;this.waitUntilConnected("NavigatorUserMedia.getUserMediaPrivate").then(function(){var b=
d.registerCallbacks(!0,!1,p.method_id_NavigatorUserMedia_t.getUserMedia);a&&"undefined"!==typeof a.audio&&0==Object.keys(a.audio).length&&(a.audio={dummy:1});if(a&&"undefined"!==typeof a.video){var c=a.video;void 0==c.mandatory.maxFrameRate&&(c.mandatory.maxFrameRate=30);void 0==c.mandatory.minWidth&&(c.mandatory.minWidth=360);void 0==c.mandatory.maxWidth&&(c.mandatory.maxWidth=1920);void 0==c.mandatory.minHeight&&(c.mandatory.minHeight=180);void 0==c.mandatory.maxHeight&&(c.mandatory.maxHeight=1080)}d.remoteInvoke(!1,
p.method_id_NavigatorUserMedia_t.getUserMedia,a,b.success,b.fail);return b.prom()}).then(function(a){g.logger.log(d.user_friendly_id()+".getUserMediaPrivate: received success callback!");return(new x(null,d.param0(a).oid,l.ProxyMode.Remote)).syncBarrier()}).then(function(f){g.logger.log(d.user_friendly_id()+".getUserMediaPrivate: MediaStream ready to deliver",JSON.stringify(f));0==f.getTracks().length?(g.logger.log(d.user_friendly_id()+".getUserMediaPrivate: reporting no tracks as error."),c({constraintName:"",
name:"OverconstrainedError",message:""})):(d.LogTelemetryDevice_(a),b(f))})["catch"](function(a){d.logRemoteInvokeError(a,".getUserMediaPrivate() failed!");k.getRedirector().getFeatureValue(p.FEATURE_ms_teams_1912)?d.param0&&a?c(d.param0(a)):c({constraintName:"",name:"OverconstrainedError",message:""}):c({constraintName:"",name:"OverconstrainedError",message:""})})};b.prototype.SendTelemetryData=function(a,b,c){k.getRedirector().telemetry.SendTelemetryData(v.tel_cmd.Data,a,b,c)};b.caps_={};return b}(l.ProxyObject);
a.NavigatorUserMedia=b},650:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});var d=c(946),n=c(550),e=c(9),m=c(851),p=c(550),l=c(394),g;(function(a){a[a.Unknown=0]="Unknown";a[a.Windows=1]="Windows";a[a.Linux=2]="Linux"})(g=a.RemoteType||(a.RemoteType={}));var k=function(){return function(){}}();a.SessionInfo=k;b=function(){function a(){var b=this;this.isremote_=!1;this.isremote_=!0;this.type_=g.Windows;this.address_="0.0.0.0";this.sessioninfo_=null;d.getRedirector().setRemoteSessionInfoCb(function(){return b.remoteSessionInfo()});
this.enginecontrol_=new e.EngineControl}a.prototype.release=function(){d.getRedirector().setRemoteSessionInfoCb(null)};a.prototype.user_friendly_id=function(){return"[RemoteSession]"};a.prototype.getFeatureFlags=function(){var a={};null!==this.enginecontrol_&&null!==this.enginecontrol_.features_&&void 0!==this.enginecontrol_.features_&&this.enginecontrol_.features_.forEach(function(b){a[b.name]=b.value});return a};a.prototype.isFeatureSupported=function(a){if("video"===a)return!0;if(!(a in p.featureNameMap))return!1;
a=p.featureNameMap[a];for(var b=this.getFeatureFlags(),c=0;c<a.length;c++)if(!(a[c]in b)||!0!==b[a[c]])return!1;return!0};a.isFeaturePstnSupported=function(){return a.pstn_};a.isFeatureDtmfSupported=function(){return a.dtmfswitch_};a.isFeaturAppshareSupported=function(){return a.appshare_};a.isFeatureWebrtc1dot0Supported=function(){return a.webrtc1dot0_};a.isFeatureDataChannelSupported=function(){return a.datachannel_};a.isFeatureVdNoBufferLimitSupported=function(){return a.vdnobuflimit_};a.prototype.getSessionInfo=
function(){m.logger.log(this.user_friendly_id()+".getSessionInfo() called.");return null!=this.sessioninfo_?Promise.resolve(this.sessioninfo_):Promise.reject()};a.prototype.remoteSessionInfo=function(){var b=this,c=this;m.logger.log(c.user_friendly_id()+".remoteSessionInfo() called.");return new Promise(function(g,f){c.enginecontrol_.syncBarrier().then(function(d){m.logger.log(c.user_friendly_id()+"enginecontrol info received!");c.sessioninfo_=new k;c.sessioninfo_.type_script=n.HDXMS_VERSION;c.sessioninfo_.webrpc=
d.version_.major.toString()+"."+d.version_.minor.toString()+"."+d.version_.revision.toString()+"."+d.version_.build.toString();if(void 0!=d.versions_&&null!=d.versions_){c.SendTelemetryData(l.tel_key_VerTypeScript,n.HDXMS_VERSION,0);for(var f=0,p=0,C=d.versions_;p<C.length;p++){var r=C[p],r=r.major.toString()+"."+r.minor.toString()+"."+r.revision.toString()+"."+r.build.toString();switch(f){case e.VersionType.Webrpc:c.sessioninfo_.webrpc=r;c.SendTelemetryData(l.tel_key_VerWebrpc,r,0);break;case e.VersionType.WebrtcCodecs:c.sessioninfo_.webrtc_codecs=
r;c.SendTelemetryData(l.tel_key_VerWebrtcCodecs,r,0);break;case e.VersionType.Receiver:c.sessioninfo_.receiver=r;c.SendTelemetryData(l.tel_key_VerReceiver,r,0);break;case e.VersionType.Vda:c.sessioninfo_.vda=r;c.SendTelemetryData(l.tel_key_VerVda,r,0);break;case e.VersionType.Endpoint:c.sessioninfo_.endpoint=r;c.SendTelemetryData(l.tel_key_VerEndpoint,r,0);break;default:m.logger.log(c.user_friendly_id()+"Unknown version type!")}f++}}void 0!=d.osinfo_&&null!=d.osinfo_&&(c.sessioninfo_.osinfo=d.osinfo_,
d.osinfo_.family.includes("Darwin")&&d.osinfo_.edition.includes("Mac")?c.sessioninfo_.clientPlatform="Mac":c.sessioninfo_.clientPlatform=d.osinfo_.family,c.SendTelemetryData(l.tel_key_OSFamily,d.osinfo_.family,0),c.SendTelemetryData(l.tel_key_OSVersion,d.osinfo_.version,0),c.SendTelemetryData(l.tel_key_OSArchitecture,d.osinfo_.architecture,0),c.SendTelemetryData(l.tel_key_OSDistro,d.osinfo_.distro,0),c.SendTelemetryData(l.tel_key_OSEdition,d.osinfo_.edition,0));void 0!=d.endpointid_&&null!=d.endpointid_&&
(c.sessioninfo_.endpointId=d.endpointid_.machine_id);a.pstn_=b.isFeatureSupported(n.Features.FEATURE_public_pstn);a.dtmfswitch_=b.isFeatureSupported(n.Features.FEATURE_public_dtmf);a.appshare_=b.isFeatureSupported(n.Features.FEATURE_public_app_sharing);a.webrtc1dot0_=b.isFeatureSupported(n.Features.FEATURE_public_webrtc1dot0);a.datachannel_=b.isFeatureSupported(n.Features.FEATURE_public_data_channel);a.vdnobuflimit_=b.isFeatureSupported(n.Features.FEATURE_public_vdnobuflimit);g(c.sessioninfo_);c.enginecontrol_.release()})["catch"](function(){d.getRedirector().isPingActive()?
c.retrySessionInfo():(f(),c.enginecontrol_.release(),c.enginecontrol_=null)})})};a.prototype.retrySessionInfo=function(){var a=this;setTimeout(function(){m.logger.log("checking if we are connected...");a.enginecontrol_.bind();d.getRedirector().handleRemoteSessionInfo()},15E3)};a.prototype.SendTelemetryData=function(a,b,c){d.getRedirector().telemetry.SendTelemetryData(l.tel_cmd.Data,a,b,c)};a.pstn_=!1;a.dtmfswitch_=!1;a.appshare_=!1;a.webrtc1dot0_=!1;a.datachannel_=!1;a.vdnobuflimit_=!1;return a}();
a.RemoteSession=b},24:function(b,a,c){var d=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(a,"__esModule",{value:!0});var n=c(658),e=c(550),m=c(851),p=c(589),l;(function(a){a[a["new"]=
0]="new";a[a.connecting=1]="connecting";a[a.connected=2]="connected";a[a.closed=3]="closed";a[a.max=4]="max"})(l||(l={}));b=function(a){function b(c,d){var g=a.call(this,c,e.class_id_t.RTCSctpTransport,d,n.ProxyMode.Remote)||this;m.logger.log(g.user_friendly_id()+".constructor");return g}d(b,a);b.prototype.syncBarrier=function(){var a=this;m.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.waitUntilConnected("RTCSctpTransport.syncBarrier").then(function(){m.logger.log(a.user_friendly_id()+
".syncBarrierBase success.");return Promise.all([a.remoteInvoke(!1,e.method_id_RTCSctpTransport_t.transport,{}),a.remoteInvoke(!1,e.method_id_RTCSctpTransport_t.state,""),a.remoteInvoke(!1,e.method_id_RTCSctpTransport_t.maxMessageSize,0),a.remoteInvoke(!1,e.method_id_RTCSctpTransport_t.maxChannels,0)])}).then(function(c){var d;d=c.map(function(b){return a.param0(b)});c=d[0];a.sctpstate_=d[1];a.maxMessageSize_=d[2];a.maxChannels_=d[3];d=a.transport_;void 0==c||!1!==c.is_null||null!==a.transport_&&
a.transport_.object_id()==c.oid||(d=new p.DtlsTransport(a,c.oid));d.syncBarrier().then(function(c){m.logger.log(a.user_friendly_id()+"transport.syncBarrier(): success");a.transport_=c;b(a)})["catch"](function(){m.logger.log(a.user_friendly_id()+"transport.syncBarrier(): failed!");a.transport_=null;b(a)})})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier() failed!");c(b)})})};Object.defineProperty(b.prototype,"transport",{get:function(){m.logger.log(this.user_friendly_id()+".get_transport() called: "+
this.transport_);return this.transport_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"state",{get:function(){m.logger.log(this.user_friendly_id()+".get_state() called: "+this.sctpstate_);return this.sctpstate_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"maxMessageSize",{get:function(){m.logger.log(this.user_friendly_id()+".get_maxMessageSize() called: "+this.maxMessageSize_);return this.maxMessageSize_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"maxChannels",{get:function(){m.logger.log(this.user_friendly_id()+".get_maxChannels() called: "+this.maxChannels_);return this.maxChannels_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onstatechange",{get:function(){m.logger.log(this.user_friendly_id()+".get_onstatechange() called: "+this.onstatechange_);return this.onstatechange_},set:function(a){var c=this;m.logger.log(this.user_friendly_id()+".set_onstatechange() called.");this.onstatechange_=a;this.waitUntilConnected(this.user_friendly_id()+
".onstatechange").then(function(){var d=c.registerCallbacks(!1,c.isNullCallback(a),e.method_id_RTCSctpTransport_t.onstatechange);d.then(function(a){m.logger.log(c.user_friendly_id()+".onstatechange callback received!!!");c.sctpstate_=b.convertState(c.param0(a));m.logger.log(c.user_friendly_id()+"sctpstate_: "+c.sctpstate_);a=new Event("onstatechange");c.onstatechange_(a)});return c.remoteInvoke(!0,e.method_id_RTCSctpTransport_t.onstatechange,d.success)})["catch"](function(){m.logger.log(c.user_friendly_id()+
".onstatechange() failed.")})},enumerable:!0,configurable:!0});b.convertState=function(a){return a==l["new"]?"closed":a==l.connecting?"connecting":a==l.connected?"connected":"closed"};return b}(n.ProxyObject);a.RTCSctpTransport=b;var g;(function(a){a[a.connecting=0]="connecting";a[a.open=1]="open";a[a.closing=2]="closing";a[a.closed=3]="closed"})(g||(g={}));b=function(a){function b(c,d,g){c=a.call(this,c,e.class_id_t.RTCDataChannel,d,g)||this;c.binaryType_="blob";m.logger.log(c.user_friendly_id()+
".constructor");return c}d(b,a);b.prototype.syncBarrier=function(){var a=this;m.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.waitUntilConnected("RtcDataChannel.syncBarrier").then(function(){m.logger.log(a.user_friendly_id()+".syncBarrier remote invoking.");return Promise.all([a.remoteInvoke(!1,e.method_id_RTCDataChannel_t.label,""),a.remoteInvoke(!1,e.method_id_RTCDataChannel_t.ordered,!0),a.remoteInvoke(!1,e.method_id_RTCDataChannel_t.maxPacketLifeTime,
0),a.remoteInvoke(!1,e.method_id_RTCDataChannel_t.maxRetransmits,0),a.remoteInvoke(!1,e.method_id_RTCDataChannel_t.protocol,""),a.remoteInvoke(!1,e.method_id_RTCDataChannel_t.negotiated,!1),a.remoteInvoke(!1,e.method_id_RTCDataChannel_t.id,0),a.remoteInvoke(!1,e.method_id_RTCDataChannel_t.readyState,""),a.remoteInvoke(!1,e.method_id_RTCDataChannel_t.bufferedAmount,0),a.remoteInvoke(!1,e.method_id_RTCDataChannel_t.bufferedAmountLowThreshold,0)])}).then(function(c){m.logger.log(a.user_friendly_id()+
".syncBarrier success.");var d;c=c.map(function(b){return a.param0(b)});a.label_=c[0];a.ordered_=c[1];a.maxPacketLifeTime_=c[2];a.maxRetransmits_=c[3];a.protocol_=c[4];a.negotiated_=c[5];a.id_=c[6];d=c[7];a.bufferedAmount_=c[8];a.bufferedAmountLowThreshold_=c[9];a.readyState_=a.toRTCDataChannelState(d);b(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier() failed!");c(b)})})};Object.defineProperty(b.prototype,"label",{get:function(){m.logger.log(this.user_friendly_id()+".get_label() called: "+
this.label_);return this.label_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"ordered",{get:function(){m.logger.log(this.user_friendly_id()+".get_ordered() called: "+this.ordered_);return this.ordered_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"maxPacketLifeTime",{get:function(){m.logger.log(this.user_friendly_id()+".get_maxPacketLifeTime() called: "+this.maxPacketLifeTime_);return this.maxPacketLifeTime_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"maxRetransmits",{get:function(){m.logger.log(this.user_friendly_id()+".get_maxRetransmits() called: "+this.maxRetransmits_);return this.maxRetransmits_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"protocol",{get:function(){m.logger.log(this.user_friendly_id()+".get_protocol() called: "+this.protocol_);return this.protocol_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"negotiated",{get:function(){m.logger.log(this.user_friendly_id()+".get_negotiated() called: "+
this.negotiated_);return this.negotiated_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"id",{get:function(){m.logger.log(this.user_friendly_id()+".get_id() called: "+this.id_);return this.id_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"readyState",{get:function(){m.logger.log(this.user_friendly_id()+".get_readyState() called: "+this.readyState_);return this.readyState_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"bufferedAmount",
{get:function(){m.logger.log(this.user_friendly_id()+".get_bufferedAmount() called: "+this.bufferedAmount_);return this.bufferedAmount_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"bufferedAmountLowThreshold",{get:function(){m.logger.log(this.user_friendly_id()+".get_bufferedAmountLowThreshold() called: "+this.bufferedAmountLowThreshold_);return this.bufferedAmountLowThreshold_},set:function(a){m.logger.log(this.user_friendly_id()+".get_bufferedAmountLowThreshold() called: "+
a);this.bufferedAmountLowThreshold_=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"binaryType",{get:function(){m.logger.log(this.user_friendly_id()+".get_binaryType() called: "+this.binaryType_);return this.binaryType_},set:function(a){m.logger.log(this.user_friendly_id()+".set_binaryType() called: "+a);this.binaryType_="blob"==a||"arraybuffer"==a?a:"blob"},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onopen",{get:function(){m.logger.log(this.user_friendly_id()+
".get_onopen() called.");return this.onopen_},set:function(a){var b=this;m.logger.log(this.user_friendly_id()+".set_onopen() called.");this.onopen_=a;this.waitUntilConnected(this.user_friendly_id()+".onopen").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),e.method_id_RTCDataChannel_t.onopen);c.then(function(a){m.logger.log(b.user_friendly_id()+".onopen callback received!!!");b.syncBarrier().then(function(){m.logger.log(b.user_friendly_id()+".onopen notifying...");var a=new Event("open",
{});Object.defineProperty(a,"target",{writable:!1,value:b});b.onopen_(a)})["catch"](function(){m.logger.log(b.user_friendly_id()+".syncBarrier(): failed!")})});return b.remoteInvoke(!0,e.method_id_RTCDataChannel_t.onopen,c.success)})["catch"](function(){m.logger.log(b.user_friendly_id()+".onopen() failed.")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onbufferedamountlow",{get:function(){m.logger.log(this.user_friendly_id()+".get_onbufferedamountlow() called.");return this.onbufferedamountlow_},
set:function(a){var b=this;m.logger.log(this.user_friendly_id()+".set_onbufferedamountlow() called.");this.onbufferedamountlow_=a;this.waitUntilConnected(this.user_friendly_id()+".onbufferedamountlow").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),e.method_id_RTCDataChannel_t.onbufferedamountlow);c.then(function(a){m.logger.log(b.user_friendly_id()+".onbufferedamountlow callback received!!!");a=new Event("onbufferedamountlow");Object.defineProperty(a,"target",{writable:!1,value:b});
b.onbufferedamountlow_(a)});return b.remoteInvoke(!0,e.method_id_RTCDataChannel_t.onbufferedamountlow,c.success)})["catch"](function(){m.logger.log(b.user_friendly_id()+".onbufferedamountlows() failed.")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onerror",{get:function(){m.logger.log(this.user_friendly_id()+".get_onerror() called.");return this.onerror_},set:function(a){var b=this;m.logger.log(this.user_friendly_id()+".set_onerror() called.");this.onerror_=a;this.waitUntilConnected(this.user_friendly_id()+
".onerror").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),e.method_id_RTCDataChannel_t.onerror);c.then(function(a){m.logger.log(b.user_friendly_id()+".onerror callback received!");a=b.param0(a);m.logger.log(b.user_friendly_id()+"error: "+a);a=new Event("onerror");Object.defineProperty(a,"target",{writable:!1,value:b});b.onerror_(a)});return b.remoteInvoke(!0,e.method_id_RTCDataChannel_t.onerror,c.success)})["catch"](function(){m.logger.log(b.user_friendly_id()+".onerror() failed.")})},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onclosing",{get:function(){m.logger.log(this.user_friendly_id()+".get_onclosing() called.");return this.onclosing_},set:function(a){var b=this;m.logger.log(this.user_friendly_id()+".set_onclosing() called.");this.onclosing_=a;this.waitUntilConnected(this.user_friendly_id()+".onclosing").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),e.method_id_RTCDataChannel_t.onclosing);c.then(function(a){m.logger.log(b.user_friendly_id()+
".onclosing callback received!!!");a=new Event("onclosing");Object.defineProperty(a,"target",{writable:!1,value:b});b.onclosing_(a)});return b.remoteInvoke(!0,e.method_id_RTCDataChannel_t.onclosing,c.success)})["catch"](function(){m.logger.log(b.user_friendly_id()+".onclosing() failed.")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onclose",{get:function(){m.logger.log(this.user_friendly_id()+".get_onclose() called.");return this.onclose_},set:function(a){var b=this;m.logger.log(this.user_friendly_id()+
".set_onclose() called.");this.onclose_=a;this.waitUntilConnected(this.user_friendly_id()+".onclose").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),e.method_id_RTCDataChannel_t.onclose);c.then(function(a){m.logger.log(b.user_friendly_id()+".onclose callback received!!!");a=new Event("onclose");Object.defineProperty(a,"target",{writable:!1,value:b});b.onclose_(a)});return b.remoteInvoke(!0,e.method_id_RTCDataChannel_t.onclose,c.success)})["catch"](function(){m.logger.log(b.user_friendly_id()+
".onclose() failed.")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onmessage",{get:function(){m.logger.log(this.user_friendly_id()+".get_onmessage() called.");return this.onmessage_},set:function(a){var b=this;m.logger.log(this.user_friendly_id()+".set_onmessage() called.");this.onmessage_=a;this.waitUntilConnected(this.user_friendly_id()+".onmessage").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),e.method_id_RTCDataChannel_t.onmessage);c.then(function(a){m.logger.log(b.user_friendly_id()+
".onmessage callback received!!!");var c=b.param0(a);a=new Event("onmessage");c.binary?a.data=c.data_ab:(c=atob(c.data_sz),a.data=c);b.onmessage_(a)});return b.remoteInvoke(!0,e.method_id_RTCDataChannel_t.onmessage,c.success)})["catch"](function(){m.logger.log(b.user_friendly_id()+".onmessage() failed.")})},enumerable:!0,configurable:!0});b.prototype.close=function(){var a=this;m.logger.log(this.user_friendly_id()+".close() called.");this.waitUntilConnected("RTCDataChannel.close").then(function(){return a.remoteInvoke(!1,
e.method_id_RTCDataChannel_t.close)}).then(function(){m.logger.log(a.user_friendly_id()+".close: success.")})["catch"](function(){m.logger.log(a.user_friendly_id()+".close: failed.")})};b.prototype.toByteArray=function(a){var b=[];a=new Uint8Array(a instanceof ArrayBuffer?a:a.buffer);for(var c in a)b.push(a[c]);return b};b.prototype.send=function(a){var b=this;m.logger.log(this.user_friendly_id()+".send() called.");this.waitUntilConnected("RTCDataChannel.send").then(function(){if("string"===typeof a)return m.logger.log(b.user_friendly_id()+
"data(string): "+a),b.remoteInvoke(!1,e.method_id_RTCDataChannel_t.send_text,a);if(a instanceof Blob)a.arrayBuffer().then(function(a){a=b.toByteArray(a);return b.remoteInvoke(!1,e.method_id_RTCDataChannel_t.send_binary,a)})["catch"](function(){m.logger.log(b.user_friendly_id()+".arrayBuffer(): failed.")});else{var c=b.toByteArray(a);return b.remoteInvoke(!1,e.method_id_RTCDataChannel_t.send_binary,c)}}).then(function(){m.logger.log(b.user_friendly_id()+".send: success.")})["catch"](function(){m.logger.log(b.user_friendly_id()+
".send: failed.")})};b.prototype.toRTCDataChannelState=function(a){var b="closed";a==g.connecting?b="connecting":a==g.open?b="open":a==g.closing?b="closing":a==g.closed&&(b="closed");return b};return b}(n.ProxyObject);a.RtcDataChannel=b},589:function(b,a,c){var d=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__awaiter||function(a,b,c,d){return new (c||(c=Promise))(function(f,g){function e(a){try{n(d.next(a))}catch(b){g(b)}}function h(a){try{n(d["throw"](a))}catch(b){g(b)}}function n(a){a.done?f(a.value):(new c(function(b){b(a.value)})).then(e,h)}n((d=d.apply(a,b||[])).next())})},k=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");
for(;f;)try{if(g=1,e&&(h=c[0]&2?e["return"]:c[0]?e["throw"]||((h=e["return"])&&h.call(e),0):e.next)&&!(h=h.call(e,c[1])).done)return h;if(e=0,h)c=[c[0]&2,h.value];switch(c[0]){case 0:case 1:h=c;break;case 4:return f.label++,{value:c[1],done:!1};case 5:f.label++;e=c[1];c=[0];continue;case 7:c=f.ops.pop();f.trys.pop();continue;default:if(!(h=f.trys,h=0<h.length&&h[h.length-1])&&(6===c[0]||2===c[0])){f=0;continue}if(3===c[0]&&(!h||c[1]>h[0]&&c[1]<h[3]))f.label=c[1];else if(6===c[0]&&f.label<h[1])f.label=
h[1],h=c;else if(h&&f.label<h[2])f.label=h[2],f.ops.push(c);else{h[2]&&f.ops.pop();f.trys.pop();continue}}c=b.call(a,f)}catch(q){c=[6,q],e=0}finally{g=h=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var f={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},g,e,h,n;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return n={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n};Object.defineProperty(a,
"__esModule",{value:!0});var m=c(658),p=c(550),l=c(851),g=c(144),G=c(517),v=c(650),t=function(a){function b(c,d){var f=a.call(this,c,p.class_id_t.RTCDTMFToneChangeEvent,d,m.ProxyMode.Remote)||this;l.logger.log(f.user_friendly_id()+".constructor");return f}d(b,a);b.prototype.syncBarrier=function(){return e(this,void 0,void 0,function(){var a,b,c=this;return k(this,function(d){switch(d.label){case 0:return l.logger.log(this.user_friendly_id()+".syncBarrier() called."),[4,this.waitUntilConnected("DTMFToneChangeEvent.syncBarrier")];
case 1:return d.sent(),[4,Promise.all([this.remoteInvoke(!1,p.method_id_RTCDTMFToneChangeEvent_t.tone,""),this.remoteInvoke(!1,p.method_id_RTCDTMFToneChangeEvent_t.tone_buffer,"")])];case 2:return b=d.sent(),a=b.map(function(a){return c.param0(a)}),this.tone=a[0],this.tone_buffer_=a[1],[2,this]}})})};Object.defineProperty(b.prototype,"tone_buffer",{get:function(){return this.tone_buffer_},enumerable:!0,configurable:!0});return b}(m.ProxyObject);a.DTMFToneChangeEvent=t;var z=function(a){function b(c,
d){var f=a.call(this,c,p.class_id_t.RTCDTMFSender,d,m.ProxyMode.Remote)||this;l.logger.log(f.user_friendly_id()+".constructor");f.canInsertDTMF=!0;f.toneBuffer_="";return f}d(b,a);b.prototype.insertDTMF=function(a,b,c){var d=this;void 0===b&&(b=100);void 0===c&&(c=70);l.logger.log(this.user_friendly_id()+".insertDTMF() called, tones: "+a);this.waitUntilConnected("DtmfSender.insertDTMF").then(function(){return d.remoteInvoke(!1,p.method_id_RTCDTMFSender_t.insertDTMF,a,b,c)}).then(function(){l.logger.log(d.user_friendly_id()+
".insertDTMF() success, tones: "+a)})["catch"](function(a){d.logRemoteInvokeError(a,".insertDTMF() failed!")})};Object.defineProperty(b.prototype,"ontonechange",{get:function(){return this.ontonechange_},set:function(a){var b=this;l.logger.log(this.user_friendly_id()+".set_ontonechange() called.");this.ontonechange_=a;this.waitUntilConnected("DtmfSender.ontonechange").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),p.method_id_RTCDTMFSender_t.ontonechange);c.then(function(a){l.logger.log(b.user_friendly_id()+
".ontonechange callback received!");(new t(b,b.param0(a).oid)).syncBarrier().then(function(a){l.logger.log(b.user_friendly_id()+"tone: "+a.tone+" tone_buffer: "+a.tone_buffer);b.toneBuffer_=a.tone_buffer;b.ontonechange_(a)})["catch"](function(a){b.logRemoteInvokeError(a,".toneEvt.syncBarrier() failed!")})});return b.remoteInvoke(!0,p.method_id_RTCDTMFSender_t.ontonechange,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".set_ontonechange() failed!")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"toneBuffer",{get:function(){l.logger.log(this.user_friendly_id()+".toneBuffer() called.");return this.toneBuffer_},enumerable:!0,configurable:!0});return b}(m.ProxyObject);a.DtmfSender=z;var u=function(a){function b(c,d){var f=a.call(this,c,p.class_id_t.RTCIceTransport,d,m.ProxyMode.Remote)||this;l.logger.log(f.user_friendly_id()+".constructor");f.selectedPair=null;f.localCandidates_=[];f.remoteCandidates_=[];return f}d(b,a);b.prototype.syncBarrier=function(){var a=this;l.logger.log(this.user_friendly_id()+
".syncBarrier() called.");return new Promise(function(c,d){a.waitUntilConnected("IceTransport.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,p.method_id_RTCIceTransport_t.role,0),a.remoteInvoke(!1,p.method_id_RTCIceTransport_t.component,0),a.remoteInvoke(!1,p.method_id_RTCIceTransport_t.state,0),a.remoteInvoke(!1,p.method_id_RTCIceTransport_t.gatheringState,0)])}).then(function(d){l.logger.log(a.user_friendly_id()+".syncBarrier success.");var f=0,h=0;d=d.map(function(b){return a.param0(b)});
a.role_=d[0];a.component_=d[1];f=d[2];h=d[3];a.state_=b.convertState(f);a.gatheringState_=b.convertGatheringState(h);c(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier() failed!");d(b)})})};b.prototype.syncCandidates=function(){var a=this;l.logger.log(this.user_friendly_id()+".syncCandidates() called.");return new Promise(function(b,c){a.waitUntilConnected("IceTransport.syncCandidates").then(function(){return Promise.all([a.remoteInvoke(!1,p.method_id_RTCIceTransport_t.localcandidates,
[]),a.remoteInvoke(!1,p.method_id_RTCIceTransport_t.remotecandidates,[])])}).then(function(c){l.logger.log(a.user_friendly_id()+".syncCandidates success.");c=c.map(function(b){return a.param0(b)});a.localCandidates_=c[0];a.remoteCandidates_=c[1];b(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncCandidates() failed!");c(b)})})};Object.defineProperty(b.prototype,"role",{get:function(){return this.role_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"component",{get:function(){return this.component_},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"State",{get:function(){return this.state_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"gatheringState",{get:function(){return this.gatheringState_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onstatechange",{get:function(){return this.onstatechange_},set:function(a){var c=this;l.logger.log(this.user_friendly_id()+".set_onstatechange() called.");this.onstatechange_=a;this.waitUntilConnected("IceTransport.onstatechange").then(function(){var d=
c.registerCallbacks(!1,c.isNullCallback(a),p.method_id_RTCIceTransport_t.onstatechange);d.then(function(a){l.logger.log(c.user_friendly_id()+".onstatechange callback received!");c.syncCandidates().then(function(a){l.logger.log(c.user_friendly_id()+"received updated ice candidates!")});c.state_=b.convertState(c.param0(a));l.logger.log(c.user_friendly_id()+"state: "+c.state_);c.onstatechange_()});return c.remoteInvoke(!0,p.method_id_RTCIceTransport_t.onstatechange,d.success)})["catch"](function(a){c.logRemoteInvokeError(a,
".set_onstatechange failed!")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"ongatheringstatechange",{get:function(){return this.ongatheringstatechange_},set:function(a){var c=this;l.logger.log(this.user_friendly_id()+".set_ongatheringstatechange() called.");this.ongatheringstatechange_=a;this.waitUntilConnected("IceTransport.ongatheringstatechange").then(function(){var d=c.registerCallbacks(!1,c.isNullCallback(a),p.method_id_RTCIceTransport_t.ongatheringstatechange);d.then(function(a){l.logger.log(c.user_friendly_id()+
".ongatheringstatechange callback received!");c.syncCandidates().then(function(a){l.logger.log(c.user_friendly_id()+"received updated ice candidates!")});c.gatheringState_=b.convertGatheringState(c.param0(a));l.logger.log(c.user_friendly_id()+"gatheringState: "+c.gatheringState_);c.ongatheringstatechange_()});return c.remoteInvoke(!0,p.method_id_RTCIceTransport_t.ongatheringstatechange,d.success)})["catch"](function(a){c.logRemoteInvokeError(a,".set_ongatheringstatechange failed!")})},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"onselectedcandidatepairchange",{get:function(){return this.onselectedcandidatepairchange_},set:function(a){var b=this;l.logger.log(this.user_friendly_id()+".set_onselectedcandidatepairchange() called.");this.onselectedcandidatepairchange_=a;this.waitUntilConnected("IceTransport.onselectedcandidatepairchange").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),p.method_id_RTCIceTransport_t.onselectedcandidatepairchange);c.then(function(a){l.logger.log(b.user_friendly_id()+
".onselectedcandidatepairchange callback received!");b.syncCandidates().then(function(a){l.logger.log(b.user_friendly_id()+"received updated ice candidates!")});b.selectedPair=b.param0(a);l.logger.log(b.user_friendly_id()+"selectedPair: "+b.selectedPair);b.onselectedcandidatepairchange_()});return b.remoteInvoke(!0,p.method_id_RTCIceTransport_t.onselectedcandidatepairchange,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".set_onselectedcandidatepairchange failed!")})},enumerable:!0,configurable:!0});
b.prototype.getLocalCandidates=function(){return this.localCandidates_};b.prototype.getRemoteCandidates=function(){return this.remoteCandidates_};b.prototype.getLocalParameters=function(){return null};b.prototype.getRemoteParameters=function(){return null};b.prototype.getSelectedCandidatePair=function(){return this.selectedPair};b.convertState=function(a){return 0==a?"new":1==a?"checking":2==a?"connected":3==a?"completed":4==a?"failed":5==a?"disconnected":"closed"};b.convertGatheringState=function(a){return 0==
a?"new":1==a?"gathering":"complete"};return b}(m.ProxyObject);a.IceTransport=u;var f;(function(a){a[a["new"]=0]="new";a[a.connecting=1]="connecting";a[a.connected=2]="connected";a[a.closed=3]="closed";a[a.failed=4]="failed";a[a.max=5]="max"})(f||(f={}));var A=function(a){function b(c,d){var f=a.call(this,c,p.class_id_t.RTCDtlsTransport,d,m.ProxyMode.Remote)||this;l.logger.log(f.user_friendly_id()+".constructor");f.state_="new";f.transport_=null;f.remoteCertificates_=[];return f}d(b,a);b.prototype.dumpInfo=
function(){l.logger.log("DtlsTransport["+this.object_id()+"].dumpInfo():");l.logger.log("    - state:"+this.state_);l.logger.log("    - transport:"+this.transport_)};b.prototype.syncBarrier=function(){var a=this;l.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(c,d){a.waitUntilConnected("DtlsTransport.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,p.method_id_RTCDtlsTransport_t.transport,{}),a.remoteInvoke(!1,p.method_id_RTCDtlsTransport_t.state,
0),a.remoteInvoke(!1,p.method_id_RTCDtlsTransport_t.getRemoteCertificates,[])])}).then(function(f){var g;l.logger.log(a.user_friendly_id()+".syncBarrier remote success.");var h;g=f.map(function(b){return a.param0(b)});f=g[0];h=g[1];a.remoteCertificates_=g[2];a.state_=b.convertState(h);g=[];void 0==f||0!=f.is_null||null!==a.transport_&&a.transport_.object_id()==f.oid||(a.transport_=new u(a,f.oid),g.push(a.transport_.syncBarrier()));Promise.all(g).then(function(){l.logger.log(a.user_friendly_id()+".syncBarrier success");
c(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".prop.syncBarrier failed!");d(b)})})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier failed!");d(b)})})};Object.defineProperty(b.prototype,"transport",{get:function(){return this.transport_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"state",{get:function(){l.logger.log(this.user_friendly_id()+".get_state() called: "+this.state_);return this.state_},enumerable:!0,configurable:!0});b.prototype.getRemoteCertificates=
function(){return this.remoteCertificates_};Object.defineProperty(b.prototype,"onstatechange",{get:function(){return this.onstatechange_},set:function(a){var c=this;l.logger.log(this.user_friendly_id()+".set_onstatechange() called.");this.onstatechange_=a;this.waitUntilConnected("DtlsTransport.onstatechange").then(function(){var d=c.registerCallbacks(!1,c.isNullCallback(a),p.method_id_RTCDtlsTransport_t.onstatechange);d.then(function(a){l.logger.log(c.user_friendly_id()+".onstatechange callback received!");
c.state_=b.convertState(c.param0(a));l.logger.log(c.user_friendly_id()+"state_: "+c.state_);c.onstatechange_()});return c.remoteInvoke(!0,p.method_id_RTCDtlsTransport_t.onstatechange,d.success)})["catch"](function(a){c.logRemoteInvokeError(a,".set_onstatechange failed!")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onerror",{get:function(){return this.onerror_},set:function(a){var b=this;l.logger.log(this.user_friendly_id()+".set_onerror() called.");this.onerror_=a;this.waitUntilConnected("DtlsTransport.onerror").then(function(){var c=
b.registerCallbacks(!1,b.isNullCallback(a),p.method_id_RTCDtlsTransport_t.onerror);c.then(function(a){l.logger.log(b.user_friendly_id()+".onerror callback received!");a=b.param0(a);l.logger.log(b.user_friendly_id()+"error: "+a);b.onerror_(a)});return b.remoteInvoke(!0,p.method_id_RTCDtlsTransport_t.onerror,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".set_onerror failed!")})},enumerable:!0,configurable:!0});b.convertState=function(a){return a==f["new"]?"new":a==f.connecting?"connecting":
a==f.connected?"connected":a==f.closed?"closed":"failed"};return b}(m.ProxyObject);a.DtlsTransport=A;b=function(a){function b(c,d,f,g){c=a.call(this,c,d,f,g)||this;l.logger.log(c.user_friendly_id()+".constructor base");c.track_=null;c.transport_=null;c.rtcpTransport_=null;return c}d(b,a);b.prototype.syncBarrierBase=function(){var a=this;l.logger.log(this.user_friendly_id()+".syncBarrierBase() called.");return new Promise(function(b,c){var d,f,h;a instanceof x?(d=p.method_id_RTCRtpSender_t.track,f=
p.method_id_RTCRtpSender_t.transport,h=p.method_id_RTCRtpSender_t.rtcpTransport):a instanceof D&&(d=p.method_id_RTCRtpReceiver_t.track,f=p.method_id_RTCRtpReceiver_t.transport,h=p.method_id_RTCRtpReceiver_t.rtcpTransport);a.waitUntilConnected("RtpSenderReceiver.syncBarrierBase").then(function(){return v.RemoteSession.isFeaturePstnSupported()&&v.RemoteSession.isFeatureDtmfSupported()?Promise.all([a.remoteInvoke(!1,d,{oid:a.object_id()}),a.remoteInvoke(!1,f,{oid:a.object_id()}),a.remoteInvoke(!1,h,
{oid:a.object_id()})]):Promise.all([a.remoteInvoke(!1,d,{oid:a.object_id()})])}).then(function(d){var h;l.logger.log(a.user_friendly_id()+".syncBarrierBase remote success.");var f;h=d.map(function(b){return a.param0(b)});d=h[0];f=h[1];h=h[2];var e=[];void 0!=d&&!1===d.is_null&&(null===a.track_||a.track_.object_id()!=d.oid?a.track_=new g.RemoteMediaTrack(a,d.oid):a.track_.bind(a,d.oid),e.push(a.track.syncBarrier()));void 0==f||!1!==f.is_null||null!==a.transport_&&a.transport_.object_id()==f.oid||(a.transport_=
new A(a,f.oid),e.push(a.transport_.syncBarrier()));void 0==h||!1!==h.is_null||null!==a.rtcpTransport_&&a.rtcpTransport_.object_id()==h.oid||(a.rtcpTransport_=new A(a,h.oid),e.push(a.rtcpTransport_.syncBarrier()));Promise.all(e).then(function(){l.logger.log(a.user_friendly_id()+".prop.syncBarrierBase success");b(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".prop.syncBarrierBase failed!");c(b)})})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrierBase() failed!");c(b)})})};Object.defineProperty(b.prototype,
"transport",{get:function(){l.logger.log(this.user_friendly_id()+".get transport() called.");return this.transport_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"rtcpTransport",{get:function(){l.logger.log(this.user_friendly_id()+".get rtcpTransport() called.");return this.rtcpTransport_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"track",{get:function(){return this.track_},enumerable:!0,configurable:!0});b.prototype.reinitTrack=function(a){this.track_=
a};b.prototype.getStats=function(){l.logger.log(this.user_friendly_id()+".getStats() called.");var a=this;return new Promise(function(b,c){var d=this;a.isRedirected()?a.waitUntilConnected("RtpReceiver.getStats").then(function(){var c;d instanceof x?c=p.method_id_RTCRtpSender_t.getStats:d instanceof D&&(c=p.method_id_RTCRtpReceiver_t.getStats);var h=a.registerCallbacks(!0,!1,c);h.then(function(a){void 0!==a.params&&0!==a.params.length&&b(G.StatsReport.fromJSON(JSON.parse(a.params[0])))});return a.remoteInvoke(!1,
c,h.success)})["catch"](function(a){a=d.logRemoteInvokeError(a,".getStats() failed!");c(a)}):(l.logger.log(a.user_friendly_id()+".getStats(): not in active redirection!"),b())})};return b}(m.ProxyObject);a.RtpSenderReceiver=b;var x=function(a){function b(c,d,f,g){c=a.call(this,c,p.class_id_t.RTCRtpSender,d,f)||this;l.logger.log(c.user_friendly_id()+".constructor");c.dtmf_=null;c.params_=null;c.unified_=g;return c}d(b,a);b.prototype.dumpInfo=function(){l.logger.log("RtpSender["+this.object_id()+"].dumpInfo():");
this.track&&this.track.dumpInfo()};b.prototype.syncBarrier=function(){var b=this;l.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(c,d){b.waitUntilConnected("RtpSender.syncBarrier").then(function(){return a.prototype.syncBarrierBase.call(b)}).then(function(){l.logger.log(b.user_friendly_id()+".syncBarrierBase success.");return v.RemoteSession.isFeaturePstnSupported()&&v.RemoteSession.isFeatureDtmfSupported()?Promise.all([b.remoteInvoke(!1,p.method_id_RTCRtpSender_t.dtmf,
{oid:b.object_id()}),b.remoteInvoke(!1,p.method_id_RTCRtpSender_t.getParameters,{oid:b.object_id()})]):Promise.all([])}).then(function(a){l.logger.log(b.user_friendly_id()+".syncBarrier success.");var d;a=a.map(function(a){return b.param0(a)});d=a[0];b.params_=a[1];void 0==d||!1!==d.is_null||null!==b.dtmf_&&b.dtmf_.object_id()==d.oid||(b.dtmf_=new z(b,d.oid));c(b)})["catch"](function(a){a=b.logRemoteInvokeError(a,".syncBarrier failed!");d(a)})})};b.getCapabilities=function(a){l.logger.log(this.constructor.name+
".getCapabilities() called.");return g.NavigatorUserMedia.getCapabilities(a)};Object.defineProperty(b.prototype,"dtmf",{get:function(){l.logger.log(this.user_friendly_id()+".get dtmf() called.");return this.dtmf_},enumerable:!0,configurable:!0});b.prototype.setParameters=function(a){var b=this;l.logger.log(this.user_friendly_id()+".setParameters() called.");return new Promise(function(c,d){b.waitUntilConnected("RtpSender.setParameters").then(function(){return Promise.all([b.remoteInvoke(!1,p.method_id_RTCRtpSender_t.setParameters,
a)])}).then(function(d){l.logger.log(b.user_friendly_id()+".setParameters(): success.");c();b.params_=a})["catch"](function(a){a=b.logRemoteInvokeError(a,".setParameters() failed!");d(a)})})};b.prototype.getParameters=function(){var a=this;l.logger.log(this.user_friendly_id()+".getParameters() called.");this.waitUntilConnected(this.user_friendly_id()+".getParameters").then(function(){l.logger.log(a.user_friendly_id()+".getParameters() remote invoking");return a.remoteInvoke(!1,p.method_id_RTCRtpSender_t.getParameters,
{oid:a.object_id()})}).then(function(b){l.logger.log(a.user_friendly_id()+".getParameters() success");a.params_=a.param0(b)})["catch"](function(b){a.logRemoteInvokeError(b,".getParameters() failed!")});l.logger.log(this.user_friendly_id()+".getParameters() returning: "+this.params_);return this.params_};b.prototype.replaceTrack=function(a){var b=this;l.logger.log(this.user_friendly_id()+".replaceTrack() called. track_:"+this.track_+", withTrack:"+a);return new Promise(function(c,d){b.waitUntilConnected("RtpSender.replaceTrack").then(function(){if(a)return Promise.all([b.remoteInvoke(!1,
p.method_id_RTCRtpSender_t.replaceTrack,{oid:a.object_id()})]);if(b.unified_)return Promise.all([b.remoteInvoke(!1,p.method_id_RTCRtpSender_t.replaceTrack,{oid:0})]);l.logger.log(b.user_friendly_id()+".replaceTrack(): failed with null track!");d()}).then(function(d){l.logger.log(b.user_friendly_id()+".replaceTrack(): success.");c();b.reinitTrack(a)})["catch"](function(a){a=b.logRemoteInvokeError(a,".replaceTrack() failed!");d(a)})})};return b}(b);a.RtpSender=x;var D=function(a){function b(c,d,f,g,
e){c=a.call(this,c,p.class_id_t.RTCRtpReceiver,d,f)||this;l.logger.log(c.user_friendly_id()+".constructor");c.contribsources_=[];c.syncsources_=[];c.params_=null;c.unified_=g;e&&(c.track_=e);return c}d(b,a);b.prototype.dumpInfo=function(){l.logger.log("RtpReceiver["+this.object_id()+"].dumpInfo():");this.track&&this.track.dumpInfo();this.transport&&this.transport.dumpInfo()};b.prototype.syncBarrier=function(){var b=this;l.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(c,
d){b.waitUntilConnected("RtpReceiver.syncBarrier").then(function(){return a.prototype.syncBarrierBase.call(b)}).then(function(){l.logger.log(b.user_friendly_id()+".syncBarrierBase success.");return v.RemoteSession.isFeaturePstnSupported()&&v.RemoteSession.isFeatureDtmfSupported()?Promise.all([b.remoteInvoke(!1,p.method_id_RTCRtpReceiver_t.getContributingSources,[]),b.remoteInvoke(!1,p.method_id_RTCRtpReceiver_t.getSynchronizationSources,[]),b.remoteInvoke(!1,p.method_id_RTCRtpReceiver_t.getParameters,
{oid:b.object_id()})]):Promise.all([b.remoteInvoke(!1,p.method_id_RTCRtpReceiver_t.getContributingSources,[])])}).then(function(a){l.logger.log(b.user_friendly_id()+".syncBarrier success.");a=a.map(function(a){return b.param0(a)});b.contribsources_=a[0];b.syncsources_=a[1];b.params_=a[2];c(b)})["catch"](function(a){a=b.logRemoteInvokeError(a,".syncBarrier() failed!");d(a)})})};b.getCapabilities=function(a){l.logger.log(this.constructor.name+".getCapabilities() called.");return g.NavigatorUserMedia.getCapabilities(a)};
b.prototype.getContributingSources=function(){var a=this;l.logger.log(this.user_friendly_id()+".getContributingSources() called. "+JSON.stringify(this.contribsources_));this.waitUntilConnected("RtpReceiver.getContributingSources").then(function(){return Promise.all([a.remoteInvoke(!1,p.method_id_RTCRtpReceiver_t.getContributingSources,[])])}).then(function(b){a.contribsources_=b.map(function(b){return a.param0(b)})[0];l.logger.log(a.user_friendly_id(),".getContributingSources() success: "+JSON.stringify(a.contribsources_))})["catch"](function(b){a.logRemoteInvokeError(b,
".getContributingSources() failed!");a.contribsources_=[]});return this.contribsources_};b.prototype.getParameters=function(){l.logger.log(this.user_friendly_id()+".getParameters() called.");return this.params_};b.prototype.getSynchronizationSources=function(){l.logger.log(this.user_friendly_id()+".getSynchronizationSources() called.");return this.syncsources_};return b}(b);a.RtpReceiver=D},377:function(b,a,c){var d=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(a,"__esModule",{value:!0});var e=c(658),k=c(550),m=c(851),p=c(589);b=function(){function a(){this.direction="sendrecv";this.sendEncodings=[];this.streams=[];m.logger.log(this.user_friendly_id()+".constructor")}a.prototype.user_friendly_id=
function(){return this.constructor.name};return a}();a.RtpTransceiverInit=b;var l;(function(a){a[a.kSendRecv=0]="kSendRecv";a[a.kSendOnly=1]="kSendOnly";a[a.kRecvOnly=2]="kRecvOnly";a[a.kInactive=3]="kInactive"})(l||(l={}));b=function(a){function b(c,d,I,u,f,A){c=a.call(this,c,k.class_id_t.RTCRtpTransceiver,d,I)||this;m.logger.log(c.user_friendly_id()+".constructor");c.unified_=u;c.sender_=new p.RtpSender(c,0,e.ProxyMode.Pseudo,u);c.receiver_=A?A:new p.RtpReceiver(c,0,e.ProxyMode.Pseudo,u);f?(c.direction_=
c.toRtpTransceiverDirection(f),c.currentDirection_=c.toRtpTransceiverDirection(f)):(c.direction_=l.kSendRecv,c.currentDirection_=l.kSendRecv);return c}d(b,a);b.prototype.dumpInfo=function(){m.logger.log(this.user_friendly_id()+".dumpInfo() [id="+this.mid+"] direction="+this.toRTCRtpTransceiverDirection(this.direction_)," currentDirection="+this.toRTCRtpTransceiverDirection(this.currentDirection_));this.sender&&this.sender.dumpInfo();this.receiver&&this.receiver.dumpInfo()};b.prototype.syncBarrier=
function(){var a=this;m.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.waitUntilConnected("RtpTransceiver.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,k.method_id_RTCRtpTransceiver_t.mid,{oid:a.object_id()}),a.remoteInvoke(!1,k.method_id_RTCRtpTransceiver_t.direction,{oid:a.object_id()}),a.remoteInvoke(!1,k.method_id_RTCRtpTransceiver_t.currentDirection,{oid:a.object_id()}),a.remoteInvoke(!1,k.method_id_RTCRtpTransceiver_t.sender,
{oid:a.object_id()}),a.remoteInvoke(!1,k.method_id_RTCRtpTransceiver_t.receiver,{oid:a.object_id()})])}).then(function(c){var d;m.logger.log(a.user_friendly_id()+".syncBarrier remote success.");d=c.map(function(b){return a.param0(b)});a.mid_=d[0];a.direction_=d[1];a.currentDirection_=d[2];c=d[3];d=d[4];var e=[];void 0!=c&&!1===c.is_null&&(a.sender_.bind(a,c.oid),e.push(a.sender_.syncBarrier()));void 0!=d&&!1===d.is_null&&(a.receiver_.bind(a,d.oid),e.push(a.receiver_.syncBarrier()));if(0==e.length)m.logger.log(a.user_friendly_id()+
".syncBarrier success"),b(a);else return m.logger.log(a.user_friendly_id()+".prop.syncBarrier start"),Promise.all(e)}).then(function(){m.logger.log(a.user_friendly_id()+".syncBarrier success");b(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier() failed!");c(b)})})};Object.defineProperty(b.prototype,"mid",{get:function(){m.logger.log(this.user_friendly_id()+".get_mid() called: "+this.mid_);return this.mid_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sender",
{get:function(){return this.sender_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"receiver",{get:function(){return this.receiver_},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"direction",{get:function(){m.logger.log(this.user_friendly_id()+".get_direction() called. "+this.toRTCRtpTransceiverDirection(this.direction_));return this.toRTCRtpTransceiverDirection(this.direction_)},set:function(a){var b=this;m.logger.log(this.user_friendly_id()+".set_direction() called. "+
a);this.direction_=this.toRtpTransceiverDirection(a);this.waitUntilConnected("RtpTransceiver.set_direction").then(function(){return b.remoteInvoke(!0,k.method_id_RTCRtpTransceiver_t.direction,b.toRtpTransceiverDirection(a))}).then(function(){m.logger.log(b.user_friendly_id()+".set_direction: success.")})["catch"](function(a){b.logRemoteInvokeError(a,".set_direction() failed!")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"currentDirection",{get:function(){m.logger.log(this.user_friendly_id()+
".get_currentDirection() called. "+this.toRTCRtpTransceiverDirection(this.direction_));return this.toRTCRtpTransceiverDirection(this.currentDirection_)},enumerable:!0,configurable:!0});b.prototype.stop=function(){var a=this;m.logger.log(this.user_friendly_id()+".stop() called.");this.waitUntilConnected("RtpTransceiver.stop").then(function(){return a.remoteInvoke(!0,k.method_id_RTCRtpTransceiver_t.stop)}).then(function(){m.logger.log(a.user_friendly_id()+".stop: success.")})["catch"](function(b){a.logRemoteInvokeError(b,
".stop() failed!")})};b.prototype.setCodecPreferences=function(a){var b=this;m.logger.log(this.user_friendly_id()+".setCodecPreferences() called.");this.waitUntilConnected("RtpTransceiver.setCodecPreferences").then(function(){return b.remoteInvoke(!0,k.method_id_RTCRtpTransceiver_t.setCodecPreferences,a)}).then(function(){m.logger.log(b.user_friendly_id()+".setCodecPreferences: success.")})["catch"](function(a){b.logRemoteInvokeError(a,".setCodecPreferences() failed!")})};b.prototype.toRtpTransceiverDirection=
function(a){var b=l.kSendRecv;switch(a){case "inactive":b=l.kInactive;break;case "recvonly":b=l.kRecvOnly;break;case "sendonly":b=l.kSendOnly;break;case "sendrecv":b=l.kSendRecv;break;default:b=l.kInactive}return b};b.prototype.toRTCRtpTransceiverDirection=function(a){var b="sendrecv";switch(a){default:b="inactive";break;case l.kRecvOnly:b="recvonly";break;case l.kSendOnly:b="sendonly";break;case l.kSendRecv:b="sendrecv"}return b};return b}(e.ProxyObject);a.RtpTransceiver=b},509:function(b,a){Object.defineProperty(a,
"__esModule",{value:!0});(function(a){a[a.Unknown=0]="Unknown";a[a.Cap=1]="Cap";a[a.GetSources=2]="GetSources";a[a.SetActive=3]="SetActive";a[a.TopologyChanged=4]="TopologyChanged"})(a.sshare_cmd||(a.sshare_cmd={}));(function(a){a[a.Unknown=0]="Unknown";a[a.Initialized=1]="Initialized";a[a.Error=2]="Error"})(a.sshare_state||(a.sshare_state={}));var c=function(){function a(){}a.prototype.onInitialized=function(a){};a.prototype.onInitComplete=function(){};a.prototype.onError=function(a){};a.prototype.onGetSources=
function(a,b){};a.prototype.onSetActive=function(a,b){};a.prototype.onToplogyChanged=function(){};return a}();a.ScreenShareUtil=c},517:function(b,a){Object.defineProperty(a,"__esModule",{value:!0});var c=function(){function a(){this.items=[]}a.fromJSON=function(b){for(var c=new a,e=0;e<b.length;e++){var l=d.fromJSON(b[e]);c.items.push(l)}return c};a.toRTCStatsReport=function(a){return a};a.prototype.toJSON=function(){return JSON.stringify(this.items)};a.prototype.result=function(){return this.items};
return a}();a.StatsReport=c;var d=function(){function a(){this.names_=[];this.stat_=new Map;this.id="";this.timestamp=0;this.type=""}a.fromJSON=function(b){var c=new a;c.id=b.id||"";c.timestamp=b.timestamp||"";c.type=b.type||"";Object.keys(b).forEach(function(a){"id"!==a&&"timestamp"!==a&&"type"!==a&&(c.names_.push(a),c.stat_.set(a,b[a]))});return c};a.prototype.toJSON=function(){return JSON.stringify({id:this.id,timestamp:this.timestamp,type:this.type,stat:this.stat_})};a.prototype.names=function(){return this.names_};
a.prototype.stat=function(a){return this.stat_.get(a)};return a}();a.Stats=d},394:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});var d=c(946),e=c(851);(function(a){a[a.unknown=0]="unknown";a[a.active=1]="active";a[a.idle=2]="idle"})(a.tel_CallState||(a.tel_CallState={}));(function(a){a[a.unknown=0]="unknown";a[a.incoming=1]="incoming";a[a.outgoing=2]="outgoing"})(a.tel_CallDirection||(a.tel_CallDirection={}));(function(a){a[a.unknown=0]="unknown";a[a.audio=1]="audio";a[a.video=2]=
"video";a[a.multi=3]="multi";a[a.dshare=4]="dshare"})(a.tel_CallType||(a.tel_CallType={}));var k;(function(a){a[a.Unknown=0]="Unknown";a[a.Cap=1]="Cap";a[a.Init=2]="Init";a[a.Data=3]="Data"})(k=a.tel_cmd||(a.tel_cmd={}));a.tel_key_ConferenceCallDuration="ConferenceCallDuration";a.tel_key_AudioCallDuration="AudioCallDuration";a.tel_key_VideoCallDuration="VideoCallDuration";a.tel_key_ScreensharingCallDuration="ScreensharingCallDuration";a.tel_key_CallEstIncoming="CallEstIncoming";a.tel_key_CallEstOutgoing=
"CallEstOutgoing";a.tel_key_AudioDeviceUsed="AudioDeviceUsed";a.tel_key_VideoDeviceUsed="VideoDeviceUsed";a.tel_key_SpeakerDeviceUsed="SpeakerDeviceUsed";a.tel_key_PerfCallDirection="PerfCallDirection";a.tel_key_PerfCallState="PerfCallState";a.tel_key_PerfCallType="PerfCallType";a.tel_key_VerWebrpc="VerWebrpc";a.tel_key_VerWebrtcCodecs="VerWebrtcCodecs";a.tel_key_VerReceiver="VerReceiver";a.tel_key_VerVda="VerVda";a.tel_key_VerEndpoint="VerEndpoint";a.tel_key_VerTypeScript="VerTypeScript";a.tel_key_OSFamily=
"OSFamily";a.tel_key_OSVersion="OSVersion";a.tel_key_OSArchitecture="OSArchitecture";a.tel_key_OSDistro="OSDistro";a.tel_key_OSEdition="OSEdition";var m=function(){function a(b,c,d,e){this.cmd=b;this.key=c;this.value=d;this.flags=e}a.prototype.SendTelemetryData=function(a){a.SendTelemetryData(this.cmd,this.key,this.value,this.flags)};return a}();b=function(){function a(){this.id=0;this.deferredData=[]}a.prototype.reset=function(){this.id=0;this.deferredData=[]};a.prototype.onInitialized=function(a){for(this.id=
a;this.deferredData&&0<this.deferredData.length;)this.deferredData.shift().SendTelemetryData(this)};a.prototype.SendTelemetryInit=function(){0<this.id&&this.reset();try{d.getRedirector().WSSendObject({v:"telemetry",hdr:{command:k.Init,id:0},init:{domain:"HDXMM Teams",subdomain:"Teams",feature:"msteams",version:"1.1.1.1"}})}catch(a){e.logger.log(a)}};a.prototype.SendTelemetryData=function(a,b,c,p){if(a!=k.Data)e.logger.log("invalid telemetry command!");else if(0==this.id)this.deferredData.push(new m(a,
b,c,p));else try{d.getRedirector().WSSendObject({v:"telemetry",hdr:{command:a,id:this.id},data:{key:b,value:c,flags:p}})}catch(t){e.logger.log(t)}};return a}();a.Telemetry=b},307:function(b,a,c){var d=c(550).Features,e=c(360),k=c(144),m=c(679),p=c(945),l=c(368),g=c(851).logger,G=c(650),v=c(247).gc,t=c(946);(function(a,b){a.CitrixWebRTC=b()})("undefined"!==typeof self?self:this,function(){function a(b){t.getRedirector().SendTelemetryData_Speaker(b)}function b(){var a=window.getCitrixWebrtcRedir;void 0!==
a?a().then(function(a){g.log("sucesss on connect, getCitrixWebrtcRedir reg value:"+a);"1"===a&&null===F&&(g.log("supported client"),F=new G.RemoteSession)})["catch"](function(){g.log("Failure to Read Webrtc redir Reg Key");A()}):(g.log("window.getCitrixWebrtcRedir() method is not available yet"),A())}function c(a){if("1"===a)g.log("Supported client"),t.getRedirector().pingConnectionBegin(!0);else if("0"===a){g.log("VDI Event: Unsupported client reported");try{H({event:"vdiClientDisconnected",reason:"endpointUnsupported",
msg:"Unsupported endpoint connected"})}catch(b){g.log("onVMEvent(): exception: "+b.message)}}else g.log("Citrix Webrtc Redir Reg Key value is incorrect")}function A(){!1===J&&(g.log("starting MS Reg retry..."),J=!0,x(10))}function x(a){if(0>=a){J=!1;g.log("VDI Event: Reg Key not Updated after timer reported, Fallback");try{H({event:"vdiClientDisconnected",reason:"failure",msg:"Citrix Webrtc Redir Reg Key not Present"})}catch(b){g.log("onVMEvent(): exception: "+b.message)}}else{var d=window.getCitrixWebrtcRedir;
void 0!==d?d().then(function(b){g.log("CitrixMSTeamsRedir reg value:"+b);"0"===b||"1"===b?(c(b),J=!1):(g.log("MS Teams Redir Reg key not updated - Start timer"),setTimeout(function(){g.log("Timer waiting for registry to be updated count :"+a);x(--a)},1E3))})["catch"](function(){g.log("Failure to Read MS Teams redir Reg Key - Start timer");setTimeout(function(){g.log("Timer waiting for registry to be updated count :"+a);x(--a)},1E3)}):(g.log("window.getCitrixWebrtcRedir() method is not available yet"),
setTimeout(function(){g.log("Timer waiting for registry to be updated count :"+a);x(--a)},1E3))}}function D(){g.log("VDI: sendSessionInfo");F&&F.getSessionInfo().then(function(a){g.log("getSessionInfo success! info:"+JSON.stringify(a));try{H({event:"vdiClientConnected",version:a})}catch(b){g.log("onVMEvent(): exception: "+b.message)}})["catch"](function(){g.log("getSessionInfo failure! session is not fully connected yet...")})}var C=e.PeerConnection,r=new k.NavigatorUserMedia,q=k.NavigatorUserMedia.getCapabilities,
w=new k.RemoteDevices,B=new l.FrameTracker,y=0,H=window.VMEventCallback,h=!1;window.onVdiClientDisconnected=function(a){g.log("VDI Event: vdiClientDisconnected");g.log("VDI : cleanup");t.getRedirector().clearReqs();k.NavigatorUserMedia.resetcaps();B=w=r=null;F&&F.release();F=null;v.reset();g.log("VDI : cleanup done");if(!0===a&&!1===h){g.log("VDI Event: vdiClientDisconnected with failure reported");h=!0;try{H({event:"vdiClientDisconnected",reason:"failure",msg:"Websocket Connection Failure"})}catch(b){g.log("onVMEvent(): exception: "+
b.message)}}else{h=!1;try{H({event:"vdiClientDisconnected",reason:"endpointDisconnected"})}catch(b){g.log("onVMEvent(): exception: "+b.message)}}};var F=new G.RemoteSession;window.onVdiClientDisconnectedTimer=function(){g.log("VDI Event: onVdiClientDisconnectedTimer");null===F&&(F=new G.RemoteSession)};window.onVdiClientConnected=function(){g.log("VDI Event: vdiClientConnected");l.FrameTracker.sendOverlayInfo();null!==w&&w.isValid()||(w=new k.RemoteDevices);null!==r&&r.isValid()||(r=new k.NavigatorUserMedia);
r.getCapabilities().then(function(a){g.log(".getCapabilities() success "+a)})["catch"](function(){g.log(".getCapabilities() failure")});D();navigator.mediaDevices.dispatchEvent(new CustomEvent("devicechange"))};var J=!1;return{Features:d,CitrixPeerConnection:C,getUserMedia:function(a,c,d){b();g.log("VDI Shim getUserMedia");null!==r&&r.isValid()||(r=new k.NavigatorUserMedia);return r.webkitGetUserMedia(a,c,d)},getDisplayMedia:function(a){b();g.log("VDI Shim getDisplayMedia");null!==w&&w.isValid()||
(w=new k.RemoteDevices);return w.getDisplayMedia(a)},enumerateDevices:function(){b();null!==w&&w.isValid()||(w=new k.RemoteDevices);return w.enumerateDevices()},mapVideoElement:function(a){g.log("VDI New Video Element Created, Creating Mapping to VDA");null===B&&(B=new l.FrameTracker);void 0!==a.remoteVideoElement?g.log("Video element is already configured!"):(b(),Object.defineProperty(a,"remoteVideoElement",{writable:!0,value:null}),a.id||(a.id="ctx-vid-"+y++),a.remoteVideoElement=new m.VideoElement(a.id),
a.remoteVideoElement.onloadedmetadata=function(){var b=new Event("loadedmetadata");a.dispatchEvent(b)},a.remoteVideoElement.ontimeupdate=function(){var b=new Event("timeupdate");a.dispatchEvent(b)},a.remoteVideoElement.onconnectionstatechange=function(){"connected"===a.remoteVideoElement.connectionState?B.track(a,function(b){a.remoteVideoElement.setFrame(b)}):B.untrack(a)},Object.defineProperty(a,"sinkId",{get:function(){return a.remoteVideoElement.sinkId},set:function(b){g.log("VDI Shim set video element SinkId value = "+
b);a.remoteVideoElement.sinkId=b}}),Object.defineProperty(a,"srcObject",{get:function(){return a.remoteVideoElement.srcObject},set:function(b){g.log("VDI Shim set video element srcObject");a.remoteVideoElement.srcObject=b}}),Object.defineProperty(a,"videoWidth",{get:function(){return a.remoteVideoElement.videoWidth}}),Object.defineProperty(a,"videoHeight",{get:function(){return a.remoteVideoElement.videoHeight}}))},mapAudioElement:function(c){g.log("VDI New Audio Element Created, Creating Mapping to VDA");
if(void 0!==c.remoteAudioElement)g.log("Audio element is already configured!");else{b();Object.defineProperty(c,"remoteAudioElement",{writable:!0,value:null});c.remoteAudioElement=new p.AudioElement;var d=c.remoteAudioElement.play;c.play=function(){g.log("VDI Shim remote audio play");return d.apply(c.remoteAudioElement,arguments)};var h=c.remoteAudioElement.pause;c.pause=function(){g.log("VDI Shim remote audio pause");return h.apply(c.remoteAudioElement,arguments)};Object.defineProperty(c,"sinkId",
{get:function(){return c.remoteAudioElement.sinkId},set:function(a){g.log("VDI Shim set audio element SinkId value = "+a);c.setSinkId(a).then(function(){g.log("VDI Shim set audio element SinkId success")})["catch"](function(){g.log("VDI Shim set audio element SinkId failure")})}});c.setSinkId=function(b){g.log("VDI Shim set audio element SinkId value = "+b);var d=c.remoteAudioElement.setSinkId(b),h;k.enumerateddecices.forEach(function(a){b===a.deviceId&&(h=a.label)});a(h);return d};Object.defineProperty(c,
"srcObject",{get:function(){return c.remoteAudioElement.srcObject},set:function(a){g.log("VDI Shim set audio element srcObject "+JSON.stringify(a));c.remoteAudioElement.srcObject=a}})}},setVMEventCallback:function(a){H=a;t.getRedirector().isConnected()&&!window.VMEventCallback&&D();window.VMEventCallback=null;g.log("VDI Event Callback Set")},addClipRect:function(a){g.log("VDI Adding Occlusion "+JSON.stringify(a));null===B&&(B=new l.FrameTracker);B.addOcclusion(a)},removeClipRect:function(a){g.log("VDI Removing Occlusion "+
JSON.stringify(a));null===B&&(B=new l.FrameTracker);B.removeOcclusion(a)},initLog:function(a){g.setMSLogger(a);g.log("VDI init logger")},isFeatureOn:function(a){return null===F?!1:F.isFeatureSupported(a)},onConnectionChange:function(a){g.log("VDI : onConnectionChange to "+a);!1===a?g.log("Disconnecting from the VDA"):(g.log("Connecting to the VDA"),a=window.getCitrixWebrtcRedir,void 0!==a?a().then(function(a){g.log("Sucesss on connect, CitrixMSTeamsRedir reg value:"+a);"0"===a||"1"===a?c(a):(g.log("MS Teams Redir Reg key not updated yet"),
A())})["catch"](function(){g.log("Failure to Read MS Teams redir Reg Key");A()}):(g.log("window.getCitrixWebrtcRedir() method is not available yet"),A()))},setCodecCapabilities:function(a){g.log("VDI Shim setCodecCapabilities");null!==r&&r.isValid()||(r=new k.NavigatorUserMedia);return r.setCodecCapabilities(a)},createMediaStream:function(a){g.log("VDI Shim createMediaStream");b();return new k.RemoteStream(null,0,0,a)},getCapabilities:function(a){b();g.log("VDI Shim getCapabilities");null!==r&&r.isValid()||
(r=new k.NavigatorUserMedia,q=k.NavigatorUserMedia.getCapabilities);return q.apply(r,arguments)},destroyVideoElement:function(a,b){g.log("VDI Shim destroyVideoElement: ");if(a){var c=a.remoteVideoElement;c&&c.dispose();a.remoteVideoElement=void 0}},destroyAudioElement:function(a,b,c){g.log("VDI Shim destroyAudioElement: ");a&&((b=a.remoteAudioElement)&&b.dispose(),a.remoteAudioElement=void 0)}}})},679:function(b,a,c){var d=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||
{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(a,"__esModule",{value:!0});var e=c(658),k=c(550),m=c(851),p=c(946),l=c(550),g=function(){return function(a){this.x=Math.round(a.x)*window.devicePixelRatio;this.y=Math.round(a.y)*window.devicePixelRatio;this.width=
Math.round(a.width)*window.devicePixelRatio;this.height=Math.round(a.height)*window.devicePixelRatio}}();a.VideoRect=g;var G;(function(a){a[a.pixels=0]="pixels";a[a.percent=1]="percent"})(G||(G={}));var v=function(){function a(b){this.value=parseInt(b);this.units=this.detectUnits(b)}a.prototype.detectUnits=function(a){return-1===a.toLowerCase().indexOf("px")?G.pixels:G.percent};return a}(),t;(function(a){a[a.fill=0]="fill";a[a.contain=1]="contain";a[a.cover=2]="cover"})(t||(t={}));var z=function(){return function(a,
b){this.x=a;this.y=b}}(),u=function(){function a(b,c,d){this.fit=this.convertFit(b);this.position=new z(c,d)}a.prototype.convertFit=function(a){return"fill"==a?t.fill:"contain"==a?t.contain:"cover"==a?t.cover:t.fill};return a}();b=function(a){function b(c){var d=a.call(this,null,k.class_id_t.VideoElement,0,e.ProxyMode.Local)||this;d.srcObject_=null;d.sinkId_="";d.videoWidth=0;d.videoHeight=0;d.isLoaded=!1;d.connectionState="disconnected";d.styleObserver=null;d.pendingRelease_=!1;d.activeConnectionEvent_=
null;d.connectionEventQueue_=[];d.elementId=c;return d}d(b,a);b.prototype.dispose=function(){m.logger.log("VideoElement.dispose (elementId: "+this.elementId+" oid: "+this.object_id()+")");this.pendingRelease_=!0;this.srcObject=this.ontimeupdate=this.onloadedmetadata=null};b.prototype.setState=function(a){this.connectionState=a;if(this.onconnectionstatechange_)this.onconnectionstatechange_()};Object.defineProperty(b.prototype,"sinkId",{get:function(){return this.sinkId_},set:function(a){var b=this;
this.waitUntilConnected("VideoElement.sinkId").then(function(){return b.remoteInvoke(!0,k.method_id_VideoElement_t.sinkId,a)}).then(function(){b.sinkId_=a})["catch"](function(a){b.logRemoteInvokeError(a,".set_sinkId() failed!")})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"srcObject",{get:function(){return this.srcObject_},set:function(a){m.logger.log(this.user_friendly_id()+".srcObject: set srcObject... this.srcObject:"+this.srcObject+" obj:"+a);if(this.srcObject_!==a){var b=
p.getRedirector().getFeatureValue(l.FEATURE_ms_teams_1911);null!==this.srcObject_&&(null===a&&b&&this.disconnect(),b||this.disconnect(),this.isLoaded=!1);this.srcObject_=a;null!==this.srcObject_&&this.connectTo(this.srcObject_)}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onconnectionstatechange",{get:function(){return this.onconnectionstatechange_},set:function(a){m.logger.log(this.user_friendly_id()+".set_onconnectionstatechange() called.");this.onconnectionstatechange_=
a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onloadedmetadata",{set:function(a){m.logger.log(this.user_friendly_id()+".set_onloadedmetadata() called.");this.onloadedmetadata_=a},enumerable:!0,configurable:!0});b.prototype.setupOnVideoFrameChanged=function(){var a=this,b=this.registerCallbacks(!1,!1,k.method_id_VideoElement_t.onvideoframechanged);b.then(function(b){m.logger.log(a.user_friendly_id()+".onvideoframechanged",b.params);a.videoWidth=b.params[0]||0;a.videoHeight=
b.params[1]||0;a.isLoaded||(a.isLoaded=!0,a.onloadedmetadata_&&a.onloadedmetadata_())});this.remoteInvoke(!0,k.method_id_VideoElement_t.onvideoframechanged,b.success)};b.prototype.processConnectionEvent=function(){var a=this;if(0!==this.connectionEventQueue_.length&&!this.activeConnectionEvent_){var b=this.connectionEventQueue_.pop();"connectTo"==b.operation?this.activeConnectionEvent_=this.connectToAsync(b.param):"disconnect"==b.operation&&(this.activeConnectionEvent_=this.disconnectAsync());this.activeConnectionEvent_.then(function(){a.activeConnectionEvent_=
void 0;a.processConnectionEvent()})["catch"](function(){m.logger.log(a.user_friendly_id()+" : Failed to handle connection event! ");a.activeConnectionEvent_=void 0;a.processConnectionEvent()})}};b.prototype.connectTo=function(a){this.connectionEventQueue_.push({operation:"connectTo",param:a});this.processConnectionEvent()};b.prototype.disconnect=function(){this.connectionEventQueue_.push({operation:"disconnect",param:null});this.processConnectionEvent()};b.prototype.connectToAsync=function(a){var b=
this;return new Promise(function(c,d){m.logger.log(b.user_friendly_id()+".connectTo: connect media stream with id = "+a.id+", clone_id = "+a.clone_state.clone_id);b.streamId_=a.id;b.waitUntilConnected("VideoElement.connectTo").then(function(){return a.waitUntilConnected("MediaStream.connectTo")}).then(function(){b.setupOnVideoFrameChanged();return a.clone_state.synchronize(a)}).then(function(a){m.logger.log(b.user_friendly_id()+".connectTo: remote invoking");var c=b.registerCallbacks(!0,!1,k.method_id_VideoElement_t.connectTo);
return Promise.all([b.remoteInvoke(!1,k.method_id_VideoElement_t.connectTo,{oid:a.object_id()},c.success,c.fail),c.prom()])}).then(function(a){m.logger.log(b.user_friendly_id()+".connectTo: remote media stream is connected!");b.setState("connected");b.watch();b.updateTimer=setInterval(function(){b.ontimeupdate&&b.ontimeupdate()},250);(a=window.document.getElementById(b.elementId))&&b.updateStyle(a);c()})["catch"](function(a){b.logRemoteInvokeError(a,".connectTo: failed to connect!");d()})})};b.prototype.disconnectAsync=
function(){var a=this;return new Promise(function(b,c){m.logger.log(a.user_friendly_id()+".disconnect: disconnecting stream : "+a.streamId_);a.unwatch();a.waitUntilConnected("VideoElement.disconnect").then(function(){a.updateTimer&&clearInterval(a.updateTimer);var b=a.registerCallbacks(!1,!0,k.method_id_VideoElement_t.onvideoframechanged);a.remoteInvoke(!0,k.method_id_VideoElement_t.onvideoframechanged,b.success);return a.remoteInvoke(!1,k.method_id_VideoElement_t.disconnect)}).then(function(){m.logger.log(a.user_friendly_id()+
".disconnect: remote media stream is disconnected!");a.setState("disconnected");1==a.pendingRelease_&&(a.pendingRelease_=!1,a.onconnectionstatechange=null,a.release());b()})["catch"](function(b){a.logRemoteInvokeError(b,".disconnect: failed to connect!");c()})})};b.prototype.setFrame=function(a){var b=this;m.logger.log(this.user_friendly_id()+".setFrame: set video frame to",a.x,a.y,a.width,a.height);this.waitUntilConnected("VideoElement.setFrame").then(function(){var c=new g(a);return b.remoteInvoke(!1,
k.method_id_VideoElement_t.setFrame,c)}).then(function(){m.logger.log(b.user_friendly_id()+".setFrame: success!")})["catch"](function(a){b.logRemoteInvokeError(a,".setFrame: failed to connect!")})};b.prototype.addClipRect=function(a){var b=this;m.logger.log(this.user_friendly_id()+".addClipRect: ",JSON.stringify(a));this.waitUntilConnected("VideoElement.addClipRect").then(function(){var c=new g(a);return b.remoteInvoke(!1,k.method_id_VideoElement_t.addClipRect,c)})["catch"](function(a){b.logRemoteInvokeError(a,
".addClipRect failed!")})};b.prototype.removeClipRect=function(a){var b=this;m.logger.log(this.user_friendly_id()+".removeClipRect: ",JSON.stringify(a));this.waitUntilConnected("VideoElement.removeClipRect").then(function(){var c=new g(a);return b.remoteInvoke(!1,k.method_id_VideoElement_t.removeClipRect,c)})["catch"](function(a){b.logRemoteInvokeError(a,".removeClipRect failed!")})};b.prototype.watch=function(){var a=this;if(p.getRedirector().getFeatureValue(l.FEATURE_ms_teams_video_placement)){var b=
window.document.getElementById(this.elementId);b&&(this.unwatch(),this.styleObserver=new MutationObserver(function(b){b.forEach(function(b){"style"==b.attributeName?a.updateStyle(b.target):a.elementId=b.target.id})}),this.styleObserver.observe(b,{attributes:!0,attributeOldValue:!0,attributeFilter:["style","id"]}))}};b.prototype.unwatch=function(){this.styleObserver&&(this.styleObserver.disconnect(),this.styleObserver=null)};b.prototype.updateStyle=function(a){if("connected"==this.connectionState){var b=
window.getComputedStyle(a).getPropertyValue("object-fit"),c=window.getComputedStyle(a).getPropertyValue("object-position").split(" ");a=new v(c[0]);c=new v(c[1]);this.placement=new u(b,a,c)}else m.logger.log(this.user_friendly_id()+".updateStyle: video element is not connected")};Object.defineProperty(b.prototype,"placement",{get:function(){return this.placement_},set:function(a){var b=this;p.getRedirector().getFeatureValue(l.FEATURE_ms_teams_video_placement)?this.waitUntilConnected("VideoElement.placement").then(function(){return b.remoteInvoke(!0,
k.method_id_VideoElement_t.placement,a)}).then(function(){b.placement_=a})["catch"](function(a){b.logRemoteInvokeError(a,".placement setter: failed to connect!")}):m.logger.log(this.user_friendly_id()+".placement: video placement feature is not supported on a client")},enumerable:!0,configurable:!0});return b}(e.ProxyObject);a.VideoElement=b},269:function(b,a){Object.defineProperty(a,"__esModule",{value:!0});a.FEATURE_ms_teams_redirection="ms_teams_redirection";a.FEATURE_unsupported="unsupported";
var c=function(){return function(a,b,c,d){this.major=a;this.minor=b;this.revision=c;this.build=d}}();a.VersionData=c;c=function(){return function(){}}();a.FeatureData=c;c=function(){return function(a,b){this.fature=a;this.version=b}}();a.WebrpcFeatureInfo=c;c=function(){return function(a,b,c,d,e){this.family=a;this.version=b;this.architecture=c;this.distro=d;this.edition=e}}();a.OSInfo=c;c=function(){return function(a,b){this.machine_id=a;this.user_id=b}}();a.EndpointId=c;c=function(){return function(b,
c,d,e,k){void 0===k&&(k=a.FEATURE_ms_teams_redirection);this.iid=b;this.mid=c;this.name=d;this.isprop=e;this.feature=k}}();a.WebrpcMethodInfo=c;c=function(){return function(a,b,c){this.id=a;this.name=b;this.methods=c}}();a.WebrpcClassInfo=c;c=function(){return function(a,b){this.name=a;this.classes=b}}();a.WebrpcClassLibInfo=c},550:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});var d=c(187);(function(b){for(var c in b)a.hasOwnProperty(c)||(a[c]=b[c])})(c(187));b=function(){function a(){}
a.getInterfaceByid=function(a){for(var b=0,c=d.class_lib_info.classes;b<c.length;b++){var e=c[b];if(e.id==a)return e}return null};a.getMethodByid=function(a,b){var c=this.getInterfaceByid(a);if(null!=c)for(var d=0,c=c.methods;d<c.length;d++){var e=c[d];if(e.mid==b)return e}return null};a.getMethodFeatureByid=function(a,b){var c=this.getInterfaceByid(a);if(null!=c)for(var d=0,c=c.methods;d<c.length;d++){var e=c[d];if(e.mid==b)return e.feature}return null};a.composeClassInfoData=function(a){a=a.hdr;
if(void 0==a)return"*** Invalid packet: Couldn't find hdr object ***";var b=a.proc;if(void 0==b)return"";a=b.iid;for(var b=b.methodid,c=0,e=d.class_lib_info.classes;c<e.length;c++){var g=e[c];if(g.id==a)for(var k=0,n=g.methods;k<n.length;k++){var t=n[k];if(t.mid==b)return g.name+"::"+t.name}}return""};return a}();a.WebrpcClassLibInfoUtil=b},187:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});b=c(269);c=c(269);a.VersionData=c.VersionData;a.FeatureData=c.FeatureData;a.OSInfo=c.OSInfo;
a.EndpointId=c.EndpointId;a.BUILD_TYPE_SDK=!0;a.HDXMS_VERSION="2.0.0.5";a.FEATURE_vda_service_no_buffer_limit="wsservice_no_buffer_limit";a.FEATURE_vda_app_sharing="webrtc_app_sharing";a.FEATURE_vda_multi_window="webrtc_multi_window";a.FEATURE_ms_teams_desktop_sharing="ms_teams_desktop_sharing";a.FEATURE_ms_teams_speaking_indicator="ms_teams_speaking_indicator";a.FEATURE_ms_teams_common_media_constraints="ms_teams_common_media_constraints";a.FEATURE_ms_teams_1911="ms_teams_1911";a.FEATURE_ms_teams_pstn=
"ms_teams_pstn";a.FEATURE_ms_teams_1912="ms_teams_1912";a.FEATURE_ms_teams_mstrack_constraints="ms_teams_mstrack_constraints";a.FEATURE_ms_teams_osinfo="ms_teams_osinfo";a.FEATURE_ms_teams_endpoint_id="ms_teams_endpoint_id";a.FEATURE_ms_teams_remote_audio_notifications="ms_teams_remote_audio_notifications";a.FEATURE_ms_teams_device_group_id="ms_teams_device_group_id";a.FEATURE_ms_teams_dtmf="ms_teams_dtmf";a.FEATURE_ms_teams_video_placement="ms_teams_video_placement";a.FEATURE_ms_teams_codec_capability=
"ms_teams_codec_capability";a.FEATURE_ms_teams_multi_window="ms_teams_multi_windows";a.FEATURE_ms_teams_webrtc_1dot0="ms_teams_webrtc_1.0";a.FEATURE_ms_teams_data_channel="ms_teams_data_channel";a.FEATURE_ms_teams_no_vd_buffer_limit="ms_teams_no_vd_buffer_limit";new b.WebrpcFeatureInfo(b.FEATURE_ms_teams_redirection,new b.VersionData(1,1,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_desktop_sharing,new b.VersionData(1,2,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_speaking_indicator,new b.VersionData(1,
2,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_common_media_constraints,new b.VersionData(1,4,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_1911,new b.VersionData(1,4,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_1912,new b.VersionData(1,5,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_mstrack_constraints,new b.VersionData(1,6,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_pstn,new b.VersionData(1,6,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_osinfo,new b.VersionData(1,7,0,0));
new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_endpoint_id,new b.VersionData(1,7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_remote_audio_notifications,new b.VersionData(1,7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_device_group_id,new b.VersionData(1,7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_codec_capability,new b.VersionData(1,7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_dtmf,new b.VersionData(1,7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_video_placement,new b.VersionData(1,
7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_webrtc_1dot0,new b.VersionData(1,8,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_data_channel,new b.VersionData(1,8,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_multi_window,new b.VersionData(1,14,0,0));c=function(){function a(){}a.FEATURE_public_screenshare="screenshare";a.FEATURE_public_redirection="redirection";a.FEATURE_public_speaking_indicator="speaking_indicator";a.FEATURE_public_pstn="pstn";a.FEATURE_public_osinfo="osinfo";a.FEATURE_public_endpoint_id=
"endpointid";a.FEATURE_public_remote_audio_notifications="remoteaudionotifications";a.FEATURE_public_device_group_id="compositedevices";a.FEATURE_public_dtmf="dtmf";a.FEATURE_public_monitor_sharing="multimonitorscreenshare";a.FEATURE_public_app_sharing="appshare";a.FEATURE_public_codec_capability="codec_capability";a.FEATURE_public_webrtc1dot0="webrtc1.0";a.FEATURE_public_data_channel="datachannel";a.FEATURE_public_vdnobuflimit="vdnobuflimit";a.FEATURE_public_multi_window="multiwindow";return a}();
a.Features=c;a.featureNameMap={};a.featureNameMap[c.FEATURE_public_screenshare]=[a.FEATURE_ms_teams_desktop_sharing];a.featureNameMap[c.FEATURE_public_redirection]=[b.FEATURE_ms_teams_redirection];a.featureNameMap[c.FEATURE_public_speaking_indicator]=[a.FEATURE_ms_teams_speaking_indicator];a.featureNameMap[c.FEATURE_public_pstn]=[a.FEATURE_ms_teams_pstn];a.featureNameMap[c.FEATURE_public_osinfo]=[a.FEATURE_ms_teams_osinfo];a.featureNameMap[c.FEATURE_public_endpoint_id]=[a.FEATURE_ms_teams_endpoint_id];
a.featureNameMap[c.FEATURE_public_remote_audio_notifications]=[a.FEATURE_ms_teams_remote_audio_notifications];a.featureNameMap[c.FEATURE_public_device_group_id]=[a.FEATURE_ms_teams_device_group_id];a.featureNameMap[c.FEATURE_public_dtmf]=[a.FEATURE_ms_teams_dtmf];a.featureNameMap[c.FEATURE_public_codec_capability]=[a.FEATURE_ms_teams_codec_capability];a.featureNameMap[c.FEATURE_public_webrtc1dot0]=[a.FEATURE_ms_teams_webrtc_1dot0];a.featureNameMap[c.FEATURE_public_multi_window]=[a.FEATURE_ms_teams_multi_window];
a.featureNameMap[c.FEATURE_public_data_channel]=[a.FEATURE_ms_teams_data_channel];a.featureNameMap[c.FEATURE_public_vdnobuflimit]=[a.FEATURE_ms_teams_no_vd_buffer_limit];(function(a){a[a.EngineControl=0]="EngineControl";a[a.RTCPeerConnection=1]="RTCPeerConnection";a[a.RTCSessionDescription=2]="RTCSessionDescription";a[a.RTCIceCandidate=3]="RTCIceCandidate";a[a.RTCIceCandidateEvent=4]="RTCIceCandidateEvent";a[a.MediaDevices=5]="MediaDevices";a[a.MediaDeviceInfo=6]="MediaDeviceInfo";a[a.MediaStreamTrack=
7]="MediaStreamTrack";a[a.MediaStreamEvent=8]="MediaStreamEvent";a[a.MediaStream=9]="MediaStream";a[a.NavigatorUserMedia=10]="NavigatorUserMedia";a[a.VideoElement=11]="VideoElement";a[a.AudioElement=12]="AudioElement";a[a.RTCRtpReceiver=13]="RTCRtpReceiver";a[a.RTCRtpSender=14]="RTCRtpSender";a[a.RTCDtlsTransport=15]="RTCDtlsTransport";a[a.RTCIceTransport=16]="RTCIceTransport";a[a.RTCDTMFSender=17]="RTCDTMFSender";a[a.RTCDTMFToneChangeEvent=18]="RTCDTMFToneChangeEvent";a[a.RTCIceCandidatePair=19]=
"RTCIceCandidatePair";a[a.RTCRtpTransceiver=20]="RTCRtpTransceiver";a[a.reserved3=21]="reserved3";a[a.reserved4=22]="reserved4";a[a.reserved1=23]="reserved1";a[a.reserved2=24]="reserved2";a[a.RTCDataChannel=25]="RTCDataChannel";a[a.RTCSctpTransport=26]="RTCSctpTransport"})(c=a.class_id_t||(a.class_id_t={}));var d;(function(a){a[a.ctor=0]="ctor";a[a.version=1]="version";a[a.feature_flags=2]="feature_flags";a[a.version_info=3]="version_info";a[a.osinfo=4]="osinfo";a[a.endpoint_id=5]="endpoint_id"})(d=
a.method_id_EngineControl_t||(a.method_id_EngineControl_t={}));var e;(function(a){a[a.ctor=0]="ctor";a[a.localDescription=1]="localDescription";a[a.remoteDescription=2]="remoteDescription";a[a.readyState=3]="readyState";a[a.iceState=4]="iceState";a[a.localStreams=5]="localStreams";a[a.remoteStreams=6]="remoteStreams";a[a.createOffer=7]="createOffer";a[a.createAnswer=8]="createAnswer";a[a.setLocalDescription=9]="setLocalDescription";a[a.setRemoteDescription=10]="setRemoteDescription";a[a.updateIce=
11]="updateIce";a[a.addIceCandidate=12]="addIceCandidate";a[a.addStream=13]="addStream";a[a.removeStream=14]="removeStream";a[a.close=15]="close";a[a.iceConnectionState=16]="iceConnectionState";a[a.iceGatheringState=17]="iceGatheringState";a[a.signalingState=18]="signalingState";a[a.onaddstream=19]="onaddstream";a[a.onicecandidate=20]="onicecandidate";a[a.oniceconnectionstatechange=21]="oniceconnectionstatechange";a[a.onicegatheringstatechange=22]="onicegatheringstatechange";a[a.onsignalingstatechange=
23]="onsignalingstatechange";a[a.onnegotiationneeded=24]="onnegotiationneeded";a[a.onremovestream=25]="onremovestream";a[a.getStats=26]="getStats";a[a.getReceivers=27]="getReceivers";a[a.getSenders=28]="getSenders";a[a.addTrack=29]="addTrack";a[a.removeTrack=30]="removeTrack";a[a.ontrack=31]="ontrack";a[a.setLocalDescription_v2=32]="setLocalDescription_v2";a[a.setRemoteDescription_v2=33]="setRemoteDescription_v2";a[a.addTransceiverWithTrack=34]="addTransceiverWithTrack";a[a.addTransceiverWithKind=
35]="addTransceiverWithKind";a[a.getTransceivers=36]="getTransceivers";a[a.onconnectionstatechange=37]="onconnectionstatechange";a[a.sctp=38]="sctp";a[a.ondatachannel=39]="ondatachannel";a[a.createDataChannel=40]="createDataChannel";a[a.getStats_v2=41]="getStats_v2"})(e=a.method_id_RTCPeerConnection_t||(a.method_id_RTCPeerConnection_t={}));var k;(function(a){a[a.ctor=0]="ctor";a[a.enumerateDevices=1]="enumerateDevices";a[a.getDisplayMedia=2]="getDisplayMedia";a[a.ondevicechange=3]="ondevicechange"})(k=
a.method_id_MediaDevices_t||(a.method_id_MediaDevices_t={}));var m;(function(a){a[a.ctor=0]="ctor";a[a.deviceId=1]="deviceId";a[a.kind=2]="kind";a[a.label=3]="label";a[a.groupId=4]="groupId"})(m=a.method_id_MediaDeviceInfo_t||(a.method_id_MediaDeviceInfo_t={}));var p;(function(a){a[a.ctor=0]="ctor";a[a.type=1]="type";a[a.sdp=2]="sdp"})(p=a.method_id_RTCSessionDescription_t||(a.method_id_RTCSessionDescription_t={}));var l;(function(a){a[a.ctor=0]="ctor";a[a.kind=1]="kind";a[a.id=2]="id";a[a.label=
3]="label";a[a.enabled=4]="enabled";a[a.muted=5]="muted";a[a.readyState=6]="readyState";a[a.onended=7]="onended";a[a.onmute=8]="onmute";a[a.onunmute=9]="onunmute";a[a.clone=10]="clone";a[a.stop=11]="stop";a[a.getCapabilities=12]="getCapabilities";a[a.getSettings=13]="getSettings";a[a.applyConstraints=14]="applyConstraints";a[a.getConstraints=15]="getConstraints"})(l=a.method_id_MediaStreamTrack_t||(a.method_id_MediaStreamTrack_t={}));var g;(function(a){a[a.ctor=0]="ctor";a[a.id=1]="id";a[a.getAudioTracks=
2]="getAudioTracks";a[a.getVideoTracks=3]="getVideoTracks";a[a.getTracks=4]="getTracks";a[a.getTrackById=5]="getTrackById";a[a.addTrack=6]="addTrack";a[a.removeTrack=7]="removeTrack";a[a.clone=8]="clone";a[a.active=9]="active"})(g=a.method_id_MediaStream_t||(a.method_id_MediaStream_t={}));var G;(function(a){a[a.ctor=0]="ctor";a[a.getUserMedia=1]="getUserMedia";a[a.setCodecCapabilities=2]="setCodecCapabilities";a[a.getCapabilities=3]="getCapabilities"})(G=a.method_id_NavigatorUserMedia_t||(a.method_id_NavigatorUserMedia_t=
{}));var v;(function(a){a[a.ctor=0]="ctor";a[a.candidate=1]="candidate";a[a.sdpMid=2]="sdpMid";a[a.sdpMLineIndex=3]="sdpMLineIndex"})(v=a.method_id_RTCIceCandidate_t||(a.method_id_RTCIceCandidate_t={}));var t;(function(a){a[a.ctor=0]="ctor";a[a.candidate=1]="candidate"})(t=a.method_id_RTCIceCandidateEvent_t||(a.method_id_RTCIceCandidateEvent_t={}));var z;(function(a){a[a.ctor=0]="ctor";a[a.stream=1]="stream"})(z=a.method_id_MediaStreamEvent_t||(a.method_id_MediaStreamEvent_t={}));var u;(function(a){a[a.ctor=
0]="ctor";a[a.sinkId=1]="sinkId";a[a.connectTo=2]="connectTo";a[a.disconnect=3]="disconnect";a[a.setFrame=4]="setFrame";a[a.addClipRect=5]="addClipRect";a[a.removeClipRect=6]="removeClipRect";a[a.onerror=7]="onerror";a[a.onvideoframechanged=8]="onvideoframechanged";a[a.placement=9]="placement"})(u=a.method_id_VideoElement_t||(a.method_id_VideoElement_t={}));var f;(function(a){a[a.ctor=0]="ctor";a[a.sinkId=1]="sinkId";a[a.srcObject=2]="srcObject";a[a.src=3]="src";a[a.play=4]="play";a[a.pause=5]="pause"})(f=
a.method_id_AudioElement_t||(a.method_id_AudioElement_t={}));var A;(function(a){a[a.ctor=0]="ctor";a[a.track=1]="track";a[a.getContributingSources=2]="getContributingSources";a[a.getSynchronizationSources=3]="getSynchronizationSources";a[a.transport=4]="transport";a[a.rtcpTransport=5]="rtcpTransport";a[a.getCapabilities=6]="getCapabilities";a[a.getParameters=7]="getParameters";a[a.getStats=8]="getStats";a[a.getCapabilities_v2=9]="getCapabilities_v2"})(A=a.method_id_RTCRtpReceiver_t||(a.method_id_RTCRtpReceiver_t=
{}));var x;(function(a){a[a.ctor=0]="ctor";a[a.track=1]="track";a[a.transport=2]="transport";a[a.rtcpTransport=3]="rtcpTransport";a[a.dtmf=4]="dtmf";a[a.getCapabilities=5]="getCapabilities";a[a.getParameters=6]="getParameters";a[a.setParameters=7]="setParameters";a[a.replaceTrack=8]="replaceTrack";a[a.getStats=9]="getStats";a[a.setStreams=10]="setStreams";a[a.getCapabilities_v2=11]="getCapabilities_v2"})(x=a.method_id_RTCRtpSender_t||(a.method_id_RTCRtpSender_t={}));var D;(function(a){a[a.ctor=0]=
"ctor";a[a.transport=1]="transport";a[a.state=2]="state";a[a.getRemoteCertificates=3]="getRemoteCertificates";a[a.onstatechange=4]="onstatechange";a[a.onerror=5]="onerror"})(D=a.method_id_RTCDtlsTransport_t||(a.method_id_RTCDtlsTransport_t={}));var C;(function(a){a[a.ctor=0]="ctor";a[a.role=1]="role";a[a.component=2]="component";a[a.state=3]="state";a[a.gatheringState=4]="gatheringState";a[a.localcandidates=5]="localcandidates";a[a.remotecandidates=6]="remotecandidates";a[a.onstatechange=7]="onstatechange";
a[a.ongatheringstatechange=8]="ongatheringstatechange";a[a.onselectedcandidatepairchange=9]="onselectedcandidatepairchange"})(C=a.method_id_RTCIceTransport_t||(a.method_id_RTCIceTransport_t={}));var r;(function(a){a[a.ctor=0]="ctor";a[a.insertDTMF=1]="insertDTMF";a[a.ontonechange=2]="ontonechange";a[a.canInsertDTMF=3]="canInsertDTMF";a[a.toneBuffer=4]="toneBuffer"})(r=a.method_id_RTCDTMFSender_t||(a.method_id_RTCDTMFSender_t={}));var q;(function(a){a[a.ctor=0]="ctor";a[a.tone=1]="tone";a[a.tone_buffer=
2]="tone_buffer"})(q=a.method_id_RTCDTMFToneChangeEvent_t||(a.method_id_RTCDTMFToneChangeEvent_t={}));var w;(function(a){a[a.ctor=0]="ctor";a[a.local=1]="local";a[a.remote=2]="remote"})(w=a.method_id_RTCIceCandidatePair_t||(a.method_id_RTCIceCandidatePair_t={}));var B;(function(a){a[a.ctor=0]="ctor";a[a.mid=1]="mid";a[a.sender=2]="sender";a[a.receiver=3]="receiver";a[a.direction=4]="direction";a[a.currentDirection=5]="currentDirection";a[a.stop=6]="stop";a[a.setCodecPreferences=7]="setCodecPreferences"})(B=
a.method_id_RTCRtpTransceiver_t||(a.method_id_RTCRtpTransceiver_t={}));var y;(function(a){a[a.ctor=0]="ctor";a[a.label=1]="label";a[a.ordered=2]="ordered";a[a.maxPacketLifeTime=3]="maxPacketLifeTime";a[a.maxRetransmits=4]="maxRetransmits";a[a.protocol=5]="protocol";a[a.negotiated=6]="negotiated";a[a.id=7]="id";a[a.readyState=8]="readyState";a[a.bufferedAmount=9]="bufferedAmount";a[a.bufferedAmountLowThreshold=10]="bufferedAmountLowThreshold";a[a.onopen=11]="onopen";a[a.onbufferedamountlow=12]="onbufferedamountlow";
a[a.onerror=13]="onerror";a[a.onclosing=14]="onclosing";a[a.onclose=15]="onclose";a[a.onmessage=16]="onmessage";a[a.close=17]="close";a[a.send_text=18]="send_text";a[a.send_binary=19]="send_binary"})(y=a.method_id_RTCDataChannel_t||(a.method_id_RTCDataChannel_t={}));var H;(function(a){a[a.ctor=0]="ctor";a[a.transport=1]="transport";a[a.state=2]="state";a[a.maxMessageSize=3]="maxMessageSize";a[a.maxChannels=4]="maxChannels";a[a.onstatechange=5]="onstatechange"})(H=a.method_id_RTCSctpTransport_t||(a.method_id_RTCSctpTransport_t=
{}));a.class_lib_info=new b.WebrpcClassLibInfo("webrpc_class_library",[new b.WebrpcClassInfo(c.EngineControl,"EngineControl",[new b.WebrpcMethodInfo(c.EngineControl,d.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.EngineControl,d.version,"version",!0),new b.WebrpcMethodInfo(c.EngineControl,d.feature_flags,"feature_flags",!0),new b.WebrpcMethodInfo(c.EngineControl,d.version_info,"version_info",!0,a.FEATURE_ms_teams_desktop_sharing),new b.WebrpcMethodInfo(c.EngineControl,d.osinfo,"osinfo",!0,a.FEATURE_ms_teams_osinfo),
new b.WebrpcMethodInfo(c.EngineControl,d.endpoint_id,"endpoint_id",!0,a.FEATURE_ms_teams_endpoint_id)]),new b.WebrpcClassInfo(c.RTCPeerConnection,"RTCPeerConnection",[new b.WebrpcMethodInfo(c.RTCPeerConnection,e.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.localDescription,"localDescription",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.remoteDescription,"remoteDescription",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.readyState,"readyState",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,
e.iceState,"iceState",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.localStreams,"localStreams",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.remoteStreams,"remoteStreams",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.createOffer,"createOffer",!1),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.createAnswer,"createAnswer",!1),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.setLocalDescription,"setLocalDescription",!1),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.setRemoteDescription,"setRemoteDescription",
!1),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.updateIce,"updateIce",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.addIceCandidate,"addIceCandidate",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.addStream,"addStream",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.removeStream,"removeStream",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.close,"close",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.iceConnectionState,"iceConnectionState",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,
e.iceGatheringState,"iceGatheringState",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.signalingState,"signalingState",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.onaddstream,"onaddstream",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.onicecandidate,"onicecandidate",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.oniceconnectionstatechange,"oniceconnectionstatechange",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.onicegatheringstatechange,"onicegatheringstatechange",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,
e.onsignalingstatechange,"onsignalingstatechange",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.onnegotiationneeded,"onnegotiationneeded",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.onremovestream,"onremovestream",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.getStats,"getStats",!1),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.getReceivers,"getReceivers",!1,a.FEATURE_ms_teams_speaking_indicator),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.getSenders,"getSenders",!1,a.FEATURE_ms_teams_pstn),
new b.WebrpcMethodInfo(c.RTCPeerConnection,e.addTrack,"addTrack",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.removeTrack,"removeTrack",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.ontrack,"ontrack",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.setLocalDescription_v2,"setLocalDescription_v2",!1,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.setRemoteDescription_v2,"setRemoteDescription_v2",
!1,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.addTransceiverWithTrack,"addTransceiverWithTrack",!1,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.addTransceiverWithKind,"addTransceiverWithKind",!1,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.getTransceivers,"getTransceivers",!1,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.onconnectionstatechange,"onconnectionstatechange",
!0,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.sctp,"sctp",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.ondatachannel,"ondatachannel",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.createDataChannel,"createDataChannel",!1,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCPeerConnection,e.getStats_v2,"getStats_v2",!1,a.FEATURE_ms_teams_webrtc_1dot0)]),new b.WebrpcClassInfo(c.RTCSessionDescription,
"RTCSessionDescription",[new b.WebrpcMethodInfo(c.RTCSessionDescription,p.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.RTCSessionDescription,p.type,"type",!0),new b.WebrpcMethodInfo(c.RTCSessionDescription,p.sdp,"sdp",!0)]),new b.WebrpcClassInfo(c.RTCIceCandidate,"RTCIceCandidate",[new b.WebrpcMethodInfo(c.RTCIceCandidate,v.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.RTCIceCandidate,v.candidate,"candidate",!0),new b.WebrpcMethodInfo(c.RTCIceCandidate,v.sdpMid,"sdpMid",!0),new b.WebrpcMethodInfo(c.RTCIceCandidate,
v.sdpMLineIndex,"sdpMLineIndex",!0)]),new b.WebrpcClassInfo(c.RTCIceCandidateEvent,"RTCIceCandidateEvent",[new b.WebrpcMethodInfo(c.RTCIceCandidateEvent,t.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.RTCIceCandidateEvent,t.candidate,"candidate",!0)]),new b.WebrpcClassInfo(c.MediaDevices,"MediaDevices",[new b.WebrpcMethodInfo(c.MediaDevices,k.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.MediaDevices,k.enumerateDevices,"enumerateDevices",!1),new b.WebrpcMethodInfo(c.MediaDevices,k.getDisplayMedia,"getDisplayMedia",
!1,a.FEATURE_ms_teams_desktop_sharing),new b.WebrpcMethodInfo(c.MediaDevices,k.ondevicechange,"ondevicechange",!0,a.FEATURE_ms_teams_speaking_indicator)]),new b.WebrpcClassInfo(c.MediaDeviceInfo,"MediaDeviceInfo",[new b.WebrpcMethodInfo(c.MediaDeviceInfo,m.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.MediaDeviceInfo,m.deviceId,"deviceId",!0),new b.WebrpcMethodInfo(c.MediaDeviceInfo,m.kind,"kind",!0),new b.WebrpcMethodInfo(c.MediaDeviceInfo,m.label,"label",!0),new b.WebrpcMethodInfo(c.MediaDeviceInfo,
m.groupId,"groupId",!0)]),new b.WebrpcClassInfo(c.MediaStreamTrack,"MediaStreamTrack",[new b.WebrpcMethodInfo(c.MediaStreamTrack,l.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.clone,"clone",!1),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.stop,"stop",!1),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.getCapabilities,"getCapabilities",!1),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.getSettings,"getSettings",!1),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.applyConstraints,"applyConstraints",
!1,a.FEATURE_ms_teams_desktop_sharing),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.kind,"kind",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.id,"id",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.label,"label",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.enabled,"enabled",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.muted,"muted",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.readyState,"readyState",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.onended,"onended",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,
l.onmute,"onmute",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.onunmute,"onunmute",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,l.getConstraints,"getConstraints",!1,a.FEATURE_ms_teams_mstrack_constraints)]),new b.WebrpcClassInfo(c.MediaStream,"MediaStream",[new b.WebrpcMethodInfo(c.MediaStream,g.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.MediaStream,g.id,"id",!0),new b.WebrpcMethodInfo(c.MediaStream,g.getAudioTracks,"getAudioTracks",!1),new b.WebrpcMethodInfo(c.MediaStream,g.getVideoTracks,"getVideoTracks",
!1),new b.WebrpcMethodInfo(c.MediaStream,g.getTracks,"getTracks",!1),new b.WebrpcMethodInfo(c.MediaStream,g.getTrackById,"getTrackById",!1),new b.WebrpcMethodInfo(c.MediaStream,g.addTrack,"addTrack",!1),new b.WebrpcMethodInfo(c.MediaStream,g.removeTrack,"removeTrack",!1),new b.WebrpcMethodInfo(c.MediaStream,g.clone,"clone",!0),new b.WebrpcMethodInfo(c.MediaStream,g.active,"active",!0)]),new b.WebrpcClassInfo(c.NavigatorUserMedia,"NavigatorUserMedia",[new b.WebrpcMethodInfo(c.NavigatorUserMedia,G.ctor,
"ctor",!1),new b.WebrpcMethodInfo(c.NavigatorUserMedia,G.getUserMedia,"getUserMedia",!1),new b.WebrpcMethodInfo(c.NavigatorUserMedia,G.setCodecCapabilities,"setCodecCapabilities",!1,a.FEATURE_ms_teams_codec_capability),new b.WebrpcMethodInfo(c.NavigatorUserMedia,G.getCapabilities,"getRtpCapabilities",!1,a.FEATURE_ms_teams_webrtc_1dot0)]),new b.WebrpcClassInfo(c.MediaStreamEvent,"MediaStreamEvent",[new b.WebrpcMethodInfo(c.MediaStreamEvent,z.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.MediaStreamEvent,
z.stream,"stream",!0)]),new b.WebrpcClassInfo(c.VideoElement,"VideoElement",[new b.WebrpcMethodInfo(c.VideoElement,u.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.VideoElement,u.sinkId,"sinkId",!0),new b.WebrpcMethodInfo(c.VideoElement,u.connectTo,"connectTo",!1),new b.WebrpcMethodInfo(c.VideoElement,u.disconnect,"disconnect",!1),new b.WebrpcMethodInfo(c.VideoElement,u.setFrame,"setFrame",!1),new b.WebrpcMethodInfo(c.VideoElement,u.addClipRect,"addClipRect",!1),new b.WebrpcMethodInfo(c.VideoElement,u.removeClipRect,
"removeClipRect",!1),new b.WebrpcMethodInfo(c.VideoElement,u.onerror,"onerror",!0),new b.WebrpcMethodInfo(c.VideoElement,u.onvideoframechanged,"onvideoframechanged",!0),new b.WebrpcMethodInfo(c.VideoElement,u.placement,"placement",!0,a.FEATURE_ms_teams_video_placement)]),new b.WebrpcClassInfo(c.AudioElement,"AudioElement",[new b.WebrpcMethodInfo(c.AudioElement,f.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.AudioElement,f.sinkId,"sinkId",!0),new b.WebrpcMethodInfo(c.AudioElement,f.srcObject,"srcObject",
!0),new b.WebrpcMethodInfo(c.AudioElement,f.src,"src",!0),new b.WebrpcMethodInfo(c.AudioElement,f.play,"play",!1),new b.WebrpcMethodInfo(c.AudioElement,f.pause,"pause",!1)]),new b.WebrpcClassInfo(c.RTCRtpReceiver,"RTCRtpReceiver",[new b.WebrpcMethodInfo(c.RTCRtpReceiver,A.ctor,"ctor",!1,a.FEATURE_ms_teams_speaking_indicator),new b.WebrpcMethodInfo(c.RTCRtpReceiver,A.track,"track",!0,a.FEATURE_ms_teams_speaking_indicator),new b.WebrpcMethodInfo(c.RTCRtpReceiver,A.getContributingSources,"getContributingSources",
!1,a.FEATURE_ms_teams_speaking_indicator),new b.WebrpcMethodInfo(c.RTCRtpReceiver,A.getSynchronizationSources,"getSynchronizationSources",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpReceiver,A.transport,"transport",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpReceiver,A.rtcpTransport,"rtcptransport",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpReceiver,A.getCapabilities,"getCapabilities",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpReceiver,
A.getParameters,"getParameters",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpReceiver,A.getStats,"getStats",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpReceiver,A.getCapabilities_v2,"getCapabilities_v2",!1,a.FEATURE_ms_teams_webrtc_1dot0)]),new b.WebrpcClassInfo(c.RTCRtpSender,"RTCRtpSender",[new b.WebrpcMethodInfo(c.RTCRtpSender,x.ctor,"ctor",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,x.track,"track",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,
x.transport,"transport",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,x.rtcpTransport,"rtcpTransport",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,x.dtmf,"dtmf",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,x.getCapabilities,"getCapabilities",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,x.getParameters,"getParameters",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,x.setParameters,"setParameters",!1,
a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,x.replaceTrack,"replaceTrack",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,x.getStats,"getStats",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,x.setStreams,"setStreams",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,x.getCapabilities_v2,"getCapabilities_v2",!1,a.FEATURE_ms_teams_webrtc_1dot0)]),new b.WebrpcClassInfo(c.RTCDtlsTransport,"RTCDtlsTransport",[new b.WebrpcMethodInfo(c.RTCDtlsTransport,
D.ctor,"ctor",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDtlsTransport,D.transport,"transport",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDtlsTransport,D.state,"state",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDtlsTransport,D.getRemoteCertificates,"getRemoteCertificates",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDtlsTransport,D.onstatechange,"onstatechange",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDtlsTransport,D.onerror,"onerror",
!0,a.FEATURE_ms_teams_pstn)]),new b.WebrpcClassInfo(c.RTCIceTransport,"RTCIceTransport",[new b.WebrpcMethodInfo(c.RTCIceTransport,C.ctor,"ctor",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,C.role,"role",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,C.component,"component",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,C.state,"state",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,C.gatheringState,"gatheringState",
!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,C.localcandidates,"localcandidates",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,C.remotecandidates,"remotecandidates",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,C.onstatechange,"onstatechange",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,C.ongatheringstatechange,"ongatheringstatechange",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,
C.onselectedcandidatepairchange,"onselectedcandidatepairchange",!0,a.FEATURE_ms_teams_pstn)]),new b.WebrpcClassInfo(c.RTCDTMFSender,"RTCDTMFSender",[new b.WebrpcMethodInfo(c.RTCDTMFSender,r.ctor,"ctor",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDTMFSender,r.insertDTMF,"insertDTMF",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDTMFSender,r.ontonechange,"ontonechange",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDTMFSender,r.canInsertDTMF,"canInsertDTMF",!0,a.FEATURE_ms_teams_pstn),
new b.WebrpcMethodInfo(c.RTCDTMFSender,r.toneBuffer,"toneBuffer",!0,a.FEATURE_ms_teams_pstn)]),new b.WebrpcClassInfo(c.RTCDTMFToneChangeEvent,"RTCDTMFToneChangeEvent",[new b.WebrpcMethodInfo(c.RTCDTMFToneChangeEvent,q.ctor,"ctor",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDTMFToneChangeEvent,q.tone,"tone",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDTMFToneChangeEvent,q.tone_buffer,"tone_buffer",!0,a.FEATURE_ms_teams_pstn)]),new b.WebrpcClassInfo(c.RTCIceCandidatePair,"RTCIceCandidatePair",
[new b.WebrpcMethodInfo(c.RTCIceCandidatePair,w.ctor,"ctor",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceCandidatePair,w.local,"local",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceCandidatePair,w.remote,"remote",!0,a.FEATURE_ms_teams_pstn)]),new b.WebrpcClassInfo(c.RTCRtpTransceiver,"RTCRtpTransceiver",[new b.WebrpcMethodInfo(c.RTCRtpTransceiver,B.ctor,"ctor",!1,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCRtpTransceiver,B.mid,"mid",!0,a.FEATURE_ms_teams_webrtc_1dot0),
new b.WebrpcMethodInfo(c.RTCRtpTransceiver,B.sender,"sender",!0,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCRtpTransceiver,B.receiver,"receiver",!0,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCRtpTransceiver,B.direction,"direction",!0,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCRtpTransceiver,B.currentDirection,"currentDirection",!0,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCRtpTransceiver,B.stop,"stop",!1,a.FEATURE_ms_teams_webrtc_1dot0),
new b.WebrpcMethodInfo(c.RTCRtpTransceiver,B.setCodecPreferences,"setCodecPreferences",!1,a.FEATURE_ms_teams_webrtc_1dot0)]),new b.WebrpcClassInfo(c.RTCDataChannel,"RTCDataChannel",[new b.WebrpcMethodInfo(c.RTCDataChannel,y.ctor,"ctor",!1,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.label,"label",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.ordered,"ordered",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.maxPacketLifeTime,
"maxPacketLifeTime",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.maxRetransmits,"maxRetransmits",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.protocol,"protocol",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.negotiated,"negotiated",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.id,"id",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.readyState,
"readyState",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.bufferedAmount,"bufferedAmount",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.bufferedAmountLowThreshold,"bufferedAmountLowThreshold",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.onopen,"onopen",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.onbufferedamountlow,"onbufferedamountlow",!0,a.FEATURE_ms_teams_data_channel),
new b.WebrpcMethodInfo(c.RTCDataChannel,y.onerror,"onerror",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.onclosing,"onclosing",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.onclose,"onclose",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.onmessage,"onmessage",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.close,"close",!1,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,
y.send_text,"send_text",!1,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,y.send_binary,"send_binary",!1,a.FEATURE_ms_teams_data_channel)]),new b.WebrpcClassInfo(c.RTCSctpTransport,"RTCSctpTransport",[new b.WebrpcMethodInfo(c.RTCSctpTransport,H.ctor,"ctor",!1,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCSctpTransport,H.transport,"transport",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCSctpTransport,H.state,"state",!0,a.FEATURE_ms_teams_data_channel),
new b.WebrpcMethodInfo(c.RTCSctpTransport,H.maxMessageSize,"maxMessageSize",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCSctpTransport,H.maxChannels,"maxChannels",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCSctpTransport,H.onstatechange,"onstatechange",!0,a.FEATURE_ms_teams_data_channel)])])},545:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});var d=c(550),e;(function(a){a[a.req=0]="req";a[a.reply=1]="reply";a[a.event_req=2]="event_req";a[a.event_reply=
3]="event_reply"})(e=a.ws_msg_type_t||(a.ws_msg_type_t={}));b=function(){function a(){}a.createMessageByid=function(a,b,c,e,k,n){for(var t=[],z=6;z<arguments.length;z++)t[z-6]=arguments[z];(z=d.WebrpcClassLibInfoUtil.getMethodByid(e,k))&&z.isprop||(a=!1);return this.createMessage.apply(this,[c,a,b,e,k,n].concat(t))};a.createMessage=function(a,b,c,d,e,k){for(var n=[],z=6;z<arguments.length;z++)n[z-6]=arguments[z];return{v:"webrtc",hdr:{version:this._version,msg_type:this.getMsgType(a),modifier:b,destroy:c,
proc:{iid:d,methodid:e}},objref:{oid:k},params:n.slice()}};a.getMsgType=function(a){var b="";switch(a){default:b="req";break;case e.reply:b="reply";break;case e.event_req:b="event-req";break;case e.event_reply:b="event-reply"}return b};a._version=1;return a}();a.WsJsonUtil=b}},k={};return d(307)}()});

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],2:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/object/create"), __esModule: true };
},{"core-js/library/fn/object/create":20}],3:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/object/define-property"), __esModule: true };
},{"core-js/library/fn/object/define-property":21}],4:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/object/get-own-property-descriptor"), __esModule: true };
},{"core-js/library/fn/object/get-own-property-descriptor":22}],5:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/object/get-prototype-of"), __esModule: true };
},{"core-js/library/fn/object/get-prototype-of":23}],6:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/object/set-prototype-of"), __esModule: true };
},{"core-js/library/fn/object/set-prototype-of":24}],7:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/promise"), __esModule: true };
},{"core-js/library/fn/promise":25}],8:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/symbol"), __esModule: true };
},{"core-js/library/fn/symbol":26}],9:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/symbol/iterator"), __esModule: true };
},{"core-js/library/fn/symbol/iterator":27}],10:[function(require,module,exports){
"use strict";

exports.__esModule = true;

var _promise = require("../core-js/promise");

var _promise2 = _interopRequireDefault(_promise);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function (fn) {
  return function () {
    var gen = fn.apply(this, arguments);
    return new _promise2.default(function (resolve, reject) {
      function step(key, arg) {
        try {
          var info = gen[key](arg);
          var value = info.value;
        } catch (error) {
          reject(error);
          return;
        }

        if (info.done) {
          resolve(value);
        } else {
          return _promise2.default.resolve(value).then(function (value) {
            step("next", value);
          }, function (err) {
            step("throw", err);
          });
        }
      }

      return step("next");
    });
  };
};
},{"../core-js/promise":7}],11:[function(require,module,exports){
"use strict";

exports.__esModule = true;

exports.default = function (instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
};
},{}],12:[function(require,module,exports){
"use strict";

exports.__esModule = true;

var _defineProperty = require("../core-js/object/define-property");

var _defineProperty2 = _interopRequireDefault(_defineProperty);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function () {
  function defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      (0, _defineProperty2.default)(target, descriptor.key, descriptor);
    }
  }

  return function (Constructor, protoProps, staticProps) {
    if (protoProps) defineProperties(Constructor.prototype, protoProps);
    if (staticProps) defineProperties(Constructor, staticProps);
    return Constructor;
  };
}();
},{"../core-js/object/define-property":3}],13:[function(require,module,exports){
"use strict";

exports.__esModule = true;

var _getPrototypeOf = require("../core-js/object/get-prototype-of");

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

var _getOwnPropertyDescriptor = require("../core-js/object/get-own-property-descriptor");

var _getOwnPropertyDescriptor2 = _interopRequireDefault(_getOwnPropertyDescriptor);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function get(object, property, receiver) {
  if (object === null) object = Function.prototype;
  var desc = (0, _getOwnPropertyDescriptor2.default)(object, property);

  if (desc === undefined) {
    var parent = (0, _getPrototypeOf2.default)(object);

    if (parent === null) {
      return undefined;
    } else {
      return get(parent, property, receiver);
    }
  } else if ("value" in desc) {
    return desc.value;
  } else {
    var getter = desc.get;

    if (getter === undefined) {
      return undefined;
    }

    return getter.call(receiver);
  }
};
},{"../core-js/object/get-own-property-descriptor":4,"../core-js/object/get-prototype-of":5}],14:[function(require,module,exports){
"use strict";

exports.__esModule = true;

var _setPrototypeOf = require("../core-js/object/set-prototype-of");

var _setPrototypeOf2 = _interopRequireDefault(_setPrototypeOf);

var _create = require("../core-js/object/create");

var _create2 = _interopRequireDefault(_create);

var _typeof2 = require("../helpers/typeof");

var _typeof3 = _interopRequireDefault(_typeof2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function (subClass, superClass) {
  if (typeof superClass !== "function" && superClass !== null) {
    throw new TypeError("Super expression must either be null or a function, not " + (typeof superClass === "undefined" ? "undefined" : (0, _typeof3.default)(superClass)));
  }

  subClass.prototype = (0, _create2.default)(superClass && superClass.prototype, {
    constructor: {
      value: subClass,
      enumerable: false,
      writable: true,
      configurable: true
    }
  });
  if (superClass) _setPrototypeOf2.default ? (0, _setPrototypeOf2.default)(subClass, superClass) : subClass.__proto__ = superClass;
};
},{"../core-js/object/create":2,"../core-js/object/set-prototype-of":6,"../helpers/typeof":16}],15:[function(require,module,exports){
"use strict";

exports.__esModule = true;

var _typeof2 = require("../helpers/typeof");

var _typeof3 = _interopRequireDefault(_typeof2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function (self, call) {
  if (!self) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }

  return call && ((typeof call === "undefined" ? "undefined" : (0, _typeof3.default)(call)) === "object" || typeof call === "function") ? call : self;
};
},{"../helpers/typeof":16}],16:[function(require,module,exports){
"use strict";

exports.__esModule = true;

var _iterator = require("../core-js/symbol/iterator");

var _iterator2 = _interopRequireDefault(_iterator);

var _symbol = require("../core-js/symbol");

var _symbol2 = _interopRequireDefault(_symbol);

var _typeof = typeof _symbol2.default === "function" && typeof _iterator2.default === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof _symbol2.default === "function" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? "symbol" : typeof obj; };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = typeof _symbol2.default === "function" && _typeof(_iterator2.default) === "symbol" ? function (obj) {
  return typeof obj === "undefined" ? "undefined" : _typeof(obj);
} : function (obj) {
  return obj && typeof _symbol2.default === "function" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? "symbol" : typeof obj === "undefined" ? "undefined" : _typeof(obj);
};
},{"../core-js/symbol":8,"../core-js/symbol/iterator":9}],17:[function(require,module,exports){
/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

// This method of obtaining a reference to the global object needs to be
// kept identical to the way it is obtained in runtime.js
var g = (function() { return this })() || Function("return this")();

// Use `getOwnPropertyNames` because not all browsers support calling
// `hasOwnProperty` on the global `self` object in a worker. See #183.
var hadRuntime = g.regeneratorRuntime &&
  Object.getOwnPropertyNames(g).indexOf("regeneratorRuntime") >= 0;

// Save the old regeneratorRuntime in case it needs to be restored later.
var oldRuntime = hadRuntime && g.regeneratorRuntime;

// Force reevalutation of runtime.js.
g.regeneratorRuntime = undefined;

module.exports = require("./runtime");

if (hadRuntime) {
  // Restore the original runtime.
  g.regeneratorRuntime = oldRuntime;
} else {
  // Remove the global property added by runtime.js.
  try {
    delete g.regeneratorRuntime;
  } catch(e) {
    g.regeneratorRuntime = undefined;
  }
}

},{"./runtime":18}],18:[function(require,module,exports){
/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

!(function(global) {
  "use strict";

  var Op = Object.prototype;
  var hasOwn = Op.hasOwnProperty;
  var undefined; // More compressible than void 0.
  var $Symbol = typeof Symbol === "function" ? Symbol : {};
  var iteratorSymbol = $Symbol.iterator || "@@iterator";
  var asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator";
  var toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag";

  var inModule = typeof module === "object";
  var runtime = global.regeneratorRuntime;
  if (runtime) {
    if (inModule) {
      // If regeneratorRuntime is defined globally and we're in a module,
      // make the exports object identical to regeneratorRuntime.
      module.exports = runtime;
    }
    // Don't bother evaluating the rest of this file if the runtime was
    // already defined globally.
    return;
  }

  // Define the runtime globally (as expected by generated code) as either
  // module.exports (if we're in a module) or a new, empty object.
  runtime = global.regeneratorRuntime = inModule ? module.exports : {};

  function wrap(innerFn, outerFn, self, tryLocsList) {
    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.
    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;
    var generator = Object.create(protoGenerator.prototype);
    var context = new Context(tryLocsList || []);

    // The ._invoke method unifies the implementations of the .next,
    // .throw, and .return methods.
    generator._invoke = makeInvokeMethod(innerFn, self, context);

    return generator;
  }
  runtime.wrap = wrap;

  // Try/catch helper to minimize deoptimizations. Returns a completion
  // record like context.tryEntries[i].completion. This interface could
  // have been (and was previously) designed to take a closure to be
  // invoked without arguments, but in all the cases we care about we
  // already have an existing method we want to call, so there's no need
  // to create a new function object. We can even get away with assuming
  // the method takes exactly one argument, since that happens to be true
  // in every case, so we don't have to touch the arguments object. The
  // only additional allocation required is the completion record, which
  // has a stable shape and so hopefully should be cheap to allocate.
  function tryCatch(fn, obj, arg) {
    try {
      return { type: "normal", arg: fn.call(obj, arg) };
    } catch (err) {
      return { type: "throw", arg: err };
    }
  }

  var GenStateSuspendedStart = "suspendedStart";
  var GenStateSuspendedYield = "suspendedYield";
  var GenStateExecuting = "executing";
  var GenStateCompleted = "completed";

  // Returning this object from the innerFn has the same effect as
  // breaking out of the dispatch switch statement.
  var ContinueSentinel = {};

  // Dummy constructor functions that we use as the .constructor and
  // .constructor.prototype properties for functions that return Generator
  // objects. For full spec compliance, you may wish to configure your
  // minifier not to mangle the names of these two functions.
  function Generator() {}
  function GeneratorFunction() {}
  function GeneratorFunctionPrototype() {}

  // This is a polyfill for %IteratorPrototype% for environments that
  // don't natively support it.
  var IteratorPrototype = {};
  IteratorPrototype[iteratorSymbol] = function () {
    return this;
  };

  var getProto = Object.getPrototypeOf;
  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));
  if (NativeIteratorPrototype &&
      NativeIteratorPrototype !== Op &&
      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {
    // This environment has a native %IteratorPrototype%; use it instead
    // of the polyfill.
    IteratorPrototype = NativeIteratorPrototype;
  }

  var Gp = GeneratorFunctionPrototype.prototype =
    Generator.prototype = Object.create(IteratorPrototype);
  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;
  GeneratorFunctionPrototype.constructor = GeneratorFunction;
  GeneratorFunctionPrototype[toStringTagSymbol] =
    GeneratorFunction.displayName = "GeneratorFunction";

  // Helper for defining the .next, .throw, and .return methods of the
  // Iterator interface in terms of a single ._invoke method.
  function defineIteratorMethods(prototype) {
    ["next", "throw", "return"].forEach(function(method) {
      prototype[method] = function(arg) {
        return this._invoke(method, arg);
      };
    });
  }

  runtime.isGeneratorFunction = function(genFun) {
    var ctor = typeof genFun === "function" && genFun.constructor;
    return ctor
      ? ctor === GeneratorFunction ||
        // For the native GeneratorFunction constructor, the best we can
        // do is to check its .name property.
        (ctor.displayName || ctor.name) === "GeneratorFunction"
      : false;
  };

  runtime.mark = function(genFun) {
    if (Object.setPrototypeOf) {
      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);
    } else {
      genFun.__proto__ = GeneratorFunctionPrototype;
      if (!(toStringTagSymbol in genFun)) {
        genFun[toStringTagSymbol] = "GeneratorFunction";
      }
    }
    genFun.prototype = Object.create(Gp);
    return genFun;
  };

  // Within the body of any async function, `await x` is transformed to
  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test
  // `hasOwn.call(value, "__await")` to determine if the yielded value is
  // meant to be awaited.
  runtime.awrap = function(arg) {
    return { __await: arg };
  };

  function AsyncIterator(generator) {
    function invoke(method, arg, resolve, reject) {
      var record = tryCatch(generator[method], generator, arg);
      if (record.type === "throw") {
        reject(record.arg);
      } else {
        var result = record.arg;
        var value = result.value;
        if (value &&
            typeof value === "object" &&
            hasOwn.call(value, "__await")) {
          return Promise.resolve(value.__await).then(function(value) {
            invoke("next", value, resolve, reject);
          }, function(err) {
            invoke("throw", err, resolve, reject);
          });
        }

        return Promise.resolve(value).then(function(unwrapped) {
          // When a yielded Promise is resolved, its final value becomes
          // the .value of the Promise<{value,done}> result for the
          // current iteration. If the Promise is rejected, however, the
          // result for this iteration will be rejected with the same
          // reason. Note that rejections of yielded Promises are not
          // thrown back into the generator function, as is the case
          // when an awaited Promise is rejected. This difference in
          // behavior between yield and await is important, because it
          // allows the consumer to decide what to do with the yielded
          // rejection (swallow it and continue, manually .throw it back
          // into the generator, abandon iteration, whatever). With
          // await, by contrast, there is no opportunity to examine the
          // rejection reason outside the generator function, so the
          // only option is to throw it from the await expression, and
          // let the generator function handle the exception.
          result.value = unwrapped;
          resolve(result);
        }, reject);
      }
    }

    var previousPromise;

    function enqueue(method, arg) {
      function callInvokeWithMethodAndArg() {
        return new Promise(function(resolve, reject) {
          invoke(method, arg, resolve, reject);
        });
      }

      return previousPromise =
        // If enqueue has been called before, then we want to wait until
        // all previous Promises have been resolved before calling invoke,
        // so that results are always delivered in the correct order. If
        // enqueue has not been called before, then it is important to
        // call invoke immediately, without waiting on a callback to fire,
        // so that the async generator function has the opportunity to do
        // any necessary setup in a predictable way. This predictability
        // is why the Promise constructor synchronously invokes its
        // executor callback, and why async functions synchronously
        // execute code before the first await. Since we implement simple
        // async functions in terms of async generators, it is especially
        // important to get this right, even though it requires care.
        previousPromise ? previousPromise.then(
          callInvokeWithMethodAndArg,
          // Avoid propagating failures to Promises returned by later
          // invocations of the iterator.
          callInvokeWithMethodAndArg
        ) : callInvokeWithMethodAndArg();
    }

    // Define the unified helper method that is used to implement .next,
    // .throw, and .return (see defineIteratorMethods).
    this._invoke = enqueue;
  }

  defineIteratorMethods(AsyncIterator.prototype);
  AsyncIterator.prototype[asyncIteratorSymbol] = function () {
    return this;
  };
  runtime.AsyncIterator = AsyncIterator;

  // Note that simple async functions are implemented on top of
  // AsyncIterator objects; they just return a Promise for the value of
  // the final result produced by the iterator.
  runtime.async = function(innerFn, outerFn, self, tryLocsList) {
    var iter = new AsyncIterator(
      wrap(innerFn, outerFn, self, tryLocsList)
    );

    return runtime.isGeneratorFunction(outerFn)
      ? iter // If outerFn is a generator, return the full iterator.
      : iter.next().then(function(result) {
          return result.done ? result.value : iter.next();
        });
  };

  function makeInvokeMethod(innerFn, self, context) {
    var state = GenStateSuspendedStart;

    return function invoke(method, arg) {
      if (state === GenStateExecuting) {
        throw new Error("Generator is already running");
      }

      if (state === GenStateCompleted) {
        if (method === "throw") {
          throw arg;
        }

        // Be forgiving, per 25.3.3.3.3 of the spec:
        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume
        return doneResult();
      }

      context.method = method;
      context.arg = arg;

      while (true) {
        var delegate = context.delegate;
        if (delegate) {
          var delegateResult = maybeInvokeDelegate(delegate, context);
          if (delegateResult) {
            if (delegateResult === ContinueSentinel) continue;
            return delegateResult;
          }
        }

        if (context.method === "next") {
          // Setting context._sent for legacy support of Babel's
          // function.sent implementation.
          context.sent = context._sent = context.arg;

        } else if (context.method === "throw") {
          if (state === GenStateSuspendedStart) {
            state = GenStateCompleted;
            throw context.arg;
          }

          context.dispatchException(context.arg);

        } else if (context.method === "return") {
          context.abrupt("return", context.arg);
        }

        state = GenStateExecuting;

        var record = tryCatch(innerFn, self, context);
        if (record.type === "normal") {
          // If an exception is thrown from innerFn, we leave state ===
          // GenStateExecuting and loop back for another invocation.
          state = context.done
            ? GenStateCompleted
            : GenStateSuspendedYield;

          if (record.arg === ContinueSentinel) {
            continue;
          }

          return {
            value: record.arg,
            done: context.done
          };

        } else if (record.type === "throw") {
          state = GenStateCompleted;
          // Dispatch the exception by looping back around to the
          // context.dispatchException(context.arg) call above.
          context.method = "throw";
          context.arg = record.arg;
        }
      }
    };
  }

  // Call delegate.iterator[context.method](context.arg) and handle the
  // result, either by returning a { value, done } result from the
  // delegate iterator, or by modifying context.method and context.arg,
  // setting context.delegate to null, and returning the ContinueSentinel.
  function maybeInvokeDelegate(delegate, context) {
    var method = delegate.iterator[context.method];
    if (method === undefined) {
      // A .throw or .return when the delegate iterator has no .throw
      // method always terminates the yield* loop.
      context.delegate = null;

      if (context.method === "throw") {
        if (delegate.iterator.return) {
          // If the delegate iterator has a return method, give it a
          // chance to clean up.
          context.method = "return";
          context.arg = undefined;
          maybeInvokeDelegate(delegate, context);

          if (context.method === "throw") {
            // If maybeInvokeDelegate(context) changed context.method from
            // "return" to "throw", let that override the TypeError below.
            return ContinueSentinel;
          }
        }

        context.method = "throw";
        context.arg = new TypeError(
          "The iterator does not provide a 'throw' method");
      }

      return ContinueSentinel;
    }

    var record = tryCatch(method, delegate.iterator, context.arg);

    if (record.type === "throw") {
      context.method = "throw";
      context.arg = record.arg;
      context.delegate = null;
      return ContinueSentinel;
    }

    var info = record.arg;

    if (! info) {
      context.method = "throw";
      context.arg = new TypeError("iterator result is not an object");
      context.delegate = null;
      return ContinueSentinel;
    }

    if (info.done) {
      // Assign the result of the finished delegate to the temporary
      // variable specified by delegate.resultName (see delegateYield).
      context[delegate.resultName] = info.value;

      // Resume execution at the desired location (see delegateYield).
      context.next = delegate.nextLoc;

      // If context.method was "throw" but the delegate handled the
      // exception, let the outer generator proceed normally. If
      // context.method was "next", forget context.arg since it has been
      // "consumed" by the delegate iterator. If context.method was
      // "return", allow the original .return call to continue in the
      // outer generator.
      if (context.method !== "return") {
        context.method = "next";
        context.arg = undefined;
      }

    } else {
      // Re-yield the result returned by the delegate method.
      return info;
    }

    // The delegate iterator is finished, so forget it and continue with
    // the outer generator.
    context.delegate = null;
    return ContinueSentinel;
  }

  // Define Generator.prototype.{next,throw,return} in terms of the
  // unified ._invoke helper method.
  defineIteratorMethods(Gp);

  Gp[toStringTagSymbol] = "Generator";

  // A Generator should always return itself as the iterator object when the
  // @@iterator function is called on it. Some browsers' implementations of the
  // iterator prototype chain incorrectly implement this, causing the Generator
  // object to not be returned from this call. This ensures that doesn't happen.
  // See https://github.com/facebook/regenerator/issues/274 for more details.
  Gp[iteratorSymbol] = function() {
    return this;
  };

  Gp.toString = function() {
    return "[object Generator]";
  };

  function pushTryEntry(locs) {
    var entry = { tryLoc: locs[0] };

    if (1 in locs) {
      entry.catchLoc = locs[1];
    }

    if (2 in locs) {
      entry.finallyLoc = locs[2];
      entry.afterLoc = locs[3];
    }

    this.tryEntries.push(entry);
  }

  function resetTryEntry(entry) {
    var record = entry.completion || {};
    record.type = "normal";
    delete record.arg;
    entry.completion = record;
  }

  function Context(tryLocsList) {
    // The root entry object (effectively a try statement without a catch
    // or a finally block) gives us a place to store values thrown from
    // locations where there is no enclosing try statement.
    this.tryEntries = [{ tryLoc: "root" }];
    tryLocsList.forEach(pushTryEntry, this);
    this.reset(true);
  }

  runtime.keys = function(object) {
    var keys = [];
    for (var key in object) {
      keys.push(key);
    }
    keys.reverse();

    // Rather than returning an object with a next method, we keep
    // things simple and return the next function itself.
    return function next() {
      while (keys.length) {
        var key = keys.pop();
        if (key in object) {
          next.value = key;
          next.done = false;
          return next;
        }
      }

      // To avoid creating an additional object, we just hang the .value
      // and .done properties off the next function object itself. This
      // also ensures that the minifier will not anonymize the function.
      next.done = true;
      return next;
    };
  };

  function values(iterable) {
    if (iterable) {
      var iteratorMethod = iterable[iteratorSymbol];
      if (iteratorMethod) {
        return iteratorMethod.call(iterable);
      }

      if (typeof iterable.next === "function") {
        return iterable;
      }

      if (!isNaN(iterable.length)) {
        var i = -1, next = function next() {
          while (++i < iterable.length) {
            if (hasOwn.call(iterable, i)) {
              next.value = iterable[i];
              next.done = false;
              return next;
            }
          }

          next.value = undefined;
          next.done = true;

          return next;
        };

        return next.next = next;
      }
    }

    // Return an iterator with no values.
    return { next: doneResult };
  }
  runtime.values = values;

  function doneResult() {
    return { value: undefined, done: true };
  }

  Context.prototype = {
    constructor: Context,

    reset: function(skipTempReset) {
      this.prev = 0;
      this.next = 0;
      // Resetting context._sent for legacy support of Babel's
      // function.sent implementation.
      this.sent = this._sent = undefined;
      this.done = false;
      this.delegate = null;

      this.method = "next";
      this.arg = undefined;

      this.tryEntries.forEach(resetTryEntry);

      if (!skipTempReset) {
        for (var name in this) {
          // Not sure about the optimal order of these conditions:
          if (name.charAt(0) === "t" &&
              hasOwn.call(this, name) &&
              !isNaN(+name.slice(1))) {
            this[name] = undefined;
          }
        }
      }
    },

    stop: function() {
      this.done = true;

      var rootEntry = this.tryEntries[0];
      var rootRecord = rootEntry.completion;
      if (rootRecord.type === "throw") {
        throw rootRecord.arg;
      }

      return this.rval;
    },

    dispatchException: function(exception) {
      if (this.done) {
        throw exception;
      }

      var context = this;
      function handle(loc, caught) {
        record.type = "throw";
        record.arg = exception;
        context.next = loc;

        if (caught) {
          // If the dispatched exception was caught by a catch block,
          // then let that catch block handle the exception normally.
          context.method = "next";
          context.arg = undefined;
        }

        return !! caught;
      }

      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        var record = entry.completion;

        if (entry.tryLoc === "root") {
          // Exception thrown outside of any try block that could handle
          // it, so set the completion value of the entire function to
          // throw the exception.
          return handle("end");
        }

        if (entry.tryLoc <= this.prev) {
          var hasCatch = hasOwn.call(entry, "catchLoc");
          var hasFinally = hasOwn.call(entry, "finallyLoc");

          if (hasCatch && hasFinally) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            } else if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else if (hasCatch) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            }

          } else if (hasFinally) {
            if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else {
            throw new Error("try statement without catch or finally");
          }
        }
      }
    },

    abrupt: function(type, arg) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc <= this.prev &&
            hasOwn.call(entry, "finallyLoc") &&
            this.prev < entry.finallyLoc) {
          var finallyEntry = entry;
          break;
        }
      }

      if (finallyEntry &&
          (type === "break" ||
           type === "continue") &&
          finallyEntry.tryLoc <= arg &&
          arg <= finallyEntry.finallyLoc) {
        // Ignore the finally entry if control is not jumping to a
        // location outside the try/catch block.
        finallyEntry = null;
      }

      var record = finallyEntry ? finallyEntry.completion : {};
      record.type = type;
      record.arg = arg;

      if (finallyEntry) {
        this.method = "next";
        this.next = finallyEntry.finallyLoc;
        return ContinueSentinel;
      }

      return this.complete(record);
    },

    complete: function(record, afterLoc) {
      if (record.type === "throw") {
        throw record.arg;
      }

      if (record.type === "break" ||
          record.type === "continue") {
        this.next = record.arg;
      } else if (record.type === "return") {
        this.rval = this.arg = record.arg;
        this.method = "return";
        this.next = "end";
      } else if (record.type === "normal" && afterLoc) {
        this.next = afterLoc;
      }

      return ContinueSentinel;
    },

    finish: function(finallyLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.finallyLoc === finallyLoc) {
          this.complete(entry.completion, entry.afterLoc);
          resetTryEntry(entry);
          return ContinueSentinel;
        }
      }
    },

    "catch": function(tryLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc === tryLoc) {
          var record = entry.completion;
          if (record.type === "throw") {
            var thrown = record.arg;
            resetTryEntry(entry);
          }
          return thrown;
        }
      }

      // The context.catch method must only be called with a location
      // argument that corresponds to a known catch block.
      throw new Error("illegal catch attempt");
    },

    delegateYield: function(iterable, resultName, nextLoc) {
      this.delegate = {
        iterator: values(iterable),
        resultName: resultName,
        nextLoc: nextLoc
      };

      if (this.method === "next") {
        // Deliberately forget the last sent value so that we don't
        // accidentally pass it on to the delegate.
        this.arg = undefined;
      }

      return ContinueSentinel;
    }
  };
})(
  // In sloppy mode, unbound `this` refers to the global object, fallback to
  // Function constructor if we're in global strict mode. That is sadly a form
  // of indirect eval which violates Content Security Policy.
  (function() { return this })() || Function("return this")()
);

},{}],19:[function(require,module,exports){
module.exports = require("regenerator-runtime");

},{"regenerator-runtime":17}],20:[function(require,module,exports){
require('../../modules/es6.object.create');
var $Object = require('../../modules/_core').Object;
module.exports = function create(P, D) {
  return $Object.create(P, D);
};

},{"../../modules/_core":35,"../../modules/es6.object.create":103}],21:[function(require,module,exports){
require('../../modules/es6.object.define-property');
var $Object = require('../../modules/_core').Object;
module.exports = function defineProperty(it, key, desc) {
  return $Object.defineProperty(it, key, desc);
};

},{"../../modules/_core":35,"../../modules/es6.object.define-property":104}],22:[function(require,module,exports){
require('../../modules/es6.object.get-own-property-descriptor');
var $Object = require('../../modules/_core').Object;
module.exports = function getOwnPropertyDescriptor(it, key) {
  return $Object.getOwnPropertyDescriptor(it, key);
};

},{"../../modules/_core":35,"../../modules/es6.object.get-own-property-descriptor":105}],23:[function(require,module,exports){
require('../../modules/es6.object.get-prototype-of');
module.exports = require('../../modules/_core').Object.getPrototypeOf;

},{"../../modules/_core":35,"../../modules/es6.object.get-prototype-of":106}],24:[function(require,module,exports){
require('../../modules/es6.object.set-prototype-of');
module.exports = require('../../modules/_core').Object.setPrototypeOf;

},{"../../modules/_core":35,"../../modules/es6.object.set-prototype-of":107}],25:[function(require,module,exports){
require('../modules/es6.object.to-string');
require('../modules/es6.string.iterator');
require('../modules/web.dom.iterable');
require('../modules/es6.promise');
require('../modules/es7.promise.finally');
require('../modules/es7.promise.try');
module.exports = require('../modules/_core').Promise;

},{"../modules/_core":35,"../modules/es6.object.to-string":108,"../modules/es6.promise":109,"../modules/es6.string.iterator":110,"../modules/es7.promise.finally":112,"../modules/es7.promise.try":113,"../modules/web.dom.iterable":116}],26:[function(require,module,exports){
require('../../modules/es6.symbol');
require('../../modules/es6.object.to-string');
require('../../modules/es7.symbol.async-iterator');
require('../../modules/es7.symbol.observable');
module.exports = require('../../modules/_core').Symbol;

},{"../../modules/_core":35,"../../modules/es6.object.to-string":108,"../../modules/es6.symbol":111,"../../modules/es7.symbol.async-iterator":114,"../../modules/es7.symbol.observable":115}],27:[function(require,module,exports){
require('../../modules/es6.string.iterator');
require('../../modules/web.dom.iterable');
module.exports = require('../../modules/_wks-ext').f('iterator');

},{"../../modules/_wks-ext":99,"../../modules/es6.string.iterator":110,"../../modules/web.dom.iterable":116}],28:[function(require,module,exports){
module.exports = function (it) {
  if (typeof it != 'function') throw TypeError(it + ' is not a function!');
  return it;
};

},{}],29:[function(require,module,exports){
module.exports = function () { /* empty */ };

},{}],30:[function(require,module,exports){
module.exports = function (it, Constructor, name, forbiddenField) {
  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {
    throw TypeError(name + ': incorrect invocation!');
  } return it;
};

},{}],31:[function(require,module,exports){
var isObject = require('./_is-object');
module.exports = function (it) {
  if (!isObject(it)) throw TypeError(it + ' is not an object!');
  return it;
};

},{"./_is-object":54}],32:[function(require,module,exports){
// false -> Array#indexOf
// true  -> Array#includes
var toIObject = require('./_to-iobject');
var toLength = require('./_to-length');
var toAbsoluteIndex = require('./_to-absolute-index');
module.exports = function (IS_INCLUDES) {
  return function ($this, el, fromIndex) {
    var O = toIObject($this);
    var length = toLength(O.length);
    var index = toAbsoluteIndex(fromIndex, length);
    var value;
    // Array#includes uses SameValueZero equality algorithm
    // eslint-disable-next-line no-self-compare
    if (IS_INCLUDES && el != el) while (length > index) {
      value = O[index++];
      // eslint-disable-next-line no-self-compare
      if (value != value) return true;
    // Array#indexOf ignores holes, Array#includes - not
    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {
      if (O[index] === el) return IS_INCLUDES || index || 0;
    } return !IS_INCLUDES && -1;
  };
};

},{"./_to-absolute-index":90,"./_to-iobject":92,"./_to-length":93}],33:[function(require,module,exports){
// getting tag from 19.1.3.6 Object.prototype.toString()
var cof = require('./_cof');
var TAG = require('./_wks')('toStringTag');
// ES3 wrong here
var ARG = cof(function () { return arguments; }()) == 'Arguments';

// fallback for IE11 Script Access Denied error
var tryGet = function (it, key) {
  try {
    return it[key];
  } catch (e) { /* empty */ }
};

module.exports = function (it) {
  var O, T, B;
  return it === undefined ? 'Undefined' : it === null ? 'Null'
    // @@toStringTag case
    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T
    // builtinTag case
    : ARG ? cof(O)
    // ES3 arguments fallback
    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;
};

},{"./_cof":34,"./_wks":100}],34:[function(require,module,exports){
var toString = {}.toString;

module.exports = function (it) {
  return toString.call(it).slice(8, -1);
};

},{}],35:[function(require,module,exports){
var core = module.exports = { version: '2.6.12' };
if (typeof __e == 'number') __e = core; // eslint-disable-line no-undef

},{}],36:[function(require,module,exports){
// optional / simple context binding
var aFunction = require('./_a-function');
module.exports = function (fn, that, length) {
  aFunction(fn);
  if (that === undefined) return fn;
  switch (length) {
    case 1: return function (a) {
      return fn.call(that, a);
    };
    case 2: return function (a, b) {
      return fn.call(that, a, b);
    };
    case 3: return function (a, b, c) {
      return fn.call(that, a, b, c);
    };
  }
  return function (/* ...args */) {
    return fn.apply(that, arguments);
  };
};

},{"./_a-function":28}],37:[function(require,module,exports){
// 7.2.1 RequireObjectCoercible(argument)
module.exports = function (it) {
  if (it == undefined) throw TypeError("Can't call method on  " + it);
  return it;
};

},{}],38:[function(require,module,exports){
// Thank's IE8 for his funny defineProperty
module.exports = !require('./_fails')(function () {
  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;
});

},{"./_fails":43}],39:[function(require,module,exports){
var isObject = require('./_is-object');
var document = require('./_global').document;
// typeof document.createElement is 'object' in old IE
var is = isObject(document) && isObject(document.createElement);
module.exports = function (it) {
  return is ? document.createElement(it) : {};
};

},{"./_global":45,"./_is-object":54}],40:[function(require,module,exports){
// IE 8- don't enum bug keys
module.exports = (
  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'
).split(',');

},{}],41:[function(require,module,exports){
// all enumerable object keys, includes symbols
var getKeys = require('./_object-keys');
var gOPS = require('./_object-gops');
var pIE = require('./_object-pie');
module.exports = function (it) {
  var result = getKeys(it);
  var getSymbols = gOPS.f;
  if (getSymbols) {
    var symbols = getSymbols(it);
    var isEnum = pIE.f;
    var i = 0;
    var key;
    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);
  } return result;
};

},{"./_object-gops":71,"./_object-keys":74,"./_object-pie":75}],42:[function(require,module,exports){
var global = require('./_global');
var core = require('./_core');
var ctx = require('./_ctx');
var hide = require('./_hide');
var has = require('./_has');
var PROTOTYPE = 'prototype';

var $export = function (type, name, source) {
  var IS_FORCED = type & $export.F;
  var IS_GLOBAL = type & $export.G;
  var IS_STATIC = type & $export.S;
  var IS_PROTO = type & $export.P;
  var IS_BIND = type & $export.B;
  var IS_WRAP = type & $export.W;
  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});
  var expProto = exports[PROTOTYPE];
  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE];
  var key, own, out;
  if (IS_GLOBAL) source = name;
  for (key in source) {
    // contains in native
    own = !IS_FORCED && target && target[key] !== undefined;
    if (own && has(exports, key)) continue;
    // export native or passed
    out = own ? target[key] : source[key];
    // prevent global pollution for namespaces
    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]
    // bind timers to global for call from export context
    : IS_BIND && own ? ctx(out, global)
    // wrap global constructors for prevent change them in library
    : IS_WRAP && target[key] == out ? (function (C) {
      var F = function (a, b, c) {
        if (this instanceof C) {
          switch (arguments.length) {
            case 0: return new C();
            case 1: return new C(a);
            case 2: return new C(a, b);
          } return new C(a, b, c);
        } return C.apply(this, arguments);
      };
      F[PROTOTYPE] = C[PROTOTYPE];
      return F;
    // make static versions for prototype methods
    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;
    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%
    if (IS_PROTO) {
      (exports.virtual || (exports.virtual = {}))[key] = out;
      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%
      if (type & $export.R && expProto && !expProto[key]) hide(expProto, key, out);
    }
  }
};
// type bitmap
$export.F = 1;   // forced
$export.G = 2;   // global
$export.S = 4;   // static
$export.P = 8;   // proto
$export.B = 16;  // bind
$export.W = 32;  // wrap
$export.U = 64;  // safe
$export.R = 128; // real proto method for `library`
module.exports = $export;

},{"./_core":35,"./_ctx":36,"./_global":45,"./_has":46,"./_hide":47}],43:[function(require,module,exports){
module.exports = function (exec) {
  try {
    return !!exec();
  } catch (e) {
    return true;
  }
};

},{}],44:[function(require,module,exports){
var ctx = require('./_ctx');
var call = require('./_iter-call');
var isArrayIter = require('./_is-array-iter');
var anObject = require('./_an-object');
var toLength = require('./_to-length');
var getIterFn = require('./core.get-iterator-method');
var BREAK = {};
var RETURN = {};
var exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {
  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);
  var f = ctx(fn, that, entries ? 2 : 1);
  var index = 0;
  var length, step, iterator, result;
  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');
  // fast case for arrays with default iterator
  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {
    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);
    if (result === BREAK || result === RETURN) return result;
  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {
    result = call(iterator, f, step.value, entries);
    if (result === BREAK || result === RETURN) return result;
  }
};
exports.BREAK = BREAK;
exports.RETURN = RETURN;

},{"./_an-object":31,"./_ctx":36,"./_is-array-iter":52,"./_iter-call":55,"./_to-length":93,"./core.get-iterator-method":101}],45:[function(require,module,exports){
// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028
var global = module.exports = typeof window != 'undefined' && window.Math == Math
  ? window : typeof self != 'undefined' && self.Math == Math ? self
  // eslint-disable-next-line no-new-func
  : Function('return this')();
if (typeof __g == 'number') __g = global; // eslint-disable-line no-undef

},{}],46:[function(require,module,exports){
var hasOwnProperty = {}.hasOwnProperty;
module.exports = function (it, key) {
  return hasOwnProperty.call(it, key);
};

},{}],47:[function(require,module,exports){
var dP = require('./_object-dp');
var createDesc = require('./_property-desc');
module.exports = require('./_descriptors') ? function (object, key, value) {
  return dP.f(object, key, createDesc(1, value));
} : function (object, key, value) {
  object[key] = value;
  return object;
};

},{"./_descriptors":38,"./_object-dp":66,"./_property-desc":79}],48:[function(require,module,exports){
var document = require('./_global').document;
module.exports = document && document.documentElement;

},{"./_global":45}],49:[function(require,module,exports){
module.exports = !require('./_descriptors') && !require('./_fails')(function () {
  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;
});

},{"./_descriptors":38,"./_dom-create":39,"./_fails":43}],50:[function(require,module,exports){
// fast apply, http://jsperf.lnkit.com/fast-apply/5
module.exports = function (fn, args, that) {
  var un = that === undefined;
  switch (args.length) {
    case 0: return un ? fn()
                      : fn.call(that);
    case 1: return un ? fn(args[0])
                      : fn.call(that, args[0]);
    case 2: return un ? fn(args[0], args[1])
                      : fn.call(that, args[0], args[1]);
    case 3: return un ? fn(args[0], args[1], args[2])
                      : fn.call(that, args[0], args[1], args[2]);
    case 4: return un ? fn(args[0], args[1], args[2], args[3])
                      : fn.call(that, args[0], args[1], args[2], args[3]);
  } return fn.apply(that, args);
};

},{}],51:[function(require,module,exports){
// fallback for non-array-like ES3 and non-enumerable old V8 strings
var cof = require('./_cof');
// eslint-disable-next-line no-prototype-builtins
module.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {
  return cof(it) == 'String' ? it.split('') : Object(it);
};

},{"./_cof":34}],52:[function(require,module,exports){
// check on default Array iterator
var Iterators = require('./_iterators');
var ITERATOR = require('./_wks')('iterator');
var ArrayProto = Array.prototype;

module.exports = function (it) {
  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);
};

},{"./_iterators":60,"./_wks":100}],53:[function(require,module,exports){
// 7.2.2 IsArray(argument)
var cof = require('./_cof');
module.exports = Array.isArray || function isArray(arg) {
  return cof(arg) == 'Array';
};

},{"./_cof":34}],54:[function(require,module,exports){
module.exports = function (it) {
  return typeof it === 'object' ? it !== null : typeof it === 'function';
};

},{}],55:[function(require,module,exports){
// call something on iterator step with safe closing on error
var anObject = require('./_an-object');
module.exports = function (iterator, fn, value, entries) {
  try {
    return entries ? fn(anObject(value)[0], value[1]) : fn(value);
  // 7.4.6 IteratorClose(iterator, completion)
  } catch (e) {
    var ret = iterator['return'];
    if (ret !== undefined) anObject(ret.call(iterator));
    throw e;
  }
};

},{"./_an-object":31}],56:[function(require,module,exports){
'use strict';
var create = require('./_object-create');
var descriptor = require('./_property-desc');
var setToStringTag = require('./_set-to-string-tag');
var IteratorPrototype = {};

// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()
require('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function () { return this; });

module.exports = function (Constructor, NAME, next) {
  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });
  setToStringTag(Constructor, NAME + ' Iterator');
};

},{"./_hide":47,"./_object-create":65,"./_property-desc":79,"./_set-to-string-tag":84,"./_wks":100}],57:[function(require,module,exports){
'use strict';
var LIBRARY = require('./_library');
var $export = require('./_export');
var redefine = require('./_redefine');
var hide = require('./_hide');
var Iterators = require('./_iterators');
var $iterCreate = require('./_iter-create');
var setToStringTag = require('./_set-to-string-tag');
var getPrototypeOf = require('./_object-gpo');
var ITERATOR = require('./_wks')('iterator');
var BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`
var FF_ITERATOR = '@@iterator';
var KEYS = 'keys';
var VALUES = 'values';

var returnThis = function () { return this; };

module.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {
  $iterCreate(Constructor, NAME, next);
  var getMethod = function (kind) {
    if (!BUGGY && kind in proto) return proto[kind];
    switch (kind) {
      case KEYS: return function keys() { return new Constructor(this, kind); };
      case VALUES: return function values() { return new Constructor(this, kind); };
    } return function entries() { return new Constructor(this, kind); };
  };
  var TAG = NAME + ' Iterator';
  var DEF_VALUES = DEFAULT == VALUES;
  var VALUES_BUG = false;
  var proto = Base.prototype;
  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];
  var $default = $native || getMethod(DEFAULT);
  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;
  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;
  var methods, key, IteratorPrototype;
  // Fix native
  if ($anyNative) {
    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));
    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {
      // Set @@toStringTag to native iterators
      setToStringTag(IteratorPrototype, TAG, true);
      // fix for some old engines
      if (!LIBRARY && typeof IteratorPrototype[ITERATOR] != 'function') hide(IteratorPrototype, ITERATOR, returnThis);
    }
  }
  // fix Array#{values, @@iterator}.name in V8 / FF
  if (DEF_VALUES && $native && $native.name !== VALUES) {
    VALUES_BUG = true;
    $default = function values() { return $native.call(this); };
  }
  // Define iterator
  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {
    hide(proto, ITERATOR, $default);
  }
  // Plug for library
  Iterators[NAME] = $default;
  Iterators[TAG] = returnThis;
  if (DEFAULT) {
    methods = {
      values: DEF_VALUES ? $default : getMethod(VALUES),
      keys: IS_SET ? $default : getMethod(KEYS),
      entries: $entries
    };
    if (FORCED) for (key in methods) {
      if (!(key in proto)) redefine(proto, key, methods[key]);
    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);
  }
  return methods;
};

},{"./_export":42,"./_hide":47,"./_iter-create":56,"./_iterators":60,"./_library":61,"./_object-gpo":72,"./_redefine":81,"./_set-to-string-tag":84,"./_wks":100}],58:[function(require,module,exports){
var ITERATOR = require('./_wks')('iterator');
var SAFE_CLOSING = false;

try {
  var riter = [7][ITERATOR]();
  riter['return'] = function () { SAFE_CLOSING = true; };
  // eslint-disable-next-line no-throw-literal
  Array.from(riter, function () { throw 2; });
} catch (e) { /* empty */ }

module.exports = function (exec, skipClosing) {
  if (!skipClosing && !SAFE_CLOSING) return false;
  var safe = false;
  try {
    var arr = [7];
    var iter = arr[ITERATOR]();
    iter.next = function () { return { done: safe = true }; };
    arr[ITERATOR] = function () { return iter; };
    exec(arr);
  } catch (e) { /* empty */ }
  return safe;
};

},{"./_wks":100}],59:[function(require,module,exports){
module.exports = function (done, value) {
  return { value: value, done: !!done };
};

},{}],60:[function(require,module,exports){
module.exports = {};

},{}],61:[function(require,module,exports){
module.exports = true;

},{}],62:[function(require,module,exports){
var META = require('./_uid')('meta');
var isObject = require('./_is-object');
var has = require('./_has');
var setDesc = require('./_object-dp').f;
var id = 0;
var isExtensible = Object.isExtensible || function () {
  return true;
};
var FREEZE = !require('./_fails')(function () {
  return isExtensible(Object.preventExtensions({}));
});
var setMeta = function (it) {
  setDesc(it, META, { value: {
    i: 'O' + ++id, // object ID
    w: {}          // weak collections IDs
  } });
};
var fastKey = function (it, create) {
  // return primitive with prefix
  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return 'F';
    // not necessary to add metadata
    if (!create) return 'E';
    // add missing metadata
    setMeta(it);
  // return object ID
  } return it[META].i;
};
var getWeak = function (it, create) {
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return true;
    // not necessary to add metadata
    if (!create) return false;
    // add missing metadata
    setMeta(it);
  // return hash weak collections IDs
  } return it[META].w;
};
// add metadata on freeze-family methods calling
var onFreeze = function (it) {
  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);
  return it;
};
var meta = module.exports = {
  KEY: META,
  NEED: false,
  fastKey: fastKey,
  getWeak: getWeak,
  onFreeze: onFreeze
};

},{"./_fails":43,"./_has":46,"./_is-object":54,"./_object-dp":66,"./_uid":96}],63:[function(require,module,exports){
var global = require('./_global');
var macrotask = require('./_task').set;
var Observer = global.MutationObserver || global.WebKitMutationObserver;
var process = global.process;
var Promise = global.Promise;
var isNode = require('./_cof')(process) == 'process';

module.exports = function () {
  var head, last, notify;

  var flush = function () {
    var parent, fn;
    if (isNode && (parent = process.domain)) parent.exit();
    while (head) {
      fn = head.fn;
      head = head.next;
      try {
        fn();
      } catch (e) {
        if (head) notify();
        else last = undefined;
        throw e;
      }
    } last = undefined;
    if (parent) parent.enter();
  };

  // Node.js
  if (isNode) {
    notify = function () {
      process.nextTick(flush);
    };
  // browsers with MutationObserver, except iOS Safari - https://github.com/zloirock/core-js/issues/339
  } else if (Observer && !(global.navigator && global.navigator.standalone)) {
    var toggle = true;
    var node = document.createTextNode('');
    new Observer(flush).observe(node, { characterData: true }); // eslint-disable-line no-new
    notify = function () {
      node.data = toggle = !toggle;
    };
  // environments with maybe non-completely correct, but existent Promise
  } else if (Promise && Promise.resolve) {
    // Promise.resolve without an argument throws an error in LG WebOS 2
    var promise = Promise.resolve(undefined);
    notify = function () {
      promise.then(flush);
    };
  // for other environments - macrotask based on:
  // - setImmediate
  // - MessageChannel
  // - window.postMessag
  // - onreadystatechange
  // - setTimeout
  } else {
    notify = function () {
      // strange IE + webpack dev server bug - use .call(global)
      macrotask.call(global, flush);
    };
  }

  return function (fn) {
    var task = { fn: fn, next: undefined };
    if (last) last.next = task;
    if (!head) {
      head = task;
      notify();
    } last = task;
  };
};

},{"./_cof":34,"./_global":45,"./_task":89}],64:[function(require,module,exports){
'use strict';
// 25.4.1.5 NewPromiseCapability(C)
var aFunction = require('./_a-function');

function PromiseCapability(C) {
  var resolve, reject;
  this.promise = new C(function ($$resolve, $$reject) {
    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');
    resolve = $$resolve;
    reject = $$reject;
  });
  this.resolve = aFunction(resolve);
  this.reject = aFunction(reject);
}

module.exports.f = function (C) {
  return new PromiseCapability(C);
};

},{"./_a-function":28}],65:[function(require,module,exports){
// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])
var anObject = require('./_an-object');
var dPs = require('./_object-dps');
var enumBugKeys = require('./_enum-bug-keys');
var IE_PROTO = require('./_shared-key')('IE_PROTO');
var Empty = function () { /* empty */ };
var PROTOTYPE = 'prototype';

// Create object with fake `null` prototype: use iframe Object with cleared prototype
var createDict = function () {
  // Thrash, waste and sodomy: IE GC bug
  var iframe = require('./_dom-create')('iframe');
  var i = enumBugKeys.length;
  var lt = '<';
  var gt = '>';
  var iframeDocument;
  iframe.style.display = 'none';
  require('./_html').appendChild(iframe);
  iframe.src = 'javascript:'; // eslint-disable-line no-script-url
  // createDict = iframe.contentWindow.Object;
  // html.removeChild(iframe);
  iframeDocument = iframe.contentWindow.document;
  iframeDocument.open();
  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);
  iframeDocument.close();
  createDict = iframeDocument.F;
  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];
  return createDict();
};

module.exports = Object.create || function create(O, Properties) {
  var result;
  if (O !== null) {
    Empty[PROTOTYPE] = anObject(O);
    result = new Empty();
    Empty[PROTOTYPE] = null;
    // add "__proto__" for Object.getPrototypeOf polyfill
    result[IE_PROTO] = O;
  } else result = createDict();
  return Properties === undefined ? result : dPs(result, Properties);
};

},{"./_an-object":31,"./_dom-create":39,"./_enum-bug-keys":40,"./_html":48,"./_object-dps":67,"./_shared-key":85}],66:[function(require,module,exports){
var anObject = require('./_an-object');
var IE8_DOM_DEFINE = require('./_ie8-dom-define');
var toPrimitive = require('./_to-primitive');
var dP = Object.defineProperty;

exports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {
  anObject(O);
  P = toPrimitive(P, true);
  anObject(Attributes);
  if (IE8_DOM_DEFINE) try {
    return dP(O, P, Attributes);
  } catch (e) { /* empty */ }
  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');
  if ('value' in Attributes) O[P] = Attributes.value;
  return O;
};

},{"./_an-object":31,"./_descriptors":38,"./_ie8-dom-define":49,"./_to-primitive":95}],67:[function(require,module,exports){
var dP = require('./_object-dp');
var anObject = require('./_an-object');
var getKeys = require('./_object-keys');

module.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {
  anObject(O);
  var keys = getKeys(Properties);
  var length = keys.length;
  var i = 0;
  var P;
  while (length > i) dP.f(O, P = keys[i++], Properties[P]);
  return O;
};

},{"./_an-object":31,"./_descriptors":38,"./_object-dp":66,"./_object-keys":74}],68:[function(require,module,exports){
var pIE = require('./_object-pie');
var createDesc = require('./_property-desc');
var toIObject = require('./_to-iobject');
var toPrimitive = require('./_to-primitive');
var has = require('./_has');
var IE8_DOM_DEFINE = require('./_ie8-dom-define');
var gOPD = Object.getOwnPropertyDescriptor;

exports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P) {
  O = toIObject(O);
  P = toPrimitive(P, true);
  if (IE8_DOM_DEFINE) try {
    return gOPD(O, P);
  } catch (e) { /* empty */ }
  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);
};

},{"./_descriptors":38,"./_has":46,"./_ie8-dom-define":49,"./_object-pie":75,"./_property-desc":79,"./_to-iobject":92,"./_to-primitive":95}],69:[function(require,module,exports){
// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window
var toIObject = require('./_to-iobject');
var gOPN = require('./_object-gopn').f;
var toString = {}.toString;

var windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames
  ? Object.getOwnPropertyNames(window) : [];

var getWindowNames = function (it) {
  try {
    return gOPN(it);
  } catch (e) {
    return windowNames.slice();
  }
};

module.exports.f = function getOwnPropertyNames(it) {
  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));
};

},{"./_object-gopn":70,"./_to-iobject":92}],70:[function(require,module,exports){
// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)
var $keys = require('./_object-keys-internal');
var hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');

exports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {
  return $keys(O, hiddenKeys);
};

},{"./_enum-bug-keys":40,"./_object-keys-internal":73}],71:[function(require,module,exports){
exports.f = Object.getOwnPropertySymbols;

},{}],72:[function(require,module,exports){
// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)
var has = require('./_has');
var toObject = require('./_to-object');
var IE_PROTO = require('./_shared-key')('IE_PROTO');
var ObjectProto = Object.prototype;

module.exports = Object.getPrototypeOf || function (O) {
  O = toObject(O);
  if (has(O, IE_PROTO)) return O[IE_PROTO];
  if (typeof O.constructor == 'function' && O instanceof O.constructor) {
    return O.constructor.prototype;
  } return O instanceof Object ? ObjectProto : null;
};

},{"./_has":46,"./_shared-key":85,"./_to-object":94}],73:[function(require,module,exports){
var has = require('./_has');
var toIObject = require('./_to-iobject');
var arrayIndexOf = require('./_array-includes')(false);
var IE_PROTO = require('./_shared-key')('IE_PROTO');

module.exports = function (object, names) {
  var O = toIObject(object);
  var i = 0;
  var result = [];
  var key;
  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);
  // Don't enum bug & hidden keys
  while (names.length > i) if (has(O, key = names[i++])) {
    ~arrayIndexOf(result, key) || result.push(key);
  }
  return result;
};

},{"./_array-includes":32,"./_has":46,"./_shared-key":85,"./_to-iobject":92}],74:[function(require,module,exports){
// 19.1.2.14 / 15.2.3.14 Object.keys(O)
var $keys = require('./_object-keys-internal');
var enumBugKeys = require('./_enum-bug-keys');

module.exports = Object.keys || function keys(O) {
  return $keys(O, enumBugKeys);
};

},{"./_enum-bug-keys":40,"./_object-keys-internal":73}],75:[function(require,module,exports){
exports.f = {}.propertyIsEnumerable;

},{}],76:[function(require,module,exports){
// most Object methods by ES6 should accept primitives
var $export = require('./_export');
var core = require('./_core');
var fails = require('./_fails');
module.exports = function (KEY, exec) {
  var fn = (core.Object || {})[KEY] || Object[KEY];
  var exp = {};
  exp[KEY] = exec(fn);
  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);
};

},{"./_core":35,"./_export":42,"./_fails":43}],77:[function(require,module,exports){
module.exports = function (exec) {
  try {
    return { e: false, v: exec() };
  } catch (e) {
    return { e: true, v: e };
  }
};

},{}],78:[function(require,module,exports){
var anObject = require('./_an-object');
var isObject = require('./_is-object');
var newPromiseCapability = require('./_new-promise-capability');

module.exports = function (C, x) {
  anObject(C);
  if (isObject(x) && x.constructor === C) return x;
  var promiseCapability = newPromiseCapability.f(C);
  var resolve = promiseCapability.resolve;
  resolve(x);
  return promiseCapability.promise;
};

},{"./_an-object":31,"./_is-object":54,"./_new-promise-capability":64}],79:[function(require,module,exports){
module.exports = function (bitmap, value) {
  return {
    enumerable: !(bitmap & 1),
    configurable: !(bitmap & 2),
    writable: !(bitmap & 4),
    value: value
  };
};

},{}],80:[function(require,module,exports){
var hide = require('./_hide');
module.exports = function (target, src, safe) {
  for (var key in src) {
    if (safe && target[key]) target[key] = src[key];
    else hide(target, key, src[key]);
  } return target;
};

},{"./_hide":47}],81:[function(require,module,exports){
module.exports = require('./_hide');

},{"./_hide":47}],82:[function(require,module,exports){
// Works with __proto__ only. Old v8 can't work with null proto objects.
/* eslint-disable no-proto */
var isObject = require('./_is-object');
var anObject = require('./_an-object');
var check = function (O, proto) {
  anObject(O);
  if (!isObject(proto) && proto !== null) throw TypeError(proto + ": can't set as prototype!");
};
module.exports = {
  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line
    function (test, buggy, set) {
      try {
        set = require('./_ctx')(Function.call, require('./_object-gopd').f(Object.prototype, '__proto__').set, 2);
        set(test, []);
        buggy = !(test instanceof Array);
      } catch (e) { buggy = true; }
      return function setPrototypeOf(O, proto) {
        check(O, proto);
        if (buggy) O.__proto__ = proto;
        else set(O, proto);
        return O;
      };
    }({}, false) : undefined),
  check: check
};

},{"./_an-object":31,"./_ctx":36,"./_is-object":54,"./_object-gopd":68}],83:[function(require,module,exports){
'use strict';
var global = require('./_global');
var core = require('./_core');
var dP = require('./_object-dp');
var DESCRIPTORS = require('./_descriptors');
var SPECIES = require('./_wks')('species');

module.exports = function (KEY) {
  var C = typeof core[KEY] == 'function' ? core[KEY] : global[KEY];
  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {
    configurable: true,
    get: function () { return this; }
  });
};

},{"./_core":35,"./_descriptors":38,"./_global":45,"./_object-dp":66,"./_wks":100}],84:[function(require,module,exports){
var def = require('./_object-dp').f;
var has = require('./_has');
var TAG = require('./_wks')('toStringTag');

module.exports = function (it, tag, stat) {
  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });
};

},{"./_has":46,"./_object-dp":66,"./_wks":100}],85:[function(require,module,exports){
var shared = require('./_shared')('keys');
var uid = require('./_uid');
module.exports = function (key) {
  return shared[key] || (shared[key] = uid(key));
};

},{"./_shared":86,"./_uid":96}],86:[function(require,module,exports){
var core = require('./_core');
var global = require('./_global');
var SHARED = '__core-js_shared__';
var store = global[SHARED] || (global[SHARED] = {});

(module.exports = function (key, value) {
  return store[key] || (store[key] = value !== undefined ? value : {});
})('versions', []).push({
  version: core.version,
  mode: require('./_library') ? 'pure' : 'global',
  copyright: ' 2020 Denis Pushkarev (zloirock.ru)'
});

},{"./_core":35,"./_global":45,"./_library":61}],87:[function(require,module,exports){
// 7.3.20 SpeciesConstructor(O, defaultConstructor)
var anObject = require('./_an-object');
var aFunction = require('./_a-function');
var SPECIES = require('./_wks')('species');
module.exports = function (O, D) {
  var C = anObject(O).constructor;
  var S;
  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);
};

},{"./_a-function":28,"./_an-object":31,"./_wks":100}],88:[function(require,module,exports){
var toInteger = require('./_to-integer');
var defined = require('./_defined');
// true  -> String#at
// false -> String#codePointAt
module.exports = function (TO_STRING) {
  return function (that, pos) {
    var s = String(defined(that));
    var i = toInteger(pos);
    var l = s.length;
    var a, b;
    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;
    a = s.charCodeAt(i);
    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff
      ? TO_STRING ? s.charAt(i) : a
      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;
  };
};

},{"./_defined":37,"./_to-integer":91}],89:[function(require,module,exports){
var ctx = require('./_ctx');
var invoke = require('./_invoke');
var html = require('./_html');
var cel = require('./_dom-create');
var global = require('./_global');
var process = global.process;
var setTask = global.setImmediate;
var clearTask = global.clearImmediate;
var MessageChannel = global.MessageChannel;
var Dispatch = global.Dispatch;
var counter = 0;
var queue = {};
var ONREADYSTATECHANGE = 'onreadystatechange';
var defer, channel, port;
var run = function () {
  var id = +this;
  // eslint-disable-next-line no-prototype-builtins
  if (queue.hasOwnProperty(id)) {
    var fn = queue[id];
    delete queue[id];
    fn();
  }
};
var listener = function (event) {
  run.call(event.data);
};
// Node.js 0.9+ & IE10+ has setImmediate, otherwise:
if (!setTask || !clearTask) {
  setTask = function setImmediate(fn) {
    var args = [];
    var i = 1;
    while (arguments.length > i) args.push(arguments[i++]);
    queue[++counter] = function () {
      // eslint-disable-next-line no-new-func
      invoke(typeof fn == 'function' ? fn : Function(fn), args);
    };
    defer(counter);
    return counter;
  };
  clearTask = function clearImmediate(id) {
    delete queue[id];
  };
  // Node.js 0.8-
  if (require('./_cof')(process) == 'process') {
    defer = function (id) {
      process.nextTick(ctx(run, id, 1));
    };
  // Sphere (JS game engine) Dispatch API
  } else if (Dispatch && Dispatch.now) {
    defer = function (id) {
      Dispatch.now(ctx(run, id, 1));
    };
  // Browsers with MessageChannel, includes WebWorkers
  } else if (MessageChannel) {
    channel = new MessageChannel();
    port = channel.port2;
    channel.port1.onmessage = listener;
    defer = ctx(port.postMessage, port, 1);
  // Browsers with postMessage, skip WebWorkers
  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'
  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {
    defer = function (id) {
      global.postMessage(id + '', '*');
    };
    global.addEventListener('message', listener, false);
  // IE8-
  } else if (ONREADYSTATECHANGE in cel('script')) {
    defer = function (id) {
      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {
        html.removeChild(this);
        run.call(id);
      };
    };
  // Rest old browsers
  } else {
    defer = function (id) {
      setTimeout(ctx(run, id, 1), 0);
    };
  }
}
module.exports = {
  set: setTask,
  clear: clearTask
};

},{"./_cof":34,"./_ctx":36,"./_dom-create":39,"./_global":45,"./_html":48,"./_invoke":50}],90:[function(require,module,exports){
var toInteger = require('./_to-integer');
var max = Math.max;
var min = Math.min;
module.exports = function (index, length) {
  index = toInteger(index);
  return index < 0 ? max(index + length, 0) : min(index, length);
};

},{"./_to-integer":91}],91:[function(require,module,exports){
// 7.1.4 ToInteger
var ceil = Math.ceil;
var floor = Math.floor;
module.exports = function (it) {
  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);
};

},{}],92:[function(require,module,exports){
// to indexed object, toObject with fallback for non-array-like ES3 strings
var IObject = require('./_iobject');
var defined = require('./_defined');
module.exports = function (it) {
  return IObject(defined(it));
};

},{"./_defined":37,"./_iobject":51}],93:[function(require,module,exports){
// 7.1.15 ToLength
var toInteger = require('./_to-integer');
var min = Math.min;
module.exports = function (it) {
  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991
};

},{"./_to-integer":91}],94:[function(require,module,exports){
// 7.1.13 ToObject(argument)
var defined = require('./_defined');
module.exports = function (it) {
  return Object(defined(it));
};

},{"./_defined":37}],95:[function(require,module,exports){
// 7.1.1 ToPrimitive(input [, PreferredType])
var isObject = require('./_is-object');
// instead of the ES6 spec version, we didn't implement @@toPrimitive case
// and the second argument - flag - preferred type is a string
module.exports = function (it, S) {
  if (!isObject(it)) return it;
  var fn, val;
  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;
  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;
  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;
  throw TypeError("Can't convert object to primitive value");
};

},{"./_is-object":54}],96:[function(require,module,exports){
var id = 0;
var px = Math.random();
module.exports = function (key) {
  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));
};

},{}],97:[function(require,module,exports){
var global = require('./_global');
var navigator = global.navigator;

module.exports = navigator && navigator.userAgent || '';

},{"./_global":45}],98:[function(require,module,exports){
var global = require('./_global');
var core = require('./_core');
var LIBRARY = require('./_library');
var wksExt = require('./_wks-ext');
var defineProperty = require('./_object-dp').f;
module.exports = function (name) {
  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});
  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });
};

},{"./_core":35,"./_global":45,"./_library":61,"./_object-dp":66,"./_wks-ext":99}],99:[function(require,module,exports){
exports.f = require('./_wks');

},{"./_wks":100}],100:[function(require,module,exports){
var store = require('./_shared')('wks');
var uid = require('./_uid');
var Symbol = require('./_global').Symbol;
var USE_SYMBOL = typeof Symbol == 'function';

var $exports = module.exports = function (name) {
  return store[name] || (store[name] =
    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));
};

$exports.store = store;

},{"./_global":45,"./_shared":86,"./_uid":96}],101:[function(require,module,exports){
var classof = require('./_classof');
var ITERATOR = require('./_wks')('iterator');
var Iterators = require('./_iterators');
module.exports = require('./_core').getIteratorMethod = function (it) {
  if (it != undefined) return it[ITERATOR]
    || it['@@iterator']
    || Iterators[classof(it)];
};

},{"./_classof":33,"./_core":35,"./_iterators":60,"./_wks":100}],102:[function(require,module,exports){
'use strict';
var addToUnscopables = require('./_add-to-unscopables');
var step = require('./_iter-step');
var Iterators = require('./_iterators');
var toIObject = require('./_to-iobject');

// 22.1.3.4 Array.prototype.entries()
// 22.1.3.13 Array.prototype.keys()
// 22.1.3.29 Array.prototype.values()
// 22.1.3.30 Array.prototype[@@iterator]()
module.exports = require('./_iter-define')(Array, 'Array', function (iterated, kind) {
  this._t = toIObject(iterated); // target
  this._i = 0;                   // next index
  this._k = kind;                // kind
// 22.1.5.2.1 %ArrayIteratorPrototype%.next()
}, function () {
  var O = this._t;
  var kind = this._k;
  var index = this._i++;
  if (!O || index >= O.length) {
    this._t = undefined;
    return step(1);
  }
  if (kind == 'keys') return step(0, index);
  if (kind == 'values') return step(0, O[index]);
  return step(0, [index, O[index]]);
}, 'values');

// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)
Iterators.Arguments = Iterators.Array;

addToUnscopables('keys');
addToUnscopables('values');
addToUnscopables('entries');

},{"./_add-to-unscopables":29,"./_iter-define":57,"./_iter-step":59,"./_iterators":60,"./_to-iobject":92}],103:[function(require,module,exports){
var $export = require('./_export');
// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])
$export($export.S, 'Object', { create: require('./_object-create') });

},{"./_export":42,"./_object-create":65}],104:[function(require,module,exports){
var $export = require('./_export');
// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)
$export($export.S + $export.F * !require('./_descriptors'), 'Object', { defineProperty: require('./_object-dp').f });

},{"./_descriptors":38,"./_export":42,"./_object-dp":66}],105:[function(require,module,exports){
// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)
var toIObject = require('./_to-iobject');
var $getOwnPropertyDescriptor = require('./_object-gopd').f;

require('./_object-sap')('getOwnPropertyDescriptor', function () {
  return function getOwnPropertyDescriptor(it, key) {
    return $getOwnPropertyDescriptor(toIObject(it), key);
  };
});

},{"./_object-gopd":68,"./_object-sap":76,"./_to-iobject":92}],106:[function(require,module,exports){
// 19.1.2.9 Object.getPrototypeOf(O)
var toObject = require('./_to-object');
var $getPrototypeOf = require('./_object-gpo');

require('./_object-sap')('getPrototypeOf', function () {
  return function getPrototypeOf(it) {
    return $getPrototypeOf(toObject(it));
  };
});

},{"./_object-gpo":72,"./_object-sap":76,"./_to-object":94}],107:[function(require,module,exports){
// 19.1.3.19 Object.setPrototypeOf(O, proto)
var $export = require('./_export');
$export($export.S, 'Object', { setPrototypeOf: require('./_set-proto').set });

},{"./_export":42,"./_set-proto":82}],108:[function(require,module,exports){

},{}],109:[function(require,module,exports){
'use strict';
var LIBRARY = require('./_library');
var global = require('./_global');
var ctx = require('./_ctx');
var classof = require('./_classof');
var $export = require('./_export');
var isObject = require('./_is-object');
var aFunction = require('./_a-function');
var anInstance = require('./_an-instance');
var forOf = require('./_for-of');
var speciesConstructor = require('./_species-constructor');
var task = require('./_task').set;
var microtask = require('./_microtask')();
var newPromiseCapabilityModule = require('./_new-promise-capability');
var perform = require('./_perform');
var userAgent = require('./_user-agent');
var promiseResolve = require('./_promise-resolve');
var PROMISE = 'Promise';
var TypeError = global.TypeError;
var process = global.process;
var versions = process && process.versions;
var v8 = versions && versions.v8 || '';
var $Promise = global[PROMISE];
var isNode = classof(process) == 'process';
var empty = function () { /* empty */ };
var Internal, newGenericPromiseCapability, OwnPromiseCapability, Wrapper;
var newPromiseCapability = newGenericPromiseCapability = newPromiseCapabilityModule.f;

var USE_NATIVE = !!function () {
  try {
    // correct subclassing with @@species support
    var promise = $Promise.resolve(1);
    var FakePromise = (promise.constructor = {})[require('./_wks')('species')] = function (exec) {
      exec(empty, empty);
    };
    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test
    return (isNode || typeof PromiseRejectionEvent == 'function')
      && promise.then(empty) instanceof FakePromise
      // v8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables
      // https://bugs.chromium.org/p/chromium/issues/detail?id=830565
      // we can't detect it synchronously, so just check versions
      && v8.indexOf('6.6') !== 0
      && userAgent.indexOf('Chrome/66') === -1;
  } catch (e) { /* empty */ }
}();

// helpers
var isThenable = function (it) {
  var then;
  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;
};
var notify = function (promise, isReject) {
  if (promise._n) return;
  promise._n = true;
  var chain = promise._c;
  microtask(function () {
    var value = promise._v;
    var ok = promise._s == 1;
    var i = 0;
    var run = function (reaction) {
      var handler = ok ? reaction.ok : reaction.fail;
      var resolve = reaction.resolve;
      var reject = reaction.reject;
      var domain = reaction.domain;
      var result, then, exited;
      try {
        if (handler) {
          if (!ok) {
            if (promise._h == 2) onHandleUnhandled(promise);
            promise._h = 1;
          }
          if (handler === true) result = value;
          else {
            if (domain) domain.enter();
            result = handler(value); // may throw
            if (domain) {
              domain.exit();
              exited = true;
            }
          }
          if (result === reaction.promise) {
            reject(TypeError('Promise-chain cycle'));
          } else if (then = isThenable(result)) {
            then.call(result, resolve, reject);
          } else resolve(result);
        } else reject(value);
      } catch (e) {
        if (domain && !exited) domain.exit();
        reject(e);
      }
    };
    while (chain.length > i) run(chain[i++]); // variable length - can't use forEach
    promise._c = [];
    promise._n = false;
    if (isReject && !promise._h) onUnhandled(promise);
  });
};
var onUnhandled = function (promise) {
  task.call(global, function () {
    var value = promise._v;
    var unhandled = isUnhandled(promise);
    var result, handler, console;
    if (unhandled) {
      result = perform(function () {
        if (isNode) {
          process.emit('unhandledRejection', value, promise);
        } else if (handler = global.onunhandledrejection) {
          handler({ promise: promise, reason: value });
        } else if ((console = global.console) && console.error) {
          console.error('Unhandled promise rejection', value);
        }
      });
      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should
      promise._h = isNode || isUnhandled(promise) ? 2 : 1;
    } promise._a = undefined;
    if (unhandled && result.e) throw result.v;
  });
};
var isUnhandled = function (promise) {
  return promise._h !== 1 && (promise._a || promise._c).length === 0;
};
var onHandleUnhandled = function (promise) {
  task.call(global, function () {
    var handler;
    if (isNode) {
      process.emit('rejectionHandled', promise);
    } else if (handler = global.onrejectionhandled) {
      handler({ promise: promise, reason: promise._v });
    }
  });
};
var $reject = function (value) {
  var promise = this;
  if (promise._d) return;
  promise._d = true;
  promise = promise._w || promise; // unwrap
  promise._v = value;
  promise._s = 2;
  if (!promise._a) promise._a = promise._c.slice();
  notify(promise, true);
};
var $resolve = function (value) {
  var promise = this;
  var then;
  if (promise._d) return;
  promise._d = true;
  promise = promise._w || promise; // unwrap
  try {
    if (promise === value) throw TypeError("Promise can't be resolved itself");
    if (then = isThenable(value)) {
      microtask(function () {
        var wrapper = { _w: promise, _d: false }; // wrap
        try {
          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));
        } catch (e) {
          $reject.call(wrapper, e);
        }
      });
    } else {
      promise._v = value;
      promise._s = 1;
      notify(promise, false);
    }
  } catch (e) {
    $reject.call({ _w: promise, _d: false }, e); // wrap
  }
};

// constructor polyfill
if (!USE_NATIVE) {
  // 25.4.3.1 Promise(executor)
  $Promise = function Promise(executor) {
    anInstance(this, $Promise, PROMISE, '_h');
    aFunction(executor);
    Internal.call(this);
    try {
      executor(ctx($resolve, this, 1), ctx($reject, this, 1));
    } catch (err) {
      $reject.call(this, err);
    }
  };
  // eslint-disable-next-line no-unused-vars
  Internal = function Promise(executor) {
    this._c = [];             // <- awaiting reactions
    this._a = undefined;      // <- checked in isUnhandled reactions
    this._s = 0;              // <- state
    this._d = false;          // <- done
    this._v = undefined;      // <- value
    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled
    this._n = false;          // <- notify
  };
  Internal.prototype = require('./_redefine-all')($Promise.prototype, {
    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)
    then: function then(onFulfilled, onRejected) {
      var reaction = newPromiseCapability(speciesConstructor(this, $Promise));
      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;
      reaction.fail = typeof onRejected == 'function' && onRejected;
      reaction.domain = isNode ? process.domain : undefined;
      this._c.push(reaction);
      if (this._a) this._a.push(reaction);
      if (this._s) notify(this, false);
      return reaction.promise;
    },
    // 25.4.5.1 Promise.prototype.catch(onRejected)
    'catch': function (onRejected) {
      return this.then(undefined, onRejected);
    }
  });
  OwnPromiseCapability = function () {
    var promise = new Internal();
    this.promise = promise;
    this.resolve = ctx($resolve, promise, 1);
    this.reject = ctx($reject, promise, 1);
  };
  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {
    return C === $Promise || C === Wrapper
      ? new OwnPromiseCapability(C)
      : newGenericPromiseCapability(C);
  };
}

$export($export.G + $export.W + $export.F * !USE_NATIVE, { Promise: $Promise });
require('./_set-to-string-tag')($Promise, PROMISE);
require('./_set-species')(PROMISE);
Wrapper = require('./_core')[PROMISE];

// statics
$export($export.S + $export.F * !USE_NATIVE, PROMISE, {
  // 25.4.4.5 Promise.reject(r)
  reject: function reject(r) {
    var capability = newPromiseCapability(this);
    var $$reject = capability.reject;
    $$reject(r);
    return capability.promise;
  }
});
$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {
  // 25.4.4.6 Promise.resolve(x)
  resolve: function resolve(x) {
    return promiseResolve(LIBRARY && this === Wrapper ? $Promise : this, x);
  }
});
$export($export.S + $export.F * !(USE_NATIVE && require('./_iter-detect')(function (iter) {
  $Promise.all(iter)['catch'](empty);
})), PROMISE, {
  // 25.4.4.1 Promise.all(iterable)
  all: function all(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var resolve = capability.resolve;
    var reject = capability.reject;
    var result = perform(function () {
      var values = [];
      var index = 0;
      var remaining = 1;
      forOf(iterable, false, function (promise) {
        var $index = index++;
        var alreadyCalled = false;
        values.push(undefined);
        remaining++;
        C.resolve(promise).then(function (value) {
          if (alreadyCalled) return;
          alreadyCalled = true;
          values[$index] = value;
          --remaining || resolve(values);
        }, reject);
      });
      --remaining || resolve(values);
    });
    if (result.e) reject(result.v);
    return capability.promise;
  },
  // 25.4.4.4 Promise.race(iterable)
  race: function race(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var reject = capability.reject;
    var result = perform(function () {
      forOf(iterable, false, function (promise) {
        C.resolve(promise).then(capability.resolve, reject);
      });
    });
    if (result.e) reject(result.v);
    return capability.promise;
  }
});

},{"./_a-function":28,"./_an-instance":30,"./_classof":33,"./_core":35,"./_ctx":36,"./_export":42,"./_for-of":44,"./_global":45,"./_is-object":54,"./_iter-detect":58,"./_library":61,"./_microtask":63,"./_new-promise-capability":64,"./_perform":77,"./_promise-resolve":78,"./_redefine-all":80,"./_set-species":83,"./_set-to-string-tag":84,"./_species-constructor":87,"./_task":89,"./_user-agent":97,"./_wks":100}],110:[function(require,module,exports){
'use strict';
var $at = require('./_string-at')(true);

// 21.1.3.27 String.prototype[@@iterator]()
require('./_iter-define')(String, 'String', function (iterated) {
  this._t = String(iterated); // target
  this._i = 0;                // next index
// 21.1.5.2.1 %StringIteratorPrototype%.next()
}, function () {
  var O = this._t;
  var index = this._i;
  var point;
  if (index >= O.length) return { value: undefined, done: true };
  point = $at(O, index);
  this._i += point.length;
  return { value: point, done: false };
});

},{"./_iter-define":57,"./_string-at":88}],111:[function(require,module,exports){
'use strict';
// ECMAScript 6 symbols shim
var global = require('./_global');
var has = require('./_has');
var DESCRIPTORS = require('./_descriptors');
var $export = require('./_export');
var redefine = require('./_redefine');
var META = require('./_meta').KEY;
var $fails = require('./_fails');
var shared = require('./_shared');
var setToStringTag = require('./_set-to-string-tag');
var uid = require('./_uid');
var wks = require('./_wks');
var wksExt = require('./_wks-ext');
var wksDefine = require('./_wks-define');
var enumKeys = require('./_enum-keys');
var isArray = require('./_is-array');
var anObject = require('./_an-object');
var isObject = require('./_is-object');
var toObject = require('./_to-object');
var toIObject = require('./_to-iobject');
var toPrimitive = require('./_to-primitive');
var createDesc = require('./_property-desc');
var _create = require('./_object-create');
var gOPNExt = require('./_object-gopn-ext');
var $GOPD = require('./_object-gopd');
var $GOPS = require('./_object-gops');
var $DP = require('./_object-dp');
var $keys = require('./_object-keys');
var gOPD = $GOPD.f;
var dP = $DP.f;
var gOPN = gOPNExt.f;
var $Symbol = global.Symbol;
var $JSON = global.JSON;
var _stringify = $JSON && $JSON.stringify;
var PROTOTYPE = 'prototype';
var HIDDEN = wks('_hidden');
var TO_PRIMITIVE = wks('toPrimitive');
var isEnum = {}.propertyIsEnumerable;
var SymbolRegistry = shared('symbol-registry');
var AllSymbols = shared('symbols');
var OPSymbols = shared('op-symbols');
var ObjectProto = Object[PROTOTYPE];
var USE_NATIVE = typeof $Symbol == 'function' && !!$GOPS.f;
var QObject = global.QObject;
// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173
var setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;

// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687
var setSymbolDesc = DESCRIPTORS && $fails(function () {
  return _create(dP({}, 'a', {
    get: function () { return dP(this, 'a', { value: 7 }).a; }
  })).a != 7;
}) ? function (it, key, D) {
  var protoDesc = gOPD(ObjectProto, key);
  if (protoDesc) delete ObjectProto[key];
  dP(it, key, D);
  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);
} : dP;

var wrap = function (tag) {
  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);
  sym._k = tag;
  return sym;
};

var isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {
  return typeof it == 'symbol';
} : function (it) {
  return it instanceof $Symbol;
};

var $defineProperty = function defineProperty(it, key, D) {
  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);
  anObject(it);
  key = toPrimitive(key, true);
  anObject(D);
  if (has(AllSymbols, key)) {
    if (!D.enumerable) {
      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));
      it[HIDDEN][key] = true;
    } else {
      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;
      D = _create(D, { enumerable: createDesc(0, false) });
    } return setSymbolDesc(it, key, D);
  } return dP(it, key, D);
};
var $defineProperties = function defineProperties(it, P) {
  anObject(it);
  var keys = enumKeys(P = toIObject(P));
  var i = 0;
  var l = keys.length;
  var key;
  while (l > i) $defineProperty(it, key = keys[i++], P[key]);
  return it;
};
var $create = function create(it, P) {
  return P === undefined ? _create(it) : $defineProperties(_create(it), P);
};
var $propertyIsEnumerable = function propertyIsEnumerable(key) {
  var E = isEnum.call(this, key = toPrimitive(key, true));
  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;
  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;
};
var $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {
  it = toIObject(it);
  key = toPrimitive(key, true);
  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;
  var D = gOPD(it, key);
  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;
  return D;
};
var $getOwnPropertyNames = function getOwnPropertyNames(it) {
  var names = gOPN(toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);
  } return result;
};
var $getOwnPropertySymbols = function getOwnPropertySymbols(it) {
  var IS_OP = it === ObjectProto;
  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);
  } return result;
};

// 19.4.1.1 Symbol([description])
if (!USE_NATIVE) {
  $Symbol = function Symbol() {
    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');
    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);
    var $set = function (value) {
      if (this === ObjectProto) $set.call(OPSymbols, value);
      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;
      setSymbolDesc(this, tag, createDesc(1, value));
    };
    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });
    return wrap(tag);
  };
  redefine($Symbol[PROTOTYPE], 'toString', function toString() {
    return this._k;
  });

  $GOPD.f = $getOwnPropertyDescriptor;
  $DP.f = $defineProperty;
  require('./_object-gopn').f = gOPNExt.f = $getOwnPropertyNames;
  require('./_object-pie').f = $propertyIsEnumerable;
  $GOPS.f = $getOwnPropertySymbols;

  if (DESCRIPTORS && !require('./_library')) {
    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);
  }

  wksExt.f = function (name) {
    return wrap(wks(name));
  };
}

$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });

for (var es6Symbols = (
  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14
  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'
).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);

for (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);

$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {
  // 19.4.2.1 Symbol.for(key)
  'for': function (key) {
    return has(SymbolRegistry, key += '')
      ? SymbolRegistry[key]
      : SymbolRegistry[key] = $Symbol(key);
  },
  // 19.4.2.5 Symbol.keyFor(sym)
  keyFor: function keyFor(sym) {
    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');
    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;
  },
  useSetter: function () { setter = true; },
  useSimple: function () { setter = false; }
});

$export($export.S + $export.F * !USE_NATIVE, 'Object', {
  // 19.1.2.2 Object.create(O [, Properties])
  create: $create,
  // 19.1.2.4 Object.defineProperty(O, P, Attributes)
  defineProperty: $defineProperty,
  // 19.1.2.3 Object.defineProperties(O, Properties)
  defineProperties: $defineProperties,
  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)
  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,
  // 19.1.2.7 Object.getOwnPropertyNames(O)
  getOwnPropertyNames: $getOwnPropertyNames,
  // 19.1.2.8 Object.getOwnPropertySymbols(O)
  getOwnPropertySymbols: $getOwnPropertySymbols
});

// Chrome 38 and 39 `Object.getOwnPropertySymbols` fails on primitives
// https://bugs.chromium.org/p/v8/issues/detail?id=3443
var FAILS_ON_PRIMITIVES = $fails(function () { $GOPS.f(1); });

$export($export.S + $export.F * FAILS_ON_PRIMITIVES, 'Object', {
  getOwnPropertySymbols: function getOwnPropertySymbols(it) {
    return $GOPS.f(toObject(it));
  }
});

// 24.3.2 JSON.stringify(value [, replacer [, space]])
$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {
  var S = $Symbol();
  // MS Edge converts symbol values to JSON as {}
  // WebKit converts symbol values to JSON as null
  // V8 throws on boxed symbols
  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';
})), 'JSON', {
  stringify: function stringify(it) {
    var args = [it];
    var i = 1;
    var replacer, $replacer;
    while (arguments.length > i) args.push(arguments[i++]);
    $replacer = replacer = args[1];
    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined
    if (!isArray(replacer)) replacer = function (key, value) {
      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);
      if (!isSymbol(value)) return value;
    };
    args[1] = replacer;
    return _stringify.apply($JSON, args);
  }
});

// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)
$Symbol[PROTOTYPE][TO_PRIMITIVE] || require('./_hide')($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);
// 19.4.3.5 Symbol.prototype[@@toStringTag]
setToStringTag($Symbol, 'Symbol');
// 20.2.1.9 Math[@@toStringTag]
setToStringTag(Math, 'Math', true);
// 24.3.3 JSON[@@toStringTag]
setToStringTag(global.JSON, 'JSON', true);

},{"./_an-object":31,"./_descriptors":38,"./_enum-keys":41,"./_export":42,"./_fails":43,"./_global":45,"./_has":46,"./_hide":47,"./_is-array":53,"./_is-object":54,"./_library":61,"./_meta":62,"./_object-create":65,"./_object-dp":66,"./_object-gopd":68,"./_object-gopn":70,"./_object-gopn-ext":69,"./_object-gops":71,"./_object-keys":74,"./_object-pie":75,"./_property-desc":79,"./_redefine":81,"./_set-to-string-tag":84,"./_shared":86,"./_to-iobject":92,"./_to-object":94,"./_to-primitive":95,"./_uid":96,"./_wks":100,"./_wks-define":98,"./_wks-ext":99}],112:[function(require,module,exports){
// https://github.com/tc39/proposal-promise-finally
'use strict';
var $export = require('./_export');
var core = require('./_core');
var global = require('./_global');
var speciesConstructor = require('./_species-constructor');
var promiseResolve = require('./_promise-resolve');

$export($export.P + $export.R, 'Promise', { 'finally': function (onFinally) {
  var C = speciesConstructor(this, core.Promise || global.Promise);
  var isFunction = typeof onFinally == 'function';
  return this.then(
    isFunction ? function (x) {
      return promiseResolve(C, onFinally()).then(function () { return x; });
    } : onFinally,
    isFunction ? function (e) {
      return promiseResolve(C, onFinally()).then(function () { throw e; });
    } : onFinally
  );
} });

},{"./_core":35,"./_export":42,"./_global":45,"./_promise-resolve":78,"./_species-constructor":87}],113:[function(require,module,exports){
'use strict';
// https://github.com/tc39/proposal-promise-try
var $export = require('./_export');
var newPromiseCapability = require('./_new-promise-capability');
var perform = require('./_perform');

$export($export.S, 'Promise', { 'try': function (callbackfn) {
  var promiseCapability = newPromiseCapability.f(this);
  var result = perform(callbackfn);
  (result.e ? promiseCapability.reject : promiseCapability.resolve)(result.v);
  return promiseCapability.promise;
} });

},{"./_export":42,"./_new-promise-capability":64,"./_perform":77}],114:[function(require,module,exports){
require('./_wks-define')('asyncIterator');

},{"./_wks-define":98}],115:[function(require,module,exports){
require('./_wks-define')('observable');

},{"./_wks-define":98}],116:[function(require,module,exports){
require('./es6.array.iterator');
var global = require('./_global');
var hide = require('./_hide');
var Iterators = require('./_iterators');
var TO_STRING_TAG = require('./_wks')('toStringTag');

var DOMIterables = ('CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,' +
  'DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,' +
  'MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,' +
  'SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,' +
  'TextTrackList,TouchList').split(',');

for (var i = 0; i < DOMIterables.length; i++) {
  var NAME = DOMIterables[i];
  var Collection = global[NAME];
  var proto = Collection && Collection.prototype;
  if (proto && !proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);
  Iterators[NAME] = Iterators.Array;
}

},{"./_global":45,"./_hide":47,"./_iterators":60,"./_wks":100,"./es6.array.iterator":102}],117:[function(require,module,exports){
/*
 *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var SDPUtils = require('sdp');

function fixStatsType(stat) {
  return {
    inboundrtp: 'inbound-rtp',
    outboundrtp: 'outbound-rtp',
    candidatepair: 'candidate-pair',
    localcandidate: 'local-candidate',
    remotecandidate: 'remote-candidate'
  }[stat.type] || stat.type;
}

function writeMediaSection(transceiver, caps, type, stream, dtlsRole) {
  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);

  // Map ICE parameters (ufrag, pwd) to SDP.
  sdp += SDPUtils.writeIceParameters(
      transceiver.iceGatherer.getLocalParameters());

  // Map DTLS parameters to SDP.
  sdp += SDPUtils.writeDtlsParameters(
      transceiver.dtlsTransport.getLocalParameters(),
      type === 'offer' ? 'actpass' : dtlsRole || 'active');

  sdp += 'a=mid:' + transceiver.mid + '\r\n';

  if (transceiver.rtpSender && transceiver.rtpReceiver) {
    sdp += 'a=sendrecv\r\n';
  } else if (transceiver.rtpSender) {
    sdp += 'a=sendonly\r\n';
  } else if (transceiver.rtpReceiver) {
    sdp += 'a=recvonly\r\n';
  } else {
    sdp += 'a=inactive\r\n';
  }

  if (transceiver.rtpSender) {
    var trackId = transceiver.rtpSender._initialTrackId ||
        transceiver.rtpSender.track.id;
    transceiver.rtpSender._initialTrackId = trackId;
    // spec.
    var msid = 'msid:' + (stream ? stream.id : '-') + ' ' +
        trackId + '\r\n';
    sdp += 'a=' + msid;
    // for Chrome. Legacy should no longer be required.
    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +
        ' ' + msid;

    // RTX
    if (transceiver.sendEncodingParameters[0].rtx) {
      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +
          ' ' + msid;
      sdp += 'a=ssrc-group:FID ' +
          transceiver.sendEncodingParameters[0].ssrc + ' ' +
          transceiver.sendEncodingParameters[0].rtx.ssrc +
          '\r\n';
    }
  }
  // FIXME: this should be written by writeRtpDescription.
  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +
      ' cname:' + SDPUtils.localCName + '\r\n';
  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {
    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +
        ' cname:' + SDPUtils.localCName + '\r\n';
  }
  return sdp;
}

// Edge does not like
// 1) stun: filtered after 14393 unless ?transport=udp is present
// 2) turn: that does not have all of turn:host:port?transport=udp
// 3) turn: with ipv6 addresses
// 4) turn: occurring muliple times
function filterIceServers(iceServers, edgeVersion) {
  var hasTurn = false;
  iceServers = JSON.parse(JSON.stringify(iceServers));
  return iceServers.filter(function(server) {
    if (server && (server.urls || server.url)) {
      var urls = server.urls || server.url;
      if (server.url && !server.urls) {
        console.warn('RTCIceServer.url is deprecated! Use urls instead.');
      }
      var isString = typeof urls === 'string';
      if (isString) {
        urls = [urls];
      }
      urls = urls.filter(function(url) {
        var validTurn = url.indexOf('turn:') === 0 &&
            url.indexOf('transport=udp') !== -1 &&
            url.indexOf('turn:[') === -1 &&
            !hasTurn;

        if (validTurn) {
          hasTurn = true;
          return true;
        }
        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&
            url.indexOf('?transport=udp') === -1;
      });

      delete server.url;
      server.urls = isString ? urls[0] : urls;
      return !!urls.length;
    }
  });
}

// Determines the intersection of local and remote capabilities.
function getCommonCapabilities(localCapabilities, remoteCapabilities) {
  var commonCapabilities = {
    codecs: [],
    headerExtensions: [],
    fecMechanisms: []
  };

  var findCodecByPayloadType = function(pt, codecs) {
    pt = parseInt(pt, 10);
    for (var i = 0; i < codecs.length; i++) {
      if (codecs[i].payloadType === pt ||
          codecs[i].preferredPayloadType === pt) {
        return codecs[i];
      }
    }
  };

  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {
    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);
    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);
    return lCodec && rCodec &&
        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();
  };

  localCapabilities.codecs.forEach(function(lCodec) {
    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {
      var rCodec = remoteCapabilities.codecs[i];
      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&
          lCodec.clockRate === rCodec.clockRate) {
        if (lCodec.name.toLowerCase() === 'rtx' &&
            lCodec.parameters && rCodec.parameters.apt) {
          // for RTX we need to find the local rtx that has a apt
          // which points to the same local codec as the remote one.
          if (!rtxCapabilityMatches(lCodec, rCodec,
              localCapabilities.codecs, remoteCapabilities.codecs)) {
            continue;
          }
        }
        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy
        // number of channels is the highest common number of channels
        rCodec.numChannels = Math.min(lCodec.numChannels,
            rCodec.numChannels);
        // push rCodec so we reply with offerer payload type
        commonCapabilities.codecs.push(rCodec);

        // determine common feedback mechanisms
        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {
          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {
            if (lCodec.rtcpFeedback[j].type === fb.type &&
                lCodec.rtcpFeedback[j].parameter === fb.parameter) {
              return true;
            }
          }
          return false;
        });
        // FIXME: also need to determine .parameters
        //  see https://github.com/openpeer/ortc/issues/569
        break;
      }
    }
  });

  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {
    for (var i = 0; i < remoteCapabilities.headerExtensions.length;
         i++) {
      var rHeaderExtension = remoteCapabilities.headerExtensions[i];
      if (lHeaderExtension.uri === rHeaderExtension.uri) {
        commonCapabilities.headerExtensions.push(rHeaderExtension);
        break;
      }
    }
  });

  // FIXME: fecMechanisms
  return commonCapabilities;
}

// is action=setLocalDescription with type allowed in signalingState
function isActionAllowedInSignalingState(action, type, signalingState) {
  return {
    offer: {
      setLocalDescription: ['stable', 'have-local-offer'],
      setRemoteDescription: ['stable', 'have-remote-offer']
    },
    answer: {
      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],
      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']
    }
  }[type][action].indexOf(signalingState) !== -1;
}

function maybeAddCandidate(iceTransport, candidate) {
  // Edge's internal representation adds some fields therefore
  // not all field are taken into account.
  var alreadyAdded = iceTransport.getRemoteCandidates()
      .find(function(remoteCandidate) {
        return candidate.foundation === remoteCandidate.foundation &&
            candidate.ip === remoteCandidate.ip &&
            candidate.port === remoteCandidate.port &&
            candidate.priority === remoteCandidate.priority &&
            candidate.protocol === remoteCandidate.protocol &&
            candidate.type === remoteCandidate.type;
      });
  if (!alreadyAdded) {
    iceTransport.addRemoteCandidate(candidate);
  }
  return !alreadyAdded;
}


function makeError(name, description) {
  var e = new Error(description);
  e.name = name;
  // legacy error codes from https://heycam.github.io/webidl/#idl-DOMException-error-names
  e.code = {
    NotSupportedError: 9,
    InvalidStateError: 11,
    InvalidAccessError: 15,
    TypeError: undefined,
    OperationError: undefined
  }[name];
  return e;
}

module.exports = function(window, edgeVersion) {
  // https://w3c.github.io/mediacapture-main/#mediastream
  // Helper function to add the track to the stream and
  // dispatch the event ourselves.
  function addTrackToStreamAndFireEvent(track, stream) {
    stream.addTrack(track);
    stream.dispatchEvent(new window.MediaStreamTrackEvent('addtrack',
        {track: track}));
  }

  function removeTrackFromStreamAndFireEvent(track, stream) {
    stream.removeTrack(track);
    stream.dispatchEvent(new window.MediaStreamTrackEvent('removetrack',
        {track: track}));
  }

  function fireAddTrack(pc, track, receiver, streams) {
    var trackEvent = new Event('track');
    trackEvent.track = track;
    trackEvent.receiver = receiver;
    trackEvent.transceiver = {receiver: receiver};
    trackEvent.streams = streams;
    window.setTimeout(function() {
      pc._dispatchEvent('track', trackEvent);
    });
  }

  var RTCPeerConnection = function(config) {
    var pc = this;

    var _eventTarget = document.createDocumentFragment();
    ['addEventListener', 'removeEventListener', 'dispatchEvent']
        .forEach(function(method) {
          pc[method] = _eventTarget[method].bind(_eventTarget);
        });

    this.canTrickleIceCandidates = null;

    this.needNegotiation = false;

    this.localStreams = [];
    this.remoteStreams = [];

    this._localDescription = null;
    this._remoteDescription = null;

    this.signalingState = 'stable';
    this.iceConnectionState = 'new';
    this.connectionState = 'new';
    this.iceGatheringState = 'new';

    config = JSON.parse(JSON.stringify(config || {}));

    this.usingBundle = config.bundlePolicy === 'max-bundle';
    if (config.rtcpMuxPolicy === 'negotiate') {
      throw(makeError('NotSupportedError',
          'rtcpMuxPolicy \'negotiate\' is not supported'));
    } else if (!config.rtcpMuxPolicy) {
      config.rtcpMuxPolicy = 'require';
    }

    switch (config.iceTransportPolicy) {
      case 'all':
      case 'relay':
        break;
      default:
        config.iceTransportPolicy = 'all';
        break;
    }

    switch (config.bundlePolicy) {
      case 'balanced':
      case 'max-compat':
      case 'max-bundle':
        break;
      default:
        config.bundlePolicy = 'balanced';
        break;
    }

    config.iceServers = filterIceServers(config.iceServers || [], edgeVersion);

    this._iceGatherers = [];
    if (config.iceCandidatePoolSize) {
      for (var i = config.iceCandidatePoolSize; i > 0; i--) {
        this._iceGatherers.push(new window.RTCIceGatherer({
          iceServers: config.iceServers,
          gatherPolicy: config.iceTransportPolicy
        }));
      }
    } else {
      config.iceCandidatePoolSize = 0;
    }

    this._config = config;

    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...
    // everything that is needed to describe a SDP m-line.
    this.transceivers = [];

    this._sdpSessionId = SDPUtils.generateSessionId();
    this._sdpSessionVersion = 0;

    this._dtlsRole = undefined; // role for a=setup to use in answers.

    this._isClosed = false;
  };

  Object.defineProperty(RTCPeerConnection.prototype, 'localDescription', {
    configurable: true,
    get: function() {
      return this._localDescription;
    }
  });
  Object.defineProperty(RTCPeerConnection.prototype, 'remoteDescription', {
    configurable: true,
    get: function() {
      return this._remoteDescription;
    }
  });

  // set up event handlers on prototype
  RTCPeerConnection.prototype.onicecandidate = null;
  RTCPeerConnection.prototype.onaddstream = null;
  RTCPeerConnection.prototype.ontrack = null;
  RTCPeerConnection.prototype.onremovestream = null;
  RTCPeerConnection.prototype.onsignalingstatechange = null;
  RTCPeerConnection.prototype.oniceconnectionstatechange = null;
  RTCPeerConnection.prototype.onconnectionstatechange = null;
  RTCPeerConnection.prototype.onicegatheringstatechange = null;
  RTCPeerConnection.prototype.onnegotiationneeded = null;
  RTCPeerConnection.prototype.ondatachannel = null;

  RTCPeerConnection.prototype._dispatchEvent = function(name, event) {
    if (this._isClosed) {
      return;
    }
    this.dispatchEvent(event);
    if (typeof this['on' + name] === 'function') {
      this['on' + name](event);
    }
  };

  RTCPeerConnection.prototype._emitGatheringStateChange = function() {
    var event = new Event('icegatheringstatechange');
    this._dispatchEvent('icegatheringstatechange', event);
  };

  RTCPeerConnection.prototype.getConfiguration = function() {
    return this._config;
  };

  RTCPeerConnection.prototype.getLocalStreams = function() {
    return this.localStreams;
  };

  RTCPeerConnection.prototype.getRemoteStreams = function() {
    return this.remoteStreams;
  };

  // internal helper to create a transceiver object.
  // (which is not yet the same as the WebRTC 1.0 transceiver)
  RTCPeerConnection.prototype._createTransceiver = function(kind, doNotAdd) {
    var hasBundleTransport = this.transceivers.length > 0;
    var transceiver = {
      track: null,
      iceGatherer: null,
      iceTransport: null,
      dtlsTransport: null,
      localCapabilities: null,
      remoteCapabilities: null,
      rtpSender: null,
      rtpReceiver: null,
      kind: kind,
      mid: null,
      sendEncodingParameters: null,
      recvEncodingParameters: null,
      stream: null,
      associatedRemoteMediaStreams: [],
      wantReceive: true
    };
    if (this.usingBundle && hasBundleTransport) {
      transceiver.iceTransport = this.transceivers[0].iceTransport;
      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;
    } else {
      var transports = this._createIceAndDtlsTransports();
      transceiver.iceTransport = transports.iceTransport;
      transceiver.dtlsTransport = transports.dtlsTransport;
    }
    if (!doNotAdd) {
      this.transceivers.push(transceiver);
    }
    return transceiver;
  };

  RTCPeerConnection.prototype.addTrack = function(track, stream) {
    if (this._isClosed) {
      throw makeError('InvalidStateError',
          'Attempted to call addTrack on a closed peerconnection.');
    }

    var alreadyExists = this.transceivers.find(function(s) {
      return s.track === track;
    });

    if (alreadyExists) {
      throw makeError('InvalidAccessError', 'Track already exists.');
    }

    var transceiver;
    for (var i = 0; i < this.transceivers.length; i++) {
      if (!this.transceivers[i].track &&
          this.transceivers[i].kind === track.kind) {
        transceiver = this.transceivers[i];
      }
    }
    if (!transceiver) {
      transceiver = this._createTransceiver(track.kind);
    }

    this._maybeFireNegotiationNeeded();

    if (this.localStreams.indexOf(stream) === -1) {
      this.localStreams.push(stream);
    }

    transceiver.track = track;
    transceiver.stream = stream;
    transceiver.rtpSender = new window.RTCRtpSender(track,
        transceiver.dtlsTransport);
    return transceiver.rtpSender;
  };

  RTCPeerConnection.prototype.addStream = function(stream) {
    var pc = this;
    if (edgeVersion >= 15025) {
      stream.getTracks().forEach(function(track) {
        pc.addTrack(track, stream);
      });
    } else {
      // Clone is necessary for local demos mostly, attaching directly
      // to two different senders does not work (build 10547).
      // Fixed in 15025 (or earlier)
      var clonedStream = stream.clone();
      stream.getTracks().forEach(function(track, idx) {
        var clonedTrack = clonedStream.getTracks()[idx];
        track.addEventListener('enabled', function(event) {
          clonedTrack.enabled = event.enabled;
        });
      });
      clonedStream.getTracks().forEach(function(track) {
        pc.addTrack(track, clonedStream);
      });
    }
  };

  RTCPeerConnection.prototype.removeTrack = function(sender) {
    if (this._isClosed) {
      throw makeError('InvalidStateError',
          'Attempted to call removeTrack on a closed peerconnection.');
    }

    if (!(sender instanceof window.RTCRtpSender)) {
      throw new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +
          'does not implement interface RTCRtpSender.');
    }

    var transceiver = this.transceivers.find(function(t) {
      return t.rtpSender === sender;
    });

    if (!transceiver) {
      throw makeError('InvalidAccessError',
          'Sender was not created by this connection.');
    }
    var stream = transceiver.stream;

    transceiver.rtpSender.stop();
    transceiver.rtpSender = null;
    transceiver.track = null;
    transceiver.stream = null;

    // remove the stream from the set of local streams
    var localStreams = this.transceivers.map(function(t) {
      return t.stream;
    });
    if (localStreams.indexOf(stream) === -1 &&
        this.localStreams.indexOf(stream) > -1) {
      this.localStreams.splice(this.localStreams.indexOf(stream), 1);
    }

    this._maybeFireNegotiationNeeded();
  };

  RTCPeerConnection.prototype.removeStream = function(stream) {
    var pc = this;
    stream.getTracks().forEach(function(track) {
      var sender = pc.getSenders().find(function(s) {
        return s.track === track;
      });
      if (sender) {
        pc.removeTrack(sender);
      }
    });
  };

  RTCPeerConnection.prototype.getSenders = function() {
    return this.transceivers.filter(function(transceiver) {
      return !!transceiver.rtpSender;
    })
    .map(function(transceiver) {
      return transceiver.rtpSender;
    });
  };

  RTCPeerConnection.prototype.getReceivers = function() {
    return this.transceivers.filter(function(transceiver) {
      return !!transceiver.rtpReceiver;
    })
    .map(function(transceiver) {
      return transceiver.rtpReceiver;
    });
  };


  RTCPeerConnection.prototype._createIceGatherer = function(sdpMLineIndex,
      usingBundle) {
    var pc = this;
    if (usingBundle && sdpMLineIndex > 0) {
      return this.transceivers[0].iceGatherer;
    } else if (this._iceGatherers.length) {
      return this._iceGatherers.shift();
    }
    var iceGatherer = new window.RTCIceGatherer({
      iceServers: this._config.iceServers,
      gatherPolicy: this._config.iceTransportPolicy
    });
    Object.defineProperty(iceGatherer, 'state',
        {value: 'new', writable: true}
    );

    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = [];
    this.transceivers[sdpMLineIndex].bufferCandidates = function(event) {
      var end = !event.candidate || Object.keys(event.candidate).length === 0;
      // polyfill since RTCIceGatherer.state is not implemented in
      // Edge 10547 yet.
      iceGatherer.state = end ? 'completed' : 'gathering';
      if (pc.transceivers[sdpMLineIndex].bufferedCandidateEvents !== null) {
        pc.transceivers[sdpMLineIndex].bufferedCandidateEvents.push(event);
      }
    };
    iceGatherer.addEventListener('localcandidate',
      this.transceivers[sdpMLineIndex].bufferCandidates);
    return iceGatherer;
  };

  // start gathering from an RTCIceGatherer.
  RTCPeerConnection.prototype._gather = function(mid, sdpMLineIndex) {
    var pc = this;
    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;
    if (iceGatherer.onlocalcandidate) {
      return;
    }
    var bufferedCandidateEvents =
      this.transceivers[sdpMLineIndex].bufferedCandidateEvents;
    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = null;
    iceGatherer.removeEventListener('localcandidate',
      this.transceivers[sdpMLineIndex].bufferCandidates);
    iceGatherer.onlocalcandidate = function(evt) {
      if (pc.usingBundle && sdpMLineIndex > 0) {
        // if we know that we use bundle we can drop candidates with
        // dpMLineIndex > 0. If we don't do this then our state gets
        // confused since we dispose the extra ice gatherer.
        return;
      }
      var event = new Event('icecandidate');
      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};

      var cand = evt.candidate;
      // Edge emits an empty object for RTCIceCandidateComplete
      var end = !cand || Object.keys(cand).length === 0;
      if (end) {
        // polyfill since RTCIceGatherer.state is not implemented in
        // Edge 10547 yet.
        if (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {
          iceGatherer.state = 'completed';
        }
      } else {
        if (iceGatherer.state === 'new') {
          iceGatherer.state = 'gathering';
        }
        // RTCIceCandidate doesn't have a component, needs to be added
        cand.component = 1;
        // also the usernameFragment. TODO: update SDP to take both variants.
        cand.ufrag = iceGatherer.getLocalParameters().usernameFragment;

        var serializedCandidate = SDPUtils.writeCandidate(cand);
        event.candidate = Object.assign(event.candidate,
            SDPUtils.parseCandidate(serializedCandidate));

        event.candidate.candidate = serializedCandidate;
        event.candidate.toJSON = function() {
          return {
            candidate: event.candidate.candidate,
            sdpMid: event.candidate.sdpMid,
            sdpMLineIndex: event.candidate.sdpMLineIndex,
            usernameFragment: event.candidate.usernameFragment
          };
        };
      }

      // update local description.
      var sections = SDPUtils.getMediaSections(pc._localDescription.sdp);
      if (!end) {
        sections[event.candidate.sdpMLineIndex] +=
            'a=' + event.candidate.candidate + '\r\n';
      } else {
        sections[event.candidate.sdpMLineIndex] +=
            'a=end-of-candidates\r\n';
      }
      pc._localDescription.sdp =
          SDPUtils.getDescription(pc._localDescription.sdp) +
          sections.join('');
      var complete = pc.transceivers.every(function(transceiver) {
        return transceiver.iceGatherer &&
            transceiver.iceGatherer.state === 'completed';
      });

      if (pc.iceGatheringState !== 'gathering') {
        pc.iceGatheringState = 'gathering';
        pc._emitGatheringStateChange();
      }

      // Emit candidate. Also emit null candidate when all gatherers are
      // complete.
      if (!end) {
        pc._dispatchEvent('icecandidate', event);
      }
      if (complete) {
        pc._dispatchEvent('icecandidate', new Event('icecandidate'));
        pc.iceGatheringState = 'complete';
        pc._emitGatheringStateChange();
      }
    };

    // emit already gathered candidates.
    window.setTimeout(function() {
      bufferedCandidateEvents.forEach(function(e) {
        iceGatherer.onlocalcandidate(e);
      });
    }, 0);
  };

  // Create ICE transport and DTLS transport.
  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {
    var pc = this;
    var iceTransport = new window.RTCIceTransport(null);
    iceTransport.onicestatechange = function() {
      pc._updateIceConnectionState();
      pc._updateConnectionState();
    };

    var dtlsTransport = new window.RTCDtlsTransport(iceTransport);
    dtlsTransport.ondtlsstatechange = function() {
      pc._updateConnectionState();
    };
    dtlsTransport.onerror = function() {
      // onerror does not set state to failed by itself.
      Object.defineProperty(dtlsTransport, 'state',
          {value: 'failed', writable: true});
      pc._updateConnectionState();
    };

    return {
      iceTransport: iceTransport,
      dtlsTransport: dtlsTransport
    };
  };

  // Destroy ICE gatherer, ICE transport and DTLS transport.
  // Without triggering the callbacks.
  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(
      sdpMLineIndex) {
    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;
    if (iceGatherer) {
      delete iceGatherer.onlocalcandidate;
      delete this.transceivers[sdpMLineIndex].iceGatherer;
    }
    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;
    if (iceTransport) {
      delete iceTransport.onicestatechange;
      delete this.transceivers[sdpMLineIndex].iceTransport;
    }
    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;
    if (dtlsTransport) {
      delete dtlsTransport.ondtlsstatechange;
      delete dtlsTransport.onerror;
      delete this.transceivers[sdpMLineIndex].dtlsTransport;
    }
  };

  // Start the RTP Sender and Receiver for a transceiver.
  RTCPeerConnection.prototype._transceive = function(transceiver,
      send, recv) {
    var params = getCommonCapabilities(transceiver.localCapabilities,
        transceiver.remoteCapabilities);
    if (send && transceiver.rtpSender) {
      params.encodings = transceiver.sendEncodingParameters;
      params.rtcp = {
        cname: SDPUtils.localCName,
        compound: transceiver.rtcpParameters.compound
      };
      if (transceiver.recvEncodingParameters.length) {
        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;
      }
      transceiver.rtpSender.send(params);
    }
    if (recv && transceiver.rtpReceiver && params.codecs.length > 0) {
      // remove RTX field in Edge 14942
      if (transceiver.kind === 'video'
          && transceiver.recvEncodingParameters
          && edgeVersion < 15019) {
        transceiver.recvEncodingParameters.forEach(function(p) {
          delete p.rtx;
        });
      }
      if (transceiver.recvEncodingParameters.length) {
        params.encodings = transceiver.recvEncodingParameters;
      } else {
        params.encodings = [{}];
      }
      params.rtcp = {
        compound: transceiver.rtcpParameters.compound
      };
      if (transceiver.rtcpParameters.cname) {
        params.rtcp.cname = transceiver.rtcpParameters.cname;
      }
      if (transceiver.sendEncodingParameters.length) {
        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;
      }
      transceiver.rtpReceiver.receive(params);
    }
  };

  RTCPeerConnection.prototype.setLocalDescription = function(description) {
    var pc = this;

    // Note: pranswer is not supported.
    if (['offer', 'answer'].indexOf(description.type) === -1) {
      return Promise.reject(makeError('TypeError',
          'Unsupported type "' + description.type + '"'));
    }

    if (!isActionAllowedInSignalingState('setLocalDescription',
        description.type, pc.signalingState) || pc._isClosed) {
      return Promise.reject(makeError('InvalidStateError',
          'Can not set local ' + description.type +
          ' in state ' + pc.signalingState));
    }

    var sections;
    var sessionpart;
    if (description.type === 'offer') {
      // VERY limited support for SDP munging. Limited to:
      // * changing the order of codecs
      sections = SDPUtils.splitSections(description.sdp);
      sessionpart = sections.shift();
      sections.forEach(function(mediaSection, sdpMLineIndex) {
        var caps = SDPUtils.parseRtpParameters(mediaSection);
        pc.transceivers[sdpMLineIndex].localCapabilities = caps;
      });

      pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {
        pc._gather(transceiver.mid, sdpMLineIndex);
      });
    } else if (description.type === 'answer') {
      sections = SDPUtils.splitSections(pc._remoteDescription.sdp);
      sessionpart = sections.shift();
      var isIceLite = SDPUtils.matchPrefix(sessionpart,
          'a=ice-lite').length > 0;
      sections.forEach(function(mediaSection, sdpMLineIndex) {
        var transceiver = pc.transceivers[sdpMLineIndex];
        var iceGatherer = transceiver.iceGatherer;
        var iceTransport = transceiver.iceTransport;
        var dtlsTransport = transceiver.dtlsTransport;
        var localCapabilities = transceiver.localCapabilities;
        var remoteCapabilities = transceiver.remoteCapabilities;

        // treat bundle-only as not-rejected.
        var rejected = SDPUtils.isRejected(mediaSection) &&
            SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;

        if (!rejected && !transceiver.rejected) {
          var remoteIceParameters = SDPUtils.getIceParameters(
              mediaSection, sessionpart);
          var remoteDtlsParameters = SDPUtils.getDtlsParameters(
              mediaSection, sessionpart);
          if (isIceLite) {
            remoteDtlsParameters.role = 'server';
          }

          if (!pc.usingBundle || sdpMLineIndex === 0) {
            pc._gather(transceiver.mid, sdpMLineIndex);
            if (iceTransport.state === 'new') {
              iceTransport.start(iceGatherer, remoteIceParameters,
                  isIceLite ? 'controlling' : 'controlled');
            }
            if (dtlsTransport.state === 'new') {
              dtlsTransport.start(remoteDtlsParameters);
            }
          }

          // Calculate intersection of capabilities.
          var params = getCommonCapabilities(localCapabilities,
              remoteCapabilities);

          // Start the RTCRtpSender. The RTCRtpReceiver for this
          // transceiver has already been started in setRemoteDescription.
          pc._transceive(transceiver,
              params.codecs.length > 0,
              false);
        }
      });
    }

    pc._localDescription = {
      type: description.type,
      sdp: description.sdp
    };
    if (description.type === 'offer') {
      pc._updateSignalingState('have-local-offer');
    } else {
      pc._updateSignalingState('stable');
    }

    return Promise.resolve();
  };

  RTCPeerConnection.prototype.setRemoteDescription = function(description) {
    var pc = this;

    // Note: pranswer is not supported.
    if (['offer', 'answer'].indexOf(description.type) === -1) {
      return Promise.reject(makeError('TypeError',
          'Unsupported type "' + description.type + '"'));
    }

    if (!isActionAllowedInSignalingState('setRemoteDescription',
        description.type, pc.signalingState) || pc._isClosed) {
      return Promise.reject(makeError('InvalidStateError',
          'Can not set remote ' + description.type +
          ' in state ' + pc.signalingState));
    }

    var streams = {};
    pc.remoteStreams.forEach(function(stream) {
      streams[stream.id] = stream;
    });
    var receiverList = [];
    var sections = SDPUtils.splitSections(description.sdp);
    var sessionpart = sections.shift();
    var isIceLite = SDPUtils.matchPrefix(sessionpart,
        'a=ice-lite').length > 0;
    var usingBundle = SDPUtils.matchPrefix(sessionpart,
        'a=group:BUNDLE ').length > 0;
    pc.usingBundle = usingBundle;
    var iceOptions = SDPUtils.matchPrefix(sessionpart,
        'a=ice-options:')[0];
    if (iceOptions) {
      pc.canTrickleIceCandidates = iceOptions.substr(14).split(' ')
          .indexOf('trickle') >= 0;
    } else {
      pc.canTrickleIceCandidates = false;
    }

    sections.forEach(function(mediaSection, sdpMLineIndex) {
      var lines = SDPUtils.splitLines(mediaSection);
      var kind = SDPUtils.getKind(mediaSection);
      // treat bundle-only as not-rejected.
      var rejected = SDPUtils.isRejected(mediaSection) &&
          SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;
      var protocol = lines[0].substr(2).split(' ')[2];

      var direction = SDPUtils.getDirection(mediaSection, sessionpart);
      var remoteMsid = SDPUtils.parseMsid(mediaSection);

      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();

      // Reject datachannels which are not implemented yet.
      if (rejected || (kind === 'application' && (protocol === 'DTLS/SCTP' ||
          protocol === 'UDP/DTLS/SCTP'))) {
        // TODO: this is dangerous in the case where a non-rejected m-line
        //     becomes rejected.
        pc.transceivers[sdpMLineIndex] = {
          mid: mid,
          kind: kind,
          protocol: protocol,
          rejected: true
        };
        return;
      }

      if (!rejected && pc.transceivers[sdpMLineIndex] &&
          pc.transceivers[sdpMLineIndex].rejected) {
        // recycle a rejected transceiver.
        pc.transceivers[sdpMLineIndex] = pc._createTransceiver(kind, true);
      }

      var transceiver;
      var iceGatherer;
      var iceTransport;
      var dtlsTransport;
      var rtpReceiver;
      var sendEncodingParameters;
      var recvEncodingParameters;
      var localCapabilities;

      var track;
      // FIXME: ensure the mediaSection has rtcp-mux set.
      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);
      var remoteIceParameters;
      var remoteDtlsParameters;
      if (!rejected) {
        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,
            sessionpart);
        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,
            sessionpart);
        remoteDtlsParameters.role = 'client';
      }
      recvEncodingParameters =
          SDPUtils.parseRtpEncodingParameters(mediaSection);

      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);

      var isComplete = SDPUtils.matchPrefix(mediaSection,
          'a=end-of-candidates', sessionpart).length > 0;
      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')
          .map(function(cand) {
            return SDPUtils.parseCandidate(cand);
          })
          .filter(function(cand) {
            return cand.component === 1;
          });

      // Check if we can use BUNDLE and dispose transports.
      if ((description.type === 'offer' || description.type === 'answer') &&
          !rejected && usingBundle && sdpMLineIndex > 0 &&
          pc.transceivers[sdpMLineIndex]) {
        pc._disposeIceAndDtlsTransports(sdpMLineIndex);
        pc.transceivers[sdpMLineIndex].iceGatherer =
            pc.transceivers[0].iceGatherer;
        pc.transceivers[sdpMLineIndex].iceTransport =
            pc.transceivers[0].iceTransport;
        pc.transceivers[sdpMLineIndex].dtlsTransport =
            pc.transceivers[0].dtlsTransport;
        if (pc.transceivers[sdpMLineIndex].rtpSender) {
          pc.transceivers[sdpMLineIndex].rtpSender.setTransport(
              pc.transceivers[0].dtlsTransport);
        }
        if (pc.transceivers[sdpMLineIndex].rtpReceiver) {
          pc.transceivers[sdpMLineIndex].rtpReceiver.setTransport(
              pc.transceivers[0].dtlsTransport);
        }
      }
      if (description.type === 'offer' && !rejected) {
        transceiver = pc.transceivers[sdpMLineIndex] ||
            pc._createTransceiver(kind);
        transceiver.mid = mid;

        if (!transceiver.iceGatherer) {
          transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,
              usingBundle);
        }

        if (cands.length && transceiver.iceTransport.state === 'new') {
          if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {
            transceiver.iceTransport.setRemoteCandidates(cands);
          } else {
            cands.forEach(function(candidate) {
              maybeAddCandidate(transceiver.iceTransport, candidate);
            });
          }
        }

        localCapabilities = window.RTCRtpReceiver.getCapabilities(kind);

        // filter RTX until additional stuff needed for RTX is implemented
        // in adapter.js
        if (edgeVersion < 15019) {
          localCapabilities.codecs = localCapabilities.codecs.filter(
              function(codec) {
                return codec.name !== 'rtx';
              });
        }

        sendEncodingParameters = transceiver.sendEncodingParameters || [{
          ssrc: (2 * sdpMLineIndex + 2) * 1001
        }];

        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams
        var isNewTrack = false;
        if (direction === 'sendrecv' || direction === 'sendonly') {
          isNewTrack = !transceiver.rtpReceiver;
          rtpReceiver = transceiver.rtpReceiver ||
              new window.RTCRtpReceiver(transceiver.dtlsTransport, kind);

          if (isNewTrack) {
            var stream;
            track = rtpReceiver.track;
            // FIXME: does not work with Plan B.
            if (remoteMsid && remoteMsid.stream === '-') {
              // no-op. a stream id of '-' means: no associated stream.
            } else if (remoteMsid) {
              if (!streams[remoteMsid.stream]) {
                streams[remoteMsid.stream] = new window.MediaStream();
                Object.defineProperty(streams[remoteMsid.stream], 'id', {
                  get: function() {
                    return remoteMsid.stream;
                  }
                });
              }
              Object.defineProperty(track, 'id', {
                get: function() {
                  return remoteMsid.track;
                }
              });
              stream = streams[remoteMsid.stream];
            } else {
              if (!streams.default) {
                streams.default = new window.MediaStream();
              }
              stream = streams.default;
            }
            if (stream) {
              addTrackToStreamAndFireEvent(track, stream);
              transceiver.associatedRemoteMediaStreams.push(stream);
            }
            receiverList.push([track, rtpReceiver, stream]);
          }
        } else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {
          transceiver.associatedRemoteMediaStreams.forEach(function(s) {
            var nativeTrack = s.getTracks().find(function(t) {
              return t.id === transceiver.rtpReceiver.track.id;
            });
            if (nativeTrack) {
              removeTrackFromStreamAndFireEvent(nativeTrack, s);
            }
          });
          transceiver.associatedRemoteMediaStreams = [];
        }

        transceiver.localCapabilities = localCapabilities;
        transceiver.remoteCapabilities = remoteCapabilities;
        transceiver.rtpReceiver = rtpReceiver;
        transceiver.rtcpParameters = rtcpParameters;
        transceiver.sendEncodingParameters = sendEncodingParameters;
        transceiver.recvEncodingParameters = recvEncodingParameters;

        // Start the RTCRtpReceiver now. The RTPSender is started in
        // setLocalDescription.
        pc._transceive(pc.transceivers[sdpMLineIndex],
            false,
            isNewTrack);
      } else if (description.type === 'answer' && !rejected) {
        transceiver = pc.transceivers[sdpMLineIndex];
        iceGatherer = transceiver.iceGatherer;
        iceTransport = transceiver.iceTransport;
        dtlsTransport = transceiver.dtlsTransport;
        rtpReceiver = transceiver.rtpReceiver;
        sendEncodingParameters = transceiver.sendEncodingParameters;
        localCapabilities = transceiver.localCapabilities;

        pc.transceivers[sdpMLineIndex].recvEncodingParameters =
            recvEncodingParameters;
        pc.transceivers[sdpMLineIndex].remoteCapabilities =
            remoteCapabilities;
        pc.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;

        if (cands.length && iceTransport.state === 'new') {
          if ((isIceLite || isComplete) &&
              (!usingBundle || sdpMLineIndex === 0)) {
            iceTransport.setRemoteCandidates(cands);
          } else {
            cands.forEach(function(candidate) {
              maybeAddCandidate(transceiver.iceTransport, candidate);
            });
          }
        }

        if (!usingBundle || sdpMLineIndex === 0) {
          if (iceTransport.state === 'new') {
            iceTransport.start(iceGatherer, remoteIceParameters,
                'controlling');
          }
          if (dtlsTransport.state === 'new') {
            dtlsTransport.start(remoteDtlsParameters);
          }
        }

        // If the offer contained RTX but the answer did not,
        // remove RTX from sendEncodingParameters.
        var commonCapabilities = getCommonCapabilities(
          transceiver.localCapabilities,
          transceiver.remoteCapabilities);

        var hasRtx = commonCapabilities.codecs.filter(function(c) {
          return c.name.toLowerCase() === 'rtx';
        }).length;
        if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {
          delete transceiver.sendEncodingParameters[0].rtx;
        }

        pc._transceive(transceiver,
            direction === 'sendrecv' || direction === 'recvonly',
            direction === 'sendrecv' || direction === 'sendonly');

        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams
        if (rtpReceiver &&
            (direction === 'sendrecv' || direction === 'sendonly')) {
          track = rtpReceiver.track;
          if (remoteMsid) {
            if (!streams[remoteMsid.stream]) {
              streams[remoteMsid.stream] = new window.MediaStream();
            }
            addTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);
            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);
          } else {
            if (!streams.default) {
              streams.default = new window.MediaStream();
            }
            addTrackToStreamAndFireEvent(track, streams.default);
            receiverList.push([track, rtpReceiver, streams.default]);
          }
        } else {
          // FIXME: actually the receiver should be created later.
          delete transceiver.rtpReceiver;
        }
      }
    });

    if (pc._dtlsRole === undefined) {
      pc._dtlsRole = description.type === 'offer' ? 'active' : 'passive';
    }

    pc._remoteDescription = {
      type: description.type,
      sdp: description.sdp
    };
    if (description.type === 'offer') {
      pc._updateSignalingState('have-remote-offer');
    } else {
      pc._updateSignalingState('stable');
    }
    Object.keys(streams).forEach(function(sid) {
      var stream = streams[sid];
      if (stream.getTracks().length) {
        if (pc.remoteStreams.indexOf(stream) === -1) {
          pc.remoteStreams.push(stream);
          var event = new Event('addstream');
          event.stream = stream;
          window.setTimeout(function() {
            pc._dispatchEvent('addstream', event);
          });
        }

        receiverList.forEach(function(item) {
          var track = item[0];
          var receiver = item[1];
          if (stream.id !== item[2].id) {
            return;
          }
          fireAddTrack(pc, track, receiver, [stream]);
        });
      }
    });
    receiverList.forEach(function(item) {
      if (item[2]) {
        return;
      }
      fireAddTrack(pc, item[0], item[1], []);
    });

    // check whether addIceCandidate({}) was called within four seconds after
    // setRemoteDescription.
    window.setTimeout(function() {
      if (!(pc && pc.transceivers)) {
        return;
      }
      pc.transceivers.forEach(function(transceiver) {
        if (transceiver.iceTransport &&
            transceiver.iceTransport.state === 'new' &&
            transceiver.iceTransport.getRemoteCandidates().length > 0) {
          console.warn('Timeout for addRemoteCandidate. Consider sending ' +
              'an end-of-candidates notification');
          transceiver.iceTransport.addRemoteCandidate({});
        }
      });
    }, 4000);

    return Promise.resolve();
  };

  RTCPeerConnection.prototype.close = function() {
    this.transceivers.forEach(function(transceiver) {
      /* not yet
      if (transceiver.iceGatherer) {
        transceiver.iceGatherer.close();
      }
      */
      if (transceiver.iceTransport) {
        transceiver.iceTransport.stop();
      }
      if (transceiver.dtlsTransport) {
        transceiver.dtlsTransport.stop();
      }
      if (transceiver.rtpSender) {
        transceiver.rtpSender.stop();
      }
      if (transceiver.rtpReceiver) {
        transceiver.rtpReceiver.stop();
      }
    });
    // FIXME: clean up tracks, local streams, remote streams, etc
    this._isClosed = true;
    this._updateSignalingState('closed');
  };

  // Update the signaling state.
  RTCPeerConnection.prototype._updateSignalingState = function(newState) {
    this.signalingState = newState;
    var event = new Event('signalingstatechange');
    this._dispatchEvent('signalingstatechange', event);
  };

  // Determine whether to fire the negotiationneeded event.
  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {
    var pc = this;
    if (this.signalingState !== 'stable' || this.needNegotiation === true) {
      return;
    }
    this.needNegotiation = true;
    window.setTimeout(function() {
      if (pc.needNegotiation) {
        pc.needNegotiation = false;
        var event = new Event('negotiationneeded');
        pc._dispatchEvent('negotiationneeded', event);
      }
    }, 0);
  };

  // Update the ice connection state.
  RTCPeerConnection.prototype._updateIceConnectionState = function() {
    var newState;
    var states = {
      'new': 0,
      closed: 0,
      checking: 0,
      connected: 0,
      completed: 0,
      disconnected: 0,
      failed: 0
    };
    this.transceivers.forEach(function(transceiver) {
      if (transceiver.iceTransport && !transceiver.rejected) {
        states[transceiver.iceTransport.state]++;
      }
    });

    newState = 'new';
    if (states.failed > 0) {
      newState = 'failed';
    } else if (states.checking > 0) {
      newState = 'checking';
    } else if (states.disconnected > 0) {
      newState = 'disconnected';
    } else if (states.new > 0) {
      newState = 'new';
    } else if (states.connected > 0) {
      newState = 'connected';
    } else if (states.completed > 0) {
      newState = 'completed';
    }

    if (newState !== this.iceConnectionState) {
      this.iceConnectionState = newState;
      var event = new Event('iceconnectionstatechange');
      this._dispatchEvent('iceconnectionstatechange', event);
    }
  };

  // Update the connection state.
  RTCPeerConnection.prototype._updateConnectionState = function() {
    var newState;
    var states = {
      'new': 0,
      closed: 0,
      connecting: 0,
      connected: 0,
      completed: 0,
      disconnected: 0,
      failed: 0
    };
    this.transceivers.forEach(function(transceiver) {
      if (transceiver.iceTransport && transceiver.dtlsTransport &&
          !transceiver.rejected) {
        states[transceiver.iceTransport.state]++;
        states[transceiver.dtlsTransport.state]++;
      }
    });
    // ICETransport.completed and connected are the same for this purpose.
    states.connected += states.completed;

    newState = 'new';
    if (states.failed > 0) {
      newState = 'failed';
    } else if (states.connecting > 0) {
      newState = 'connecting';
    } else if (states.disconnected > 0) {
      newState = 'disconnected';
    } else if (states.new > 0) {
      newState = 'new';
    } else if (states.connected > 0) {
      newState = 'connected';
    }

    if (newState !== this.connectionState) {
      this.connectionState = newState;
      var event = new Event('connectionstatechange');
      this._dispatchEvent('connectionstatechange', event);
    }
  };

  RTCPeerConnection.prototype.createOffer = function() {
    var pc = this;

    if (pc._isClosed) {
      return Promise.reject(makeError('InvalidStateError',
          'Can not call createOffer after close'));
    }

    var numAudioTracks = pc.transceivers.filter(function(t) {
      return t.kind === 'audio';
    }).length;
    var numVideoTracks = pc.transceivers.filter(function(t) {
      return t.kind === 'video';
    }).length;

    // Determine number of audio and video tracks we need to send/recv.
    var offerOptions = arguments[0];
    if (offerOptions) {
      // Reject Chrome legacy constraints.
      if (offerOptions.mandatory || offerOptions.optional) {
        throw new TypeError(
            'Legacy mandatory/optional constraints not supported.');
      }
      if (offerOptions.offerToReceiveAudio !== undefined) {
        if (offerOptions.offerToReceiveAudio === true) {
          numAudioTracks = 1;
        } else if (offerOptions.offerToReceiveAudio === false) {
          numAudioTracks = 0;
        } else {
          numAudioTracks = offerOptions.offerToReceiveAudio;
        }
      }
      if (offerOptions.offerToReceiveVideo !== undefined) {
        if (offerOptions.offerToReceiveVideo === true) {
          numVideoTracks = 1;
        } else if (offerOptions.offerToReceiveVideo === false) {
          numVideoTracks = 0;
        } else {
          numVideoTracks = offerOptions.offerToReceiveVideo;
        }
      }
    }

    pc.transceivers.forEach(function(transceiver) {
      if (transceiver.kind === 'audio') {
        numAudioTracks--;
        if (numAudioTracks < 0) {
          transceiver.wantReceive = false;
        }
      } else if (transceiver.kind === 'video') {
        numVideoTracks--;
        if (numVideoTracks < 0) {
          transceiver.wantReceive = false;
        }
      }
    });

    // Create M-lines for recvonly streams.
    while (numAudioTracks > 0 || numVideoTracks > 0) {
      if (numAudioTracks > 0) {
        pc._createTransceiver('audio');
        numAudioTracks--;
      }
      if (numVideoTracks > 0) {
        pc._createTransceiver('video');
        numVideoTracks--;
      }
    }

    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,
        pc._sdpSessionVersion++);
    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {
      // For each track, create an ice gatherer, ice transport,
      // dtls transport, potentially rtpsender and rtpreceiver.
      var track = transceiver.track;
      var kind = transceiver.kind;
      var mid = transceiver.mid || SDPUtils.generateIdentifier();
      transceiver.mid = mid;

      if (!transceiver.iceGatherer) {
        transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,
            pc.usingBundle);
      }

      var localCapabilities = window.RTCRtpSender.getCapabilities(kind);
      // filter RTX until additional stuff needed for RTX is implemented
      // in adapter.js
      if (edgeVersion < 15019) {
        localCapabilities.codecs = localCapabilities.codecs.filter(
            function(codec) {
              return codec.name !== 'rtx';
            });
      }
      localCapabilities.codecs.forEach(function(codec) {
        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552
        // by adding level-asymmetry-allowed=1
        if (codec.name === 'H264' &&
            codec.parameters['level-asymmetry-allowed'] === undefined) {
          codec.parameters['level-asymmetry-allowed'] = '1';
        }

        // for subsequent offers, we might have to re-use the payload
        // type of the last offer.
        if (transceiver.remoteCapabilities &&
            transceiver.remoteCapabilities.codecs) {
          transceiver.remoteCapabilities.codecs.forEach(function(remoteCodec) {
            if (codec.name.toLowerCase() === remoteCodec.name.toLowerCase() &&
                codec.clockRate === remoteCodec.clockRate) {
              codec.preferredPayloadType = remoteCodec.payloadType;
            }
          });
        }
      });
      localCapabilities.headerExtensions.forEach(function(hdrExt) {
        var remoteExtensions = transceiver.remoteCapabilities &&
            transceiver.remoteCapabilities.headerExtensions || [];
        remoteExtensions.forEach(function(rHdrExt) {
          if (hdrExt.uri === rHdrExt.uri) {
            hdrExt.id = rHdrExt.id;
          }
        });
      });

      // generate an ssrc now, to be used later in rtpSender.send
      var sendEncodingParameters = transceiver.sendEncodingParameters || [{
        ssrc: (2 * sdpMLineIndex + 1) * 1001
      }];
      if (track) {
        // add RTX
        if (edgeVersion >= 15019 && kind === 'video' &&
            !sendEncodingParameters[0].rtx) {
          sendEncodingParameters[0].rtx = {
            ssrc: sendEncodingParameters[0].ssrc + 1
          };
        }
      }

      if (transceiver.wantReceive) {
        transceiver.rtpReceiver = new window.RTCRtpReceiver(
            transceiver.dtlsTransport, kind);
      }

      transceiver.localCapabilities = localCapabilities;
      transceiver.sendEncodingParameters = sendEncodingParameters;
    });

    // always offer BUNDLE and dispose on return if not supported.
    if (pc._config.bundlePolicy !== 'max-compat') {
      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {
        return t.mid;
      }).join(' ') + '\r\n';
    }
    sdp += 'a=ice-options:trickle\r\n';

    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {
      sdp += writeMediaSection(transceiver, transceiver.localCapabilities,
          'offer', transceiver.stream, pc._dtlsRole);
      sdp += 'a=rtcp-rsize\r\n';

      if (transceiver.iceGatherer && pc.iceGatheringState !== 'new' &&
          (sdpMLineIndex === 0 || !pc.usingBundle)) {
        transceiver.iceGatherer.getLocalCandidates().forEach(function(cand) {
          cand.component = 1;
          sdp += 'a=' + SDPUtils.writeCandidate(cand) + '\r\n';
        });

        if (transceiver.iceGatherer.state === 'completed') {
          sdp += 'a=end-of-candidates\r\n';
        }
      }
    });

    var desc = new window.RTCSessionDescription({
      type: 'offer',
      sdp: sdp
    });
    return Promise.resolve(desc);
  };

  RTCPeerConnection.prototype.createAnswer = function() {
    var pc = this;

    if (pc._isClosed) {
      return Promise.reject(makeError('InvalidStateError',
          'Can not call createAnswer after close'));
    }

    if (!(pc.signalingState === 'have-remote-offer' ||
        pc.signalingState === 'have-local-pranswer')) {
      return Promise.reject(makeError('InvalidStateError',
          'Can not call createAnswer in signalingState ' + pc.signalingState));
    }

    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,
        pc._sdpSessionVersion++);
    if (pc.usingBundle) {
      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {
        return t.mid;
      }).join(' ') + '\r\n';
    }
    sdp += 'a=ice-options:trickle\r\n';

    var mediaSectionsInOffer = SDPUtils.getMediaSections(
        pc._remoteDescription.sdp).length;
    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {
      if (sdpMLineIndex + 1 > mediaSectionsInOffer) {
        return;
      }
      if (transceiver.rejected) {
        if (transceiver.kind === 'application') {
          if (transceiver.protocol === 'DTLS/SCTP') { // legacy fmt
            sdp += 'm=application 0 DTLS/SCTP 5000\r\n';
          } else {
            sdp += 'm=application 0 ' + transceiver.protocol +
                ' webrtc-datachannel\r\n';
          }
        } else if (transceiver.kind === 'audio') {
          sdp += 'm=audio 0 UDP/TLS/RTP/SAVPF 0\r\n' +
              'a=rtpmap:0 PCMU/8000\r\n';
        } else if (transceiver.kind === 'video') {
          sdp += 'm=video 0 UDP/TLS/RTP/SAVPF 120\r\n' +
              'a=rtpmap:120 VP8/90000\r\n';
        }
        sdp += 'c=IN IP4 0.0.0.0\r\n' +
            'a=inactive\r\n' +
            'a=mid:' + transceiver.mid + '\r\n';
        return;
      }

      // FIXME: look at direction.
      if (transceiver.stream) {
        var localTrack;
        if (transceiver.kind === 'audio') {
          localTrack = transceiver.stream.getAudioTracks()[0];
        } else if (transceiver.kind === 'video') {
          localTrack = transceiver.stream.getVideoTracks()[0];
        }
        if (localTrack) {
          // add RTX
          if (edgeVersion >= 15019 && transceiver.kind === 'video' &&
              !transceiver.sendEncodingParameters[0].rtx) {
            transceiver.sendEncodingParameters[0].rtx = {
              ssrc: transceiver.sendEncodingParameters[0].ssrc + 1
            };
          }
        }
      }

      // Calculate intersection of capabilities.
      var commonCapabilities = getCommonCapabilities(
          transceiver.localCapabilities,
          transceiver.remoteCapabilities);

      var hasRtx = commonCapabilities.codecs.filter(function(c) {
        return c.name.toLowerCase() === 'rtx';
      }).length;
      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {
        delete transceiver.sendEncodingParameters[0].rtx;
      }

      sdp += writeMediaSection(transceiver, commonCapabilities,
          'answer', transceiver.stream, pc._dtlsRole);
      if (transceiver.rtcpParameters &&
          transceiver.rtcpParameters.reducedSize) {
        sdp += 'a=rtcp-rsize\r\n';
      }
    });

    var desc = new window.RTCSessionDescription({
      type: 'answer',
      sdp: sdp
    });
    return Promise.resolve(desc);
  };

  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {
    var pc = this;
    var sections;
    if (candidate && !(candidate.sdpMLineIndex !== undefined ||
        candidate.sdpMid)) {
      return Promise.reject(new TypeError('sdpMLineIndex or sdpMid required'));
    }

    // TODO: needs to go into ops queue.
    return new Promise(function(resolve, reject) {
      if (!pc._remoteDescription) {
        return reject(makeError('InvalidStateError',
            'Can not add ICE candidate without a remote description'));
      } else if (!candidate || candidate.candidate === '') {
        for (var j = 0; j < pc.transceivers.length; j++) {
          if (pc.transceivers[j].rejected) {
            continue;
          }
          pc.transceivers[j].iceTransport.addRemoteCandidate({});
          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);
          sections[j] += 'a=end-of-candidates\r\n';
          pc._remoteDescription.sdp =
              SDPUtils.getDescription(pc._remoteDescription.sdp) +
              sections.join('');
          if (pc.usingBundle) {
            break;
          }
        }
      } else {
        var sdpMLineIndex = candidate.sdpMLineIndex;
        if (candidate.sdpMid) {
          for (var i = 0; i < pc.transceivers.length; i++) {
            if (pc.transceivers[i].mid === candidate.sdpMid) {
              sdpMLineIndex = i;
              break;
            }
          }
        }
        var transceiver = pc.transceivers[sdpMLineIndex];
        if (transceiver) {
          if (transceiver.rejected) {
            return resolve();
          }
          var cand = Object.keys(candidate.candidate).length > 0 ?
              SDPUtils.parseCandidate(candidate.candidate) : {};
          // Ignore Chrome's invalid candidates since Edge does not like them.
          if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {
            return resolve();
          }
          // Ignore RTCP candidates, we assume RTCP-MUX.
          if (cand.component && cand.component !== 1) {
            return resolve();
          }
          // when using bundle, avoid adding candidates to the wrong
          // ice transport. And avoid adding candidates added in the SDP.
          if (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&
              transceiver.iceTransport !== pc.transceivers[0].iceTransport)) {
            if (!maybeAddCandidate(transceiver.iceTransport, cand)) {
              return reject(makeError('OperationError',
                  'Can not add ICE candidate'));
            }
          }

          // update the remoteDescription.
          var candidateString = candidate.candidate.trim();
          if (candidateString.indexOf('a=') === 0) {
            candidateString = candidateString.substr(2);
          }
          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);
          sections[sdpMLineIndex] += 'a=' +
              (cand.type ? candidateString : 'end-of-candidates')
              + '\r\n';
          pc._remoteDescription.sdp =
              SDPUtils.getDescription(pc._remoteDescription.sdp) +
              sections.join('');
        } else {
          return reject(makeError('OperationError',
              'Can not add ICE candidate'));
        }
      }
      resolve();
    });
  };

  RTCPeerConnection.prototype.getStats = function(selector) {
    if (selector && selector instanceof window.MediaStreamTrack) {
      var senderOrReceiver = null;
      this.transceivers.forEach(function(transceiver) {
        if (transceiver.rtpSender &&
            transceiver.rtpSender.track === selector) {
          senderOrReceiver = transceiver.rtpSender;
        } else if (transceiver.rtpReceiver &&
            transceiver.rtpReceiver.track === selector) {
          senderOrReceiver = transceiver.rtpReceiver;
        }
      });
      if (!senderOrReceiver) {
        throw makeError('InvalidAccessError', 'Invalid selector.');
      }
      return senderOrReceiver.getStats();
    }

    var promises = [];
    this.transceivers.forEach(function(transceiver) {
      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',
          'dtlsTransport'].forEach(function(method) {
            if (transceiver[method]) {
              promises.push(transceiver[method].getStats());
            }
          });
    });
    return Promise.all(promises).then(function(allStats) {
      var results = new Map();
      allStats.forEach(function(stats) {
        stats.forEach(function(stat) {
          results.set(stat.id, stat);
        });
      });
      return results;
    });
  };

  // fix low-level stat names and return Map instead of object.
  var ortcObjects = ['RTCRtpSender', 'RTCRtpReceiver', 'RTCIceGatherer',
    'RTCIceTransport', 'RTCDtlsTransport'];
  ortcObjects.forEach(function(ortcObjectName) {
    var obj = window[ortcObjectName];
    if (obj && obj.prototype && obj.prototype.getStats) {
      var nativeGetstats = obj.prototype.getStats;
      obj.prototype.getStats = function() {
        return nativeGetstats.apply(this)
        .then(function(nativeStats) {
          var mapStats = new Map();
          Object.keys(nativeStats).forEach(function(id) {
            nativeStats[id].type = fixStatsType(nativeStats[id]);
            mapStats.set(id, nativeStats[id]);
          });
          return mapStats;
        });
      };
    }
  });

  // legacy callback shims. Should be moved to adapter.js some days.
  var methods = ['createOffer', 'createAnswer'];
  methods.forEach(function(method) {
    var nativeMethod = RTCPeerConnection.prototype[method];
    RTCPeerConnection.prototype[method] = function() {
      var args = arguments;
      if (typeof args[0] === 'function' ||
          typeof args[1] === 'function') { // legacy
        return nativeMethod.apply(this, [arguments[2]])
        .then(function(description) {
          if (typeof args[0] === 'function') {
            args[0].apply(null, [description]);
          }
        }, function(error) {
          if (typeof args[1] === 'function') {
            args[1].apply(null, [error]);
          }
        });
      }
      return nativeMethod.apply(this, arguments);
    };
  });

  methods = ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'];
  methods.forEach(function(method) {
    var nativeMethod = RTCPeerConnection.prototype[method];
    RTCPeerConnection.prototype[method] = function() {
      var args = arguments;
      if (typeof args[1] === 'function' ||
          typeof args[2] === 'function') { // legacy
        return nativeMethod.apply(this, arguments)
        .then(function() {
          if (typeof args[1] === 'function') {
            args[1].apply(null);
          }
        }, function(error) {
          if (typeof args[2] === 'function') {
            args[2].apply(null, [error]);
          }
        });
      }
      return nativeMethod.apply(this, arguments);
    };
  });

  // getStats is special. It doesn't have a spec legacy method yet we support
  // getStats(something, cb) without error callbacks.
  ['getStats'].forEach(function(method) {
    var nativeMethod = RTCPeerConnection.prototype[method];
    RTCPeerConnection.prototype[method] = function() {
      var args = arguments;
      if (typeof args[1] === 'function') {
        return nativeMethod.apply(this, arguments)
        .then(function() {
          if (typeof args[1] === 'function') {
            args[1].apply(null);
          }
        });
      }
      return nativeMethod.apply(this, arguments);
    };
  });

  return RTCPeerConnection;
};

},{"sdp":118}],118:[function(require,module,exports){
/* eslint-env node */
'use strict';

// SDP helpers.
var SDPUtils = {};

// Generate an alphanumeric identifier for cname or mids.
// TODO: use UUIDs instead? https://gist.github.com/jed/982883
SDPUtils.generateIdentifier = function() {
  return Math.random().toString(36).substr(2, 10);
};

// The RTCP CNAME used by all peerconnections from the same JS.
SDPUtils.localCName = SDPUtils.generateIdentifier();

// Splits SDP into lines, dealing with both CRLF and LF.
SDPUtils.splitLines = function(blob) {
  return blob.trim().split('\n').map(function(line) {
    return line.trim();
  });
};
// Splits SDP into sessionpart and mediasections. Ensures CRLF.
SDPUtils.splitSections = function(blob) {
  var parts = blob.split('\nm=');
  return parts.map(function(part, index) {
    return (index > 0 ? 'm=' + part : part).trim() + '\r\n';
  });
};

// returns the session description.
SDPUtils.getDescription = function(blob) {
  var sections = SDPUtils.splitSections(blob);
  return sections && sections[0];
};

// returns the individual media sections.
SDPUtils.getMediaSections = function(blob) {
  var sections = SDPUtils.splitSections(blob);
  sections.shift();
  return sections;
};

// Returns lines that start with a certain prefix.
SDPUtils.matchPrefix = function(blob, prefix) {
  return SDPUtils.splitLines(blob).filter(function(line) {
    return line.indexOf(prefix) === 0;
  });
};

// Parses an ICE candidate line. Sample input:
// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8
// rport 55996"
SDPUtils.parseCandidate = function(line) {
  var parts;
  // Parse both variants.
  if (line.indexOf('a=candidate:') === 0) {
    parts = line.substring(12).split(' ');
  } else {
    parts = line.substring(10).split(' ');
  }

  var candidate = {
    foundation: parts[0],
    component: parseInt(parts[1], 10),
    protocol: parts[2].toLowerCase(),
    priority: parseInt(parts[3], 10),
    ip: parts[4],
    address: parts[4], // address is an alias for ip.
    port: parseInt(parts[5], 10),
    // skip parts[6] == 'typ'
    type: parts[7]
  };

  for (var i = 8; i < parts.length; i += 2) {
    switch (parts[i]) {
      case 'raddr':
        candidate.relatedAddress = parts[i + 1];
        break;
      case 'rport':
        candidate.relatedPort = parseInt(parts[i + 1], 10);
        break;
      case 'tcptype':
        candidate.tcpType = parts[i + 1];
        break;
      case 'ufrag':
        candidate.ufrag = parts[i + 1]; // for backward compability.
        candidate.usernameFragment = parts[i + 1];
        break;
      default: // extension handling, in particular ufrag
        candidate[parts[i]] = parts[i + 1];
        break;
    }
  }
  return candidate;
};

// Translates a candidate object into SDP candidate attribute.
SDPUtils.writeCandidate = function(candidate) {
  var sdp = [];
  sdp.push(candidate.foundation);
  sdp.push(candidate.component);
  sdp.push(candidate.protocol.toUpperCase());
  sdp.push(candidate.priority);
  sdp.push(candidate.address || candidate.ip);
  sdp.push(candidate.port);

  var type = candidate.type;
  sdp.push('typ');
  sdp.push(type);
  if (type !== 'host' && candidate.relatedAddress &&
      candidate.relatedPort) {
    sdp.push('raddr');
    sdp.push(candidate.relatedAddress);
    sdp.push('rport');
    sdp.push(candidate.relatedPort);
  }
  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {
    sdp.push('tcptype');
    sdp.push(candidate.tcpType);
  }
  if (candidate.usernameFragment || candidate.ufrag) {
    sdp.push('ufrag');
    sdp.push(candidate.usernameFragment || candidate.ufrag);
  }
  return 'candidate:' + sdp.join(' ');
};

// Parses an ice-options line, returns an array of option tags.
// a=ice-options:foo bar
SDPUtils.parseIceOptions = function(line) {
  return line.substr(14).split(' ');
};

// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:
// a=rtpmap:111 opus/48000/2
SDPUtils.parseRtpMap = function(line) {
  var parts = line.substr(9).split(' ');
  var parsed = {
    payloadType: parseInt(parts.shift(), 10) // was: id
  };

  parts = parts[0].split('/');

  parsed.name = parts[0];
  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate
  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;
  // legacy alias, got renamed back to channels in ORTC.
  parsed.numChannels = parsed.channels;
  return parsed;
};

// Generate an a=rtpmap line from RTCRtpCodecCapability or
// RTCRtpCodecParameters.
SDPUtils.writeRtpMap = function(codec) {
  var pt = codec.payloadType;
  if (codec.preferredPayloadType !== undefined) {
    pt = codec.preferredPayloadType;
  }
  var channels = codec.channels || codec.numChannels || 1;
  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +
      (channels !== 1 ? '/' + channels : '') + '\r\n';
};

// Parses an a=extmap line (headerextension from RFC 5285). Sample input:
// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset
// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset
SDPUtils.parseExtmap = function(line) {
  var parts = line.substr(9).split(' ');
  return {
    id: parseInt(parts[0], 10),
    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',
    uri: parts[1]
  };
};

// Generates a=extmap line from RTCRtpHeaderExtensionParameters or
// RTCRtpHeaderExtension.
SDPUtils.writeExtmap = function(headerExtension) {
  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +
      (headerExtension.direction && headerExtension.direction !== 'sendrecv'
        ? '/' + headerExtension.direction
        : '') +
      ' ' + headerExtension.uri + '\r\n';
};

// Parses an ftmp line, returns dictionary. Sample input:
// a=fmtp:96 vbr=on;cng=on
// Also deals with vbr=on; cng=on
SDPUtils.parseFmtp = function(line) {
  var parsed = {};
  var kv;
  var parts = line.substr(line.indexOf(' ') + 1).split(';');
  for (var j = 0; j < parts.length; j++) {
    kv = parts[j].trim().split('=');
    parsed[kv[0].trim()] = kv[1];
  }
  return parsed;
};

// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.
SDPUtils.writeFmtp = function(codec) {
  var line = '';
  var pt = codec.payloadType;
  if (codec.preferredPayloadType !== undefined) {
    pt = codec.preferredPayloadType;
  }
  if (codec.parameters && Object.keys(codec.parameters).length) {
    var params = [];
    Object.keys(codec.parameters).forEach(function(param) {
      if (codec.parameters[param]) {
        params.push(param + '=' + codec.parameters[param]);
      } else {
        params.push(param);
      }
    });
    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\r\n';
  }
  return line;
};

// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:
// a=rtcp-fb:98 nack rpsi
SDPUtils.parseRtcpFb = function(line) {
  var parts = line.substr(line.indexOf(' ') + 1).split(' ');
  return {
    type: parts.shift(),
    parameter: parts.join(' ')
  };
};
// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.
SDPUtils.writeRtcpFb = function(codec) {
  var lines = '';
  var pt = codec.payloadType;
  if (codec.preferredPayloadType !== undefined) {
    pt = codec.preferredPayloadType;
  }
  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {
    // FIXME: special handling for trr-int?
    codec.rtcpFeedback.forEach(function(fb) {
      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +
      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +
          '\r\n';
    });
  }
  return lines;
};

// Parses an RFC 5576 ssrc media attribute. Sample input:
// a=ssrc:3735928559 cname:something
SDPUtils.parseSsrcMedia = function(line) {
  var sp = line.indexOf(' ');
  var parts = {
    ssrc: parseInt(line.substr(7, sp - 7), 10)
  };
  var colon = line.indexOf(':', sp);
  if (colon > -1) {
    parts.attribute = line.substr(sp + 1, colon - sp - 1);
    parts.value = line.substr(colon + 1);
  } else {
    parts.attribute = line.substr(sp + 1);
  }
  return parts;
};

SDPUtils.parseSsrcGroup = function(line) {
  var parts = line.substr(13).split(' ');
  return {
    semantics: parts.shift(),
    ssrcs: parts.map(function(ssrc) {
      return parseInt(ssrc, 10);
    })
  };
};

// Extracts the MID (RFC 5888) from a media section.
// returns the MID or undefined if no mid line was found.
SDPUtils.getMid = function(mediaSection) {
  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];
  if (mid) {
    return mid.substr(6);
  }
};

SDPUtils.parseFingerprint = function(line) {
  var parts = line.substr(14).split(' ');
  return {
    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.
    value: parts[1]
  };
};

// Extracts DTLS parameters from SDP media section or sessionpart.
// FIXME: for consistency with other functions this should only
//   get the fingerprint line as input. See also getIceParameters.
SDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {
  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,
    'a=fingerprint:');
  // Note: a=setup line is ignored since we use the 'auto' role.
  // Note2: 'algorithm' is not case sensitive except in Edge.
  return {
    role: 'auto',
    fingerprints: lines.map(SDPUtils.parseFingerprint)
  };
};

// Serializes DTLS parameters to SDP.
SDPUtils.writeDtlsParameters = function(params, setupType) {
  var sdp = 'a=setup:' + setupType + '\r\n';
  params.fingerprints.forEach(function(fp) {
    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\r\n';
  });
  return sdp;
};

// Parses a=crypto lines into
//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members
SDPUtils.parseCryptoLine = function(line) {
  var parts = line.substr(9).split(' ');
  return {
    tag: parseInt(parts[0], 10),
    cryptoSuite: parts[1],
    keyParams: parts[2],
    sessionParams: parts.slice(3),
  };
};

SDPUtils.writeCryptoLine = function(parameters) {
  return 'a=crypto:' + parameters.tag + ' ' +
    parameters.cryptoSuite + ' ' +
    (typeof parameters.keyParams === 'object'
      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)
      : parameters.keyParams) +
    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +
    '\r\n';
};

// Parses the crypto key parameters into
//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*
SDPUtils.parseCryptoKeyParams = function(keyParams) {
  if (keyParams.indexOf('inline:') !== 0) {
    return null;
  }
  var parts = keyParams.substr(7).split('|');
  return {
    keyMethod: 'inline',
    keySalt: parts[0],
    lifeTime: parts[1],
    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,
    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,
  };
};

SDPUtils.writeCryptoKeyParams = function(keyParams) {
  return keyParams.keyMethod + ':'
    + keyParams.keySalt +
    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +
    (keyParams.mkiValue && keyParams.mkiLength
      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength
      : '');
};

// Extracts all SDES paramters.
SDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {
  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,
    'a=crypto:');
  return lines.map(SDPUtils.parseCryptoLine);
};

// Parses ICE information from SDP media section or sessionpart.
// FIXME: for consistency with other functions this should only
//   get the ice-ufrag and ice-pwd lines as input.
SDPUtils.getIceParameters = function(mediaSection, sessionpart) {
  var ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,
    'a=ice-ufrag:')[0];
  var pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,
    'a=ice-pwd:')[0];
  if (!(ufrag && pwd)) {
    return null;
  }
  return {
    usernameFragment: ufrag.substr(12),
    password: pwd.substr(10),
  };
};

// Serializes ICE parameters to SDP.
SDPUtils.writeIceParameters = function(params) {
  return 'a=ice-ufrag:' + params.usernameFragment + '\r\n' +
      'a=ice-pwd:' + params.password + '\r\n';
};

// Parses the SDP media section and returns RTCRtpParameters.
SDPUtils.parseRtpParameters = function(mediaSection) {
  var description = {
    codecs: [],
    headerExtensions: [],
    fecMechanisms: [],
    rtcp: []
  };
  var lines = SDPUtils.splitLines(mediaSection);
  var mline = lines[0].split(' ');
  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]
    var pt = mline[i];
    var rtpmapline = SDPUtils.matchPrefix(
      mediaSection, 'a=rtpmap:' + pt + ' ')[0];
    if (rtpmapline) {
      var codec = SDPUtils.parseRtpMap(rtpmapline);
      var fmtps = SDPUtils.matchPrefix(
        mediaSection, 'a=fmtp:' + pt + ' ');
      // Only the first a=fmtp:<pt> is considered.
      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};
      codec.rtcpFeedback = SDPUtils.matchPrefix(
        mediaSection, 'a=rtcp-fb:' + pt + ' ')
        .map(SDPUtils.parseRtcpFb);
      description.codecs.push(codec);
      // parse FEC mechanisms from rtpmap lines.
      switch (codec.name.toUpperCase()) {
        case 'RED':
        case 'ULPFEC':
          description.fecMechanisms.push(codec.name.toUpperCase());
          break;
        default: // only RED and ULPFEC are recognized as FEC mechanisms.
          break;
      }
    }
  }
  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {
    description.headerExtensions.push(SDPUtils.parseExtmap(line));
  });
  // FIXME: parse rtcp.
  return description;
};

// Generates parts of the SDP media section describing the capabilities /
// parameters.
SDPUtils.writeRtpDescription = function(kind, caps) {
  var sdp = '';

  // Build the mline.
  sdp += 'm=' + kind + ' ';
  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.
  sdp += ' UDP/TLS/RTP/SAVPF ';
  sdp += caps.codecs.map(function(codec) {
    if (codec.preferredPayloadType !== undefined) {
      return codec.preferredPayloadType;
    }
    return codec.payloadType;
  }).join(' ') + '\r\n';

  sdp += 'c=IN IP4 0.0.0.0\r\n';
  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\r\n';

  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.
  caps.codecs.forEach(function(codec) {
    sdp += SDPUtils.writeRtpMap(codec);
    sdp += SDPUtils.writeFmtp(codec);
    sdp += SDPUtils.writeRtcpFb(codec);
  });
  var maxptime = 0;
  caps.codecs.forEach(function(codec) {
    if (codec.maxptime > maxptime) {
      maxptime = codec.maxptime;
    }
  });
  if (maxptime > 0) {
    sdp += 'a=maxptime:' + maxptime + '\r\n';
  }
  sdp += 'a=rtcp-mux\r\n';

  if (caps.headerExtensions) {
    caps.headerExtensions.forEach(function(extension) {
      sdp += SDPUtils.writeExtmap(extension);
    });
  }
  // FIXME: write fecMechanisms.
  return sdp;
};

// Parses the SDP media section and returns an array of
// RTCRtpEncodingParameters.
SDPUtils.parseRtpEncodingParameters = function(mediaSection) {
  var encodingParameters = [];
  var description = SDPUtils.parseRtpParameters(mediaSection);
  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;
  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;

  // filter a=ssrc:... cname:, ignore PlanB-msid
  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')
    .map(function(line) {
      return SDPUtils.parseSsrcMedia(line);
    })
    .filter(function(parts) {
      return parts.attribute === 'cname';
    });
  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;
  var secondarySsrc;

  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')
    .map(function(line) {
      var parts = line.substr(17).split(' ');
      return parts.map(function(part) {
        return parseInt(part, 10);
      });
    });
  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {
    secondarySsrc = flows[0][1];
  }

  description.codecs.forEach(function(codec) {
    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {
      var encParam = {
        ssrc: primarySsrc,
        codecPayloadType: parseInt(codec.parameters.apt, 10)
      };
      if (primarySsrc && secondarySsrc) {
        encParam.rtx = {ssrc: secondarySsrc};
      }
      encodingParameters.push(encParam);
      if (hasRed) {
        encParam = JSON.parse(JSON.stringify(encParam));
        encParam.fec = {
          ssrc: primarySsrc,
          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'
        };
        encodingParameters.push(encParam);
      }
    }
  });
  if (encodingParameters.length === 0 && primarySsrc) {
    encodingParameters.push({
      ssrc: primarySsrc
    });
  }

  // we support both b=AS and b=TIAS but interpret AS as TIAS.
  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');
  if (bandwidth.length) {
    if (bandwidth[0].indexOf('b=TIAS:') === 0) {
      bandwidth = parseInt(bandwidth[0].substr(7), 10);
    } else if (bandwidth[0].indexOf('b=AS:') === 0) {
      // use formula from JSEP to convert b=AS to TIAS value.
      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95
          - (50 * 40 * 8);
    } else {
      bandwidth = undefined;
    }
    encodingParameters.forEach(function(params) {
      params.maxBitrate = bandwidth;
    });
  }
  return encodingParameters;
};

// parses http://draft.ortc.org/#rtcrtcpparameters*
SDPUtils.parseRtcpParameters = function(mediaSection) {
  var rtcpParameters = {};

  // Gets the first SSRC. Note tha with RTX there might be multiple
  // SSRCs.
  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')
    .map(function(line) {
      return SDPUtils.parseSsrcMedia(line);
    })
    .filter(function(obj) {
      return obj.attribute === 'cname';
    })[0];
  if (remoteSsrc) {
    rtcpParameters.cname = remoteSsrc.value;
    rtcpParameters.ssrc = remoteSsrc.ssrc;
  }

  // Edge uses the compound attribute instead of reducedSize
  // compound is !reducedSize
  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');
  rtcpParameters.reducedSize = rsize.length > 0;
  rtcpParameters.compound = rsize.length === 0;

  // parses the rtcp-mux attrbute.
  // Note that Edge does not support unmuxed RTCP.
  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');
  rtcpParameters.mux = mux.length > 0;

  return rtcpParameters;
};

// parses either a=msid: or a=ssrc:... msid lines and returns
// the id of the MediaStream and MediaStreamTrack.
SDPUtils.parseMsid = function(mediaSection) {
  var parts;
  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');
  if (spec.length === 1) {
    parts = spec[0].substr(7).split(' ');
    return {stream: parts[0], track: parts[1]};
  }
  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')
    .map(function(line) {
      return SDPUtils.parseSsrcMedia(line);
    })
    .filter(function(msidParts) {
      return msidParts.attribute === 'msid';
    });
  if (planB.length > 0) {
    parts = planB[0].value.split(' ');
    return {stream: parts[0], track: parts[1]};
  }
};

// SCTP
// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back
// to draft-ietf-mmusic-sctp-sdp-05
SDPUtils.parseSctpDescription = function(mediaSection) {
  var mline = SDPUtils.parseMLine(mediaSection);
  var maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');
  var maxMessageSize;
  if (maxSizeLine.length > 0) {
    maxMessageSize = parseInt(maxSizeLine[0].substr(19), 10);
  }
  if (isNaN(maxMessageSize)) {
    maxMessageSize = 65536;
  }
  var sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');
  if (sctpPort.length > 0) {
    return {
      port: parseInt(sctpPort[0].substr(12), 10),
      protocol: mline.fmt,
      maxMessageSize: maxMessageSize
    };
  }
  var sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');
  if (sctpMapLines.length > 0) {
    var parts = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:')[0]
      .substr(10)
      .split(' ');
    return {
      port: parseInt(parts[0], 10),
      protocol: parts[1],
      maxMessageSize: maxMessageSize
    };
  }
};

// SCTP
// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers
// support by now receiving in this format, unless we originally parsed
// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line
// protocol of DTLS/SCTP -- without UDP/ or TCP/)
SDPUtils.writeSctpDescription = function(media, sctp) {
  var output = [];
  if (media.protocol !== 'DTLS/SCTP') {
    output = [
      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\r\n',
      'c=IN IP4 0.0.0.0\r\n',
      'a=sctp-port:' + sctp.port + '\r\n'
    ];
  } else {
    output = [
      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\r\n',
      'c=IN IP4 0.0.0.0\r\n',
      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\r\n'
    ];
  }
  if (sctp.maxMessageSize !== undefined) {
    output.push('a=max-message-size:' + sctp.maxMessageSize + '\r\n');
  }
  return output.join('');
};

// Generate a session ID for SDP.
// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1
// recommends using a cryptographically random +ve 64-bit value
// but right now this should be acceptable and within the right range
SDPUtils.generateSessionId = function() {
  return Math.random().toString().substr(2, 21);
};

// Write boilder plate for start of SDP
// sessId argument is optional - if not supplied it will
// be generated randomly
// sessVersion is optional and defaults to 2
// sessUser is optional and defaults to 'thisisadapterortc'
SDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {
  var sessionId;
  var version = sessVer !== undefined ? sessVer : 2;
  if (sessId) {
    sessionId = sessId;
  } else {
    sessionId = SDPUtils.generateSessionId();
  }
  var user = sessUser || 'thisisadapterortc';
  // FIXME: sess-id should be an NTP timestamp.
  return 'v=0\r\n' +
      'o=' + user + ' ' + sessionId + ' ' + version +
        ' IN IP4 127.0.0.1\r\n' +
      's=-\r\n' +
      't=0 0\r\n';
};

SDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {
  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);

  // Map ICE parameters (ufrag, pwd) to SDP.
  sdp += SDPUtils.writeIceParameters(
    transceiver.iceGatherer.getLocalParameters());

  // Map DTLS parameters to SDP.
  sdp += SDPUtils.writeDtlsParameters(
    transceiver.dtlsTransport.getLocalParameters(),
    type === 'offer' ? 'actpass' : 'active');

  sdp += 'a=mid:' + transceiver.mid + '\r\n';

  if (transceiver.direction) {
    sdp += 'a=' + transceiver.direction + '\r\n';
  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {
    sdp += 'a=sendrecv\r\n';
  } else if (transceiver.rtpSender) {
    sdp += 'a=sendonly\r\n';
  } else if (transceiver.rtpReceiver) {
    sdp += 'a=recvonly\r\n';
  } else {
    sdp += 'a=inactive\r\n';
  }

  if (transceiver.rtpSender) {
    // spec.
    var msid = 'msid:' + stream.id + ' ' +
        transceiver.rtpSender.track.id + '\r\n';
    sdp += 'a=' + msid;

    // for Chrome.
    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +
        ' ' + msid;
    if (transceiver.sendEncodingParameters[0].rtx) {
      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +
          ' ' + msid;
      sdp += 'a=ssrc-group:FID ' +
          transceiver.sendEncodingParameters[0].ssrc + ' ' +
          transceiver.sendEncodingParameters[0].rtx.ssrc +
          '\r\n';
    }
  }
  // FIXME: this should be written by writeRtpDescription.
  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +
      ' cname:' + SDPUtils.localCName + '\r\n';
  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {
    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +
        ' cname:' + SDPUtils.localCName + '\r\n';
  }
  return sdp;
};

// Gets the direction from the mediaSection or the sessionpart.
SDPUtils.getDirection = function(mediaSection, sessionpart) {
  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.
  var lines = SDPUtils.splitLines(mediaSection);
  for (var i = 0; i < lines.length; i++) {
    switch (lines[i]) {
      case 'a=sendrecv':
      case 'a=sendonly':
      case 'a=recvonly':
      case 'a=inactive':
        return lines[i].substr(2);
      default:
        // FIXME: What should happen here?
    }
  }
  if (sessionpart) {
    return SDPUtils.getDirection(sessionpart);
  }
  return 'sendrecv';
};

SDPUtils.getKind = function(mediaSection) {
  var lines = SDPUtils.splitLines(mediaSection);
  var mline = lines[0].split(' ');
  return mline[0].substr(2);
};

SDPUtils.isRejected = function(mediaSection) {
  return mediaSection.split(' ', 2)[1] === '0';
};

SDPUtils.parseMLine = function(mediaSection) {
  var lines = SDPUtils.splitLines(mediaSection);
  var parts = lines[0].substr(2).split(' ');
  return {
    kind: parts[0],
    port: parseInt(parts[1], 10),
    protocol: parts[2],
    fmt: parts.slice(3).join(' ')
  };
};

SDPUtils.parseOLine = function(mediaSection) {
  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];
  var parts = line.substr(2).split(' ');
  return {
    username: parts[0],
    sessionId: parts[1],
    sessionVersion: parseInt(parts[2], 10),
    netType: parts[3],
    addressType: parts[4],
    address: parts[5]
  };
};

// a very naive interpretation of a valid SDP.
SDPUtils.isValidSDP = function(blob) {
  if (typeof blob !== 'string' || blob.length === 0) {
    return false;
  }
  var lines = SDPUtils.splitLines(blob);
  for (var i = 0; i < lines.length; i++) {
    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {
      return false;
    }
    // TODO: check the modifier a bit more.
  }
  return true;
};

// Expose public methods.
if (typeof module === 'object') {
  module.exports = SDPUtils;
}

},{}],119:[function(require,module,exports){
/**
 * Convert array of 16 byte values to UUID string format of the form:
 * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
 */
var byteToHex = [];
for (var i = 0; i < 256; ++i) {
  byteToHex[i] = (i + 0x100).toString(16).substr(1);
}

function bytesToUuid(buf, offset) {
  var i = offset || 0;
  var bth = byteToHex;
  // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4
  return ([
    bth[buf[i++]], bth[buf[i++]],
    bth[buf[i++]], bth[buf[i++]], '-',
    bth[buf[i++]], bth[buf[i++]], '-',
    bth[buf[i++]], bth[buf[i++]], '-',
    bth[buf[i++]], bth[buf[i++]], '-',
    bth[buf[i++]], bth[buf[i++]],
    bth[buf[i++]], bth[buf[i++]],
    bth[buf[i++]], bth[buf[i++]]
  ]).join('');
}

module.exports = bytesToUuid;

},{}],120:[function(require,module,exports){
// Unique ID creation requires a high quality random # generator.  In the
// browser this is a little complicated due to unknown quality of Math.random()
// and inconsistent support for the `crypto` API.  We do the best we can via
// feature-detection

// getRandomValues needs to be invoked in a context where "this" is a Crypto
// implementation. Also, find the complete implementation of crypto on IE11.
var getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto)) ||
                      (typeof(msCrypto) != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto));

if (getRandomValues) {
  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto
  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef

  module.exports = function whatwgRNG() {
    getRandomValues(rnds8);
    return rnds8;
  };
} else {
  // Math.random()-based (RNG)
  //
  // If all else fails, use Math.random().  It's fast, but is of unspecified
  // quality.
  var rnds = new Array(16);

  module.exports = function mathRNG() {
    for (var i = 0, r; i < 16; i++) {
      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;
      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;
    }

    return rnds;
  };
}

},{}],121:[function(require,module,exports){
var rng = require('./lib/rng');
var bytesToUuid = require('./lib/bytesToUuid');

function v4(options, buf, offset) {
  var i = buf && offset || 0;

  if (typeof(options) == 'string') {
    buf = options === 'binary' ? new Array(16) : null;
    options = null;
  }
  options = options || {};

  var rnds = options.random || (options.rng || rng)();

  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`
  rnds[6] = (rnds[6] & 0x0f) | 0x40;
  rnds[8] = (rnds[8] & 0x3f) | 0x80;

  // Copy bytes to buffer, if provided
  if (buf) {
    for (var ii = 0; ii < 16; ++ii) {
      buf[i + ii] = rnds[ii];
    }
  }

  return buf || bytesToUuid(rnds);
}

module.exports = v4;

},{"./lib/bytesToUuid":119,"./lib/rng":120}],122:[function(require,module,exports){
(function (global){(function (){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */

'use strict';

var adapterFactory = require('./adapter_factory.js');
module.exports = adapterFactory({window: global.window});

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./adapter_factory.js":123}],123:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */

'use strict';

var utils = require('./utils');
// Shimming starts here.
module.exports = function(dependencies, opts) {
  var window = dependencies && dependencies.window;

  var options = {
    shimChrome: true,
    shimFirefox: true,
    shimEdge: true,
    shimSafari: true,
  };

  for (var key in opts) {
    if (hasOwnProperty.call(opts, key)) {
      options[key] = opts[key];
    }
  }

  // Utils.
  var logging = utils.log;
  var browserDetails = utils.detectBrowser(window);

  // Uncomment the line below if you want logging to occur, including logging
  // for the switch statement below. Can also be turned on in the browser via
  // adapter.disableLog(false), but then logging from the switch statement below
  // will not appear.
  // require('./utils').disableLog(false);

  // Browser shims.
  var chromeShim = require('./chrome/chrome_shim') || null;
  var edgeShim = require('./edge/edge_shim') || null;
  var firefoxShim = require('./firefox/firefox_shim') || null;
  var safariShim = require('./safari/safari_shim') || null;
  var commonShim = require('./common_shim') || null;

  // Export to the adapter global object visible in the browser.
  var adapter = {
    browserDetails: browserDetails,
    commonShim: commonShim,
    extractVersion: utils.extractVersion,
    disableLog: utils.disableLog,
    disableWarnings: utils.disableWarnings
  };

  // Shim browser if found.
  switch (browserDetails.browser) {
    case 'chrome':
      if (!chromeShim || !chromeShim.shimPeerConnection ||
          !options.shimChrome) {
        logging('Chrome shim is not included in this adapter release.');
        return adapter;
      }
      logging('adapter.js shimming chrome.');
      // Export to the adapter global object visible in the browser.
      adapter.browserShim = chromeShim;
      commonShim.shimCreateObjectURL(window);

      chromeShim.shimGetUserMedia(window);
      chromeShim.shimMediaStream(window);
      chromeShim.shimSourceObject(window);
      chromeShim.shimPeerConnection(window);
      chromeShim.shimOnTrack(window);
      chromeShim.shimAddTrackRemoveTrack(window);
      chromeShim.shimGetSendersWithDtmf(window);
      chromeShim.shimSenderReceiverGetStats(window);
      chromeShim.fixNegotiationNeeded(window);

      commonShim.shimRTCIceCandidate(window);
      commonShim.shimMaxMessageSize(window);
      commonShim.shimSendThrowTypeError(window);
      break;
    case 'firefox':
      if (!firefoxShim || !firefoxShim.shimPeerConnection ||
          !options.shimFirefox) {
        logging('Firefox shim is not included in this adapter release.');
        return adapter;
      }
      logging('adapter.js shimming firefox.');
      // Export to the adapter global object visible in the browser.
      adapter.browserShim = firefoxShim;
      commonShim.shimCreateObjectURL(window);

      firefoxShim.shimGetUserMedia(window);
      firefoxShim.shimSourceObject(window);
      firefoxShim.shimPeerConnection(window);
      firefoxShim.shimOnTrack(window);
      firefoxShim.shimRemoveStream(window);
      firefoxShim.shimSenderGetStats(window);
      firefoxShim.shimReceiverGetStats(window);
      firefoxShim.shimRTCDataChannel(window);

      commonShim.shimRTCIceCandidate(window);
      commonShim.shimMaxMessageSize(window);
      commonShim.shimSendThrowTypeError(window);
      break;
    case 'edge':
      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {
        logging('MS edge shim is not included in this adapter release.');
        return adapter;
      }
      logging('adapter.js shimming edge.');
      // Export to the adapter global object visible in the browser.
      adapter.browserShim = edgeShim;
      commonShim.shimCreateObjectURL(window);

      edgeShim.shimGetUserMedia(window);
      edgeShim.shimPeerConnection(window);
      edgeShim.shimReplaceTrack(window);
      edgeShim.shimGetDisplayMedia(window);

      // the edge shim implements the full RTCIceCandidate object.

      commonShim.shimMaxMessageSize(window);
      commonShim.shimSendThrowTypeError(window);
      break;
    case 'safari':
      if (!safariShim || !options.shimSafari) {
        logging('Safari shim is not included in this adapter release.');
        return adapter;
      }
      logging('adapter.js shimming safari.');
      // Export to the adapter global object visible in the browser.
      adapter.browserShim = safariShim;
      commonShim.shimCreateObjectURL(window);

      safariShim.shimRTCIceServerUrls(window);
      safariShim.shimCreateOfferLegacy(window);
      safariShim.shimCallbacksAPI(window);
      safariShim.shimLocalStreamsAPI(window);
      safariShim.shimRemoteStreamsAPI(window);
      safariShim.shimTrackEventTransceiver(window);
      safariShim.shimGetUserMedia(window);

      commonShim.shimRTCIceCandidate(window);
      commonShim.shimMaxMessageSize(window);
      commonShim.shimSendThrowTypeError(window);
      break;
    default:
      logging('Unsupported browser!');
      break;
  }

  return adapter;
};

},{"./chrome/chrome_shim":124,"./common_shim":126,"./edge/edge_shim":127,"./firefox/firefox_shim":130,"./safari/safari_shim":132,"./utils":133}],124:[function(require,module,exports){

/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';
var utils = require('../utils.js');
var logging = utils.log;

/* iterates the stats graph recursively. */
function walkStats(stats, base, resultSet) {
  if (!base || resultSet.has(base.id)) {
    return;
  }
  resultSet.set(base.id, base);
  Object.keys(base).forEach(function(name) {
    if (name.endsWith('Id')) {
      walkStats(stats, stats.get(base[name]), resultSet);
    } else if (name.endsWith('Ids')) {
      base[name].forEach(function(id) {
        walkStats(stats, stats.get(id), resultSet);
      });
    }
  });
}

/* filter getStats for a sender/receiver track. */
function filterStats(result, track, outbound) {
  var streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';
  var filteredResult = new Map();
  if (track === null) {
    return filteredResult;
  }
  var trackStats = [];
  result.forEach(function(value) {
    if (value.type === 'track' &&
        value.trackIdentifier === track.id) {
      trackStats.push(value);
    }
  });
  trackStats.forEach(function(trackStat) {
    result.forEach(function(stats) {
      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {
        walkStats(result, stats, filteredResult);
      }
    });
  });
  return filteredResult;
}

module.exports = {
  shimGetUserMedia: require('./getusermedia'),
  shimMediaStream: function(window) {
    window.MediaStream = window.MediaStream || window.webkitMediaStream;
  },

  shimOnTrack: function(window) {
    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in
        window.RTCPeerConnection.prototype)) {
      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {
        get: function() {
          return this._ontrack;
        },
        set: function(f) {
          if (this._ontrack) {
            this.removeEventListener('track', this._ontrack);
          }
          this.addEventListener('track', this._ontrack = f);
        },
        enumerable: true,
        configurable: true
      });
      var origSetRemoteDescription =
          window.RTCPeerConnection.prototype.setRemoteDescription;
      window.RTCPeerConnection.prototype.setRemoteDescription = function() {
        var pc = this;
        if (!pc._ontrackpoly) {
          pc._ontrackpoly = function(e) {
            // onaddstream does not fire when a track is added to an existing
            // stream. But stream.onaddtrack is implemented so we use that.
            e.stream.addEventListener('addtrack', function(te) {
              var receiver;
              if (window.RTCPeerConnection.prototype.getReceivers) {
                receiver = pc.getReceivers().find(function(r) {
                  return r.track && r.track.id === te.track.id;
                });
              } else {
                receiver = {track: te.track};
              }

              var event = new Event('track');
              event.track = te.track;
              event.receiver = receiver;
              event.transceiver = {receiver: receiver};
              event.streams = [e.stream];
              pc.dispatchEvent(event);
            });
            e.stream.getTracks().forEach(function(track) {
              var receiver;
              if (window.RTCPeerConnection.prototype.getReceivers) {
                receiver = pc.getReceivers().find(function(r) {
                  return r.track && r.track.id === track.id;
                });
              } else {
                receiver = {track: track};
              }
              var event = new Event('track');
              event.track = track;
              event.receiver = receiver;
              event.transceiver = {receiver: receiver};
              event.streams = [e.stream];
              pc.dispatchEvent(event);
            });
          };
          pc.addEventListener('addstream', pc._ontrackpoly);
        }
        return origSetRemoteDescription.apply(pc, arguments);
      };
    } else {
      // even if RTCRtpTransceiver is in window, it is only used and
      // emitted in unified-plan. Unfortunately this means we need
      // to unconditionally wrap the event.
      utils.wrapPeerConnectionEvent(window, 'track', function(e) {
        if (!e.transceiver) {
          Object.defineProperty(e, 'transceiver',
            {value: {receiver: e.receiver}});
        }
        return e;
      });
    }
  },

  shimGetSendersWithDtmf: function(window) {
    // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.
    if (typeof window === 'object' && window.RTCPeerConnection &&
        !('getSenders' in window.RTCPeerConnection.prototype) &&
        'createDTMFSender' in window.RTCPeerConnection.prototype) {
      var shimSenderWithDtmf = function(pc, track) {
        return {
          track: track,
          get dtmf() {
            if (this._dtmf === undefined) {
              if (track.kind === 'audio') {
                this._dtmf = pc.createDTMFSender(track);
              } else {
                this._dtmf = null;
              }
            }
            return this._dtmf;
          },
          _pc: pc
        };
      };

      // augment addTrack when getSenders is not available.
      if (!window.RTCPeerConnection.prototype.getSenders) {
        window.RTCPeerConnection.prototype.getSenders = function() {
          this._senders = this._senders || [];
          return this._senders.slice(); // return a copy of the internal state.
        };
        var origAddTrack = window.RTCPeerConnection.prototype.addTrack;
        window.RTCPeerConnection.prototype.addTrack = function(track, stream) {
          var pc = this;
          var sender = origAddTrack.apply(pc, arguments);
          if (!sender) {
            sender = shimSenderWithDtmf(pc, track);
            pc._senders.push(sender);
          }
          return sender;
        };

        var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;
        window.RTCPeerConnection.prototype.removeTrack = function(sender) {
          var pc = this;
          origRemoveTrack.apply(pc, arguments);
          var idx = pc._senders.indexOf(sender);
          if (idx !== -1) {
            pc._senders.splice(idx, 1);
          }
        };
      }
      var origAddStream = window.RTCPeerConnection.prototype.addStream;
      window.RTCPeerConnection.prototype.addStream = function(stream) {
        var pc = this;
        pc._senders = pc._senders || [];
        origAddStream.apply(pc, [stream]);
        stream.getTracks().forEach(function(track) {
          pc._senders.push(shimSenderWithDtmf(pc, track));
        });
      };

      var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;
      window.RTCPeerConnection.prototype.removeStream = function(stream) {
        var pc = this;
        pc._senders = pc._senders || [];
        origRemoveStream.apply(pc, [stream]);

        stream.getTracks().forEach(function(track) {
          var sender = pc._senders.find(function(s) {
            return s.track === track;
          });
          if (sender) {
            pc._senders.splice(pc._senders.indexOf(sender), 1); // remove sender
          }
        });
      };
    } else if (typeof window === 'object' && window.RTCPeerConnection &&
               'getSenders' in window.RTCPeerConnection.prototype &&
               'createDTMFSender' in window.RTCPeerConnection.prototype &&
               window.RTCRtpSender &&
               !('dtmf' in window.RTCRtpSender.prototype)) {
      var origGetSenders = window.RTCPeerConnection.prototype.getSenders;
      window.RTCPeerConnection.prototype.getSenders = function() {
        var pc = this;
        var senders = origGetSenders.apply(pc, []);
        senders.forEach(function(sender) {
          sender._pc = pc;
        });
        return senders;
      };

      Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {
        get: function() {
          if (this._dtmf === undefined) {
            if (this.track.kind === 'audio') {
              this._dtmf = this._pc.createDTMFSender(this.track);
            } else {
              this._dtmf = null;
            }
          }
          return this._dtmf;
        }
      });
    }
  },

  shimSenderReceiverGetStats: function(window) {
    if (!(typeof window === 'object' && window.RTCPeerConnection &&
        window.RTCRtpSender && window.RTCRtpReceiver)) {
      return;
    }

    // shim sender stats.
    if (!('getStats' in window.RTCRtpSender.prototype)) {
      var origGetSenders = window.RTCPeerConnection.prototype.getSenders;
      if (origGetSenders) {
        window.RTCPeerConnection.prototype.getSenders = function() {
          var pc = this;
          var senders = origGetSenders.apply(pc, []);
          senders.forEach(function(sender) {
            sender._pc = pc;
          });
          return senders;
        };
      }

      var origAddTrack = window.RTCPeerConnection.prototype.addTrack;
      if (origAddTrack) {
        window.RTCPeerConnection.prototype.addTrack = function() {
          var sender = origAddTrack.apply(this, arguments);
          sender._pc = this;
          return sender;
        };
      }
      window.RTCRtpSender.prototype.getStats = function() {
        var sender = this;
        return this._pc.getStats().then(function(result) {
          /* Note: this will include stats of all senders that
           *   send a track with the same id as sender.track as
           *   it is not possible to identify the RTCRtpSender.
           */
          return filterStats(result, sender.track, true);
        });
      };
    }

    // shim receiver stats.
    if (!('getStats' in window.RTCRtpReceiver.prototype)) {
      var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;
      if (origGetReceivers) {
        window.RTCPeerConnection.prototype.getReceivers = function() {
          var pc = this;
          var receivers = origGetReceivers.apply(pc, []);
          receivers.forEach(function(receiver) {
            receiver._pc = pc;
          });
          return receivers;
        };
      }
      utils.wrapPeerConnectionEvent(window, 'track', function(e) {
        e.receiver._pc = e.srcElement;
        return e;
      });
      window.RTCRtpReceiver.prototype.getStats = function() {
        var receiver = this;
        return this._pc.getStats().then(function(result) {
          return filterStats(result, receiver.track, false);
        });
      };
    }

    if (!('getStats' in window.RTCRtpSender.prototype &&
        'getStats' in window.RTCRtpReceiver.prototype)) {
      return;
    }

    // shim RTCPeerConnection.getStats(track).
    var origGetStats = window.RTCPeerConnection.prototype.getStats;
    window.RTCPeerConnection.prototype.getStats = function() {
      var pc = this;
      if (arguments.length > 0 &&
          arguments[0] instanceof window.MediaStreamTrack) {
        var track = arguments[0];
        var sender;
        var receiver;
        var err;
        pc.getSenders().forEach(function(s) {
          if (s.track === track) {
            if (sender) {
              err = true;
            } else {
              sender = s;
            }
          }
        });
        pc.getReceivers().forEach(function(r) {
          if (r.track === track) {
            if (receiver) {
              err = true;
            } else {
              receiver = r;
            }
          }
          return r.track === track;
        });
        if (err || (sender && receiver)) {
          return Promise.reject(new DOMException(
            'There are more than one sender or receiver for the track.',
            'InvalidAccessError'));
        } else if (sender) {
          return sender.getStats();
        } else if (receiver) {
          return receiver.getStats();
        }
        return Promise.reject(new DOMException(
          'There is no sender or receiver for the track.',
          'InvalidAccessError'));
      }
      return origGetStats.apply(pc, arguments);
    };
  },

  shimSourceObject: function(window) {
    var URL = window && window.URL;

    if (typeof window === 'object') {
      if (window.HTMLMediaElement &&
        !('srcObject' in window.HTMLMediaElement.prototype)) {
        // Shim the srcObject property, once, when HTMLMediaElement is found.
        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {
          get: function() {
            return this._srcObject;
          },
          set: function(stream) {
            var self = this;
            // Use _srcObject as a private property for this shim
            this._srcObject = stream;
            if (this.src) {
              URL.revokeObjectURL(this.src);
            }

            if (!stream) {
              this.src = '';
              return undefined;
            }
            this.src = URL.createObjectURL(stream);
            // We need to recreate the blob url when a track is added or
            // removed. Doing it manually since we want to avoid a recursion.
            stream.addEventListener('addtrack', function() {
              if (self.src) {
                URL.revokeObjectURL(self.src);
              }
              self.src = URL.createObjectURL(stream);
            });
            stream.addEventListener('removetrack', function() {
              if (self.src) {
                URL.revokeObjectURL(self.src);
              }
              self.src = URL.createObjectURL(stream);
            });
          }
        });
      }
    }
  },

  shimAddTrackRemoveTrackWithNative: function(window) {
    // shim addTrack/removeTrack with native variants in order to make
    // the interactions with legacy getLocalStreams behave as in other browsers.
    // Keeps a mapping stream.id => [stream, rtpsenders...]
    window.RTCPeerConnection.prototype.getLocalStreams = function() {
      var pc = this;
      this._shimmedLocalStreams = this._shimmedLocalStreams || {};
      return Object.keys(this._shimmedLocalStreams).map(function(streamId) {
        return pc._shimmedLocalStreams[streamId][0];
      });
    };

    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;
    window.RTCPeerConnection.prototype.addTrack = function(track, stream) {
      if (!stream) {
        return origAddTrack.apply(this, arguments);
      }
      this._shimmedLocalStreams = this._shimmedLocalStreams || {};

      var sender = origAddTrack.apply(this, arguments);
      if (!this._shimmedLocalStreams[stream.id]) {
        this._shimmedLocalStreams[stream.id] = [stream, sender];
      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {
        this._shimmedLocalStreams[stream.id].push(sender);
      }
      return sender;
    };

    var origAddStream = window.RTCPeerConnection.prototype.addStream;
    window.RTCPeerConnection.prototype.addStream = function(stream) {
      var pc = this;
      this._shimmedLocalStreams = this._shimmedLocalStreams || {};

      stream.getTracks().forEach(function(track) {
        var alreadyExists = pc.getSenders().find(function(s) {
          return s.track === track;
        });
        if (alreadyExists) {
          throw new DOMException('Track already exists.',
              'InvalidAccessError');
        }
      });
      var existingSenders = pc.getSenders();
      origAddStream.apply(this, arguments);
      var newSenders = pc.getSenders().filter(function(newSender) {
        return existingSenders.indexOf(newSender) === -1;
      });
      this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);
    };

    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;
    window.RTCPeerConnection.prototype.removeStream = function(stream) {
      this._shimmedLocalStreams = this._shimmedLocalStreams || {};
      delete this._shimmedLocalStreams[stream.id];
      return origRemoveStream.apply(this, arguments);
    };

    var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;
    window.RTCPeerConnection.prototype.removeTrack = function(sender) {
      var pc = this;
      this._shimmedLocalStreams = this._shimmedLocalStreams || {};
      if (sender) {
        Object.keys(this._shimmedLocalStreams).forEach(function(streamId) {
          var idx = pc._shimmedLocalStreams[streamId].indexOf(sender);
          if (idx !== -1) {
            pc._shimmedLocalStreams[streamId].splice(idx, 1);
          }
          if (pc._shimmedLocalStreams[streamId].length === 1) {
            delete pc._shimmedLocalStreams[streamId];
          }
        });
      }
      return origRemoveTrack.apply(this, arguments);
    };
  },

  shimAddTrackRemoveTrack: function(window) {
    if (!window.RTCPeerConnection) {
      return;
    }
    var browserDetails = utils.detectBrowser(window);
    // shim addTrack and removeTrack.
    if (window.RTCPeerConnection.prototype.addTrack &&
        browserDetails.version >= 65) {
      return this.shimAddTrackRemoveTrackWithNative(window);
    }

    // also shim pc.getLocalStreams when addTrack is shimmed
    // to return the original streams.
    var origGetLocalStreams = window.RTCPeerConnection.prototype
        .getLocalStreams;
    window.RTCPeerConnection.prototype.getLocalStreams = function() {
      var pc = this;
      var nativeStreams = origGetLocalStreams.apply(this);
      pc._reverseStreams = pc._reverseStreams || {};
      return nativeStreams.map(function(stream) {
        return pc._reverseStreams[stream.id];
      });
    };

    var origAddStream = window.RTCPeerConnection.prototype.addStream;
    window.RTCPeerConnection.prototype.addStream = function(stream) {
      var pc = this;
      pc._streams = pc._streams || {};
      pc._reverseStreams = pc._reverseStreams || {};

      stream.getTracks().forEach(function(track) {
        var alreadyExists = pc.getSenders().find(function(s) {
          return s.track === track;
        });
        if (alreadyExists) {
          throw new DOMException('Track already exists.',
              'InvalidAccessError');
        }
      });
      // Add identity mapping for consistency with addTrack.
      // Unless this is being used with a stream from addTrack.
      if (!pc._reverseStreams[stream.id]) {
        var newStream = new window.MediaStream(stream.getTracks());
        pc._streams[stream.id] = newStream;
        pc._reverseStreams[newStream.id] = stream;
        stream = newStream;
      }
      origAddStream.apply(pc, [stream]);
    };

    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;
    window.RTCPeerConnection.prototype.removeStream = function(stream) {
      var pc = this;
      pc._streams = pc._streams || {};
      pc._reverseStreams = pc._reverseStreams || {};

      origRemoveStream.apply(pc, [(pc._streams[stream.id] || stream)]);
      delete pc._reverseStreams[(pc._streams[stream.id] ?
          pc._streams[stream.id].id : stream.id)];
      delete pc._streams[stream.id];
    };

    window.RTCPeerConnection.prototype.addTrack = function(track, stream) {
      var pc = this;
      if (pc.signalingState === 'closed') {
        throw new DOMException(
          'The RTCPeerConnection\'s signalingState is \'closed\'.',
          'InvalidStateError');
      }
      var streams = [].slice.call(arguments, 1);
      if (streams.length !== 1 ||
          !streams[0].getTracks().find(function(t) {
            return t === track;
          })) {
        // this is not fully correct but all we can manage without
        // [[associated MediaStreams]] internal slot.
        throw new DOMException(
          'The adapter.js addTrack polyfill only supports a single ' +
          ' stream which is associated with the specified track.',
          'NotSupportedError');
      }

      var alreadyExists = pc.getSenders().find(function(s) {
        return s.track === track;
      });
      if (alreadyExists) {
        throw new DOMException('Track already exists.',
            'InvalidAccessError');
      }

      pc._streams = pc._streams || {};
      pc._reverseStreams = pc._reverseStreams || {};
      var oldStream = pc._streams[stream.id];
      if (oldStream) {
        // this is using odd Chrome behaviour, use with caution:
        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815
        // Note: we rely on the high-level addTrack/dtmf shim to
        // create the sender with a dtmf sender.
        oldStream.addTrack(track);

        // Trigger ONN async.
        Promise.resolve().then(function() {
          pc.dispatchEvent(new Event('negotiationneeded'));
        });
      } else {
        var newStream = new window.MediaStream([track]);
        pc._streams[stream.id] = newStream;
        pc._reverseStreams[newStream.id] = stream;
        pc.addStream(newStream);
      }
      return pc.getSenders().find(function(s) {
        return s.track === track;
      });
    };

    // replace the internal stream id with the external one and
    // vice versa.
    function replaceInternalStreamId(pc, description) {
      var sdp = description.sdp;
      Object.keys(pc._reverseStreams || []).forEach(function(internalId) {
        var externalStream = pc._reverseStreams[internalId];
        var internalStream = pc._streams[externalStream.id];
        sdp = sdp.replace(new RegExp(internalStream.id, 'g'),
            externalStream.id);
      });
      return new RTCSessionDescription({
        type: description.type,
        sdp: sdp
      });
    }
    function replaceExternalStreamId(pc, description) {
      var sdp = description.sdp;
      Object.keys(pc._reverseStreams || []).forEach(function(internalId) {
        var externalStream = pc._reverseStreams[internalId];
        var internalStream = pc._streams[externalStream.id];
        sdp = sdp.replace(new RegExp(externalStream.id, 'g'),
            internalStream.id);
      });
      return new RTCSessionDescription({
        type: description.type,
        sdp: sdp
      });
    }
    ['createOffer', 'createAnswer'].forEach(function(method) {
      var nativeMethod = window.RTCPeerConnection.prototype[method];
      window.RTCPeerConnection.prototype[method] = function() {
        var pc = this;
        var args = arguments;
        var isLegacyCall = arguments.length &&
            typeof arguments[0] === 'function';
        if (isLegacyCall) {
          return nativeMethod.apply(pc, [
            function(description) {
              var desc = replaceInternalStreamId(pc, description);
              args[0].apply(null, [desc]);
            },
            function(err) {
              if (args[1]) {
                args[1].apply(null, err);
              }
            }, arguments[2]
          ]);
        }
        return nativeMethod.apply(pc, arguments)
        .then(function(description) {
          return replaceInternalStreamId(pc, description);
        });
      };
    });

    var origSetLocalDescription =
        window.RTCPeerConnection.prototype.setLocalDescription;
    window.RTCPeerConnection.prototype.setLocalDescription = function() {
      var pc = this;
      if (!arguments.length || !arguments[0].type) {
        return origSetLocalDescription.apply(pc, arguments);
      }
      arguments[0] = replaceExternalStreamId(pc, arguments[0]);
      return origSetLocalDescription.apply(pc, arguments);
    };

    // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier

    var origLocalDescription = Object.getOwnPropertyDescriptor(
        window.RTCPeerConnection.prototype, 'localDescription');
    Object.defineProperty(window.RTCPeerConnection.prototype,
        'localDescription', {
          get: function() {
            var pc = this;
            var description = origLocalDescription.get.apply(this);
            if (description.type === '') {
              return description;
            }
            return replaceInternalStreamId(pc, description);
          }
        });

    window.RTCPeerConnection.prototype.removeTrack = function(sender) {
      var pc = this;
      if (pc.signalingState === 'closed') {
        throw new DOMException(
          'The RTCPeerConnection\'s signalingState is \'closed\'.',
          'InvalidStateError');
      }
      // We can not yet check for sender instanceof RTCRtpSender
      // since we shim RTPSender. So we check if sender._pc is set.
      if (!sender._pc) {
        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +
            'does not implement interface RTCRtpSender.', 'TypeError');
      }
      var isLocal = sender._pc === pc;
      if (!isLocal) {
        throw new DOMException('Sender was not created by this connection.',
            'InvalidAccessError');
      }

      // Search for the native stream the senders track belongs to.
      pc._streams = pc._streams || {};
      var stream;
      Object.keys(pc._streams).forEach(function(streamid) {
        var hasTrack = pc._streams[streamid].getTracks().find(function(track) {
          return sender.track === track;
        });
        if (hasTrack) {
          stream = pc._streams[streamid];
        }
      });

      if (stream) {
        if (stream.getTracks().length === 1) {
          // if this is the last track of the stream, remove the stream. This
          // takes care of any shimmed _senders.
          pc.removeStream(pc._reverseStreams[stream.id]);
        } else {
          // relying on the same odd chrome behaviour as above.
          stream.removeTrack(sender.track);
        }
        pc.dispatchEvent(new Event('negotiationneeded'));
      }
    };
  },

  shimPeerConnection: function(window) {
    var browserDetails = utils.detectBrowser(window);

    // The RTCPeerConnection object.
    if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {
      window.RTCPeerConnection = function(pcConfig, pcConstraints) {
        // Translate iceTransportPolicy to iceTransports,
        // see https://code.google.com/p/webrtc/issues/detail?id=4869
        // this was fixed in M56 along with unprefixing RTCPeerConnection.
        logging('PeerConnection');
        if (pcConfig && pcConfig.iceTransportPolicy) {
          pcConfig.iceTransports = pcConfig.iceTransportPolicy;
        }

        return new window.webkitRTCPeerConnection(pcConfig, pcConstraints);
      };
      window.RTCPeerConnection.prototype =
          window.webkitRTCPeerConnection.prototype;
      // wrap static methods. Currently just generateCertificate.
      if (window.webkitRTCPeerConnection.generateCertificate) {
        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {
          get: function() {
            return window.webkitRTCPeerConnection.generateCertificate;
          }
        });
      }
    }
    if (!window.RTCPeerConnection) {
      return;
    }

    var origGetStats = window.RTCPeerConnection.prototype.getStats;
    window.RTCPeerConnection.prototype.getStats = function(selector,
        successCallback, errorCallback) {
      var pc = this;
      var args = arguments;

      // If selector is a function then we are in the old style stats so just
      // pass back the original getStats format to avoid breaking old users.
      if (arguments.length > 0 && typeof selector === 'function') {
        return origGetStats.apply(this, arguments);
      }

      // When spec-style getStats is supported, return those when called with
      // either no arguments or the selector argument is null.
      if (origGetStats.length === 0 && (arguments.length === 0 ||
          typeof arguments[0] !== 'function')) {
        return origGetStats.apply(this, []);
      }

      var fixChromeStats_ = function(response) {
        var standardReport = {};
        var reports = response.result();
        reports.forEach(function(report) {
          var standardStats = {
            id: report.id,
            timestamp: report.timestamp,
            type: {
              localcandidate: 'local-candidate',
              remotecandidate: 'remote-candidate'
            }[report.type] || report.type
          };
          report.names().forEach(function(name) {
            standardStats[name] = report.stat(name);
          });
          standardReport[standardStats.id] = standardStats;
        });

        return standardReport;
      };

      // shim getStats with maplike support
      var makeMapStats = function(stats) {
        return new Map(Object.keys(stats).map(function(key) {
          return [key, stats[key]];
        }));
      };

      if (arguments.length >= 2) {
        var successCallbackWrapper_ = function(response) {
          args[1](makeMapStats(fixChromeStats_(response)));
        };

        return origGetStats.apply(this, [successCallbackWrapper_,
          arguments[0]]);
      }

      // promise-support
      return new Promise(function(resolve, reject) {
        origGetStats.apply(pc, [
          function(response) {
            resolve(makeMapStats(fixChromeStats_(response)));
          }, reject]);
      }).then(successCallback, errorCallback);
    };

    // add promise support -- natively available in Chrome 51
    if (browserDetails.version < 51) {
      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']
          .forEach(function(method) {
            var nativeMethod = window.RTCPeerConnection.prototype[method];
            window.RTCPeerConnection.prototype[method] = function() {
              var args = arguments;
              var pc = this;
              var promise = new Promise(function(resolve, reject) {
                nativeMethod.apply(pc, [args[0], resolve, reject]);
              });
              if (args.length < 2) {
                return promise;
              }
              return promise.then(function() {
                args[1].apply(null, []);
              },
              function(err) {
                if (args.length >= 3) {
                  args[2].apply(null, [err]);
                }
              });
            };
          });
    }

    // promise support for createOffer and createAnswer. Available (without
    // bugs) since M52: crbug/619289
    if (browserDetails.version < 52) {
      ['createOffer', 'createAnswer'].forEach(function(method) {
        var nativeMethod = window.RTCPeerConnection.prototype[method];
        window.RTCPeerConnection.prototype[method] = function() {
          var pc = this;
          if (arguments.length < 1 || (arguments.length === 1 &&
              typeof arguments[0] === 'object')) {
            var opts = arguments.length === 1 ? arguments[0] : undefined;
            return new Promise(function(resolve, reject) {
              nativeMethod.apply(pc, [resolve, reject, opts]);
            });
          }
          return nativeMethod.apply(this, arguments);
        };
      });
    }

    // shim implicit creation of RTCSessionDescription/RTCIceCandidate
    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']
        .forEach(function(method) {
          var nativeMethod = window.RTCPeerConnection.prototype[method];
          window.RTCPeerConnection.prototype[method] = function() {
            arguments[0] = new ((method === 'addIceCandidate') ?
                window.RTCIceCandidate :
                window.RTCSessionDescription)(arguments[0]);
            return nativeMethod.apply(this, arguments);
          };
        });

    // support for addIceCandidate(null or undefined)
    var nativeAddIceCandidate =
        window.RTCPeerConnection.prototype.addIceCandidate;
    window.RTCPeerConnection.prototype.addIceCandidate = function() {
      if (!arguments[0]) {
        if (arguments[1]) {
          arguments[1].apply(null);
        }
        return Promise.resolve();
      }
      return nativeAddIceCandidate.apply(this, arguments);
    };
  },

  fixNegotiationNeeded: function(window) {
    utils.wrapPeerConnectionEvent(window, 'negotiationneeded', function(e) {
      var pc = e.target;
      if (pc.signalingState !== 'stable') {
        return;
      }
      return e;
    });
  },

  shimGetDisplayMedia: function(window, getSourceId) {
    if (!window.navigator || !window.navigator.mediaDevices ||
        'getDisplayMedia' in window.navigator.mediaDevices) {
      return;
    }
    // getSourceId is a function that returns a promise resolving with
    // the sourceId of the screen/window/tab to be shared.
    if (typeof getSourceId !== 'function') {
      console.error('shimGetDisplayMedia: getSourceId argument is not ' +
          'a function');
      return;
    }
    window.navigator.mediaDevices.getDisplayMedia = function(constraints) {
      return getSourceId(constraints)
        .then(function(sourceId) {
          var widthSpecified = constraints.video && constraints.video.width;
          var heightSpecified = constraints.video && constraints.video.height;
          var frameRateSpecified = constraints.video &&
            constraints.video.frameRate;
          constraints.video = {
            mandatory: {
              chromeMediaSource: 'desktop',
              chromeMediaSourceId: sourceId,
              maxFrameRate: frameRateSpecified || 3
            }
          };
          if (widthSpecified) {
            constraints.video.mandatory.maxWidth = widthSpecified;
          }
          if (heightSpecified) {
            constraints.video.mandatory.maxHeight = heightSpecified;
          }
          return window.navigator.mediaDevices.getUserMedia(constraints);
        });
    };
    window.navigator.getDisplayMedia = function(constraints) {
      utils.deprecated('navigator.getDisplayMedia',
          'navigator.mediaDevices.getDisplayMedia');
      return window.navigator.mediaDevices.getDisplayMedia(constraints);
    };
  }
};

},{"../utils.js":133,"./getusermedia":125}],125:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';
var utils = require('../utils.js');
var logging = utils.log;

// Expose public methods.
module.exports = function(window) {
  var browserDetails = utils.detectBrowser(window);
  var navigator = window && window.navigator;

  var constraintsToChrome_ = function(c) {
    if (typeof c !== 'object' || c.mandatory || c.optional) {
      return c;
    }
    var cc = {};
    Object.keys(c).forEach(function(key) {
      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {
        return;
      }
      var r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};
      if (r.exact !== undefined && typeof r.exact === 'number') {
        r.min = r.max = r.exact;
      }
      var oldname_ = function(prefix, name) {
        if (prefix) {
          return prefix + name.charAt(0).toUpperCase() + name.slice(1);
        }
        return (name === 'deviceId') ? 'sourceId' : name;
      };
      if (r.ideal !== undefined) {
        cc.optional = cc.optional || [];
        var oc = {};
        if (typeof r.ideal === 'number') {
          oc[oldname_('min', key)] = r.ideal;
          cc.optional.push(oc);
          oc = {};
          oc[oldname_('max', key)] = r.ideal;
          cc.optional.push(oc);
        } else {
          oc[oldname_('', key)] = r.ideal;
          cc.optional.push(oc);
        }
      }
      if (r.exact !== undefined && typeof r.exact !== 'number') {
        cc.mandatory = cc.mandatory || {};
        cc.mandatory[oldname_('', key)] = r.exact;
      } else {
        ['min', 'max'].forEach(function(mix) {
          if (r[mix] !== undefined) {
            cc.mandatory = cc.mandatory || {};
            cc.mandatory[oldname_(mix, key)] = r[mix];
          }
        });
      }
    });
    if (c.advanced) {
      cc.optional = (cc.optional || []).concat(c.advanced);
    }
    return cc;
  };

  var shimConstraints_ = function(constraints, func) {
    if (browserDetails.version >= 61) {
      return func(constraints);
    }
    constraints = JSON.parse(JSON.stringify(constraints));
    if (constraints && typeof constraints.audio === 'object') {
      var remap = function(obj, a, b) {
        if (a in obj && !(b in obj)) {
          obj[b] = obj[a];
          delete obj[a];
        }
      };
      constraints = JSON.parse(JSON.stringify(constraints));
      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');
      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');
      constraints.audio = constraintsToChrome_(constraints.audio);
    }
    if (constraints && typeof constraints.video === 'object') {
      // Shim facingMode for mobile & surface pro.
      var face = constraints.video.facingMode;
      face = face && ((typeof face === 'object') ? face : {ideal: face});
      var getSupportedFacingModeLies = browserDetails.version < 66;

      if ((face && (face.exact === 'user' || face.exact === 'environment' ||
                    face.ideal === 'user' || face.ideal === 'environment')) &&
          !(navigator.mediaDevices.getSupportedConstraints &&
            navigator.mediaDevices.getSupportedConstraints().facingMode &&
            !getSupportedFacingModeLies)) {
        delete constraints.video.facingMode;
        var matches;
        if (face.exact === 'environment' || face.ideal === 'environment') {
          matches = ['back', 'rear'];
        } else if (face.exact === 'user' || face.ideal === 'user') {
          matches = ['front'];
        }
        if (matches) {
          // Look for matches in label, or use last cam for back (typical).
          return navigator.mediaDevices.enumerateDevices()
          .then(function(devices) {
            devices = devices.filter(function(d) {
              return d.kind === 'videoinput';
            });
            var dev = devices.find(function(d) {
              return matches.some(function(match) {
                return d.label.toLowerCase().indexOf(match) !== -1;
              });
            });
            if (!dev && devices.length && matches.indexOf('back') !== -1) {
              dev = devices[devices.length - 1]; // more likely the back cam
            }
            if (dev) {
              constraints.video.deviceId = face.exact ? {exact: dev.deviceId} :
                                                        {ideal: dev.deviceId};
            }
            constraints.video = constraintsToChrome_(constraints.video);
            logging('chrome: ' + JSON.stringify(constraints));
            return func(constraints);
          });
        }
      }
      constraints.video = constraintsToChrome_(constraints.video);
    }
    logging('chrome: ' + JSON.stringify(constraints));
    return func(constraints);
  };

  var shimError_ = function(e) {
    if (browserDetails.version >= 64) {
      return e;
    }
    return {
      name: {
        PermissionDeniedError: 'NotAllowedError',
        PermissionDismissedError: 'NotAllowedError',
        InvalidStateError: 'NotAllowedError',
        DevicesNotFoundError: 'NotFoundError',
        ConstraintNotSatisfiedError: 'OverconstrainedError',
        TrackStartError: 'NotReadableError',
        MediaDeviceFailedDueToShutdown: 'NotAllowedError',
        MediaDeviceKillSwitchOn: 'NotAllowedError',
        TabCaptureError: 'AbortError',
        ScreenCaptureError: 'AbortError',
        DeviceCaptureError: 'AbortError'
      }[e.name] || e.name,
      message: e.message,
      constraint: e.constraint || e.constraintName,
      toString: function() {
        return this.name + (this.message && ': ') + this.message;
      }
    };
  };

  var getUserMedia_ = function(constraints, onSuccess, onError) {
    shimConstraints_(constraints, function(c) {
      navigator.webkitGetUserMedia(c, onSuccess, function(e) {
        if (onError) {
          onError(shimError_(e));
        }
      });
    });
  };

  navigator.getUserMedia = getUserMedia_;

  // Returns the result of getUserMedia as a Promise.
  var getUserMediaPromise_ = function(constraints) {
    return new Promise(function(resolve, reject) {
      navigator.getUserMedia(constraints, resolve, reject);
    });
  };

  if (!navigator.mediaDevices) {
    navigator.mediaDevices = {
      getUserMedia: getUserMediaPromise_,
      enumerateDevices: function() {
        return new Promise(function(resolve) {
          var kinds = {audio: 'audioinput', video: 'videoinput'};
          return window.MediaStreamTrack.getSources(function(devices) {
            resolve(devices.map(function(device) {
              return {label: device.label,
                kind: kinds[device.kind],
                deviceId: device.id,
                groupId: ''};
            }));
          });
        });
      },
      getSupportedConstraints: function() {
        return {
          deviceId: true, echoCancellation: true, facingMode: true,
          frameRate: true, height: true, width: true
        };
      }
    };
  }

  // A shim for getUserMedia method on the mediaDevices object.
  // TODO(KaptenJansson) remove once implemented in Chrome stable.
  if (!navigator.mediaDevices.getUserMedia) {
    navigator.mediaDevices.getUserMedia = function(constraints) {
      return getUserMediaPromise_(constraints);
    };
  } else {
    // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia
    // function which returns a Promise, it does not accept spec-style
    // constraints.
    var origGetUserMedia = navigator.mediaDevices.getUserMedia.
        bind(navigator.mediaDevices);
    navigator.mediaDevices.getUserMedia = function(cs) {
      return shimConstraints_(cs, function(c) {
        return origGetUserMedia(c).then(function(stream) {
          if (c.audio && !stream.getAudioTracks().length ||
              c.video && !stream.getVideoTracks().length) {
            stream.getTracks().forEach(function(track) {
              track.stop();
            });
            throw new DOMException('', 'NotFoundError');
          }
          return stream;
        }, function(e) {
          return Promise.reject(shimError_(e));
        });
      });
    };
  }

  // Dummy devicechange event methods.
  // TODO(KaptenJansson) remove once implemented in Chrome stable.
  if (typeof navigator.mediaDevices.addEventListener === 'undefined') {
    navigator.mediaDevices.addEventListener = function() {
      logging('Dummy mediaDevices.addEventListener called.');
    };
  }
  if (typeof navigator.mediaDevices.removeEventListener === 'undefined') {
    navigator.mediaDevices.removeEventListener = function() {
      logging('Dummy mediaDevices.removeEventListener called.');
    };
  }
};

},{"../utils.js":133}],126:[function(require,module,exports){
/*
 *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var SDPUtils = require('sdp');
var utils = require('./utils');

module.exports = {
  shimRTCIceCandidate: function(window) {
    // foundation is arbitrarily chosen as an indicator for full support for
    // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface
    if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in
        window.RTCIceCandidate.prototype)) {
      return;
    }

    var NativeRTCIceCandidate = window.RTCIceCandidate;
    window.RTCIceCandidate = function(args) {
      // Remove the a= which shouldn't be part of the candidate string.
      if (typeof args === 'object' && args.candidate &&
          args.candidate.indexOf('a=') === 0) {
        args = JSON.parse(JSON.stringify(args));
        args.candidate = args.candidate.substr(2);
      }

      if (args.candidate && args.candidate.length) {
        // Augment the native candidate with the parsed fields.
        var nativeCandidate = new NativeRTCIceCandidate(args);
        var parsedCandidate = SDPUtils.parseCandidate(args.candidate);
        var augmentedCandidate = Object.assign(nativeCandidate,
            parsedCandidate);

        // Add a serializer that does not serialize the extra attributes.
        augmentedCandidate.toJSON = function() {
          return {
            candidate: augmentedCandidate.candidate,
            sdpMid: augmentedCandidate.sdpMid,
            sdpMLineIndex: augmentedCandidate.sdpMLineIndex,
            usernameFragment: augmentedCandidate.usernameFragment,
          };
        };
        return augmentedCandidate;
      }
      return new NativeRTCIceCandidate(args);
    };
    window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;

    // Hook up the augmented candidate in onicecandidate and
    // addEventListener('icecandidate', ...)
    utils.wrapPeerConnectionEvent(window, 'icecandidate', function(e) {
      if (e.candidate) {
        Object.defineProperty(e, 'candidate', {
          value: new window.RTCIceCandidate(e.candidate),
          writable: 'false'
        });
      }
      return e;
    });
  },

  // shimCreateObjectURL must be called before shimSourceObject to avoid loop.

  shimCreateObjectURL: function(window) {
    var URL = window && window.URL;

    if (!(typeof window === 'object' && window.HTMLMediaElement &&
          'srcObject' in window.HTMLMediaElement.prototype &&
        URL.createObjectURL && URL.revokeObjectURL)) {
      // Only shim CreateObjectURL using srcObject if srcObject exists.
      return undefined;
    }

    var nativeCreateObjectURL = URL.createObjectURL.bind(URL);
    var nativeRevokeObjectURL = URL.revokeObjectURL.bind(URL);
    var streams = new Map(), newId = 0;

    URL.createObjectURL = function(stream) {
      if ('getTracks' in stream) {
        var url = 'polyblob:' + (++newId);
        streams.set(url, stream);
        utils.deprecated('URL.createObjectURL(stream)',
            'elem.srcObject = stream');
        return url;
      }
      return nativeCreateObjectURL(stream);
    };
    URL.revokeObjectURL = function(url) {
      nativeRevokeObjectURL(url);
      streams.delete(url);
    };

    var dsc = Object.getOwnPropertyDescriptor(window.HTMLMediaElement.prototype,
                                              'src');
    Object.defineProperty(window.HTMLMediaElement.prototype, 'src', {
      get: function() {
        return dsc.get.apply(this);
      },
      set: function(url) {
        this.srcObject = streams.get(url) || null;
        return dsc.set.apply(this, [url]);
      }
    });

    var nativeSetAttribute = window.HTMLMediaElement.prototype.setAttribute;
    window.HTMLMediaElement.prototype.setAttribute = function() {
      if (arguments.length === 2 &&
          ('' + arguments[0]).toLowerCase() === 'src') {
        this.srcObject = streams.get(arguments[1]) || null;
      }
      return nativeSetAttribute.apply(this, arguments);
    };
  },

  shimMaxMessageSize: function(window) {
    if (window.RTCSctpTransport || !window.RTCPeerConnection) {
      return;
    }
    var browserDetails = utils.detectBrowser(window);

    if (!('sctp' in window.RTCPeerConnection.prototype)) {
      Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {
        get: function() {
          return typeof this._sctp === 'undefined' ? null : this._sctp;
        }
      });
    }

    var sctpInDescription = function(description) {
      var sections = SDPUtils.splitSections(description.sdp);
      sections.shift();
      return sections.some(function(mediaSection) {
        var mLine = SDPUtils.parseMLine(mediaSection);
        return mLine && mLine.kind === 'application'
            && mLine.protocol.indexOf('SCTP') !== -1;
      });
    };

    var getRemoteFirefoxVersion = function(description) {
      // TODO: Is there a better solution for detecting Firefox?
      var match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);
      if (match === null || match.length < 2) {
        return -1;
      }
      var version = parseInt(match[1], 10);
      // Test for NaN (yes, this is ugly)
      return version !== version ? -1 : version;
    };

    var getCanSendMaxMessageSize = function(remoteIsFirefox) {
      // Every implementation we know can send at least 64 KiB.
      // Note: Although Chrome is technically able to send up to 256 KiB, the
      //       data does not reach the other peer reliably.
      //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419
      var canSendMaxMessageSize = 65536;
      if (browserDetails.browser === 'firefox') {
        if (browserDetails.version < 57) {
          if (remoteIsFirefox === -1) {
            // FF < 57 will send in 16 KiB chunks using the deprecated PPID
            // fragmentation.
            canSendMaxMessageSize = 16384;
          } else {
            // However, other FF (and RAWRTC) can reassemble PPID-fragmented
            // messages. Thus, supporting ~2 GiB when sending.
            canSendMaxMessageSize = 2147483637;
          }
        } else if (browserDetails.version < 60) {
          // Currently, all FF >= 57 will reset the remote maximum message size
          // to the default value when a data channel is created at a later
          // stage. :(
          // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831
          canSendMaxMessageSize =
            browserDetails.version === 57 ? 65535 : 65536;
        } else {
          // FF >= 60 supports sending ~2 GiB
          canSendMaxMessageSize = 2147483637;
        }
      }
      return canSendMaxMessageSize;
    };

    var getMaxMessageSize = function(description, remoteIsFirefox) {
      // Note: 65536 bytes is the default value from the SDP spec. Also,
      //       every implementation we know supports receiving 65536 bytes.
      var maxMessageSize = 65536;

      // FF 57 has a slightly incorrect default remote max message size, so
      // we need to adjust it here to avoid a failure when sending.
      // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697
      if (browserDetails.browser === 'firefox'
           && browserDetails.version === 57) {
        maxMessageSize = 65535;
      }

      var match = SDPUtils.matchPrefix(description.sdp, 'a=max-message-size:');
      if (match.length > 0) {
        maxMessageSize = parseInt(match[0].substr(19), 10);
      } else if (browserDetails.browser === 'firefox' &&
                  remoteIsFirefox !== -1) {
        // If the maximum message size is not present in the remote SDP and
        // both local and remote are Firefox, the remote peer can receive
        // ~2 GiB.
        maxMessageSize = 2147483637;
      }
      return maxMessageSize;
    };

    var origSetRemoteDescription =
        window.RTCPeerConnection.prototype.setRemoteDescription;
    window.RTCPeerConnection.prototype.setRemoteDescription = function() {
      var pc = this;
      pc._sctp = null;

      if (sctpInDescription(arguments[0])) {
        // Check if the remote is FF.
        var isFirefox = getRemoteFirefoxVersion(arguments[0]);

        // Get the maximum message size the local peer is capable of sending
        var canSendMMS = getCanSendMaxMessageSize(isFirefox);

        // Get the maximum message size of the remote peer.
        var remoteMMS = getMaxMessageSize(arguments[0], isFirefox);

        // Determine final maximum message size
        var maxMessageSize;
        if (canSendMMS === 0 && remoteMMS === 0) {
          maxMessageSize = Number.POSITIVE_INFINITY;
        } else if (canSendMMS === 0 || remoteMMS === 0) {
          maxMessageSize = Math.max(canSendMMS, remoteMMS);
        } else {
          maxMessageSize = Math.min(canSendMMS, remoteMMS);
        }

        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'
        // attribute.
        var sctp = {};
        Object.defineProperty(sctp, 'maxMessageSize', {
          get: function() {
            return maxMessageSize;
          }
        });
        pc._sctp = sctp;
      }

      return origSetRemoteDescription.apply(pc, arguments);
    };
  },

  shimSendThrowTypeError: function(window) {
    if (!(window.RTCPeerConnection &&
        'createDataChannel' in window.RTCPeerConnection.prototype)) {
      return;
    }

    // Note: Although Firefox >= 57 has a native implementation, the maximum
    //       message size can be reset for all data channels at a later stage.
    //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831

    function wrapDcSend(dc, pc) {
      var origDataChannelSend = dc.send;
      dc.send = function() {
        var data = arguments[0];
        var length = data.length || data.size || data.byteLength;
        if (dc.readyState === 'open' &&
            pc.sctp && length > pc.sctp.maxMessageSize) {
          throw new TypeError('Message too large (can send a maximum of ' +
            pc.sctp.maxMessageSize + ' bytes)');
        }
        return origDataChannelSend.apply(dc, arguments);
      };
    }
    var origCreateDataChannel =
      window.RTCPeerConnection.prototype.createDataChannel;
    window.RTCPeerConnection.prototype.createDataChannel = function() {
      var pc = this;
      var dataChannel = origCreateDataChannel.apply(pc, arguments);
      wrapDcSend(dataChannel, pc);
      return dataChannel;
    };
    utils.wrapPeerConnectionEvent(window, 'datachannel', function(e) {
      wrapDcSend(e.channel, e.target);
      return e;
    });
  }
};

},{"./utils":133,"sdp":118}],127:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var utils = require('../utils');
var filterIceServers = require('./filtericeservers');
var shimRTCPeerConnection = require('rtcpeerconnection-shim');

module.exports = {
  shimGetUserMedia: require('./getusermedia'),
  shimPeerConnection: function(window) {
    var browserDetails = utils.detectBrowser(window);

    if (window.RTCIceGatherer) {
      if (!window.RTCIceCandidate) {
        window.RTCIceCandidate = function(args) {
          return args;
        };
      }
      if (!window.RTCSessionDescription) {
        window.RTCSessionDescription = function(args) {
          return args;
        };
      }
      // this adds an additional event listener to MediaStrackTrack that signals
      // when a tracks enabled property was changed. Workaround for a bug in
      // addStream, see below. No longer required in 15025+
      if (browserDetails.version < 15025) {
        var origMSTEnabled = Object.getOwnPropertyDescriptor(
            window.MediaStreamTrack.prototype, 'enabled');
        Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {
          set: function(value) {
            origMSTEnabled.set.call(this, value);
            var ev = new Event('enabled');
            ev.enabled = value;
            this.dispatchEvent(ev);
          }
        });
      }
    }

    // ORTC defines the DTMF sender a bit different.
    // https://github.com/w3c/ortc/issues/714
    if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {
      Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {
        get: function() {
          if (this._dtmf === undefined) {
            if (this.track.kind === 'audio') {
              this._dtmf = new window.RTCDtmfSender(this);
            } else if (this.track.kind === 'video') {
              this._dtmf = null;
            }
          }
          return this._dtmf;
        }
      });
    }
    // Edge currently only implements the RTCDtmfSender, not the
    // RTCDTMFSender alias. See http://draft.ortc.org/#rtcdtmfsender2*
    if (window.RTCDtmfSender && !window.RTCDTMFSender) {
      window.RTCDTMFSender = window.RTCDtmfSender;
    }

    var RTCPeerConnectionShim = shimRTCPeerConnection(window,
        browserDetails.version);
    window.RTCPeerConnection = function(config) {
      if (config && config.iceServers) {
        config.iceServers = filterIceServers(config.iceServers);
      }
      return new RTCPeerConnectionShim(config);
    };
    window.RTCPeerConnection.prototype = RTCPeerConnectionShim.prototype;
  },
  shimReplaceTrack: function(window) {
    // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614
    if (window.RTCRtpSender &&
        !('replaceTrack' in window.RTCRtpSender.prototype)) {
      window.RTCRtpSender.prototype.replaceTrack =
          window.RTCRtpSender.prototype.setTrack;
    }
  },
  shimGetDisplayMedia: function(window, preferredMediaSource) {
    if (!('getDisplayMedia' in window.navigator) ||
        !window.navigator.mediaDevices ||
        'getDisplayMedia' in window.navigator.mediaDevices) {
      return;
    }
    var origGetDisplayMedia = window.navigator.getDisplayMedia;
    window.navigator.mediaDevices.getDisplayMedia = function(constraints) {
      return origGetDisplayMedia.call(window.navigator, constraints);
    };
    window.navigator.getDisplayMedia = function(constraints) {
      utils.deprecated('navigator.getDisplayMedia',
          'navigator.mediaDevices.getDisplayMedia');
      return origGetDisplayMedia.call(window.navigator, constraints);
    };
  }
};

},{"../utils":133,"./filtericeservers":128,"./getusermedia":129,"rtcpeerconnection-shim":117}],128:[function(require,module,exports){
/*
 *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var utils = require('../utils');
// Edge does not like
// 1) stun: filtered after 14393 unless ?transport=udp is present
// 2) turn: that does not have all of turn:host:port?transport=udp
// 3) turn: with ipv6 addresses
// 4) turn: occurring muliple times
module.exports = function(iceServers, edgeVersion) {
  var hasTurn = false;
  iceServers = JSON.parse(JSON.stringify(iceServers));
  return iceServers.filter(function(server) {
    if (server && (server.urls || server.url)) {
      var urls = server.urls || server.url;
      if (server.url && !server.urls) {
        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');
      }
      var isString = typeof urls === 'string';
      if (isString) {
        urls = [urls];
      }
      urls = urls.filter(function(url) {
        var validTurn = url.indexOf('turn:') === 0 &&
            url.indexOf('transport=udp') !== -1 &&
            url.indexOf('turn:[') === -1 &&
            !hasTurn;

        if (validTurn) {
          hasTurn = true;
          return true;
        }
        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&
            url.indexOf('?transport=udp') === -1;
      });

      delete server.url;
      server.urls = isString ? urls[0] : urls;
      return !!urls.length;
    }
  });
};

},{"../utils":133}],129:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

// Expose public methods.
module.exports = function(window) {
  var navigator = window && window.navigator;

  var shimError_ = function(e) {
    return {
      name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,
      message: e.message,
      constraint: e.constraint,
      toString: function() {
        return this.name;
      }
    };
  };

  // getUserMedia error shim.
  var origGetUserMedia = navigator.mediaDevices.getUserMedia.
      bind(navigator.mediaDevices);
  navigator.mediaDevices.getUserMedia = function(c) {
    return origGetUserMedia(c).catch(function(e) {
      return Promise.reject(shimError_(e));
    });
  };
};

},{}],130:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var utils = require('../utils');

module.exports = {
  shimGetUserMedia: require('./getusermedia'),
  shimOnTrack: function(window) {
    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in
        window.RTCPeerConnection.prototype)) {
      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {
        get: function() {
          return this._ontrack;
        },
        set: function(f) {
          if (this._ontrack) {
            this.removeEventListener('track', this._ontrack);
            this.removeEventListener('addstream', this._ontrackpoly);
          }
          this.addEventListener('track', this._ontrack = f);
          this.addEventListener('addstream', this._ontrackpoly = function(e) {
            e.stream.getTracks().forEach(function(track) {
              var event = new Event('track');
              event.track = track;
              event.receiver = {track: track};
              event.transceiver = {receiver: event.receiver};
              event.streams = [e.stream];
              this.dispatchEvent(event);
            }.bind(this));
          }.bind(this));
        },
        enumerable: true,
        configurable: true
      });
    }
    if (typeof window === 'object' && window.RTCTrackEvent &&
        ('receiver' in window.RTCTrackEvent.prototype) &&
        !('transceiver' in window.RTCTrackEvent.prototype)) {
      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {
        get: function() {
          return {receiver: this.receiver};
        }
      });
    }
  },

  shimSourceObject: function(window) {
    // Firefox has supported mozSrcObject since FF22, unprefixed in 42.
    if (typeof window === 'object') {
      if (window.HTMLMediaElement &&
        !('srcObject' in window.HTMLMediaElement.prototype)) {
        // Shim the srcObject property, once, when HTMLMediaElement is found.
        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {
          get: function() {
            return this.mozSrcObject;
          },
          set: function(stream) {
            this.mozSrcObject = stream;
          }
        });
      }
    }
  },

  shimPeerConnection: function(window) {
    var browserDetails = utils.detectBrowser(window);

    if (typeof window !== 'object' || !(window.RTCPeerConnection ||
        window.mozRTCPeerConnection)) {
      return; // probably media.peerconnection.enabled=false in about:config
    }
    // The RTCPeerConnection object.
    if (!window.RTCPeerConnection) {
      window.RTCPeerConnection = function(pcConfig, pcConstraints) {
        if (browserDetails.version < 38) {
          // .urls is not supported in FF < 38.
          // create RTCIceServers with a single url.
          if (pcConfig && pcConfig.iceServers) {
            var newIceServers = [];
            for (var i = 0; i < pcConfig.iceServers.length; i++) {
              var server = pcConfig.iceServers[i];
              if (server.hasOwnProperty('urls')) {
                for (var j = 0; j < server.urls.length; j++) {
                  var newServer = {
                    url: server.urls[j]
                  };
                  if (server.urls[j].indexOf('turn') === 0) {
                    newServer.username = server.username;
                    newServer.credential = server.credential;
                  }
                  newIceServers.push(newServer);
                }
              } else {
                newIceServers.push(pcConfig.iceServers[i]);
              }
            }
            pcConfig.iceServers = newIceServers;
          }
        }
        return new window.mozRTCPeerConnection(pcConfig, pcConstraints);
      };
      window.RTCPeerConnection.prototype =
          window.mozRTCPeerConnection.prototype;

      // wrap static methods. Currently just generateCertificate.
      if (window.mozRTCPeerConnection.generateCertificate) {
        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {
          get: function() {
            return window.mozRTCPeerConnection.generateCertificate;
          }
        });
      }

      window.RTCSessionDescription = window.mozRTCSessionDescription;
      window.RTCIceCandidate = window.mozRTCIceCandidate;
    }

    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.
    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']
        .forEach(function(method) {
          var nativeMethod = window.RTCPeerConnection.prototype[method];
          window.RTCPeerConnection.prototype[method] = function() {
            arguments[0] = new ((method === 'addIceCandidate') ?
                window.RTCIceCandidate :
                window.RTCSessionDescription)(arguments[0]);
            return nativeMethod.apply(this, arguments);
          };
        });

    // support for addIceCandidate(null or undefined)
    var nativeAddIceCandidate =
        window.RTCPeerConnection.prototype.addIceCandidate;
    window.RTCPeerConnection.prototype.addIceCandidate = function() {
      if (!arguments[0]) {
        if (arguments[1]) {
          arguments[1].apply(null);
        }
        return Promise.resolve();
      }
      return nativeAddIceCandidate.apply(this, arguments);
    };

    // shim getStats with maplike support
    var makeMapStats = function(stats) {
      var map = new Map();
      Object.keys(stats).forEach(function(key) {
        map.set(key, stats[key]);
        map[key] = stats[key];
      });
      return map;
    };

    var modernStatsTypes = {
      inboundrtp: 'inbound-rtp',
      outboundrtp: 'outbound-rtp',
      candidatepair: 'candidate-pair',
      localcandidate: 'local-candidate',
      remotecandidate: 'remote-candidate'
    };

    var nativeGetStats = window.RTCPeerConnection.prototype.getStats;
    window.RTCPeerConnection.prototype.getStats = function(
      selector,
      onSucc,
      onErr
    ) {
      return nativeGetStats.apply(this, [selector || null])
        .then(function(stats) {
          if (browserDetails.version < 48) {
            stats = makeMapStats(stats);
          }
          if (browserDetails.version < 53 && !onSucc) {
            // Shim only promise getStats with spec-hyphens in type names
            // Leave callback version alone; misc old uses of forEach before Map
            try {
              stats.forEach(function(stat) {
                stat.type = modernStatsTypes[stat.type] || stat.type;
              });
            } catch (e) {
              if (e.name !== 'TypeError') {
                throw e;
              }
              // Avoid TypeError: "type" is read-only, in old versions. 34-43ish
              stats.forEach(function(stat, i) {
                stats.set(i, Object.assign({}, stat, {
                  type: modernStatsTypes[stat.type] || stat.type
                }));
              });
            }
          }
          return stats;
        })
        .then(onSucc, onErr);
    };
  },

  shimSenderGetStats: function(window) {
    if (!(typeof window === 'object' && window.RTCPeerConnection &&
        window.RTCRtpSender)) {
      return;
    }
    if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {
      return;
    }
    var origGetSenders = window.RTCPeerConnection.prototype.getSenders;
    if (origGetSenders) {
      window.RTCPeerConnection.prototype.getSenders = function() {
        var pc = this;
        var senders = origGetSenders.apply(pc, []);
        senders.forEach(function(sender) {
          sender._pc = pc;
        });
        return senders;
      };
    }

    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;
    if (origAddTrack) {
      window.RTCPeerConnection.prototype.addTrack = function() {
        var sender = origAddTrack.apply(this, arguments);
        sender._pc = this;
        return sender;
      };
    }
    window.RTCRtpSender.prototype.getStats = function() {
      return this.track ? this._pc.getStats(this.track) :
          Promise.resolve(new Map());
    };
  },

  shimReceiverGetStats: function(window) {
    if (!(typeof window === 'object' && window.RTCPeerConnection &&
        window.RTCRtpSender)) {
      return;
    }
    if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {
      return;
    }
    var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;
    if (origGetReceivers) {
      window.RTCPeerConnection.prototype.getReceivers = function() {
        var pc = this;
        var receivers = origGetReceivers.apply(pc, []);
        receivers.forEach(function(receiver) {
          receiver._pc = pc;
        });
        return receivers;
      };
    }
    utils.wrapPeerConnectionEvent(window, 'track', function(e) {
      e.receiver._pc = e.srcElement;
      return e;
    });
    window.RTCRtpReceiver.prototype.getStats = function() {
      return this._pc.getStats(this.track);
    };
  },

  shimRemoveStream: function(window) {
    if (!window.RTCPeerConnection ||
        'removeStream' in window.RTCPeerConnection.prototype) {
      return;
    }
    window.RTCPeerConnection.prototype.removeStream = function(stream) {
      var pc = this;
      utils.deprecated('removeStream', 'removeTrack');
      this.getSenders().forEach(function(sender) {
        if (sender.track && stream.getTracks().indexOf(sender.track) !== -1) {
          pc.removeTrack(sender);
        }
      });
    };
  },

  shimRTCDataChannel: function(window) {
    // rename DataChannel to RTCDataChannel (native fix in FF60):
    // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851
    if (window.DataChannel && !window.RTCDataChannel) {
      window.RTCDataChannel = window.DataChannel;
    }
  },

  shimGetDisplayMedia: function(window, preferredMediaSource) {
    if (!window.navigator || !window.navigator.mediaDevices ||
        'getDisplayMedia' in window.navigator.mediaDevices) {
      return;
    }
    window.navigator.mediaDevices.getDisplayMedia = function(constraints) {
      if (!(constraints && constraints.video)) {
        var err = new DOMException('getDisplayMedia without video ' +
            'constraints is undefined');
        err.name = 'NotFoundError';
        // from https://heycam.github.io/webidl/#idl-DOMException-error-names
        err.code = 8;
        return Promise.reject(err);
      }
      if (constraints.video === true) {
        constraints.video = {mediaSource: preferredMediaSource};
      } else {
        constraints.video.mediaSource = preferredMediaSource;
      }
      return window.navigator.mediaDevices.getUserMedia(constraints);
    };
    window.navigator.getDisplayMedia = function(constraints) {
      utils.deprecated('navigator.getDisplayMedia',
          'navigator.mediaDevices.getDisplayMedia');
      return window.navigator.mediaDevices.getDisplayMedia(constraints);
    };
  }
};

},{"../utils":133,"./getusermedia":131}],131:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var utils = require('../utils');
var logging = utils.log;

// Expose public methods.
module.exports = function(window) {
  var browserDetails = utils.detectBrowser(window);
  var navigator = window && window.navigator;
  var MediaStreamTrack = window && window.MediaStreamTrack;

  var shimError_ = function(e) {
    return {
      name: {
        InternalError: 'NotReadableError',
        NotSupportedError: 'TypeError',
        PermissionDeniedError: 'NotAllowedError',
        SecurityError: 'NotAllowedError'
      }[e.name] || e.name,
      message: {
        'The operation is insecure.': 'The request is not allowed by the ' +
        'user agent or the platform in the current context.'
      }[e.message] || e.message,
      constraint: e.constraint,
      toString: function() {
        return this.name + (this.message && ': ') + this.message;
      }
    };
  };

  // getUserMedia constraints shim.
  var getUserMedia_ = function(constraints, onSuccess, onError) {
    var constraintsToFF37_ = function(c) {
      if (typeof c !== 'object' || c.require) {
        return c;
      }
      var require = [];
      Object.keys(c).forEach(function(key) {
        if (key === 'require' || key === 'advanced' || key === 'mediaSource') {
          return;
        }
        var r = c[key] = (typeof c[key] === 'object') ?
            c[key] : {ideal: c[key]};
        if (r.min !== undefined ||
            r.max !== undefined || r.exact !== undefined) {
          require.push(key);
        }
        if (r.exact !== undefined) {
          if (typeof r.exact === 'number') {
            r. min = r.max = r.exact;
          } else {
            c[key] = r.exact;
          }
          delete r.exact;
        }
        if (r.ideal !== undefined) {
          c.advanced = c.advanced || [];
          var oc = {};
          if (typeof r.ideal === 'number') {
            oc[key] = {min: r.ideal, max: r.ideal};
          } else {
            oc[key] = r.ideal;
          }
          c.advanced.push(oc);
          delete r.ideal;
          if (!Object.keys(r).length) {
            delete c[key];
          }
        }
      });
      if (require.length) {
        c.require = require;
      }
      return c;
    };
    constraints = JSON.parse(JSON.stringify(constraints));
    if (browserDetails.version < 38) {
      logging('spec: ' + JSON.stringify(constraints));
      if (constraints.audio) {
        constraints.audio = constraintsToFF37_(constraints.audio);
      }
      if (constraints.video) {
        constraints.video = constraintsToFF37_(constraints.video);
      }
      logging('ff37: ' + JSON.stringify(constraints));
    }
    return navigator.mozGetUserMedia(constraints, onSuccess, function(e) {
      onError(shimError_(e));
    });
  };

  // Returns the result of getUserMedia as a Promise.
  var getUserMediaPromise_ = function(constraints) {
    return new Promise(function(resolve, reject) {
      getUserMedia_(constraints, resolve, reject);
    });
  };

  // Shim for mediaDevices on older versions.
  if (!navigator.mediaDevices) {
    navigator.mediaDevices = {getUserMedia: getUserMediaPromise_,
      addEventListener: function() { },
      removeEventListener: function() { }
    };
  }
  navigator.mediaDevices.enumerateDevices =
      navigator.mediaDevices.enumerateDevices || function() {
        return new Promise(function(resolve) {
          var infos = [
            {kind: 'audioinput', deviceId: 'default', label: '', groupId: ''},
            {kind: 'videoinput', deviceId: 'default', label: '', groupId: ''}
          ];
          resolve(infos);
        });
      };

  if (browserDetails.version < 41) {
    // Work around http://bugzil.la/1169665
    var orgEnumerateDevices =
        navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);
    navigator.mediaDevices.enumerateDevices = function() {
      return orgEnumerateDevices().then(undefined, function(e) {
        if (e.name === 'NotFoundError') {
          return [];
        }
        throw e;
      });
    };
  }
  if (browserDetails.version < 49) {
    var origGetUserMedia = navigator.mediaDevices.getUserMedia.
        bind(navigator.mediaDevices);
    navigator.mediaDevices.getUserMedia = function(c) {
      return origGetUserMedia(c).then(function(stream) {
        // Work around https://bugzil.la/802326
        if (c.audio && !stream.getAudioTracks().length ||
            c.video && !stream.getVideoTracks().length) {
          stream.getTracks().forEach(function(track) {
            track.stop();
          });
          throw new DOMException('The object can not be found here.',
                                 'NotFoundError');
        }
        return stream;
      }, function(e) {
        return Promise.reject(shimError_(e));
      });
    };
  }
  if (!(browserDetails.version > 55 &&
      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {
    var remap = function(obj, a, b) {
      if (a in obj && !(b in obj)) {
        obj[b] = obj[a];
        delete obj[a];
      }
    };

    var nativeGetUserMedia = navigator.mediaDevices.getUserMedia.
        bind(navigator.mediaDevices);
    navigator.mediaDevices.getUserMedia = function(c) {
      if (typeof c === 'object' && typeof c.audio === 'object') {
        c = JSON.parse(JSON.stringify(c));
        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');
        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');
      }
      return nativeGetUserMedia(c);
    };

    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {
      var nativeGetSettings = MediaStreamTrack.prototype.getSettings;
      MediaStreamTrack.prototype.getSettings = function() {
        var obj = nativeGetSettings.apply(this, arguments);
        remap(obj, 'mozAutoGainControl', 'autoGainControl');
        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');
        return obj;
      };
    }

    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {
      var nativeApplyConstraints = MediaStreamTrack.prototype.applyConstraints;
      MediaStreamTrack.prototype.applyConstraints = function(c) {
        if (this.kind === 'audio' && typeof c === 'object') {
          c = JSON.parse(JSON.stringify(c));
          remap(c, 'autoGainControl', 'mozAutoGainControl');
          remap(c, 'noiseSuppression', 'mozNoiseSuppression');
        }
        return nativeApplyConstraints.apply(this, [c]);
      };
    }
  }
  navigator.getUserMedia = function(constraints, onSuccess, onError) {
    if (browserDetails.version < 44) {
      return getUserMedia_(constraints, onSuccess, onError);
    }
    // Replace Firefox 44+'s deprecation warning with unprefixed version.
    utils.deprecated('navigator.getUserMedia',
        'navigator.mediaDevices.getUserMedia');
    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);
  };
};

},{"../utils":133}],132:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
'use strict';
var utils = require('../utils');

module.exports = {
  shimLocalStreamsAPI: function(window) {
    if (typeof window !== 'object' || !window.RTCPeerConnection) {
      return;
    }
    if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {
      window.RTCPeerConnection.prototype.getLocalStreams = function() {
        if (!this._localStreams) {
          this._localStreams = [];
        }
        return this._localStreams;
      };
    }
    if (!('getStreamById' in window.RTCPeerConnection.prototype)) {
      window.RTCPeerConnection.prototype.getStreamById = function(id) {
        var result = null;
        if (this._localStreams) {
          this._localStreams.forEach(function(stream) {
            if (stream.id === id) {
              result = stream;
            }
          });
        }
        if (this._remoteStreams) {
          this._remoteStreams.forEach(function(stream) {
            if (stream.id === id) {
              result = stream;
            }
          });
        }
        return result;
      };
    }
    if (!('addStream' in window.RTCPeerConnection.prototype)) {
      var _addTrack = window.RTCPeerConnection.prototype.addTrack;
      window.RTCPeerConnection.prototype.addStream = function(stream) {
        if (!this._localStreams) {
          this._localStreams = [];
        }
        if (this._localStreams.indexOf(stream) === -1) {
          this._localStreams.push(stream);
        }
        var pc = this;
        stream.getTracks().forEach(function(track) {
          _addTrack.call(pc, track, stream);
        });
      };

      window.RTCPeerConnection.prototype.addTrack = function(track, stream) {
        if (stream) {
          if (!this._localStreams) {
            this._localStreams = [stream];
          } else if (this._localStreams.indexOf(stream) === -1) {
            this._localStreams.push(stream);
          }
        }
        return _addTrack.call(this, track, stream);
      };
    }
    if (!('removeStream' in window.RTCPeerConnection.prototype)) {
      window.RTCPeerConnection.prototype.removeStream = function(stream) {
        if (!this._localStreams) {
          this._localStreams = [];
        }
        var index = this._localStreams.indexOf(stream);
        if (index === -1) {
          return;
        }
        this._localStreams.splice(index, 1);
        var pc = this;
        var tracks = stream.getTracks();
        this.getSenders().forEach(function(sender) {
          if (tracks.indexOf(sender.track) !== -1) {
            pc.removeTrack(sender);
          }
        });
      };
    }
  },
  shimRemoteStreamsAPI: function(window) {
    if (typeof window !== 'object' || !window.RTCPeerConnection) {
      return;
    }
    if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {
      window.RTCPeerConnection.prototype.getRemoteStreams = function() {
        return this._remoteStreams ? this._remoteStreams : [];
      };
    }
    if (!('onaddstream' in window.RTCPeerConnection.prototype)) {
      Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {
        get: function() {
          return this._onaddstream;
        },
        set: function(f) {
          if (this._onaddstream) {
            this.removeEventListener('addstream', this._onaddstream);
          }
          this.addEventListener('addstream', this._onaddstream = f);
        }
      });
      var origSetRemoteDescription =
          window.RTCPeerConnection.prototype.setRemoteDescription;
      window.RTCPeerConnection.prototype.setRemoteDescription = function() {
        var pc = this;
        if (!this._onaddstreampoly) {
          this.addEventListener('track', this._onaddstreampoly = function(e) {
            e.streams.forEach(function(stream) {
              if (!pc._remoteStreams) {
                pc._remoteStreams = [];
              }
              if (pc._remoteStreams.indexOf(stream) >= 0) {
                return;
              }
              pc._remoteStreams.push(stream);
              var event = new Event('addstream');
              event.stream = stream;
              pc.dispatchEvent(event);
            });
          });
        }
        return origSetRemoteDescription.apply(pc, arguments);
      };
    }
  },
  shimCallbacksAPI: function(window) {
    if (typeof window !== 'object' || !window.RTCPeerConnection) {
      return;
    }
    var prototype = window.RTCPeerConnection.prototype;
    var createOffer = prototype.createOffer;
    var createAnswer = prototype.createAnswer;
    var setLocalDescription = prototype.setLocalDescription;
    var setRemoteDescription = prototype.setRemoteDescription;
    var addIceCandidate = prototype.addIceCandidate;

    prototype.createOffer = function(successCallback, failureCallback) {
      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];
      var promise = createOffer.apply(this, [options]);
      if (!failureCallback) {
        return promise;
      }
      promise.then(successCallback, failureCallback);
      return Promise.resolve();
    };

    prototype.createAnswer = function(successCallback, failureCallback) {
      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];
      var promise = createAnswer.apply(this, [options]);
      if (!failureCallback) {
        return promise;
      }
      promise.then(successCallback, failureCallback);
      return Promise.resolve();
    };

    var withCallback = function(description, successCallback, failureCallback) {
      var promise = setLocalDescription.apply(this, [description]);
      if (!failureCallback) {
        return promise;
      }
      promise.then(successCallback, failureCallback);
      return Promise.resolve();
    };
    prototype.setLocalDescription = withCallback;

    withCallback = function(description, successCallback, failureCallback) {
      var promise = setRemoteDescription.apply(this, [description]);
      if (!failureCallback) {
        return promise;
      }
      promise.then(successCallback, failureCallback);
      return Promise.resolve();
    };
    prototype.setRemoteDescription = withCallback;

    withCallback = function(candidate, successCallback, failureCallback) {
      var promise = addIceCandidate.apply(this, [candidate]);
      if (!failureCallback) {
        return promise;
      }
      promise.then(successCallback, failureCallback);
      return Promise.resolve();
    };
    prototype.addIceCandidate = withCallback;
  },
  shimGetUserMedia: function(window) {
    var navigator = window && window.navigator;

    if (!navigator.getUserMedia) {
      if (navigator.webkitGetUserMedia) {
        navigator.getUserMedia = navigator.webkitGetUserMedia.bind(navigator);
      } else if (navigator.mediaDevices &&
          navigator.mediaDevices.getUserMedia) {
        navigator.getUserMedia = function(constraints, cb, errcb) {
          navigator.mediaDevices.getUserMedia(constraints)
          .then(cb, errcb);
        }.bind(navigator);
      }
    }
  },
  shimRTCIceServerUrls: function(window) {
    // migrate from non-spec RTCIceServer.url to RTCIceServer.urls
    var OrigPeerConnection = window.RTCPeerConnection;
    window.RTCPeerConnection = function(pcConfig, pcConstraints) {
      if (pcConfig && pcConfig.iceServers) {
        var newIceServers = [];
        for (var i = 0; i < pcConfig.iceServers.length; i++) {
          var server = pcConfig.iceServers[i];
          if (!server.hasOwnProperty('urls') &&
              server.hasOwnProperty('url')) {
            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');
            server = JSON.parse(JSON.stringify(server));
            server.urls = server.url;
            delete server.url;
            newIceServers.push(server);
          } else {
            newIceServers.push(pcConfig.iceServers[i]);
          }
        }
        pcConfig.iceServers = newIceServers;
      }
      return new OrigPeerConnection(pcConfig, pcConstraints);
    };
    window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;
    // wrap static methods. Currently just generateCertificate.
    if ('generateCertificate' in window.RTCPeerConnection) {
      Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {
        get: function() {
          return OrigPeerConnection.generateCertificate;
        }
      });
    }
  },
  shimTrackEventTransceiver: function(window) {
    // Add event.transceiver member over deprecated event.receiver
    if (typeof window === 'object' && window.RTCPeerConnection &&
        ('receiver' in window.RTCTrackEvent.prototype) &&
        // can't check 'transceiver' in window.RTCTrackEvent.prototype, as it is
        // defined for some reason even when window.RTCTransceiver is not.
        !window.RTCTransceiver) {
      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {
        get: function() {
          return {receiver: this.receiver};
        }
      });
    }
  },

  shimCreateOfferLegacy: function(window) {
    var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;
    window.RTCPeerConnection.prototype.createOffer = function(offerOptions) {
      var pc = this;
      if (offerOptions) {
        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {
          // support bit values
          offerOptions.offerToReceiveAudio = !!offerOptions.offerToReceiveAudio;
        }
        var audioTransceiver = pc.getTransceivers().find(function(transceiver) {
          return transceiver.sender.track &&
              transceiver.sender.track.kind === 'audio';
        });
        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {
          if (audioTransceiver.direction === 'sendrecv') {
            if (audioTransceiver.setDirection) {
              audioTransceiver.setDirection('sendonly');
            } else {
              audioTransceiver.direction = 'sendonly';
            }
          } else if (audioTransceiver.direction === 'recvonly') {
            if (audioTransceiver.setDirection) {
              audioTransceiver.setDirection('inactive');
            } else {
              audioTransceiver.direction = 'inactive';
            }
          }
        } else if (offerOptions.offerToReceiveAudio === true &&
            !audioTransceiver) {
          pc.addTransceiver('audio');
        }


        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {
          // support bit values
          offerOptions.offerToReceiveVideo = !!offerOptions.offerToReceiveVideo;
        }
        var videoTransceiver = pc.getTransceivers().find(function(transceiver) {
          return transceiver.sender.track &&
              transceiver.sender.track.kind === 'video';
        });
        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {
          if (videoTransceiver.direction === 'sendrecv') {
            videoTransceiver.setDirection('sendonly');
          } else if (videoTransceiver.direction === 'recvonly') {
            videoTransceiver.setDirection('inactive');
          }
        } else if (offerOptions.offerToReceiveVideo === true &&
            !videoTransceiver) {
          pc.addTransceiver('video');
        }
      }
      return origCreateOffer.apply(pc, arguments);
    };
  }
};

},{"../utils":133}],133:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var logDisabled_ = true;
var deprecationWarnings_ = true;

/**
 * Extract browser version out of the provided user agent string.
 *
 * @param {!string} uastring userAgent string.
 * @param {!string} expr Regular expression used as match criteria.
 * @param {!number} pos position in the version string to be returned.
 * @return {!number} browser version.
 */
function extractVersion(uastring, expr, pos) {
  var match = uastring.match(expr);
  return match && match.length >= pos && parseInt(match[pos], 10);
}

// Wraps the peerconnection event eventNameToWrap in a function
// which returns the modified event object (or false to prevent
// the event).
function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {
  if (!window.RTCPeerConnection) {
    return;
  }
  var proto = window.RTCPeerConnection.prototype;
  var nativeAddEventListener = proto.addEventListener;
  proto.addEventListener = function(nativeEventName, cb) {
    if (nativeEventName !== eventNameToWrap) {
      return nativeAddEventListener.apply(this, arguments);
    }
    var wrappedCallback = function(e) {
      var modifiedEvent = wrapper(e);
      if (modifiedEvent) {
        cb(modifiedEvent);
      }
    };
    this._eventMap = this._eventMap || {};
    this._eventMap[cb] = wrappedCallback;
    return nativeAddEventListener.apply(this, [nativeEventName,
      wrappedCallback]);
  };

  var nativeRemoveEventListener = proto.removeEventListener;
  proto.removeEventListener = function(nativeEventName, cb) {
    if (nativeEventName !== eventNameToWrap || !this._eventMap
        || !this._eventMap[cb]) {
      return nativeRemoveEventListener.apply(this, arguments);
    }
    var unwrappedCb = this._eventMap[cb];
    delete this._eventMap[cb];
    return nativeRemoveEventListener.apply(this, [nativeEventName,
      unwrappedCb]);
  };

  Object.defineProperty(proto, 'on' + eventNameToWrap, {
    get: function() {
      return this['_on' + eventNameToWrap];
    },
    set: function(cb) {
      if (this['_on' + eventNameToWrap]) {
        this.removeEventListener(eventNameToWrap,
            this['_on' + eventNameToWrap]);
        delete this['_on' + eventNameToWrap];
      }
      if (cb) {
        this.addEventListener(eventNameToWrap,
            this['_on' + eventNameToWrap] = cb);
      }
    },
    enumerable: true,
    configurable: true
  });
}

// Utility methods.
module.exports = {
  extractVersion: extractVersion,
  wrapPeerConnectionEvent: wrapPeerConnectionEvent,
  disableLog: function(bool) {
    if (typeof bool !== 'boolean') {
      return new Error('Argument type: ' + typeof bool +
          '. Please use a boolean.');
    }
    logDisabled_ = bool;
    return (bool) ? 'adapter.js logging disabled' :
        'adapter.js logging enabled';
  },

  /**
   * Disable or enable deprecation warnings
   * @param {!boolean} bool set to true to disable warnings.
   */
  disableWarnings: function(bool) {
    if (typeof bool !== 'boolean') {
      return new Error('Argument type: ' + typeof bool +
          '. Please use a boolean.');
    }
    deprecationWarnings_ = !bool;
    return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');
  },

  log: function() {
    if (typeof window === 'object') {
      if (logDisabled_) {
        return;
      }
      if (typeof console !== 'undefined' && typeof console.log === 'function') {
        console.log.apply(console, arguments);
      }
    }
  },

  /**
   * Shows a deprecation warning suggesting the modern and spec-compatible API.
   */
  deprecated: function(oldMethod, newMethod) {
    if (!deprecationWarnings_) {
      return;
    }
    console.warn(oldMethod + ' is deprecated, please use ' + newMethod +
        ' instead.');
  },

  /**
   * Browser detector.
   *
   * @return {object} result containing browser and version
   *     properties.
   */
  detectBrowser: function(window) {
    var navigator = window && window.navigator;

    // Returned result object.
    var result = {};
    result.browser = null;
    result.version = null;

    // Fail early if it's not a browser
    if (typeof window === 'undefined' || !window.navigator) {
      result.browser = 'Not a browser.';
      return result;
    }

    if (navigator.mozGetUserMedia) { // Firefox.
      result.browser = 'firefox';
      result.version = extractVersion(navigator.userAgent,
          /Firefox\/(\d+)\./, 1);
    } else if (navigator.webkitGetUserMedia) {
      // Chrome, Chromium, Webview, Opera.
      // Version matches Chrome/WebRTC version.
      result.browser = 'chrome';
      result.version = extractVersion(navigator.userAgent,
          /Chrom(e|ium)\/(\d+)\./, 2);
    } else if (navigator.mediaDevices &&
        navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)) { // Edge.
      result.browser = 'edge';
      result.version = extractVersion(navigator.userAgent,
          /Edge\/(\d+).(\d+)$/, 2);
    } else if (window.RTCPeerConnection &&
        navigator.userAgent.match(/AppleWebKit\/(\d+)\./)) { // Safari.
      result.browser = 'safari';
      result.version = extractVersion(navigator.userAgent,
          /AppleWebKit\/(\d+)\./, 1);
    } else { // Default fallthrough: not supported.
      result.browser = 'Not a supported browser.';
      return result;
    }

    return result;
  }
};

},{}],134:[function(require,module,exports){
(function (global){(function (){
'use strict';

require('webrtc-adapter');

var _rtc_session = require('./rtc_session');

var _rtc_session2 = _interopRequireDefault(_rtc_session);

var _rtc_const = require('./rtc_const');

var _rtc_peer_connection_factory = require('./rtc_peer_connection_factory');

var _rtc_peer_connection_factory2 = _interopRequireDefault(_rtc_peer_connection_factory);

var _v = require('uuid/v4');

var _v2 = _interopRequireDefault(_v);

var _StandardStrategy = require('./strategies/StandardStrategy');

var _StandardStrategy2 = _interopRequireDefault(_StandardStrategy);

var _CitrixVDIStrategy = require('./strategies/CitrixVDIStrategy');

var _CitrixVDIStrategy2 = _interopRequireDefault(_CitrixVDIStrategy);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * @license
 * License info for uuid module assembled into js bundle:
 *
 * The MIT License (MIT)
 *
 * Copyright (c) 2010-2016 Robert Kieffer and other contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
global.connect = global.connect || {}; /**
                                        * @license
                                        * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
                                        *
                                        * SPDX-License-Identifier: Apache-2.0
                                        */
/**
 * @license
 * License info for webrtc-adapter module assembled into js bundle:
 *
 * Copyright (c) 2014, The WebRTC project authors. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 *
 * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 *
 * Neither the name of Google nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
/**
 * @license
 * License info for sdp module assembled into js bundle:
 *
 * See https://www.npmjs.com/package/sdp
 */

global.connect.RTCSession = _rtc_session2.default;
global.connect.RTCErrors = _rtc_const.RTC_ERRORS;
global.connect.RtcPeerConnectionFactory = _rtc_peer_connection_factory2.default;
global.connect.uuid = _v2.default;
global.connect.StandardStrategy = _StandardStrategy2.default;
global.connect.CitrixVDIStrategy = _CitrixVDIStrategy2.default;

global.lily = global.lily || {};
global.lily.RTCSession = _rtc_session2.default;
global.lily.RTCErrors = _rtc_const.RTC_ERRORS;

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./rtc_const":136,"./rtc_peer_connection_factory":137,"./rtc_session":138,"./strategies/CitrixVDIStrategy":143,"./strategies/StandardStrategy":144,"uuid/v4":121,"webrtc-adapter":122}],135:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.UnknownSignalingError = exports.UnknownSignalingErrorName = exports.CallNotFoundException = exports.CallNotFoundExceptionName = exports.BusyException = exports.BusyExceptionName = exports.UnsupportedOperation = exports.UnsupportedOperationExceptionName = exports.IllegalState = exports.IllegalStateExceptionName = exports.IllegalParameters = exports.IllegalParametersExceptionName = exports.GumTimeout = exports.GumTimeoutExceptionName = exports.Timeout = exports.TimeoutExceptionName = undefined;

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */
var TimeoutExceptionName = exports.TimeoutExceptionName = 'Timeout';

var Timeout = exports.Timeout = function (_Error) {
    (0, _inherits3.default)(Timeout, _Error);

    function Timeout(msg) {
        (0, _classCallCheck3.default)(this, Timeout);

        var _this = (0, _possibleConstructorReturn3.default)(this, (Timeout.__proto__ || Object.getPrototypeOf(Timeout)).call(this, msg));

        _this.name = TimeoutExceptionName;
        return _this;
    }

    return Timeout;
}(Error);

var GumTimeoutExceptionName = exports.GumTimeoutExceptionName = 'GumTimeout';

var GumTimeout = exports.GumTimeout = function (_Timeout) {
    (0, _inherits3.default)(GumTimeout, _Timeout);

    function GumTimeout(msg) {
        (0, _classCallCheck3.default)(this, GumTimeout);

        var _this2 = (0, _possibleConstructorReturn3.default)(this, (GumTimeout.__proto__ || Object.getPrototypeOf(GumTimeout)).call(this, msg));

        _this2.name = GumTimeoutExceptionName;
        return _this2;
    }

    return GumTimeout;
}(Timeout);

var IllegalParametersExceptionName = exports.IllegalParametersExceptionName = 'IllegalParameters';

var IllegalParameters = exports.IllegalParameters = function (_Error2) {
    (0, _inherits3.default)(IllegalParameters, _Error2);

    function IllegalParameters(msg) {
        (0, _classCallCheck3.default)(this, IllegalParameters);

        var _this3 = (0, _possibleConstructorReturn3.default)(this, (IllegalParameters.__proto__ || Object.getPrototypeOf(IllegalParameters)).call(this, msg));

        _this3.name = IllegalParametersExceptionName;
        return _this3;
    }

    return IllegalParameters;
}(Error);

var IllegalStateExceptionName = exports.IllegalStateExceptionName = 'IllegalState';

var IllegalState = exports.IllegalState = function (_Error3) {
    (0, _inherits3.default)(IllegalState, _Error3);

    function IllegalState(msg) {
        (0, _classCallCheck3.default)(this, IllegalState);

        var _this4 = (0, _possibleConstructorReturn3.default)(this, (IllegalState.__proto__ || Object.getPrototypeOf(IllegalState)).call(this, msg));

        _this4.name = IllegalStateExceptionName;
        return _this4;
    }

    return IllegalState;
}(Error);

var UnsupportedOperationExceptionName = exports.UnsupportedOperationExceptionName = 'UnsupportedOperation';

var UnsupportedOperation = exports.UnsupportedOperation = function (_Error4) {
    (0, _inherits3.default)(UnsupportedOperation, _Error4);

    function UnsupportedOperation(msg) {
        (0, _classCallCheck3.default)(this, UnsupportedOperation);

        var _this5 = (0, _possibleConstructorReturn3.default)(this, (UnsupportedOperation.__proto__ || Object.getPrototypeOf(UnsupportedOperation)).call(this, msg));

        _this5.name = UnsupportedOperationExceptionName;
        return _this5;
    }

    return UnsupportedOperation;
}(Error);

var BusyExceptionName = exports.BusyExceptionName = 'BusyException';

var BusyException = exports.BusyException = function (_Error5) {
    (0, _inherits3.default)(BusyException, _Error5);

    function BusyException(msg) {
        (0, _classCallCheck3.default)(this, BusyException);

        var _this6 = (0, _possibleConstructorReturn3.default)(this, (BusyException.__proto__ || Object.getPrototypeOf(BusyException)).call(this, msg));

        _this6.name = BusyExceptionName;
        return _this6;
    }

    return BusyException;
}(Error);

var CallNotFoundExceptionName = exports.CallNotFoundExceptionName = 'CallNotFoundException';

var CallNotFoundException = exports.CallNotFoundException = function (_Error6) {
    (0, _inherits3.default)(CallNotFoundException, _Error6);

    function CallNotFoundException(msg) {
        (0, _classCallCheck3.default)(this, CallNotFoundException);

        var _this7 = (0, _possibleConstructorReturn3.default)(this, (CallNotFoundException.__proto__ || Object.getPrototypeOf(CallNotFoundException)).call(this, msg));

        _this7.name = CallNotFoundExceptionName;
        return _this7;
    }

    return CallNotFoundException;
}(Error);

var UnknownSignalingErrorName = exports.UnknownSignalingErrorName = 'UnknownSignalingError';

var UnknownSignalingError = exports.UnknownSignalingError = function (_Error7) {
    (0, _inherits3.default)(UnknownSignalingError, _Error7);

    function UnknownSignalingError() {
        (0, _classCallCheck3.default)(this, UnknownSignalingError);

        var _this8 = (0, _possibleConstructorReturn3.default)(this, (UnknownSignalingError.__proto__ || Object.getPrototypeOf(UnknownSignalingError)).call(this));

        _this8.name = UnknownSignalingErrorName;
        return _this8;
    }

    return UnknownSignalingError;
}(Error);

},{"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/inherits":14,"babel-runtime/helpers/possibleConstructorReturn":15}],136:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});
/**
 * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * Timeout waiting for server response to accept/hangup request.
 */
var MAX_ACCEPT_BYE_DELAY_MS = exports.MAX_ACCEPT_BYE_DELAY_MS = 2000;
/**
 * Timeout waiting for server response to invite.
 */
var MAX_INVITE_DELAY_MS = exports.MAX_INVITE_DELAY_MS = 5000;
/**
 *  Default timeout on opening WebSocket connection.
 */
var DEFAULT_CONNECT_TIMEOUT_MS = exports.DEFAULT_CONNECT_TIMEOUT_MS = 10000;
/**
 * Default ice collection timeout in milliseconds.
 */
var DEFAULT_ICE_TIMEOUT_MS = exports.DEFAULT_ICE_TIMEOUT_MS = 8000;
/**
 * Default gum timeout in milliseconds to be enforced during start of a call.
 */
var DEFAULT_GUM_TIMEOUT_MS = exports.DEFAULT_GUM_TIMEOUT_MS = 10000;

var SOFTPHONE_ROUTE_KEY = exports.SOFTPHONE_ROUTE_KEY = "aws/softphone";

var INVITE_METHOD_NAME = exports.INVITE_METHOD_NAME = "invite";
var ACCEPT_METHOD_NAME = exports.ACCEPT_METHOD_NAME = "accept";
var BYE_METHOD_NAME = exports.BYE_METHOD_NAME = "bye";

var RTC_PEER_CONNECTION_CONFIG = exports.RTC_PEER_CONNECTION_CONFIG = {
    iceTransportPolicy: 'relay',
    rtcpMuxPolicy: 'require',
    bundlePolicy: 'balanced',
    sdpSemantics: 'unified-plan',
    enableDtlsSrtp: true
};

var RTC_PEER_CONNECTION_OPTIONAL_CONFIG = exports.RTC_PEER_CONNECTION_OPTIONAL_CONFIG = {
    optional: [{
        googDscp: true

    }, {
        DtlsSrtpKeyAgreement: true
    }]
};

var DEFAULT_ICE_CANDIDATE_POOL_SIZE = exports.DEFAULT_ICE_CANDIDATE_POOL_SIZE = 1;

var RTC_PEER_CONNECTION_IDLE_TIMEOUT_MS = exports.RTC_PEER_CONNECTION_IDLE_TIMEOUT_MS = 1 * 60 * 1000;

var NETWORK_CONNECTIVITY_CHECK_INTERVAL_MS = exports.NETWORK_CONNECTIVITY_CHECK_INTERVAL_MS = 250;

var CHROME_SUPPORTED_VERSION = exports.CHROME_SUPPORTED_VERSION = 59;

/**
 * RTC error names.
 */
var RTC_ERRORS = exports.RTC_ERRORS = {
    ICE_COLLECTION_TIMEOUT: 'Ice Collection Timeout',
    USER_BUSY: 'User Busy',
    SIGNALLING_CONNECTION_FAILURE: 'Signalling Connection Failure',
    SIGNALLING_HANDSHAKE_FAILURE: 'Signalling Handshake Failure',
    SET_REMOTE_DESCRIPTION_FAILURE: 'Set Remote Description Failure',
    CREATE_OFFER_FAILURE: 'Create Offer Failure',
    SET_LOCAL_DESCRIPTION_FAILURE: 'Set Local Description Failure',
    INVALID_REMOTE_SDP: 'Invalid Remote SDP',
    NO_REMOTE_ICE_CANDIDATE: 'No Remote ICE Candidate',
    GUM_TIMEOUT_FAILURE: 'GUM Timeout Failure',
    GUM_OTHER_FAILURE: 'GUM Other Failure',
    CALL_NOT_FOUND: 'Call Not Found'
};

var ICE_CONNECTION_STATE = exports.ICE_CONNECTION_STATE = {
    NEW: 'new',
    CHECKING: 'checking',
    CONNECTED: 'connected',
    COMPLETED: 'completed',
    FAILED: 'failed',
    DISCONNECTED: 'disconnected',
    CLOSED: 'closed'
};

var PEER_CONNECTION_STATE = exports.PEER_CONNECTION_STATE = {
    NEW: 'new',
    CONNECTING: 'connecting',
    CONNECTED: 'connected',
    FAILED: 'failed',
    DISCONNECTED: 'disconnected',
    CLOSED: 'closed'
};

},{}],137:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _utils = require('./utils');

var _rtc_const = require('./rtc_const');

var _CCPInitiationStrategyInterface = require('./strategies/CCPInitiationStrategyInterface');

var _CCPInitiationStrategyInterface2 = _interopRequireDefault(_CCPInitiationStrategyInterface);

var _StandardStrategy = require('./strategies/StandardStrategy');

var _StandardStrategy2 = _interopRequireDefault(_StandardStrategy);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var RtcPeerConnectionFactory = function () {

    //transportHandle must be a callback function which should return a promise which is going to return the iceServers. Please refer https://www.w3.org/TR/webrtc/#rtciceserver-dictionary for iceServer example
    //publishError(errorType, errorMessage) must be a callback function which will publish the passed error message to client browser
    function RtcPeerConnectionFactory(logger, wssManager, clientId, transportHandle, publishError) {
        var strategy = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : new _StandardStrategy2.default();
        (0, _classCallCheck3.default)(this, RtcPeerConnectionFactory);

        if (!(strategy instanceof _CCPInitiationStrategyInterface2.default)) {
            throw new Error('Expected a strategy of type CCPInitiationStrategyInterface');
        }
        (0, _utils.assertTrue)((0, _utils.isFunction)(transportHandle), 'transportHandle must be a function');
        (0, _utils.assertTrue)((0, _utils.isFunction)(publishError), 'publishError must be a function');
        this._strategy = strategy;
        this._logger = logger;
        this._clientId = clientId;
        this._wssManager = wssManager;
        this._requestIceAccess = transportHandle;
        this._publishError = publishError;
        this._earlyMediaConnectionSupported = this._isEarlyMediaConnectionSupported();
        this._initializeWebSocketEventListeners();
        this._requestPeerConnection();
        this._networkConnectivityChecker();

        this._logger.log("RTC.js is using " + strategy.getStrategyName());
    }

    (0, _createClass3.default)(RtcPeerConnectionFactory, [{
        key: '_isEarlyMediaConnectionSupported',
        value: function _isEarlyMediaConnectionSupported() {
            return this._strategy._isEarlyMediaConnectionSupported();
        }

        //This will handle the idleConnection and quota limits notification from the server

    }, {
        key: '_webSocketManagerOnMessage',
        value: function _webSocketManagerOnMessage(event) {
            var content = void 0;
            if (event.content) {
                content = JSON.parse(event.content);
            }
            if (content && this._clientId === content.clientId) {
                if (content.jsonRpcMsg.method === "idleConnection") {
                    this._clearIdleRtcPeerConnection();
                } else if (content.jsonRpcMsg.method === "quotaBreached") {
                    this._logger.log("Number of active sessions are more then allowed limit for the client " + this._clientId);
                    this._closeRTCPeerConnection();
                    this._publishError("multiple_softphone_active_sessions", "Number of active sessions are more then allowed limit.");
                }
            }
        }
    }, {
        key: '_initializeWebSocketEventListeners',
        value: function _initializeWebSocketEventListeners() {
            this._wssManager.subscribeTopics([_rtc_const.SOFTPHONE_ROUTE_KEY]);
            this._unSubscribe = this._wssManager.onMessage(_rtc_const.SOFTPHONE_ROUTE_KEY, (0, _utils.hitch)(this, this._webSocketManagerOnMessage));
        }

        // This method will create and return new peer connection if browser is not supporting early ice collection.
        // For the supported browser, this method will request for new peerConnection after returning the existing peerConnection

    }, {
        key: 'get',
        value: function get(iceServers) {
            var self = this;
            var pc = self._pc;
            self._pc = null;
            if (pc == null) {
                pc = self._createRtcPeerConnection(iceServers);
            }
            self.clearIdleRtcPeerConnectionTimerId();
            self._requestPeerConnection();
            return pc;
        }
    }, {
        key: 'clearIdleRtcPeerConnectionTimerId',
        value: function clearIdleRtcPeerConnectionTimerId() {
            var self = this;
            if (self._idleRtcPeerConnectionTimerId) {
                clearTimeout(self._idleRtcPeerConnectionTimerId);
                self._idleRtcPeerConnectionTimerId = null;
            }
        }
    }, {
        key: '_requestPeerConnection',
        value: function _requestPeerConnection() {
            var self = this;
            if (!self._peerConnectionRequestInFlight && self._earlyMediaConnectionSupported) {
                self._peerConnectionRequestInFlight = true;
                self._requestIceAccess().then(function (response) {
                    self._pc = self._createRtcPeerConnection(response);
                    self._peerConnectionRequestInFlight = false;
                    self._idleRtcPeerConnectionTimerId = setTimeout((0, _utils.hitch)(self, self._refreshRtcPeerConnection), _rtc_const.RTC_PEER_CONNECTION_IDLE_TIMEOUT_MS);
                },
                // eslint-disable-next-line no-unused-vars
                function (reason) {
                    self._peerConnectionRequestInFlight = false;
                });
            }
        }
    }, {
        key: '_networkConnectivityChecker',
        value: function _networkConnectivityChecker() {
            var self = this;
            setInterval(function () {
                if (!navigator.onLine && self._pc) {
                    self._logger.log("Network offline. Cleaning up early connection");
                    self._pc.close();
                    self._pc = null;
                }
            }, _rtc_const.NETWORK_CONNECTIVITY_CHECK_INTERVAL_MS);
        }
    }, {
        key: '_createRtcPeerConnection',
        value: function _createRtcPeerConnection(iceServers) {
            var rtcPeerConnectionConfig = JSON.parse(JSON.stringify(_rtc_const.RTC_PEER_CONNECTION_CONFIG));
            rtcPeerConnectionConfig.iceServers = iceServers;
            rtcPeerConnectionConfig.iceCandidatePoolSize = _rtc_const.DEFAULT_ICE_CANDIDATE_POOL_SIZE;
            return this._strategy._createRtcPeerConnection(rtcPeerConnectionConfig, _rtc_const.RTC_PEER_CONNECTION_OPTIONAL_CONFIG);
        }
    }, {
        key: '_clearIdleRtcPeerConnection',
        value: function _clearIdleRtcPeerConnection() {
            this._logger.log("session is idle from long time. closing the peer connection for client " + this._clientId);
            this._closeRTCPeerConnection();
        }
    }, {
        key: '_refreshRtcPeerConnection',
        value: function _refreshRtcPeerConnection() {
            this._idleRtcPeerConnectionTimerId = null;
            this._clearIdleRtcPeerConnection();
            this._logger.log("refreshing peer connection for client " + this._clientId);
            this._requestPeerConnection();
        }
    }, {
        key: '_closeRTCPeerConnection',
        value: function _closeRTCPeerConnection() {
            if (this._pc) {
                this._pc.close();
                this._pc = null;
            }
        }
    }]);
    return RtcPeerConnectionFactory;
}();

exports.default = RtcPeerConnectionFactory;

},{"./rtc_const":136,"./strategies/CCPInitiationStrategyInterface":142,"./strategies/StandardStrategy":144,"./utils":145,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],138:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.FailedState = exports.DisconnectedState = exports.CleanUpState = exports.TalkingState = exports.AcceptState = exports.InviteAnswerState = exports.ConnectSignalingAndIceCollectionState = exports.SetLocalSessionDescriptionState = exports.CreateOfferState = exports.GrabLocalMediaState = exports.RTCSessionState = undefined;

var _regenerator = require('babel-runtime/regenerator');

var _regenerator2 = _interopRequireDefault(_regenerator);

var _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _typeof2 = require('babel-runtime/helpers/typeof');

var _typeof3 = _interopRequireDefault(_typeof2);

var _get2 = require('babel-runtime/helpers/get');

var _get3 = _interopRequireDefault(_get2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _utils = require('./utils');

var _session_report = require('./session_report');

var _rtc_const = require('./rtc_const');

var _exceptions = require('./exceptions');

var _signaling = require('./signaling');

var _signaling2 = _interopRequireDefault(_signaling);

var _v = require('uuid/v4');

var _v2 = _interopRequireDefault(_v);

var _rtpStats = require('./rtp-stats');

var _sdp = require('sdp');

var _CCPInitiationStrategyInterface = require('./strategies/CCPInitiationStrategyInterface');

var _CCPInitiationStrategyInterface2 = _interopRequireDefault(_CCPInitiationStrategyInterface);

var _StandardStrategy = require('./strategies/StandardStrategy');

var _StandardStrategy2 = _interopRequireDefault(_StandardStrategy);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */
var RTCSessionState = exports.RTCSessionState = function () {
    /**
     *
     * @param {RtcSession} rtcSession
     */
    function RTCSessionState(rtcSession) {
        (0, _classCallCheck3.default)(this, RTCSessionState);

        this._rtcSession = rtcSession;
    }

    (0, _createClass3.default)(RTCSessionState, [{
        key: 'onEnter',
        value: function onEnter() {}
    }, {
        key: 'onExit',
        value: function onExit() {}
    }, {
        key: '_isCurrentState',
        value: function _isCurrentState() {
            return this._rtcSession._state === this;
        }
    }, {
        key: 'transit',
        value: function transit(nextState) {
            if (this._isCurrentState()) {
                this._rtcSession.transit(nextState);
            }
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            this.transit(new FailedState(this._rtcSession));
        }
    }, {
        key: 'onIceCandidate',
        value: function onIceCandidate(evt) {// eslint-disable-line no-unused-vars
            //ignore candidate by default, ConnectSignalingAndIceCollectionState will override to collect candidates, but collecting process could last much longer than ConnectSignalingAndIceCollectionState
            //we don't want to spam the console log
        }
    }, {
        key: 'onRemoteHungup',
        value: function onRemoteHungup() {
            throw new _exceptions.UnsupportedOperation('onRemoteHungup not implemented by ' + this.name);
        }
    }, {
        key: 'onSignalingConnected',
        value: function onSignalingConnected() {
            throw new _exceptions.UnsupportedOperation('onSignalingConnected not implemented by ' + this.name);
        }
    }, {
        key: 'onSignalingHandshaked',
        value: function onSignalingHandshaked() {
            throw new _exceptions.UnsupportedOperation('onSignalingHandshaked not implemented by ' + this.name);
        }
    }, {
        key: 'onSignalingFailed',
        value: function onSignalingFailed(e) {
            // eslint-disable-line no-unused-vars
            throw new _exceptions.UnsupportedOperation('onSignalingFailed not implemented by ' + this.name);
        }
    }, {
        key: 'onIceStateChange',
        value: function onIceStateChange(evt) {// eslint-disable-line no-unused-vars
        }
    }, {
        key: 'logger',
        get: function get() {
            return this._rtcSession._logger;
        }
    }, {
        key: 'name',
        get: function get() {
            return "RTCSessionState";
        }
    }]);
    return RTCSessionState;
}();

var GrabLocalMediaState = exports.GrabLocalMediaState = function (_RTCSessionState) {
    (0, _inherits3.default)(GrabLocalMediaState, _RTCSessionState);

    function GrabLocalMediaState() {
        (0, _classCallCheck3.default)(this, GrabLocalMediaState);
        return (0, _possibleConstructorReturn3.default)(this, (GrabLocalMediaState.__proto__ || Object.getPrototypeOf(GrabLocalMediaState)).apply(this, arguments));
    }

    (0, _createClass3.default)(GrabLocalMediaState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            var startTime = Date.now();
            if (self._rtcSession._isUserProvidedStream) {
                self.transit(new CreateOfferState(self._rtcSession));
            } else {
                var gumTimeoutPromise = new Promise(function (resolve, reject) {
                    setTimeout(function () {
                        reject(new _exceptions.GumTimeout('Local media has not been initialized yet.'));
                    }, self._rtcSession._gumTimeoutMillis);
                });
                var sessionGumPromise = self._gUM(self._rtcSession._buildMediaConstraints());

                Promise.race([sessionGumPromise, gumTimeoutPromise]).then(function (stream) {
                    self._rtcSession._sessionReport.gumTimeMillis = Date.now() - startTime;
                    self._rtcSession._onGumSuccess(self._rtcSession);
                    self._rtcSession._localStream = stream;
                    self._rtcSession._sessionReport.gumOtherFailure = false;
                    self._rtcSession._sessionReport.gumTimeoutFailure = false;
                    self.transit(new CreateOfferState(self._rtcSession));
                }).catch(function (e) {
                    self._rtcSession._sessionReport.gumTimeMillis = Date.now() - startTime;
                    var errorReason;
                    if (e instanceof _exceptions.GumTimeout) {
                        errorReason = _rtc_const.RTC_ERRORS.GUM_TIMEOUT_FAILURE;
                        self._rtcSession._sessionReport.gumTimeoutFailure = true;
                        self._rtcSession._sessionReport.gumOtherFailure = false;
                    } else {
                        errorReason = _rtc_const.RTC_ERRORS.GUM_OTHER_FAILURE;
                        self._rtcSession._sessionReport.gumOtherFailure = true;
                        self._rtcSession._sessionReport.gumTimeoutFailure = false;
                    }
                    self.logger.error('Local media initialization failed', e);
                    self._rtcSession._onGumError(self._rtcSession);
                    self.transit(new FailedState(self._rtcSession, errorReason));
                });
            }
        }
    }, {
        key: '_gUM',
        value: function _gUM(constraints) {
            return this._rtcSession._strategy._gUM(constraints);
        }
    }, {
        key: 'name',
        get: function get() {
            return "GrabLocalMediaState";
        }
    }]);
    return GrabLocalMediaState;
}(RTCSessionState);

var CreateOfferState = exports.CreateOfferState = function (_RTCSessionState2) {
    (0, _inherits3.default)(CreateOfferState, _RTCSessionState2);

    function CreateOfferState() {
        (0, _classCallCheck3.default)(this, CreateOfferState);
        return (0, _possibleConstructorReturn3.default)(this, (CreateOfferState.__proto__ || Object.getPrototypeOf(CreateOfferState)).apply(this, arguments));
    }

    (0, _createClass3.default)(CreateOfferState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            var stream = self._rtcSession._localStream;
            self._rtcSession._strategy.addStream(self._rtcSession._pc, stream);
            self._rtcSession._onLocalStreamAdded(self._rtcSession, stream);
            self._rtcSession._pc.createOffer().then(function (rtcSessionDescription) {
                self._rtcSession._localSessionDescription = rtcSessionDescription;
                self._rtcSession._sessionReport.createOfferFailure = false;
                self.transit(new SetLocalSessionDescriptionState(self._rtcSession));
            }).catch(function (e) {
                self.logger.error('CreateOffer failed', e);
                self._rtcSession._sessionReport.createOfferFailure = true;
                self.transit(new FailedState(self._rtcSession, _rtc_const.RTC_ERRORS.CREATE_OFFER_FAILURE));
            });
        }
    }, {
        key: 'name',
        get: function get() {
            return "CreateOfferState";
        }
    }]);
    return CreateOfferState;
}(RTCSessionState);

var SetLocalSessionDescriptionState = exports.SetLocalSessionDescriptionState = function (_RTCSessionState3) {
    (0, _inherits3.default)(SetLocalSessionDescriptionState, _RTCSessionState3);

    function SetLocalSessionDescriptionState() {
        (0, _classCallCheck3.default)(this, SetLocalSessionDescriptionState);
        return (0, _possibleConstructorReturn3.default)(this, (SetLocalSessionDescriptionState.__proto__ || Object.getPrototypeOf(SetLocalSessionDescriptionState)).apply(this, arguments));
    }

    (0, _createClass3.default)(SetLocalSessionDescriptionState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;

            // fix/modify SDP as needed here, before setLocalDescription
            var localDescription = self._rtcSession._localSessionDescription;
            var sdpOptions = new _utils.SdpOptions();
            // Set audio codec.
            if (self._rtcSession._forceAudioCodec) {
                sdpOptions.forceCodec['audio'] = self._rtcSession._forceAudioCodec;
            }
            // Set video codec.
            if (self._rtcSession._forceVideoCodec) {
                sdpOptions.forceCodec['video'] = self._rtcSession._forceVideoCodec;
            }
            sdpOptions.enableOpusDtx = self._rtcSession._enableOpusDtx;

            var transformedSdp = (0, _utils.transformSdp)(localDescription.sdp, sdpOptions);
            localDescription.sdp = transformedSdp.sdp;
            localDescription.sdp += 'a=ptime:20\r\n';
            localDescription.sdp += 'a=maxptime:20\r\n';
            localDescription.sdp = localDescription.sdp.replace("minptime=10", "minptime=20");

            self.logger.info('LocalSD', self._rtcSession._localSessionDescription);
            self._rtcSession._pc.setLocalDescription(self._rtcSession._localSessionDescription).then(function () {
                var initializationTime = Date.now() - self._rtcSession._connectTimeStamp;
                self._rtcSession._sessionReport.initializationTimeMillis = initializationTime;
                self._rtcSession._onSessionInitialized(self._rtcSession, initializationTime);
                self._rtcSession._sessionReport.setLocalDescriptionFailure = false;
                self.transit(new ConnectSignalingAndIceCollectionState(self._rtcSession, transformedSdp.mLines));
            }).catch(function (e) {
                self.logger.error('SetLocalDescription failed', e);
                self._rtcSession._sessionReport.setLocalDescriptionFailure = true;
                self.transit(new FailedState(self._rtcSession, _rtc_const.RTC_ERRORS.SET_LOCAL_DESCRIPTION_FAILURE));
            });
        }
    }, {
        key: 'name',
        get: function get() {
            return "SetLocalSessionDescriptionState";
        }
    }]);
    return SetLocalSessionDescriptionState;
}(RTCSessionState);

/**
 * Kick off signaling connection. Wait until signaling connects and ICE collection (which already started in previous state) completes.
 * ICE collection times out after user specified amount of time (default to DEFAULT_ICE_TIMEOUT_MS) in case user has complex network environment that blackholes STUN/TURN requests. In this case at least one candidate is required to move forward.
 * ICE collection could also wrap up before timeout if it's determined that RTP candidates from same TURN server have been collected for all m lines.
 */


var ConnectSignalingAndIceCollectionState = exports.ConnectSignalingAndIceCollectionState = function (_RTCSessionState4) {
    (0, _inherits3.default)(ConnectSignalingAndIceCollectionState, _RTCSessionState4);

    /**
     * Create ConnectSignalingAndIceCollectionState object.
     * @param {RtcSession} rtcSession
     * @param {number} mLines Number of m lines in SDP
     */
    function ConnectSignalingAndIceCollectionState(rtcSession, mLines) {
        (0, _classCallCheck3.default)(this, ConnectSignalingAndIceCollectionState);

        var _this4 = (0, _possibleConstructorReturn3.default)(this, (ConnectSignalingAndIceCollectionState.__proto__ || Object.getPrototypeOf(ConnectSignalingAndIceCollectionState)).call(this, rtcSession));

        _this4._iceCandidates = [];
        _this4._iceCandidateFoundationsMap = {};
        _this4._mLines = mLines;
        return _this4;
    }

    (0, _createClass3.default)(ConnectSignalingAndIceCollectionState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            self._startTime = Date.now();
            setTimeout(function () {
                if (self._isCurrentState() && !self._iceCompleted) {
                    self.logger.warn('ICE collection timed out');
                    self._reportIceCompleted(true);
                }
            }, self._rtcSession._iceTimeoutMillis);
            self._rtcSession._createSignalingChannel().connect();
        }
    }, {
        key: 'onSignalingConnected',
        value: function onSignalingConnected() {
            this._rtcSession._signallingConnectTimestamp = Date.now();
            this._rtcSession._sessionReport.signallingConnectTimeMillis = this._rtcSession._signallingConnectTimestamp - this._startTime;
            this._signalingConnected = true;
            this._rtcSession._onSignalingConnected(this._rtcSession);
            this._rtcSession._sessionReport.signallingConnectionFailure = false;
            this._checkAndTransit();
        }
    }, {
        key: 'onSignalingFailed',
        value: function onSignalingFailed(e) {
            this._rtcSession._sessionReport.signallingConnectTimeMillis = Date.now() - this._startTime;
            this.logger.error('Failed connecting to signaling server', e);
            this._rtcSession._sessionReport.signallingConnectionFailure = true;
            this.transit(new FailedState(this._rtcSession, _rtc_const.RTC_ERRORS.SIGNALLING_CONNECTION_FAILURE));
        }
    }, {
        key: '_createLocalCandidate',
        value: function _createLocalCandidate(initDict) {
            return new RTCIceCandidate(initDict);
        }
    }, {
        key: 'onIceCandidate',
        value: function onIceCandidate(evt) {
            var candidate = evt.candidate;
            this.logger.log('onicecandidate ' + JSON.stringify(candidate));
            if (candidate) {
                if (candidate.candidate) {
                    this._iceCandidates.push(this._createLocalCandidate(candidate));
                    if (!this._iceCompleted) {
                        this._checkCandidatesSufficient(candidate);
                    }
                }
            } else {
                this._reportIceCompleted(false);
            }
        }
    }, {
        key: '_checkCandidatesSufficient',
        value: function _checkCandidatesSufficient(candidate) {
            //check if we collected sufficient candidates from single media server to start the call
            var candidateObj = (0, _sdp.parseCandidate)(candidate.candidate);
            if (candidateObj.component != 1) {
                return;
            }
            var candidateFoundation = candidateObj.foundation;
            var candidateMLineIndex = candidate.sdpMLineIndex;
            if (candidateFoundation && candidateMLineIndex >= 0 && candidateMLineIndex < this._mLines) {
                var mIndexList = this._iceCandidateFoundationsMap[candidateFoundation] || [];
                if (!mIndexList.includes(candidateMLineIndex)) {
                    mIndexList.push(candidateMLineIndex);
                }
                this._iceCandidateFoundationsMap[candidateFoundation] = mIndexList;

                if (this._mLines == mIndexList.length) {
                    this._reportIceCompleted(false);
                }
            }
        }
    }, {
        key: '_reportIceCompleted',
        value: function _reportIceCompleted(isTimeout) {
            this._rtcSession._sessionReport.iceCollectionTimeMillis = Date.now() - this._startTime;
            this._iceCompleted = true;
            this._rtcSession._onIceCollectionComplete(this._rtcSession, isTimeout, this._iceCandidates.length);
            if (this._iceCandidates.length > 0) {
                this._rtcSession._sessionReport.iceCollectionFailure = false;
                this._checkAndTransit();
            } else {
                this.logger.error('No ICE candidate');
                this._rtcSession._sessionReport.iceCollectionFailure = true;
                this.transit(new FailedState(this._rtcSession, _rtc_const.RTC_ERRORS.ICE_COLLECTION_TIMEOUT));
            }
        }
    }, {
        key: '_checkAndTransit',
        value: function _checkAndTransit() {
            if (this._iceCompleted && this._signalingConnected) {
                this.transit(new InviteAnswerState(this._rtcSession, this._iceCandidates));
            } else if (!this._iceCompleted) {
                this.logger.log('Pending ICE collection');
            } else {
                //implies _signalingConnected == false
                this.logger.log('Pending signaling connection');
            }
        }
    }, {
        key: 'name',
        get: function get() {
            return "ConnectSignalingAndIceCollectionState";
        }
    }]);
    return ConnectSignalingAndIceCollectionState;
}(RTCSessionState);

var InviteAnswerState = exports.InviteAnswerState = function (_RTCSessionState5) {
    (0, _inherits3.default)(InviteAnswerState, _RTCSessionState5);

    function InviteAnswerState(rtcSession, iceCandidates) {
        (0, _classCallCheck3.default)(this, InviteAnswerState);

        var _this5 = (0, _possibleConstructorReturn3.default)(this, (InviteAnswerState.__proto__ || Object.getPrototypeOf(InviteAnswerState)).call(this, rtcSession));

        _this5._iceCandidates = iceCandidates;
        return _this5;
    }

    (0, _createClass3.default)(InviteAnswerState, [{
        key: 'onEnter',
        value: function onEnter() {
            var rtcSession = this._rtcSession;
            rtcSession._onSignalingStarted(rtcSession);
            rtcSession._signalingChannel.invite(rtcSession._localSessionDescription.sdp, this._iceCandidates);
        }
    }, {
        key: 'onSignalingAnswered',
        value: function onSignalingAnswered(sdp, candidates) {
            this._rtcSession._sessionReport.userBusyFailure = false;
            this._rtcSession._sessionReport.handshakingFailure = false;
            this.transit(new AcceptState(this._rtcSession, sdp, candidates));
        }
    }, {
        key: 'onSignalingFailed',
        value: function onSignalingFailed(e) {
            var reason;
            if (e.name == _exceptions.BusyExceptionName) {
                this.logger.error('User Busy, possibly multiple CCP windows open', e);
                this._rtcSession._sessionReport.userBusyFailure = true;
                this._rtcSession._sessionReport.handshakingFailure = true;
                reason = _rtc_const.RTC_ERRORS.USER_BUSY;
            } else if (e.name == _exceptions.CallNotFoundExceptionName) {
                this.logger.error('Call not found. One of the participant probably hungup.', e);
                reason = _rtc_const.RTC_ERRORS.CALL_NOT_FOUND;
                this._rtcSession._sessionReport.handshakingFailure = true;
            } else {
                this.logger.error('Failed handshaking with signaling server', e);
                this._rtcSession._sessionReport.userBusyFailure = false;
                this._rtcSession._sessionReport.handshakingFailure = true;
                reason = _rtc_const.RTC_ERRORS.SIGNALLING_HANDSHAKE_FAILURE;
            }
            this.transit(new FailedState(this._rtcSession, reason));
        }
    }, {
        key: 'name',
        get: function get() {
            return "InviteAnswerState";
        }
    }]);
    return InviteAnswerState;
}(RTCSessionState);

var AcceptState = exports.AcceptState = function (_RTCSessionState6) {
    (0, _inherits3.default)(AcceptState, _RTCSessionState6);

    function AcceptState(rtcSession, sdp, candidates) {
        (0, _classCallCheck3.default)(this, AcceptState);

        var _this6 = (0, _possibleConstructorReturn3.default)(this, (AcceptState.__proto__ || Object.getPrototypeOf(AcceptState)).call(this, rtcSession));

        _this6._sdp = sdp;
        _this6._candidates = candidates;
        return _this6;
    }

    (0, _createClass3.default)(AcceptState, [{
        key: '_createSessionDescription',
        value: function _createSessionDescription(initDict) {
            return new RTCSessionDescription(initDict);
        }
    }, {
        key: '_createRemoteCandidate',
        value: function _createRemoteCandidate(initDict) {
            return new RTCIceCandidate(initDict);
        }
    }, {
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            var rtcSession = self._rtcSession;

            if (!self._sdp) {
                self.logger.error('Invalid remote SDP');
                rtcSession._stopSession();
                rtcSession._sessionReport.invalidRemoteSDPFailure = true;
                self.transit(new FailedState(rtcSession, _rtc_const.RTC_ERRORS.INVALID_REMOTE_SDP));
                return;
            } else if (!self._candidates || self._candidates.length < 1) {
                self.logger.error('No remote ICE candidate');
                rtcSession._stopSession();
                rtcSession._sessionReport.noRemoteIceCandidateFailure = true;
                self.transit(new FailedState(rtcSession, _rtc_const.RTC_ERRORS.NO_REMOTE_ICE_CANDIDATE));
                return;
            }

            rtcSession._sessionReport.invalidRemoteSDPFailure = false;
            rtcSession._sessionReport.noRemoteIceCandidateFailure = false;
            self._rtcSession._strategy.setRemoteDescription(self, rtcSession);
        }
    }, {
        key: 'onSignalingHandshaked',
        value: function onSignalingHandshaked() {
            this._rtcSession._sessionReport.handshakingTimeMillis = Date.now() - this._rtcSession._signallingConnectTimestamp;
            this._signalingHandshaked = true;
            this._checkAndTransit();
        }
    }, {
        key: '_checkAndTransit',
        value: function _checkAndTransit() {
            if (this._signalingHandshaked && this._remoteDescriptionSet) {
                this.transit(new TalkingState(this._rtcSession));
            } else if (!this._signalingHandshaked) {
                this.logger.log('Pending handshaking');
            } else {
                //implies _remoteDescriptionSet == false
                this.logger.log('Pending setting remote description');
            }
        }
    }, {
        key: 'name',
        get: function get() {
            return "AcceptState";
        }
    }]);
    return AcceptState;
}(RTCSessionState);

var TalkingState = exports.TalkingState = function (_RTCSessionState7) {
    (0, _inherits3.default)(TalkingState, _RTCSessionState7);

    function TalkingState() {
        (0, _classCallCheck3.default)(this, TalkingState);
        return (0, _possibleConstructorReturn3.default)(this, (TalkingState.__proto__ || Object.getPrototypeOf(TalkingState)).apply(this, arguments));
    }

    (0, _createClass3.default)(TalkingState, [{
        key: 'onEnter',
        value: function onEnter() {
            this._startTime = Date.now();
            this._rtcSession._sessionReport.preTalkingTimeMillis = this._startTime - this._rtcSession._connectTimeStamp;
            this._rtcSession._onSessionConnected(this._rtcSession);
        }
    }, {
        key: 'onSignalingReconnected',
        value: function onSignalingReconnected() {}
    }, {
        key: 'onRemoteHungup',
        value: function onRemoteHungup() {
            this._rtcSession._signalingChannel.hangup();
            this.transit(new DisconnectedState(this._rtcSession));
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            this._rtcSession._signalingChannel.hangup();
            this.transit(new DisconnectedState(this._rtcSession));
        }
    }, {
        key: 'onIceStateChange',
        value: function onIceStateChange(evt) {
            var iceState = this._rtcSession._strategy.onIceStateChange(evt, this._rtcSession._pc);
            this.logger.info('ICE Connection State: ', iceState);

            if (iceState == _rtc_const.ICE_CONNECTION_STATE.DISCONNECTED) {
                this.logger.info('Lost ICE connection');
                this._rtcSession._sessionReport.iceConnectionsLost += 1;
            }
            if (iceState == _rtc_const.ICE_CONNECTION_STATE.FAILED) {
                this._rtcSession._sessionReport.iceConnectionsFailed = true;
            }
        }
    }, {
        key: 'onPeerConnectionStateChange',
        value: function onPeerConnectionStateChange() {
            var peerConnectionState = this._rtcSession._strategy.onPeerConnectionStateChange(this._rtcSession._pc);
            this.logger.info('Peer Connection State: ', peerConnectionState);

            if (peerConnectionState == _rtc_const.PEER_CONNECTION_STATE.FAILED) {
                this._rtcSession._sessionReport.peerConnectionFailed = true;
            }
        }
    }, {
        key: 'onExit',
        value: function onExit() {
            this._rtcSession._sessionReport.talkingTimeMillis = Date.now() - this._startTime;
            this._rtcSession._detachMedia();
            this._rtcSession._sessionReport.sessionEndTime = new Date();
            this._rtcSession._onSessionCompleted(this._rtcSession);
        }
    }, {
        key: 'name',
        get: function get() {
            return "TalkingState";
        }
    }]);
    return TalkingState;
}(RTCSessionState);

var CleanUpState = exports.CleanUpState = function (_RTCSessionState8) {
    (0, _inherits3.default)(CleanUpState, _RTCSessionState8);

    function CleanUpState() {
        (0, _classCallCheck3.default)(this, CleanUpState);
        return (0, _possibleConstructorReturn3.default)(this, (CleanUpState.__proto__ || Object.getPrototypeOf(CleanUpState)).apply(this, arguments));
    }

    (0, _createClass3.default)(CleanUpState, [{
        key: 'onEnter',
        value: function onEnter() {
            this._startTime = Date.now();
            this._rtcSession._stopSession();
            this._rtcSession._sessionReport.cleanupTimeMillis = Date.now() - this._startTime;
            this._rtcSession._onSessionDestroyed(this._rtcSession, this._rtcSession._sessionReport);
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            //do nothing, already at the end of lifecycle
        }
    }, {
        key: 'name',
        get: function get() {
            return "CleanUpState";
        }
    }]);
    return CleanUpState;
}(RTCSessionState);

var DisconnectedState = exports.DisconnectedState = function (_CleanUpState) {
    (0, _inherits3.default)(DisconnectedState, _CleanUpState);

    function DisconnectedState() {
        (0, _classCallCheck3.default)(this, DisconnectedState);
        return (0, _possibleConstructorReturn3.default)(this, (DisconnectedState.__proto__ || Object.getPrototypeOf(DisconnectedState)).apply(this, arguments));
    }

    (0, _createClass3.default)(DisconnectedState, [{
        key: 'name',
        get: function get() {
            return "DisconnectedState";
        }
    }]);
    return DisconnectedState;
}(CleanUpState);

var FailedState = exports.FailedState = function (_CleanUpState2) {
    (0, _inherits3.default)(FailedState, _CleanUpState2);

    function FailedState(rtcSession, failureReason) {
        (0, _classCallCheck3.default)(this, FailedState);

        var _this10 = (0, _possibleConstructorReturn3.default)(this, (FailedState.__proto__ || Object.getPrototypeOf(FailedState)).call(this, rtcSession));

        _this10._failureReason = failureReason;
        return _this10;
    }

    (0, _createClass3.default)(FailedState, [{
        key: 'onEnter',
        value: function onEnter() {
            this._rtcSession._sessionReport.sessionEndTime = new Date();
            this._rtcSession._onSessionFailed(this._rtcSession, this._failureReason);
            (0, _get3.default)(FailedState.prototype.__proto__ || Object.getPrototypeOf(FailedState.prototype), 'onEnter', this).call(this);
        }
    }, {
        key: 'name',
        get: function get() {
            return "FailedState";
        }
    }]);
    return FailedState;
}(CleanUpState);

var RtcSession = function () {
    /**
     * Build an AmazonConnect RTC session.
     * @param {*} signalingUri
     * @param {*} iceServers Array of ice servers
     * @param {*} contactToken A string representing the contact token (optional)
     * @param {*} logger An object provides logging functions, such as console
     * @param {*} contactId Must be UUID, uniquely identifies the session.
     */
    function RtcSession(signalingUri, iceServers, contactToken, logger, contactId, connectionId, wssManager) {
        var strategy = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : new _StandardStrategy2.default();
        (0, _classCallCheck3.default)(this, RtcSession);

        if (!(strategy instanceof _CCPInitiationStrategyInterface2.default)) {
            throw new Error('Expected a strategy of type CCPInitiationStrategyInterface');
        }
        if (typeof signalingUri !== 'string' || signalingUri.trim().length === 0) {
            throw new _exceptions.IllegalParameters('signalingUri required');
        }
        if (!iceServers) {
            throw new _exceptions.IllegalParameters('iceServers required');
        }
        if ((typeof logger === 'undefined' ? 'undefined' : (0, _typeof3.default)(logger)) !== 'object') {
            throw new _exceptions.IllegalParameters('logger required');
        }
        if (!contactId) {
            this._callId = (0, _v2.default)();
        } else {
            this._callId = contactId;
        }
        this._strategy = strategy;
        this._connectionId = connectionId;
        this._wssManager = wssManager;
        this._sessionReport = new _session_report.SessionReport();
        this._signalingUri = signalingUri;
        this._iceServers = iceServers;
        this._contactToken = contactToken;
        this._originalLogger = logger;
        this._logger = (0, _utils.wrapLogger)(this._originalLogger, this._callId, 'SESSION');
        this._iceTimeoutMillis = _rtc_const.DEFAULT_ICE_TIMEOUT_MS;
        this._gumTimeoutMillis = _rtc_const.DEFAULT_GUM_TIMEOUT_MS;

        this._enableAudio = true;
        this._enableVideo = false;
        this._facingMode = 'user';
        this._legacyStatsReportSupport = false;
        /**
         * user may provide the stream to the RtcSession directly to connect to the other end.
         * user may also acquire the stream from the local device.
         * This flag is used to track where the stream is acquired.
         * If it's acquired from local devices, then we must close the stream when the session ends.
         * If it's provided by user (rather than local camera/microphone), then we should leave it open when the
         * session ends.
         */
        this._isUserProvidedStream = false;

        this._onGumError = this._onGumSuccess = this._onLocalStreamAdded = this._onSessionFailed = this._onSessionInitialized = this._onSignalingConnected = this._onIceCollectionComplete = this._onSignalingStarted = this._onSessionConnected = this._onRemoteStreamAdded = this._onSessionCompleted = this._onSessionDestroyed = function () {};
    }

    (0, _createClass3.default)(RtcSession, [{
        key: 'pauseLocalVideo',
        value: function pauseLocalVideo() {
            if (this._localStream) {
                var videoTrack = this._localStream.getVideoTracks()[0];
                if (videoTrack) {
                    videoTrack.enabled = false;
                }
            }
        }
    }, {
        key: 'resumeLocalVideo',
        value: function resumeLocalVideo() {
            if (this._localStream) {
                var videoTrack = this._localStream.getVideoTracks()[0];
                if (videoTrack) {
                    videoTrack.enabled = true;
                }
            }
        }
    }, {
        key: 'pauseRemoteVideo',
        value: function pauseRemoteVideo() {
            if (this._remoteVideoStream) {
                var videoTrack = this._remoteVideoStream.getTracks()[1];
                if (videoTrack) {
                    videoTrack.enabled = false;
                }
            }
        }
    }, {
        key: 'resumeRemoteVideo',
        value: function resumeRemoteVideo() {
            if (this._remoteVideoStream) {
                var videoTrack = this._remoteVideoStream.getTracks()[1];
                if (videoTrack) {
                    videoTrack.enabled = true;
                }
            }
        }
    }, {
        key: 'pauseLocalAudio',
        value: function pauseLocalAudio() {
            if (this._localStream) {
                var audioTrack = this._localStream.getAudioTracks()[0];
                if (audioTrack) {
                    audioTrack.enabled = false;
                }
            }
        }
    }, {
        key: 'resumeLocalAudio',
        value: function resumeLocalAudio() {
            if (this._localStream) {
                var audioTrack = this._localStream.getAudioTracks()[0];
                if (audioTrack) {
                    audioTrack.enabled = true;
                }
            }
        }
    }, {
        key: 'pauseRemoteAudio',
        value: function pauseRemoteAudio() {
            if (this._remoteAudioStream) {
                var audioTrack = this._remoteAudioStream.getTracks()[0];
                if (audioTrack) {
                    audioTrack.enabled = false;
                }
            }
        }
    }, {
        key: 'resumeRemoteAudio',
        value: function resumeRemoteAudio() {
            if (this._remoteAudioStream) {
                var audioTrack = this._remoteAudioStream.getTracks()[0];
                if (audioTrack) {
                    audioTrack.enabled = true;
                }
            }
        }
        /**
         * Callback when gUM succeeds.
         * First param is RtcSession object.
         */

    }, {
        key: 'transit',
        value: function transit(nextState) {
            try {
                this._logger.info((this._state ? this._state.name : 'null') + ' => ' + nextState.name);
                if (this._state && this._state.onExit) {
                    this._state.onExit();
                }
            } finally {
                this._state = nextState;
                if (nextState.onEnter) {
                    try {
                        nextState.onEnter();
                    } catch (e) {
                        this._logger.warn(nextState.name + '#onEnter failed', e);
                        throw e; // eslint-disable-line no-unsafe-finally
                    }
                }
            }
        }
    }, {
        key: '_createSignalingChannel',
        value: function _createSignalingChannel() {
            var signalingChannel = new _signaling2.default(this._callId, this._signalingUri, this._contactToken, this._originalLogger, this._signalingConnectTimeout, this._connectionId, this._wssManager);
            signalingChannel.onConnected = (0, _utils.hitch)(this, this._signalingConnected);
            signalingChannel.onAnswered = (0, _utils.hitch)(this, this._signalingAnswered);
            signalingChannel.onHandshaked = (0, _utils.hitch)(this, this._signalingHandshaked);
            signalingChannel.onRemoteHungup = (0, _utils.hitch)(this, this._signalingRemoteHungup);
            signalingChannel.onFailed = (0, _utils.hitch)(this, this._signalingFailed);
            signalingChannel.onDisconnected = (0, _utils.hitch)(this, this._signalingDisconnected);

            this._signalingChannel = signalingChannel;

            return signalingChannel;
        }
    }, {
        key: '_signalingConnected',
        value: function _signalingConnected() {
            this._state.onSignalingConnected();
        }
    }, {
        key: '_signalingAnswered',
        value: function _signalingAnswered(sdp, candidates) {
            this._state.onSignalingAnswered(sdp, candidates);
        }
    }, {
        key: '_signalingHandshaked',
        value: function _signalingHandshaked() {
            this._state.onSignalingHandshaked();
        }
    }, {
        key: '_signalingRemoteHungup',
        value: function _signalingRemoteHungup() {
            this._state.onRemoteHungup();
        }
    }, {
        key: '_signalingFailed',
        value: function _signalingFailed(e) {
            this._state.onSignalingFailed(e);
        }
    }, {
        key: '_signalingDisconnected',
        value: function _signalingDisconnected() {}
    }, {
        key: '_createPeerConnection',
        value: function _createPeerConnection(configuration, optionalConfiguration) {
            return this._strategy._createPeerConnection(configuration, optionalConfiguration);
        }
    }, {
        key: 'connect',
        value: function connect(pc) {
            var self = this;
            var now = new Date();
            self._sessionReport.sessionStartTime = now;
            self._connectTimeStamp = now.getTime();
            if (pc && pc.signalingState != 'closed') {
                self._pc = pc;
            } else {
                if (pc) {
                    pc.close();
                    pc = null;
                }
                _rtc_const.RTC_PEER_CONNECTION_CONFIG.iceServers = self._iceServers;
                self._pc = self._createPeerConnection(_rtc_const.RTC_PEER_CONNECTION_CONFIG, _rtc_const.RTC_PEER_CONNECTION_OPTIONAL_CONFIG);
            }
            self._strategy.connect(self);
            self._pc.onicecandidate = (0, _utils.hitch)(self, self._onIceCandidate);
            self._pc.onconnectionstatechange = (0, _utils.hitch)(self, self._onPeerConnectionStateChange);
            self._pc.oniceconnectionstatechange = (0, _utils.hitch)(self, self._onIceStateChange);

            (0, _utils.isLegacyStatsReportSupported)(self._pc).then(function (result) {
                self._legacyStatsReportSupport = result;
                self.transit(new GrabLocalMediaState(self));
            });
        }
    }, {
        key: 'accept',
        value: function accept() {
            throw new _exceptions.UnsupportedOperation('accept does not go through signaling channel at this moment');
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            this._state.hangup();
        }

        /**
         * Get a promise containing an object with two named lists of audio stats, one for each channel on each
         * media type of 'video' and 'audio'.
         * @return Rejected promise if failed to get MediaRtpStats. The promise is never resolved with null value.
         */

    }, {
        key: 'getStats',
        value: function () {
            var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3() {
                var _this11 = this;

                var timestamp, impl, statsResult, rttReducer, audioInputRttMilliseconds, videoInputRttMilliseconds;
                return _regenerator2.default.wrap(function _callee3$(_context3) {
                    while (1) {
                        switch (_context3.prev = _context3.next) {
                            case 0:
                                timestamp = new Date();

                                impl = function () {
                                    var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2(stream, streamType) {
                                        var tracks;
                                        return _regenerator2.default.wrap(function _callee2$(_context2) {
                                            while (1) {
                                                switch (_context2.prev = _context2.next) {
                                                    case 0:
                                                        tracks = [];

                                                        if (stream) {
                                                            _context2.next = 3;
                                                            break;
                                                        }

                                                        return _context2.abrupt('return', []);

                                                    case 3:
                                                        _context2.t0 = streamType;
                                                        _context2.next = _context2.t0 === 'audio_input' ? 6 : _context2.t0 === 'audio_output' ? 6 : _context2.t0 === 'video_input' ? 8 : _context2.t0 === 'video_output' ? 8 : 10;
                                                        break;

                                                    case 6:
                                                        tracks = stream.getAudioTracks();
                                                        return _context2.abrupt('break', 11);

                                                    case 8:
                                                        tracks = stream.getVideoTracks();
                                                        return _context2.abrupt('break', 11);

                                                    case 10:
                                                        throw new Error('Unsupported stream type while trying to get stats: ' + streamType);

                                                    case 11:
                                                        _context2.next = 13;
                                                        return Promise.all(tracks.map((0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {
                                                            return _regenerator2.default.wrap(function _callee$(_context) {
                                                                while (1) {
                                                                    switch (_context.prev = _context.next) {
                                                                        case 0:
                                                                            return _context.abrupt('return', _this11._pc.getStats().then(function (rawStats) {
                                                                                var digestedStats = (0, _rtpStats.extractMediaStatsFromStats)(timestamp, rawStats, streamType);
                                                                                if (!digestedStats) {
                                                                                    throw new Error('Failed to extract MediaRtpStats from RTCStatsReport for stream type ' + streamType);
                                                                                }
                                                                                return digestedStats;
                                                                            }));

                                                                        case 1:
                                                                        case 'end':
                                                                            return _context.stop();
                                                                    }
                                                                }
                                                            }, _callee, _this11);
                                                        }))));

                                                    case 13:
                                                        return _context2.abrupt('return', _context2.sent);

                                                    case 14:
                                                    case 'end':
                                                        return _context2.stop();
                                                }
                                            }
                                        }, _callee2, _this11);
                                    }));

                                    return function impl(_x2, _x3) {
                                        return _ref2.apply(this, arguments);
                                    };
                                }();

                                if (!(this._pc && this._pc.signalingState === 'stable')) {
                                    _context3.next = 26;
                                    break;
                                }

                                _context3.next = 5;
                                return impl(this._remoteAudioStream, 'audio_input');

                            case 5:
                                _context3.t0 = _context3.sent;
                                _context3.next = 8;
                                return impl(this._localStream, 'audio_output');

                            case 8:
                                _context3.t1 = _context3.sent;
                                _context3.t2 = {
                                    input: _context3.t0,
                                    output: _context3.t1
                                };
                                _context3.next = 12;
                                return impl(this._remoteVideoStream, 'video_input');

                            case 12:
                                _context3.t3 = _context3.sent;
                                _context3.next = 15;
                                return impl(this._localStream, 'video_output');

                            case 15:
                                _context3.t4 = _context3.sent;
                                _context3.t5 = {
                                    input: _context3.t3,
                                    output: _context3.t4
                                };
                                statsResult = {
                                    audio: _context3.t2,
                                    video: _context3.t5
                                };

                                // For consistency's sake, coalesce rttMilliseconds into the output for audio and video.
                                rttReducer = function rttReducer(acc, stats) {
                                    if (stats.rttMilliseconds !== null && (acc === null || stats.rttMilliseconds > acc)) {
                                        acc = stats.rttMilliseconds;
                                    }
                                    stats._rttMilliseconds = null;
                                    return acc;
                                };

                                audioInputRttMilliseconds = statsResult.audio.input.reduce(rttReducer, null);
                                videoInputRttMilliseconds = statsResult.video.input.reduce(rttReducer, null);


                                if (audioInputRttMilliseconds !== null) {
                                    statsResult.audio.output.forEach(function (stats) {
                                        stats._rttMilliseconds = audioInputRttMilliseconds;
                                    });
                                }

                                if (videoInputRttMilliseconds !== null) {
                                    statsResult.video.output.forEach(function (stats) {
                                        stats._rttMilliseconds = videoInputRttMilliseconds;
                                    });
                                }

                                return _context3.abrupt('return', statsResult);

                            case 26:
                                return _context3.abrupt('return', Promise.reject(new _exceptions.IllegalState()));

                            case 27:
                            case 'end':
                                return _context3.stop();
                        }
                    }
                }, _callee3, this);
            }));

            function getStats() {
                return _ref.apply(this, arguments);
            }

            return getStats;
        }()

        /**
         * Get a promise of MediaRtpStats object for remote audio (from Amazon Connect to client).
         * @return Rejected promise if failed to get MediaRtpStats. The promise is never resolved with null value.
         * @deprecated in favor of getStats()
         */

    }, {
        key: 'getRemoteAudioStats',
        value: function getRemoteAudioStats() {
            return this.getStats().then(function (stats) {
                if (stats.audio.output.length > 0) {
                    return stats.audio.output[0];
                } else {
                    return Promise.reject(new _exceptions.IllegalState());
                }
            });
        }

        /**
         * Get a promise of MediaRtpStats object for user audio (from client to Amazon Connect).
         * @return Rejected promise if failed to get MediaRtpStats. The promise is never resolved with null value.
         * @deprecated in favor of getStats()
         */

    }, {
        key: 'getUserAudioStats',
        value: function getUserAudioStats() {
            return this.getStats().then(function (stats) {
                if (stats.audio.input.length > 0) {
                    return stats.audio.input[0];
                } else {
                    return Promise.reject(new _exceptions.IllegalState());
                }
            });
        }

        /**
         * Get a promise of MediaRtpStats object for user video (from client to Amazon Connect).
         * @return Rejected promise if failed to get MediaRtpStats. The promise is never resolved with null value.
         * @deprecated in favor of getStats()
         */

    }, {
        key: 'getRemoteVideoStats',
        value: function getRemoteVideoStats() {
            return this.getStats().then(function (stats) {
                if (stats.video.output.length > 0) {
                    return stats.video.output[0];
                } else {
                    return Promise.reject(new _exceptions.IllegalState());
                }
            });
        }

        /**
         * Get a promise of MediaRtpStats object for user video (from client to Amazon Connect).
         * @return Rejected promise if failed to get MediaRtpStats. The promise is never resolved with null value.
         * @deprecated in favor of getStats()
         */

    }, {
        key: 'getUserVideoStats',
        value: function getUserVideoStats() {
            return this.getStats().then(function (stats) {
                if (stats.video.input.length > 0) {
                    return stats.video.input[0];
                } else {
                    return Promise.reject(new _exceptions.IllegalState());
                }
            });
        }
    }, {
        key: '_onIceCandidate',
        value: function _onIceCandidate(evt) {
            this._state.onIceCandidate(evt);
        }
    }, {
        key: '_onPeerConnectionStateChange',
        value: function _onPeerConnectionStateChange() {
            this._state.onPeerConnectionStateChange();
        }
    }, {
        key: '_onIceStateChange',
        value: function _onIceStateChange(evt) {
            this._state.onIceStateChange(evt);
        }

        /**
         * Attach remote media stream to web element.
         */

    }, {
        key: '_ontrack',
        value: function _ontrack(evt) {
            this._strategy._ontrack(this, evt);
            this._onRemoteStreamAdded(this, evt.streams[0]);
        }
    }, {
        key: '_detachMedia',
        value: function _detachMedia() {
            if (this._remoteVideoElement) {
                this._remoteVideoElement.srcObject = null;
            }
            if (this._remoteAudioElement) {
                this._remoteAudioElement.srcObject = null;
                this._remoteAudioStream = null;
            }
        }
    }, {
        key: '_stopSession',
        value: function _stopSession() {
            try {
                if (this._localStream && !this._isUserProvidedStream) {
                    (0, _utils.closeStream)(this._localStream);
                    this._localStream = null;
                    this._isUserProvidedStream = false;
                }
            } finally {
                try {
                    if (this._pc) {
                        this._pc.close();
                    }
                } catch (e) {
                    // eat exception
                } finally {
                    this._pc = null;
                }
            }
        }
    }, {
        key: '_buildMediaConstraints',
        value: function _buildMediaConstraints() {
            var self = this;
            var mediaConstraints = {};

            self._strategy._buildMediaConstraints(self, mediaConstraints);

            if (self._enableVideo) {
                var videoConstraints = {};
                var widthConstraints = {};
                var heightConstraints = {};
                var frameRateConstraints = {};

                //build video width constraints
                if (typeof self._idealVideoWidth !== 'undefined') {
                    widthConstraints.ideal = self._idealVideoWidth;
                }
                if (typeof self._maxVideoWidth !== 'undefined') {
                    widthConstraints.max = self._maxVideoWidth;
                }
                if (typeof self._minVideoWidth !== 'undefined') {
                    widthConstraints.min = self._minVideoWidth;
                }
                // build video height constraints
                if (typeof self._idealVideoHeight !== 'undefined') {
                    heightConstraints.ideal = self._idealVideoHeight;
                }
                if (typeof self._maxVideoHeight !== 'undefined') {
                    heightConstraints.max = self._maxVideoHeight;
                }
                if (typeof self._minVideoHeight !== 'undefined') {
                    heightConstraints.min = self._minVideoHeight;
                }
                if (Object.keys(widthConstraints).length > 0 && Object.keys(heightConstraints).length > 0) {
                    videoConstraints.width = widthConstraints;
                    videoConstraints.height = heightConstraints;
                }
                // build frame rate constraints
                if (typeof self._videoFrameRate !== 'undefined') {
                    frameRateConstraints.ideal = self._videoFrameRate;
                }
                if (typeof self._minVideoFrameRate !== 'undefined') {
                    frameRateConstraints.min = self._minVideoFrameRate;
                }
                if (typeof self._maxVideoFrameRate !== 'undefined') {
                    frameRateConstraints.max = self._maxVideoFrameRate;
                }
                if (Object.keys(frameRateConstraints).length > 0) {
                    videoConstraints.frameRate = frameRateConstraints;
                }

                // build facing mode constraints
                if (self._facingMode !== 'user' && self._facingMode !== "environment") {
                    self._facingMode = 'user';
                }
                videoConstraints.facingMode = self._facingMode;

                // set video constraints
                if (Object.keys(videoConstraints).length > 0) {
                    mediaConstraints.video = videoConstraints;
                } else {
                    mediaConstraints.video = true;
                }
            }

            return mediaConstraints;
        }
    }, {
        key: 'sessionReport',
        get: function get() {
            return this._sessionReport;
        }
    }, {
        key: 'callId',
        get: function get() {
            return this._callId;
        }
        /**
         * getMediaStream returns the local stream, which may be acquired from local device or from user provided stream.
         * Rather than getting a stream by calling getUserMedia (which gets a stream from local device such as camera),
         * user could also provide the stream to the RtcSession directly to connect to the other end.
         */

    }, {
        key: 'mediaStream',
        get: function get() {
            return this._localStream;
        },

        /**
         * Optional. RtcSession will grab input device if this is not specified.
         * Please note: this RtcSession class only support single audio track and/or single video track.
         */
        set: function set(input) {
            this._localStream = input;
            this._isUserProvidedStream = true;
        }
        /**
         * Needed, expect an audio element that can be used to play remote audio stream.
         */

    }, {
        key: 'remoteVideoStream',
        get: function get() {
            return this._remoteVideoStream;
        }
    }, {
        key: 'onGumSuccess',
        set: function set(handler) {
            this._onGumSuccess = handler;
        }
        /**
         * Callback when gUM fails.
         * First param is RtcSession object.
         * Second param is the error.
         */

    }, {
        key: 'onGumError',
        set: function set(handler) {
            this._onGumError = handler;
        }
        /**
         * Callback if failed initializing local resources
         * First param is RtcSession object.
         */

    }, {
        key: 'onSessionFailed',
        set: function set(handler) {
            this._onSessionFailed = handler;
        }
        /**
         * Callback after local user media stream is added to the session.
         * First param is RtcSession object.
         * Second param is media stream
         */

    }, {
        key: 'onLocalStreamAdded',
        set: function set(handler) {
            this._onLocalStreamAdded = handler;
        }
        /**
         * Callback when all local resources are ready. Establishing signaling chanel and ICE collection happens at the same time after this.
         * First param is RtcSession object.
         */

    }, {
        key: 'onSessionInitialized',
        set: function set(handler) {
            this._onSessionInitialized = handler;
        }
        /**
         * Callback when signaling channel is established.
         * RTC session will move forward only if onSignalingConnected and onIceCollectionComplete are both called.
         *
         * First param is RtcSession object.
         */

    }, {
        key: 'onSignalingConnected',
        set: function set(handler) {
            this._onSignalingConnected = handler;
        }
        /**
         * Callback when ICE collection completes either because there is no more candidate or collection timed out.
         * RTC session will move forward only if onSignalingConnected and onIceCollectionComplete are both called.
         *
         * First param is RtcSession object.
         * Second param is boolean, TRUE - ICE collection timed out.
         * Third param is number of candidates collected.
         */

    }, {
        key: 'onIceCollectionComplete',
        set: function set(handler) {
            this._onIceCollectionComplete = handler;
        }
        /**
         * Callback when signaling channel is established and ICE collection completed with at least one candidate.
         * First param is RtcSession object.
         */

    }, {
        key: 'onSignalingStarted',
        set: function set(handler) {
            this._onSignalingStarted = handler;
        }
        /**
         * Callback when the call is established (handshaked and media stream should be flowing)
         * First param is RtcSession object.
         */

    }, {
        key: 'onSessionConnected',
        set: function set(handler) {
            this._onSessionConnected = handler;
        }
        /**
         * Callback after remote media stream is added to the session.
         * This could be called multiple times with the same stream if multiple tracks are included in the same stream.
         *
         * First param is RtcSession object.
         * Second param is media stream track.
         */

    }, {
        key: 'onRemoteStreamAdded',
        set: function set(handler) {
            this._onRemoteStreamAdded = handler;
        }
        /**
         * Callback when the hangup is initiated (implies the call was successfully established).
         * First param is RtcSession object.
         */

    }, {
        key: 'onSessionCompleted',
        set: function set(handler) {
            this._onSessionCompleted = handler;
        }
        /**
         * Callback after session is cleaned up, no matter if the call was successfully established or not.
         * First param is RtcSession object.
         * Second param is SessionReport object.
         */

    }, {
        key: 'onSessionDestroyed',
        set: function set(handler) {
            this._onSessionDestroyed = handler;
        }
    }, {
        key: 'enableAudio',
        set: function set(flag) {
            this._enableAudio = flag;
        }
    }, {
        key: 'echoCancellation',
        set: function set(flag) {
            this._echoCancellation = flag;
        }
    }, {
        key: 'enableVideo',
        set: function set(flag) {
            this._enableVideo = flag;
        }
    }, {
        key: 'maxVideoFrameRate',
        set: function set(frameRate) {
            this._maxVideoFrameRate = frameRate;
        }
    }, {
        key: 'minVideoFrameRate',
        set: function set(frameRate) {
            this._minVideoFrameRate = frameRate;
        }
    }, {
        key: 'videoFrameRate',
        set: function set(frameRate) {
            this._videoFrameRate = frameRate;
        }
    }, {
        key: 'maxVideoWidth',
        set: function set(width) {
            this._maxVideoWidth = width;
        }
    }, {
        key: 'minVideoWidth',
        set: function set(width) {
            this._minVideoWidth = width;
        }
    }, {
        key: 'idealVideoWidth',
        set: function set(width) {
            this._idealVideoWidth = width;
        }
    }, {
        key: 'maxVideoHeight',
        set: function set(height) {
            this._maxVideoHeight = height;
        }
    }, {
        key: 'minVideoHeight',
        set: function set(height) {
            this._minVideoHeight = height;
        }
    }, {
        key: 'idealVideoHeight',
        set: function set(height) {
            this._idealVideoHeight = height;
        }
    }, {
        key: 'facingMode',
        set: function set(mode) {
            this._facingMode = mode;
        }
    }, {
        key: 'remoteAudioElement',
        set: function set(element) {
            this._remoteAudioElement = element;
        }
    }, {
        key: 'remoteVideoElement',
        set: function set(element) {
            this._remoteVideoElement = element;
        }
        /**
         * Override the default signaling connect time out.
         */

    }, {
        key: 'signalingConnectTimeout',
        set: function set(ms) {
            this._signalingConnectTimeout = ms;
        }
        /**
         * Override the default ICE collection time limit.
         */

    }, {
        key: 'iceTimeoutMillis',
        set: function set(timeoutMillis) {
            this._iceTimeoutMillis = timeoutMillis;
        }
        /**
         * Override the default GUM timeout time limit.
         */

    }, {
        key: 'gumTimeoutMillis',
        set: function set(timeoutMillis) {
            this._gumTimeoutMillis = timeoutMillis;
        }
        /**
         * connect-rtc-js initiate the handshaking with all browser supported codec by default, Amazon Connect service will choose the codec according to its preference setting.
         * Setting this attribute will force connect-rtc-js to only use specified codec.
         * WARNING: Setting this to unsupported codec will cause the failure of handshaking.
         * Supported audio codecs: opus.
         */

    }, {
        key: 'forceAudioCodec',
        set: function set(audioCodec) {
            this._forceAudioCodec = audioCodec;
        }

        /**
         * connect-rtc-js initiate the handshaking with all browser supported codec by default, Amazon Connect service will choose the codec according to its preference setting.
         * Setting this attribute will force connect-rtc-js to only use specified codec.
         * WARNING: Setting this to unsupported codec will cause the failure of handshaking.
         * Supported video codecs: VP8, VP9, H264.
         */

    }, {
        key: 'forceVideoCodec',
        set: function set(videoCodec) {
            this._forceVideoCodec = videoCodec;
        }

        /**
         * connect-rtc-js disables OPUS DTX by default because it harms audio quality.
         * @param flag boolean
         */

    }, {
        key: 'enableOpusDtx',
        set: function set(flag) {
            this._enableOpusDtx = flag;
        }
    }]);
    return RtcSession;
}();

exports.default = RtcSession;

},{"./exceptions":135,"./rtc_const":136,"./rtp-stats":139,"./session_report":140,"./signaling":141,"./strategies/CCPInitiationStrategyInterface":142,"./strategies/StandardStrategy":144,"./utils":145,"babel-runtime/helpers/asyncToGenerator":10,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12,"babel-runtime/helpers/get":13,"babel-runtime/helpers/inherits":14,"babel-runtime/helpers/possibleConstructorReturn":15,"babel-runtime/helpers/typeof":16,"babel-runtime/regenerator":19,"sdp":118,"uuid/v4":121}],139:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

exports.extractMediaStatsFromStats = extractMediaStatsFromStats;

var _utils = require('./utils');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function extractMediaStatsFromStats(timestamp, stats, streamType) {
    var extractedStats = null;
    var reportType = null;

    stats.forEach(function (statsReport) {
        if (statsReport) {
            if (statsReport.type === 'inbound-rtp' && streamType === 'audio_input') {
                // inbound-rtp: Stats for stream from Server to CCP, as seen on the browser
                reportType = statsReport.type;
                extractedStats = {
                    timestamp: timestamp,
                    packetsLost: statsReport.packetsLost,
                    // packetsCount: number of packet received by CCP, as seen on the browser
                    packetsCount: statsReport.packetsReceived,
                    jbMilliseconds: Math.floor((0, _utils.when_defined)(statsReport.jitter, 0) * 1000),
                    // Multiplying audioLevel by 32768 aligns its value with the legacy getStats API.
                    audioLevel: (0, _utils.is_defined)(statsReport.audioLevel) ? Math.floor(statsReport.audioLevel * 32768) : null
                };
            } else if (statsReport.type === 'outbound-rtp' && streamType === 'audio_output') {
                // outbound-rtp: Stats for stream from CCP to Server, as seen on the browser
                extractedStats = extractedStats || {};
                // packetsCount: number of packet sent by CCP, as seen on the browser
                extractedStats.packetsCount = statsReport.packetsSent;
            } else if (statsReport.type === 'media-source' && streamType === 'audio_output') {
                extractedStats = extractedStats || {};
                // Multiplying audioLevel by 32768 aligns its value with the legacy getStats API.
                extractedStats.audioLevel = (0, _utils.is_defined)(statsReport.audioLevel) ? Math.floor(statsReport.audioLevel * 32768) : null;
            } else if (statsReport.type === 'remote-inbound-rtp' && streamType === 'audio_output') {
                // remote-inbound-rtp: Stats for stream from CCP to Server, as seen on Server side
                reportType = statsReport.type;
                extractedStats = extractedStats || {};
                extractedStats.timestamp = timestamp;
                extractedStats.packetsLost = statsReport.packetsLost;
                extractedStats.rttMilliseconds = (0, _utils.is_defined)(statsReport.roundTripTime) ? Math.floor(statsReport.roundTripTime * 1000) : null;
                extractedStats.jbMilliseconds = Math.floor((0, _utils.when_defined)(statsReport.jitter, 0) * 1000);
            }
        }
    });

    return extractedStats ? new MediaRtpStats(extractedStats, reportType, streamType) : null;
}

/**
 * Basic RTP statistics object, represents statistics of an audio or video stream.
 */
/**
 * Extract rtp stats of specified stream from RTCStatsReport
 * Chrome reports all stream stats in statsReports whereas firefox reports only single stream stats in report
 * StreamType is passed only to pull right stream stats audio_input or audio_output.
 */

var MediaRtpStats = function () {
    function MediaRtpStats(paramsIn, statsReportType, streamType) {
        (0, _classCallCheck3.default)(this, MediaRtpStats);

        var params = paramsIn || {};

        this._timestamp = params.timestamp || new Date().getTime();
        this._packetsLost = (0, _utils.when_defined)(params.packetsLost);
        this._packetsCount = (0, _utils.when_defined)(params.packetsCount);
        this._audioLevel = (0, _utils.when_defined)(params.audioLevel);
        this._procMilliseconds = (0, _utils.when_defined)(params.procMilliseconds);
        this._rttMilliseconds = (0, _utils.when_defined)(params.rttMilliseconds);
        this._jbMilliseconds = (0, _utils.when_defined)(params.jbMilliseconds);
        this._bytesSent = (0, _utils.when_defined)(params.bytesSent);
        this._bytesReceived = (0, _utils.when_defined)(params.bytesReceived);
        this._framesEncoded = (0, _utils.when_defined)(params.framesEncoded);
        this._framesDecoded = (0, _utils.when_defined)(params.framesDecoded);
        this._frameRateSent = (0, _utils.when_defined)(params.frameRateSent);
        this._frameRateReceived = (0, _utils.when_defined)(params.frameRateReceived);
        this._statsReportType = statsReportType || params._statsReportType || "unknown";
        this._streamType = streamType || params.streamType || "unknown";
    }

    /** {number} number of packets sent to the channel */


    (0, _createClass3.default)(MediaRtpStats, [{
        key: 'packetsCount',
        get: function get() {
            return this._packetsCount;
        }
        /** {number} number of packets lost after travelling through the channel */

    }, {
        key: 'packetsLost',
        get: function get() {
            return this._packetsLost;
        }
        /** {number} number of packets lost after travelling through the channel */

    }, {
        key: 'packetLossPercentage',
        get: function get() {
            return this._packetsCount > 0 ? this._packetsLost / this._packetsCount : 0;
        }
        /** Audio volume level
         * Currently firefox doesn't provide audio level in rtp stats.
         */

    }, {
        key: 'audioLevel',
        get: function get() {
            return this._audioLevel;
        }
        /** Timestamp when stats are collected. */

    }, {
        key: 'timestamp',
        get: function get() {
            return this._timestamp;
        }
        /** {number} Processing delay calculated by time to process packet header */

    }, {
        key: 'procMilliseconds',
        get: function get() {
            return this._procMilliseconds;
        }
        /** {number} Round trip time calculated with RTCP reports */

    }, {
        key: 'rttMilliseconds',
        get: function get() {
            return this._rttMilliseconds;
        }
        /** {number} Statistical variance of RTP data packet inter-arrival time */

    }, {
        key: 'jbMilliseconds',
        get: function get() {
            return this._jbMilliseconds;
        }
        /** {number} number of bytes sent to the channel*/

    }, {
        key: 'bytesSent',
        get: function get() {
            return this._bytesSent;
        }
        /** {number} number of bytes received from the channel*/

    }, {
        key: 'bytesReceived',
        get: function get() {
            return this._bytesReceived;
        }
        /** {number} number of video frames encoded*/

    }, {
        key: 'framesEncoded',
        get: function get() {
            return this._framesEncoded;
        }
        /** {number} number of video frames decoded*/

    }, {
        key: 'framesDecoded',
        get: function get() {
            return this._framesDecoded;
        }
        /** {number} frames per second sent to the channel*/

    }, {
        key: 'frameRateSent',
        get: function get() {
            return this._frameRateSent;
        }
        /** {number} frames per second received from the channel*/

    }, {
        key: 'frameRateReceived',
        get: function get() {
            return this._frameRateReceived;
        }
        /** {string} the type of the stats report */

    }, {
        key: 'statsReportType',
        get: function get() {
            return this._statsReportType;
        }
        /** {string} the type of the stream */

    }, {
        key: 'streamType',
        get: function get() {
            return this._streamType;
        }
    }]);
    return MediaRtpStats;
}();

},{"./utils":145,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],140:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.SessionReport = undefined;

var _classCallCheck2 = require("babel-runtime/helpers/classCallCheck");

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require("babel-runtime/helpers/createClass");

var _createClass3 = _interopRequireDefault(_createClass2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */

var SessionReport = exports.SessionReport = function () {
    /**
     * @class Prototype for tracking various RTC session report
     * @constructs
     */
    function SessionReport() {
        (0, _classCallCheck3.default)(this, SessionReport);

        this._sessionStartTime = null;
        this._sessionEndTime = null;
        this._gumTimeMillis = null;
        this._initializationTimeMillis = null;
        this._iceCollectionTimeMillis = null;
        this._signallingConnectTimeMillis = null;
        this._handshakingTimeMillis = null;
        this._preTalkingTimeMillis = null;
        this._talkingTimeMillis = null;
        this._iceConnectionsLost = 0;
        this._iceConnectionsFailed = null;
        this._peerConnectionFailed = null;
        this._cleanupTimeMillis = null;
        this._iceCollectionFailure = null;
        this._signallingConnectionFailure = null;
        this._handshakingFailure = null;
        this._gumOtherFailure = null;
        this._gumTimeoutFailure = null;
        this._createOfferFailure = null;
        this._setLocalDescriptionFailure = null;
        this._userBusyFailure = null;
        this._invalidRemoteSDPFailure = null;
        this._noRemoteIceCandidateFailure = null;
        this._setRemoteDescriptionFailure = null;
        this._streamStats = [];
        this._rtcJsVersion = "1.1.23";
    }
    /**
     *Timestamp when RTCSession started.
     */


    (0, _createClass3.default)(SessionReport, [{
        key: "sessionStartTime",
        get: function get() {
            return this._sessionStartTime;
        }
        /**
         * Timestamp when RTCSession ended.
         */
        ,
        set: function set(value) {
            this._sessionStartTime = value;
        }
    }, {
        key: "sessionEndTime",
        get: function get() {
            return this._sessionEndTime;
        }
        /**
         * Time taken for grabbing user microphone at the time of connecting RTCSession.
         */
        ,
        set: function set(value) {
            this._sessionEndTime = value;
        }
    }, {
        key: "gumTimeMillis",
        get: function get() {
            return this._gumTimeMillis;
        }
        /**
         * Time taken for session initialization in millis. Includes time spent in GrabLocalMedia, SetLocalSDP states.
         */
        ,
        set: function set(value) {
            this._gumTimeMillis = value;
        }
    }, {
        key: "initializationTimeMillis",
        get: function get() {
            return this._initializationTimeMillis;
        }
        /**
         * Time spent on ICECollection in millis.
         */
        ,
        set: function set(value) {
            this._initializationTimeMillis = value;
        }
    }, {
        key: "iceCollectionTimeMillis",
        get: function get() {
            return this._iceCollectionTimeMillis;
        }
        /**
         * Time taken for connecting the signalling in millis.
         */
        ,
        set: function set(value) {
            this._iceCollectionTimeMillis = value;
        }
    }, {
        key: "signallingConnectTimeMillis",
        get: function get() {
            return this._signallingConnectTimeMillis;
        }
        /**
         * Times spent from RTCSession connection until entering Talking state in millis.
         */
        ,
        set: function set(value) {
            this._signallingConnectTimeMillis = value;
        }
    }, {
        key: "preTalkingTimeMillis",
        get: function get() {
            return this._preTalkingTimeMillis;
        }
        /**
         *  Times spent in completing handshaking process of the RTCSession in millis.
         */
        ,
        set: function set(value) {
            this._preTalkingTimeMillis = value;
        }
    }, {
        key: "handshakingTimeMillis",
        get: function get() {
            return this._handshakingTimeMillis;
        }
        /**
         *  Times spent in Talking state in millis.
         */
        ,
        set: function set(value) {
            this._handshakingTimeMillis = value;
        }
    }, {
        key: "talkingTimeMillis",
        get: function get() {
            return this._talkingTimeMillis;
        }
        /**
         * How many times the RTCSession has lost ICE connection in talking state.
         */
        ,
        set: function set(value) {
            this._talkingTimeMillis = value;
        }
    }, {
        key: "iceConnectionsLost",
        get: function get() {
            return this._iceConnectionsLost;
        }
        /**
         * Tells if the RTCSession has failed RTCPeerConnection.iceConnectionState
         */
        ,
        set: function set(value) {
            this._iceConnectionsLost = value;
        }
    }, {
        key: "iceConnectionsFailed",
        get: function get() {
            return this._iceConnectionsFailed;
        }
        /**
         * Tells if the RTCSession has failed RTCPeerConnection.connectionState
         */
        ,
        set: function set(value) {
            this._iceConnectionsFailed = value;
        }
    }, {
        key: "peerConnectionFailed",
        get: function get() {
            return this._peerConnectionFailed;
        }
        /**
         * Times spent in Cleanup state in millis
         */
        ,
        set: function set(value) {
            this._peerConnectionFailed = value;
        }
    }, {
        key: "cleanupTimeMillis",
        get: function get() {
            return this._cleanupTimeMillis;
        }
        /**
         * Tells if the RTCSession fails in ICECollection.
         */
        ,
        set: function set(value) {
            this._cleanupTimeMillis = value;
        }
    }, {
        key: "iceCollectionFailure",
        get: function get() {
            return this._iceCollectionFailure;
        }
        /**
         * Tells if the RTCSession failed in signalling connect stage.
         */
        ,
        set: function set(value) {
            this._iceCollectionFailure = value;
        }
    }, {
        key: "signallingConnectionFailure",
        get: function get() {
            return this._signallingConnectionFailure;
        }
        /**
         * Handshaking failure of the RTCSession
         */
        ,
        set: function set(value) {
            this._signallingConnectionFailure = value;
        }
    }, {
        key: "handshakingFailure",
        get: function get() {
            return this._handshakingFailure;
        }
        /**
         * Gum failed due to timeout at the time of new RTCSession connection
         */
        ,
        set: function set(value) {
            this._handshakingFailure = value;
        }
    }, {
        key: "gumTimeoutFailure",
        get: function get() {
            return this._gumTimeoutFailure;
        }
        /**
         * Gum failed due to other reasons (other than Timeout)
         */
        ,
        set: function set(value) {
            this._gumTimeoutFailure = value;
        }
    }, {
        key: "gumOtherFailure",
        get: function get() {
            return this._gumOtherFailure;
        }
        /**
         * RTC Session failed in create Offer state.
         */
        ,
        set: function set(value) {
            this._gumOtherFailure = value;
        }
    }, {
        key: "createOfferFailure",
        get: function get() {
            return this._createOfferFailure;
        }
        /**
         * Tells if setLocalDescription failed for the RTC Session.
         */
        ,
        set: function set(value) {
            this._createOfferFailure = value;
        }
    }, {
        key: "setLocalDescriptionFailure",
        get: function get() {
            return this._setLocalDescriptionFailure;
        }
        /**
         * Tells if handshaking failed due to user busy case,
         * happens when multiple softphone calls are initiated at same time.
         */
        ,
        set: function set(value) {
            this._setLocalDescriptionFailure = value;
        }
    }, {
        key: "userBusyFailure",
        get: function get() {
            return this._userBusyFailure;
        }
        /**
         * Tells it remote SDP is invalid.
         */
        ,
        set: function set(value) {
            this._userBusyFailure = value;
        }
    }, {
        key: "invalidRemoteSDPFailure",
        get: function get() {
            return this._invalidRemoteSDPFailure;
        }
        /**
         * Tells if the setRemoteDescription failed for the RTC Session.
         */
        ,
        set: function set(value) {
            this._invalidRemoteSDPFailure = value;
        }
    }, {
        key: "setRemoteDescriptionFailure",
        get: function get() {
            return this._setRemoteDescriptionFailure;
        }
        /**
         * A failure case when there is no RemoteIceCandidate.
         */
        ,
        set: function set(value) {
            this._setRemoteDescriptionFailure = value;
        }
    }, {
        key: "noRemoteIceCandidateFailure",
        get: function get() {
            return this._noRemoteIceCandidateFailure;
        }
        /**
         * Statistics for each stream(audio-in, audio-out, video-in, video-out) of the RTCSession.
         */
        ,
        set: function set(value) {
            this._noRemoteIceCandidateFailure = value;
        }
    }, {
        key: "streamStats",
        get: function get() {
            return this._streamStats;
        }
        /**
         * get current connect-rtc-js version
         */
        ,
        set: function set(value) {
            this._streamStats = value;
        }
    }, {
        key: "rtcJsVersion",
        get: function get() {
            return this._rtcJsVersion;
        },
        set: function set(value) {
            this._rtcJsVersion = value;
        }
    }]);
    return SessionReport;
}();

},{"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],141:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.FailedState = exports.DisconnectedState = exports.PendingLocalHangupState = exports.PendingRemoteHangupState = exports.PendingReconnectState = exports.TalkingState = exports.PendingAcceptAckState = exports.PendingAcceptState = exports.PendingAnswerState = exports.PendingInviteState = exports.PendingConnectState = exports.FailOnTimeoutState = exports.SignalingState = undefined;

var _regenerator = require('babel-runtime/regenerator');

var _regenerator2 = _interopRequireDefault(_regenerator);

var _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _utils = require('./utils');

var _rtc_const = require('./rtc_const');

var _exceptions = require('./exceptions');

var _v = require('uuid/v4');

var _v2 = _interopRequireDefault(_v);

var _virtual_wss_connection_manager = require('./virtual_wss_connection_manager');

var _virtual_wss_connection_manager2 = _interopRequireDefault(_virtual_wss_connection_manager);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var CONNECT_MAX_RETRIES = 3;

/**
 * Abstract signaling state class.
 */
/**
 * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */

var SignalingState = exports.SignalingState = function () {
    /**
     * @param {AmznRtcSignaling} signaling Signaling object.
     */
    function SignalingState(signaling) {
        (0, _classCallCheck3.default)(this, SignalingState);

        this._signaling = signaling;
        this._createTime = new Date().getTime();
    }

    (0, _createClass3.default)(SignalingState, [{
        key: 'setStateTimeout',
        value: function setStateTimeout(timeoutMs) {
            setTimeout((0, _utils.hitch)(this, this._onTimeoutChecked), timeoutMs);
        }
    }, {
        key: 'onEnter',
        value: function onEnter() {}
    }, {
        key: '_onTimeoutChecked',
        value: function _onTimeoutChecked() {
            if (this.isCurrentState) {
                this.onTimeout();
            }
        }
    }, {
        key: 'onTimeout',
        value: function onTimeout() {
            throw new _exceptions.UnsupportedOperation();
        }
    }, {
        key: 'transit',
        value: function transit(newState) {
            this._signaling.transit(newState);
        }
    }, {
        key: 'onExit',
        value: function onExit() {}
    }, {
        key: 'onOpen',
        value: function onOpen() {
            throw new _exceptions.UnsupportedOperation('onOpen not supported by ' + this.name);
        }
    }, {
        key: 'onError',
        value: function onError() {
            this.channelDown();
        }
    }, {
        key: 'onClose',
        value: function onClose() {
            this.channelDown();
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            throw new _exceptions.UnsupportedOperation('channelDown not supported by ' + this.name);
        }
    }, {
        key: 'onRpcMsg',
        value: function onRpcMsg(rpcMsg) {
            // eslint-disable-line no-unused-vars
            throw new _exceptions.UnsupportedOperation('onRpcMsg not supported by ' + this.name);
        }
    }, {
        key: 'invite',
        value: function invite(sdp, iceCandidates) {
            // eslint-disable-line no-unused-vars
            throw new _exceptions.UnsupportedOperation('invite not supported by ' + this.name);
        }
    }, {
        key: 'accept',
        value: function accept() {
            throw new _exceptions.UnsupportedOperation('accept not supported by ' + this.name);
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            throw new _exceptions.UnsupportedOperation('hangup not supported by ' + this.name);
        }
    }, {
        key: 'isCurrentState',
        get: function get() {
            return this === this._signaling.state;
        }
    }, {
        key: 'name',
        get: function get() {
            return "SignalingState";
        }
    }, {
        key: 'logger',
        get: function get() {
            return this._signaling._logger;
        }
    }]);
    return SignalingState;
}();

var FailOnTimeoutState = exports.FailOnTimeoutState = function (_SignalingState) {
    (0, _inherits3.default)(FailOnTimeoutState, _SignalingState);

    function FailOnTimeoutState(signaling, timeoutMs) {
        (0, _classCallCheck3.default)(this, FailOnTimeoutState);

        var _this = (0, _possibleConstructorReturn3.default)(this, (FailOnTimeoutState.__proto__ || Object.getPrototypeOf(FailOnTimeoutState)).call(this, signaling));

        _this._timeoutMs = timeoutMs;
        return _this;
    }

    (0, _createClass3.default)(FailOnTimeoutState, [{
        key: 'onEnter',
        value: function onEnter() {
            this.setStateTimeout(this._timeoutMs);
        }
    }, {
        key: 'onTimeout',
        value: function onTimeout() {
            this.transit(new FailedState(this._signaling, new _exceptions.Timeout()));
        }
    }, {
        key: 'name',
        get: function get() {
            return "FailOnTimeoutState";
        }
    }]);
    return FailOnTimeoutState;
}(SignalingState);

var PendingConnectState = exports.PendingConnectState = function (_FailOnTimeoutState) {
    (0, _inherits3.default)(PendingConnectState, _FailOnTimeoutState);

    function PendingConnectState(signaling, timeoutMs, initialStartTimeIn, retriesIn) {
        (0, _classCallCheck3.default)(this, PendingConnectState);

        var _this2 = (0, _possibleConstructorReturn3.default)(this, (PendingConnectState.__proto__ || Object.getPrototypeOf(PendingConnectState)).call(this, signaling, timeoutMs));

        _this2._initialStartTime = initialStartTimeIn || new Date().getTime();
        _this2._retries = retriesIn || 0;
        return _this2;
    }

    (0, _createClass3.default)(PendingConnectState, [{
        key: 'onOpen',
        value: function onOpen() {
            this.transit(new PendingInviteState(this._signaling));
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            var now = new Date().getTime();
            var untilTimeoutMs = this._initialStartTime + this._timeoutMs - now;
            if (untilTimeoutMs > 0 && ++this._retries < CONNECT_MAX_RETRIES) {
                this._signaling._connect();
                this.transit(new PendingConnectState(this._signaling, untilTimeoutMs, this._initialStartTime, this._retries));
            } else {
                this.transit(new FailedState(this._signaling, new Error('channelDown')));
            }
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingConnectState";
        }
    }]);
    return PendingConnectState;
}(FailOnTimeoutState);

var PendingInviteState = exports.PendingInviteState = function (_SignalingState2) {
    (0, _inherits3.default)(PendingInviteState, _SignalingState2);

    function PendingInviteState() {
        (0, _classCallCheck3.default)(this, PendingInviteState);
        return (0, _possibleConstructorReturn3.default)(this, (PendingInviteState.__proto__ || Object.getPrototypeOf(PendingInviteState)).apply(this, arguments));
    }

    (0, _createClass3.default)(PendingInviteState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            new Promise(function notifyConnected(resolve) {
                self._signaling._connectedHandler();
                resolve();
            });
        }
    }, {
        key: 'invite',
        value: function invite(sdp, iceCandidates) {
            var self = this;
            var inviteId = (0, _v2.default)();

            var inviteParams = {
                sdp: sdp,
                candidates: iceCandidates,
                callContextToken: self._signaling._contactToken
            };
            self.logger.log('Sending SDP', (0, _utils.getRedactedSdp)(sdp));
            self._signaling._wss.send(JSON.stringify({
                jsonrpc: '2.0',
                method: _rtc_const.INVITE_METHOD_NAME,
                params: inviteParams,
                id: inviteId
            }));
            self.transit(new PendingAnswerState(self._signaling, inviteId));
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            this.transit(new FailedState(this._signaling));
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingInviteState";
        }
    }]);
    return PendingInviteState;
}(SignalingState);

var PendingAnswerState = exports.PendingAnswerState = function (_FailOnTimeoutState2) {
    (0, _inherits3.default)(PendingAnswerState, _FailOnTimeoutState2);

    function PendingAnswerState(signaling, inviteId) {
        (0, _classCallCheck3.default)(this, PendingAnswerState);

        var _this4 = (0, _possibleConstructorReturn3.default)(this, (PendingAnswerState.__proto__ || Object.getPrototypeOf(PendingAnswerState)).call(this, signaling, _rtc_const.MAX_INVITE_DELAY_MS));

        _this4._inviteId = inviteId;
        return _this4;
    }

    (0, _createClass3.default)(PendingAnswerState, [{
        key: 'onRpcMsg',
        value: function onRpcMsg(msg) {
            var self = this;
            if (msg.id === this._inviteId) {
                if (msg.error || !msg.result) {
                    this.transit(new FailedState(this._signaling, self.translateInviteError(msg)));
                } else {
                    new Promise(function notifyAnswered(resolve) {
                        self.logger.log('Received SDP', (0, _utils.getRedactedSdp)(msg.result.sdp));
                        self._signaling._answeredHandler(msg.result.sdp, msg.result.candidates);
                        resolve();
                    });
                    this.transit(new PendingAcceptState(this._signaling, this._signaling._autoAnswer));
                }
            }
        }
    }, {
        key: 'translateInviteError',
        value: function translateInviteError(msg) {
            if (msg.error && msg.error.code == 486) {
                return new _exceptions.BusyException(msg.error.message);
            } else if (msg.error && msg.error.code == 404) {
                return new _exceptions.CallNotFoundException(msg.error.message);
            } else {
                return new _exceptions.UnknownSignalingError();
            }
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingAnswerState";
        }
    }]);
    return PendingAnswerState;
}(FailOnTimeoutState);

var PendingAcceptState = exports.PendingAcceptState = function (_SignalingState3) {
    (0, _inherits3.default)(PendingAcceptState, _SignalingState3);

    function PendingAcceptState(signaling, autoAnswer) {
        (0, _classCallCheck3.default)(this, PendingAcceptState);

        var _this5 = (0, _possibleConstructorReturn3.default)(this, (PendingAcceptState.__proto__ || Object.getPrototypeOf(PendingAcceptState)).call(this, signaling));

        _this5._autoAnswer = autoAnswer;
        return _this5;
    }

    (0, _createClass3.default)(PendingAcceptState, [{
        key: 'onEnter',
        value: function onEnter() {
            if (this._autoAnswer) {
                this.accept();
            }
        }
    }, {
        key: 'accept',
        value: function accept() {
            this.sendAcceptRequest();
            this.transit(new TalkingState(this._signaling));
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            this.transit(new FailedState(this._signaling));
        }
    }, {
        key: 'sendAcceptRequest',
        value: function () {
            var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {
                var acceptId;
                return _regenerator2.default.wrap(function _callee$(_context) {
                    while (1) {
                        switch (_context.prev = _context.next) {
                            case 0:
                                acceptId = (0, _v2.default)();

                                this._signaling._wss.send(JSON.stringify({
                                    jsonrpc: '2.0',
                                    method: _rtc_const.ACCEPT_METHOD_NAME,
                                    params: {},
                                    id: acceptId
                                }));

                            case 2:
                            case 'end':
                                return _context.stop();
                        }
                    }
                }, _callee, this);
            }));

            function sendAcceptRequest() {
                return _ref.apply(this, arguments);
            }

            return sendAcceptRequest;
        }()
    }, {
        key: 'name',
        get: function get() {
            return "PendingAcceptState";
        }
    }]);
    return PendingAcceptState;
}(SignalingState);

var PendingAcceptAckState = exports.PendingAcceptAckState = function (_FailOnTimeoutState3) {
    (0, _inherits3.default)(PendingAcceptAckState, _FailOnTimeoutState3);

    function PendingAcceptAckState(signaling, acceptId) {
        (0, _classCallCheck3.default)(this, PendingAcceptAckState);

        var _this6 = (0, _possibleConstructorReturn3.default)(this, (PendingAcceptAckState.__proto__ || Object.getPrototypeOf(PendingAcceptAckState)).call(this, signaling, _rtc_const.MAX_ACCEPT_BYE_DELAY_MS));

        _this6._acceptId = acceptId;
        return _this6;
    }

    (0, _createClass3.default)(PendingAcceptAckState, [{
        key: 'onRpcMsg',
        value: function onRpcMsg(msg) {
            if (msg.id === this._acceptId) {
                if (msg.error) {
                    this.transit(new FailedState(this._signaling));
                } else {
                    this._signaling._clientToken = msg.result.clientToken;
                    this.transit(new TalkingState(this._signaling));
                }
            }
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingAcceptAckState";
        }
    }]);
    return PendingAcceptAckState;
}(FailOnTimeoutState);

var TalkingState = exports.TalkingState = function (_SignalingState4) {
    (0, _inherits3.default)(TalkingState, _SignalingState4);

    function TalkingState() {
        (0, _classCallCheck3.default)(this, TalkingState);
        return (0, _possibleConstructorReturn3.default)(this, (TalkingState.__proto__ || Object.getPrototypeOf(TalkingState)).apply(this, arguments));
    }

    (0, _createClass3.default)(TalkingState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            new Promise(function notifyHandshaked(resolve) {
                self._signaling._handshakedHandler();
                resolve();
            });
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            var byeId = (0, _v2.default)();
            this._signaling._wss.send(JSON.stringify({
                jsonrpc: '2.0',
                method: _rtc_const.BYE_METHOD_NAME,
                params: { callContextToken: this._signaling._contactToken },
                id: byeId
            }));
            this.transit(new PendingRemoteHangupState(this._signaling, byeId));
        }
    }, {
        key: 'onRpcMsg',
        value: function onRpcMsg(msg) {
            if (msg.method === _rtc_const.BYE_METHOD_NAME) {
                this.transit(new PendingLocalHangupState(this._signaling, msg.id));
            } else if (msg.method === 'renewClientToken') {
                this._signaling._clientToken = msg.params.clientToken;
            }
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            this._signaling._reconnect();
            this._signaling.transit(new PendingReconnectState(this._signaling));
        }
    }, {
        key: 'name',
        get: function get() {
            return "TalkingState";
        }
    }]);
    return TalkingState;
}(SignalingState);

var PendingReconnectState = exports.PendingReconnectState = function (_FailOnTimeoutState4) {
    (0, _inherits3.default)(PendingReconnectState, _FailOnTimeoutState4);

    function PendingReconnectState(signaling) {
        (0, _classCallCheck3.default)(this, PendingReconnectState);
        return (0, _possibleConstructorReturn3.default)(this, (PendingReconnectState.__proto__ || Object.getPrototypeOf(PendingReconnectState)).call(this, signaling, _rtc_const.DEFAULT_CONNECT_TIMEOUT_MS));
    }

    (0, _createClass3.default)(PendingReconnectState, [{
        key: 'onOpen',
        value: function onOpen() {
            this.transit(new TalkingState(this._signaling));
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            this.transit(new FailedState(this._signaling));
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingReconnectState";
        }
    }]);
    return PendingReconnectState;
}(FailOnTimeoutState);

var PendingRemoteHangupState = exports.PendingRemoteHangupState = function (_FailOnTimeoutState5) {
    (0, _inherits3.default)(PendingRemoteHangupState, _FailOnTimeoutState5);

    function PendingRemoteHangupState(signaling, byeId) {
        (0, _classCallCheck3.default)(this, PendingRemoteHangupState);

        var _this9 = (0, _possibleConstructorReturn3.default)(this, (PendingRemoteHangupState.__proto__ || Object.getPrototypeOf(PendingRemoteHangupState)).call(this, signaling, _rtc_const.MAX_ACCEPT_BYE_DELAY_MS));

        _this9._byeId = byeId;
        return _this9;
    }

    (0, _createClass3.default)(PendingRemoteHangupState, [{
        key: 'onRpcMsg',
        value: function onRpcMsg(msg) {
            if (msg.id === this._byeId || msg.method === _rtc_const.BYE_METHOD_NAME) {
                this.transit(new DisconnectedState(this._signaling));
            }
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingRemoteHangupState";
        }
    }]);
    return PendingRemoteHangupState;
}(FailOnTimeoutState);

var PendingLocalHangupState = exports.PendingLocalHangupState = function (_SignalingState5) {
    (0, _inherits3.default)(PendingLocalHangupState, _SignalingState5);

    function PendingLocalHangupState(signaling, byeId) {
        (0, _classCallCheck3.default)(this, PendingLocalHangupState);

        var _this10 = (0, _possibleConstructorReturn3.default)(this, (PendingLocalHangupState.__proto__ || Object.getPrototypeOf(PendingLocalHangupState)).call(this, signaling));

        _this10._byeId = byeId;
        return _this10;
    }

    (0, _createClass3.default)(PendingLocalHangupState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            new Promise(function notifyRemoteHungup(resolve) {
                self._signaling._remoteHungupHandler();
                resolve();
            });
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            var self = this;
            self._signaling._wss.send(JSON.stringify({
                jsonrpc: '2.0',
                result: {},
                id: self._byeId
            }));
            self.transit(new DisconnectedState(self._signaling));
        }
    }, {
        key: 'onRpcMsg',
        value: function onRpcMsg() {
            //Do nothing
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            this.transit(new DisconnectedState(this._signaling));
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingLocalHangupState";
        }
    }]);
    return PendingLocalHangupState;
}(SignalingState);

var DisconnectedState = exports.DisconnectedState = function (_SignalingState6) {
    (0, _inherits3.default)(DisconnectedState, _SignalingState6);

    function DisconnectedState() {
        (0, _classCallCheck3.default)(this, DisconnectedState);
        return (0, _possibleConstructorReturn3.default)(this, (DisconnectedState.__proto__ || Object.getPrototypeOf(DisconnectedState)).apply(this, arguments));
    }

    (0, _createClass3.default)(DisconnectedState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            new Promise(function notifyDisconnected(resolve) {
                self._signaling._disconnectedHandler();
                resolve();
            });
            this._signaling._wss.close();
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            //Do nothing
        }
    }, {
        key: 'onRpcMsg',
        value: function onRpcMsg() {
            //Do nothing
        }
    }, {
        key: 'name',
        get: function get() {
            return "DisconnectedState";
        }
    }]);
    return DisconnectedState;
}(SignalingState);

var FailedState = exports.FailedState = function (_SignalingState7) {
    (0, _inherits3.default)(FailedState, _SignalingState7);

    function FailedState(signaling, exception) {
        (0, _classCallCheck3.default)(this, FailedState);

        var _this12 = (0, _possibleConstructorReturn3.default)(this, (FailedState.__proto__ || Object.getPrototypeOf(FailedState)).call(this, signaling));

        _this12._exception = exception;
        return _this12;
    }

    (0, _createClass3.default)(FailedState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            new Promise(function notifyFailed(resolve) {
                self._signaling._failedHandler(self._exception);
                resolve();
            });
            this._signaling._wss.close();
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            //Do nothing
        }
    }, {
        key: 'name',
        get: function get() {
            return "FailedState";
        }
    }, {
        key: 'exception',
        get: function get() {
            return this._exception;
        }
    }]);
    return FailedState;
}(SignalingState);

var AmznRtcSignaling = function () {
    function AmznRtcSignaling(callId, signalingUri, contactToken, logger, connectTimeoutMs, connectionId, wssManager) {
        (0, _classCallCheck3.default)(this, AmznRtcSignaling);

        this._callId = callId;
        this._connectTimeoutMs = connectTimeoutMs || _rtc_const.DEFAULT_CONNECT_TIMEOUT_MS;
        this._autoAnswer = true;
        this._signalingUri = signalingUri;
        this._contactToken = contactToken;
        this._logger = (0, _utils.wrapLogger)(logger, callId, 'SIGNALING');
        this._connectionId = connectionId;
        this._wssManager = wssManager;

        //empty event handlers
        this._connectedHandler = this._answeredHandler = this._handshakedHandler = this._reconnectedHandler = this._remoteHungupHandler = this._disconnectedHandler = this._failedHandler = function noOp() {};
    }

    (0, _createClass3.default)(AmznRtcSignaling, [{
        key: 'connect',
        value: function connect() {
            this._connect();
            this.transit(new PendingConnectState(this, this._connectTimeoutMs));
        }
    }, {
        key: '_connect',
        value: function _connect() {
            this._wss = this._connectWebSocket(this._buildInviteUri());
        }
    }, {
        key: 'transit',
        value: function transit(nextState) {
            try {
                this._logger.info((this._state ? this._state.name : 'null') + ' => ' + nextState.name);
                if (this.state && this.state.onExit) {
                    this.state.onExit();
                }
            } finally {
                this._state = nextState;
                if (this._state.onEnter) {
                    this._state.onEnter();
                }
            }
        }
    }, {
        key: '_connectWebSocket',
        value: function _connectWebSocket(uri) {
            var wsConnection = void 0;
            if (this._wssManager) {
                wsConnection = new _virtual_wss_connection_manager2.default(this._logger, this._connectionId, this._wssManager);
            } else {
                wsConnection = new WebSocket(uri);
            }
            wsConnection.onopen = (0, _utils.hitch)(this, this._onOpen);
            wsConnection.onmessage = (0, _utils.hitch)(this, this._onMessage);
            wsConnection.onerror = (0, _utils.hitch)(this, this._onError);
            wsConnection.onclose = (0, _utils.hitch)(this, this._onClose);
            return wsConnection;
        }
    }, {
        key: '_buildInviteUri',
        value: function _buildInviteUri() {
            if (this._contactToken) {
                return this._buildUriBase() + '&contactCtx=' + encodeURIComponent(this._contactToken);
            } else {
                return this._buildUriBase();
            }
        }
    }, {
        key: '_buildReconnectUri',
        value: function _buildReconnectUri() {
            return this._buildUriBase() + '&clientToken=' + encodeURIComponent(this._clientToken);
        }
    }, {
        key: '_buildUriBase',
        value: function _buildUriBase() {
            var separator = '?';
            if (this._signalingUri.indexOf(separator) > -1) {
                separator = '&';
            }
            return this._signalingUri + separator + 'callId=' + encodeURIComponent(this._callId);
        }
    }, {
        key: '_onMessage',
        value: function _onMessage(evt) {
            this.state.onRpcMsg(JSON.parse(evt.data));
        }
    }, {
        key: '_onOpen',
        value: function _onOpen(evt) {
            this.state.onOpen(evt);
        }
    }, {
        key: '_onError',
        value: function _onError(evt) {
            this.state.onError(evt);
        }
    }, {
        key: '_onClose',
        value: function _onClose(evt) {
            this._logger.log('WebSocket onclose code=' + evt.code + ', reason=' + evt.reason);
            this.state.onClose(evt);
        }
    }, {
        key: '_reconnect',
        value: function _reconnect() {
            this._wss = this._connectWebSocket(this._buildReconnectUri());
        }
    }, {
        key: 'invite',
        value: function invite(sdp, iceCandidates) {
            this.state.invite(sdp, iceCandidates);
        }
    }, {
        key: 'accept',
        value: function accept() {
            this.state.accept();
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            this.state.hangup();
        }
    }, {
        key: 'callId',
        get: function get() {
            return this._callId;
        }
    }, {
        key: 'onConnected',
        set: function set(connectedHandler) {
            this._connectedHandler = connectedHandler;
        }
    }, {
        key: 'onAnswered',
        set: function set(answeredHandler) {
            this._answeredHandler = answeredHandler;
        }
    }, {
        key: 'onHandshaked',
        set: function set(handshakedHandler) {
            this._handshakedHandler = handshakedHandler;
        }
    }, {
        key: 'onReconnected',
        set: function set(reconnectedHandler) {
            this._reconnectedHandler = reconnectedHandler;
        }
    }, {
        key: 'onRemoteHungup',
        set: function set(remoteHungupHandler) {
            this._remoteHungupHandler = remoteHungupHandler;
        }
    }, {
        key: 'onDisconnected',
        set: function set(disconnectedHandler) {
            this._disconnectedHandler = disconnectedHandler;
        }
    }, {
        key: 'onFailed',
        set: function set(failedHandler) {
            this._failedHandler = failedHandler;
        }
    }, {
        key: 'state',
        get: function get() {
            return this._state;
        }
    }]);
    return AmznRtcSignaling;
}();

exports.default = AmznRtcSignaling;

},{"./exceptions":135,"./rtc_const":136,"./utils":145,"./virtual_wss_connection_manager":146,"babel-runtime/helpers/asyncToGenerator":10,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12,"babel-runtime/helpers/inherits":14,"babel-runtime/helpers/possibleConstructorReturn":15,"babel-runtime/regenerator":19,"uuid/v4":121}],142:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _classCallCheck2 = require("babel-runtime/helpers/classCallCheck");

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require("babel-runtime/helpers/createClass");

var _createClass3 = _interopRequireDefault(_createClass2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var CCPInitiationStrategyInterface = function () {
    function CCPInitiationStrategyInterface() {
        (0, _classCallCheck3.default)(this, CCPInitiationStrategyInterface);

        console.log("CCPInitiationStrategyInterface initialized");
    }

    (0, _createClass3.default)(CCPInitiationStrategyInterface, [{
        key: "getStrategyName",
        value: function getStrategyName() {
            console.error("getStrategyName needs to be overridden");
        }

        // the following functions are rtc_peer_connection_factory related functions
        // check if the browser supports early media connection

    }, {
        key: "_isEarlyMediaConnectionSupported",
        value: function _isEarlyMediaConnectionSupported() {
            console.error("_isEarlyMediaConnectionSupported needs to be overridden");
        }
    }, {
        key: "_createRtcPeerConnection",
        value: function _createRtcPeerConnection() {
            console.error("_createRtcPeerConnection needs to be overridden");
        }

        // the following functions are rtc_session related functions

    }, {
        key: "_guM",
        value: function _guM() {
            console.error("_guM needs to be overridden");
        }
    }, {
        key: "addStream",
        value: function addStream() {
            console.error("addStream needs to be overridden");
        }
    }, {
        key: "setRemoteDescription",
        value: function setRemoteDescription() {
            console.error("setRemoteDescription needs to be overridden");
        }
    }, {
        key: "onIceStateChange",
        value: function onIceStateChange() {
            console.error("onIceStateChange needs to be overridden");
        }
    }, {
        key: "onPeerConnectionStateChange",
        value: function onPeerConnectionStateChange() {
            console.error("onPeerConnectionStateChange needs to be overridden");
        }
    }, {
        key: "_createPeerConnection",
        value: function _createPeerConnection() {
            console.error("_createPeerConnection needs to be overridden");
        }
    }, {
        key: "connect",
        value: function connect() {
            console.error("connect needs to be overridden");
        }
    }, {
        key: "_ontrack",
        value: function _ontrack() {
            console.error("_ontrack needs to be overridden");
        }
    }, {
        key: "_buildMediaConstraints",
        value: function _buildMediaConstraints() {
            console.error("_buildMediaConstraints needs to be overridden");
        }
    }]);
    return CCPInitiationStrategyInterface;
}();

exports.default = CCPInitiationStrategyInterface;

},{"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],143:[function(require,module,exports){
(function (global){(function (){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _classCallCheck2 = require("babel-runtime/helpers/classCallCheck");

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require("babel-runtime/helpers/createClass");

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require("babel-runtime/helpers/possibleConstructorReturn");

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require("babel-runtime/helpers/inherits");

var _inherits3 = _interopRequireDefault(_inherits2);

var _CCPInitiationStrategyInterface = require("./CCPInitiationStrategyInterface");

var _CCPInitiationStrategyInterface2 = _interopRequireDefault(_CCPInitiationStrategyInterface);

var _utils = require("../utils");

var _rtc_session = require("../rtc_session");

var _rtc_const = require("../rtc_const");

require("@citrix/ucsdk/CitrixWebRTC");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var CitrixVDIStrategy = function (_CCPInitiationStrateg) {
    (0, _inherits3.default)(CitrixVDIStrategy, _CCPInitiationStrateg);

    function CitrixVDIStrategy() {
        (0, _classCallCheck3.default)(this, CitrixVDIStrategy);

        var _this = (0, _possibleConstructorReturn3.default)(this, (CitrixVDIStrategy.__proto__ || Object.getPrototypeOf(CitrixVDIStrategy)).call(this));

        if (!window.CitrixWebRTC.isFeatureOn("webrtc1.0")) {
            throw new Error('Citrix WebRTC redirection feature is NOT supported!');
        }
        window.getCitrixWebrtcRedir = function () {
            var registryValue = Promise.resolve(1);
            return new Promise(function (resolve, reject) {
                //retrieve registry value internally
                registryValue.then(function (v) {
                    resolve(v);
                }).catch(function () {
                    reject();
                });
            });
        };
        window.CitrixWebRTC.initLog(global.connect.getLog());
        console.log("CitrixVDIStrategy initialized");
        return _this;
    }

    // the following functions are rtc_peer_connection_factory related functions
    // check if the browser supports early media connection


    (0, _createClass3.default)(CitrixVDIStrategy, [{
        key: "_isEarlyMediaConnectionSupported",
        value: function _isEarlyMediaConnectionSupported() {
            // Citrix WebRTC SDK doesn't support early media connection
            return false;
        }
    }, {
        key: "_createRtcPeerConnection",
        value: function _createRtcPeerConnection(rtcPeerConnectionConfig, rtcPeerConnectionOptionalConfig) {
            return new window.CitrixWebRTC.CitrixPeerConnection(rtcPeerConnectionConfig, rtcPeerConnectionOptionalConfig);
        }

        // the following functions are rtc_session related functions

    }, {
        key: "_gUM",
        value: function _gUM(constraints) {
            return window.CitrixWebRTC.getUserMedia(constraints);
        }
    }, {
        key: "addStream",
        value: function addStream(_pc, stream) {
            stream.getTracks().forEach(function (track) {
                _pc.addTransceiver(track, {});
            });
        }
    }, {
        key: "setRemoteDescription",
        value: function setRemoteDescription(self, rtcSession) {
            var answerSessionDescription = self._createSessionDescription({ type: 'answer', sdp: self._sdp });

            rtcSession._pc.setRemoteDescription(answerSessionDescription, function () {
                var remoteCandidatePromises = Promise.all(self._candidates.map(function (candidate) {
                    var remoteCandidate = self._createRemoteCandidate(candidate);
                    self.logger.info('Adding remote candidate', remoteCandidate);
                    return rtcSession._pc.addIceCandidate(remoteCandidate);
                }));
                remoteCandidatePromises.catch(function (reason) {
                    self.logger.warn('Error adding remote candidate', reason);
                });
                rtcSession._sessionReport.setRemoteDescriptionFailure = false;
                self._remoteDescriptionSet = true;
                self._checkAndTransit();
            }, function () {
                rtcSession._stopSession();
                rtcSession._sessionReport.setRemoteDescriptionFailure = true;
                self.transit(new _rtc_session.FailedState(rtcSession, _rtc_const.RTC_ERRORS.SET_REMOTE_DESCRIPTION_FAILURE));
            });
        }
    }, {
        key: "onIceStateChange",
        value: function onIceStateChange(evt, _pc) {
            return _pc.iceConnectionState;
        }
    }, {
        key: "onPeerConnectionStateChange",
        value: function onPeerConnectionStateChange(_pc) {
            return _pc.connectionState_;
        }
    }, {
        key: "_createPeerConnection",
        value: function _createPeerConnection(configuration, optionalConfiguration) {
            return new window.CitrixWebRTC.CitrixPeerConnection(configuration, optionalConfiguration);
        }
    }, {
        key: "connect",
        value: function connect(self) {
            self._pc.onaddstream = (0, _utils.hitch)(self, self._ontrack);
        }
    }, {
        key: "_ontrack",
        value: function _ontrack(self, evt) {
            var remoteStream = evt.stream.clone();

            var audioTracks = evt.stream.getAudioTracks();
            if (audioTracks !== undefined && audioTracks.length > 0) {
                self._remoteAudioStream = remoteStream;
                self._remoteAudioElement.srcObject = remoteStream;
            }
        }
    }, {
        key: "_buildMediaConstraints",
        value: function _buildMediaConstraints(self, mediaConstraints) {
            if (self._enableAudio) {
                var audioConstraints = {};
                if (typeof self._echoCancellation !== 'undefined') {
                    audioConstraints.echoCancellation = !!self._echoCancellation;
                }
                if (window.audio_input) {
                    audioConstraints.deviceId = window.audio_input;
                }
                if (Object.keys(audioConstraints).length > 0) {
                    mediaConstraints.audio = audioConstraints;
                } else {
                    mediaConstraints.audio = true;
                }
            } else {
                mediaConstraints.audio = false;
            }
        }
    }, {
        key: "getStrategyName",
        value: function getStrategyName() {
            return 'CitrixVDIStrategy';
        }
    }]);
    return CitrixVDIStrategy;
}(_CCPInitiationStrategyInterface2.default); /**
                                              * By using the Citrix ucsdk (https://www.npmjs.com/package/@citrix/ucsdk), you are accepting the Citrix Developer Terms of Use  located here: https://www.cloud.com/terms-of-use.
                                              */

exports.default = CitrixVDIStrategy;

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../rtc_const":136,"../rtc_session":138,"../utils":145,"./CCPInitiationStrategyInterface":142,"@citrix/ucsdk/CitrixWebRTC":1,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12,"babel-runtime/helpers/inherits":14,"babel-runtime/helpers/possibleConstructorReturn":15}],144:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _classCallCheck2 = require("babel-runtime/helpers/classCallCheck");

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require("babel-runtime/helpers/createClass");

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require("babel-runtime/helpers/possibleConstructorReturn");

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require("babel-runtime/helpers/inherits");

var _inherits3 = _interopRequireDefault(_inherits2);

var _CCPInitiationStrategyInterface = require("./CCPInitiationStrategyInterface");

var _CCPInitiationStrategyInterface2 = _interopRequireDefault(_CCPInitiationStrategyInterface);

var _rtc_const = require("../rtc_const");

var _utils = require("../utils");

var _rtc_session = require("../rtc_session");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var StandardStrategy = function (_CCPInitiationStrateg) {
    (0, _inherits3.default)(StandardStrategy, _CCPInitiationStrateg);

    function StandardStrategy() {
        (0, _classCallCheck3.default)(this, StandardStrategy);

        var _this = (0, _possibleConstructorReturn3.default)(this, (StandardStrategy.__proto__ || Object.getPrototypeOf(StandardStrategy)).call(this));

        console.log("StandardStrategy initialized");
        return _this;
    }

    // the following functions are rtc_peer_connection_factory related functions
    // check if the browser supports early media connection


    (0, _createClass3.default)(StandardStrategy, [{
        key: "_isEarlyMediaConnectionSupported",
        value: function _isEarlyMediaConnectionSupported() {
            return (0, _utils.isChromeBrowser)() && (0, _utils.getChromeBrowserVersion)() >= _rtc_const.CHROME_SUPPORTED_VERSION;
        }
    }, {
        key: "_createRtcPeerConnection",
        value: function _createRtcPeerConnection(rtcPeerConnectionConfig, rtcPeerConnectionOptionalConfig) {
            return new RTCPeerConnection(rtcPeerConnectionConfig, rtcPeerConnectionOptionalConfig);
        }

        // the following functions are rtc_session related functions

    }, {
        key: "_gUM",
        value: function _gUM(constraints) {
            return navigator.mediaDevices.getUserMedia(constraints);
        }
    }, {
        key: "addStream",
        value: function addStream(_pc, stream) {
            _pc.addStream(stream);
        }
    }, {
        key: "setRemoteDescription",
        value: function setRemoteDescription(self, rtcSession) {
            var setRemoteDescriptionPromise = rtcSession._pc.setRemoteDescription(self._createSessionDescription({
                type: 'answer',
                sdp: self._sdp
            }));
            setRemoteDescriptionPromise.catch(function (e) {
                self.logger.error('SetRemoteDescription failed', e);
            });
            setRemoteDescriptionPromise.then(function () {
                var remoteCandidatePromises = Promise.all(self._candidates.map(function (candidate) {
                    var remoteCandidate = self._createRemoteCandidate(candidate);
                    self.logger.info('Adding remote candidate', remoteCandidate);
                    return rtcSession._pc.addIceCandidate(remoteCandidate);
                }));
                remoteCandidatePromises.catch(function (reason) {
                    self.logger.warn('Error adding remote candidate', reason);
                });
                return remoteCandidatePromises;
            }).then(function () {
                rtcSession._sessionReport.setRemoteDescriptionFailure = false;
                self._remoteDescriptionSet = true;
                self._checkAndTransit();
            }).catch(function () {
                rtcSession._stopSession();
                rtcSession._sessionReport.setRemoteDescriptionFailure = true;
                self.transit(new _rtc_session.FailedState(rtcSession, _rtc_const.RTC_ERRORS.SET_REMOTE_DESCRIPTION_FAILURE));
            });
        }
    }, {
        key: "onIceStateChange",
        value: function onIceStateChange(evt, _pc) {
            // eslint-disable-line no-unused-vars
            return evt.currentTarget.iceConnectionState;
        }
    }, {
        key: "onPeerConnectionStateChange",
        value: function onPeerConnectionStateChange(_pc) {
            return _pc.connectionState;
        }
    }, {
        key: "_createPeerConnection",
        value: function _createPeerConnection(configuration, optionalConfiguration) {
            return new RTCPeerConnection(configuration, optionalConfiguration);
        }
    }, {
        key: "connect",
        value: function connect(self) {
            self._pc.ontrack = (0, _utils.hitch)(self, self._ontrack);
        }
    }, {
        key: "_ontrack",
        value: function _ontrack(self, evt) {
            if (evt.streams.length > 1) {
                self._logger.warn('Found more than 1 streams for ' + evt.track.kind + ' track ' + evt.track.id + ' : ' + evt.streams.map(function (stream) {
                    return stream.id;
                }).join(','));
            }
            if (evt.track.kind === 'video' && self._remoteVideoElement) {
                self._remoteVideoElement.srcObject = evt.streams[0];
                self._remoteVideoStream = evt.streams[0];
            } else if (evt.track.kind === 'audio' && self._remoteAudioElement) {
                self._remoteAudioElement.srcObject = evt.streams[0];
                self._remoteAudioStream = evt.streams[0];
            }
        }
    }, {
        key: "_buildMediaConstraints",
        value: function _buildMediaConstraints(self, mediaConstraints) {
            if (self._enableAudio) {
                var audioConstraints = {};
                if (typeof self._echoCancellation !== 'undefined') {
                    audioConstraints.echoCancellation = !!self._echoCancellation;
                }
                if (Object.keys(audioConstraints).length > 0) {
                    mediaConstraints.audio = audioConstraints;
                } else {
                    mediaConstraints.audio = true;
                }
            } else {
                mediaConstraints.audio = false;
            }
        }
    }, {
        key: "getStrategyName",
        value: function getStrategyName() {
            return 'StandardStrategy';
        }
    }]);
    return StandardStrategy;
}(_CCPInitiationStrategyInterface2.default);

exports.default = StandardStrategy;

},{"../rtc_const":136,"../rtc_session":138,"../utils":145,"./CCPInitiationStrategyInterface":142,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12,"babel-runtime/helpers/inherits":14,"babel-runtime/helpers/possibleConstructorReturn":15}],145:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.SdpOptions = undefined;

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

exports.hitch = hitch;
exports.wrapLogger = wrapLogger;
exports.closeStream = closeStream;
exports.transformSdp = transformSdp;
exports.is_defined = is_defined;
exports.when_defined = when_defined;
exports.isLegacyStatsReportSupported = isLegacyStatsReportSupported;
exports.isFunction = isFunction;
exports.assertTrue = assertTrue;
exports.isChromeBrowser = isChromeBrowser;
exports.getChromeBrowserVersion = getChromeBrowserVersion;
exports.getRedactedSdp = getRedactedSdp;

var _exceptions = require('./exceptions');

var _sdp = require('sdp');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * All logging methods used by connect-rtc.
 */
/**
 * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */

var logMethods = ['log', 'info', 'warn', 'error'];

/**
 * Binds the given instance object as the context for
 * the method provided.
 *
 * @param scope The instance object to be set as the scope
 *    of the function.
 * @param method The method to be encapsulated.
 *
 * All other arguments, if any, are bound to the method
 * invocation inside the closure.
 *
 * @return A closure encapsulating the invocation of the
 *    method provided in context of the given instance.
 */
function hitch() {
    var args = Array.prototype.slice.call(arguments);
    var scope = args.shift();
    var method = args.shift();

    if (!scope) {
        throw new _exceptions.IllegalParameters('utils.hitch(): scope is required!');
    }

    if (!method) {
        throw new _exceptions.IllegalParameters('utils.hitch(): method is required!');
    }

    if (typeof method !== 'function') {
        throw new _exceptions.IllegalParameters('utils.hitch(): method is not a function!');
    }

    return function _hitchedFunction() {
        var closureArgs = Array.prototype.slice.call(arguments);
        return method.apply(scope, args.concat(closureArgs));
    };
}

function wrapLogger(logger, callId, logCategory) {
    var _logger = {};
    logMethods.forEach(function (logMethod) {
        if (!logger[logMethod]) {
            throw new Error('Logging method ' + logMethod + ' required');
        }
        _logger[logMethod] = hitch(logger, logger[logMethod], callId, logCategory);
    });
    return _logger;
}

function closeStream(stream) {
    if (stream) {
        var tracks = stream.getTracks();
        for (var i = 0; i < tracks.length; i++) {
            var track = tracks[i];
            try {
                track.stop();
            } catch (e) {
                // eat exception
            }
        }
    }
}

/**
 * A parameter of transformSdp.
 * This defines all the SDP options connect-rtc-js supports.
 */

var SdpOptions = exports.SdpOptions = function () {
    function SdpOptions() {
        (0, _classCallCheck3.default)(this, SdpOptions);

        this._forceCodec = {};
    }

    (0, _createClass3.default)(SdpOptions, [{
        key: '_shouldDeleteCodec',


        /**
         * Test if given codec should be removed from SDP.
         * @param mediaType audio|video
         * @param codecName case insensitive
         * @return TRUE - should remove
         */
        value: function _shouldDeleteCodec(mediaType, codecName) {
            var upperCaseCodecName = codecName.toUpperCase();
            return this._forceCodec[mediaType] && upperCaseCodecName !== this._forceCodec[mediaType].toUpperCase() && upperCaseCodecName !== 'TELEPHONE-EVENT';
        }
    }, {
        key: 'enableOpusDtx',
        get: function get() {
            return this._enableOpusDtx;
        }

        /**
         * By default transformSdp disables dtx for OPUS codec.
         * Setting this to true would force it to turn on DTX.
         */
        ,
        set: function set(flag) {
            this._enableOpusDtx = flag;
        }

        /**
         * A map from media type (audio/video) to codec (case insensitive).
         * Add entry for force connect-rtc-js to use specified codec for certain media type.
         * For example: sdpOptions.forceCodec['audio'] = 'opus';
         */

    }, {
        key: 'forceCodec',
        get: function get() {
            return this._forceCodec;
        }
    }]);
    return SdpOptions;
}();

/**
 * Modifies input SDP according to sdpOptions.
 * See SdpOptions for available options.
 * @param sdp original SDP
 * @param sdpOptions defines changes to be applied to SDP
 * @returns a map with 'sdp' containing the transformed SDP and 'mLines' containing the number of m lines in SDP
 */


function transformSdp(sdp, sdpOptions) {
    var sections = (0, _sdp.splitSections)(sdp);
    for (var i = 1; i < sections.length; i++) {
        var mediaType = (0, _sdp.getKind)(sections[i]);
        var rtpParams = (0, _sdp.parseRtpParameters)(sections[i]);
        // a map from payload type (string) to codec object
        var codecMap = rtpParams.codecs.reduce(function (map, codec) {
            map['' + codec.payloadType] = codec;
            return map;
        }, {});
        sections[i] = (0, _sdp.splitLines)(sections[i]).map(function (line) {
            if (line.startsWith('m=')) {
                // modify m= line if SdpOptions#forceCodec specifies codec for current media type
                if (sdpOptions.forceCodec[mediaType]) {
                    var targetCodecPts = Object.keys(codecMap).filter(function (pt) {
                        return !sdpOptions._shouldDeleteCodec(mediaType, codecMap[pt].name);
                    });
                    return (/.*RTP\/S?AVPF? /.exec(line) + targetCodecPts.join(' ')
                    );
                } else {
                    return line;
                }
            } else if (line.startsWith('a=rtpmap:')) {
                var rtpMap = (0, _sdp.parseRtpMap)(line);
                var currentCodec = codecMap[rtpMap.payloadType];

                // remove this codec if SdpOptions#forceCodec specifies a different codec for current media type
                if (is_defined(currentCodec) && sdpOptions._shouldDeleteCodec(mediaType, currentCodec.name)) {
                    return null;
                }

                // append a=fmtp line immediately if current codec is OPUS (to explicitly specify OPUS parameters)
                if (is_defined(currentCodec) && currentCodec.name.toUpperCase() === 'OPUS') {
                    currentCodec.parameters.usedtx = sdpOptions.enableOpusDtx ? "1" : "0";
                    // generate fmtp line immediately after rtpmap line, and remove original fmtp line once we see it
                    return (line + "\r\n" + (0, _sdp.writeFmtp)(currentCodec)).trim();
                } else {
                    return line;
                }
            } else if (line.startsWith('a=fmtp:')) {
                var pt = line.substring('a=fmtp:'.length, line.indexOf(' '));
                var currentCodec = codecMap[pt]; // eslint-disable-line no-redeclare

                // remove this codec if SdpOptions#forceCodec specifies a different codec for current media type
                if (is_defined(currentCodec) && sdpOptions._shouldDeleteCodec(mediaType, currentCodec.name)) {
                    return null;
                }

                if (is_defined(currentCodec) && currentCodec.name.toUpperCase() === 'OPUS') {
                    // this is a line for OPUS, remove it because FMTP line is already generated when rtpmap line is processed
                    return null;
                } else {
                    return line;
                }
            } else if (line.startsWith('a=rtcp-fb:')) {
                var pt = line.substring(line.indexOf(':') + 1, line.indexOf(' ')); // eslint-disable-line no-redeclare
                if (pt === '*') {
                    //always allow wildcard in rtc-fb
                    return line;
                } else {
                    var currentCodec = codecMap[pt]; // eslint-disable-line no-redeclare

                    // remove this codec if SdpOptions#forceCodec specifies a different codec for current media type
                    if (is_defined(currentCodec) && sdpOptions._shouldDeleteCodec(mediaType, currentCodec.name)) {
                        return null;
                    } else {
                        return line;
                    }
                }
            } else {
                return line;
            }
        }).filter(function (line) {
            return line !== null;
        }).join('\r\n');
    }
    return {
        sdp: sections.map(function (section) {
            return section.trim();
        }).join('\r\n') + '\r\n',
        mLines: sections.length - 1 // first section is session description, the rest are media descriptions
    };
}

function is_defined(v) {
    return typeof v !== 'undefined';
}

function when_defined(v, alternativeIn) {
    var alternative = is_defined(alternativeIn) ? alternativeIn : null;
    return is_defined(v) ? v : alternative;
}

/**
 * Check if the getStats API for retrieving legacy stats report is supported
 */
function isLegacyStatsReportSupported(pc) {
    return new Promise(function (resolve) {
        pc.getStats(function () {
            resolve(true);
        }).catch(function () {
            // Exception thrown if browser does not support legacy stats report
            resolve(false);
        });
    });
}

/**
 * Determine if the given value is a callable function type.
 * Borrowed from Underscore.js.
 */
function isFunction(obj) {
    return !!(obj && obj.constructor && obj.call && obj.apply);
}

/**
 * Asserts that a premise is true.
 */
function assertTrue(premise, message) {
    if (!premise) {
        throw new Error(message);
    }
}

function isChromeBrowser() {
    return navigator.userAgent.indexOf("Chrome") !== -1;
}

function getChromeBrowserVersion() {
    var userAgent = navigator.userAgent;
    var chromeVersion = userAgent.substring(userAgent.indexOf("Chrome") + 7);
    if (chromeVersion) {
        return parseFloat(chromeVersion);
    } else {
        return -1;
    }
}

function getRedactedSdp(sdp) {
    // pattern to find and redact the value after 'a=ice-pwd:'
    var pattern = /a=ice-pwd:[^\r\n]*/;

    // Use the replace method to redact the value with '[redacted]'
    return sdp.replace(pattern, 'a=ice-pwd:[redacted]');
}

},{"./exceptions":135,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12,"sdp":118}],146:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _utils = require('./utils');

var _rtc_const = require('./rtc_const');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var VirtualWssConnectionManager = function () {
    function VirtualWssConnectionManager(logger, connectionId, wssManager) {
        (0, _classCallCheck3.default)(this, VirtualWssConnectionManager);

        this._logger = logger;
        this._connectionId = connectionId;
        this._wssManager = wssManager;
        this._initializeWebSocketEventListeners();
    }

    (0, _createClass3.default)(VirtualWssConnectionManager, [{
        key: '_initializeWebSocketEventListeners',
        value: function _initializeWebSocketEventListeners() {
            var _this = this;

            this._wssManager.subscribeTopics([_rtc_const.SOFTPHONE_ROUTE_KEY]);
            this._unSubscribe = this._wssManager.onMessage(_rtc_const.SOFTPHONE_ROUTE_KEY, (0, _utils.hitch)(this, this._webSocketManagerOnMessage));
            setTimeout(function () {
                _this._onOpen();
            }, 0);
        }
    }, {
        key: '_webSocketManagerOnMessage',
        value: function _webSocketManagerOnMessage(event) {
            var content = void 0;
            if (event.content) {
                content = JSON.parse(event.content);
            }
            if (this._onMessage && content && this._connectionId === content.connectionId) {
                this._onMessage({ data: JSON.stringify(content.jsonRpcMsg) });
            }
        }
    }, {
        key: 'send',
        value: function send(webSocketPayload) {
            var payload = {};
            try {
                payload.topic = _rtc_const.SOFTPHONE_ROUTE_KEY;
                payload.connectionId = this._connectionId;
                payload.jsonRpcMsg = JSON.parse(webSocketPayload);
                this._wssManager.sendMessage(payload);
            } catch (error) {
                this._logger.error("Error in sendMessage ", error);
            }
        }
    }, {
        key: 'close',
        value: function close() {
            this._logger.info("closing virtual connection");
            this._unSubscribe();
        }
    }, {
        key: 'onmessage',
        set: function set(callBack) {
            this._onMessage = callBack;
        }
    }, {
        key: 'onopen',
        set: function set(callBack) {
            this._onOpen = callBack;
        }
    }]);
    return VirtualWssConnectionManager;
}();

exports.default = VirtualWssConnectionManager;

},{"./rtc_const":136,"./utils":145,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}]},{},[134])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvQGNpdHJpeC91Y3Nkay9DaXRyaXhXZWJSVEMuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9jcmVhdGUuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHkuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtcHJvdG90eXBlLW9mLmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZi5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZS5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2NvcmUtanMvc3ltYm9sLmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvY29yZS1qcy9zeW1ib2wvaXRlcmF0b3IuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3IuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrLmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcy5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0LmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvaGVscGVycy9pbmhlcml0cy5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybi5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2hlbHBlcnMvdHlwZW9mLmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvbm9kZV9tb2R1bGVzL3JlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS1tb2R1bGUuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9ub2RlX21vZHVsZXMvcmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvcmVnZW5lcmF0b3IvaW5kZXguanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9jcmVhdGUuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9kZWZpbmUtcHJvcGVydHkuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtcHJvdG90eXBlLW9mLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9mbi9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZi5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvZm4vcHJvbWlzZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvZm4vc3ltYm9sL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9mbi9zeW1ib2wvaXRlcmF0b3IuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2EtZnVuY3Rpb24uanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2FkZC10by11bnNjb3BhYmxlcy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fYW4taW5zdGFuY2UuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2FuLW9iamVjdC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fYXJyYXktaW5jbHVkZXMuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2NsYXNzb2YuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2NvZi5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fY29yZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fY3R4LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19kZWZpbmVkLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19kZXNjcmlwdG9ycy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fZG9tLWNyZWF0ZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fZW51bS1idWcta2V5cy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fZW51bS1rZXlzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19leHBvcnQuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2ZhaWxzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19mb3Itb2YuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2dsb2JhbC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faGFzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19oaWRlLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19odG1sLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pZTgtZG9tLWRlZmluZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faW52b2tlLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pb2JqZWN0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pcy1hcnJheS1pdGVyLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pcy1hcnJheS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faXMtb2JqZWN0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pdGVyLWNhbGwuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2l0ZXItY3JlYXRlLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pdGVyLWRlZmluZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faXRlci1kZXRlY3QuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2l0ZXItc3RlcC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faXRlcmF0b3JzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19saWJyYXJ5LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19tZXRhLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19taWNyb3Rhc2suanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX25ldy1wcm9taXNlLWNhcGFiaWxpdHkuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1jcmVhdGUuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1kcC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fb2JqZWN0LWRwcy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fb2JqZWN0LWdvcGQuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1nb3BuLWV4dC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fb2JqZWN0LWdvcG4uanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1nb3BzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtZ3BvLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3Qta2V5cy1pbnRlcm5hbC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fb2JqZWN0LWtleXMuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1waWUuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1zYXAuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3BlcmZvcm0uanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3Byb21pc2UtcmVzb2x2ZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fcHJvcGVydHktZGVzYy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fcmVkZWZpbmUtYWxsLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19yZWRlZmluZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fc2V0LXByb3RvLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19zZXQtc3BlY2llcy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fc2V0LXRvLXN0cmluZy10YWcuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3NoYXJlZC1rZXkuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3NoYXJlZC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fc3BlY2llcy1jb25zdHJ1Y3Rvci5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fc3RyaW5nLWF0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190YXNrLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190by1hYnNvbHV0ZS1pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fdG8taW50ZWdlci5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fdG8taW9iamVjdC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fdG8tbGVuZ3RoLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190by1vYmplY3QuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3RvLXByaW1pdGl2ZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fdWlkLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL191c2VyLWFnZW50LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL193a3MtZGVmaW5lLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL193a3MtZXh0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL193a3MuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5hcnJheS5pdGVyYXRvci5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYub2JqZWN0LmNyZWF0ZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvci5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYub2JqZWN0LmdldC1wcm90b3R5cGUtb2YuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvZXM2Lm9iamVjdC5zZXQtcHJvdG90eXBlLW9mLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5wcm9taXNlLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvZXM2LnN5bWJvbC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczcucHJvbWlzZS5maW5hbGx5LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNy5wcm9taXNlLnRyeS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczcuc3ltYm9sLmFzeW5jLWl0ZXJhdG9yLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNy5zeW1ib2wub2JzZXJ2YWJsZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlLmpzIiwibm9kZV9tb2R1bGVzL3J0Y3BlZXJjb25uZWN0aW9uLXNoaW0vcnRjcGVlcmNvbm5lY3Rpb24uanMiLCJub2RlX21vZHVsZXMvc2RwL3NkcC5qcyIsIm5vZGVfbW9kdWxlcy91dWlkL2xpYi9ieXRlc1RvVXVpZC5qcyIsIm5vZGVfbW9kdWxlcy91dWlkL2xpYi9ybmctYnJvd3Nlci5qcyIsIm5vZGVfbW9kdWxlcy91dWlkL3Y0LmpzIiwibm9kZV9tb2R1bGVzL3dlYnJ0Yy1hZGFwdGVyL3NyYy9qcy9hZGFwdGVyX2NvcmUuanMiLCJub2RlX21vZHVsZXMvd2VicnRjLWFkYXB0ZXIvc3JjL2pzL2FkYXB0ZXJfZmFjdG9yeS5qcyIsIm5vZGVfbW9kdWxlcy93ZWJydGMtYWRhcHRlci9zcmMvanMvY2hyb21lL2Nocm9tZV9zaGltLmpzIiwibm9kZV9tb2R1bGVzL3dlYnJ0Yy1hZGFwdGVyL3NyYy9qcy9jaHJvbWUvZ2V0dXNlcm1lZGlhLmpzIiwibm9kZV9tb2R1bGVzL3dlYnJ0Yy1hZGFwdGVyL3NyYy9qcy9jb21tb25fc2hpbS5qcyIsIm5vZGVfbW9kdWxlcy93ZWJydGMtYWRhcHRlci9zcmMvanMvZWRnZS9lZGdlX3NoaW0uanMiLCJub2RlX21vZHVsZXMvd2VicnRjLWFkYXB0ZXIvc3JjL2pzL2VkZ2UvZmlsdGVyaWNlc2VydmVycy5qcyIsIm5vZGVfbW9kdWxlcy93ZWJydGMtYWRhcHRlci9zcmMvanMvZWRnZS9nZXR1c2VybWVkaWEuanMiLCJub2RlX21vZHVsZXMvd2VicnRjLWFkYXB0ZXIvc3JjL2pzL2ZpcmVmb3gvZmlyZWZveF9zaGltLmpzIiwibm9kZV9tb2R1bGVzL3dlYnJ0Yy1hZGFwdGVyL3NyYy9qcy9maXJlZm94L2dldHVzZXJtZWRpYS5qcyIsIm5vZGVfbW9kdWxlcy93ZWJydGMtYWRhcHRlci9zcmMvanMvc2FmYXJpL3NhZmFyaV9zaGltLmpzIiwibm9kZV9tb2R1bGVzL3dlYnJ0Yy1hZGFwdGVyL3NyYy9qcy91dGlscy5qcyIsInNyYy9qcy9jb25uZWN0LXJ0Yy5qcyIsInNyYy9qcy9leGNlcHRpb25zLmpzIiwic3JjL2pzL3J0Y19jb25zdC5qcyIsInNyYy9qcy9ydGNfcGVlcl9jb25uZWN0aW9uX2ZhY3RvcnkuanMiLCJzcmMvanMvcnRjX3Nlc3Npb24uanMiLCJzcmMvanMvcnRwLXN0YXRzLmpzIiwic3JjL2pzL3Nlc3Npb25fcmVwb3J0LmpzIiwic3JjL2pzL3NpZ25hbGluZy5qcyIsInNyYy9qcy9zdHJhdGVnaWVzL0NDUEluaXRpYXRpb25TdHJhdGVneUludGVyZmFjZS5qcyIsInNyYy9qcy9zdHJhdGVnaWVzL0NpdHJpeFZESVN0cmF0ZWd5LmpzIiwic3JjL2pzL3N0cmF0ZWdpZXMvU3RhbmRhcmRTdHJhdGVneS5qcyIsInNyYy9qcy91dGlscy5qcyIsInNyYy9qcy92aXJ0dWFsX3dzc19jb25uZWN0aW9uX21hbmFnZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ3JkQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3Z0QkE7QUFDQTs7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBOztBQ0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSkE7QUFDQTs7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBOztBQ0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RCQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBOztBQ0RBO0FBQ0E7O0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1BBO0FBQ0E7O0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUEE7QUFDQTs7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUEE7QUFDQTs7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVEE7QUFDQTs7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1RBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOVJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdFBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWkE7QUFDQTs7QUNEQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2owREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDenpCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDN0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDejZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbFNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDak5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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UCxFQUFoQjtBQUNIO0FBQ0o7Ozs2QkFVSSxnQixFQUFrQjtBQUNuQixnQkFBTSxVQUFVLEVBQWhCO0FBQ0EsZ0JBQUk7QUFDQSx3QkFBUSxLQUFSLEdBQWdCLDhCQUFoQjtBQUNBLHdCQUFRLFlBQVIsR0FBdUIsS0FBSyxhQUE1QjtBQUNBLHdCQUFRLFVBQVIsR0FBcUIsS0FBSyxLQUFMLENBQVcsZ0JBQVgsQ0FBckI7QUFDQSxxQkFBSyxXQUFMLENBQWlCLFdBQWpCLENBQTZCLE9BQTdCO0FBQ0gsYUFMRCxDQUtFLE9BQU8sS0FBUCxFQUFjO0FBQ1oscUJBQUssT0FBTCxDQUFhLEtBQWIsQ0FBbUIsdUJBQW5CLEVBQTRDLEtBQTVDO0FBQ0g7QUFDSjs7O2dDQUVPO0FBQ0osaUJBQUssT0FBTCxDQUFhLElBQWIsQ0FBa0IsNEJBQWxCO0FBQ0EsaUJBQUssWUFBTDtBQUNIOzs7MEJBdkJhLFEsRUFBVTtBQUNwQixpQkFBSyxVQUFMLEdBQWtCLFFBQWxCO0FBQ0g7OzswQkFFVSxRLEVBQVU7QUFDakIsaUJBQUssT0FBTCxHQUFlLFFBQWY7QUFDSDs7Ozs7a0JBaENnQiwyQiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQnkgdXNpbmcgdGhlc2UgRGV2ZWxvcGVyIE1hdGVyaWFscywgeW91IGFjY2VwdCBhbmQgYWdyZWUgdG8gY29tcGx5IHdpdGhcclxuLy8gdGhlIHRlcm1zIG9mIHRoZSBDbG91ZCBTb2Z0d2FyZSBHcm91cCBEZXZlbG9wZXIgVGVybXMgb2YgVXNlIGZvdW5kIGhlcmVcclxuLy8gKGh0dHBzOi8vd3d3LmNsb3VkLmNvbS9sZWdhbClcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcblxyXG52YXIgJGpzY29tcD17c2NvcGU6e30sZ2V0R2xvYmFsOmZ1bmN0aW9uKGQpe3JldHVyblwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdz09PWQ/ZDpcInVuZGVmaW5lZFwiIT10eXBlb2YgZ2xvYmFsP2dsb2JhbDpkfX07JGpzY29tcC5nbG9iYWw9JGpzY29tcC5nZXRHbG9iYWwodGhpcyk7JGpzY29tcC5pbml0U3ltYm9sPWZ1bmN0aW9uKCl7JGpzY29tcC5nbG9iYWwuU3ltYm9sfHwoJGpzY29tcC5nbG9iYWwuU3ltYm9sPSRqc2NvbXAuU3ltYm9sKTskanNjb21wLmluaXRTeW1ib2w9ZnVuY3Rpb24oKXt9fTskanNjb21wLnN5bWJvbENvdW50ZXJfPTA7JGpzY29tcC5TeW1ib2w9ZnVuY3Rpb24oZCl7cmV0dXJuXCJqc2NvbXBfc3ltYm9sX1wiK2QrJGpzY29tcC5zeW1ib2xDb3VudGVyXysrfTtcclxuJGpzY29tcC5pbml0U3ltYm9sSXRlcmF0b3I9ZnVuY3Rpb24oKXskanNjb21wLmluaXRTeW1ib2woKTskanNjb21wLmdsb2JhbC5TeW1ib2wuaXRlcmF0b3J8fCgkanNjb21wLmdsb2JhbC5TeW1ib2wuaXRlcmF0b3I9JGpzY29tcC5nbG9iYWwuU3ltYm9sKFwiaXRlcmF0b3JcIikpOyRqc2NvbXAuaW5pdFN5bWJvbEl0ZXJhdG9yPWZ1bmN0aW9uKCl7fX07JGpzY29tcC5tYWtlSXRlcmF0b3I9ZnVuY3Rpb24oZCl7JGpzY29tcC5pbml0U3ltYm9sSXRlcmF0b3IoKTtpZihkWyRqc2NvbXAuZ2xvYmFsLlN5bWJvbC5pdGVyYXRvcl0pcmV0dXJuIGRbJGpzY29tcC5nbG9iYWwuU3ltYm9sLml0ZXJhdG9yXSgpO3ZhciBlPTA7cmV0dXJue25leHQ6ZnVuY3Rpb24oKXtyZXR1cm4gZT09ZC5sZW5ndGg/e2RvbmU6ITB9Ontkb25lOiExLHZhbHVlOmRbZSsrXX19fX07XHJcbiRqc2NvbXAuYXJyYXlGcm9tSXRlcmF0b3I9ZnVuY3Rpb24oZCl7Zm9yKHZhciBlLGs9W107IShlPWQubmV4dCgpKS5kb25lOylrLnB1c2goZS52YWx1ZSk7cmV0dXJuIGt9OyRqc2NvbXAuYXJyYXlGcm9tSXRlcmFibGU9ZnVuY3Rpb24oZCl7cmV0dXJuIGQgaW5zdGFuY2VvZiBBcnJheT9kOiRqc2NvbXAuYXJyYXlGcm9tSXRlcmF0b3IoJGpzY29tcC5tYWtlSXRlcmF0b3IoZCkpfTtcclxuJGpzY29tcC5pbmhlcml0cz1mdW5jdGlvbihkLGUpe2Z1bmN0aW9uIGsoKXt9ay5wcm90b3R5cGU9ZS5wcm90b3R5cGU7ZC5wcm90b3R5cGU9bmV3IGs7ZC5wcm90b3R5cGUuY29uc3RydWN0b3I9ZDtmb3IodmFyIGIgaW4gZSlpZigkanNjb21wLmdsb2JhbC5PYmplY3QuZGVmaW5lUHJvcGVydGllcyl7dmFyIGE9JGpzY29tcC5nbG9iYWwuT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLGIpO2EmJiRqc2NvbXAuZ2xvYmFsLk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkLGIsYSl9ZWxzZSBkW2JdPWVbYl19OyRqc2NvbXAuYXJyYXk9JGpzY29tcC5hcnJheXx8e307JGpzY29tcC5hcnJheS5kb25lXz1mdW5jdGlvbigpe3JldHVybntkb25lOiEwLHZhbHVlOnZvaWQgMH19O1xyXG4kanNjb21wLmFycmF5LmFycmF5SXRlcmF0b3JfPWZ1bmN0aW9uKGQsZSl7ZCBpbnN0YW5jZW9mIFN0cmluZyYmKGQ9U3RyaW5nKGQpKTt2YXIgaz0wOyRqc2NvbXAuaW5pdFN5bWJvbCgpOyRqc2NvbXAuaW5pdFN5bWJvbEl0ZXJhdG9yKCk7dmFyIGI9e30sYT0oYi5uZXh0PWZ1bmN0aW9uKCl7aWYoazxkLmxlbmd0aCl7dmFyIGI9aysrO3JldHVybnt2YWx1ZTplKGIsZFtiXSksZG9uZTohMX19YS5uZXh0PSRqc2NvbXAuYXJyYXkuZG9uZV87cmV0dXJuICRqc2NvbXAuYXJyYXkuZG9uZV8oKX0sYltTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIGF9LGIpO3JldHVybiBhfTtcclxuJGpzY29tcC5hcnJheS5maW5kSW50ZXJuYWxfPWZ1bmN0aW9uKGQsZSxrKXtkIGluc3RhbmNlb2YgU3RyaW5nJiYoZD1TdHJpbmcoZCkpO2Zvcih2YXIgYj1kLmxlbmd0aCxhPTA7YTxiO2ErKyl7dmFyIGM9ZFthXTtpZihlLmNhbGwoayxjLGEsZCkpcmV0dXJue2k6YSx2OmN9fXJldHVybntpOi0xLHY6dm9pZCAwfX07XHJcbiRqc2NvbXAuYXJyYXkuZnJvbT1mdW5jdGlvbihkLGUsayl7ZT12b2lkIDA9PT1lP2Z1bmN0aW9uKGEpe3JldHVybiBhfTplO3ZhciBiPVtdOyRqc2NvbXAuaW5pdFN5bWJvbCgpOyRqc2NvbXAuaW5pdFN5bWJvbEl0ZXJhdG9yKCk7aWYoZFtTeW1ib2wuaXRlcmF0b3JdKXskanNjb21wLmluaXRTeW1ib2woKTskanNjb21wLmluaXRTeW1ib2xJdGVyYXRvcigpO2Q9ZFtTeW1ib2wuaXRlcmF0b3JdKCk7Zm9yKHZhciBhOyEoYT1kLm5leHQoKSkuZG9uZTspYi5wdXNoKGUuY2FsbChrLGEudmFsdWUpKX1lbHNle2E9ZC5sZW5ndGg7Zm9yKHZhciBjPTA7YzxhO2MrKyliLnB1c2goZS5jYWxsKGssZFtjXSkpfXJldHVybiBifTskanNjb21wLmFycmF5Lm9mPWZ1bmN0aW9uKGQpe2Zvcih2YXIgZT1bXSxrPTA7azxhcmd1bWVudHMubGVuZ3RoOysrayllW2stMF09YXJndW1lbnRzW2tdO3JldHVybiAkanNjb21wLmFycmF5LmZyb20oZSl9O1xyXG4kanNjb21wLmFycmF5LmVudHJpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gJGpzY29tcC5hcnJheS5hcnJheUl0ZXJhdG9yXyh0aGlzLGZ1bmN0aW9uKGQsZSl7cmV0dXJuW2QsZV19KX07JGpzY29tcC5hcnJheS5lbnRyaWVzJGluc3RhbGw9ZnVuY3Rpb24oKXtBcnJheS5wcm90b3R5cGUuZW50cmllc3x8KEFycmF5LnByb3RvdHlwZS5lbnRyaWVzPSRqc2NvbXAuYXJyYXkuZW50cmllcyl9OyRqc2NvbXAuYXJyYXkua2V5cz1mdW5jdGlvbigpe3JldHVybiAkanNjb21wLmFycmF5LmFycmF5SXRlcmF0b3JfKHRoaXMsZnVuY3Rpb24oZCl7cmV0dXJuIGR9KX07JGpzY29tcC5hcnJheS5rZXlzJGluc3RhbGw9ZnVuY3Rpb24oKXtBcnJheS5wcm90b3R5cGUua2V5c3x8KEFycmF5LnByb3RvdHlwZS5rZXlzPSRqc2NvbXAuYXJyYXkua2V5cyl9OyRqc2NvbXAuYXJyYXkudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuICRqc2NvbXAuYXJyYXkuYXJyYXlJdGVyYXRvcl8odGhpcyxmdW5jdGlvbihkLGUpe3JldHVybiBlfSl9O1xyXG4kanNjb21wLmFycmF5LnZhbHVlcyRpbnN0YWxsPWZ1bmN0aW9uKCl7QXJyYXkucHJvdG90eXBlLnZhbHVlc3x8KEFycmF5LnByb3RvdHlwZS52YWx1ZXM9JGpzY29tcC5hcnJheS52YWx1ZXMpfTskanNjb21wLmFycmF5LmNvcHlXaXRoaW49ZnVuY3Rpb24oZCxlLGspe3ZhciBiPXRoaXMubGVuZ3RoO2Q9TnVtYmVyKGQpO2U9TnVtYmVyKGUpO2s9TnVtYmVyKG51bGwhPWs/azpiKTtpZihkPGUpZm9yKGs9TWF0aC5taW4oayxiKTtlPGs7KWUgaW4gdGhpcz90aGlzW2QrK109dGhpc1tlKytdOihkZWxldGUgdGhpc1tkKytdLGUrKyk7ZWxzZSBmb3Ioaz1NYXRoLm1pbihrLGIrZS1kKSxkKz1rLWU7az5lOyktLWsgaW4gdGhpcz90aGlzWy0tZF09dGhpc1trXTpkZWxldGUgdGhpc1tkXTtyZXR1cm4gdGhpc307JGpzY29tcC5hcnJheS5jb3B5V2l0aGluJGluc3RhbGw9ZnVuY3Rpb24oKXtBcnJheS5wcm90b3R5cGUuY29weVdpdGhpbnx8KEFycmF5LnByb3RvdHlwZS5jb3B5V2l0aGluPSRqc2NvbXAuYXJyYXkuY29weVdpdGhpbil9O1xyXG4kanNjb21wLmFycmF5LmZpbGw9ZnVuY3Rpb24oZCxlLGspe251bGwhPWsmJmQubGVuZ3RofHwoaz10aGlzLmxlbmd0aHx8MCk7az1OdW1iZXIoayk7Zm9yKGU9TnVtYmVyKCh2b2lkIDA9PT1lPzA6ZSl8fDApO2U8aztlKyspdGhpc1tlXT1kO3JldHVybiB0aGlzfTskanNjb21wLmFycmF5LmZpbGwkaW5zdGFsbD1mdW5jdGlvbigpe0FycmF5LnByb3RvdHlwZS5maWxsfHwoQXJyYXkucHJvdG90eXBlLmZpbGw9JGpzY29tcC5hcnJheS5maWxsKX07JGpzY29tcC5hcnJheS5maW5kPWZ1bmN0aW9uKGQsZSl7cmV0dXJuICRqc2NvbXAuYXJyYXkuZmluZEludGVybmFsXyh0aGlzLGQsZSkudn07JGpzY29tcC5hcnJheS5maW5kJGluc3RhbGw9ZnVuY3Rpb24oKXtBcnJheS5wcm90b3R5cGUuZmluZHx8KEFycmF5LnByb3RvdHlwZS5maW5kPSRqc2NvbXAuYXJyYXkuZmluZCl9O1xyXG4kanNjb21wLmFycmF5LmZpbmRJbmRleD1mdW5jdGlvbihkLGUpe3JldHVybiAkanNjb21wLmFycmF5LmZpbmRJbnRlcm5hbF8odGhpcyxkLGUpLml9OyRqc2NvbXAuYXJyYXkuZmluZEluZGV4JGluc3RhbGw9ZnVuY3Rpb24oKXtBcnJheS5wcm90b3R5cGUuZmluZEluZGV4fHwoQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleD0kanNjb21wLmFycmF5LmZpbmRJbmRleCl9OyRqc2NvbXAuTWFwPWZ1bmN0aW9uKGQpe2Q9dm9pZCAwPT09ZD9bXTpkO3RoaXMuZGF0YV89e307dGhpcy5oZWFkXz0kanNjb21wLk1hcC5jcmVhdGVIZWFkXygpO3RoaXMuc2l6ZT0wO2lmKGQpe2Q9JGpzY29tcC5tYWtlSXRlcmF0b3IoZCk7Zm9yKHZhciBlPWQubmV4dCgpOyFlLmRvbmU7ZT1kLm5leHQoKSllPWUudmFsdWUsdGhpcy5zZXQoZVswXSxlWzFdKX19O1xyXG4kanNjb21wLk1hcC5jaGVja0Jyb3dzZXJDb25mb3JtYW5jZV89ZnVuY3Rpb24oKXt2YXIgZD0kanNjb21wLmdsb2JhbC5NYXA7aWYoIWR8fCFkLnByb3RvdHlwZS5lbnRyaWVzfHwhT2JqZWN0LnNlYWwpcmV0dXJuITE7dHJ5e3ZhciBlPU9iamVjdC5zZWFsKHt4OjR9KSxrPW5ldyBkKCRqc2NvbXAubWFrZUl0ZXJhdG9yKFtbZSxcInNcIl1dKSk7aWYoXCJzXCIhPWsuZ2V0KGUpfHwxIT1rLnNpemV8fGsuZ2V0KHt4OjR9KXx8ay5zZXQoe3g6NH0sXCJ0XCIpIT1rfHwyIT1rLnNpemUpcmV0dXJuITE7dmFyIGI9ay5lbnRyaWVzKCksYT1iLm5leHQoKTtpZihhLmRvbmV8fGEudmFsdWVbMF0hPWV8fFwic1wiIT1hLnZhbHVlWzFdKXJldHVybiExO2E9Yi5uZXh0KCk7cmV0dXJuIGEuZG9uZXx8NCE9YS52YWx1ZVswXS54fHxcInRcIiE9YS52YWx1ZVsxXXx8IWIubmV4dCgpLmRvbmU/ITE6ITB9Y2F0Y2goYyl7cmV0dXJuITF9fTtcclxuJGpzY29tcC5NYXAuY3JlYXRlSGVhZF89ZnVuY3Rpb24oKXt2YXIgZD17fTtyZXR1cm4gZC5wcmV2aW91cz1kLm5leHQ9ZC5oZWFkPWR9OyRqc2NvbXAuTWFwLmdldElkXz1mdW5jdGlvbihkKXtpZighKGQgaW5zdGFuY2VvZiBPYmplY3QpKXJldHVybiBTdHJpbmcoZCk7JGpzY29tcC5NYXAua2V5XyBpbiBkfHxkIGluc3RhbmNlb2YgT2JqZWN0JiZPYmplY3QuaXNFeHRlbnNpYmxlJiZPYmplY3QuaXNFeHRlbnNpYmxlKGQpJiYkanNjb21wLk1hcC5kZWZpbmVQcm9wZXJ0eV8oZCwkanNjb21wLk1hcC5rZXlfLCsrJGpzY29tcC5NYXAuaW5kZXhfKTtyZXR1cm4gJGpzY29tcC5NYXAua2V5XyBpbiBkP2RbJGpzY29tcC5NYXAua2V5X106XCIgXCIrZH07XHJcbiRqc2NvbXAuTWFwLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24oZCxlKXt2YXIgaz10aGlzLm1heWJlR2V0RW50cnlfKGQpLGI9ay5pZCxhPWsubGlzdCxrPWsuZW50cnk7YXx8KGE9dGhpcy5kYXRhX1tiXT1bXSk7az9rLnZhbHVlPWU6KGs9e25leHQ6dGhpcy5oZWFkXyxwcmV2aW91czp0aGlzLmhlYWRfLnByZXZpb3VzLGhlYWQ6dGhpcy5oZWFkXyxrZXk6ZCx2YWx1ZTplfSxhLnB1c2goayksdGhpcy5oZWFkXy5wcmV2aW91cy5uZXh0PWssdGhpcy5oZWFkXy5wcmV2aW91cz1rLHRoaXMuc2l6ZSsrKTtyZXR1cm4gdGhpc307XHJcbiRqc2NvbXAuTWFwLnByb3RvdHlwZVtcImRlbGV0ZVwiXT1mdW5jdGlvbihkKXt2YXIgZT10aGlzLm1heWJlR2V0RW50cnlfKGQpO2Q9ZS5pZDt2YXIgaz1lLmxpc3QsYj1lLmluZGV4O3JldHVybihlPWUuZW50cnkpJiZrPyhrLnNwbGljZShiLDEpLGsubGVuZ3RofHxkZWxldGUgdGhpcy5kYXRhX1tkXSxlLnByZXZpb3VzLm5leHQ9ZS5uZXh0LGUubmV4dC5wcmV2aW91cz1lLnByZXZpb3VzLGUuaGVhZD1udWxsLHRoaXMuc2l6ZS0tLCEwKTohMX07JGpzY29tcC5NYXAucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5kYXRhXz17fTt0aGlzLmhlYWRfPXRoaXMuaGVhZF8ucHJldmlvdXM9JGpzY29tcC5NYXAuY3JlYXRlSGVhZF8oKTt0aGlzLnNpemU9MH07JGpzY29tcC5NYXAucHJvdG90eXBlLmhhcz1mdW5jdGlvbihkKXtyZXR1cm4hIXRoaXMubWF5YmVHZXRFbnRyeV8oZCkuZW50cnl9O1xyXG4kanNjb21wLk1hcC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGQpe3JldHVybihkPXRoaXMubWF5YmVHZXRFbnRyeV8oZCkuZW50cnkpJiZkLnZhbHVlfTskanNjb21wLk1hcC5wcm90b3R5cGUubWF5YmVHZXRFbnRyeV89ZnVuY3Rpb24oZCl7dmFyIGU9JGpzY29tcC5NYXAuZ2V0SWRfKGQpLGs9dGhpcy5kYXRhX1tlXTtpZihrKWZvcih2YXIgYj0wO2I8ay5sZW5ndGg7YisrKXt2YXIgYT1rW2JdO2lmKGQhPT1kJiZhLmtleSE9PWEua2V5fHxkPT09YS5rZXkpcmV0dXJue2lkOmUsbGlzdDprLGluZGV4OmIsZW50cnk6YX19cmV0dXJue2lkOmUsbGlzdDprLGluZGV4Oi0xLGVudHJ5OnZvaWQgMH19OyRqc2NvbXAuTWFwLnByb3RvdHlwZS5lbnRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlcl8oZnVuY3Rpb24oZCl7cmV0dXJuW2Qua2V5LGQudmFsdWVdfSl9OyRqc2NvbXAuTWFwLnByb3RvdHlwZS5rZXlzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlcl8oZnVuY3Rpb24oZCl7cmV0dXJuIGQua2V5fSl9O1xyXG4kanNjb21wLk1hcC5wcm90b3R5cGUudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlcl8oZnVuY3Rpb24oZCl7cmV0dXJuIGQudmFsdWV9KX07JGpzY29tcC5NYXAucHJvdG90eXBlLmZvckVhY2g9ZnVuY3Rpb24oZCxlKXtmb3IodmFyIGs9JGpzY29tcC5tYWtlSXRlcmF0b3IodGhpcy5lbnRyaWVzKCkpLGI9ay5uZXh0KCk7IWIuZG9uZTtiPWsubmV4dCgpKWI9Yi52YWx1ZSxkLmNhbGwoZSxiWzFdLGJbMF0sdGhpcyl9O1xyXG4kanNjb21wLk1hcC5wcm90b3R5cGUuaXRlcl89ZnVuY3Rpb24oZCl7dmFyIGU9dGhpcyxrPXRoaXMuaGVhZF87JGpzY29tcC5pbml0U3ltYm9sKCk7JGpzY29tcC5pbml0U3ltYm9sSXRlcmF0b3IoKTt2YXIgYj17fTtyZXR1cm4gYi5uZXh0PWZ1bmN0aW9uKCl7aWYoayl7Zm9yKDtrLmhlYWQhPWUuaGVhZF87KWs9ay5wcmV2aW91cztmb3IoO2submV4dCE9ay5oZWFkOylyZXR1cm4gaz1rLm5leHQse2RvbmU6ITEsdmFsdWU6ZChrKX07az1udWxsfXJldHVybntkb25lOiEwLHZhbHVlOnZvaWQgMH19LGJbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSxifTskanNjb21wLk1hcC5pbmRleF89MDskanNjb21wLk1hcC5kZWZpbmVQcm9wZXJ0eV89T2JqZWN0LmRlZmluZVByb3BlcnR5P2Z1bmN0aW9uKGQsZSxrKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZCxlLHt2YWx1ZTpTdHJpbmcoayl9KX06ZnVuY3Rpb24oZCxlLGspe2RbZV09U3RyaW5nKGspfTtcclxuJGpzY29tcC5NYXAuRW50cnlfPWZ1bmN0aW9uKCl7fTskanNjb21wLk1hcC5BU1NVTUVfTk9fTkFUSVZFPSExOyRqc2NvbXAuTWFwJGluc3RhbGw9ZnVuY3Rpb24oKXskanNjb21wLmluaXRTeW1ib2woKTskanNjb21wLmluaXRTeW1ib2xJdGVyYXRvcigpOyEkanNjb21wLk1hcC5BU1NVTUVfTk9fTkFUSVZFJiYkanNjb21wLk1hcC5jaGVja0Jyb3dzZXJDb25mb3JtYW5jZV8oKT8kanNjb21wLk1hcD0kanNjb21wLmdsb2JhbC5NYXA6KCRqc2NvbXAuaW5pdFN5bWJvbCgpLCRqc2NvbXAuaW5pdFN5bWJvbEl0ZXJhdG9yKCksJGpzY29tcC5NYXAucHJvdG90eXBlW1N5bWJvbC5pdGVyYXRvcl09JGpzY29tcC5NYXAucHJvdG90eXBlLmVudHJpZXMsJGpzY29tcC5pbml0U3ltYm9sKCksJGpzY29tcC5NYXAua2V5Xz1TeW1ib2woXCJtYXAtaWQta2V5XCIpKTskanNjb21wLk1hcCRpbnN0YWxsPWZ1bmN0aW9uKCl7fX07JGpzY29tcC5tYXRoPSRqc2NvbXAubWF0aHx8e307XHJcbiRqc2NvbXAubWF0aC5jbHozMj1mdW5jdGlvbihkKXtkPU51bWJlcihkKT4+PjA7aWYoMD09PWQpcmV0dXJuIDMyO3ZhciBlPTA7MD09PShkJjQyOTQ5MDE3NjApJiYoZDw8PTE2LGUrPTE2KTswPT09KGQmNDI3ODE5MDA4MCkmJihkPDw9OCxlKz04KTswPT09KGQmNDAyNjUzMTg0MCkmJihkPDw9NCxlKz00KTswPT09KGQmMzIyMTIyNTQ3MikmJihkPDw9MixlKz0yKTswPT09KGQmMjE0NzQ4MzY0OCkmJmUrKztyZXR1cm4gZX07JGpzY29tcC5tYXRoLmltdWw9ZnVuY3Rpb24oZCxlKXtkPU51bWJlcihkKTtlPU51bWJlcihlKTt2YXIgaz1kJjY1NTM1LGI9ZSY2NTUzNTtyZXR1cm4gaypiKygoZD4+PjE2JjY1NTM1KSpiK2sqKGU+Pj4xNiY2NTUzNSk8PDE2Pj4+MCl8MH07JGpzY29tcC5tYXRoLnNpZ249ZnVuY3Rpb24oZCl7ZD1OdW1iZXIoZCk7cmV0dXJuIDA9PT1kfHxpc05hTihkKT9kOjA8ZD8xOi0xfTtcclxuJGpzY29tcC5tYXRoLmxvZzEwPWZ1bmN0aW9uKGQpe3JldHVybiBNYXRoLmxvZyhkKS9NYXRoLkxOMTB9OyRqc2NvbXAubWF0aC5sb2cyPWZ1bmN0aW9uKGQpe3JldHVybiBNYXRoLmxvZyhkKS9NYXRoLkxOMn07JGpzY29tcC5tYXRoLmxvZzFwPWZ1bmN0aW9uKGQpe2Q9TnVtYmVyKGQpO2lmKC4yNT5kJiYtLjI1PGQpe2Zvcih2YXIgZT1kLGs9MSxiPWQsYT0wLGM9MTthIT1iOyllKj1kLGMqPS0xLGI9KGE9YikrYyplLysraztyZXR1cm4gYn1yZXR1cm4gTWF0aC5sb2coMStkKX07JGpzY29tcC5tYXRoLmV4cG0xPWZ1bmN0aW9uKGQpe2Q9TnVtYmVyKGQpO2lmKC4yNT5kJiYtLjI1PGQpe2Zvcih2YXIgZT1kLGs9MSxiPWQsYT0wO2EhPWI7KWUqPWQvKytrLGI9KGE9YikrZTtyZXR1cm4gYn1yZXR1cm4gTWF0aC5leHAoZCktMX07JGpzY29tcC5tYXRoLmNvc2g9ZnVuY3Rpb24oZCl7ZD1OdW1iZXIoZCk7cmV0dXJuKE1hdGguZXhwKGQpK01hdGguZXhwKC1kKSkvMn07XHJcbiRqc2NvbXAubWF0aC5zaW5oPWZ1bmN0aW9uKGQpe2Q9TnVtYmVyKGQpO3JldHVybiAwPT09ZD9kOihNYXRoLmV4cChkKS1NYXRoLmV4cCgtZCkpLzJ9OyRqc2NvbXAubWF0aC50YW5oPWZ1bmN0aW9uKGQpe2Q9TnVtYmVyKGQpO2lmKDA9PT1kKXJldHVybiBkO3ZhciBlPU1hdGguZXhwKDIqLU1hdGguYWJzKGQpKSxlPSgxLWUpLygxK2UpO3JldHVybiAwPmQ/LWU6ZX07JGpzY29tcC5tYXRoLmFjb3NoPWZ1bmN0aW9uKGQpe2Q9TnVtYmVyKGQpO3JldHVybiBNYXRoLmxvZyhkK01hdGguc3FydChkKmQtMSkpfTskanNjb21wLm1hdGguYXNpbmg9ZnVuY3Rpb24oZCl7ZD1OdW1iZXIoZCk7aWYoMD09PWQpcmV0dXJuIGQ7dmFyIGU9TWF0aC5sb2coTWF0aC5hYnMoZCkrTWF0aC5zcXJ0KGQqZCsxKSk7cmV0dXJuIDA+ZD8tZTplfTtcclxuJGpzY29tcC5tYXRoLmF0YW5oPWZ1bmN0aW9uKGQpe2Q9TnVtYmVyKGQpO3JldHVybigkanNjb21wLm1hdGgubG9nMXAoZCktJGpzY29tcC5tYXRoLmxvZzFwKC1kKSkvMn07XHJcbiRqc2NvbXAubWF0aC5oeXBvdD1mdW5jdGlvbihkLGUsayl7Zm9yKHZhciBiPVtdLGE9MjthPGFyZ3VtZW50cy5sZW5ndGg7KythKWJbYS0yXT1hcmd1bWVudHNbYV07ZD1OdW1iZXIoZCk7ZT1OdW1iZXIoZSk7Zm9yKHZhciBjPU1hdGgubWF4KE1hdGguYWJzKGQpLE1hdGguYWJzKGUpKSxJPSRqc2NvbXAubWFrZUl0ZXJhdG9yKGIpLGE9SS5uZXh0KCk7IWEuZG9uZTthPUkubmV4dCgpKWM9TWF0aC5tYXgoYyxNYXRoLmFicyhhLnZhbHVlKSk7aWYoMUUxMDA8Y3x8MUUtMTAwPmMpe2QvPWM7ZS89YztJPWQqZCtlKmU7Yj0kanNjb21wLm1ha2VJdGVyYXRvcihiKTtmb3IoYT1iLm5leHQoKTshYS5kb25lO2E9Yi5uZXh0KCkpYT1hLnZhbHVlLGE9TnVtYmVyKGEpL2MsSSs9YSphO3JldHVybiBNYXRoLnNxcnQoSSkqY31jPWQqZCtlKmU7Yj0kanNjb21wLm1ha2VJdGVyYXRvcihiKTtmb3IoYT1iLm5leHQoKTshYS5kb25lO2E9Yi5uZXh0KCkpYT1hLnZhbHVlLGE9TnVtYmVyKGEpLGMrPVxyXG5hKmE7cmV0dXJuIE1hdGguc3FydChjKX07JGpzY29tcC5tYXRoLnRydW5jPWZ1bmN0aW9uKGQpe2Q9TnVtYmVyKGQpO2lmKGlzTmFOKGQpfHxJbmZpbml0eT09PWR8fC1JbmZpbml0eT09PWR8fDA9PT1kKXJldHVybiBkO3ZhciBlPU1hdGguZmxvb3IoTWF0aC5hYnMoZCkpO3JldHVybiAwPmQ/LWU6ZX07JGpzY29tcC5tYXRoLmNicnQ9ZnVuY3Rpb24oZCl7aWYoMD09PWQpcmV0dXJuIGQ7ZD1OdW1iZXIoZCk7dmFyIGU9TWF0aC5wb3coTWF0aC5hYnMoZCksMS8zKTtyZXR1cm4gMD5kPy1lOmV9OyRqc2NvbXAubnVtYmVyPSRqc2NvbXAubnVtYmVyfHx7fTskanNjb21wLm51bWJlci5pc0Zpbml0ZT1mdW5jdGlvbihkKXtyZXR1cm5cIm51bWJlclwiIT09dHlwZW9mIGQ/ITE6IWlzTmFOKGQpJiZJbmZpbml0eSE9PWQmJi1JbmZpbml0eSE9PWR9O1xyXG4kanNjb21wLm51bWJlci5pc0ludGVnZXI9ZnVuY3Rpb24oZCl7cmV0dXJuICRqc2NvbXAubnVtYmVyLmlzRmluaXRlKGQpP2Q9PT1NYXRoLmZsb29yKGQpOiExfTskanNjb21wLm51bWJlci5pc05hTj1mdW5jdGlvbihkKXtyZXR1cm5cIm51bWJlclwiPT09dHlwZW9mIGQmJmlzTmFOKGQpfTskanNjb21wLm51bWJlci5pc1NhZmVJbnRlZ2VyPWZ1bmN0aW9uKGQpe3JldHVybiAkanNjb21wLm51bWJlci5pc0ludGVnZXIoZCkmJk1hdGguYWJzKGQpPD0kanNjb21wLm51bWJlci5NQVhfU0FGRV9JTlRFR0VSfTskanNjb21wLm51bWJlci5FUFNJTE9OPU1hdGgucG93KDIsLTUyKTskanNjb21wLm51bWJlci5NQVhfU0FGRV9JTlRFR0VSPTkwMDcxOTkyNTQ3NDA5OTE7JGpzY29tcC5udW1iZXIuTUlOX1NBRkVfSU5URUdFUj0tOTAwNzE5OTI1NDc0MDk5MTskanNjb21wLm9iamVjdD0kanNjb21wLm9iamVjdHx8e307XHJcbiRqc2NvbXAub2JqZWN0LmFzc2lnbj1mdW5jdGlvbihkLGUpe2Zvcih2YXIgaz1bXSxiPTE7Yjxhcmd1bWVudHMubGVuZ3RoOysrYilrW2ItMV09YXJndW1lbnRzW2JdO2s9JGpzY29tcC5tYWtlSXRlcmF0b3Ioayk7Zm9yKGI9ay5uZXh0KCk7IWIuZG9uZTtiPWsubmV4dCgpKWlmKGI9Yi52YWx1ZSlmb3IodmFyIGEgaW4gYilPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYixhKSYmKGRbYV09YlthXSk7cmV0dXJuIGR9OyRqc2NvbXAub2JqZWN0LmlzPWZ1bmN0aW9uKGQsZSl7cmV0dXJuIGQ9PT1lPzAhPT1kfHwxL2Q9PT0xL2U6ZCE9PWQmJmUhPT1lfTskanNjb21wLlNldD1mdW5jdGlvbihkKXtkPXZvaWQgMD09PWQ/W106ZDt0aGlzLm1hcF89bmV3ICRqc2NvbXAuTWFwO2lmKGQpe2Q9JGpzY29tcC5tYWtlSXRlcmF0b3IoZCk7Zm9yKHZhciBlPWQubmV4dCgpOyFlLmRvbmU7ZT1kLm5leHQoKSl0aGlzLmFkZChlLnZhbHVlKX10aGlzLnNpemU9dGhpcy5tYXBfLnNpemV9O1xyXG4kanNjb21wLlNldC5jaGVja0Jyb3dzZXJDb25mb3JtYW5jZV89ZnVuY3Rpb24oKXt2YXIgZD0kanNjb21wLmdsb2JhbC5TZXQ7aWYoIWR8fCFkLnByb3RvdHlwZS5lbnRyaWVzfHwhT2JqZWN0LnNlYWwpcmV0dXJuITE7dmFyIGU9T2JqZWN0LnNlYWwoe3g6NH0pLGQ9bmV3IGQoJGpzY29tcC5tYWtlSXRlcmF0b3IoW2VdKSk7aWYoZC5oYXMoZSl8fDEhPWQuc2l6ZXx8ZC5hZGQoZSkhPWR8fDEhPWQuc2l6ZXx8ZC5hZGQoe3g6NH0pIT1kfHwyIT1kLnNpemUpcmV0dXJuITE7dmFyIGQ9ZC5lbnRyaWVzKCksaz1kLm5leHQoKTtpZihrLmRvbmV8fGsudmFsdWVbMF0hPWV8fGsudmFsdWVbMV0hPWUpcmV0dXJuITE7az1kLm5leHQoKTtyZXR1cm4gay5kb25lfHxrLnZhbHVlWzBdPT1lfHw0IT1rLnZhbHVlWzBdLnh8fGsudmFsdWVbMV0hPWsudmFsdWVbMF0/ITE6ZC5uZXh0KCkuZG9uZX07XHJcbiRqc2NvbXAuU2V0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZCl7dGhpcy5tYXBfLnNldChkLGQpO3RoaXMuc2l6ZT10aGlzLm1hcF8uc2l6ZTtyZXR1cm4gdGhpc307JGpzY29tcC5TZXQucHJvdG90eXBlW1wiZGVsZXRlXCJdPWZ1bmN0aW9uKGQpe2Q9dGhpcy5tYXBfW1wiZGVsZXRlXCJdKGQpO3RoaXMuc2l6ZT10aGlzLm1hcF8uc2l6ZTtyZXR1cm4gZH07JGpzY29tcC5TZXQucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5tYXBfLmNsZWFyKCk7dGhpcy5zaXplPTB9OyRqc2NvbXAuU2V0LnByb3RvdHlwZS5oYXM9ZnVuY3Rpb24oZCl7cmV0dXJuIHRoaXMubWFwXy5oYXMoZCl9OyRqc2NvbXAuU2V0LnByb3RvdHlwZS5lbnRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwXy5lbnRyaWVzKCl9OyRqc2NvbXAuU2V0LnByb3RvdHlwZS52YWx1ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXBfLnZhbHVlcygpfTtcclxuJGpzY29tcC5TZXQucHJvdG90eXBlLmZvckVhY2g9ZnVuY3Rpb24oZCxlKXt2YXIgaz10aGlzO3RoaXMubWFwXy5mb3JFYWNoKGZ1bmN0aW9uKGIpe3JldHVybiBkLmNhbGwoZSxiLGIsayl9KX07JGpzY29tcC5TZXQuQVNTVU1FX05PX05BVElWRT0hMTskanNjb21wLlNldCRpbnN0YWxsPWZ1bmN0aW9uKCl7ISRqc2NvbXAuU2V0LkFTU1VNRV9OT19OQVRJVkUmJiRqc2NvbXAuU2V0LmNoZWNrQnJvd3NlckNvbmZvcm1hbmNlXygpPyRqc2NvbXAuU2V0PSRqc2NvbXAuZ2xvYmFsLlNldDooJGpzY29tcC5NYXAkaW5zdGFsbCgpLCRqc2NvbXAuaW5pdFN5bWJvbCgpLCRqc2NvbXAuaW5pdFN5bWJvbEl0ZXJhdG9yKCksJGpzY29tcC5TZXQucHJvdG90eXBlW1N5bWJvbC5pdGVyYXRvcl09JGpzY29tcC5TZXQucHJvdG90eXBlLnZhbHVlcyk7JGpzY29tcC5TZXQkaW5zdGFsbD1mdW5jdGlvbigpe319OyRqc2NvbXAuc3RyaW5nPSRqc2NvbXAuc3RyaW5nfHx7fTtcclxuJGpzY29tcC5zdHJpbmcubm9SZWdFeHBfPWZ1bmN0aW9uKGQsZSl7aWYoZCBpbnN0YW5jZW9mIFJlZ0V4cCl0aHJvdyBuZXcgVHlwZUVycm9yKFwiRmlyc3QgYXJndW1lbnQgdG8gU3RyaW5nLnByb3RvdHlwZS5cIitlK1wiIG11c3Qgbm90IGJlIGEgcmVndWxhciBleHByZXNzaW9uXCIpO307XHJcbiRqc2NvbXAuc3RyaW5nLmZyb21Db2RlUG9pbnQ9ZnVuY3Rpb24oZCl7Zm9yKHZhciBlPVtdLGs9MDtrPGFyZ3VtZW50cy5sZW5ndGg7KytrKWVbay0wXT1hcmd1bWVudHNba107Zm9yKHZhciBrPVwiXCIsZT0kanNjb21wLm1ha2VJdGVyYXRvcihlKSxiPWUubmV4dCgpOyFiLmRvbmU7Yj1lLm5leHQoKSl7Yj1iLnZhbHVlO2I9K2I7aWYoMD5ifHwxMTE0MTExPGJ8fGIhPT1NYXRoLmZsb29yKGIpKXRocm93IG5ldyBSYW5nZUVycm9yKFwiaW52YWxpZF9jb2RlX3BvaW50IFwiK2IpOzY1NTM1Pj1iP2srPVN0cmluZy5mcm9tQ2hhckNvZGUoYik6KGItPTY1NTM2LGsrPVN0cmluZy5mcm9tQ2hhckNvZGUoYj4+PjEwJjEwMjN8NTUyOTYpLGsrPVN0cmluZy5mcm9tQ2hhckNvZGUoYiYxMDIzfDU2MzIwKSl9cmV0dXJuIGt9O1xyXG4kanNjb21wLnN0cmluZy5yZXBlYXQ9ZnVuY3Rpb24oZCl7dmFyIGU9dGhpcy50b1N0cmluZygpO2lmKDA+ZHx8MTM0MjE3NzI3OTxkKXRocm93IG5ldyBSYW5nZUVycm9yKFwiSW52YWxpZCBjb3VudCB2YWx1ZVwiKTtkfD0wO2Zvcih2YXIgaz1cIlwiO2Q7KWlmKGQmMSYmKGsrPWUpLGQ+Pj49MSllKz1lO3JldHVybiBrfTskanNjb21wLnN0cmluZy5yZXBlYXQkaW5zdGFsbD1mdW5jdGlvbigpe1N0cmluZy5wcm90b3R5cGUucmVwZWF0fHwoU3RyaW5nLnByb3RvdHlwZS5yZXBlYXQ9JGpzY29tcC5zdHJpbmcucmVwZWF0KX07XHJcbiRqc2NvbXAuc3RyaW5nLmNvZGVQb2ludEF0PWZ1bmN0aW9uKGQpe3ZhciBlPXRoaXMudG9TdHJpbmcoKSxrPWUubGVuZ3RoO2Q9TnVtYmVyKGQpfHwwO2lmKDA8PWQmJmQ8ayl7ZHw9MDt2YXIgYj1lLmNoYXJDb2RlQXQoZCk7aWYoNTUyOTY+Ynx8NTYzMTk8Ynx8ZCsxPT09aylyZXR1cm4gYjtkPWUuY2hhckNvZGVBdChkKzEpO3JldHVybiA1NjMyMD5kfHw1NzM0MzxkP2I6MTAyNCooYi01NTI5NikrZCs5MjE2fX07JGpzY29tcC5zdHJpbmcuY29kZVBvaW50QXQkaW5zdGFsbD1mdW5jdGlvbigpe1N0cmluZy5wcm90b3R5cGUuY29kZVBvaW50QXR8fChTdHJpbmcucHJvdG90eXBlLmNvZGVQb2ludEF0PSRqc2NvbXAuc3RyaW5nLmNvZGVQb2ludEF0KX07XHJcbiRqc2NvbXAuc3RyaW5nLmluY2x1ZGVzPWZ1bmN0aW9uKGQsZSl7ZT12b2lkIDA9PT1lPzA6ZTskanNjb21wLnN0cmluZy5ub1JlZ0V4cF8oZCxcImluY2x1ZGVzXCIpO3JldHVybi0xIT09dGhpcy50b1N0cmluZygpLmluZGV4T2YoZCxlKX07JGpzY29tcC5zdHJpbmcuaW5jbHVkZXMkaW5zdGFsbD1mdW5jdGlvbigpe1N0cmluZy5wcm90b3R5cGUuaW5jbHVkZXN8fChTdHJpbmcucHJvdG90eXBlLmluY2x1ZGVzPSRqc2NvbXAuc3RyaW5nLmluY2x1ZGVzKX07XHJcbiRqc2NvbXAuc3RyaW5nLnN0YXJ0c1dpdGg9ZnVuY3Rpb24oZCxlKXtlPXZvaWQgMD09PWU/MDplOyRqc2NvbXAuc3RyaW5nLm5vUmVnRXhwXyhkLFwic3RhcnRzV2l0aFwiKTt2YXIgaz10aGlzLnRvU3RyaW5nKCk7ZCs9XCJcIjtmb3IodmFyIGI9ay5sZW5ndGgsYT1kLmxlbmd0aCxjPU1hdGgubWF4KDAsTWF0aC5taW4oZXwwLGsubGVuZ3RoKSksST0wO0k8YSYmYzxiOylpZihrW2MrK10hPWRbSSsrXSlyZXR1cm4hMTtyZXR1cm4gST49YX07JGpzY29tcC5zdHJpbmcuc3RhcnRzV2l0aCRpbnN0YWxsPWZ1bmN0aW9uKCl7U3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRofHwoU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoPSRqc2NvbXAuc3RyaW5nLnN0YXJ0c1dpdGgpfTtcclxuJGpzY29tcC5zdHJpbmcuZW5kc1dpdGg9ZnVuY3Rpb24oZCxlKXskanNjb21wLnN0cmluZy5ub1JlZ0V4cF8oZCxcImVuZHNXaXRoXCIpO3ZhciBrPXRoaXMudG9TdHJpbmcoKTtkKz1cIlwiO3ZvaWQgMD09PWUmJihlPWsubGVuZ3RoKTtmb3IodmFyIGI9TWF0aC5tYXgoMCxNYXRoLm1pbihlfDAsay5sZW5ndGgpKSxhPWQubGVuZ3RoOzA8YSYmMDxiOylpZihrWy0tYl0hPWRbLS1hXSlyZXR1cm4hMTtyZXR1cm4gMD49YX07JGpzY29tcC5zdHJpbmcuZW5kc1dpdGgkaW5zdGFsbD1mdW5jdGlvbigpe1N0cmluZy5wcm90b3R5cGUuZW5kc1dpdGh8fChTdHJpbmcucHJvdG90eXBlLmVuZHNXaXRoPSRqc2NvbXAuc3RyaW5nLmVuZHNXaXRoKX07XHJcbihmdW5jdGlvbihkLGUpe1wib2JqZWN0XCI9PT10eXBlb2YgZXhwb3J0cyYmXCJvYmplY3RcIj09PXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9ZSgpOlwiZnVuY3Rpb25cIj09PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtdLGUpOlwib2JqZWN0XCI9PT10eXBlb2YgZXhwb3J0cz9leHBvcnRzLkNpdHJpeFdlYlJUQz1lKCk6ZC5DaXRyaXhXZWJSVEM9ZSgpfSkoc2VsZixmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbigpe2Z1bmN0aW9uIGQoYil7dmFyIGE9a1tiXTtpZih2b2lkIDAhPT1hKXJldHVybiBhLmV4cG9ydHM7YT1rW2JdPXtleHBvcnRzOnt9fTtlW2JdLmNhbGwoYS5leHBvcnRzLGEsYS5leHBvcnRzLGQpO3JldHVybiBhLmV4cG9ydHN9dmFyIGU9ezk0NTpmdW5jdGlvbihiLGEsYyl7dmFyIGQ9dGhpcyYmdGhpcy5fX2V4dGVuZHN8fGZ1bmN0aW9uKCl7dmFyIGE9ZnVuY3Rpb24oYixjKXthPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mXHJcbkFycmF5JiZmdW5jdGlvbihhLGIpe2EuX19wcm90b19fPWJ9fHxmdW5jdGlvbihhLGIpe2Zvcih2YXIgYyBpbiBiKWIuaGFzT3duUHJvcGVydHkoYykmJihhW2NdPWJbY10pfTtyZXR1cm4gYShiLGMpfTtyZXR1cm4gZnVuY3Rpb24oYixjKXtmdW5jdGlvbiBkKCl7dGhpcy5jb25zdHJ1Y3Rvcj1ifWEoYixjKTtiLnByb3RvdHlwZT1udWxsPT09Yz9PYmplY3QuY3JlYXRlKGMpOihkLnByb3RvdHlwZT1jLnByb3RvdHlwZSxuZXcgZCl9fSgpO09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBuPWMoNjU4KSxFPWMoNTUwKSxtPWMoODUxKSxwPWMoOTQ2KTtiPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXt2YXIgYz1hLmNhbGwodGhpcyxudWxsLEUuY2xhc3NfaWRfdC5BdWRpb0VsZW1lbnQsMCxuLlByb3h5TW9kZS5Mb2NhbCl8fHRoaXM7Yy5zaW5rSWRfPVwiXCI7Yy5zcmNPYmplY3RfPW51bGw7cmV0dXJuIGN9ZChiLGEpO2IucHJvdG90eXBlLnNldFNpbmtJZD1cclxuZnVuY3Rpb24oYSl7dmFyIGI9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0U2lua0lkOiBzZXQgc2lua0lkIHRvIFwiK2EpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihjLGQpe2Iud2FpdFVudGlsQ29ubmVjdGVkKFwiQXVkaW9FbGVtZW50LnNpbmtJZFwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGQ9Yi5yZW1vdGVJbnZva2UoITAsRS5tZXRob2RfaWRfQXVkaW9FbGVtZW50X3Quc2lua0lkLGEpO3AuZ2V0UmVkaXJlY3RvcigpLmdldEZlYXR1cmVWYWx1ZShFLkZFQVRVUkVfbXNfdGVhbXNfcHN0bil8fChiLnNpbmtJZF89YSxjKCkpO3JldHVybiBkfSkudGhlbihmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRTaW5rSWQ6IHN1Y2Nlc3MhIHJlc29sdmluZy4uLlwiKTtiLnNpbmtJZF89YTtjKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnNpbmtJZCBzZXR0ZXI6IGZhaWxlZCB0byBjb25uZWN0IVwiKTtcclxuZChhKX0pfSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInNpbmtJZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zaW5rSWRffSxzZXQ6ZnVuY3Rpb24oYSl7dGhpcy5zZXRTaW5rSWQoYSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwic3JjT2JqZWN0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNyY09iamVjdF99LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zcmNPYmplY3Q6IHNldCBzcmNPYmplY3QgdG8gXCIrSlNPTi5zdHJpbmdpZnkoYSkpO2lmKGEhPT10aGlzLnNyY09iamVjdF8pe3RoaXMuc3JjT2JqZWN0Xz1hO3ZhciBjPW51bGwhPT1hJiZ2b2lkIDAhPT1hP2EuaWQ6XCJudWxsXCI7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJBdWRpb0VsZW1lbnQuc3JjT2JqZWN0XCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsXHJcbkUubWV0aG9kX2lkX0F1ZGlvRWxlbWVudF90LnNyY09iamVjdCxjKX0pLnRoZW4oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3JjT2JqZWN0IHNldHRlcjogcmVtb3RlIHN1Y2Nlc3MhXCIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc3JjT2JqZWN0IHNldHRlcjogZmFpbGVkIHRvIGNvbm5lY3QhXCIpfSl9fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInNyY1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zcmNffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3JjOiBzZXQgc3JjIHRvIFwiK2EpO3RoaXMuc3JjXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiQXVkaW9FbGVtZW50LnNyY1wiKS50aGVuKGZ1bmN0aW9uKCl7Yi5yZW1vdGVJbnZva2UoITAsXHJcbkUubWV0aG9kX2lkX0F1ZGlvRWxlbWVudF90LnNyYyxhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnNyYyBzZXR0ZXI6IGZhaWxlZCB0byBjb25uZWN0IVwiKX0pfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLnBsYXk9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5wbGF5KCkgY2FsbGVkLlwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixjKXthLnRvZ2dsZUF1ZGlvKCEwKTthLndhaXRVbnRpbENvbm5lY3RlZChcIkF1ZGlvRWxlbWVudC5wbGF5XCIpLnRoZW4oZnVuY3Rpb24oKXthLnJlbW90ZUludm9rZSghMSxFLm1ldGhvZF9pZF9BdWRpb0VsZW1lbnRfdC5wbGF5LFtdKS50aGVuKGZ1bmN0aW9uKCl7YigpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIucGxheTogZmFpbGVkIHRvIHJlbW90ZSFcIik7XHJcbmMoKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIucGxheTogZmFpbGVkIHRvIGNvbm5lY3QhXCIpO2MoKX0pfSl9O2IucHJvdG90eXBlLnBhdXNlPWZ1bmN0aW9uKCl7dmFyIGE9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucGF1c2UoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2EudG9nZ2xlQXVkaW8oITEpO2Eud2FpdFVudGlsQ29ubmVjdGVkKFwiQXVkaW9FbGVtZW50LnBhdXNlXCIpLnRoZW4oZnVuY3Rpb24oKXthLnJlbW90ZUludm9rZSghMSxFLm1ldGhvZF9pZF9BdWRpb0VsZW1lbnRfdC5wYXVzZSxbXSkudGhlbihmdW5jdGlvbigpe2IoKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLnBhdXNlOiBmYWlsZWQgdG8gcmVtb3RlIVwiKTtjKCl9KX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFxyXG5cIi5wYXVzZTogZmFpbGVkIHRvIGNvbm5lY3QhXCIpO2MoKX0pfSl9O2IucHJvdG90eXBlLnRvZ2dsZUF1ZGlvPWZ1bmN0aW9uKGEpe3RoaXMuc3JjT2JqZWN0XyYmKG0ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi50b2dnbGVBdWRpbygpIHRvZ2dsZSBhdWRpbyB0cmFja3M6XCIrYSksdGhpcy5zcmNPYmplY3RfLnRvZ2dsZUF1ZGlvKGEpKX07Yi5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5kaXNwb3NlKClcIik7dGhpcy5zcmNfPXRoaXMuc2lua0lkXz1cIlwiO3RoaXMuc3JjT2JqZWN0Xz1udWxsO3RoaXMucmVsZWFzZSgpfTtyZXR1cm4gYn0obi5Qcm94eU9iamVjdCk7YS5BdWRpb0VsZW1lbnQ9Yn0sOTpmdW5jdGlvbihiLGEsYyl7dmFyIGQ9dGhpcyYmdGhpcy5fX2V4dGVuZHN8fGZ1bmN0aW9uKCl7dmFyIGE9ZnVuY3Rpb24oYixjKXthPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mXHJcbkFycmF5JiZmdW5jdGlvbihhLGIpe2EuX19wcm90b19fPWJ9fHxmdW5jdGlvbihhLGIpe2Zvcih2YXIgYyBpbiBiKWIuaGFzT3duUHJvcGVydHkoYykmJihhW2NdPWJbY10pfTtyZXR1cm4gYShiLGMpfTtyZXR1cm4gZnVuY3Rpb24oYixjKXtmdW5jdGlvbiBkKCl7dGhpcy5jb25zdHJ1Y3Rvcj1ifWEoYixjKTtiLnByb3RvdHlwZT1udWxsPT09Yz9PYmplY3QuY3JlYXRlKGMpOihkLnByb3RvdHlwZT1jLnByb3RvdHlwZSxuZXcgZCl9fSgpO09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBuPWMoNTUwKSxFPWMoOTQ2KSxtPWMoNjU4KSxwPWMoODUxKTsoZnVuY3Rpb24oYSl7YVthLldlYnJwYz0wXT1cIldlYnJwY1wiO2FbYS5XZWJydGNDb2RlY3M9MV09XCJXZWJydGNDb2RlY3NcIjthW2EuUmVjZWl2ZXI9Ml09XCJSZWNlaXZlclwiO2FbYS5WZGE9M109XCJWZGFcIjthW2EuRW5kcG9pbnQ9NF09XCJFbmRwb2ludFwiO2FbYS5UeXBlU2NyaXB0PTVdPVwiVHlwZVNjcmlwdFwiO1xyXG5hW2EuTWF4PTZdPVwiTWF4XCJ9KShhLlZlcnNpb25UeXBlfHwoYS5WZXJzaW9uVHlwZT17fSkpO2I9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYigpe3JldHVybiBhLmNhbGwodGhpcyxudWxsLG4uY2xhc3NfaWRfdC5FbmdpbmVDb250cm9sLDAsbS5Qcm94eU1vZGUuTG9jYWwpfHx0aGlzfWQoYixhKTtiLnByb3RvdHlwZS5iaW5kPWZ1bmN0aW9uKCl7cC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmJpbmQoKSBjYWxsZWQuXCIpO3RoaXMucmVjb25zdHJ1Y3RvcihudWxsLG4uY2xhc3NfaWRfdC5FbmdpbmVDb250cm9sLDApfTtiLnByb3RvdHlwZS5zeW5jQmFycmllcj1mdW5jdGlvbigpe3ZhciBhPXRoaXM7cC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyKCkgY2FsbGVkLlwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixjKXthLndhaXRVbnRpbENvbm5lY3RlZChcIkVuZ2luZUNvbnRyb2wuc3luY0JhcnJpZXJcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEsXHJcbm4ubWV0aG9kX2lkX0VuZ2luZUNvbnRyb2xfdC52ZXJzaW9uLHttYWpvcjowLG1pbm9yOjAscmV2aXNpb246MCxidWlsZDowfSksYS5yZW1vdGVJbnZva2UoITEsbi5tZXRob2RfaWRfRW5naW5lQ29udHJvbF90LmZlYXR1cmVfZmxhZ3MsW10pXSl9KS50aGVuKGZ1bmN0aW9uKGIpe3AubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcInJlY2VpdmVkIHdlYnJwYyB2ZXJzaW9uIGFuZCBzdXBwb3J0ZWQgZmVhdHVyZSBsaXN0LlwiKTtiPWIubWFwKGZ1bmN0aW9uKGIpe3JldHVybiBhLnBhcmFtMChiKX0pO2EudmVyc2lvbl89YlswXTthLmZlYXR1cmVzXz1iWzFdO0UuZ2V0UmVkaXJlY3RvcigpLnNldEZlYXR1cmVzKGEuZmVhdHVyZXNfKTtiPVtdO2Zvcih2YXIgYz0wLGY9YS5mZWF0dXJlc187YzxmLmxlbmd0aDtjKyspe3ZhciBkPWZbY107XCJtc190ZWFtc19kZXNrdG9wX3NoYXJpbmdcIj09PWQubmFtZSYmZC52YWx1ZT9iLnB1c2goYS5yZW1vdGVJbnZva2UoITEsbi5tZXRob2RfaWRfRW5naW5lQ29udHJvbF90LnZlcnNpb25faW5mbyxcclxuW10pKTpcIm1zX3RlYW1zX29zaW5mb1wiPT09ZC5uYW1lJiZkLnZhbHVlP2IucHVzaChhLnJlbW90ZUludm9rZSghMSxuLm1ldGhvZF9pZF9FbmdpbmVDb250cm9sX3Qub3NpbmZvLHtmYW1pbHk6XCJcIix2ZXJzaW9uOlwiXCIsYXJjaGl0ZWN0dXJlOlwiXCIsZGlzdHJvOlwiXCIsZWRpdGlvbjpcIlwifSkpOlwibXNfdGVhbXNfZW5kcG9pbnRfaWRcIj09PWQubmFtZSYmZC52YWx1ZSYmYi5wdXNoKGEucmVtb3RlSW52b2tlKCExLG4ubWV0aG9kX2lkX0VuZ2luZUNvbnRyb2xfdC5lbmRwb2ludF9pZCx7bWFjaGluZV9pZDpcIlwiLHVzZXJfaWQ6XCJcIn0pKX1pZigwPGIubGVuZ3RoKXJldHVybiBQcm9taXNlLmFsbChiKX0pLnRoZW4oZnVuY3Rpb24oYyl7aWYodm9pZCAwPT09YylwLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCJyZWxlYXNlLTE5MDUgY2xpZW50LlwiKTtlbHNle3AubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcInJlbGVhc2UtMTkwNiBvciBsYXRlciBjbGllbnQ6IHJlY2VpdmVkIGRldGFpbGVkIGNsaWVudCB2ZXJzaW9uIGxpc3QuXCIpO1xyXG5mb3IodmFyIGQ9MDtkPGMubGVuZ3RoO2QrKyl7dmFyIGY9Y1tkXTtmLmhkci5wcm9jLmlpZD09bi5jbGFzc19pZF90LkVuZ2luZUNvbnRyb2wmJmYuaGRyLnByb2MubWV0aG9kaWQ9PW4ubWV0aG9kX2lkX0VuZ2luZUNvbnRyb2xfdC52ZXJzaW9uX2luZm8/YS52ZXJzaW9uc189YS5wYXJhbTAoZik6Zi5oZHIucHJvYy5paWQ9PW4uY2xhc3NfaWRfdC5FbmdpbmVDb250cm9sJiZmLmhkci5wcm9jLm1ldGhvZGlkPT1uLm1ldGhvZF9pZF9FbmdpbmVDb250cm9sX3Qub3NpbmZvP2Eub3NpbmZvXz1hLnBhcmFtMChmKTpmLmhkci5wcm9jLmlpZD09bi5jbGFzc19pZF90LkVuZ2luZUNvbnRyb2wmJmYuaGRyLnByb2MubWV0aG9kaWQ9PW4ubWV0aG9kX2lkX0VuZ2luZUNvbnRyb2xfdC5lbmRwb2ludF9pZCYmKGEuZW5kcG9pbnRpZF89YS5wYXJhbTAoZikpfX1iKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtiPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcImZhaWx1cmUgdG8gcmV0cmlldmUgdmVyc2lvbi9mZWF0dXJlIHJlbGF0ZWQgY2xpZW50IGluZm8uXCIpO1xyXG5jKGIpfSl9KX07cmV0dXJuIGJ9KG0uUHJveHlPYmplY3QpO2EuRW5naW5lQ29udHJvbD1ifSwzNjg6ZnVuY3Rpb24oYixhLGMpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBkPWMoODUxKSxuPWMoOTQ2KTtiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe3ZhciBiPXRoaXM7dGhpcy5ydW5uaW5nXz0hMTt0aGlzLmVsZW1lbnRzXz1bXTt0aGlzLmNsaXBSZWN0cz1uZXcgU2V0O3RoaXMud2hlZWxFdmVudEhhbmRsZXI9ZnVuY3Rpb24oYSl7c2V0VGltZW91dChmdW5jdGlvbigpe2IudXBkYXRlQWxsKCl9LDEwKX07dGhpcy5rZXl1cEV2ZW50SGFuZGxlcj1mdW5jdGlvbihhKXtcIlRhYlwiIT1hLmNvZGUmJlwiQXJyb3dVcFwiIT1hLmNvZGUmJlwiQXJyb3dEb3duXCIhPWEuY29kZSYmXCJBcnJvd0xlZnRcIiE9YS5jb2RlJiZcIkFycm93UmlnaHRcIiE9YS5jb2RlJiZcIlBhZ2VVcFwiIT1hLmNvZGUmJlwiUGFnZURvd25cIiE9YS5jb2RlJiZcIkhvbWVcIiE9YS5jb2RlJiZcclxuXCJFbmRcIiE9YS5jb2RlfHxiLnVwZGF0ZUFsbCgpfTthLnNlbmRPdmVybGF5SW5mbygpO3RoaXMub2JzZXJ2ZXJfPW5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uKGEpe2IudXBkYXRlQWxsKCl9KX1hLnNlbmRPdmVybGF5SW5mbz1mdW5jdGlvbigpe3ZhciBhPXdpbmRvdy5nZXRXaW5kb3dIYW5kbGVBc0hleDtpZih2b2lkIDA9PT1hfHxudWxsPT09YSlkLmxvZ2dlci5sb2coXCJGcmFtZVRyYWNrZXIuc2VuZE92ZXJsYXlJbmZvOiBnZXRXaW5kb3dIYW5kbGUgbWV0aG9kIGlzIHVuZGVmaW5lZCBvciBudWxsXCIpO2Vsc2V7dmFyIGI9bi5nZXRSZWRpcmVjdG9yKCk7UHJvbWlzZS5hbGwoW2EoKSxiLnN0YXJ0UmVkaXJlY3Rpb24oITEsXCJzZW5kT3ZlcmxheUluZm9cIildKS50aGVuKGZ1bmN0aW9uKGEpe2QubG9nZ2VyLmxvZyhcIkZyYW1lVHJhY2tlci5zZW5kT3ZlcmxheUluZm86IHNldCB3aW5kb3cgaGFuZGxlOiBcIithWzBdKTtiLldTU2VuZE9iamVjdCh7djpcIm92ZXJsYXlcIixjb21tYW5kOlwid2luZG93XCIsXHJcbndpbmRvd0hhbmRsZTphWzBdfSl9KX19O2EucHJvdG90eXBlLnJlY3RhbmdsZXNJbnRlcnNlY3Q9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS54PGIueCtiLndpZHRoJiZhLngrYS53aWR0aD5iLngmJmEueTxiLnkrYi5oZWlnaHQmJmEueSthLmhlaWdodD5iLnk/ITA6ITF9O2EucHJvdG90eXBlLmludGVyc2VjdGluZ1JlY3Q9ZnVuY3Rpb24oYSxiKXt2YXIgYz1NYXRoLm1heChhLmxlZnQsYi5sZWZ0KSxkPU1hdGgubWF4KGEudG9wLGIudG9wKTtyZXR1cm4gbmV3IERPTVJlY3QoYyxkLE1hdGgubWluKGEucmlnaHQsYi5yaWdodCktYyxNYXRoLm1pbihhLmJvdHRvbSxiLmJvdHRvbSktZCl9O2EucHJvdG90eXBlLnBlZGlncmVlQ291bnQ9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MCxkPWEucGFyZW50RWxlbWVudDtudWxsIT1kJiZkIT1iOyljKyssZD1kLnBhcmVudEVsZW1lbnQ7cmV0dXJue2lzQW5jZXN0b3I6bnVsbCE9ZCxwZWRpZ3JlZTpjfX07YS5wcm90b3R5cGUuc2VsZWN0VG9wbW9zdD1cclxuZnVuY3Rpb24oYSxiKXt2YXIgYz1hLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGQ9Yi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxjPXRoaXMuaW50ZXJzZWN0aW5nUmVjdChjLGQpLGQ9ZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChjLmxlZnQrYy53aWR0aC8yLGMudG9wK2MuaGVpZ2h0LzIpO2lmKGQ9PWEpcmV0dXJuIGE7aWYoZD09YilyZXR1cm4gYjtjPXRoaXMucGVkaWdyZWVDb3VudChhLGQpO2Q9dGhpcy5wZWRpZ3JlZUNvdW50KGIsZCk7aWYoYy5pc0FuY2VzdG9yJiZkLmlzQW5jZXN0b3Ipe2lmKGMucGVkaWdyZWU8ZC5wZWRpZ3JlZSlyZXR1cm4gYTtpZihkLnBlZGlncmVlPGMucGVkaWdyZWUpcmV0dXJuIGJ9ZWxzZXtpZihjLmlzQW5jZXN0b3IpcmV0dXJuIGE7aWYoZC5pc0FuY2VzdG9yKXJldHVybiBifX07YS5wcm90b3R5cGUuY2hlY2tPdmVybGFwcGluZ1ZpZGVvcz1mdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9YS50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbmEub3ZlcmxhcHMuZm9yRWFjaChmdW5jdGlvbihiKXthLnRhcmdldC5yZW1vdGVWaWRlb0VsZW1lbnQucmVtb3ZlQ2xpcFJlY3QoYi5yZWN0KX0pO2Eub3ZlcmxhcHM9W107dGhpcy5lbGVtZW50c18uZm9yRWFjaChmdW5jdGlvbihkKXtpZihkIT1hKXt2YXIgbj1kLm92ZXJsYXBzLm1hcChmdW5jdGlvbihhKXtyZXR1cm4gYS5lbGVtZW50fSkuaW5kZXhPZihhLnRhcmdldCk7LTEhPW4mJihuPWQub3ZlcmxhcHMuc3BsaWNlKG4sMSlbMF0sZC50YXJnZXQucmVtb3RlVmlkZW9FbGVtZW50LnJlbW92ZUNsaXBSZWN0KG4ucmVjdCkpO249ZC50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7aWYoYi5yZWN0YW5nbGVzSW50ZXJzZWN0KGMsbikpe3ZhciB2PWIuc2VsZWN0VG9wbW9zdChhLnRhcmdldCxkLnRhcmdldCk7dj09YS50YXJnZXQ/KGQub3ZlcmxhcHMucHVzaCh7ZWxlbWVudDphLnRhcmdldCxyZWN0OmN9KSxkLnRhcmdldC5yZW1vdGVWaWRlb0VsZW1lbnQuYWRkQ2xpcFJlY3QoYykpOlxyXG52PT1kLnRhcmdldCYmKGEub3ZlcmxhcHMucHVzaCh7ZWxlbWVudDpkLnRhcmdldCxyZWN0Om59KSxhLnRhcmdldC5yZW1vdGVWaWRlb0VsZW1lbnQuYWRkQ2xpcFJlY3QobikpfX19KX07YS5wcm90b3R5cGUudXBkYXRlQWxsPWZ1bmN0aW9uKCl7dmFyIGE9dGhpczt0aGlzLmVsZW1lbnRzXy5mb3JFYWNoKGZ1bmN0aW9uKGIpe3ZhciBjPWIudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO2lmKHZvaWQgMCE9PWMpe3ZhciBkPWIuY2xpZW50UmVjdDtpZih2b2lkIDA9PT1kfHxkLnghPT1jLnh8fGQueSE9PWMueXx8ZC53aWR0aCE9PWMud2lkdGh8fGQuaGVpZ2h0IT09Yy5oZWlnaHQpYi5jbGllbnRSZWN0PWMsYi5jYWxsYmFjayhjKSxhLmNoZWNrT3ZlcmxhcHBpbmdWaWRlb3MoYil9fSl9O2EucHJvdG90eXBlLnRyYWNrPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxnPWEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7ZC5sb2dnZXIubG9nKFwiVHJhY2sgZWxlbWVudCBmcmFtZVwiLFxyXG5hLEpTT04uc3RyaW5naWZ5KGcpKTtjb25zb2xlLmxvZyhhKTt0aGlzLmVsZW1lbnRzXy5wdXNoKHt0YXJnZXQ6YSxjbGllbnRSZWN0OnZvaWQgMCxjYWxsYmFjazpiLG92ZXJsYXBzOltdfSk7dHJ5e2QubG9nZ2VyLmxvZyhcIltIZHhXZWJSVEMuanNdIEluaXRpYWxpemluZyBvY2NsdXNpb24gZm9yIG5ldyB2aWRlb0VsZW1lbnRcIiksdGhpcy5jbGlwUmVjdHMuZm9yRWFjaChmdW5jdGlvbihiKXtjLmFwcGx5T2NjbHVzaW9uKGEsSlNPTi5wYXJzZShiKSl9KX1jYXRjaChuKXtkLmxvZ2dlci5sb2coXCJbSGR4V2ViUlRDLmpzXSBhZGRPY2NsdXNpb25Jbml0IGZhaWxlZCEgXCIrbil9dGhpcy5ydW5uaW5nX3x8KGQubG9nZ2VyLmxvZyhcIlN0YXJ0IEZyYW1lVHJhY2tlciBvYnNlcnZlci4uLlwiKSx0aGlzLm9ic2VydmVyXy5vYnNlcnZlKGRvY3VtZW50LmJvZHkse2F0dHJpYnV0ZXM6ITAsY2hpbGRMaXN0OiEwLHN1YnRyZWU6ITB9KSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIndoZWVsXCIsdGhpcy53aGVlbEV2ZW50SGFuZGxlciksXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIix0aGlzLmtleXVwRXZlbnRIYW5kbGVyKSx0aGlzLnJ1bm5pbmdfPSEwKTt0aGlzLnVwZGF0ZUFsbCgpfTthLnByb3RvdHlwZS51bnRyYWNrPWZ1bmN0aW9uKGEpe2QubG9nZ2VyLmxvZyhcIlVudHJhY2sgZWxlbWVudCBmcmFtZVwiLGEpO3ZhciBiPS0xO3RoaXMuZWxlbWVudHNfLmZvckVhY2goZnVuY3Rpb24oYyxkKXtjLnRhcmdldD09PWEmJihiPWQpfSk7MDw9YiYmKHRoaXMuZWxlbWVudHNfLnNwbGljZShiLDEpLDA9PT10aGlzLmVsZW1lbnRzXy5sZW5ndGgmJihkLmxvZ2dlci5sb2coXCJTdG9wIEZyYW1lVHJhY2tlciBvYnNlcnZlci4uLlwiKSx0aGlzLm9ic2VydmVyXy5kaXNjb25uZWN0KCksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLHRoaXMud2hlZWxFdmVudEhhbmRsZXIpLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIix0aGlzLmtleXVwRXZlbnRIYW5kbGVyKSx0aGlzLnJ1bm5pbmdfPSExKSl9O1xyXG5hLnByb3RvdHlwZS5hcHBseU9jY2x1c2lvbj1mdW5jdGlvbihhLGIpe3ZhciBjPWEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7dGhpcy5yZWN0YW5nbGVzSW50ZXJzZWN0KGIsYykmJnZvaWQgMCE9PWEucmVtb3RlVmlkZW9FbGVtZW50JiZhLnJlbW90ZVZpZGVvRWxlbWVudC5hZGRDbGlwUmVjdChiKX07YS5wcm90b3R5cGUuYWRkT2NjbHVzaW9uPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7ZC5sb2dnZXIubG9nKFwiW0hkeFdlYlJUQy5qc10gQWRkaW5nIG9jY2x1c2lvbiBcIitKU09OLnN0cmluZ2lmeShhKSk7ZC5sb2dnZXIubG9nKFwiW0hkeFdlYlJUQy5qc10gVHJhY2tpbmcgJ1wiK3RoaXMuZWxlbWVudHNfLmxlbmd0aCtcIicgZWxlbWVudHMuXCIpO3RoaXMuY2xpcFJlY3RzLmFkZChKU09OLnN0cmluZ2lmeShhKSk7dGhpcy5lbGVtZW50c18uZm9yRWFjaChmdW5jdGlvbihjKXtiLmFwcGx5T2NjbHVzaW9uKGMudGFyZ2V0LGEpfSl9O2EucHJvdG90eXBlLnJlbW92ZU9jY2x1c2lvbj1mdW5jdGlvbihhKXtkLmxvZ2dlci5sb2coXCJbSGR4V2ViUlRDLmpzXSBSZW1vdmluZyBvY2NsdXNpb24gXCIrXHJcbkpTT04uc3RyaW5naWZ5KGEpKTtkLmxvZ2dlci5sb2coXCJbSGR4V2ViUlRDLmpzXSBUcmFja2luZyAnXCIrdGhpcy5lbGVtZW50c18ubGVuZ3RoK1wiJyBlbGVtZW50cy5cIik7dGhpcy5jbGlwUmVjdHNbXCJkZWxldGVcIl0oSlNPTi5zdHJpbmdpZnkoYSkpO3RoaXMuZWxlbWVudHNfLmZvckVhY2goZnVuY3Rpb24oYil7dm9pZCAwIT09Yi50YXJnZXQucmVtb3RlVmlkZW9FbGVtZW50JiZiLnRhcmdldC5yZW1vdGVWaWRlb0VsZW1lbnQucmVtb3ZlQ2xpcFJlY3QoYSl9KX07cmV0dXJuIGF9KCk7YS5GcmFtZVRyYWNrZXI9Yn0sMjQ3OmZ1bmN0aW9uKGIsYSl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIpe3RoaXMucGFyZW50Xz10aGlzLm9iamVjdF89bnVsbDt0aGlzLmNoaWxkcmVuXz1bXTt0aGlzLm9iamVjdF89Yn1hLnByb3RvdHlwZS5hZGRDaGlsZD1mdW5jdGlvbihhKXthLnBhcmVudF8hPXRoaXMmJlxyXG4oYS5wYXJlbnRfPXRoaXMsdGhpcy5jaGlsZHJlbl8ucHVzaChhKSl9O2EucHJvdG90eXBlLnJlbW92ZUNoaWxkPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hpbGRyZW5fLmluZGV4T2YoYSk7dGhpcy5jaGlsZHJlbl8uc3BsaWNlKGIsMSk7YS5wYXJlbnRfPW51bGx9O3JldHVybiBhfSgpLGQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7dGhpcy5yb290Xz1uZXcgYyhudWxsKX1hLnByb3RvdHlwZS50cmFja09iamVjdD1mdW5jdGlvbihhLGIpe3ZvaWQgMD09PWImJihiPW51bGwpO2lmKG51bGw9PT10aGlzLmZpbmROb2RlKGEsdGhpcy5yb290Xykpe3ZhciBkPXRoaXMuZmluZE5vZGUoYix0aGlzLnJvb3RfKSxuPW5ldyBjKGEpO2Q/ZC5hZGRDaGlsZChuKTp0aGlzLnJvb3RfLmFkZENoaWxkKG4pfX07YS5wcm90b3R5cGUucmVsZWFzZU9iamVjdD1mdW5jdGlvbihhKXthPXRoaXMuZmluZE5vZGUoYSx0aGlzLnJvb3RfKTtpZihudWxsPT09YXx8YT09PXRoaXMucm9vdF8pcmV0dXJuITE7XHJcbnRoaXMuZGVzdHJveU5vZGVPYmplY3RSZWN1cnNlKGEpO2EucGFyZW50Xy5yZW1vdmVDaGlsZChhKTtyZXR1cm4hMH07YS5wcm90b3R5cGUuZGVzdHJveU5vZGVPYmplY3RSZWN1cnNlPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wLGM9YS5jaGlsZHJlbl87YjxjLmxlbmd0aDtiKyspdGhpcy5kZXN0cm95Tm9kZU9iamVjdFJlY3Vyc2UoY1tiXSk7YS5vYmplY3RfLmRlc3Ryb3koKX07YS5wcm90b3R5cGUuc2V0UGFyZW50PWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5maW5kTm9kZShhLHRoaXMucm9vdF8pO2lmKG51bGw9PT1jKXJldHVybiExO3ZhciBkPXRoaXMuZmluZE5vZGUoYix0aGlzLnJvb3RfKTtpZihudWxsPT09ZClyZXR1cm4hMTtpZihjLnBhcmVudF89PT1kKXJldHVybiEwO2MucGFyZW50Xy5yZW1vdmVDaGlsZChjKTtkLmFkZENoaWxkKGMpO3JldHVybiEwfTthLnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbigpe3RoaXMucm9vdF8uY2hpbGRyZW5fPVtdfTthLnByb3RvdHlwZS5maW5kTm9kZT1cclxuZnVuY3Rpb24oYSxiKXtpZihiLm9iamVjdF89PT1hKXJldHVybiBiO2Zvcih2YXIgYz1udWxsLGQ9MCxnPWIuY2hpbGRyZW5fO2Q8Zy5sZW5ndGgmJihjPXRoaXMuZmluZE5vZGUoYSxnW2RdKSxudWxsPT09Yyk7ZCsrKTtyZXR1cm4gY307cmV0dXJuIGF9KCk7YS5HQz1kO2EuZ2M9bmV3IGR9LDk0NjpmdW5jdGlvbihiLGEsYyl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGQ9Yyg2NTgpLG49Yyg4NTEpLEU9Yyg1NTApLG09Yyg1NDUpLHA9YygzOTQpLGw9Yyg1MDkpLGc9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiLGMsZCxnLG4sdCl7dGhpcy5yZXNvbHZlPWE7dGhpcy5yZWplY3Q9Yjt0aGlzLmlpZD1jO3RoaXMub2lkPWQ7dGhpcy5jYmlkPWc7dGhpcy5vbmVTaG90PW47dGhpcy5taWQ9dH19KCksZTsoZnVuY3Rpb24oYSl7YVthLnJwY19zdGF0dXNfc3VjY2Vzcz0wXT1cInJwY19zdGF0dXNfc3VjY2Vzc1wiO2FbYS5ycGNfc3RhdHVzX3Vuc3BlY2lmaWVkX2Vycm9yPVxyXG4xXT1cInJwY19zdGF0dXNfdW5zcGVjaWZpZWRfZXJyb3JcIjthW2EucnBjX3N0YXR1c191bmV4cGVjdGVkPTJdPVwicnBjX3N0YXR1c191bmV4cGVjdGVkXCI7YVthLnJwY19zdGF0dXNfaW5kZXhfb3V0X29mX2JvdW5kcz0zXT1cInJwY19zdGF0dXNfaW5kZXhfb3V0X29mX2JvdW5kc1wiO2FbYS5ycGNfc3RhdHVzX21pc3NpbmdfcGFyYW1ldGVyPTRdPVwicnBjX3N0YXR1c19taXNzaW5nX3BhcmFtZXRlclwiO2FbYS5ycGNfc3RhdHVzX21pc3NpbmdfcmV0dXJuX3ZhbHVlPTVdPVwicnBjX3N0YXR1c19taXNzaW5nX3JldHVybl92YWx1ZVwiO2FbYS5ycGNfc3RhdHVzX2ludmFsaWRfb2JqZWN0PTZdPVwicnBjX3N0YXR1c19pbnZhbGlkX29iamVjdFwiO2FbYS5ycGNfc3RhdHVzX3VzZXJfZXhjZXB0aW9uPTddPVwicnBjX3N0YXR1c191c2VyX2V4Y2VwdGlvblwiO2FbYS5ycGNfc3RhdHVzX3N5c3RlbV9lcnJvcj04XT1cInJwY19zdGF0dXNfc3lzdGVtX2Vycm9yXCJ9KShlPWEuV2VicnBjU3RhdHVzQ29kZXx8XHJcbihhLldlYnJwY1N0YXR1c0NvZGU9e30pKTt2YXIgdjsoZnVuY3Rpb24oYSl7YVthLk5vdFJlZGlyZWN0ZWQ9MF09XCJOb3RSZWRpcmVjdGVkXCI7YVthLkNvbm5lY3Rpbmc9MV09XCJDb25uZWN0aW5nXCI7YVthLkJpbmRpbmc9Ml09XCJCaW5kaW5nXCI7YVthLlJlZGlyZWN0ZWQ9M109XCJSZWRpcmVjdGVkXCJ9KSh2PWEuUmVkaXJlY3Rpb25TdGF0dXN8fChhLlJlZGlyZWN0aW9uU3RhdHVzPXt9KSk7Yj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt0aGlzLnBpbmdhY3RpdmU9ITE7dGhpcy5zdGF0dXM9di5Ob3RSZWRpcmVjdGVkO3RoaXMucmVxcz1bXTt0aGlzLmNicz1bXTt0aGlzLmRlZmVycmVkQWN0aW9ucz1bXTt0aGlzLnRlbGVtZXRyeV89bmV3IHAuVGVsZW1ldHJ5O3RoaXMuc2NyZWVuc2hhcmVfPW5ldyBsLlNjcmVlblNoYXJlVXRpbDt0aGlzLnN0YXRlQ2hhbmdlTm90aWZjYXRpb25zPVtdO3RoaXMudmRhZmVhdHVyZXNfPVtdfU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLnByb3RvdHlwZSxcInRlbGVtZXRyeVwiLFxyXG57Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGVsZW1ldHJ5X30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYS5wcm90b3R5cGUsXCJzY3JlZW5zaGFyZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zY3JlZW5zaGFyZV99LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7YS5wcm90b3R5cGUuc3RvcEFwcHNoYXJlPWZ1bmN0aW9uKCl7dmFyIGE9d2luZG93LnN0b3BBcHBzaGFyZTthJiZhKCl9O2EucHJvdG90eXBlLnNldFJlbW90ZVNlc3Npb25JbmZvQ2I9ZnVuY3Rpb24oYSl7dGhpcy5yZW1vdGVTZXNzaW9uSW5mb0NiPWF9O2EucHJvdG90eXBlLnNldEZlYXR1cmVzPWZ1bmN0aW9uKGEpe3RoaXMuZmVhdHVyZXM9YTt0aGlzLnNjcmVlbnNoYXJlLm9uSW5pdENvbXBsZXRlKCl9O2EucHJvdG90eXBlLmdldEZlYXR1cmVWYWx1ZT1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmZlYXR1cmVzLmZpbmQoZnVuY3Rpb24oYil7cmV0dXJuIGIubmFtZT09PVxyXG5hfSk7cmV0dXJuIHZvaWQgMCE9PWI/Yi52YWx1ZTohMX07YS5wcm90b3R5cGUub25SZWRpcmVjdGlvbkNvbXBsZXRlPWZ1bmN0aW9uKCl7Zm9yKDt0aGlzLmRlZmVycmVkQWN0aW9ucyYmMDx0aGlzLmRlZmVycmVkQWN0aW9ucy5sZW5ndGg7KXRoaXMuZGVmZXJyZWRBY3Rpb25zLnNoaWZ0KCkucG9zdCh0aGlzLnN0YXR1cz09di5SZWRpcmVjdGVkKX07YS5wcm90b3R5cGUuY29ubmVjdFRvU2VydmljZT1mdW5jdGlvbigpe24ubG9nZ2VyLmxvZyhcIlJlZGlyZWN0aW9uIHN0YXR1czogQ29ubmVjdGluZy4uLlwiKTt0aGlzLnN0YXR1cz12LkNvbm5lY3Rpbmc7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGEsYil7dmFyIGM9bmV3IFdlYlNvY2tldChcIndzczovLzEyNy4wLjAuMTo5MDAyXCIpO2Mub25vcGVuPWZ1bmN0aW9uKCl7YShjKX07Yy5vbmVycm9yPWZ1bmN0aW9uKGEpe24ubG9nZ2VyLmxvZyhcIndlYnNvY2tldCBjb25uZWN0aW9uIGVycm9yOiBcIithLnR5cGUpO2IoYSl9fSl9O2EucHJvdG90eXBlLndhaXRVbnRpbFJlZGlyZWN0ZWQ9XHJcbmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsZCl7Yi5zdGF0dXM9PXYuUmVkaXJlY3RlZD9jKCk6MD49YT9kKCk6c2V0VGltZW91dChmdW5jdGlvbigpe24ubG9nZ2VyLmxvZyhcIndhaXRVbnRpbFJlZGlyZWN0ZWQoKSB0aW1lb3V0LiBjb3VudD1cIithKTtiLnN0YXR1cyE9di5SZWRpcmVjdGVkP2Iud2FpdFVudGlsUmVkaXJlY3RlZCgtLWEpLnRoZW4oZnVuY3Rpb24oKXtjKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7ZCgpfSk6YygpfSwyRTMpfSl9O2EucHJvdG90eXBlLmhhbmRsZVJlbW90ZVNlc3Npb25JbmZvPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztuLmxvZ2dlci5sb2coXCJoYW5kbGVSZW1vdGVTZXNzaW9uSW5mbyBjYWxsZWQuXCIpO3ZhciBiPXRoaXM7Yi5yZW1vdGVTZXNzaW9uSW5mb0NiP2IucmVtb3RlU2Vzc2lvbkluZm9DYigpLnRoZW4oZnVuY3Rpb24oYyl7bi5sb2dnZXIubG9nKFwicmVtb3RlU2Vzc2lvbkluZm8gc3VjY2VzcyEgaW5mbzpcIitcclxuSlNPTi5zdHJpbmdpZnkoYykpO24ubG9nZ2VyLmxvZyhcIlJlZGlyZWN0aW9uIHN0YXR1czogUmVkaXJlY3RlZFwiKTtiLnN0YXR1cz12LlJlZGlyZWN0ZWQ7Yi5waW5nQ29ubmVjdGlvbkVuZCgpOygwLHdpbmRvdy5vblZkaUNsaWVudENvbm5lY3RlZCkoKTthLnRlbGVtZXRyeS5TZW5kVGVsZW1ldHJ5SW5pdCgpO2Iub25SZWRpcmVjdGlvbkNvbXBsZXRlKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7bi5sb2dnZXIubG9nKFwicmVtb3RlU2Vzc2lvbkluZm8gZmFpbHVyZSFcIik7Yi5zdXNwZW5kUmVkaXJlY3Rpb24oITApO2Iub25SZWRpcmVjdGlvbkNvbXBsZXRlKCl9KToobi5sb2dnZXIubG9nKFwicmVtb3RlU2Vzc2lvbkluZm9DYiBpcyBpbnZhbGlkIVwiKSxiLnN1c3BlbmRSZWRpcmVjdGlvbighMCksYi5vblJlZGlyZWN0aW9uQ29tcGxldGUoKSl9O2EucHJvdG90eXBlLnN0YXJ0UmVkaXJlY3Rpb249ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGc9d2luZG93Lm9uVmRpQ2xpZW50RGlzY29ubmVjdGVkO1xyXG5yZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24odCx6KXtjLnN0YXR1cyE9di5SZWRpcmVjdGVkPyhuLmxvZ2dlci5sb2coXCJBdHRlbXB0aW5nIHRvIHN0YXJ0IHJlZGlyZWN0aW9uOiBcIitiKSwhMT09PWE/Yy5kZWZlcnJlZEFjdGlvbnMucHVzaChuZXcgZC5kZWZlcnJlZF9hY3Rpb24odCx6LGIpKTpjLmNvbm5lY3RUb1NlcnZpY2UoKS50aGVuKGZ1bmN0aW9uKGEpe24ubG9nZ2VyLmxvZyhcIlJlZGlyZWN0aW9uIHN0YXR1czogQmluZGluZy4uLlwiKTtjLnN0YXR1cz12LkJpbmRpbmc7Yy53ZWJzb2NrZXQ9YTtjLndlYnNvY2tldC5vbm1lc3NhZ2U9ZnVuY3Rpb24oYSl7Yy5vbldTTWVzc2FnZShhKX07Yy53ZWJzb2NrZXQub25jbG9zZT1mdW5jdGlvbihhKXtjLm9uV1NDbG9zZShhKX07dCgpO2MuaGFuZGxlUmVtb3RlU2Vzc2lvbkluZm8oKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7bi5sb2dnZXIubG9nKFwiVW5hYmxlIHRvIGNvbm5lY3QgdG8gd2Vic29ja2V0IHNlcnZpY2UhXCIpO3ooKTtcclxuYy5zdXNwZW5kUmVkaXJlY3Rpb24oITApO2Mub25SZWRpcmVjdGlvbkNvbXBsZXRlKCk7ZyghMCl9KSk6KG4ubG9nZ2VyLmxvZyhcIlJlZGlyZWN0aW9uIGFscmVhZHkgc3RhcnRlZC5cIiksdCgpKX0pfTthLnByb3RvdHlwZS5zdXNwZW5kUmVkaXJlY3Rpb249ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztuLmxvZ2dlci5sb2coXCJTdXNwZW5kaW5nIHJlZGlyZWN0aW9uLlwiKTsoMCx3aW5kb3cub25WZGlDbGllbnREaXNjb25uZWN0ZWQpKCExKTt2YXIgYz0hMTthPXdpbmRvdy5nZXRDaXRyaXhNU1RlYW1zUmVkaXI7dmFyIGQ9d2luZG93LmdldENpdHJpeFdlYnJ0Y1JlZGlyLGc7YT9nPWE6ZCYmKGc9ZCk7ZyYmZygpLnRoZW4oZnVuY3Rpb24oYSl7bi5sb2dnZXIubG9nKFwic3VjZXNzcyBvbiBkaXNjb25uZWN0XCIrYSk7XCIxXCI9PWEmJihjPSEwLG4ubG9nZ2VyLmxvZyhcIlJlZyBrZXkgZXhpc3RzIHdoaWxlIGRpc2Nvbm5lY3RpbmdcIikpO2Iuc3RhdHVzPT09di5SZWRpcmVjdGVkJiYxPT1jJiYobi5sb2dnZXIubG9nKFwiQ2FsbGluZyBwaW5nIG5vdCBub3JtYWwgZGlzY29ubmVjdFwiKSxcclxuYi5waW5nQ29ubmVjdGlvbkJlZ2luKCExKSk7bi5sb2dnZXIubG9nKFwiUmVkaXJlY3Rpb24gc3RhdHVzOiBOb3RSZWRpcmVjdGVkXCIpO2Iuc3RhdHVzPXYuTm90UmVkaXJlY3RlZH0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtuLmxvZ2dlci5sb2coXCJGYWlsdXJlIHRvIFJlYWQgTVMgVGVhbXMgcmVkaXIgUmVnIEtleSwgbm90IHJldHJ5aW5nLi4uXCIpfSk7dGhpcy5kaXNwYXRjaFN0YXRlQ2hhbmdlTm90aWZpY2F0aW9ucygpfTthLnByb3RvdHlwZS5vbldTT3Blbj1mdW5jdGlvbigpe307YS5wcm90b3R5cGUub25XU0Nsb3NlPWZ1bmN0aW9uKGEpe24ubG9nZ2VyLmxvZyhcImRpc2Nvbm5lY3RlZCBmcm9tIHdlYnNvY2tldCBzZXJ2aWNlLlwiKTt0cnl7dGhpcy5zdXNwZW5kUmVkaXJlY3Rpb24oITApfWNhdGNoKGIpe24ubG9nZ2VyLmxvZyhcInN1c3BlbmRSZWRpcmVjdGlvbigpOiBleGNlcHRpb24gY2xvc2luZyBXZWJTb2NrZXQ6IFwiK2IubWVzc2FnZSl9fTthLnByb3RvdHlwZS5vbldTRXJyb3I9XHJcbmZ1bmN0aW9uKCl7dHJ5e3RoaXMuc3VzcGVuZFJlZGlyZWN0aW9uKCEwKX1jYXRjaChhKXtuLmxvZ2dlci5sb2coXCJzdXNwZW5kUmVkaXJlY3Rpb24oKTogZXhjZXB0aW9uIG9uIFdlYlNvY2tldCBlcnJvcjogXCIrYS5tZXNzYWdlKX19O2EucHJvdG90eXBlLldTU2VuZE9iamVjdFdyYXBwZXI9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGc9ITA7YiE9RS5jbGFzc19pZF90LkVuZ2luZUNvbnRyb2x8fGMhPUUubWV0aG9kX2lkX0VuZ2luZUNvbnRyb2xfdC5jdG9yJiZjIT1FLm1ldGhvZF9pZF9FbmdpbmVDb250cm9sX3QudmVyc2lvbiYmYyE9RS5tZXRob2RfaWRfRW5naW5lQ29udHJvbF90LmZlYXR1cmVfZmxhZ3N8fChnPSExKTt2YXIgdD0hMDtpZihnJiYodD0hMSx2b2lkIDAhPXRoaXMuZmVhdHVyZXMpKWZvcih2YXIgZz0wLHI9dGhpcy5mZWF0dXJlcztnPHIubGVuZ3RoO2crKyl7dmFyIHE9cltnXTtpZighMD09PXEudmFsdWUmJnEubmFtZT09YSl7dD0hMDticmVha319cmV0dXJuIDE9PVxyXG50P3RoaXMuV1NTZW5kT2JqZWN0KGQpOlByb21pc2UucmVqZWN0KFwiQ2Fubm90IGludm9rZSBtZXRob2QgdGhhdCBpcyBub3Qgc3VwcG9ydGVkIGJ5IHdlYnJwYzogaWlkKFwiK2IrXCIpIG1pZChcIitjK1wiKVwiKX07YS5wcm90b3R5cGUuV1NTZW5kT2JqZWN0PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsZCl7aWYoXCJ3ZWJydGNcIj09YS52KXt2YXIgdD1hLmhkci5wcm9jLmlpZCx6PWEuaGRyLnByb2MubWV0aG9kaWQscj1hLm9ianJlZi5vaWQ7YS5oZHIuZGVzdHJveXx8KHQ9bmV3IGcoYyxkLHQsciwwLCEwLHopLGIucmVxcy5wdXNoKHQpKTt0PUpTT04uc3RyaW5naWZ5KGEpO24ubG9nZ2VyLnRyYWNlKFwiV1NTZW5kT2JqZWN0OiA+Pj4gXCIrRS5XZWJycGNDbGFzc0xpYkluZm9VdGlsLmNvbXBvc2VDbGFzc0luZm9EYXRhKGEpK1wiIFwiK3QpO3RyeXtiLndlYnNvY2tldC5zZW5kKHQpfWNhdGNoKHEpe24ubG9nZ2VyLmxvZyhcIldTU2VuZE9iamVjdCgpOiBleGNlcHRpb246IFwiK1xyXG5xLm1lc3NhZ2UpLGQocS5tZXNzYWdlKX19ZWxzZSBpZihcIm92ZXJsYXlcIj09YS52KXt0PUpTT04uc3RyaW5naWZ5KGEpO24ubG9nZ2VyLmxvZyhcIkhEWE1TOiBTZW5kT3ZlcmxheURhdGE6ID4+PiBcIit0K1wiJ1wiKTt0cnl7Yi53ZWJzb2NrZXQuc2VuZCh0KX1jYXRjaChxKXtuLmxvZ2dlci5sb2coXCJXU1NlbmRPYmplY3QoKTogZXhjZXB0aW9uOiBcIitxLm1lc3NhZ2UpLGQocS5tZXNzYWdlKX19ZWxzZSBpZihcInRlbGVtZXRyeVwiPT1hLnYpe3Q9SlNPTi5zdHJpbmdpZnkoYSk7bi5sb2dnZXIubG9nKFwiSERYTVM6IFNlbmRUZWxlbWV0cnlEYXRhOiA+Pj4gXCIrdCtcIidcIik7dHJ5e2Iud2Vic29ja2V0LnNlbmQodCl9Y2F0Y2gocSl7bi5sb2dnZXIubG9nKFwiV1NTZW5kT2JqZWN0KCk6IGV4Y2VwdGlvbjogXCIrcS5tZXNzYWdlKSxkKHEubWVzc2FnZSl9fWVsc2UgaWYoXCJhcHBzaGFyaW5nXCI9PWEudil7dD1KU09OLnN0cmluZ2lmeShhKTtuLmxvZ2dlci5sb2coXCJIRFhNUzogU2VuZFNjcmVlblNoYXJpbmdEYXRhOiA+Pj4gXCIrXHJcbnQrXCInXCIpO3RyeXtiLndlYnNvY2tldC5zZW5kKHQpfWNhdGNoKHEpe24ubG9nZ2VyLmxvZyhcIldTU2VuZE9iamVjdCgpOiBleGNlcHRpb246IFwiK3EubWVzc2FnZSksZChxLm1lc3NhZ2UpfX1lbHNlIG4ubG9nZ2VyLmxvZyhcIkhEWE1TOiBVbmtub3duIHByb3RvY29sOiAnXCIrSlNPTi5zdHJpbmdpZnkoYSkrXCInXCIpfSl9O2EucHJvdG90eXBlLndlYnJwY1N0YXR1c0NvZGVUb05hbWU9ZnVuY3Rpb24oYSl7c3dpdGNoKGEpe2Nhc2UgZS5ycGNfc3RhdHVzX3N1Y2Nlc3M6YT1cInJwY19zdGF0dXNfc3VjY2Vzc1wiO2JyZWFrO2Nhc2UgZS5ycGNfc3RhdHVzX3Vuc3BlY2lmaWVkX2Vycm9yOmE9XCJycGNfc3RhdHVzX3Vuc3BlY2lmaWVkX2Vycm9yXCI7YnJlYWs7Y2FzZSBlLnJwY19zdGF0dXNfdW5leHBlY3RlZDphPVwicnBjX3N0YXR1c191bmV4cGVjdGVkXCI7YnJlYWs7Y2FzZSBlLnJwY19zdGF0dXNfaW5kZXhfb3V0X29mX2JvdW5kczphPVwicnBjX3N0YXR1c19pbmRleF9vdXRfb2ZfYm91bmRzXCI7XHJcbmJyZWFrO2Nhc2UgZS5ycGNfc3RhdHVzX21pc3NpbmdfcGFyYW1ldGVyOmE9XCJycGNfc3RhdHVzX21pc3NpbmdfcGFyYW1ldGVyXCI7YnJlYWs7Y2FzZSBlLnJwY19zdGF0dXNfbWlzc2luZ19yZXR1cm5fdmFsdWU6YT1cInJwY19zdGF0dXNfbWlzc2luZ19yZXR1cm5fdmFsdWVcIjticmVhaztjYXNlIGUucnBjX3N0YXR1c19pbnZhbGlkX29iamVjdDphPVwicnBjX3N0YXR1c19pbnZhbGlkX29iamVjdFwiO2JyZWFrO2Nhc2UgZS5ycGNfc3RhdHVzX3VzZXJfZXhjZXB0aW9uOmE9XCJycGNfc3RhdHVzX3VzZXJfZXhjZXB0aW9uXCI7YnJlYWs7Y2FzZSBlLnJwY19zdGF0dXNfc3lzdGVtX2Vycm9yOmE9XCJycGNfc3RhdHVzX3N5c3RlbV9lcnJvclwiO2JyZWFrO2RlZmF1bHQ6YT1cInVua25vd25cIn1yZXR1cm4gYX07YS5wcm90b3R5cGUucGFyY2VXZWJycGNFcnJvcj1mdW5jdGlvbihhLGIpe3ZvaWQgMD09PWEmJihhPWImJjA8Yi5sZW5ndGg/YlswXS5jYXRlZ29yeXx8YlswXS5jb2RlfHxiWzBdLm1lc3NhZ2U/XHJcbmUucnBjX3N0YXR1c19zeXN0ZW1fZXJyb3I6ZS5ycGNfc3RhdHVzX3VzZXJfZXhjZXB0aW9uOmUucnBjX3N0YXR1c191bnNwZWNpZmllZF9lcnJvcik7dmFyIGM7c3dpdGNoKGEpe2Nhc2UgZS5ycGNfc3RhdHVzX3Vuc3BlY2lmaWVkX2Vycm9yOmNhc2UgZS5ycGNfc3RhdHVzX3VuZXhwZWN0ZWQ6Y2FzZSBlLnJwY19zdGF0dXNfaW5kZXhfb3V0X29mX2JvdW5kczpjYXNlIGUucnBjX3N0YXR1c19taXNzaW5nX3BhcmFtZXRlcjpjYXNlIGUucnBjX3N0YXR1c19taXNzaW5nX3JldHVybl92YWx1ZTpjYXNlIGUucnBjX3N0YXR1c19pbnZhbGlkX29iamVjdDpjPW5ldyBET01FeGNlcHRpb24odGhpcy53ZWJycGNTdGF0dXNDb2RlVG9OYW1lKGEpLHRoaXMud2VicnBjU3RhdHVzQ29kZVRvTmFtZShhKSk7YnJlYWs7Y2FzZSBlLnJwY19zdGF0dXNfdXNlcl9leGNlcHRpb246Yz1iJiYwPGIubGVuZ3RoP25ldyBET01FeGNlcHRpb24oYlswXSx0aGlzLndlYnJwY1N0YXR1c0NvZGVUb05hbWUoYSkpOlxyXG5uZXcgRE9NRXhjZXB0aW9uKHRoaXMud2VicnBjU3RhdHVzQ29kZVRvTmFtZShhKSx0aGlzLndlYnJwY1N0YXR1c0NvZGVUb05hbWUoYSkpO2JyZWFrO2Nhc2UgZS5ycGNfc3RhdHVzX3N5c3RlbV9lcnJvcjppZihiJiYwPGIubGVuZ3RoKXtjPU9iamVjdC5jcmVhdGUoRE9NRXhjZXB0aW9uKTt2YXIgZD17dmFsdWU6bnVsbCx3cml0YWJsZTohMCxlbnVtZXJhYmxlOiExLENvbmZpZ3VyYWJsZTohMH07ZC52YWx1ZT1iWzBdLmNhdGVnb3J5O09iamVjdC5kZWZpbmVQcm9wZXJ0eShjLFwibmFtZVwiLGQpO2QudmFsdWU9YlswXS5jb2RlO09iamVjdC5kZWZpbmVQcm9wZXJ0eShjLFwiY29kZVwiLGQpO2QudmFsdWU9YlswXS5tZXNzYWdlO09iamVjdC5kZWZpbmVQcm9wZXJ0eShjLFwibWVzc2FnZVwiLGQpfWVsc2UgYz1uZXcgRE9NRXhjZXB0aW9uKHRoaXMud2VicnBjU3RhdHVzQ29kZVRvTmFtZShhKSx0aGlzLndlYnJwY1N0YXR1c0NvZGVUb05hbWUoYSkpfXJldHVybiBjfTthLnByb3RvdHlwZS5vbldTTWVzc2FnZT1cclxuZnVuY3Rpb24oYSl7dmFyIGI9YS5kYXRhLGM7dHJ5e2M9SlNPTi5wYXJzZShiKX1jYXRjaChxKXtjb25zb2xlLmxvZyhcImludmFsaWQgSlNPTiEhIVwiKTtjb25zb2xlLmxvZyhxKTtjb25zb2xlLmxvZyhiKTtyZXR1cm59aWYoXCJ3ZWJydGNcIj09Yy52KXtuLmxvZ2dlci50cmFjZShcIm9uV1NNZXNzYWdlOiA8PDwgXCIrRS5XZWJycGNDbGFzc0xpYkluZm9VdGlsLmNvbXBvc2VDbGFzc0luZm9EYXRhKGMpK1wiIFwiK2IpO3ZhciBkPWMuaGRyLnByb2MuaWlkLGc9Yy5oZHIucHJvYy5tZXRob2RpZCx0PWMub2JqcmVmLm9pZDthPWMuc3RhdHVzO2lmKGMuaGRyLm1zZ190eXBlPT1tLldzSnNvblV0aWwuZ2V0TXNnVHlwZShtLndzX21zZ190eXBlX3QucmVwbHkpKWI9dGhpcy5yZXFzLmZpbmRJbmRleChmdW5jdGlvbihhKXtyZXR1cm4gYS5paWQ9PWQmJmEub2lkPT10JiZhLm1pZD09Z30pLDA8PWI/MD09YT90aGlzLnJlcXMuc3BsaWNlKGIsMSkuc2hpZnQoKS5yZXNvbHZlKGMpOihjPXRoaXMucGFyY2VXZWJycGNFcnJvcihhLFxyXG5jLnBhcmFtcyksdGhpcy5yZXFzLnNwbGljZShiLDEpLnNoaWZ0KCkucmVqZWN0KGMpKToobi5sb2dnZXIubG9nKFwiSERYTVMgZGlkbnQgZmluZCB0aGlzIG9uZS4gKHJlcXMpXCIpLG4ubG9nZ2VyLmxvZyh0aGlzLnJlcXMpKTtlbHNlIGlmKGMuaGRyLm1zZ190eXBlPT1tLldzSnNvblV0aWwuZ2V0TXNnVHlwZShtLndzX21zZ190eXBlX3QuZXZlbnRfcmVxKSl7dmFyIHI9Yy5mdW5jLmlkLGI9dGhpcy5jYnMuZmluZEluZGV4KGZ1bmN0aW9uKGEpe3JldHVybiBhLmlpZD09ZCYmYS5vaWQ9PXQmJmEuY2JpZD09cj4+MTZ9KTswPD1iPygwPT0ociY2NTUzNSk/dGhpcy5jYnNbYl0ucmVzb2x2ZShjKTooYz10aGlzLnBhcmNlV2VicnBjRXJyb3IoYSxjLnBhcmFtcyksdGhpcy5jYnNbYl0ucmVqZWN0KGMpKSwxPT10aGlzLmNic1tiXS5vbmVTaG90JiZ0aGlzLmNicy5zcGxpY2UoYiwxKSk6KG4ubG9nZ2VyLmxvZyhcIkhEWE1TIGRpZG50IGZpbmQgdGhpcyBvbmUuIChjYnMpXCIpLG4ubG9nZ2VyLmxvZyh0aGlzLmNicykpfWVsc2Ugbi5sb2dnZXIubG9nKFwiSERYTVMgUmVjZWl2ZWQgYm9ndXMgbWVzc2FnZTogXCIrXHJcbmIrXCInXCIpfWVsc2UgaWYoXCJ0ZWxlbWV0cnlcIj09Yy52KTA9PWMuc3RhdHVzJiYoYT1jLmhkci5jb21tYW5kLDI9PShhJjIxNDc0ODM2NDcpJiYoYj1jLmhkci5pZCx0aGlzLnRlbGVtZXRyeS5vbkluaXRpYWxpemVkKGIpLG4ubG9nZ2VyLmxvZyhcIlRlbGVtZXRyeSBpbml0IHJlc3BvbnNlIHJlY2VpdmVkXCIpKSk7ZWxzZSBpZihcImZlYXR1cmVzXCI9PWMudil7YT1jLmZlYXR1cmVzO2lmKFwiZmVhdHVyZS1zdXBwb3J0XCI9PWMuY29tbWFuZClmb3Iobi5sb2dnZXIubG9nKFwiZmVhdHVyZXMgY2FwYWJpbGl0aWVzIHJlY2VpdmVkLCBmZWF0dXJlczpcIithKSx0aGlzLnZkYWZlYXR1cmVzXz1hLGI9MDtiPGEubGVuZ3RoO2IrKylpZihhW2JdPT09RS5GRUFUVVJFX3ZkYV9hcHBfc2hhcmluZyl0aGlzLnNjcmVlbnNoYXJlLm9uSW5pdGlhbGl6ZWQoITApO3RoaXMuY2xpZW50Vmlld3BvcnRNb2RlXz1jLmNsaWVudF92aWV3cG9ydF9tb2RlO24ubG9nZ2VyLmxvZyhcImZlYXR1cmVzIGNsaWVudF92aWV3cG9ydF9tb2RlIHZhbHVlOiBcIitcclxudGhpcy5jbGllbnRWaWV3cG9ydE1vZGVfKX1lbHNlXCJhcHBzaGFyaW5nXCI9PWMudj8oYT1jLnN0YXR1cywwPT1hPyhhPWMuaGRyLmNvbW1hbmQsYj1jLmhkci5pZCwoYSYyMTQ3NDgzNjQ3KT09bC5zc2hhcmVfY21kLkdldFNvdXJjZXM/KG4ubG9nZ2VyLmxvZyhcImFwcHNoYXJpbmcgR2V0U291cmNlcyByZXNwb25zZSByZWNlaXZlZFwiKSx0aGlzLnNjcmVlbnNoYXJlLm9uR2V0U291cmNlcyhiLGMuZGF0YSkpOihhJjIxNDc0ODM2NDcpPT1sLnNzaGFyZV9jbWQuU2V0QWN0aXZlPyhuLmxvZ2dlci5sb2coXCJhcHBzaGFyaW5nIFNldEFjdGl2ZSByZXNwb25zZSByZWNlaXZlZFwiKSx0aGlzLnNjcmVlbnNoYXJlLm9uU2V0QWN0aXZlKGIsYy5kYXRhKSk6KGEmMjE0NzQ4MzY0Nyk9PWwuc3NoYXJlX2NtZC5Ub3BvbG9neUNoYW5nZWQ/KG4ubG9nZ2VyLmxvZyhcImFwcHNoYXJpbmcgV2luZG93IHRvcG9sb2d5IGNoYW5nZWQgY21kIHJlY2VpdmVkXCIpLHRoaXMuc2NyZWVuc2hhcmUub25Ub3Bsb2d5Q2hhbmdlZCgpKTpcclxuKG4ubG9nZ2VyLmxvZyhcImludmFsaWQgY29tbWFuZCByZXBseTpcIithKSx0aGlzLnNjcmVlbnNoYXJlLm9uRXJyb3IoYikpKToobi5sb2dnZXIubG9nKFwiaW52YWxpZCBzdGF0dXMgcmVwbHk6XCIrYSksYj1jLmhkci5pZCx0aGlzLnNjcmVlbnNoYXJlLm9uRXJyb3IoYikpKTpuLmxvZ2dlci5sb2coXCJIRFhNUzogVW5rbm93biBwcm90b2NvbDogXCIrYitcIidcIil9O2EucHJvdG90eXBlLmNsZWFyUmVxcz1mdW5jdGlvbigpe24ubG9nZ2VyLmxvZyhcImNsZWFyUmVxcygpXCIpO3RoaXMucmVxcy5mb3JFYWNoKGZ1bmN0aW9uKGEsYil7YS5yZWplY3QoKX0pO3RoaXMucmVxcz1bXX07YS5wcm90b3R5cGUucmVnaXN0ZXJIYW5kbGVyPWZ1bmN0aW9uKGEsYixjKXthPW5ldyBnKGMucmVzb2x2ZS5iaW5kKGMpLGMucmVqZWN0LmJpbmQoYyksYSxiLGMuaWQsYy5vbmVTaG90LDApO3RoaXMuY2JzLnB1c2goYSl9O2EucHJvdG90eXBlLnVucmVnaXN0ZXJIYW5kbGVyPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1cclxudGhpcy5jYnMuZmluZEluZGV4KGZ1bmN0aW9uKGQpe3JldHVybiBkLmlpZD09YSYmZC5vaWQ9PWImJmQuY2JpZD09Y30pOzA8PWQ/dGhpcy5jYnMuc3BsaWNlKGQsMSk6KG4ubG9nZ2VyLmxvZyhcIkhEWE1TIERpZG50IGZpbmQgdGhpcyBjYWxsYmFjayBpbiB0aGUgbGlzdCFcIiksY29uc29sZS5sb2codGhpcy5jYnMpKX07YS5wcm90b3R5cGUuaXNSZWRpcmVjdGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdHVzPT09di5SZWRpcmVjdGVkfHx0aGlzLnN0YXR1cz09PXYuQmluZGluZ3x8dGhpcy5zdGF0dXM9PT12LkNvbm5lY3Rpbmd9O2EucHJvdG90eXBlLmlzQ29ubmVjdGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdHVzPT12LlJlZGlyZWN0ZWR9O2EucHJvdG90eXBlLmlzUGluZ0FjdGl2ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBpbmdhY3RpdmV9O2EucHJvdG90eXBlLnBpbmdDb25uZWN0aW9uQmVnaW49ZnVuY3Rpb24oYSl7bi5sb2dnZXIubG9nKFwiU3RhcnRlZCB0aW1lclwiKTtcclxudGhpcy5waW5nYWN0aXZlPSEwO3ZhciBiPXdpbmRvdy5vblZkaUNsaWVudERpc2Nvbm5lY3RlZFRpbWVyOzE9PWE/KG4ubG9nZ2VyLmxvZyhcImNoZWNraW5nIGlmIHdlIGFyZSBjb25uZWN0ZWQuLi5cIiksYigpKTp0aGlzLmNvbm50aW1lcj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7bi5sb2dnZXIubG9nKFwiY2hlY2tpbmcgaWYgd2UgYXJlIGNvbm5lY3RlZC4uLlwiKTtiKCl9LDE1RTMpfTthLnByb3RvdHlwZS5waW5nQ29ubmVjdGlvbkVuZD1mdW5jdGlvbigpe3RoaXMucGluZ2FjdGl2ZT0hMTtjbGVhclRpbWVvdXQodGhpcy5jb25udGltZXIpfTthLnByb3RvdHlwZS5TZW5kVGVsZW1ldHJ5RGF0YV9TcGVha2VyPWZ1bmN0aW9uKGEpe3RoaXMudGVsZW1ldHJ5LlNlbmRUZWxlbWV0cnlEYXRhKHAudGVsX2NtZC5EYXRhLHAudGVsX2tleV9TcGVha2VyRGV2aWNlVXNlZCxhLDApfTthLnByb3RvdHlwZS5yZWdpc3RlclN0YXRlQ2hhbmdlTm90aWZpY2F0aW9uPWZ1bmN0aW9uKGEpe3RoaXMuc3RhdGVDaGFuZ2VOb3RpZmNhdGlvbnMucHVzaChhKX07XHJcbmEucHJvdG90eXBlLnVucmVnaXN0ZXJTdGF0ZUNoYW5nZU5vdGlmaWNhdGlvbj1mdW5jdGlvbihhKXt0aGlzLnN0YXRlQ2hhbmdlTm90aWZjYXRpb25zPXRoaXMuc3RhdGVDaGFuZ2VOb3RpZmNhdGlvbnMuZmlsdGVyKGZ1bmN0aW9uKGIpe3JldHVybiBiIT1hfSl9O2EucHJvdG90eXBlLmRpc3BhdGNoU3RhdGVDaGFuZ2VOb3RpZmljYXRpb25zPWZ1bmN0aW9uKCl7dGhpcy5zdGF0ZUNoYW5nZU5vdGlmY2F0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGEpe2EoKX0pfTthLnByb3RvdHlwZS52ZGFidWZmZXJOb0xpbWl0PWZ1bmN0aW9uKCl7Zm9yKHZhciBhPSExLGI9MCxjPXRoaXMudmRhZmVhdHVyZXNfO2I8Yy5sZW5ndGg7YisrKWlmKGNbYl09PT1FLkZFQVRVUkVfdmRhX3NlcnZpY2Vfbm9fYnVmZmVyX2xpbWl0KXthPSEwO2JyZWFrfXJldHVybiBhfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYS5wcm90b3R5cGUsXCJjbGllbnRWaWV3cG9ydE1vZGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2xpZW50Vmlld3BvcnRNb2RlX3x8XHJcblwidW5rbm93blwifSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO3JldHVybiBhfSgpO2EuSGR4TWVkaWFTdHJlYW09Yjt2YXIgdD1uZXcgYjthLmdldFJlZGlyZWN0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdH19LDk4NTpmdW5jdGlvbihiLGEsYyl7dmFyIGQ9dGhpcyYmdGhpcy5fX2V4dGVuZHN8fGZ1bmN0aW9uKCl7dmFyIGE9ZnVuY3Rpb24oYixjKXthPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihhLGIpe2EuX19wcm90b19fPWJ9fHxmdW5jdGlvbihhLGIpe2Zvcih2YXIgYyBpbiBiKWIuaGFzT3duUHJvcGVydHkoYykmJihhW2NdPWJbY10pfTtyZXR1cm4gYShiLGMpfTtyZXR1cm4gZnVuY3Rpb24oYixjKXtmdW5jdGlvbiBkKCl7dGhpcy5jb25zdHJ1Y3Rvcj1ifWEoYixjKTtiLnByb3RvdHlwZT1udWxsPT09Yz9PYmplY3QuY3JlYXRlKGMpOihkLnByb3RvdHlwZT1jLnByb3RvdHlwZSxuZXcgZCl9fSgpO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgbj1jKDY1OCksZT1jKDU1MCksbT1jKDg1MSk7Yj1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKGMsZCxuKXtmb3IodmFyIHQ9W10sej0zO3o8YXJndW1lbnRzLmxlbmd0aDt6KyspdFt6LTNdPWFyZ3VtZW50c1t6XTtyZXR1cm4gYS5hcHBseSh0aGlzLFtjLGUuY2xhc3NfaWRfdC5SVENJY2VDYW5kaWRhdGUsZCxuLG51bGxdLmNvbmNhdCh0KSl8fHRoaXN9ZChiLGEpO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImNhbmRpZGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jYW5kaWRhdGVffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInNkcE1pZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZHBNaWRffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcclxuXCJzZHBNTGluZUluZGV4XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNkcE1MaW5lSW5kZXhffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLnN5bmNCYXJyaWVyPWZ1bmN0aW9uKCl7dmFyIGE9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2Eud2FpdFVudGlsQ29ubmVjdGVkKFwiSWNlQ2FuZGlkYXRlLnN5bmNCYXJyaWVyXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5hbGwoW2EucmVtb3RlSW52b2tlKCExLGUubWV0aG9kX2lkX1JUQ0ljZUNhbmRpZGF0ZV90LmNhbmRpZGF0ZSxcIlwiKSxhLnJlbW90ZUludm9rZSghMSxlLm1ldGhvZF9pZF9SVENJY2VDYW5kaWRhdGVfdC5zZHBNaWQsXCJcIiksYS5yZW1vdGVJbnZva2UoITEsZS5tZXRob2RfaWRfUlRDSWNlQ2FuZGlkYXRlX3Quc2RwTUxpbmVJbmRleCxcclxuMCldKX0pLnRoZW4oZnVuY3Rpb24oYyl7Yz1jLm1hcChmdW5jdGlvbihiKXtyZXR1cm4gYS5wYXJhbTAoYil9KTthLmNhbmRpZGF0ZV89Y1swXTthLnNkcE1pZF89Y1sxXTthLnNkcE1MaW5lSW5kZXhfPWNbMl07YihhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7Yj1hLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuc3luY0JhcnJpZXIgZmFpbGVkIVwiKTtjKGIpfSl9KX07cmV0dXJuIGJ9KG4uUHJveHlPYmplY3QpO2EuSWNlQ2FuZGlkYXRlPWI7Yj1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKGMsZCl7cmV0dXJuIGEuY2FsbCh0aGlzLGMsZS5jbGFzc19pZF90LlJUQ0ljZUNhbmRpZGF0ZVBhaXIsZCxuLlByb3h5TW9kZS5SZW1vdGUpfHx0aGlzfWQoYixhKTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJsb2NhbFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sb2NhbF99LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFxyXG5cInJlbW90ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZW1vdGVffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLnN5bmNCYXJyaWVyPWZ1bmN0aW9uKCl7dmFyIGE9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2Eud2FpdFVudGlsQ29ubmVjdGVkKFwiSWNlQ2FuZGlkYXRlUGFpci5zeW5jQmFycmllclwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFthLnJlbW90ZUludm9rZSghMSxlLm1ldGhvZF9pZF9SVENJY2VDYW5kaWRhdGVQYWlyX3QubG9jYWwse30pLGEucmVtb3RlSW52b2tlKCExLGUubWV0aG9kX2lkX1JUQ0ljZUNhbmRpZGF0ZVBhaXJfdC5yZW1vdGUse30pXSl9KS50aGVuKGZ1bmN0aW9uKGMpe2M9Yy5tYXAoZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyYW0wKGIpfSk7YS5sb2NhbF89XHJcbmNbMF07YS5yZW1vdGVfPWNbMV07YihhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7Yj1hLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuc3luY0JhcnJpZXIgZmFpbGVkIVwiKTtjKGIpfSl9KX07cmV0dXJuIGJ9KG4uUHJveHlPYmplY3QpO2EuSWNlQ2FuZGlkYXRlUGFpcj1ifSw4NTE6ZnVuY3Rpb24oYixhKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYil7dGhpcy50cmFjaW5nPSExO3RoaXMubXNsb2dnZXJfPXZvaWQgMDt0aGlzLnRhZz1iO3RoaXMuZW5hYmxlZD0hMH1hLnByb3RvdHlwZS5zZXRNU0xvZ2dlcj1mdW5jdGlvbihhKXt0aGlzLm1zbG9nZ2VyXz1hfTthLnByb3RvdHlwZS5sb2c9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wO2I8YXJndW1lbnRzLmxlbmd0aDtiKyspYVtiXT1hcmd1bWVudHNbYl07dGhpcy5lbmFibGVkJiYodm9pZCAwIT10aGlzLm1zbG9nZ2VyXz90aGlzLm1zbG9nZ2VyXy5pbmZvKHRoaXMudGFnK1xyXG5cIiBcIithKTpjb25zb2xlLmxvZyh0aGlzLnRhZytcIiBcIithKSl9O2EucHJvdG90eXBlLnRyYWNlPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MDtiPGFyZ3VtZW50cy5sZW5ndGg7YisrKWFbYl09YXJndW1lbnRzW2JdO3RoaXMudHJhY2luZyYmdGhpcy5sb2cuYXBwbHkodGhpcyxhKX07cmV0dXJuIGF9KCk7YS5Mb2dnZXI9YzthLmxvZ2dlcj1uZXcgYyhcIltIZHhXZWJSVEMuanNdXCIpO2EubG9nZ2VyLmVuYWJsZWQ9ITB9LDM2MDpmdW5jdGlvbihiLGEsYyl7dmFyIGQ9dGhpcyYmdGhpcy5fX2V4dGVuZHN8fGZ1bmN0aW9uKCl7dmFyIGE9ZnVuY3Rpb24oYixjKXthPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihhLGIpe2EuX19wcm90b19fPWJ9fHxmdW5jdGlvbihhLGIpe2Zvcih2YXIgaCBpbiBiKWIuaGFzT3duUHJvcGVydHkoaCkmJihhW2hdPWJbaF0pfTtyZXR1cm4gYShiLGMpfTtyZXR1cm4gZnVuY3Rpb24oYixcclxuYyl7ZnVuY3Rpb24gcSgpe3RoaXMuY29uc3RydWN0b3I9Yn1hKGIsYyk7Yi5wcm90b3R5cGU9bnVsbD09PWM/T2JqZWN0LmNyZWF0ZShjKToocS5wcm90b3R5cGU9Yy5wcm90b3R5cGUsbmV3IHEpfX0oKSxuPXRoaXMmJnRoaXMuX19hd2FpdGVyfHxmdW5jdGlvbihhLGIsYyxxKXtyZXR1cm4gbmV3IChjfHwoYz1Qcm9taXNlKSkoZnVuY3Rpb24oZCxmKXtmdW5jdGlvbiB3KGEpe3RyeXt5KHEubmV4dChhKSl9Y2F0Y2goYil7ZihiKX19ZnVuY3Rpb24gcihhKXt0cnl7eShxW1widGhyb3dcIl0oYSkpfWNhdGNoKGIpe2YoYil9fWZ1bmN0aW9uIHkoYSl7YS5kb25lP2QoYS52YWx1ZSk6KG5ldyBjKGZ1bmN0aW9uKGIpe2IoYS52YWx1ZSl9KSkudGhlbih3LHIpfXkoKHE9cS5hcHBseShhLGJ8fFtdKSkubmV4dCgpKX0pfSxlPXRoaXMmJnRoaXMuX19nZW5lcmF0b3J8fGZ1bmN0aW9uKGEsYil7ZnVuY3Rpb24gYyhhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIHEoW2EsYl0pfX1mdW5jdGlvbiBxKGMpe2lmKGYpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbmZvcig7ZDspdHJ5e2lmKGY9MSx3JiYocj1jWzBdJjI/d1tcInJldHVyblwiXTpjWzBdP3dbXCJ0aHJvd1wiXXx8KChyPXdbXCJyZXR1cm5cIl0pJiZyLmNhbGwodyksMCk6dy5uZXh0KSYmIShyPXIuY2FsbCh3LGNbMV0pKS5kb25lKXJldHVybiByO2lmKHc9MCxyKWM9W2NbMF0mMixyLnZhbHVlXTtzd2l0Y2goY1swXSl7Y2FzZSAwOmNhc2UgMTpyPWM7YnJlYWs7Y2FzZSA0OnJldHVybiBkLmxhYmVsKysse3ZhbHVlOmNbMV0sZG9uZTohMX07Y2FzZSA1OmQubGFiZWwrKzt3PWNbMV07Yz1bMF07Y29udGludWU7Y2FzZSA3OmM9ZC5vcHMucG9wKCk7ZC50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoIShyPWQudHJ5cyxyPTA8ci5sZW5ndGgmJnJbci5sZW5ndGgtMV0pJiYoNj09PWNbMF18fDI9PT1jWzBdKSl7ZD0wO2NvbnRpbnVlfWlmKDM9PT1jWzBdJiYoIXJ8fGNbMV0+clswXSYmY1sxXTxyWzNdKSlkLmxhYmVsPWNbMV07ZWxzZSBpZig2PT09Y1swXSYmZC5sYWJlbDxyWzFdKWQubGFiZWw9XHJcbnJbMV0scj1jO2Vsc2UgaWYociYmZC5sYWJlbDxyWzJdKWQubGFiZWw9clsyXSxkLm9wcy5wdXNoKGMpO2Vsc2V7clsyXSYmZC5vcHMucG9wKCk7ZC50cnlzLnBvcCgpO2NvbnRpbnVlfX1jPWIuY2FsbChhLGQpfWNhdGNoKEope2M9WzYsSl0sdz0wfWZpbmFsbHl7Zj1yPTB9aWYoY1swXSY1KXRocm93IGNbMV07cmV0dXJue3ZhbHVlOmNbMF0/Y1sxXTp2b2lkIDAsZG9uZTohMH19dmFyIGQ9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKHJbMF0mMSl0aHJvdyByWzFdO3JldHVybiByWzFdfSx0cnlzOltdLG9wczpbXX0sZix3LHIseTskanNjb21wLmluaXRTeW1ib2woKTskanNjb21wLmluaXRTeW1ib2woKTskanNjb21wLmluaXRTeW1ib2xJdGVyYXRvcigpO3JldHVybiB5PXtuZXh0OmMoMCksXCJ0aHJvd1wiOmMoMSksXCJyZXR1cm5cIjpjKDIpfSxcImZ1bmN0aW9uXCI9PT10eXBlb2YgU3ltYm9sJiYoeVtTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSx5fTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcclxuXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIG09Yyg5NDYpLHA9YygxNDQpLGw9Yyg1ODkpLGc9Yyg2NTgpLGs9Yyg5ODUpLHY9YygzNzcpLHQ9Yyg2NTApLHo9YygyNCksdT1jKDU1MCksZj1jKDg1MSksQT1jKDUxNykseD1jKDM5NCksRD1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKGgsYyxxKXtoPWEuY2FsbCh0aGlzLGgsdS5jbGFzc19pZF90LlJUQ0ljZUNhbmRpZGF0ZUV2ZW50LGMsZy5Qcm94eU1vZGUuUmVtb3RlKXx8dGhpcztoLnRhcmdldD1xO2gudHlwZT1cImljZWNhbmRpZGF0ZVwiO3JldHVybiBofWQoYixhKTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJjYW5kaWRhdGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FuZGlkYXRlX30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtiLnByb3RvdHlwZS5zeW5jQmFycmllcj1mdW5jdGlvbigpe3ZhciBhPXRoaXM7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyKCkgY2FsbGVkLlwiKTtcclxucmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGIsaCl7YS53YWl0VW50aWxDb25uZWN0ZWQoYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXJcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBhLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENJY2VDYW5kaWRhdGVFdmVudF90LmNhbmRpZGF0ZSx7b2lkOjB9KX0pLnRoZW4oZnVuY3Rpb24oYil7Yj1hLnBhcmFtMChiKTtyZXR1cm4hMT09PWIuaXNfbnVsbD8obmV3IGsuSWNlQ2FuZGlkYXRlKGEsYi5vaWQsZy5Qcm94eU1vZGUuUmVtb3RlKSkuc3luY0JhcnJpZXIoKTpQcm9taXNlLnJlc29sdmUobnVsbCl9KS50aGVuKGZ1bmN0aW9uKGgpe2YubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmljZWNhbmRpZGF0ZTogaWNlY2FuZGlkYXRlIGF2YWlsYWJsZSFcIik7YS5jYW5kaWRhdGVfPWg7YihhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7Yj1hLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIub25pY2VjYW5kaWRhdGUoKSBmYWlsZWQhXCIpO1xyXG5oKGIpfSl9KX07cmV0dXJuIGJ9KGcuUHJveHlPYmplY3QpO2EuSWNlQ2FuZGlkYXRlRXZlbnQ9RDt2YXIgQz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYil7dGhpcy5zdGF0ZV89XCJuZXdcIjt0aGlzLmNhbmRpZGF0ZXNfPVtdO3RoaXMucGNfPWJ9YS5wcm90b3R5cGUucHVzaFN0YXRlPWZ1bmN0aW9uKGEpe2YubG9nZ2VyLmxvZyh0aGlzLnBjXy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZTogbmV3IHN0YXRlIGlzIFwiK2EpO3RoaXMuc3RhdGVfPWE7XCJnYXRoZXJpbmdcIj09dGhpcy5zdGF0ZV8/KHRoaXMuY2FuZGlkYXRlc189W10sdGhpcy5wb3N0VXBkYXRlKCkpOnRoaXMucHJvY2Vzc1JlbWFpbmluZygpfTthLnByb3RvdHlwZS5hZGRJY2VDYW5kaWRhdGU9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpczt0aGlzLmNhbmRpZGF0ZXNfLnB1c2goYSk7YS5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oYSl7Zi5sb2dnZXIubG9nKGIucGNfLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIub25pY2VjYW5kaWRhdGU6IGljZWNhbmRpZGF0ZSBhdmFpbGFibGUhXCIpO3JldHVybiBQcm9taXNlLmFsbChbYi5wY18udXBkYXRlU2RwRGVzY3JpcHRpb24oITApLFByb21pc2UucmVzb2x2ZShhKV0pfSkudGhlbihmdW5jdGlvbihhKXtiLnBvc3RJY2VDYW5kaWRhdGUoYVsxXSl9KX07YS5wcm90b3R5cGUucG9zdEljZUNhbmRpZGF0ZT1mdW5jdGlvbihhKXtmLmxvZ2dlci5sb2codGhpcy5wY18udXNlcl9mcmllbmRseV9pZCgpK1wiLm9uaWNlY2FuZGlkYXRlOiBwb3N0aW5nIGljZSBjYW5kaWRhdGUgbm93IVwiKTtpZihudWxsIT10aGlzLnBjXy5vbmljZWNhbmRpZGF0ZSl0aGlzLnBjXy5vbmljZWNhbmRpZGF0ZShhKTtlbHNlIGYubG9nZ2VyLmxvZyh0aGlzLnBjXy51c2VyX2ZyaWVuZGx5X2lkKCkrXCJvbmljZWNhbmRpZGF0ZSBpcyBOVUxMISEhXCIpO3RoaXMuY2FuZGlkYXRlc18uc2hpZnQoKTt0aGlzLnByb2Nlc3NSZW1haW5pbmcoKX07YS5wcm90b3R5cGUucG9zdFVwZGF0ZT1mdW5jdGlvbigpe2YubG9nZ2VyLmxvZyh0aGlzLnBjXy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2U6IHBvc3RpbmcgZXZlbnQgbm93IVwiKTt2YXIgYT1uZXcgdyhcIm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2VcIix0aGlzLnBjXyk7dGhpcy5wY18ub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZShhKX07YS5wcm90b3R5cGUucHJvY2Vzc1JlbWFpbmluZz1mdW5jdGlvbigpezA9PXRoaXMuY2FuZGlkYXRlc18ubGVuZ3RoJiZcImNvbXBsZXRlXCI9PXRoaXMuc3RhdGVfPyh0aGlzLnBjXy5vbmljZWNhbmRpZGF0ZSh7Y2FuZGlkYXRlOm51bGwsdGFyZ2V0OnRoaXN9KSx0aGlzLnBvc3RVcGRhdGUoKSk6Zi5sb2dnZXIubG9nKHRoaXMucGNfLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmljZWNhbmRpZGF0ZTogY2FuZGlkYXRlcyByZW1haW5pbmc9W1wiK3RoaXMuY2FuZGlkYXRlc18ubWFwKGZ1bmN0aW9uKGEpe3JldHVybiBhLm9iamVjdF9pZCgpfSkrXCJdLCBzdGF0ZT1cIit0aGlzLnN0YXRlXyl9O3JldHVybiBhfSgpLHI9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxcclxuYil7dGhpcy5zZHA9Yjt0aGlzLnR5cGU9YX19KCk7YS5TZXNzaW9uRGVzY3JpcHRpb25Jbml0PXI7dmFyIHE9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihoLGMscSl7Zm9yKHZhciBkPVtdLHc9Mzt3PGFyZ3VtZW50cy5sZW5ndGg7dysrKWRbdy0zXT1hcmd1bWVudHNbd107cmV0dXJuIGEuYXBwbHkodGhpcyxbaCx1LmNsYXNzX2lkX3QuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uLGMscSxudWxsXS5jb25jYXQoZCkpfHx0aGlzfWQoYixhKTtiLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm57dHlwZTp0aGlzLnR5cGVfLHNkcDp0aGlzLnNkcF99fTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJzZHBcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2RwX30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJ0eXBlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnR5cGVffSxlbnVtZXJhYmxlOiEwLFxyXG5jb25maWd1cmFibGU6ITB9KTtiLnByb3RvdHlwZS5zeW5jQmFycmllcj1mdW5jdGlvbigpe3ZhciBhPXRoaXM7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyKCkgY2FsbGVkLlwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixoKXthLndhaXRVbnRpbENvbm5lY3RlZChhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllclwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFthLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENTZXNzaW9uRGVzY3JpcHRpb25fdC50eXBlLDApLGEucmVtb3RlSW52b2tlKCExLHUubWV0aG9kX2lkX1JUQ1Nlc3Npb25EZXNjcmlwdGlvbl90LnNkcCxcIlwiKV0pfSkudGhlbihmdW5jdGlvbihoKXthLnR5cGVfPWEuY29udmVydFR5cGUoYS5wYXJhbTAoaFswXSkpO2Euc2RwXz1hLnBhcmFtMChoWzFdKTtiKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtiPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcclxuXCIuc3luY0JhcnJpZXIoKSBmYWlsZWQhXCIpO2goYil9KX0pfTtiLnByb3RvdHlwZS5jb252ZXJ0VHlwZT1mdW5jdGlvbihhKXtyZXR1cm4gMD09YT9cIm9mZmVyXCI6MT09YT9cInByYW5zd2VyXCI6Mj09YT9cImFuc3dlclwiOlwicm9sbGJhY2tcIn07Yi5jb252ZXJ0QzJIPWZ1bmN0aW9uKGEpe3JldHVyblwib2ZmZXJcIj09YT8wOlwicHJhbnN3ZXJcIj09YT8xOlwiYW5zd2VyXCI9PWE/MjozfTtyZXR1cm4gYn0oZy5Qcm94eU9iamVjdCk7YS5TZXNzaW9uRGVzY3JpcHRpb249cTt2YXIgdz1mdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihhLGIpe3RoaXMudHlwZT1hO3RoaXMudGFyZ2V0PWJ9fSgpLEI9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oKXt9fSgpLHk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsYyl7dGhpcy5sb2NhbD1iO3RoaXMucmVtb3RlPWN9T2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwiYWN0aXZlXCIse2dldDpmdW5jdGlvbigpe3ZhciBhPSExO2lmKDE9PXRoaXMubG9jYWx8fFxyXG4xPT10aGlzLnJlbW90ZSlhPSEwO3JldHVybiBhfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO3JldHVybiBhfSgpO2I9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjKXt2YXIgaD1hLmNhbGwodGhpcyxudWxsLHUuY2xhc3NfaWRfdC5SVENQZWVyQ29ubmVjdGlvbiwwLGcuUHJveHlNb2RlLkxvY2FsLG51bGwsdm9pZCAwIT1jP2M6e30se30pfHx0aGlzO2gudGltZWVyc3RhcnRlZF89ITE7aC5maXJzdHRpbWVyZW1vdGVvZmZlcl89ITE7aC5maXJzdHN0YWJsZV89ITE7aC5maXJzdHRpbWVsb2NhbG9mZmVyXz0hMTtoLmF1ZGlvY2FsbF89bmV3IHkoITEsITEpO2gudmlkZW9jYWxsXz1uZXcgeSghMSwhMSk7aC5zY3JlZW5zaGFyaW5nY2FsbF89bmV3IHkoITEsITEpO2guY29uZmVyZW5jZWNhbGxfPSExO2guaW5jb21pbmdjYWxsXz0hMTtoLm91dGdvaW5nY2FsbF89ITE7YyYmYy5zZHBTZW1hbnRpY3MmJihoLnNkcFNlbWFudGljc189Yy5zZHBTZW1hbnRpY3MpO2YubG9nZ2VyLmxvZyhoLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuY29uc3RydWN0b3Igc2RwU2VtYW50aWNzPVwiK2guc2RwU2VtYW50aWNzXyk7aWYoIXUuQlVJTERfVFlQRV9TREsmJmguaXNVbmlmaWVkKCkmJiFtLmdldFJlZGlyZWN0b3IoKS5nZXRGZWF0dXJlVmFsdWUodS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCkpdGhyb3cgbmV3IERPTUV4Y2VwdGlvbihcIkNXQSBjbGllbnQgZG9lcyBub3Qgc3VwcG9ydCB1bmlmaWVkIHNkcFNlbWFudGljXCIsXCJjcmVhdGVQZWVyQ29ubmVjdGlvblwiKTtoLnBlbmRpbmd0cmFuc2NlaXZlcl89ITE7aC5kZWZlcnJlZE9mZmVyQW5zd2Vycz1bXTtoLmxvY2FsU3RyZWFtcz1bXTtoLnJlbW90ZVN0cmVhbXM9W107aC5vbmFkZHN0cmVhbV89bnVsbDtoLnNpZ25hbGluZ1N0YXRlXz1cInN0YWJsZVwiO2guaWNlQ29ubmVjdGlvblN0YXRlXz1cIm5ld1wiO2guaWNlR2F0aGVyaW5nU3RhdGVfPVwibmV3XCI7aC5pY2VRXz1uZXcgQyhoKTtoLnJlY2VpdmVyc189W107aC5zZW5kZXJzXz1bXTtoLnRyYW5zY2VpdmVyc189XHJcbltdO2gucmVnaXN0ZXJTdGF0ZUNoYW5nZU5vdGlmaWNhdGlvbihoLm9uU3RhdGVDaGFuZ2UpO2gubG9jYWxkYXRhY2hhbm5lbF89bnVsbDtoLnJlbW90ZWRhdGFjaGFubmVsXz1udWxsO3JldHVybiBofWQoYixhKTtiLnByb3RvdHlwZS5kdW1wU2RwPWZ1bmN0aW9uKGEpe2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5kdW1wU2RwXCIpO2EmJihmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIgIC0tIHR5cGU6IFwiK2EudHlwZSksZi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiICAtLSBzZHA6IFwiK2Euc2RwKSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImxvY2FsRGVzY3JpcHRpb25cIix7Z2V0OmZ1bmN0aW9uKCl7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9sb2NhbERlc2NyaXB0aW9uKCkgY2FsbGVkLlwiKTtyZXR1cm4gdGhpcy5sb2NhbERlc2NyaXB0aW9uX30sc2V0OmZ1bmN0aW9uKGEpe2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuc2V0X2xvY2FsRGVzY3JpcHRpb24oKSBjYWxsZWQuXCIpO3RoaXMubG9jYWxEZXNjcmlwdGlvbl89YX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJyZW1vdGVEZXNjcmlwdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X3JlbW90ZURlc2NyaXB0aW9uKCkgY2FsbGVkLlwiKTtyZXR1cm4gdGhpcy5yZW1vdGVEZXNjcmlwdGlvbl99LHNldDpmdW5jdGlvbihhKXtmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X3JlbW90ZURlc2NyaXB0aW9uKCkgY2FsbGVkLlwiKTt0aGlzLnJlbW90ZURlc2NyaXB0aW9uXz1hfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmlzVW5pZmllZD1mdW5jdGlvbigpe3JldHVyblwidW5pZmllZFwiPT10aGlzLnNkcFNlbWFudGljc198fFwidW5pZmllZC1wbGFuXCI9PVxyXG50aGlzLnNkcFNlbWFudGljc199O2IucHJvdG90eXBlLm9uU3RhdGVDaGFuZ2U9ZnVuY3Rpb24oKXt2YXIgYT1uZXcgdyhcImljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLHRoaXMpO2lmKHRoaXMub25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2VfKXRoaXMub25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2VfKGEpfTtiLnByb3RvdHlwZS5hZGRJY2VDYW5kaWRhdGU9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkSWNlQ2FuZGlkYXRlKCkgY2FsbGVkLlwiKTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5hZGRJY2VDYW5kaWRhdGVcIikudGhlbihmdW5jdGlvbigpe3ZhciBjPXtjYW5kaWRhdGU6YS5jYW5kaWRhdGUsc2RwTWlkOmEuc2RwTWlkLHNkcE1MaW5lSW5kZXg6YS5zZHBNTGluZUluZGV4fTtpZih2b2lkIDA9PWMuY2FuZGlkYXRlfHxudWxsPT1jLmNhbmRpZGF0ZSljLmNhbmRpZGF0ZT1cclxuXCJcIjt2b2lkIDA9PWMuc2RwTWlkJiYoYy5zZHBNaWQ9bnVsbCk7dm9pZCAwPT1jLnNkcE1MaW5lSW5kZXgmJihjLnNkcE1MaW5lSW5kZXg9bnVsbCk7cmV0dXJuKG5ldyBrLkljZUNhbmRpZGF0ZShiLDAsZy5Qcm94eU1vZGUuTG9jYWwsYykpLnN5bmNCYXJyaWVyKCl9KS50aGVuKGZ1bmN0aW9uKGEpe3JldHVybiBiLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmFkZEljZUNhbmRpZGF0ZSx7b2lkOmEub2JqZWN0X2lkKCl9LHt9KX0pLnRoZW4oZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkSWNlQ2FuZGlkYXRlKCkgc3VjY2Vzcy5cIik7cmV0dXJuIGIudXBkYXRlU2RwRGVzY3JpcHRpb24oITEpfSkudGhlbihmdW5jdGlvbigpe2YubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5hZGRJY2VDYW5kaWRhdGUoKSAtIHN5bmMgcmVtb3RlIHNkcCBzdWNjZXNzLlwiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFxyXG5cIi5hZGRJY2VDYW5kaWRhdGUoKSBmYWlsZWQhXCIpfSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9uaWNlY2FuZGlkYXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9uaWNlY2FuZGlkYXRlX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbmljZWNhbmRpZGF0ZSgpIGNhbGxlZC5cIik7dGhpcy5vbmljZWNhbmRpZGF0ZV89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmljZWNhbmRpZGF0ZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLHUubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Qub25pY2VjYW5kaWRhdGUpO2MudGhlbihmdW5jdGlvbihhKXtmLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25pY2VjYW5kaWRhdGUgY2FsbGJhY2sgcmVjZWl2ZWQhISFcIik7XHJcbmE9bmV3IEQoYixiLnBhcmFtMChhKS5vaWQsYik7bnVsbCE9Yi5pY2VRXyYmYi5pY2VRXy5hZGRJY2VDYW5kaWRhdGUoYSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbmljZWNhbmRpZGF0ZSxjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0X29uaWNlY2FuZGlkYXRlKCkgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmNvbnZlcnRJY2VDb25uZWN0aW9uU3RhdGU9ZnVuY3Rpb24oYSl7cmV0dXJuIDA9PWE/XCJuZXdcIjoxPT1hP1wiY2hlY2tpbmdcIjoyPT1hP1wiY29ubmVjdGVkXCI6Mz09YT9cImNvbXBsZXRlZFwiOjQ9PWE/XCJmYWlsZWRcIjo1PT1hP1wiZGlzY29ubmVjdGVkXCI6XCJjbG9zZWRcIn07Yi5wcm90b3R5cGUuY29udmVydENvbm5lY3Rpb25TdGF0ZT1mdW5jdGlvbihhKXtpZigwIT1hKXtpZigxPT1hKXJldHVyblwiY29ubmVjdGluZ1wiO1xyXG5pZigyPT1hKXJldHVyblwiY29ubmVjdGVkXCI7aWYoMz09YSlyZXR1cm5cImRpc2Nvbm5lY3RlZFwiO2lmKDQ9PWEpcmV0dXJuXCJmYWlsZWRcIjtpZig1PT1hKXJldHVyblwiY2xvc2VkXCJ9cmV0dXJuXCJuZXdcIn07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25jb25uZWN0aW9uc3RhdGVjaGFuZ2VcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub25jb25uZWN0aW9uc3RhdGVjaGFuZ2VffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uY29ubmVjdGlvbnN0YXRlY2hhbmdlKCkgY2FsbGVkLlwiKTt0aGlzLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGIuaXNOdWxsQ2FsbGJhY2soYSksXHJcbnUubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Qub25jb25uZWN0aW9uc3RhdGVjaGFuZ2UpO2MudGhlbihmdW5jdGlvbihhKXtmLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25jb25uZWN0aW9uc3RhdGVjaGFuZ2UoKTogc3VjY2VzcyBjYWxsYmFjayByZWNlaXZlZCEhIVwiKTtiLmNvbm5lY3Rpb25TdGF0ZV89Yi5jb252ZXJ0Q29ubmVjdGlvblN0YXRlKGIucGFyYW0wKGEpKTtmLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIgY29ubmVjdGlvblN0YXRlPTpcIitiLmNvbm5lY3Rpb25TdGF0ZV8pO2E9bmV3IHcoXCJjb25uZWN0aW9uc3RhdGVjaGFuZ2VcIixiKTtiLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlXyhhKX0pO3JldHVybiBiLnJlbW90ZUludm9rZSghMCx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90Lm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlLGMuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcclxuXCIuc2V0X29uY29ubmVjdGlvbnN0YXRlY2hhbmdlKCkgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmdldF9jb25uZWN0aW9uU3RhdGU9ZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X2Nvbm5lY3Rpb25TdGF0ZSgpIGNhbGxlZCwgdmFsdWUgPSBcIit0aGlzLmNvbm5lY3Rpb25TdGF0ZV8pO3JldHVybiB0aGlzLmlzUmVkaXJlY3RlZCgpP3RoaXMuY29ubmVjdGlvblN0YXRlXzpcImZhaWxlZFwifTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZV99LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2UoKSBjYWxsZWQuXCIpO1xyXG50aGlzLm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGIuaXNOdWxsQ2FsbGJhY2soYSksdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSk7Yy50aGVuKGZ1bmN0aW9uKGEpe2YubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSgpOiBzdWNjZXNzIGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO2IuaWNlQ29ubmVjdGlvblN0YXRlXz1iLmNvbnZlcnRJY2VDb25uZWN0aW9uU3RhdGUoYi5wYXJhbTAoYSkpO2E9bmV3IHcoXCJpY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2VcIixiKTtiLm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlXyhhKX0pO3JldHVybiBiLnJlbW90ZUludm9rZSghMCxcclxudS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSxjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0X29uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlKCkgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImljZUNvbm5lY3Rpb25TdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X2ljZUNvbm5lY3Rpb25TdGF0ZSgpIGNhbGxlZCwgdmFsdWUgPSBcIit0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZV8pO3JldHVybiB0aGlzLmlzUmVkaXJlY3RlZCgpP3RoaXMuaWNlQ29ubmVjdGlvblN0YXRlXzpcImZhaWxlZFwifSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmNvbnZlcnRJY2VHYXRoZXJpbmdTdGF0ZT1cclxuZnVuY3Rpb24oYSl7cmV0dXJuIDA9PWE/XCJuZXdcIjoxPT1hP1wiZ2F0aGVyaW5nXCI6XCJjb21wbGV0ZVwifTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2VffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2UoKSBjYWxsZWQuXCIpO3RoaXMub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZV89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGIuaXNOdWxsQ2FsbGJhY2soYSksdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlKTtcclxuYy50aGVuKGZ1bmN0aW9uKGEpe2YubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlKCk6IGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO2IuaWNlR2F0aGVyaW5nU3RhdGVfPWIuY29udmVydEljZUdhdGhlcmluZ1N0YXRlKGIucGFyYW0wKGEpKTtudWxsIT1iLmljZVFfJiZiLmljZVFfLnB1c2hTdGF0ZShiLmljZUdhdGhlcmluZ1N0YXRlXyl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlLGMuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfb25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZSgpIGZhaWxlZCFcIil9KX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJpY2VHYXRoZXJpbmdTdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLmdldF9pY2VHYXRoZXJpbmdTdGF0ZSgpIGNhbGxlZCwgdmFsdWUgPSBcIit0aGlzLmljZUdhdGhlcmluZ1N0YXRlXyk7cmV0dXJuIHRoaXMuaWNlR2F0aGVyaW5nU3RhdGVffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmNvbnZlcnRTaWduYWxTdGF0ZT1mdW5jdGlvbihhKXtyZXR1cm4gMD09YT9cInN0YWJsZVwiOjE9PWE/XCJoYXZlLWxvY2FsLW9mZmVyXCI6Mj09YT9cImhhdmUtbG9jYWwtcHJhbnN3ZXJcIjozPT1hP1wiaGF2ZS1yZW1vdGUtb2ZmZXJcIjo0PT1hP1wiaGF2ZS1yZW1vdGUtcHJhbnN3ZXJcIjpcImNsb3NlZFwifTtiLnByb3RvdHlwZS5UZWxlbXRyeVJlYWRpbmdzXz1mdW5jdGlvbigpe1wiaGF2ZS1sb2NhbC1vZmZlclwiPT10aGlzLnNpZ25hbGluZ1N0YXRlXyYmMD09dGhpcy5maXJzdHRpbWVsb2NhbG9mZmVyXyYmMD09dGhpcy5maXJzdHRpbWVyZW1vdGVvZmZlcl8mJih0aGlzLm91dGdvaW5nY2FsbHN0YXJ0Xz0obmV3IERhdGUpLmdldFRpbWUoKSxcclxuMD09dGhpcy5vdXRnb2luZ2NhbGxfJiYodGhpcy5TZW5kVGVsZW1ldHJ5RGF0YSh4LnRlbF9rZXlfUGVyZkNhbGxTdGF0ZSx4LnRlbF9DYWxsU3RhdGUuYWN0aXZlLDEpLHRoaXMuU2VuZFRlbGVtZXRyeURhdGEoeC50ZWxfa2V5X1BlcmZDYWxsRGlyZWN0aW9uLHgudGVsX0NhbGxEaXJlY3Rpb24ub3V0Z29pbmcsMSksdGhpcy5vdXRnb2luZ2NhbGxfPSEwKSx0aGlzLmZpcnN0dGltZWxvY2Fsb2ZmZXJfPSEwKTtcImhhdmUtcmVtb3RlLW9mZmVyXCI9PXRoaXMuc2lnbmFsaW5nU3RhdGVfJiYwPT10aGlzLmZpcnN0dGltZXJlbW90ZW9mZmVyXyYmMD09dGhpcy5maXJzdHRpbWVsb2NhbG9mZmVyXyYmKHRoaXMuaW5jb21pbmdjYWxsc3RhcnRfPShuZXcgRGF0ZSkuZ2V0VGltZSgpLDA9PXRoaXMuaW5jb21pbmdjYWxsXyYmKHRoaXMuU2VuZFRlbGVtZXRyeURhdGEoeC50ZWxfa2V5X1BlcmZDYWxsU3RhdGUseC50ZWxfQ2FsbFN0YXRlLmFjdGl2ZSwxKSx0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHgudGVsX2tleV9QZXJmQ2FsbERpcmVjdGlvbixcclxueC50ZWxfQ2FsbERpcmVjdGlvbi5pbmNvbWluZywxKSx0aGlzLmluY29taW5nY2FsbF89ITApLHRoaXMuZmlyc3R0aW1lcmVtb3Rlb2ZmZXJfPSEwKTtcInN0YWJsZVwiPT10aGlzLnNpZ25hbGluZ1N0YXRlXyYmMD09dGhpcy5maXJzdHN0YWJsZV8mJih0aGlzLmNhbGxzdGFydFRpbWVfPShuZXcgRGF0ZSkuZ2V0VGltZSgpLHRoaXMuZmlyc3RzdGFibGVfPXRoaXMudGltZWVyc3RhcnRlZF89ITApO2lmKFwic3RhYmxlXCI9PXRoaXMuc2lnbmFsaW5nU3RhdGVfKXtmb3IodmFyIGE9MCxiPXRoaXMubG9jYWxTdHJlYW1zO2E8Yi5sZW5ndGg7YSsrKXt2YXIgYz1iW2FdOzE8PWMuZ2V0QXVkaW9UcmFja3MoKS5sZW5ndGgmJjA9PXRoaXMuYXVkaW9jYWxsXy5sb2NhbCYmKHRoaXMuU2VuZFRlbGVtZXRyeURhdGEoeC50ZWxfa2V5X1BlcmZDYWxsVHlwZSx4LnRlbF9DYWxsVHlwZS5hdWRpbywxKSx0aGlzLmF1ZGlvY2FsbF8ubG9jYWw9ITApO2M9Yy5nZXRWaWRlb1RyYWNrcygpO2lmKDE8PWMubGVuZ3RoKWZvcih2YXIgaD1cclxuMCxxPWM7aDxxLmxlbmd0aDtoKyspYz1xW2hdLDE9PWMuZ2V0U2V0dGluZ3MoKS5kZXZpY2VJZC5pbmNsdWRlcyhcImRpc3BsYXlcIik/MD09dGhpcy5zY3JlZW5zaGFyaW5nY2FsbF8ubG9jYWwmJih0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHgudGVsX2tleV9QZXJmQ2FsbFR5cGUseC50ZWxfQ2FsbFR5cGUuZHNoYXJlLDEpLHRoaXMuc2NyZWVuc2hhcmluZ2NhbGxfLmxvY2FsPSEwKTowPT10aGlzLnZpZGVvY2FsbF8ubG9jYWwmJih0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHgudGVsX2tleV9QZXJmQ2FsbFR5cGUseC50ZWxfQ2FsbFR5cGUudmlkZW8sMSksdGhpcy52aWRlb2NhbGxfLmxvY2FsPSEwKX1hPTA7Zm9yKGI9dGhpcy5yZW1vdGVTdHJlYW1zO2E8Yi5sZW5ndGg7YSsrKWlmKGM9YlthXSwxPD1jLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoJiYwPT10aGlzLmF1ZGlvY2FsbF8ucmVtb3RlJiYodGhpcy5TZW5kVGVsZW1ldHJ5RGF0YSh4LnRlbF9rZXlfUGVyZkNhbGxUeXBlLHgudGVsX0NhbGxUeXBlLmF1ZGlvLFxyXG4xKSx0aGlzLmF1ZGlvY2FsbF8ucmVtb3RlPSEwKSxoPWMuZ2V0VmlkZW9UcmFja3MoKSwxPD1oLmxlbmd0aClmb3IoYz0wO2M8aC5sZW5ndGg7YysrKTE9PWhbY10uaWQuaW5jbHVkZXMoXCJhcHBsaWNhdGlvbnNoYXJpbmdWaWRlb1wiKT8wPT10aGlzLnNjcmVlbnNoYXJpbmdjYWxsXy5yZW1vdGUmJih0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHgudGVsX2tleV9QZXJmQ2FsbFR5cGUseC50ZWxfQ2FsbFR5cGUuZHNoYXJlLDEpLHRoaXMuc2NyZWVuc2hhcmluZ2NhbGxfLnJlbW90ZT0hMCk6MD09dGhpcy52aWRlb2NhbGxfLnJlbW90ZSYmKHRoaXMuU2VuZFRlbGVtZXRyeURhdGEoeC50ZWxfa2V5X1BlcmZDYWxsVHlwZSx4LnRlbF9DYWxsVHlwZS52aWRlbywxKSx0aGlzLnZpZGVvY2FsbF8ucmVtb3RlPSEwKTsyPHRoaXMuZ2V0UmVjZWl2ZXJzKCkubGVuZ3RoJiYwPT10aGlzLmNvbmZlcmVuY2VjYWxsXyYmKHRoaXMuU2VuZFRlbGVtZXRyeURhdGEoeC50ZWxfa2V5X1BlcmZDYWxsVHlwZSxcclxueC50ZWxfQ2FsbFR5cGUubXVsdGksMSksdGhpcy5jb25mZXJlbmNlY2FsbF89ITApfX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25zaWduYWxpbmdzdGF0ZWNoYW5nZVwiLHtzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uc2lnbmFsaW5nc3RhdGVjaGFuZ2UoKSBjYWxsZWQuXCIpO3RoaXMub25zaWduYWxpbmdzdGF0ZWNoYW5nZV89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlZFwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLHUubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Qub25zaWduYWxpbmdzdGF0ZWNoYW5nZSk7Yy50aGVuKGZ1bmN0aW9uKGEpe2YubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlKCk6IGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO1xyXG5iLnNpZ25hbGluZ1N0YXRlXz1iLmNvbnZlcnRTaWduYWxTdGF0ZShiLnBhcmFtMChhKSk7YT1uZXcgdyhcIm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2VcIixiKTtiLm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2VfKGEpO2IuVGVsZW10cnlSZWFkaW5nc18oKX0pO3JldHVybiBiLnJlbW90ZUludm9rZSghMCx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90Lm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2UsYy5zdWNjZXNzKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnNldF9vbnNpZ25hbGluZ3N0YXRlY2hhbmdlKCkgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2VkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2VffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbnRyYWNrXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9udHJhY2tffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29udHJhY2soKSBjYWxsZWQuXCIpO3RoaXMub250cmFja189YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbnRyYWNrXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGIuaXNOdWxsQ2FsbGJhY2soYSksdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbnRyYWNrKTtjLnRoZW4oZnVuY3Rpb24oYSl7cmV0dXJuIG4oYix2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIGIsYyxoLHEsZCx3LEosRixyLEsseSx6PXRoaXM7cmV0dXJuIGUodGhpcyxmdW5jdGlvbihuKXtmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLm9udHJhY2soKTogY2FsbGJhY2sgcmVjZWl2ZWQhISFcIik7Yj1uZXcgQjtjPVtdO2g9dGhpcy5wYXJhbTAoYSk7dm9pZCAwIT1oLnRyYWNrJiYhMT09PWgudHJhY2suaXNfbnVsbCYmKGYubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIiBhZGRpbmcgYSBSZW1vdGVNZWRpYVRyYWNrIHdpdGggb2lkOlwiK2gudHJhY2sub2lkKSxxPW5ldyBwLlJlbW90ZU1lZGlhVHJhY2sodGhpcyxoLnRyYWNrLm9pZCksYy5wdXNoKHEuc3luY0JhcnJpZXIoKSkpO2IudHJhY2s9cTt2b2lkIDAhPWgucmVjZWl2ZXImJiExPT09aC5yZWNlaXZlci5pc19udWxsJiYoZD10aGlzLnJlY2VpdmVyc18uZmluZChmdW5jdGlvbihhKXtyZXR1cm4gYS5vYmplY3RfaWQoKT09PWgucmVjZWl2ZXIub2lkfSksdm9pZCAwPT09ZCYmKGYubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIiBhZGRpbmcgYSBSdHBSZWNlaXZlciB3aXRoIG9pZDpcIitoLnJlY2VpdmVyLm9pZCksZD1uZXcgbC5SdHBSZWNlaXZlcih0aGlzLFxyXG5oLnJlY2VpdmVyLm9pZCxnLlByb3h5TW9kZS5SZW1vdGUsdGhpcy5pc1VuaWZpZWQoKSxxKSksYy5wdXNoKGQuc3luY0JhcnJpZXIoKSkpO2IucmVjZWl2ZXI9ZDt0LlJlbW90ZVNlc3Npb24uaXNGZWF0dXJlV2VicnRjMWRvdDBTdXBwb3J0ZWQoKSYmdm9pZCAwIT1oLnRyYW5zY2VpdmVyJiYhMT09PWgudHJhbnNjZWl2ZXIuaXNfbnVsbCYmKHc9dGhpcy50cmFuc2NlaXZlcnNfLmZpbmQoZnVuY3Rpb24oYSl7cmV0dXJuIGEub2JqZWN0X2lkKCk9PT1oLnRyYW5zY2VpdmVyLm9pZH0pLHZvaWQgMD09PXcmJihmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIgYWRkaW5nIGEgUnRwVHJhbnNjZWl2ZXIgd2l0aCBvaWQ6XCIraC50cmFuc2NlaXZlci5vaWQpLHc9bmV3IHYuUnRwVHJhbnNjZWl2ZXIodGhpcyxoLnRyYW5zY2VpdmVyLm9pZCxnLlByb3h5TW9kZS5SZW1vdGUsdGhpcy5pc1VuaWZpZWQoKSxcImluYWN0aXZlXCIsZCksdGhpcy50cmFuc2NlaXZlcnNfLnB1c2godykpLFxyXG5jLnB1c2gody5zeW5jQmFycmllcigpKSk7Yi50cmFuc2NlaXZlcj13O2Iuc3RyZWFtcz1bXTtpZih2b2lkIDAhPWguc3RyZWFtcylmb3IoSj1mdW5jdGlvbihhKXt2YXIgaD1GLnJlbW90ZVN0cmVhbXMuZmluZChmdW5jdGlvbihiKXtyZXR1cm4hMT09PWEuaXNfbnVsbCYmYi5vYmplY3RfaWQoKT09PWEub2lkfSk7dm9pZCAwPT09aCYmKGYubG9nZ2VyLmxvZyhGLnVzZXJfZnJpZW5kbHlfaWQoKStcIiBhZGRpbmcgYSBSZW1vdGVTdHJlYW0gd2l0aCBvaWQ6XCIrYS5vaWQpLGg9bmV3IHAuUmVtb3RlU3RyZWFtKEYsYS5vaWQsZy5Qcm94eU1vZGUuUmVtb3RlKSxGLnJlbW90ZVN0cmVhbXMucHVzaChoKSk7Yy5wdXNoKGguc3luY0JhcnJpZXIoKSk7Yi5zdHJlYW1zLnB1c2goaCl9LEY9dGhpcyxyPTAsSz1oLnN0cmVhbXM7cjxLLmxlbmd0aDtyKyspeT1LW3JdLEooeSk7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9udHJhY2soKTogLnByb3Auc3luY0JhcnJpZXIgc3RhcnRcIik7XHJcblByb21pc2UuYWxsKGMpLnRoZW4oZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2coei51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub250cmFjaygpOiBub3RpZmllZCEhISB3aXRoIGV2dDogXCIrYik7Zm9yKHZhciBhPTAsYz1iLnN0cmVhbXM7YTxjLmxlbmd0aDthKyspY1thXS50b2dnbGVBdWRpbyghMSk7ei5vbnRyYWNrXyhiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7ei5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLm9udHJhY2soKTogLnByb3Auc3luY0JhcnJpZXIgZmFpbGVkLlwiKX0pO3JldHVyblsyXX0pfSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbnRyYWNrLGMuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfb250cmFjaygpOiBmYWlsZWQuXCIpfSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFxyXG5cInNpZ25hbGluZ1N0YXRlXCIse2dldDpmdW5jdGlvbigpe2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfc2lnbmFsaW5nU3RhdGUoKSBjYWxsZWQsIHZhbHVlID0gXCIrdGhpcy5zaWduYWxpbmdTdGF0ZV8pO3JldHVybiB0aGlzLnNpZ25hbGluZ1N0YXRlX30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbm5lZ290aWF0aW9ubmVlZGVkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9ubmVnb3RpYXRpb25uZWVkZWRffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29ubmVnb3RpYXRpb25uZWVkZWQoKSBjYWxsZWQuXCIpO3RoaXMub25uZWdvdGlhdGlvbm5lZWRlZF89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbm5lZ290aWF0aW9ubmVlZGVkXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1cclxuYi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLHUubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Qub25uZWdvdGlhdGlvbm5lZWRlZCk7Yy50aGVuKGZ1bmN0aW9uKCl7Zi5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9ubmVnb3RpYXRpb25uZWVkZWQoKTogY2FsbGJhY2sgcmVjZWl2ZWQhISFcIik7dmFyIGE9bmV3IHcoXCJuZWdvdGlhdGlvbm5lZWRlZFwiLGIpO2Iub25uZWdvdGlhdGlvbm5lZWRlZF8oYSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbm5lZ290aWF0aW9ubmVlZGVkLGMuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfb25uZWdvdGlhdGlvbm5lZWRlZCgpOiBmYWlsZWQuXCIpfSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuZHVtcENvbnN0cmFpbnRzPWZ1bmN0aW9uKGEpe2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCJjb25zdHJhaW50czogXCIrYSk7dm9pZCAwIT09YSYmMCE9PU9iamVjdC5rZXlzKGEpLmxlbmd0aHx8Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiY29uc3RyYWludHMgZWl0aGVyIHVuZGVmaW5lZCBvciBlbXB0eSFcIik7YSYmKGYubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIiAgLS0gdmlkZW86IFwiK2Eub2ZmZXJUb1JlY2VpdmVWaWRlbyksZi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiICAtLSBhdWRpbzogXCIrYS5vZmZlclRvUmVjZWl2ZUF1ZGlvKSxmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIgIC0tIGljZVJlc3RhcnQ6IFwiK2EuaWNlUmVzdGFydCksZi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiICAtLSB2b2ljZUFjdGl2aXR5RGV0ZWN0aW9uOiBcIithLnZvaWNlQWN0aXZpdHlEZXRlY3Rpb24pKX07Yi5wcm90b3R5cGUuZml4X2NvbnN0cmFpbnRzPWZ1bmN0aW9uKGEpe3RoaXMuZHVtcENvbnN0cmFpbnRzKGEpO1xyXG52YXIgYj17fTt0aGlzLmlzVW5pZmllZCgpfHwoYj17YXVkaW86ITAsdmlkZW86ITB9KTthJiYodm9pZCAwIT09YS52aWRlbyYmKGIudmlkZW89YS5vZmZlclRvUmVjZWl2ZVZpZGVvKSx2b2lkIDAhPT1hLmF1ZGlvJiYoYi5hdWRpbz1hLm9mZmVyVG9SZWNlaXZlQXVkaW8pLHZvaWQgMCE9PWEuaWNlUmVzdGFydCYmKGIuaWNlUmVzdGFydD1hLmljZVJlc3RhcnQpLHZvaWQgMCE9PWEudm9pY2VBY3Rpdml0eURldGVjdGlvbiYmKGIudm9pY2VBY3Rpdml0eURldGVjdGlvbj1hLnZvaWNlQWN0aXZpdHlEZXRlY3Rpb24pKTtyZXR1cm4gYn07Yi5wcm90b3R5cGUuY3JlYXRlT2ZmZXI9ZnVuY3Rpb24oYSxiLGMpe2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jcmVhdGVPZmZlcigpIGNhbGxlZC5cIixKU09OLnN0cmluZ2lmeShhKSk7cmV0dXJuIHRoaXMuaXNVbmlmaWVkKCk/dm9pZCAwPT1hP3RoaXMuY3JlYXRlT2ZmZXJfdjIoKTphP3RoaXMuY3JlYXRlT2ZmZXJfdjIoYSk6XHJcbnRoaXMuY3JlYXRlT2ZmZXJfdjEoYSxiLGMpOnRoaXMuY3JlYXRlT2ZmZXJfdjEoYSxiLGMpfTtiLnByb3RvdHlwZS5jcmVhdGVPZmZlcl92Mj1mdW5jdGlvbihhKXt2YXIgYj10aGlzO2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jcmVhdGVPZmZlcl92MigpIGNhbGxlZC5cIixKU09OLnN0cmluZ2lmeShhKSk7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsaCl7Yi5jcmVhdGVPZmZlcl92MShmdW5jdGlvbihhKXtmLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY3JlYXRlT2ZmZXJfdjIoKTogZ290IHNkcCEhIVwiKTthPW5ldyByKGEudHlwZSxhLnNkcCk7YyhhKX0sZnVuY3Rpb24oYSl7dm9pZCAwIT1hJiYoYT1iLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuY3JlYXRlT2ZmZXJfdjIoKSBmYWlsZWQuXCIpLGgoYSkpfSxhKX0pfTtiLnByb3RvdHlwZS5jcmVhdGVPZmZlcl92MT1mdW5jdGlvbihhLGIsYyl7dmFyIGg9dGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLmNyZWF0ZU9mZmVyX3YxKCkuXCIsSlNPTi5zdHJpbmdpZnkoYykpO3ZhciBkPVt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jcmVhdGVPZmZlcl92MVwiKSx0aGlzLndhaXRUcmFuc2NlaXZlclJlYWR5KHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZU9mZmVyX3YxXCIpXTtQcm9taXNlLmFsbChkKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGE9aC5yZWdpc3RlckNhbGxiYWNrcyghMCwhMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmNyZWF0ZU9mZmVyKTtoLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmNyZWF0ZU9mZmVyLGEuc3VjY2VzcyxhLmZhaWwsaC5maXhfY29uc3RyYWludHMoYykpO3JldHVybiBhLnByb20oKX0pLnRoZW4oZnVuY3Rpb24oYSl7Zi5sb2dnZXIubG9nKGgudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZU9mZmVyX3YxKCk6IHN1Y2Nlc3MgY2FsbGJhY2sgcmVjZWl2ZWQhISFcIik7XHJcbnJldHVybihuZXcgcShoLGgucGFyYW0wKGEpLm9pZCxnLlByb3h5TW9kZS5SZW1vdGUpKS5zeW5jQmFycmllcigpfSkudGhlbihmdW5jdGlvbihiKXthJiZhKGIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXt2b2lkIDAhPWEmJihhPWgubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5jcmVhdGVPZmZlcl92MSgpIGZhaWxlZC5cIiksYiYmYihhKSl9KX07Yi5wcm90b3R5cGUuY3JlYXRlQW5zd2VyPWZ1bmN0aW9uKGEsYixjKXtmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY3JlYXRlQW5zd2VyKCkgY2FsbGVkLlwiLEpTT04uc3RyaW5naWZ5KGEpKTtyZXR1cm4gdGhpcy5pc1VuaWZpZWQoKT92b2lkIDA9PWE/dGhpcy5jcmVhdGVBbnN3ZXJfdjIoKTphP3RoaXMuY3JlYXRlQW5zd2VyX3YyKGEpOnRoaXMuY3JlYXRlQW5zd2VyX3YxKGEsYixjKTp0aGlzLmNyZWF0ZUFuc3dlcl92MShhLGIsYyl9O2IucHJvdG90eXBlLmNyZWF0ZUFuc3dlcl92Mj1mdW5jdGlvbihhKXt2YXIgYj1cclxudGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY3JlYXRlQW5zd2VyX3YyKCkgY2FsbGVkLlwiLEpTT04uc3RyaW5naWZ5KGEpKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxoKXtiLmNyZWF0ZUFuc3dlcl92MShmdW5jdGlvbihhKXtmLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY3JlYXRlQW5zd2VyX3YyKCk6IGdvdCBzZHAhISFcIik7YT1uZXcgcihhLnR5cGUsYS5zZHApO2MoYSl9LGZ1bmN0aW9uKGEpe3ZvaWQgMCE9YSYmKGE9Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLmNyZWF0ZUFuc3dlcl92MigpIGZhaWxlZC5cIiksaChhKSl9LGEpfSl9O2IucHJvdG90eXBlLmNyZWF0ZUFuc3dlcl92MT1mdW5jdGlvbihhLGIsYyl7dmFyIGg9dGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY3JlYXRlQW5zd2VyX3YxKCkgY2FsbGVkLlwiLEpTT04uc3RyaW5naWZ5KGMpKTt2YXIgZD1bdGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLmNyZWF0ZUFuc3dlcl92MVwiKSx0aGlzLndhaXRUcmFuc2NlaXZlclJlYWR5KHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZUFuc3dlcl92MVwiKV07UHJvbWlzZS5hbGwoZCkudGhlbihmdW5jdGlvbigpe3ZhciBhPWgucmVnaXN0ZXJDYWxsYmFja3MoITAsITEsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5jcmVhdGVBbnN3ZXIpO2gucmVtb3RlSW52b2tlKCExLHUubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3QuY3JlYXRlQW5zd2VyLGEuc3VjY2VzcyxhLmZhaWwsaC5maXhfY29uc3RyYWludHMoYykse30pO3JldHVybiBhLnByb20oKX0pLnRoZW4oZnVuY3Rpb24oYSl7Zi5sb2dnZXIubG9nKGgudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZUFuc3dlcl92MSgpOiBzdWNjZXNzIGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO3JldHVybihuZXcgcShoLGgucGFyYW0wKGEpLm9pZCxnLlByb3h5TW9kZS5SZW1vdGUpKS5zeW5jQmFycmllcigpfSkudGhlbihmdW5jdGlvbihiKXthJiZcclxuYShiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7YT1oLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuY3JlYXRlQW5zd2VyX3YxKCkgZmFpbGVkLlwiKTtiJiZiKGEubWVzc2FnZSl9KX07Yi5wcm90b3R5cGUudXBkYXRlU2RwRGVzY3JpcHRpb249ZnVuY3Rpb24oYSl7cmV0dXJuIG4odGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIGIsYyxoLGQ9dGhpcztyZXR1cm4gZSh0aGlzLGZ1bmN0aW9uKHcpe3N3aXRjaCh3LmxhYmVsKXtjYXNlIDA6cmV0dXJuIGYubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi51cGRhdGVTZHBEZXNjcmlwdGlvbigpIGNhbGxlZC5cIiksMSE9YT9bMywyXTpbNCx0aGlzLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmxvY2FsRGVzY3JpcHRpb24se29pZDp0aGlzLm9iamVjdF9pZCgpfSldO2Nhc2UgMTpyZXR1cm4gYj13LnNlbnQoKSxbMyw0XTtjYXNlIDI6cmV0dXJuWzQsdGhpcy5yZW1vdGVJbnZva2UoITEsXHJcbnUubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3QucmVtb3RlRGVzY3JpcHRpb24se29pZDp0aGlzLm9iamVjdF9pZCgpfSldO2Nhc2UgMzpiPXcuc2VudCgpLHcubGFiZWw9NDtjYXNlIDQ6cmV0dXJuIGM9bmV3IHEodGhpcyx0aGlzLnBhcmFtMChiKS5vaWQsZy5Qcm94eU1vZGUuUmVtb3RlKSxbNCxjLnN5bmNCYXJyaWVyKClbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtkLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCJzZHAuc3luY0JhcnJpZXIoKSBmYWlsZWQhXCIpO3JldHVybiBudWxsfSldO2Nhc2UgNTpyZXR1cm4gaD13LnNlbnQoKSwxPT1hP3RoaXMubG9jYWxEZXNjcmlwdGlvbl89aDp0aGlzLnJlbW90ZURlc2NyaXB0aW9uXz1oLFsyXX19KX0pfTtiLnByb3RvdHlwZS5zZXRMb2NhbERlc2NyaXB0aW9uPWZ1bmN0aW9uKGEsYixjKXtmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0TG9jYWxEZXNjcmlwdGlvbigpIGNhbGxlZC5cIixKU09OLnN0cmluZ2lmeShhKSk7XHJcbmlmKGEgaW5zdGFuY2VvZiByKXJldHVybiB0aGlzLnNldExvY2FsRGVzY3JpcHRpb25fdjIoYSk7aWYoYSBpbnN0YW5jZW9mIFJUQ1Nlc3Npb25EZXNjcmlwdGlvbiYmYilyZXR1cm4gdGhpcy5zZXRMb2NhbERlc2NyaXB0aW9uX3YxKGEsYixjKTtiPXZvaWQgMDthP2I9bmV3IHIoYS50eXBlLGEuc2RwKTooZi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldExvY2FsRGVzY3JpcHRpb24oKSBlbXB0eSBwYXJhbTEsIHNldHRpbmcgc2RwIHR5cGUgdG8gcm9sbGJhY2tcIiksYT12b2lkIDAsYT1cImhhdmUtcmVtb3RlLW9mZmVyXCI9PXRoaXMuc2lnbmFsaW5nU3RhdGVfP1wiYW5zd2VyXCI6XCJoYXZlLWxvY2FsLXByYW5zd2VyXCI9PXRoaXMuc2lnbmFsaW5nU3RhdGVffHxcImhhdmUtcmVtb3RlLXByYW5zd2VyXCI9PXRoaXMuc2lnbmFsaW5nU3RhdGVfP1wicHJhbnN3ZXJcIjpcIm9mZmVyXCIsYj1uZXcgcihhLFwiXCIpKTtyZXR1cm4gdGhpcy5zZXRMb2NhbERlc2NyaXB0aW9uX3YyKGIpfTtcclxuYi5wcm90b3R5cGUuc2V0TG9jYWxEZXNjcmlwdGlvbl92Mj1mdW5jdGlvbihhKXt2YXIgYj10aGlzO2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRMb2NhbERlc2NyaXB0aW9uX3YyKCkgY2FsbGVkLlwiLEpTT04uc3RyaW5naWZ5KGEpKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxoKXtiLndhaXRVbnRpbENvbm5lY3RlZChiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRMb2NhbERlc2NyaXB0aW9uX3YyXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4obmV3IHEoYiwwLGcuUHJveHlNb2RlLkxvY2FsLHt0eXBlOnEuY29udmVydEMySChhLnR5cGUpLHNkcDphLnNkcH0pKS5zeW5jQmFycmllcigpfSkudGhlbihmdW5jdGlvbihkKXt2YXIgdz1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCEwLCExLHUubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Quc2V0TG9jYWxEZXNjcmlwdGlvbl92Mikscj17dHlwZTpxLmNvbnZlcnRDMkgoYS50eXBlKSxzZHA6YS5zZHB9O1xyXG5iLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LnNldExvY2FsRGVzY3JpcHRpb25fdjIscix3LnN1Y2Nlc3Msdy5mYWlsKTt3LnByb20oKS50aGVuKGZ1bmN0aW9uKCl7Zi5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldExvY2FsRGVzY3JpcHRpb25fdjIoKTogc3VjY2VzcyBjYWxsYmFjayByZWNlaXZlZCEhIVwiKTtiLmxvY2FsRGVzY3JpcHRpb25fPWQ7Zi5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldExvY2FsRGVzY3JpcHRpb25fdjIoKTogdXBkYXRlZCBsb2NhbERlc2NyaXB0aW9uX1wiKTtiLmlzVW5pZmllZCgpO1Byb21pc2UuYWxsKFtdKS50aGVuKGZ1bmN0aW9uKCl7Zi5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldExvY2FsRGVzY3JpcHRpb25fdjIoKSBzdWNjZXNzLlwiKTtjKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnByb3Auc2V0TG9jYWxEZXNjcmlwdGlvbl92MigpIGZhaWxlZCFcIik7XHJcbmgoYSl9KX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7YT1iLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCJzZXRMb2NhbERlc2NyaXB0aW9uX3YyKCkgZXJyb3IgY2FsbGJhY2sgcmVjZWl2ZWQhXCIpO2goYSl9KX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7YT1iLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0TG9jYWxEZXNjcmlwdGlvbl92MigpIGZhaWxlZC5cIik7aChhKX0pfSl9O2IucHJvdG90eXBlLnNldExvY2FsRGVzY3JpcHRpb25fdjE9ZnVuY3Rpb24oYSxiLGMpe3ZhciBoPXRoaXM7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldExvY2FsRGVzY3JpcHRpb25fdjEoKSBjYWxsZWQuXCIpO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldExvY2FsRGVzY3JpcHRpb25fdjFcIikudGhlbihmdW5jdGlvbigpe3JldHVybihuZXcgcShoLDAsZy5Qcm94eU1vZGUuTG9jYWwse3R5cGU6cS5jb252ZXJ0QzJIKGEudHlwZSksXHJcbnNkcDphLnNkcH0pKS5zeW5jQmFycmllcigpfSkudGhlbihmdW5jdGlvbihhKXt2YXIgcT1oLnJlZ2lzdGVyQ2FsbGJhY2tzKCEwLCExLHUubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Quc2V0TG9jYWxEZXNjcmlwdGlvbik7aC5yZW1vdGVJbnZva2UoITEsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5zZXRMb2NhbERlc2NyaXB0aW9uLHtvaWQ6YS5vYmplY3RfaWQoKX0scS5zdWNjZXNzLHEuZmFpbCk7cS5wcm9tKCkudGhlbihmdW5jdGlvbigpe2YubG9nZ2VyLmxvZyhoLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRMb2NhbERlc2NyaXB0aW9uX3YxKCk6IHN1Y2Nlc3MgY2FsbGJhY2sgcmVjZWl2ZWQhISFcIik7aC5sb2NhbERlc2NyaXB0aW9uXz1hO2YubG9nZ2VyLmxvZyhoLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRMb2NhbERlc2NyaXB0aW9uX3YxKCk6IHVwZGF0ZWQgbG9jYWxEZXNjcmlwdGlvbl9cIik7aC5pc1VuaWZpZWQoKTtQcm9taXNlLmFsbChbXSkudGhlbihmdW5jdGlvbigpe2YubG9nZ2VyLmxvZyhoLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuc2V0TG9jYWxEZXNjcmlwdGlvbl92MSgpIHN1Y2Nlc3MuXCIpO2ImJmIoKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7YT1oLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIucHJvcC5zZXRMb2NhbERlc2NyaXB0aW9uX3YxKCkgZmFpbGVkLlwiKTtjJiZjKGEubWVzc2FnZSl9KX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7YT1oLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0TG9jYWxEZXNjcmlwdGlvbl92MSgpIGVycm9yIGNhbGxiYWNrIHJlY2VpdmVkLlwiKTtjJiZjKGEubWVzc2FnZSl9KX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7YT1oLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0TG9jYWxEZXNjcmlwdGlvbl92MSgpIGZhaWxlZC5cIik7YyYmYyhhLm1lc3NhZ2UpfSl9O2IucHJvdG90eXBlLnNldFJlbW90ZURlc2NyaXB0aW9uPWZ1bmN0aW9uKGEsYixjKXtmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0UmVtb3RlRGVzY3JpcHRpb24oKSBjYWxsZWQuXCIsXHJcbkpTT04uc3RyaW5naWZ5KGEpKTtpZihhIGluc3RhbmNlb2YgcilyZXR1cm4gdGhpcy5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MihhKTtpZihhIGluc3RhbmNlb2YgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uJiZiKXJldHVybiB0aGlzLnNldFJlbW90ZURlc2NyaXB0aW9uX3YxKGEsYixjKTtiPXZvaWQgMDthP2I9bmV3IHIoYS50eXBlLGEuc2RwKTooZi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldFJlbW90ZURlc2NyaXB0aW9uKCkgZW1wdHkgcGFyYW0xLCBzZXR0aW5nIHNkcCB0eXBlIHRvIHJvbGxiYWNrXCIpLGE9dm9pZCAwLGE9XCJoYXZlLXJlbW90ZS1vZmZlclwiPT10aGlzLnNpZ25hbGluZ1N0YXRlXz9cImFuc3dlclwiOlwiaGF2ZS1sb2NhbC1wcmFuc3dlclwiPT10aGlzLnNpZ25hbGluZ1N0YXRlX3x8XCJoYXZlLXJlbW90ZS1wcmFuc3dlclwiPT10aGlzLnNpZ25hbGluZ1N0YXRlXz9cInByYW5zd2VyXCI6XCJvZmZlclwiLGI9bmV3IHIoYSxcIlwiKSk7cmV0dXJuIHRoaXMuc2V0UmVtb3RlRGVzY3JpcHRpb25fdjIoYil9O1xyXG5iLnByb3RvdHlwZS5zZXRSZW1vdGVEZXNjcmlwdGlvbl92Mj1mdW5jdGlvbihhKXt2YXIgYj10aGlzO2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MigpIGNhbGxlZC5cIixKU09OLnN0cmluZ2lmeShhKSk7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsaCl7Yi53YWl0VW50aWxDb25uZWN0ZWQoYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0UmVtb3RlRGVzY3JpcHRpb25fdjJcIikudGhlbihmdW5jdGlvbigpe3JldHVybihuZXcgcShiLDAsZy5Qcm94eU1vZGUuTG9jYWwse3R5cGU6cS5jb252ZXJ0QzJIKGEudHlwZSksc2RwOmEuc2RwfSkpLnN5bmNCYXJyaWVyKCl9KS50aGVuKGZ1bmN0aW9uKGQpe3ZhciB3PWIucmVnaXN0ZXJDYWxsYmFja3MoITAsITEsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5zZXRSZW1vdGVEZXNjcmlwdGlvbl92Mikscj17dHlwZTpxLmNvbnZlcnRDMkgoYS50eXBlKSxzZHA6YS5zZHB9O1xyXG5iLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LnNldFJlbW90ZURlc2NyaXB0aW9uX3YyLHIsdy5zdWNjZXNzLHcuZmFpbCk7dy5wcm9tKCkudGhlbihmdW5jdGlvbigpe2YubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MigpOiBzdWNjZXNzIGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO2IucmVtb3RlRGVzY3JpcHRpb25fPWQ7Zi5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldFJlbW90ZURlc2NyaXB0aW9uX3YyKCk6IHVwZGF0ZWQgcmVtb3RlRGVzY3JpcHRpb25fXCIpO3ZhciBhPVtdO2IuaXNVbmlmaWVkKCk/YS5wdXNoKGIuZ2V0VHJhbnNjZWl2ZXJzQXN5bmMoKSk6YS5wdXNoKGIuZ2V0U2VuZGVyc0FzeW5jKCkpO1Byb21pc2UuYWxsKGEpLnRoZW4oZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0UmVtb3RlRGVzY3JpcHRpb25fdjIoKTogc3VjY2Vzcy5cIik7XHJcbmMoKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7YT1iLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIucHJvcC5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MigpIGZhaWxlZC5cIik7aChhKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPWIubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MigpIGVycm9yIGNhbGxiYWNrIHJlY2VpdmVkLlwiKTtoKGEpfSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnNldFJlbW90ZURlc2NyaXB0aW9uX3YyKCkgZmFpbGVkLlwiKTtoKGEpfSl9KX07Yi5wcm90b3R5cGUuc2V0UmVtb3RlRGVzY3JpcHRpb25fdjE9ZnVuY3Rpb24oYSxiLGMpe3ZhciBoPXRoaXM7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldFJlbW90ZURlc2NyaXB0aW9uX3YxKCkgY2FsbGVkLlwiKTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MVwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuKG5ldyBxKGgsXHJcbjAsZy5Qcm94eU1vZGUuTG9jYWwse3R5cGU6cS5jb252ZXJ0QzJIKGEudHlwZSksc2RwOmEuc2RwfSkpLnN5bmNCYXJyaWVyKCl9KS50aGVuKGZ1bmN0aW9uKGEpe3ZhciBxPWgucmVnaXN0ZXJDYWxsYmFja3MoITAsITEsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5zZXRSZW1vdGVEZXNjcmlwdGlvbik7aC5yZW1vdGVJbnZva2UoITEsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5zZXRSZW1vdGVEZXNjcmlwdGlvbix7b2lkOmEub2JqZWN0X2lkKCl9LHEuc3VjY2VzcyxxLmZhaWwpO3EucHJvbSgpLnRoZW4oZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2coaC51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0UmVtb3RlRGVzY3JpcHRpb25fdjEoKTogc3VjY2VzcyBjYWxsYmFjayByZWNlaXZlZCEhIVwiKTtoLnJlbW90ZURlc2NyaXB0aW9uXz1hO2YubG9nZ2VyLmxvZyhoLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MSgpOiB1cGRhdGVkIHJlbW90ZURlc2NyaXB0aW9uX1wiKTtcclxudmFyIHE9W107aC5pc1VuaWZpZWQoKT9xLnB1c2goaC5nZXRUcmFuc2NlaXZlcnNBc3luYygpKTpxLnB1c2goaC5nZXRTZW5kZXJzQXN5bmMoKSk7UHJvbWlzZS5hbGwocSkudGhlbihmdW5jdGlvbigpe2YubG9nZ2VyLmxvZyhoLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MSgpOiBzdWNjZXNzLlwiKTtiJiZiKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9aC5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnByb3Auc2V0UmVtb3RlRGVzY3JpcHRpb25fdjEoKSBmYWlsZWQuXCIpO2MmJmMoYS5tZXNzYWdlKX0pfSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9aC5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnNldFJlbW90ZURlc2NyaXB0aW9uX3YxKCkgZmFpbGVkLlwiKTtjJiZjKGEubWVzc2FnZSl9KX07Yi5wcm90b3R5cGUuZ2V0TG9jYWxTdHJlYW1zPWZ1bmN0aW9uKCl7Zi5sb2dnZXIubG9nKFwiUGVlckNvbm5lY3Rpb24uZ2V0TG9jYWxTdHJlYW1zKCkgY2FsbGVkLiBbb2lkPVwiK1xyXG50aGlzLm9iamVjdF9pZCgpK1wiXVwiKTtmb3IodmFyIGE9MCxiPXRoaXMubG9jYWxTdHJlYW1zO2E8Yi5sZW5ndGg7YSsrKWYubG9nZ2VyLmxvZyhKU09OLnN0cmluZ2lmeShiW2FdKSk7cmV0dXJuIHRoaXMubG9jYWxTdHJlYW1zfTtiLnByb3RvdHlwZS5nZXRSZW1vdGVTdHJlYW1zPWZ1bmN0aW9uKCl7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFJlbW90ZVN0cmVhbXMoKSBjYWxsZWQuXCIpO2Zvcih2YXIgYT0wLGI9dGhpcy5yZW1vdGVTdHJlYW1zO2E8Yi5sZW5ndGg7YSsrKWYubG9nZ2VyLmxvZyhKU09OLnN0cmluZ2lmeShiW2FdKSk7cmV0dXJuIHRoaXMucmVtb3RlU3RyZWFtc307Yi5wcm90b3R5cGUuYWRkVHJhY2s9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzO2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5hZGRUcmFjaygpIGNhbGxlZDogXCIrSlNPTi5zdHJpbmdpZnkoYikpO3ZhciBoPVtdO2lmKGIgaW5zdGFuY2VvZiBwLlJlbW90ZVN0cmVhbSloLnB1c2goYi5pZCksXHJcbnRoaXMubG9jYWxTdHJlYW1zLnB1c2goYik7ZWxzZSBmb3IodmFyIHE9MDtxPGIubGVuZ3RoO3ErKyloLnB1c2goYltxXS5pZCksdGhpcy5sb2NhbFN0cmVhbXMucHVzaChiW3FdKTt2YXIgZD1uZXcgbC5SdHBTZW5kZXIodGhpcywwLGcuUHJveHlNb2RlLlBzZXVkbyx0aGlzLmlzVW5pZmllZCgpKTt0aGlzLnNlbmRlcnNfLnB1c2goZCk7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkVHJhY2tcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBjLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmFkZFRyYWNrLHtvaWQ6YS5vYmplY3RfaWQoKX0saCl9KS50aGVuKGZ1bmN0aW9uKGEpe2YubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5hZGRUcmFjaygpIHN1Y2Nlc3Mgd2l0aCBvaWQ6IFwiK2MucGFyYW0wKGEpLm9pZCk7ZC5iaW5kKGMsYy5wYXJhbTAoYSkub2lkKTtkLnN5bmNCYXJyaWVyKCkudGhlbihmdW5jdGlvbigpe2YubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCJzZW5kZXIuc3luY0JhcnJpZXIoKTogc3VjY2Vzc1wiKTtjLmlzVW5pZmllZCgpJiZjLmdldFRyYW5zY2VpdmVyc0FzeW5jKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2MubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcInNlbmRlci5zeW5jQmFycmllcigpIGZhaWxlZCFcIil9KX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yy5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiYWRkVHJhY2soKSBmYWlsZWQhXCIpfSk7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmFkZFRyYWNrKCkgcmV0dXJuaW5nOiBcIitkKTtyZXR1cm4gZH07Yi5wcm90b3R5cGUucmVtb3ZlVHJhY2s9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucmVtb3ZlVHJhY2soKSBjYWxsZWQuXCIpO2Zvcih2YXIgYz0wO2M8dGhpcy5zZW5kZXJzXy5sZW5ndGg7YysrKXRoaXMuc2VuZGVyc19bY109PWEmJnRoaXMuc2VuZGVyc18uc3BsaWNlKGMsMSk7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLnJlbW92ZVRyYWNrXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITEsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5yZW1vdmVUcmFjayx7b2lkOmEub2JqZWN0X2lkKCl9KX0pLnRoZW4oZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucmVtb3ZlVHJhY2soKSBzdWNjZXNzLlwiKTtiLmlzVW5pZmllZCgpJiZiLmdldFRyYW5zY2VpdmVyc0FzeW5jKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcInJlbW92ZVRyYWNrKCkgZmFpbGVkIVwiKX0pfTtiLnByb3RvdHlwZS5hZGRTdHJlYW09ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkU3RyZWFtKCkgY2FsbGVkOiBcIitKU09OLnN0cmluZ2lmeShhKSk7dGhpcy5sb2NhbFN0cmVhbXMucHVzaChhKTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuYWRkU3RyZWFtXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITEsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5hZGRTdHJlYW0se29pZDphLm9iamVjdF9pZCgpfSx7fSl9KS50aGVuKGZ1bmN0aW9uKCl7Zi5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLmFkZFN0cmVhbSgpIHN1Y2Nlc3MuXCIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCJhZGRTdHJlYW0oKSBmYWlsZWQuXCIpfSl9O2IucHJvdG90eXBlLnJlbW92ZVN0cmVhbT1mdW5jdGlvbihhKXt2YXIgYj10aGlzO2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5yZW1vdmVTdHJlYW0oKSBjYWxsZWQ6IFwiK0pTT04uc3RyaW5naWZ5KGEpKTtmb3IodmFyIGM9MDtjPHRoaXMubG9jYWxTdHJlYW1zLmxlbmd0aDtjKyspdGhpcy5sb2NhbFN0cmVhbXNbY109PWEmJnRoaXMubG9jYWxTdHJlYW1zLnNwbGljZShjLDEpO1xyXG50aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5yZW1vdmVTdHJlYW1cIikudGhlbihmdW5jdGlvbigpe3JldHVybiBiLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LnJlbW92ZVN0cmVhbSx7b2lkOmEub2JqZWN0X2lkKCl9KX0pLnRoZW4oZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucmVtb3ZlU3RyZWFtKCkgc3VjY2Vzcy5cIil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcInJlbW92ZVN0cmVhbSgpIGZhaWxlZC5cIil9KX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25hZGRzdHJlYW1cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub25hZGRzdHJlYW1ffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uYWRkc3RyZWFtKCkgY2FsbGVkLlwiKTtcclxudGhpcy5vbmFkZHN0cmVhbV89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmFkZHN0cmVhbVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLHUubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Qub25hZGRzdHJlYW0pO2MudGhlbihmdW5jdGlvbihhKXsobmV3IHAuUmVtb3RlU3RyZWFtRXZlbnQoYixiLnBhcmFtMChhKS5vaWQpKS5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oYSl7Zi5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uYWRkc3RyZWFtIGNhbGxiYWNrIHJlY2VpdmVkIVwiKTt2b2lkIDA9PT1iLnJlbW90ZVN0cmVhbXMuZmluZChmdW5jdGlvbihiKXtyZXR1cm4gdm9pZCAwIT1hLnN0cmVhbSYmYi5vYmplY3RfaWQoKT09PWEuc3RyZWFtLm9iamVjdF9pZCgpfSkmJmIucmVtb3RlU3RyZWFtcy5wdXNoKGEuc3RyZWFtKTt2b2lkIDAhPVxyXG5iLm9uYWRkc3RyZWFtXyYmKGYubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmFkZHN0cmVhbSBub3RpZmllZCEhISBcIithLnN0cmVhbS5pZCksYi5vbmFkZHN0cmVhbV8oYSkpfSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbmFkZHN0cmVhbSxjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCJzZXRfb25hZGRzdHJlYW0oKSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25yZW1vdmVzdHJlYW1cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub25yZW1vdmVzdHJlYW1ffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29ucmVtb3Zlc3RyZWFtKCkgY2FsbGVkLlwiKTt0aGlzLm9ucmVtb3Zlc3RyZWFtXz1cclxuYTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbnJlbW92ZXN0cmVhbVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLHUubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Qub25yZW1vdmVzdHJlYW0pO2MudGhlbihmdW5jdGlvbihhKXsobmV3IHAuUmVtb3RlU3RyZWFtRXZlbnQoYixiLnBhcmFtMChhKS5vaWQpKS5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oYSl7Zi5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9ucmVtb3Zlc3RyZWFtIGNhbGxiYWNrIHJlY2VpdmVkISBcIithLnN0cmVhbS5pZCk7dmFyIGM9Yi5yZW1vdGVTdHJlYW1zLmZpbmRJbmRleChmdW5jdGlvbihiKXtyZXR1cm4gYi5pZD09YS5zdHJlYW0uaWR9KTswPD1jJiZiLnJlbW90ZVN0cmVhbXMuc3BsaWNlKGMsMSk7Yi5vbnJlbW92ZXN0cmVhbV8oYSl9KX0pO3JldHVybiBiLnJlbW90ZUludm9rZSghMCxcclxudS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbnJlbW92ZXN0cmVhbSxjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCJzZXRfb25yZW1vdmVzdHJlYW0oKSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuZ2V0U3RhdHM9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxoKXt2YXIgcT10aGlzO2IuaXNSZWRpcmVjdGVkKCk/Yi53YWl0VW50aWxDb25uZWN0ZWQoYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0U3RhdHNcIikudGhlbihmdW5jdGlvbigpe3ZhciBoPWIucmVnaXN0ZXJDYWxsYmFja3MoITAsITEsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5nZXRTdGF0cyk7aC50aGVuKGZ1bmN0aW9uKGIpe3ZvaWQgMCE9PWIucGFyYW1zJiYwIT09Yi5wYXJhbXMubGVuZ3RoJiYoYT8oYShBLlN0YXRzUmVwb3J0LmZyb21KU09OKEpTT04ucGFyc2UoYi5wYXJhbXNbMF0pKSksXHJcbmMoKSk6YyhBLlN0YXRzUmVwb3J0LnRvUlRDU3RhdHNSZXBvcnQoSlNPTi5wYXJzZShiLnBhcmFtc1swXSkpKSl9KTtyZXR1cm4gYT9iLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmdldFN0YXRzLGguc3VjY2Vzcyk6Yi5yZW1vdGVJbnZva2UoITEsdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5nZXRTdGF0c192MixoLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtxJiYoYT1xLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuZ2V0U3RhdHMoKSBmYWlsZWQhXCIpLGgoYSkpfSk6KGEoe30pLGMoKSl9KX07Yi5wcm90b3R5cGUuU2VuZFRlbGVtZXRyeURhdGE9ZnVuY3Rpb24oYSxiLGMpe20uZ2V0UmVkaXJlY3RvcigpLnRlbGVtZXRyeS5TZW5kVGVsZW1ldHJ5RGF0YSh4LnRlbF9jbWQuRGF0YSxhLGIsYyl9O2IucHJvdG90eXBlLk1pbGxpc2Vjb25kc3RvRGlzcGxheWZvcm1hdF89ZnVuY3Rpb24oYSl7dmFyIGIsYztjPU1hdGguZmxvb3IoYS9cclxuMUUzKTtiPU1hdGguZmxvb3IoYy82MCk7YT1NYXRoLmZsb29yKGIvNjApO2YubG9nZ2VyLmxvZyhNYXRoLmZsb29yKGEvMjQpK1wiOlwiK2ElMjQrXCI6XCIrYiU2MCtcIjpcIitjJTYwKX07Yi5wcm90b3R5cGUuQ2FsY3VsYXRlQ2FsbER1cmF0aW9uYW5kVHlwZV89ZnVuY3Rpb24oKXtpZigxPT10aGlzLnRpbWVlcnN0YXJ0ZWRfKXt0aGlzLnRpbWVlcnN0YXJ0ZWRfPSExO3RoaXMuY2FsbGVuZFRpbWVfPShuZXcgRGF0ZSkuZ2V0VGltZSgpO3ZhciBhPXRoaXMuY2FsbGVuZFRpbWVfLXRoaXMuY2FsbHN0YXJ0VGltZV87dGhpcy5NaWxsaXNlY29uZHN0b0Rpc3BsYXlmb3JtYXRfKGEpO2E9TWF0aC5yb3VuZChhLzFFMyk7Zi5sb2dnZXIubG9nKFwiQ2FsbCBEdXJhdGlvbiBcIithKTsxPT10aGlzLmNvbmZlcmVuY2VjYWxsXz90aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHgudGVsX2tleV9Db25mZXJlbmNlQ2FsbER1cmF0aW9uLGEsMSk6KDE9PXRoaXMuYXVkaW9jYWxsXy5hY3RpdmUmJnRoaXMuU2VuZFRlbGVtZXRyeURhdGEoeC50ZWxfa2V5X0F1ZGlvQ2FsbER1cmF0aW9uLFxyXG5hLDEpLDE9PXRoaXMudmlkZW9jYWxsXy5hY3RpdmUmJnRoaXMuU2VuZFRlbGVtZXRyeURhdGEoeC50ZWxfa2V5X1ZpZGVvQ2FsbER1cmF0aW9uLGEsMSksMT09dGhpcy5zY3JlZW5zaGFyaW5nY2FsbF8uYWN0aXZlJiZ0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHgudGVsX2tleV9TY3JlZW5zaGFyaW5nQ2FsbER1cmF0aW9uLGEsMSkpO3ZhciBiOzE9PXRoaXMuZmlyc3R0aW1lbG9jYWxvZmZlcl8mJihiPXRoaXMuY2FsbHN0YXJ0VGltZV8tdGhpcy5vdXRnb2luZ2NhbGxzdGFydF8pOzE9PXRoaXMuZmlyc3R0aW1lcmVtb3Rlb2ZmZXJfJiYoYj10aGlzLmNhbGxzdGFydFRpbWVfLXRoaXMuaW5jb21pbmdjYWxsc3RhcnRfKTt0aGlzLk1pbGxpc2Vjb25kc3RvRGlzcGxheWZvcm1hdF8oYik7Yj1NYXRoLnJvdW5kKGIvMUUzKTtmLmxvZ2dlci5sb2coXCJDYWxsIEVzdGFibGlzaCBUaW1lIFwiK2IpOzE9PXRoaXMuaW5jb21pbmdjYWxsXz90aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHgudGVsX2tleV9DYWxsRXN0SW5jb21pbmcsXHJcbmIsMSk6MT09dGhpcy5vdXRnb2luZ2NhbGxfJiZ0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHgudGVsX2tleV9DYWxsRXN0T3V0Z29pbmcsYiwxKTt0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHgudGVsX2tleV9QZXJmQ2FsbFN0YXRlLHgudGVsX0NhbGxTdGF0ZS5pZGxlLDEpfX07Yi5wcm90b3R5cGUuY2xvc2U9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jbG9zZSgpIGNhbGxlZC5cIik7dGhpcy5DYWxjdWxhdGVDYWxsRHVyYXRpb25hbmRUeXBlXygpO3RoaXMudW5yZWdpc3RlclN0YXRlQ2hhbmdlTm90aWZpY2F0aW9uKHRoaXMub25TdGF0ZUNoYW5nZSk7dGhpcy5vbm5lZ290aWF0aW9ubmVlZGVkPXRoaXMub25zaWduYWxpbmdzdGF0ZWNoYW5nZT10aGlzLm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2U9dGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZT10aGlzLm9uaWNlY2FuZGlkYXRlPXRoaXMub25hZGRzdHJlYW09XHJcbm51bGw7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY2xvc2VcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBhLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmNsb3NlKX0pLnRoZW4oZnVuY3Rpb24oKXthLmljZVFfPW51bGw7YS5yZWxlYXNlKCk7Zi5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmNsb3NlKCkgc3VjY2Vzcy5cIil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2EubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5jbG9zZSgpIGZhaWxlZC5cIik7YS5pY2VRXz1udWxsO2EucmVsZWFzZSgpfSl9O2IucHJvdG90eXBlLmNyZWF0ZURUTUZTZW5kZXI9ZnVuY3Rpb24oYSl7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZURUTUZTZW5kZXIoKSBjYWxsZWQuXCIpO3ZhciBiLGM9dGhpcy5zZW5kZXJzXztpZih2b2lkIDA9PT1jfHwwPT09Yy5sZW5ndGgpYz10aGlzLmdldFNlbmRlcnMoKTtcclxudm9pZCAwIT1jJiYoYz1jLmZpbmQoZnVuY3Rpb24oYil7cmV0dXJuIGIudHJhY2suaWQ9PT1hLmlkfSksdm9pZCAwIT1jJiYoZi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiIHJldHVybmluZyBSdHBTZW5kZXIgd2l0aCBvaWQ6XCIrYy5vYmplY3RfaWQoKSksYj1jLmR0bWYpKTtyZXR1cm4gYn07Yi5wcm90b3R5cGUuZ2V0U2VuZGVycz1mdW5jdGlvbigpe3ZhciBhPXRoaXM7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFNlbmRlcnMoKSBjYWxsZWQuIFwiKTtpZih0aGlzLmlzVW5pZmllZCgpKXtmb3IodmFyIGI9W10sYz0wLGg9dGhpcy50cmFuc2NlaXZlcnNfO2M8aC5sZW5ndGg7YysrKWIucHVzaChoW2NdLnNlbmRlcik7dGhpcy5zZW5kZXJzXz1ifWVsc2UgdGhpcy5nZXRTZW5kZXJzQXN5bmMoKS50aGVuKGZ1bmN0aW9uKCl7Zi5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFNlbmRlcnMoKSBzdWNjZXNzLlwiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFxyXG5cIi5nZXRTZW5kZXJzKCkgZmFpbGVkIVwiKX0pO2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRTZW5kZXJzKCkgcmV0dXJuaW5nOlwiK3RoaXMuc2VuZGVyc18ubGVuZ3RoK1wiIGl0ZW1zXCIpO3JldHVybiB0aGlzLnNlbmRlcnNffTtiLnByb3RvdHlwZS5nZXRTZW5kZXJzQXN5bmM9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRTZW5kZXJzQXN5bmMoKSBjYWxsZWQuIFwiK3RoaXMuc2VuZGVyc18pO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2Eud2FpdFVudGlsQ29ubmVjdGVkKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFNlbmRlcnNBc3luY1wiKS50aGVuKGZ1bmN0aW9uKCl7Zi5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFNlbmRlcnNBc3luYyBpbnZva2luZyByZW1vdGVcIik7cmV0dXJuIGEucmVtb3RlSW52b2tlKCExLHUubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3QuZ2V0U2VuZGVycyxcclxuW10pfSkudGhlbihmdW5jdGlvbihjKXtmLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0U2VuZGVyc0FzeW5jIHJlbW90ZSBzdWNjZXNzXCIpO3ZhciBoPVtdLHE9W107Yy5wYXJhbXNbMF0uZm9yRWFjaChmdW5jdGlvbihiKXt2YXIgYz1hLnNlbmRlcnNfLmZpbmQoZnVuY3Rpb24oYSl7cmV0dXJuIGEub2JqZWN0X2lkKCk9PT1iLm9pZH0pO3ZvaWQgMD09PWMmJihmLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIgYWRkaW5nIGEgUnRwU2VuZGVyIHdpdGggb2lkOlwiK2Iub2lkKSxjPW5ldyBsLlJ0cFNlbmRlcihhLGIub2lkLGcuUHJveHlNb2RlLlJlbW90ZSxhLmlzVW5pZmllZCgpKSxxLnB1c2goYy5zeW5jQmFycmllcigpKSk7aC5wdXNoKGMpfSk7UHJvbWlzZS5hbGwocSkudGhlbihmdW5jdGlvbigpe2Euc2VuZGVyc189aDtmLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0U2VuZGVyc0FzeW5jOiByZXR1cm5pbmcgc2VuZGVycyB3aXRoIGlkcyBbXCIrXHJcbmEuc2VuZGVyc18ubWFwKGZ1bmN0aW9uKGEpe3JldHVybiBhLm9iamVjdF9pZCgpfSkrXCJdXCIpO2IoYS5zZW5kZXJzXyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGMpe2EubG9nUmVtb3RlSW52b2tlRXJyb3IoYyxcIi5wcm9wLmdldFNlbmRlcnNBc3luYygpIGZhaWxlZC5cIik7YS5zZW5kZXJzXz1bXTtiKGEuc2VuZGVyc18pfSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGMpe2EubG9nUmVtb3RlSW52b2tlRXJyb3IoYyxcIi5nZXRTZW5kZXJzQXN5bmMoKSBmYWlsZWQuXCIpO2Euc2VuZGVyc189W107YihhLnNlbmRlcnNfKX0pfSl9O2IucHJvdG90eXBlLmdldFJlY2VpdmVycz1mdW5jdGlvbigpe3ZhciBhPXRoaXM7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFJlY2VpdmVycygpIGNhbGxlZC4gXCIpO2lmKHRoaXMuaXNVbmlmaWVkKCkpe2Zvcih2YXIgYj1bXSxjPTAsaD10aGlzLnRyYW5zY2VpdmVyc187YzxoLmxlbmd0aDtjKyspYi5wdXNoKGhbY10ucmVjZWl2ZXIpO1xyXG50aGlzLnJlY2VpdmVyc189Yn1lbHNlIHRoaXMuZ2V0UmVjZWl2ZXJzQXN5bmMoKS50aGVuKGZ1bmN0aW9uKCl7Zi5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFJlY2VpdmVycygpIHN1Y2Nlc3MuXCIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuZ2V0UmVjZWl2ZXJzKCkgZmFpbGVkIVwiKX0pO2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRSZWNlaXZlcnMoKSByZXR1cm5pbmc6XCIrdGhpcy5yZWNlaXZlcnNfLmxlbmd0aCtcIiBpdGVtc1wiKTtyZXR1cm4gdGhpcy5yZWNlaXZlcnNffTtiLnByb3RvdHlwZS5nZXRSZWNlaXZlcnNBc3luYz1mdW5jdGlvbigpe3ZhciBhPXRoaXM7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFJlY2VpdmVyc0FzeW5jKCkgY2FsbGVkLiBcIit0aGlzLnJlY2VpdmVyc18pO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2Eud2FpdFVudGlsQ29ubmVjdGVkKGEudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5nZXRSZWNlaXZlcnNBc3luY1wiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGEucmVtb3RlSW52b2tlKCExLHUubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3QuZ2V0UmVjZWl2ZXJzLFtdKX0pLnRoZW4oZnVuY3Rpb24oYyl7Zi5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFJlY2VpdmVyc0FzeW5jOiByZW1vdGUgc3VjY2Vzcy5cIik7dmFyIGg9W10scT1bXTtjLnBhcmFtc1swXS5mb3JFYWNoKGZ1bmN0aW9uKGIpe3ZhciBjPWEucmVjZWl2ZXJzXy5maW5kKGZ1bmN0aW9uKGEpe3JldHVybiBhLm9iamVjdF9pZCgpPT09Yi5vaWR9KTt2b2lkIDA9PT1jJiYoZi5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiIGFkZGluZyBhIFJ0cFJlY2VpdmVyIHdpdGggb2lkOlwiK2Iub2lkKSxjPW5ldyBsLlJ0cFJlY2VpdmVyKGEsYi5vaWQsZy5Qcm94eU1vZGUuUmVtb3RlLGEuaXNVbmlmaWVkKCkpLHEucHVzaChjLnN5bmNCYXJyaWVyKCkpKTtoLnB1c2goYyl9KTtcclxuUHJvbWlzZS5hbGwocSkudGhlbihmdW5jdGlvbigpe2EucmVjZWl2ZXJzXz1oO2YubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRSZWNlaXZlcnNBc3luYzogcmV0dXJuaW5nIHJlY2VpdmVyIHdpdGggaWRzIFtcIithLnJlY2VpdmVyc18ubWFwKGZ1bmN0aW9uKGEpe3JldHVybiBhLm9iamVjdF9pZCgpfSkrXCJdXCIpO2IoYS5yZWNlaXZlcnNfKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYyl7YS5sb2dSZW1vdGVJbnZva2VFcnJvcihjLFwiLnByb3AuZ2V0UmVjZWl2ZXJzQXN5bmMoKSBmYWlsZWQhXCIpO2EucmVjZWl2ZXJzXz1bXTtiKGEucmVjZWl2ZXJzXyl9KX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYyl7YS5sb2dSZW1vdGVJbnZva2VFcnJvcihjLFwiLmdldFJlY2VpdmVyc0FzeW5jKCkgZmFpbGVkIVwiKTthLnJlY2VpdmVyc189W107YihhLnJlY2VpdmVyc18pfSl9KX07Yi5wcm90b3R5cGUuYWRkVHJhbnNjZWl2ZXI9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzO2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuYWRkVHJhbnNjZWl2ZXIoKSBjYWxsZWQ6IFwiK0pTT04uc3RyaW5naWZ5KGEpK1wiIGluaXQ9XCIrSlNPTi5zdHJpbmdpZnkoYikpO3RoaXMucGVuZGluZ3RyYW5zY2VpdmVyXz0hMDt2YXIgaD1cInNlbmRyZWN2XCI7YiYmYi5kaXJlY3Rpb24mJihoPWIuZGlyZWN0aW9uKTt2YXIgcT1uZXcgdi5SdHBUcmFuc2NlaXZlcih0aGlzLDAsZy5Qcm94eU1vZGUuUHNldWRvLHRoaXMuaXNVbmlmaWVkKCksaCk7dGhpcy50cmFuc2NlaXZlcnNfLnB1c2gocSk7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkVHJhbnNjZWl2ZXJcIikudGhlbihmdW5jdGlvbigpe3JldHVyblwic3RyaW5nXCI9PT10eXBlb2YgYT9jLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmFkZFRyYW5zY2VpdmVyV2l0aEtpbmQsYSxiKTpjLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmFkZFRyYW5zY2VpdmVyV2l0aFRyYWNrLFxyXG57b2lkOmEub2JqZWN0X2lkKCl9LGIpfSkudGhlbihmdW5jdGlvbihhKXtmLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkVHJhbnNjZWl2ZXIoKSBzdWNjZXNzIHdpdGggb2lkOiBcIitjLnBhcmFtMChhKS5vaWQpO3EuYmluZChjLGMucGFyYW0wKGEpLm9pZCk7cS5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkVHJhbnNjZWl2ZXIoKTogc3VjY2Vzc1wiKTtjLnBlbmRpbmd0cmFuc2NlaXZlcl89ITF9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2MubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5wcm9wLmFkZFRyYW5zY2VpdmVyKCkgZmFpbGVkIVwiKTtjLnBlbmRpbmd0cmFuc2NlaXZlcl89ITF9KX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yy5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiYWRkVHJhbnNjZWl2ZXIoKSBmYWlsZWQhXCIpO2MucGVuZGluZ3RyYW5zY2VpdmVyXz0hMX0pO2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuYWRkVHJhbnNjZWl2ZXIoKSByZXR1cm5pbmc6XCIpO3JldHVybiBxfTtiLnByb3RvdHlwZS53YWl0VHJhbnNjZWl2ZXJSZWFkeT1mdW5jdGlvbihhKXt2YXIgYj10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihjLGgpe2YubG9nZ2VyLnRyYWNlKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLndhaXRUcmFuc2NlaXZlclJlYWR5KCk6IHBlbmRpbmd0cmFuc2NlaXZlcl89XCIrYi5wZW5kaW5ndHJhbnNjZWl2ZXJfKTtpZigwPT1iLnBlbmRpbmd0cmFuc2NlaXZlcl8pe2Zvcig7Yi5kZWZlcnJlZE9mZmVyQW5zd2VycyYmMDxiLmRlZmVycmVkT2ZmZXJBbnN3ZXJzLmxlbmd0aDspYi5kZWZlcnJlZE9mZmVyQW5zd2Vycy5zaGlmdCgpLnBvc3QoITApO2MoKX1lbHNlIGIuZGVmZXJyZWRPZmZlckFuc3dlcnMucHVzaChuZXcgZy5kZWZlcnJlZF9hY3Rpb24oYyxoLGEpKSxiLmNoZWNrVHJhbnNjZWl2ZXIoMTUsMUUzKX0pfTtiLnByb3RvdHlwZS5jaGVja1RyYW5zY2VpdmVyPWZ1bmN0aW9uKGEsXHJcbmIpe3ZhciBjPXRoaXM7aWYoMD49YSlmb3IoZi5sb2dnZXIubG9nKFwiLmNoZWNrVHJhbnNjZWl2ZXIoKSB0aW1lb3V0IHdhaXRpbmcgZm9yIHRyYW5zY2VpdmVyIHJlYWR5IVwiKTt0aGlzLmRlZmVycmVkT2ZmZXJBbnN3ZXJzJiYwPHRoaXMuZGVmZXJyZWRPZmZlckFuc3dlcnMubGVuZ3RoOyl0aGlzLmRlZmVycmVkT2ZmZXJBbnN3ZXJzLnNoaWZ0KCkucG9zdCghMSk7ZWxzZSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7aWYoMD09Yy5wZW5kaW5ndHJhbnNjZWl2ZXJfKWZvcig7Yy5kZWZlcnJlZE9mZmVyQW5zd2VycyYmMDxjLmRlZmVycmVkT2ZmZXJBbnN3ZXJzLmxlbmd0aDspYy5kZWZlcnJlZE9mZmVyQW5zd2Vycy5zaGlmdCgpLnBvc3QoITApO2Vsc2UgZi5sb2dnZXIubG9nKCcuY2hlY2tUcmFuc2NlaXZlcigpOiBjb3VudD0gXCInK2EpLGMuY2hlY2tUcmFuc2NlaXZlcigtLWEsYil9LGIpfTtiLnByb3RvdHlwZS5nZXRUcmFuc2NlaXZlcnM9ZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLmdldFRyYW5zY2VpdmVycygpIGNhbGxlZC4gXCIpO2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRUcmFuc2NlaXZlcnMoKSByZXR1cm5pbmc6XCIrdGhpcy50cmFuc2NlaXZlcnNfLmxlbmd0aCtcIiBpdGVtc1wiKTtyZXR1cm4gdGhpcy50cmFuc2NlaXZlcnNffTtiLnByb3RvdHlwZS5nZXRUcmFuc2NlaXZlcnNBc3luYz1mdW5jdGlvbigpe3ZhciBhPXRoaXM7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFRyYW5zY2VpdmVyc0FzeW5jKCkgY2FsbGVkLiBcIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGIsYyl7YS53YWl0VW50aWxDb25uZWN0ZWQoYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0VHJhbnNjZWl2ZXJzQXN5bmNcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBhLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmdldFRyYW5zY2VpdmVycyxbXSl9KS50aGVuKGZ1bmN0aW9uKGMpe2YubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuZ2V0VHJhbnNjZWl2ZXJzQXN5bmMoKSByZW1vdGUgc3VjY2Vzcy5cIik7dmFyIGg9W10scT1bXTtjLnBhcmFtc1swXS5mb3JFYWNoKGZ1bmN0aW9uKGIpe3ZhciBjPWEudHJhbnNjZWl2ZXJzXy5maW5kKGZ1bmN0aW9uKGEpe3JldHVybiBhLm9iamVjdF9pZCgpPT09Yi5vaWR9KTt2b2lkIDA9PT1jJiYoZi5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiIGFkZGluZyBhIFJ0cFRyYW5zY2VpdmVyIHdpdGggb2lkOlwiK2Iub2lkKSxjPW5ldyB2LlJ0cFRyYW5zY2VpdmVyKGEsYi5vaWQsZy5Qcm94eU1vZGUuUmVtb3RlLGEuaXNVbmlmaWVkKCkpLHEucHVzaChjLnN5bmNCYXJyaWVyKCkpKTtoLnB1c2goYyl9KTtQcm9taXNlLmFsbChxKS50aGVuKGZ1bmN0aW9uKCl7YS50cmFuc2NlaXZlcnNfPWg7Zi5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnByb3AuZ2V0VHJhbnNjZWl2ZXJzQXN5bmM6IHJldHVybmluZyB0cmFuc2NlaXZlciB3aXRoIGlkcyBbXCIrYS50cmFuc2NlaXZlcnNfLm1hcChmdW5jdGlvbihhKXtyZXR1cm4gYS5vYmplY3RfaWQoKX0pK1xyXG5cIl1cIik7YihhLnRyYW5zY2VpdmVyc18pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihjKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGMsXCIucHJvcC5nZXRUcmFuc2NlaXZlcnNBc3luYygpIGZhaWxlZCFcIik7YS50cmFuc2NlaXZlcnNfPVtdO2IoYS50cmFuc2NlaXZlcnNfKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihjKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGMsXCIuZ2V0VHJhbnNjZWl2ZXJzQXN5bmMoKSBmYWlsZWQhXCIpO2EudHJhbnNjZWl2ZXJzXz1bXTtiKGEudHJhbnNjZWl2ZXJzXyl9KX0pfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJzY3RwXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNjdHBffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9uZGF0YWNoYW5uZWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub25kYXRhY2hhbm5lbF99LHNldDpmdW5jdGlvbihhKXt2YXIgYj1cclxudGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uZGF0YWNoYW5uZWwoKSBjYWxsZWQuXCIpO3RoaXMub25kYXRhY2hhbm5lbF89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmRhdGFjaGFubmVsXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGIuaXNOdWxsQ2FsbGJhY2soYSksdS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbmRhdGFjaGFubmVsKTtjLnRoZW4oZnVuY3Rpb24oYSl7Zi5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uZGF0YWNoYW5uZWwgY2FsbGJhY2sgcmVjZWl2ZWQhISFcIik7aWYobnVsbD09PWIucmVtb3RlZGF0YWNoYW5uZWxffHxiLnJlbW90ZWRhdGFjaGFubmVsXy5vYmplY3RfaWQoKSE9Yi5wYXJhbTAoYSkub2lkKWIucmVtb3RlZGF0YWNoYW5uZWxfPW5ldyB6LlJ0Y0RhdGFDaGFubmVsKGIsYi5wYXJhbTAoYSkub2lkLFxyXG5nLlByb3h5TW9kZS5SZW1vdGUpLGIucmVtb3RlZGF0YWNoYW5uZWxfLnN5bmNCYXJyaWVyKCkudGhlbihmdW5jdGlvbigpe2YubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcInJlbW90ZWRhdGFjaGFubmVsXy5zeW5jQmFycmllcigpOiBzdWNjZXNzXCIpO3ZhciBhPW5ldyBFdmVudChcIm9uZGF0YWNoYW5uZWxcIik7YS5jaGFubmVsPWIucmVtb3RlZGF0YWNoYW5uZWxfO2lmKGIubG9jYWxkYXRhY2hhbm5lbF8mJiFiLmxvY2FsZGF0YWNoYW5uZWxfLmlzZGVzdHJveWVkKCkpYi5sb2NhbGRhdGFjaGFubmVsXy5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCJvbmRhdGFjaGFubmVsKCk6IG5vdGlmeWluZy4uLlwiKTtpZihiLm9uZGF0YWNoYW5uZWxfKWIub25kYXRhY2hhbm5lbF8oYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7Zi5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wibG9jYWxkYXRhY2hhbm5lbF8uc3luY0JhcnJpZXIoKTogZmFpbGVkIVwiKX0pO1xyXG5lbHNlIGlmKGYubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIm9uZGF0YWNoYW5uZWwoKTogbm90aWZ5aW5nLi4uXCIpLGIub25kYXRhY2hhbm5lbF8pYi5vbmRhdGFjaGFubmVsXyhhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCJyZW1vdGVkYXRhY2hhbm5lbF8uc3luY0JhcnJpZXIoKTogZmFpbGVkIVwiKX0pfSk7cmV0dXJuIGIucmVtb3RlSW52b2tlKCEwLHUubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Qub25kYXRhY2hhbm5lbCxjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2YubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmRhdGFjaGFubmVsKCkgZmFpbGVkLlwiKX0pfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmZpeERhdGFDaGFubmVsQ29uZmlnPWZ1bmN0aW9uKGEpe2YubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5maXhEYXRhQ2hhbm5lbENvbmZpZygpIGNhbGxlZDogXCIrXHJcbmEpO3ZvaWQgMD09YSYmKGE9e30pO3ZvaWQgMD09YS5uZWdvdGlhdGVkJiZ2b2lkIDA9PWEuaWQmJihhLm5lZ290aWF0ZWQ9ITEsYS5pZD0tMSk7cmV0dXJuIGF9O2IucHJvdG90eXBlLmNyZWF0ZURhdGFDaGFubmVsPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcztmLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY3JlYXRlRGF0YUNoYW5uZWwoKSBjYWxsZWQuIGxhYmVsOlwiK2EpO3RoaXMubG9jYWxkYXRhY2hhbm5lbF89bmV3IHouUnRjRGF0YUNoYW5uZWwodGhpcywwLGcuUHJveHlNb2RlLlBzZXVkbyk7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY3JlYXRlRGF0YUNoYW5uZWxcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBjLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmNyZWF0ZURhdGFDaGFubmVsLGEsYy5maXhEYXRhQ2hhbm5lbENvbmZpZyhiKSl9KS50aGVuKGZ1bmN0aW9uKGEpe2YubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuY3JlYXRlRGF0YUNoYW5uZWwoKSBzdWNjZXNzIHdpdGggb2lkOiBcIitjLnBhcmFtMChhKS5vaWQpO2MubG9jYWxkYXRhY2hhbm5lbF8uYmluZChjLGMucGFyYW0wKGEpLm9pZCk7Yy5sb2NhbGRhdGFjaGFubmVsXy5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oKXtmLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCJjaGFubmVsLnN5bmNCYXJyaWVyKCk6IHN1Y2Nlc3NcIil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7Zi5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiY2hhbm5lbC5zeW5jQmFycmllcigpOiBmYWlsZWQhXCIpfSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9Yy5wYXJhbTAoYSk7Zi5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZURhdGFDaGFubmVsKCkgZmFpbGVkIHdpdGggZXJyb3I6IFwiK2EpfSk7Zi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZURhdGFDaGFubmVsKCkgcmV0dXJuaW5nOiBcIitcclxudGhpcy5sb2NhbGRhdGFjaGFubmVsXyk7cmV0dXJuIHRoaXMubG9jYWxkYXRhY2hhbm5lbF99O3JldHVybiBifShnLlByb3h5T2JqZWN0KTthLlBlZXJDb25uZWN0aW9uPWJ9LDY1ODpmdW5jdGlvbihiLGEsYyl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGQ9Yyg5NDYpLG49Yyg4NTEpLGU9Yyg1NDUpLG09YygyNDcpLHA9Yyg1NTApLGw9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsYyxkKXt0aGlzLnJlc29sdmU9Yjt0aGlzLnJlamVjdD1jO3RoaXMubmFtZV89ZH1PYmplY3QuZGVmaW5lUHJvcGVydHkoYS5wcm90b3R5cGUsXCJuYW1lXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm5hbWVffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2EucHJvdG90eXBlLnBvc3Q9ZnVuY3Rpb24oYSl7MT09YT8obi5sb2dnZXIubG9nKCdkZWZlcnJlZF9hY3Rpb24ucG9zdCgpOiByZXNvbHZpbmcgXCInK3RoaXMubmFtZV8rJ1wiJyksXHJcbnRoaXMucmVzb2x2ZSgpKToobi5sb2dnZXIubG9nKCdkZWZlcnJlZF9hY3Rpb24ucG9zdCgpOiByZWplY3RpbmcgXCInK3RoaXMubmFtZV8rJ1wiJyksdGhpcy5yZWplY3QoKSl9O2EucHJvdG90eXBlLnBvc3RXaXRoUmVzdWx0PWZ1bmN0aW9uKGEsYil7MT09YT8obi5sb2dnZXIubG9nKCdkZWZlcnJlZF9hY3Rpb24ucG9zdCgpOiByZXNvbHZpbmcgXCInK3RoaXMubmFtZV8rJ1wiJyksdGhpcy5yZXNvbHZlKGIpKToobi5sb2dnZXIubG9nKCdkZWZlcnJlZF9hY3Rpb24ucG9zdCgpOiByZWplY3RpbmcgXCInK3RoaXMubmFtZV8rJ1wiJyksdGhpcy5yZWplY3QoKSl9O3JldHVybiBhfSgpO2EuZGVmZXJyZWRfYWN0aW9uPWw7dmFyIGc9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiKXt0aGlzLmlkPWE7dGhpcy5pc19udWxsPWJ9fSgpO2EucnBjX2NhbGxiYWNrPWc7dmFyIGs9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsYyxkKXt0aGlzLnN1Y2Nlc3M9bmV3IGcoYjw8MTYsYyk7dGhpcy5mYWlsPVxyXG5uZXcgZyhiPDwxNnwxLGMpO3RoaXMuaWQ9Yjt0aGlzLm9uZVNob3Q9ZH1hLnByb3RvdHlwZS5yZXNvbHZlPWZ1bmN0aW9uKGEpe24ubG9nZ2VyLnRyYWNlKFwiY2FsbGJhY2sucmVzb2x2ZSgpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO251bGwhPXRoaXMuaGFuZGxlciYmdGhpcy5oYW5kbGVyKGEpfTthLnByb3RvdHlwZS5yZWplY3Q9ZnVuY3Rpb24oYSl7bnVsbCE9dGhpcy5lcnJfaGFuZGxlciYmdGhpcy5lcnJfaGFuZGxlcihhKX07YS5wcm90b3R5cGUudGhlbj1mdW5jdGlvbihhKXt0aGlzLmhhbmRsZXI9YX07YS5wcm90b3R5cGUucHJvbT1mdW5jdGlvbigpe3ZhciBhPXRoaXM7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGIsYyl7YS5oYW5kbGVyPWI7YS5lcnJfaGFuZGxlcj1jfSl9O3JldHVybiBhfSgpO2EuY2FsbGJhY2s9azt2YXIgdjsoZnVuY3Rpb24oYSl7YVthLk5vdENvbmZpZ3VyZWQ9MF09XCJOb3RDb25maWd1cmVkXCI7YVthLkNvbmZpZ3VyZWQ9MV09XCJDb25maWd1cmVkXCI7XHJcbmFbYS5FcnJvcj0yXT1cIkVycm9yXCI7YVthLkRlc3Ryb3llZD0zXT1cIkRlc3Ryb3llZFwifSkodnx8KHY9e30pKTt2YXIgdDsoZnVuY3Rpb24oYSl7YVthLkxvY2FsPTBdPVwiTG9jYWxcIjthW2EuUmVtb3RlPTFdPVwiUmVtb3RlXCI7YVthLlBzZXVkbz0yXT1cIlBzZXVkb1wifSkodD1hLlByb3h5TW9kZXx8KGEuUHJveHlNb2RlPXt9KSk7Yj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixjLGcsbCxrKXt2b2lkIDA9PT1rJiYoaz1udWxsKTtmb3IodmFyIEM9W10scj01O3I8YXJndW1lbnRzLmxlbmd0aDtyKyspQ1tyLTVdPWFyZ3VtZW50c1tyXTt2YXIgcT10aGlzO3RoaXMuaGR4bXM9ZC5nZXRSZWRpcmVjdG9yKCk7dGhpcy5paWQ9Yzt0aGlzLm9pZD1nO3RoaXMubW9kZT1sO3RoaXMucHJveHlzdGF0ZT12Lk5vdENvbmZpZ3VyZWQ7dGhpcy5kZWZlcnJlZEFjdGlvbnM9W107dGhpcy5jYnM9bmV3IE1hcDtsPT09dC5Mb2NhbD8ocj0hMSx0aGlzLmlpZD09PXAuY2xhc3NfaWRfdC5FbmdpbmVDb250cm9sJiZcclxuKHI9ITApLHRoaXMuaGR4bXMuc3RhcnRSZWRpcmVjdGlvbihyLHRoaXMudXNlcl9mcmllbmRseV9pZCgpKS50aGVuKGZ1bmN0aW9uKCl7cS5vaWQ9YS5uZXh0SWQrKztuLmxvZ2dlci5sb2cocS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIgYXNzaWduZWQgbG9jYWwgb2lkOlwiK3Eub2lkKTt2YXIgYj1wLldlYnJwY0NsYXNzTGliSW5mb1V0aWwuZ2V0TWV0aG9kRmVhdHVyZUJ5aWQoYywwKTtyZXR1cm4gcS5oZHhtcy5XU1NlbmRPYmplY3RXcmFwcGVyKGIsYywwLGUuV3NKc29uVXRpbC5jcmVhdGVNZXNzYWdlQnlpZC5hcHBseShlLldzSnNvblV0aWwsWyExLCExLGUud3NfbXNnX3R5cGVfdC5yZXEsYywwLHEub2lkXS5jb25jYXQoQykpKX0pLnRoZW4oZnVuY3Rpb24oYSl7bi5sb2dnZXIudHJhY2UoXCJQcm94eU9iamVjdDogc2V0dGluZyBzdGF0ZSB0byBjb25maWd1cmVkLiAoaWlkOiBcIitxLmlpZCtcIiBvaWQ6IFwiK3Eub2lkK1wiKVwiKTt2YXIgYz1xLm9pZDtxLnByb3h5c3RhdGU9di5Db25maWd1cmVkO1xyXG5xLm9pZD1xLnBhcmFtMChhKTtuLmxvZ2dlci5sb2cocS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIgYXNzaWduZWQgcmVtb3RlIG9pZCBmb3IgbG9jYWwgb2lkOlwiK2MpO3Eub25Db25uZWN0ZWQoKTtrJiZrKCk7bS5nYy50cmFja09iamVjdChxLGIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe3EucHJveHlzdGF0ZT12LkVycm9yO3Eub25Db25uZWN0ZWQoKX0pKTpsPT09dC5SZW1vdGUmJih0aGlzLnByb3h5c3RhdGU9di5Db25maWd1cmVkLG0uZ2MudHJhY2tPYmplY3QodGhpcyxiKSl9YS5wcm90b3R5cGUuYmluZD1mdW5jdGlvbihhLGIpe24ubG9nZ2VyLnRyYWNlKFwiUHJveHlPYmplY3Q6IGJpbmRpbmcgb2JqZWN0LiAoaWlkOiBcIit0aGlzLmlpZCtcIiBvaWQ6IFwiK2IrXCIgbW9kZTogXCIrdGhpcy5tb2RlK1wiKVwiKTtpZih0aGlzLm1vZGU9PT10LlBzZXVkbyl7dGhpcy5wcm94eXN0YXRlPXYuQ29uZmlndXJlZDt2YXIgYz10aGlzLm9pZDt0aGlzLm9pZD1iO24ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIgYXNzaWduZWQgcmVtb3RlIG9pZCBmb3IgbG9jYWwgb2lkOlwiK2MpO3RoaXMub25Db25uZWN0ZWQoKTttLmdjLnRyYWNrT2JqZWN0KHRoaXMsYSk7dGhpcy5tb2RlPXQuUmVtb3RlfWVsc2UgdGhpcy5tb2RlPT09dC5SZW1vdGU/bi5sb2dnZXIubG9nKFwiUHJveHlPYmplY3Q6IGJpbmRpbmcgYWxyZWFkeSBjb21wbGV0ZS5cIik6bi5sb2dnZXIubG9nKFwiUHJveHlPYmplY3Q6IGJpbmRpbmcgZmFpbHVyZS4gaW5jb3JyZWN0IG1vZGUhXCIpfTthLnByb3RvdHlwZS5yZWNvbnN0cnVjdG9yPWZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9dGhpcyx0PVtdLGc9MztnPGFyZ3VtZW50cy5sZW5ndGg7ZysrKXRbZy0zXT1hcmd1bWVudHNbZ107dGhpcy5wcm94eXN0YXRlPXYuTm90Q29uZmlndXJlZDt0aGlzLmRlZmVycmVkQWN0aW9ucz1bXTtnPXAuV2VicnBjQ2xhc3NMaWJJbmZvVXRpbC5nZXRNZXRob2RGZWF0dXJlQnlpZChiLDApO3RoaXMuaGR4bXMuV1NTZW5kT2JqZWN0V3JhcHBlcihnLGIsXHJcbjAsZS5Xc0pzb25VdGlsLmNyZWF0ZU1lc3NhZ2VCeWlkLmFwcGx5KGUuV3NKc29uVXRpbCxbITEsITEsZS53c19tc2dfdHlwZV90LnJlcSxiLDAsdGhpcy5vaWRdLmNvbmNhdCh0KSkpLnRoZW4oZnVuY3Rpb24oYil7bi5sb2dnZXIudHJhY2UoXCJQcm94eU9iamVjdDogc2V0dGluZyBzdGF0ZSB0byBjb25maWd1cmVkLiAoaWlkOiBcIitkLmlpZCtcIiBvaWQ6IFwiK2Qub2lkK1wiKVwiKTt2YXIgYz1kLm9pZDtkLnByb3h5c3RhdGU9di5Db25maWd1cmVkO2Qub2lkPWQucGFyYW0wKGIpO24ubG9nZ2VyLmxvZyhkLnVzZXJfZnJpZW5kbHlfaWQoKStcIiBhc3NpZ25lZCByZW1vdGUgb2lkIGZvciBsb2NhbCBvaWQ6XCIrYyk7ZC5vbkNvbm5lY3RlZCgpO20uZ2MudHJhY2tPYmplY3QoZCxhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtkLnByb3h5c3RhdGU9di5FcnJvcjtkLm9uQ29ubmVjdGVkKCl9KX07YS5wcm90b3R5cGUuc2V0UGFyZW50PWZ1bmN0aW9uKGEpe20uZ2Muc2V0UGFyZW50KHRoaXMsYSl9O1xyXG5hLnByb3RvdHlwZS5yZWxlYXNlPWZ1bmN0aW9uKCl7bi5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnJlbGVhc2UoKSBjYWxsZWQuXCIpO20uZ2MucmVsZWFzZU9iamVjdCh0aGlzKX07YS5wcm90b3R5cGUuZGVzdHJveT1mdW5jdGlvbigpe24ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5kZXN0cm95KCkgY2FsbGVkLlwiKTt0aGlzLnByb3h5c3RhdGU9di5EZXN0cm95ZWQ7dmFyIGE9cC5XZWJycGNDbGFzc0xpYkluZm9VdGlsLmdldE1ldGhvZEZlYXR1cmVCeWlkKHRoaXMuaWlkLDApO3RoaXMuaGR4bXMuV1NTZW5kT2JqZWN0V3JhcHBlcihhLHRoaXMuaWlkLDAsZS5Xc0pzb25VdGlsLmNyZWF0ZU1lc3NhZ2VCeWlkKCExLCEwLGUud3NfbXNnX3R5cGVfdC5yZXEsdGhpcy5paWQsMCx0aGlzLm9pZCkpfTthLnByb3RvdHlwZS5pc2Rlc3Ryb3llZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnByb3h5c3RhdGU9PXYuRGVzdHJveWVkfTthLnByb3RvdHlwZS5vbkNvbm5lY3RlZD1cclxuZnVuY3Rpb24oKXtmb3IoO3RoaXMuZGVmZXJyZWRBY3Rpb25zJiYwPHRoaXMuZGVmZXJyZWRBY3Rpb25zLmxlbmd0aDspdGhpcy5kZWZlcnJlZEFjdGlvbnMuc2hpZnQoKS5wb3N0KHRoaXMucHJveHlzdGF0ZT09di5Db25maWd1cmVkKX07YS5wcm90b3R5cGUuaXNQc2V1ZG89ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlPT10LlBzZXVkb307YS5wcm90b3R5cGUuY2hlY2tTdGF0ZT1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXM7MD49YT8obi5sb2dnZXIubG9nKFwiUHJveHlPYmplY3QuY2hlY2tTdGF0ZSgpIHRpbWVvdXQgd2FpdGluZyBmb3IgY29ubmVjdGlvbiByZXNwb25zZSEgZmFpbGVkLiAoaWlkOiBcIitjLmlpZCtcIiBvaWQ6IFwiK2Mub2lkK1wiKVwiKSxjLm9uQ29ubmVjdGVkKCkpOnNldFRpbWVvdXQoZnVuY3Rpb24oKXtpZihjLnByb3h5c3RhdGU9PXYuQ29uZmlndXJlZCljLm9uQ29ubmVjdGVkKCk7ZWxzZSBpZihjLnByb3h5c3RhdGU9PXYuRXJyb3IpYy5vbkNvbm5lY3RlZCgpO1xyXG5lbHNlIGlmKGMucHJveHlzdGF0ZT09di5EZXN0cm95ZWQpYy5vbkNvbm5lY3RlZCgpO2Vsc2Ugbi5sb2dnZXIubG9nKCdQcm94eU9iamVjdC5jaGVja1N0YXRlKCk6IGNvdW50PSBcIicrYSsnXCIuIChpaWQ6ICcrYy5paWQrXCIgb2lkOiBcIitjLm9pZCtcIilcIiksYy5jaGVja1N0YXRlKC0tYSxiKX0sYil9O2EucHJvdG90eXBlLndhaXRVbnRpbENvbm5lY3RlZD1mdW5jdGlvbihhKXt2YXIgYj10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihjLGQpe2I/KG4ubG9nZ2VyLnRyYWNlKFwiUHJveHlPYmplY3Qud2FpdFVudGlsQ29ubmVjdGVkKCk6IHJlYWR5U3RhdGU9XCIrYi5wcm94eXN0YXRlK1wiLiAoaWlkOiBcIitiLmlpZCtcIiBvaWQ6IFwiK2Iub2lkK1wiKVwiKSxiLnByb3h5c3RhdGU9PXYuRGVzdHJveWVkPyhiLm9uQ29ubmVjdGVkKCksbi5sb2dnZXIudHJhY2UoXCJyZWplY3RpbmcgYWxyZWFkeSBkZXN0cm95ZWQgT2JqZWN0OlwiK2IudXNlcl9mcmllbmRseV9pZCgpKSxkKFwiT2JqZWN0IGFscmVhZHkgZGVzdHJveWVkIDpcIitcclxuYi51c2VyX2ZyaWVuZGx5X2lkKCkpKTpiLnByb3h5c3RhdGU9PXYuQ29uZmlndXJlZD8oYi5vbkNvbm5lY3RlZCgpLGMoKSk6Yi5wcm94eXN0YXRlPT12LkVycm9yPyhuLmxvZ2dlci50cmFjZShcIlByb3h5T2JqZWN0LndhaXRVbnRpbENvbm5lY3RlZCgpOiByZWFkeVN0YXRlPVwiK2IucHJveHlzdGF0ZStcIi4gKGlpZDogXCIrYi5paWQrXCIgb2lkOiBcIitiLm9pZCtcIilcIiksYi5vbkNvbm5lY3RlZCgpLGQoKSk6KG4ubG9nZ2VyLmxvZygnUHJveHlPYmplY3Qud2FpdFVudGlsQ29ubmVjdGVkKCk6IGRlZmVycmluZyBhY3Rpb24gXCInK2ErJ1wiLiAoaWlkOiAnK2IuaWlkK1wiIG9pZDogXCIrYi5vaWQrXCIpXCIpLGIuZGVmZXJyZWRBY3Rpb25zLnB1c2gobmV3IGwoYyxkLGEpKSxiLmNoZWNrU3RhdGUoMTUsMUUzKSkpOmQoXCJJbnZhbGlkIE9iamVjdFwiKX0pfTthLnByb3RvdHlwZS5yZW1vdGVJbnZva2U9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9W10sZD0yO2Q8YXJndW1lbnRzLmxlbmd0aDtkKyspY1tkLVxyXG4yXT1hcmd1bWVudHNbZF07aWYodGhpcy5wcm94eXN0YXRlPT12LkRlc3Ryb3llZClyZXR1cm4gbi5sb2dnZXIudHJhY2UoXCJyZWplY3RpbmcgYWxyZWFkeSBkZXN0cm95ZWQgT2JqZWN0OlwiK3RoaXMudXNlcl9mcmllbmRseV9pZCgpKSxQcm9taXNlLnJlamVjdChcIkNhbm5vdCBpbnZva2UgZGVzdHJveWVkIG9iamVjdCA6XCIrdGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkpO2lmKHRoaXMucHJveHlzdGF0ZT09di5FcnJvcilyZXR1cm4gbi5sb2dnZXIudHJhY2UoXCJyZWplY3RpbmcgYWxyZWFkeSBlcnJvciBzdGF0ZSBPYmplY3Q6XCIrdGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkpLFByb21pc2UucmVqZWN0KFwiQ2Fubm90IGludm9rZSBvYmplY3QgaW4gRXJyb3Igc3RhdGU6XCIrdGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkpO2Q9cC5XZWJycGNDbGFzc0xpYkluZm9VdGlsLmdldE1ldGhvZEZlYXR1cmVCeWlkKHRoaXMuaWlkLGIpO3JldHVybiB0aGlzLmhkeG1zLldTU2VuZE9iamVjdFdyYXBwZXIoZCxcclxudGhpcy5paWQsYixlLldzSnNvblV0aWwuY3JlYXRlTWVzc2FnZUJ5aWQuYXBwbHkoZS5Xc0pzb25VdGlsLFthLCExLGUud3NfbXNnX3R5cGVfdC5yZXEsdGhpcy5paWQsYix0aGlzLm9pZF0uY29uY2F0KGMpKSl9O2EucHJvdG90eXBlLmxvZ1JlbW90ZUludm9rZUVycm9yPWZ1bmN0aW9uKGEsYil7dmFyIGM9YTtjP24ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStiK1wiIHdpdGggZXJyb3I6IFwiK2MubWVzc2FnZSk6dGhpcy5wYXJhbTA/KG4ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStiK1wiIHdpdGggZXJyb3I6IFwiK3RoaXMucGFyYW0wKGEpKSxjPW5ldyBET01FeGNlcHRpb24oYitcIiB3aXRoIGVycm9yOiBcIit0aGlzLnBhcmFtMChhKSx0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKSkpOihuLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrYiksYz1uZXcgRE9NRXhjZXB0aW9uKGIsdGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkpKTtyZXR1cm4gY307XHJcbmEucHJvdG90eXBlLnJlZ2lzdGVyQ2FsbGJhY2tzPWZ1bmN0aW9uKGIsYyxkKXt0aGlzLnVucmVnaXN0ZXJDYWxsYmFja3MoZCk7dmFyIGc9YS5uZXh0Y2JpZCsrLHQ9bmV3IGsoZyxjLGIpO2N8fChifHx0aGlzLmNicy5zZXQoZCxnKSx0aGlzLmhkeG1zLnJlZ2lzdGVySGFuZGxlcih0aGlzLmlpZCx0aGlzLm9pZCx0KSk7cmV0dXJuIHR9O2EucHJvdG90eXBlLnVucmVnaXN0ZXJDYWxsYmFja3M9ZnVuY3Rpb24oYSl7dGhpcy5jYnMuaGFzKGEpPyh0aGlzLmhkeG1zLnVucmVnaXN0ZXJIYW5kbGVyKHRoaXMuaWlkLHRoaXMub2lkLHRoaXMuY2JzLmdldChhKSksdGhpcy5jYnNbXCJkZWxldGVcIl0oYSkpOm4ubG9nZ2VyLnRyYWNlKHRoaXMuY2JzKX07YS5wcm90b3R5cGUub2JqZWN0X2lkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub2lkfTthLnByb3RvdHlwZS5wYXJhbTA9ZnVuY3Rpb24oYSl7dmFyIGI9e307YSYmYS5wYXJhbXMmJihiPWEucGFyYW1zWzBdKTtyZXR1cm4gYn07YS5wcm90b3R5cGUuaXNOdWxsQ2FsbGJhY2s9XHJcbmZ1bmN0aW9uKGEpe3JldHVybiB2b2lkIDA9PWF8fG51bGw9PWF9O2EucHJvdG90eXBlLnVzZXJfZnJpZW5kbHlfaWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5uYW1lK1wiW1wiK3RoaXMub2lkK1wiXVwifTthLnByb3RvdHlwZS5pc1JlZGlyZWN0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oZHhtcy5pc1JlZGlyZWN0ZWQoKX07YS5wcm90b3R5cGUuaXNWYWxpZD1mdW5jdGlvbigpe3JldHVybiEodGhpcy5wcm94eXN0YXRlPT09di5FcnJvcnx8dGhpcy5wcm94eXN0YXRlPT09di5EZXN0cm95ZWQpfTthLnByb3RvdHlwZS5yZWdpc3RlclN0YXRlQ2hhbmdlTm90aWZpY2F0aW9uPWZ1bmN0aW9uKGEpe3RoaXMuaGR4bXMucmVnaXN0ZXJTdGF0ZUNoYW5nZU5vdGlmaWNhdGlvbihhKX07YS5wcm90b3R5cGUudW5yZWdpc3RlclN0YXRlQ2hhbmdlTm90aWZpY2F0aW9uPWZ1bmN0aW9uKGEpe3RoaXMuaGR4bXMudW5yZWdpc3RlclN0YXRlQ2hhbmdlTm90aWZpY2F0aW9uKGEpfTtcclxuYS5uZXh0SWQ9MDthLm5leHRjYmlkPTA7cmV0dXJuIGF9KCk7YS5Qcm94eU9iamVjdD1ifSwxNDQ6ZnVuY3Rpb24oYixhLGMpe2Z1bmN0aW9uIGQoYSl7Zm9yKHZhciBiPVtdLGM9MDtjPGEubGVuZ3RoO2MrKyliLnB1c2goe29pZDphW2NdLm9iamVjdF9pZCgpfSk7cmV0dXJuIGJ9dmFyIG49dGhpcyYmdGhpcy5fX2V4dGVuZHN8fGZ1bmN0aW9uKCl7dmFyIGE9ZnVuY3Rpb24oYixjKXthPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihhLGIpe2EuX19wcm90b19fPWJ9fHxmdW5jdGlvbihhLGIpe2Zvcih2YXIgYyBpbiBiKWIuaGFzT3duUHJvcGVydHkoYykmJihhW2NdPWJbY10pfTtyZXR1cm4gYShiLGMpfTtyZXR1cm4gZnVuY3Rpb24oYixjKXtmdW5jdGlvbiBkKCl7dGhpcy5jb25zdHJ1Y3Rvcj1ifWEoYixjKTtiLnByb3RvdHlwZT1udWxsPT09Yz9PYmplY3QuY3JlYXRlKGMpOihkLnByb3RvdHlwZT1jLnByb3RvdHlwZSxcclxubmV3IGQpfX0oKSxlPXRoaXMmJnRoaXMuX19hd2FpdGVyfHxmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gbmV3IChjfHwoYz1Qcm9taXNlKSkoZnVuY3Rpb24oZix5KXtmdW5jdGlvbiBnKGEpe3RyeXt0KGQubmV4dChhKSl9Y2F0Y2goYil7eShiKX19ZnVuY3Rpb24gaChhKXt0cnl7dChkW1widGhyb3dcIl0oYSkpfWNhdGNoKGIpe3koYil9fWZ1bmN0aW9uIHQoYSl7YS5kb25lP2YoYS52YWx1ZSk6KG5ldyBjKGZ1bmN0aW9uKGIpe2IoYS52YWx1ZSl9KSkudGhlbihnLGgpfXQoKGQ9ZC5hcHBseShhLGJ8fFtdKSkubmV4dCgpKX0pfSxtPXRoaXMmJnRoaXMuX19nZW5lcmF0b3J8fGZ1bmN0aW9uKGEsYil7ZnVuY3Rpb24gYyhhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGQoW2EsYl0pfX1mdW5jdGlvbiBkKGMpe2lmKHkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7Zm9yKDtmOyl0cnl7aWYoeT0xLGcmJihoPWNbMF0mMj9nW1wicmV0dXJuXCJdOlxyXG5jWzBdP2dbXCJ0aHJvd1wiXXx8KChoPWdbXCJyZXR1cm5cIl0pJiZoLmNhbGwoZyksMCk6Zy5uZXh0KSYmIShoPWguY2FsbChnLGNbMV0pKS5kb25lKXJldHVybiBoO2lmKGc9MCxoKWM9W2NbMF0mMixoLnZhbHVlXTtzd2l0Y2goY1swXSl7Y2FzZSAwOmNhc2UgMTpoPWM7YnJlYWs7Y2FzZSA0OnJldHVybiBmLmxhYmVsKysse3ZhbHVlOmNbMV0sZG9uZTohMX07Y2FzZSA1OmYubGFiZWwrKztnPWNbMV07Yz1bMF07Y29udGludWU7Y2FzZSA3OmM9Zi5vcHMucG9wKCk7Zi50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoIShoPWYudHJ5cyxoPTA8aC5sZW5ndGgmJmhbaC5sZW5ndGgtMV0pJiYoNj09PWNbMF18fDI9PT1jWzBdKSl7Zj0wO2NvbnRpbnVlfWlmKDM9PT1jWzBdJiYoIWh8fGNbMV0+aFswXSYmY1sxXTxoWzNdKSlmLmxhYmVsPWNbMV07ZWxzZSBpZig2PT09Y1swXSYmZi5sYWJlbDxoWzFdKWYubGFiZWw9aFsxXSxoPWM7ZWxzZSBpZihoJiZmLmxhYmVsPGhbMl0pZi5sYWJlbD1cclxuaFsyXSxmLm9wcy5wdXNoKGMpO2Vsc2V7aFsyXSYmZi5vcHMucG9wKCk7Zi50cnlzLnBvcCgpO2NvbnRpbnVlfX1jPWIuY2FsbChhLGYpfWNhdGNoKHEpe2M9WzYscV0sZz0wfWZpbmFsbHl7eT1oPTB9aWYoY1swXSY1KXRocm93IGNbMV07cmV0dXJue3ZhbHVlOmNbMF0/Y1sxXTp2b2lkIDAsZG9uZTohMH19dmFyIGY9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKGhbMF0mMSl0aHJvdyBoWzFdO3JldHVybiBoWzFdfSx0cnlzOltdLG9wczpbXX0seSxnLGgsdDskanNjb21wLmluaXRTeW1ib2woKTskanNjb21wLmluaXRTeW1ib2woKTskanNjb21wLmluaXRTeW1ib2xJdGVyYXRvcigpO3JldHVybiB0PXtuZXh0OmMoMCksXCJ0aHJvd1wiOmMoMSksXCJyZXR1cm5cIjpjKDIpfSxcImZ1bmN0aW9uXCI9PT10eXBlb2YgU3ltYm9sJiYodFtTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSx0fTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTtcclxudmFyIHA9Yyg1NTApLGw9Yyg2NTgpLGc9Yyg4NTEpLGs9Yyg5NDYpLHY9YygzOTQpLHQ7YS5lbnVtZXJhdGVkZGVjaWNlcz10O3ZhciB6PWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYil7dGhpcy50eXBlPWE7dGhpcy50YXJnZXQ9Yn19KCksdT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt0aGlzLmlzX2xvY2FsX2Nsb25lPSExO3RoaXMuY2xvbmVfaWQ9dGhpcy5jbG9uZV9jb3VudD0wfWEucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7dGhpcy5jbG9uZV9jb3VudCsrO3ZhciBiPW5ldyBhO2IuaXNfbG9jYWxfY2xvbmU9ITA7Yi5jbG9uZV9pZD10aGlzLmNsb25lX2NvdW50O3JldHVybiBifTthLnByb3RvdHlwZS5zeW5jaHJvbml6ZT1mdW5jdGlvbihhKXtyZXR1cm4gZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24oKXtyZXR1cm4gbSh0aGlzLGZ1bmN0aW9uKGIpe3JldHVybiB0aGlzLmlzX2xvY2FsX2Nsb25lP1syLGEuYXN5bmNDbG9uZSgpXTpbMixhXX0pfSl9O3JldHVybiBhfSgpLFxyXG5mPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYyxkKXt2YXIgZj1hLmNhbGwodGhpcyxjLHAuY2xhc3NfaWRfdC5NZWRpYVN0cmVhbVRyYWNrLGQsbC5Qcm94eU1vZGUuUmVtb3RlKXx8dGhpcztmLnJlZkNvdW50Xz0wO2YucmVmQ291bnRfKys7Zi5jbG9uZV9zdGF0ZT1uZXcgdTtyZXR1cm4gZn1uKGIsYSk7Yi5wcm90b3R5cGUuZHVtcEluZm89ZnVuY3Rpb24oKXtnLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZHVtcEluZm8oKSBbaWQ9XCIrdGhpcy5pZCtcIl0ga2luZD1cIit0aGlzLmtpbmQrXCIgbGFiZWw9XCIrdGhpcy5sYWJlbCtcIiByZWZjb3VudD1cIit0aGlzLnJlZmNvdW50KX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwicmVmY291bnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVmQ291bnRffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmFkZFJlZj1mdW5jdGlvbigpe3RoaXMucmVmQ291bnRfKys7XHJcbmcubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5hZGRSZWYoKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1wiXSByZWZjb3VudD1cIit0aGlzLnJlZkNvdW50Xyl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9uZW5kZWRcIix7Z2V0OmZ1bmN0aW9uKCl7Zy5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9vbmVuZGVkKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7cmV0dXJuIHRoaXMub25lbmRlZF99LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25lbmRlZCgpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO3RoaXMub25lbmRlZF89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIk1lZGlhU3RyZWFtVHJhY2sub25lbmRlZFwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLFxyXG5wLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3Qub25lbmRlZCk7Yy50aGVuKGZ1bmN0aW9uKGEpe2cubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIm9uZW5kZWQgZXZlbnQgcmVjZWl2ZWQhISFcIik7YT1uZXcgeihcImVuZGVkXCIsYik7Yi5yZWFkeVN0YXRlXz1cImVuZGVkXCI7Yi5vbmVuZGVkXyhhKX0pO3JldHVybiBiLnJlbW90ZUludm9rZSghMCxwLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3Qub25lbmRlZCxjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIub25lbmRlZCBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25tdXRlXCIse2dldDpmdW5jdGlvbigpe2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfb25tdXRlKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7cmV0dXJuIHRoaXMub25tdXRlX30sXHJcbnNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25tdXRlKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7dGhpcy5vbm11dGVfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJNZWRpYVN0cmVhbVRyYWNrLm9ubXV0ZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLHAubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5vbm11dGUpO2MudGhlbihmdW5jdGlvbihhKXtnLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCJvbm11dGUgZXZlbnQgcmVjZWl2ZWQhISFcIik7YT1uZXcgeihcIm11dGVcIixiKTtiLm11dGVkPSEwO2Iub25tdXRlXyhhKX0pO3JldHVybiBiLnJlbW90ZUludm9rZSghMCxwLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3Qub25tdXRlLGMuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcclxuXCIub25tdXRlIGZhaWxlZCFcIil9KX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbnVubXV0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtnLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X29udW5tdXRlKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7cmV0dXJuIHRoaXMub251bm11dGVffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztnLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29udW5tdXRlKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7dGhpcy5vbnVubXV0ZV89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIk1lZGlhU3RyZWFtVHJhY2sub251bm11dGVcIikudGhlbihmdW5jdGlvbigpe3ZhciBjPWIucmVnaXN0ZXJDYWxsYmFja3MoITEsYi5pc051bGxDYWxsYmFjayhhKSxwLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3Qub251bm11dGUpO1xyXG5jLnRoZW4oZnVuY3Rpb24oYSl7Zy5sb2dnZXIubG9nKFwib251bm11dGUgZXZlbnQgcmVjZWl2ZWQhISFcIik7YT1uZXcgeihcInVubXV0ZVwiLGIpO2IubXV0ZWQ9ITE7Yi5vbnVubXV0ZV8oYSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAscC5tZXRob2RfaWRfTWVkaWFTdHJlYW1UcmFja190Lm9udW5tdXRlLGMuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5vbnVubXV0ZSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25zdG9wXCIse3NldDpmdW5jdGlvbihhKXt0aGlzLm9uc3RvcF89YX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJlbmFibGVkXCIse2dldDpmdW5jdGlvbigpe2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfZW5hYmxlZCgpIGNhbGxlZC4gW2lkPVwiK1xyXG50aGlzLmlkK1wiLCB2YWx1ZT1cIit0aGlzLmVuYWJsZWRfK1wiXVwiKTtyZXR1cm4gdGhpcy5lbmFibGVkX30sc2V0OmZ1bmN0aW9uKGEpe2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfZW5hYmxlZCgpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCIsIHZhbHVlPVwiK2ErXCJdXCIpO3RoaXMuZW5hYmxlZF89YTt0aGlzLnJlbW90ZUludm9rZSghMCxwLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3QuZW5hYmxlZCxhKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJyZWFkeVN0YXRlXCIse2dldDpmdW5jdGlvbigpe2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfcmVhZHlTdGF0ZSgpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO3JldHVybiB0aGlzLnJlYWR5U3RhdGVffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmFzeW5jQ2xvbmU9XHJcbmZ1bmN0aW9uKCl7cmV0dXJuIGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIGEsYyxkO3JldHVybiBtKHRoaXMsZnVuY3Rpb24oZil7c3dpdGNoKGYubGFiZWwpe2Nhc2UgMDpyZXR1cm5bNCx0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIlJlbW90ZU1lZGlhVHJhY2suYXN5bmNDbG9uZVwiKV07Y2FzZSAxOnJldHVybiBmLnNlbnQoKSxbNCx0aGlzLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3QuY2xvbmUsW10pXTtjYXNlIDI6cmV0dXJuIGE9Zi5zZW50KCksYz10aGlzLnBhcmFtMChhKSxkPW5ldyBiKHRoaXMsYy5vaWQpLFsyLGQuc3luY0JhcnJpZXIoKV19fSl9KX07Yi5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtnLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY2xvbmUoKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1wiXVwiKTt2YXIgYT10aGlzLmNsb25lX3N0YXRlLmNsb25lKCksYz1uZXcgYih0aGlzLHRoaXMub2JqZWN0X2lkKCkpO1xyXG5jLmlkPXRoaXMuaWQrXCIuXCIrYS5jbG9uZV9pZC50b1N0cmluZygpO2MubGFiZWw9dGhpcy5sYWJlbDtjLmtpbmQ9dGhpcy5raW5kO2MuZW5hYmxlZF89dGhpcy5lbmFibGVkXztjLm11dGVkPXRoaXMubXV0ZWQ7Yy5yZWFkeVN0YXRlXz10aGlzLnJlYWR5U3RhdGVfO2MudHJhY2tTZXR0aW5nc189dGhpcy50cmFja1NldHRpbmdzXztjLmNsb25lX3N0YXRlPWE7Yy5jb25zdHJhaW50c189dGhpcy5jb25zdHJhaW50c187Yy5jYXBhYmlsaXRpZXNfPXRoaXMuY2FwYWJpbGl0aWVzXztyZXR1cm4gY307Yi5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbigpe3ZhciBhPXRoaXM7Zy5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnN0b3AoKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1wiXSByZWZjb3VudD1cIit0aGlzLnJlZkNvdW50Xyk7dGhpcy5yZWFkeVN0YXRlXz1cImVuZGVkXCI7aWYoMDx0aGlzLnJlZkNvdW50XyYmKHRoaXMucmVmQ291bnRfLS0sMD09PXRoaXMucmVmQ291bnRfJiZcclxuKGcubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zdG9wKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl0gcmVtb3RlIGludm9raW5nLi4uXCIpLHRoaXMucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5zdG9wKVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2EubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5zdG9wIGZhaWxlZCFcIil9KSxcInZpZGVvXCI9PXRoaXMua2luZCYmXCJyZW1vdGVhcHAtdHJhY2tcIj09dGhpcy5sYWJlbCYmay5nZXRSZWRpcmVjdG9yKCkuc3RvcEFwcHNoYXJlKCksbnVsbCE9PXRoaXMub25zdG9wXyYmdm9pZCAwIT10aGlzLm9uc3RvcF8pKSl0aGlzLm9uc3RvcF8oKX07Yi5wcm90b3R5cGUuZ2V0Q2FwYWJpbGl0aWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FwYWJpbGl0aWVzX307Yi5wcm90b3R5cGUuZ2V0Q29uc3RyYWludHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJhaW50c199O2IucHJvdG90eXBlLmdldFNldHRpbmdzPVxyXG5mdW5jdGlvbigpe3JldHVyblwiYXVkaW9cIj09dGhpcy5raW5kP2Z1bmN0aW9uKGEpe3JldHVybntkZXZpY2VJZDphLmRldmljZUlkLGVjaG9DYW5jZWxsYXRpb246YS5lY2hvQ2FuY2VsbGF0aW9ufX0odGhpcy50cmFja1NldHRpbmdzXyk6ZnVuY3Rpb24oYSl7cmV0dXJue2FzcGVjdFJhdGlvOmEuYXNwZWN0UmF0aW8sZGV2aWNlSWQ6YS5kZXZpY2VJZCxmcmFtZVJhdGU6YS5mcmFtZVJhdGUsaGVpZ2h0OmEuaGVpZ2h0LHdpZHRoOmEud2lkdGh9fSh0aGlzLnRyYWNrU2V0dGluZ3NfKX07Yi5wcm90b3R5cGUuYXBwbHlDb25zdHJhaW50cz1mdW5jdGlvbihhKXt2YXIgYj10aGlzO2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5hcHBseUNvbnN0cmFpbnRzKCkgY2FsbGVkLlwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxkKXtiLndhaXRVbnRpbENvbm5lY3RlZChcIk1lZGlhU3RyZWFtVHJhY2suYXBwbHlDb25zdHJhaW50c1wiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFtiLnJlbW90ZUludm9rZSghMSxcclxucC5tZXRob2RfaWRfTWVkaWFTdHJlYW1UcmFja190LmFwcGx5Q29uc3RyYWludHMsYSksYi5zeW5jQmFycmllcigpXSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7ZCh7bmFtZTpcIk92ZXJjb25zdHJhaW5lZEVycm9yXCIsbWVzc2FnZTpcIkZhaWxlZCB0byBhcHBseSBjb25zdHJhaW50cy5cIn0pfSkudGhlbihmdW5jdGlvbigpe2IuY29uc3RyYWludHNfPWE7cmV0dXJuIGIucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5nZXRDb25zdHJhaW50cyl9KS50aGVuKGZ1bmN0aW9uKGEpe2IuY29uc3RyYWludHNfPWIucGFyYW0wKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc3luY0JhcnJpZXIoKSByZW1vdGUgY2xpZW50IGRvZXMgbm90IHN1cHBvcnQgZ2V0Q29uc3RyYWludHMgbWV0aG9kLiBJZ25vcmUgaXRcIil9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGMoKX0pfSl9O2IuY29udmVydFJlYWR5U3RhdGU9ZnVuY3Rpb24oYSl7cmV0dXJuIDA9PVxyXG5hP1wibGl2ZVwiOlwiZW5kZWRcIn07Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllcigpIGNhbGxlZC5cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsZCl7YS53YWl0VW50aWxDb25uZWN0ZWQoXCJNZWRpYVN0cmVhbVRyYWNrLnN5bmNCYXJyaWVyXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5hbGwoW2EucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5raW5kLFwiXCIpLGEucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5pZCxcIlwiKSxhLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3QubGFiZWwsXCJcIiksYS5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfTWVkaWFTdHJlYW1UcmFja190LmVuYWJsZWQsITEpLGEucmVtb3RlSW52b2tlKCExLFxyXG5wLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3QubXV0ZWQsITEpLGEucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5yZWFkeVN0YXRlLDApLGEucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5nZXRTZXR0aW5ncyksYS5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfTWVkaWFTdHJlYW1UcmFja190LmdldENhcGFiaWxpdGllcyldKX0pLnRoZW4oZnVuY3Rpb24oZCl7dmFyIGY9MDtkPWQubWFwKGZ1bmN0aW9uKGIpe3JldHVybiBhLnBhcmFtMChiKX0pO2Eua2luZD1kWzBdO2EuaWQ9ZFsxXTthLmxhYmVsPWRbMl07YS5lbmFibGVkXz1kWzNdO2EubXV0ZWQ9ZFs0XTtmPWRbNV07YS50cmFja1NldHRpbmdzXz1kWzZdO2EuY2FwYWJpbGl0aWVzXz1kWzddO2EucmVhZHlTdGF0ZV89Yi5jb252ZXJ0UmVhZHlTdGF0ZShmKTtjKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtiPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcclxuXCIuc3luY0JhcnJpZXIoKSBmYWlsZWQhXCIpO2QoYil9KX0pfTtyZXR1cm4gYn0obC5Qcm94eU9iamVjdCk7YS5SZW1vdGVNZWRpYVRyYWNrPWY7dmFyIEE9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oKXt9fSgpLHg9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjLGYsZyx0KXt2b2lkIDA9PT1nJiYoZz1sLlByb3h5TW9kZS5Mb2NhbCk7dm9pZCAwPT09dCYmKHQ9W10pO2M9YS5jYWxsKHRoaXMsYyxwLmNsYXNzX2lkX3QuTWVkaWFTdHJlYW0sZixnLG51bGwsZCh0KSl8fHRoaXM7Yy5jbG9uZV9zdGF0ZT1uZXcgdTtjLnRyYWNrc189dDtyZXR1cm4gY31uKGIsYSk7Yi5wcm90b3R5cGUuZHVtcEluZm89ZnVuY3Rpb24oKXtnLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZHVtcEluZm8oKSBbaWQ9XCIrdGhpcy5pZCtcIl0gYWN0aXZlPVwiK3RoaXMuYWN0aXZlXytcIiBudW0gdHJhY2tzPVwiK3RoaXMudHJhY2tzXy5sZW5ndGgpO2Zvcih2YXIgYT0wLGI9dGhpcy50cmFja3NfO2E8XHJcbmIubGVuZ3RoO2ErKyl7dmFyIGM9YlthXTtjJiZjLmR1bXBJbmZvKCl9fTtiLnByb3RvdHlwZS50b2dnbGVBdWRpbz1mdW5jdGlvbihhKXtnLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIudG9nZ2xlQXVkaW8oKSBjYWxsZWQ6IFwiK2EpO2Zvcih2YXIgYj0wLGM9dGhpcy5nZXRBdWRpb1RyYWNrcygpO2I8Yy5sZW5ndGg7YisrKWNbYl0uZW5hYmxlZD1hfTtiLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXt2YXIgYT1uZXcgQTthLmlkPXRoaXMuaWQ7YS5hY3RpdmU9dGhpcy5hY3RpdmVfO2Eub2lkPXRoaXMub2JqZWN0X2lkKCk7cmV0dXJuXCJSZW1vdGVTdHJlYW06XCIrSlNPTi5zdHJpbmdpZnkoYSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImFjdGl2ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtnLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0IGFjdGl2ZSgpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdIGFjdGl2ZT1cIit0aGlzLmFjdGl2ZV8pO1xyXG5yZXR1cm4gdGhpcy5hY3RpdmVffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmdldEF1ZGlvVHJhY2tzPWZ1bmN0aW9uKCl7Zy5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldEF1ZGlvVHJhY2tzKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMudHJhY2tzXztiPGMubGVuZ3RoO2IrKyl7dmFyIGQ9Y1tiXTtcImF1ZGlvXCI9PWQua2luZCYmYS5wdXNoKGQpfXJldHVybiBhfTtiLnByb3RvdHlwZS5nZXRWaWRlb1RyYWNrcz1mdW5jdGlvbigpe2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRWaWRlb1RyYWNrcygpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLnRyYWNrc187YjxjLmxlbmd0aDtiKyspe3ZhciBkPWNbYl07XCJ2aWRlb1wiPT1kLmtpbmQmJmEucHVzaChkKX1yZXR1cm4gYX07Yi5wcm90b3R5cGUuZ2V0VHJhY2tzPVxyXG5mdW5jdGlvbigpe2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRUcmFja3MoKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1wiXVwiKTtyZXR1cm4gdGhpcy50cmFja3NffTtiLnByb3RvdHlwZS5nZXRUcmFja0J5SWQ9ZnVuY3Rpb24oYSl7Zy5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFRyYWNrQnlJZCgpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO2Zvcih2YXIgYj0wLGM9dGhpcy50cmFja3NfO2I8Yy5sZW5ndGg7YisrKXt2YXIgZD1jW2JdO2lmKGQuaWQ9PWEpcmV0dXJuIGR9fTtiLnByb3RvdHlwZS5hZGRUcmFjaz1mdW5jdGlvbihhKXt2YXIgYj10aGlzO2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5hZGRUcmFjaygpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO3RoaXMudHJhY2tzXy5wdXNoKGEpO2EmJmEuZHVtcEluZm8oKTt2YXIgYz10aGlzO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiTWVkaWFTdHJlYW0uYWRkVHJhY2tcIikudGhlbihmdW5jdGlvbigpe2cubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuYWRkVHJhY2sgcmVtb3RlIGludm9raW5nXCIpO3JldHVybiBjLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9NZWRpYVN0cmVhbV90LmFkZFRyYWNrLHtvaWQ6YS5vYmplY3RfaWQoKX0pfSkudGhlbihmdW5jdGlvbigpe2cubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5hZGRUcmFjayBzdWNjZXNzXCIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuYWRkVHJhY2sgZmFpbGVkIVwiKX0pfTtiLnByb3RvdHlwZS5yZW1vdmVUcmFjaz1mdW5jdGlvbihhKXt2YXIgYj10aGlzO2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5yZW1vdmVUcmFjaygpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO3ZhciBjPXRoaXMudHJhY2tzXy5pbmRleE9mKGEpO3RoaXMudHJhY2tzXy5zcGxpY2UoYywxKTt2YXIgZD10aGlzO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiTWVkaWFTdHJlYW0ucmVtb3ZlVHJhY2tcIikudGhlbihmdW5jdGlvbigpe2cubG9nZ2VyLmxvZyhkLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIucmVtb3ZlVHJhY2sgcmVtb3RlIGludm9raW5nXCIpO3JldHVybiBkLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9NZWRpYVN0cmVhbV90LnJlbW92ZVRyYWNrLHtvaWQ6YS5vYmplY3RfaWQoKX0pfSkudGhlbihmdW5jdGlvbigpe2cubG9nZ2VyLmxvZyhkLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5yZW1vdmVUcmFjayBzdWNjZXNzXCIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIucmVtb3ZlVHJhY2sgZmFpbGVkIVwiKX0pfTtiLnByb3RvdHlwZS5hc3luY0Nsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIGEsYyxkO3JldHVybiBtKHRoaXMsZnVuY3Rpb24oZil7c3dpdGNoKGYubGFiZWwpe2Nhc2UgMDpyZXR1cm4gZy5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmFzeW5jQ2xvbmUoKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1wiXVwiKSxbNCx0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcImFzeW5jQ2xvbmVcIildO1xyXG5jYXNlIDE6cmV0dXJuIGYuc2VudCgpLFs0LHRoaXMucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX01lZGlhU3RyZWFtX3QuY2xvbmUsW10pXTtjYXNlIDI6cmV0dXJuIGE9Zi5zZW50KCksY29uc29sZS5sb2coYSksYz10aGlzLnBhcmFtMChhKSxkPW5ldyBiKHRoaXMsYy5vaWQsbC5Qcm94eU1vZGUuUmVtb3RlKSxbMixkLnN5bmNCYXJyaWVyKCldfX0pfSl9O2IucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7Zy5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNsb25lKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7dmFyIGE9dGhpcy5jbG9uZV9zdGF0ZS5jbG9uZSgpLGM9bmV3IGIodGhpcyx0aGlzLm9iamVjdF9pZCgpLGwuUHJveHlNb2RlLlJlbW90ZSk7Yy5pZD10aGlzLmlkK1wiLlwiK2EuY2xvbmVfaWQudG9TdHJpbmcoKTt0aGlzLnRyYWNrc18uZm9yRWFjaChmdW5jdGlvbihhKXthLmFkZFJlZigpfSk7Yy50cmFja3NfPXRoaXMudHJhY2tzXztjLmNsb25lX3N0YXRlPVxyXG5hO3JldHVybiBjfTtiLnByb3RvdHlwZS5zeW5jQmFycmllcj1mdW5jdGlvbigpe3ZhciBhPXRoaXM7Zy5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGIsYyl7YS53YWl0VW50aWxDb25uZWN0ZWQoXCJNZWRpYVN0cmVhbS5zeW5jQmFycmllclwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFthLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9NZWRpYVN0cmVhbV90LmlkLFwiXCIpLGEucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX01lZGlhU3RyZWFtX3QuYWN0aXZlLCExKSxhLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9NZWRpYVN0cmVhbV90LmdldFRyYWNrcyxbXSldKX0pLnRoZW4oZnVuY3Rpb24oYil7Zy5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyKCkgcmVtb3RlIHN1Y2Nlc3NcIik7XHJcbmI9Yi5tYXAoZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyYW0wKGIpfSk7YS5pZD1iWzBdO2EuYWN0aXZlXz1iWzFdO2I9YlsyXTtmb3IodmFyIGM9W10saD1mdW5jdGlvbihiKXt2YXIgaD1hLnRyYWNrc18uZmluZChmdW5jdGlvbihhKXtyZXR1cm4gYS5vYmplY3RfaWQoKT09PWIub2lkfSk7dm9pZCAwPT09aCYmKGcubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIiBhZGRpbmcgYSBSZW1vdGVNZWRpYVRyYWNrIHdpdGggb2lkOlwiK2Iub2lkKSxoPW5ldyBmKGEsYi5vaWQpKTtjLnB1c2goaC5zeW5jQmFycmllcigpKX0sZD0wO2Q8Yi5sZW5ndGg7ZCsrKWgoYltkXSk7cmV0dXJuIFByb21pc2UuYWxsKGMpfSkudGhlbihmdW5jdGlvbihjKXthLnRyYWNrc189W107Yy5mb3JFYWNoKGZ1bmN0aW9uKGIpe2Iub25zdG9wPWZ1bmN0aW9uKCl7dmFyIGI9ITA7YS50cmFja3NfLmZvckVhY2goZnVuY3Rpb24oYSl7XCJlbmRlZFwiIT1hLnJlYWR5U3RhdGUmJihiPSExKX0pO2ImJmEucmVsZWFzZSgpfTtcclxuYS50cmFja3NfLnB1c2goYil9KTtiKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuc3luY0JhcnJpZXIgZmFpbGVkIVwiKTtjKCl9KX0pfTtyZXR1cm4gYn0obC5Qcm94eU9iamVjdCk7YS5SZW1vdGVTdHJlYW09eDtiPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYyxkKXtyZXR1cm4gYS5jYWxsKHRoaXMsYyxwLmNsYXNzX2lkX3QuTWVkaWFTdHJlYW1FdmVudCxkLGwuUHJveHlNb2RlLlJlbW90ZSl8fHRoaXN9bihiLGEpO2IucHJvdG90eXBlLnN5bmNCYXJyaWVyPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztnLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2Eud2FpdFVudGlsQ29ubmVjdGVkKFwiTWVkaWFTdHJlYW1FdmVudC5zeW5jQmFycmllclwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGEucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX01lZGlhU3RyZWFtRXZlbnRfdC5zdHJlYW0sXHJcbntvaWQ6MH0pfSkudGhlbihmdW5jdGlvbihiKXtyZXR1cm4obmV3IHgoYSxiLnBhcmFtc1swXS5vaWQsbC5Qcm94eU1vZGUuUmVtb3RlKSkuc3luY0JhcnJpZXIoKX0pLnRoZW4oZnVuY3Rpb24oYyl7YS5zdHJlYW09YztiKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtiPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5zeW5jQmFycmllcigpIGZhaWxlZCFcIik7YyhiKX0pfSl9O3JldHVybiBifShsLlByb3h5T2JqZWN0KTthLlJlbW90ZVN0cmVhbUV2ZW50PWI7dmFyIEQ9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjKXtyZXR1cm4gYS5jYWxsKHRoaXMsbnVsbCxwLmNsYXNzX2lkX3QuTWVkaWFEZXZpY2VJbmZvLGMsbC5Qcm94eU1vZGUuUmVtb3RlKXx8dGhpc31uKGIsYSk7Yi5wcm90b3R5cGUuY29udmVydEtpbmQ9ZnVuY3Rpb24oYSl7cmV0dXJuIDA9PWE/XCJhdWRpb2lucHV0XCI6MT09YT9cImF1ZGlvb3V0cHV0XCI6XCJ2aWRlb2lucHV0XCJ9O2IucHJvdG90eXBlLnN5bmNCYXJyaWVyPWZ1bmN0aW9uKCl7dmFyIGE9XHJcbnRoaXM7Zy5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyKCkgY2FsbGVkLlwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixjKXthLndhaXRVbnRpbENvbm5lY3RlZChcIlJlbW90ZURldmljZUluZm8uc3luY0JhcnJpZXJcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfTWVkaWFEZXZpY2VJbmZvX3QuZGV2aWNlSWQsXCJcIiksYS5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfTWVkaWFEZXZpY2VJbmZvX3Qua2luZCwwKSxhLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9NZWRpYURldmljZUluZm9fdC5sYWJlbCxcIlwiKSxhLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9NZWRpYURldmljZUluZm9fdC5ncm91cElkLFwiXCIpXSl9KS50aGVuKGZ1bmN0aW9uKGMpe2Eua2luZD1hLmNvbnZlcnRLaW5kKGEucGFyYW0wKGMuc3BsaWNlKDEsMSlbMF0pKTtjPWMubWFwKGZ1bmN0aW9uKGIpe3JldHVybiBhLnBhcmFtMChiKX0pO1xyXG5hLmRldmljZUlkPWNbMF07YS5sYWJlbD1jWzFdO2EuZ3JvdXBJZD1jWzJdO2IoYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2I9YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLnN5bmNCYXJyaWVyKCkgZmFpbGVkIVwiKTtjKGIpfSl9KX07cmV0dXJuIGJ9KGwuUHJveHlPYmplY3QpO2EuUmVtb3RlRGV2aWNlSW5mbz1EO2I9ZnVuY3Rpb24oYil7ZnVuY3Rpb24gYygpe3ZhciBhPWIuY2FsbCh0aGlzLG51bGwscC5jbGFzc19pZF90Lk1lZGlhRGV2aWNlcywwLGwuUHJveHlNb2RlLkxvY2FsLGZ1bmN0aW9uKCl7YS5zZXREZXZpY2VDaGFuZ2VDYWxsYmFjaygpfSl8fHRoaXM7YS5kZXZpY2VzXz1bXTthLnBlbmRpbmdFbnVtZXJhdGVEZXZpY2VfPVtdO3JldHVybiBhfW4oYyxiKTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYy5wcm90b3R5cGUsXCJwYW5lbGlkXCIse3NldDpmdW5jdGlvbihhKXt0aGlzLnBhbmVsaWRfPWF9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7Yy5wcm90b3R5cGUuY2xlYXJQYW5lbElkPVxyXG5mdW5jdGlvbigpe3RoaXMucGFuZWxpZF89LTF9O2MucHJvdG90eXBlLmVudW1lcmF0ZURldmljZXM9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3JldHVybiAwPHRoaXMuZGV2aWNlc18ubGVuZ3RoJiYwPT10aGlzLnBlbmRpbmdFbnVtZXJhdGVEZXZpY2VfLmxlbmd0aD9uZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2cubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5lbnVtZXJhdGVEZXZpY2VzOiByZXR1cm5pbmcgY2FjaGVkIGRldmljZXMgd2l0aCBpZHMgW1wiK2EuZGV2aWNlc18ubWFwKGZ1bmN0aW9uKGEpe3JldHVybiBhLm9iamVjdF9pZCgpfSkrXCJdXCIpO2IoYS5kZXZpY2VzXyl9KTp0aGlzLmVudW1lcmF0ZURldmljZXNQcml2YXRlKCExKX07Yy5wcm90b3R5cGUucG9zdEVudW1lcmF0ZURldmljZXNSZXN1bHQ9ZnVuY3Rpb24oKXtmb3IodmFyIGE9ITAsYj0wLGM9MCxkPXRoaXMucGVuZGluZ0VudW1lcmF0ZURldmljZV87YzxkLmxlbmd0aDtjKyspe3ZhciBmPWRbY107XHJcbmlmKDA9PWEmJlwiZW51bWVyYXRlRGV2aWNlc1ByaXZhdGUtcmVtb3RlXCI9PWYubmFtZSlicmVhaztmLnBvc3RXaXRoUmVzdWx0KCEwLHRoaXMuZGV2aWNlc18pO2IrKzthPSExfTA8YiYmdGhpcy5wZW5kaW5nRW51bWVyYXRlRGV2aWNlXy5zcGxpY2UoMCxiKX07Yy5wcm90b3R5cGUuZW51bWVyYXRlRGV2aWNlc1ByaXZhdGU9ZnVuY3Rpb24oYil7dmFyIGM9dGhpcztnLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZW51bWVyYXRlRGV2aWNlc1ByaXZhdGUoKSBjYWxsZWQuIHJlZnJlc2g6XCIrYitcIiBwZW5kaW5nOlwiK3RoaXMucGVuZGluZ0VudW1lcmF0ZURldmljZV8ubGVuZ3RoKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oZCxmKXsxPT1ifHwwPT1jLnBlbmRpbmdFbnVtZXJhdGVEZXZpY2VfLmxlbmd0aD8oYy5wZW5kaW5nRW51bWVyYXRlRGV2aWNlXy5wdXNoKG5ldyBsLmRlZmVycmVkX2FjdGlvbihkLGYsXCJlbnVtZXJhdGVEZXZpY2VzUHJpdmF0ZS1yZW1vdGVcIikpLFxyXG5jLndhaXRVbnRpbENvbm5lY3RlZChcIlJlbW90ZURldmljZXMuZW51bWVyYXRlRGV2aWNlc1ByaXZhdGVcIikudGhlbihmdW5jdGlvbigpe2cubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5lbnVtZXJhdGVEZXZpY2VzUHJpdmF0ZSgpIHJlbW90ZSBpbnZva2luZy4uLlwiKTtyZXR1cm4gYy5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfTWVkaWFEZXZpY2VzX3QuZW51bWVyYXRlRGV2aWNlcyxbXSl9KS50aGVuKGZ1bmN0aW9uKGEpe3ZhciBiPVtdO2EucGFyYW1zWzBdLmZvckVhY2goZnVuY3Rpb24oYSl7dmFyIGQ9Yy5kZXZpY2VzXy5maW5kKGZ1bmN0aW9uKGIpe3JldHVybiBiLm9iamVjdF9pZCgpPT09YS5vaWR9KTt2b2lkIDA9PT1kPyhkPW5ldyBEKGEub2lkKSxiLnB1c2goZC5zeW5jQmFycmllcigpKSk6Yi5wdXNoKGQpfSk7cmV0dXJuIFByb21pc2UuYWxsKGIpfSkudGhlbihmdW5jdGlvbihiKXtjLmRldmljZXNfLmZvckVhY2goZnVuY3Rpb24oYSl7Zm9yKHZhciBjPVxyXG4hMCxkPTA7ZDxiLmxlbmd0aDtkKyspe3ZhciBxPWJbZF07aWYoYS5vYmplY3RfaWQoKT09PXEub2JqZWN0X2lkKCkpe2M9ITE7YnJlYWt9fWMmJmEucmVsZWFzZSgpfSk7Yy5kZXZpY2VzXz1iO2EuZW51bWVyYXRlZGRlY2ljZXM9dD1iO2cubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5lbnVtZXJhdGVEZXZpY2VzUHJpdmF0ZTogcmVzb2x2aW5nIGVudW1lcmF0ZWQgZGV2aWNlcyB3aXRoIGlkcyBbXCIrYi5tYXAoZnVuY3Rpb24oYSl7cmV0dXJuIGEub2JqZWN0X2lkKCl9KStcIl1cIik7Yy5wb3N0RW51bWVyYXRlRGV2aWNlc1Jlc3VsdCgpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtjLmRldmljZXNfPVtdO2EuZW51bWVyYXRlZGRlY2ljZXM9dD1bXTtjLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuZW51bWVyYXRlRGV2aWNlc1ByaXZhdGUoKSBmYWlsZWQsIHJlc29sdmluZyB3aXRoIGVtcHR5IGxpc3QuXCIpO2MucG9zdEVudW1lcmF0ZURldmljZXNSZXN1bHQoKX0pKTooYy5wZW5kaW5nRW51bWVyYXRlRGV2aWNlXy5wdXNoKG5ldyBsLmRlZmVycmVkX2FjdGlvbihkLFxyXG5mLFwiZW51bWVyYXRlRGV2aWNlc1ByaXZhdGVcIikpLGcubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5lbnVtZXJhdGVEZXZpY2VzUHJpdmF0ZSgpIG5vdCByZW1vdGluZyB0aGlzIGNhbGwuLi5cIikpfSl9O2MucHJvdG90eXBlLmdldERpc3BsYXlNZWRpYT1mdW5jdGlvbihhKXt2YXIgYj10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihjLGQpe2Iud2FpdFVudGlsQ29ubmVjdGVkKFwiUmVtb3RlRGV2aWNlcy5nZXREaXNwbGF5TWVkaWFcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBiLklzUGFuZWxJZFZhbGlkKCl9KS50aGVuKGZ1bmN0aW9uKCl7dm9pZCAwIT09YS52aWRlbyYmbnVsbCE9PWEudmlkZW8mJnZvaWQgMCE9PWIucGFuZWxpZF8mJihhLnZpZGVvLmRldmljZUlkPWIucGFuZWxpZF8pO3ZhciBjPWIucHJlcGFyZURpc3BsYXlDb25zdHJhaW50cyhhKTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfTWVkaWFEZXZpY2VzX3QuZ2V0RGlzcGxheU1lZGlhLFxyXG5jKX0pLnRoZW4oZnVuY3Rpb24oYSl7cmV0dXJuKG5ldyB4KG51bGwsYS5wYXJhbXNbMF0ub2lkLGwuUHJveHlNb2RlLlJlbW90ZSkpLnN5bmNCYXJyaWVyKCl9KS50aGVuKGZ1bmN0aW9uKGEpe2MoYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLmdldERpc3BsYXlNZWRpYSgpIGZhaWxlZCFcIik7ZChhKX0pfSl9O2MucHJvdG90eXBlLnNldERldmljZUNoYW5nZUNhbGxiYWNrPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztnLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X0RldmljZUNoYW5nZUNhbGxiYWNrKCkgY2FsbGVkLlwiKTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIk1lZGlhRGV2aWNlcy5vbmRldmljZWNoYW5nZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGI9YS5yZWdpc3RlckNhbGxiYWNrcyghMSwhMSxwLm1ldGhvZF9pZF9NZWRpYURldmljZXNfdC5vbmRldmljZWNoYW5nZSk7Yi50aGVuKGZ1bmN0aW9uKCl7Zy5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5vbmRldmljZWNoYW5nZSgpOiBjYWxsYmFjayByZWNlaXZlZCEhIVwiKTthLmVudW1lcmF0ZURldmljZXNQcml2YXRlKCEwKS50aGVuKGZ1bmN0aW9uKCl7bmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcImRldmljZWNoYW5nZVwiKSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7bmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcImRldmljZWNoYW5nZVwiKSl9KX0pO3JldHVybiBhLnJlbW90ZUludm9rZSghMCxwLm1ldGhvZF9pZF9NZWRpYURldmljZXNfdC5vbmRldmljZWNoYW5nZSxiLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuc2V0X29uZGV2aWNlY2hhbmdlKCkgZmFpbGVkIVwiKX0pfTtjLnByb3RvdHlwZS5wcmVwYXJlRGlzcGxheUNvbnN0cmFpbnRzPWZ1bmN0aW9uKGEpe2lmKGsuZ2V0UmVkaXJlY3RvcigpLmdldEZlYXR1cmVWYWx1ZShwLkZFQVRVUkVfbXNfdGVhbXNfY29tbW9uX21lZGlhX2NvbnN0cmFpbnRzKSlyZXR1cm4gYTtcclxudmFyIGI9e2ZyYW1lUmF0ZToxNSx3aWR0aDp7bWF4OjE5MjB9LGhlaWdodDp7bWF4OjEwODB9fTt2b2lkIDAhPT1hLnZpZGVvJiZudWxsIT09YS52aWRlbyYmKGE9YS52aWRlbyx2b2lkIDAhPT1hLmZyYW1lUmF0ZSYmdm9pZCAwIT09YS53aWR0aCYmdm9pZCAwIT09YS5oZWlnaHQmJihiLmZyYW1lUmF0ZT1hLmZyYW1lUmF0ZSxiLndpZHRoLm1heD1hLndpZHRoLm1heHx8YS53aWR0aCxiLmhlaWdodC5tYXg9YS5oZWlnaHQubWF4fHxhLmhlaWdodCkpO3JldHVybnt2aWRlbzpifX07Yy5wcm90b3R5cGUuSXNQYW5lbElkVmFsaWQ9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2lmKC0xIT09YS5wYW5lbGlkXylnLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuSXNQYW5lbElkVmFsaWQoKSByZXNvbHZpbmcgd2l0aCBwYW5lbGlkXzpcIithLnBhbmVsaWRfKSxiKCk7ZWxzZSB2YXIgZD0wLGY9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtnLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLklzUGFuZWxJZFZhbGlkKCkgd2FpdGluZyBwYW5lbGlkXzpcIithLnBhbmVsaWRfKTs1MDw9ZD8oYygpLGNsZWFySW50ZXJ2YWwoZiksZy5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLklzUGFuZWxJZFZhbGlkKCk6IFBhbmVsSWQgaXMgaW52YWxpZC5cIikpOigrK2QsLTEhPWEucGFuZWxpZF8mJihiKCksY2xlYXJJbnRlcnZhbChmKSxnLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuSXNQYW5lbElkVmFsaWQoKTogUGFuZWxJZCBpcyB2YWxpZC5cIikpKX0sMTApfSl9O3JldHVybiBjfShsLlByb3h5T2JqZWN0KTthLlJlbW90ZURldmljZXM9YjtiPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXtyZXR1cm4gYS5jYWxsKHRoaXMsbnVsbCxwLmNsYXNzX2lkX3QuTmF2aWdhdG9yVXNlck1lZGlhLDAsbC5Qcm94eU1vZGUuTG9jYWwpfHx0aGlzfW4oYixhKTtiLmdldENhcGFiaWxpdGllcz1mdW5jdGlvbihhKXtnLmxvZ2dlci5sb2codGhpcy5jb25zdHJ1Y3Rvci5uYW1lK1xyXG5cIi5nZXRDYXBhYmlsaXRpZXMoKSBjYWxsZWQ6XCIrYStcIiBjYXBzOlwiK2IuY2Fwc18pO3JldHVybiBiLmNhcHNfW2FdfTtiLnJlc2V0Y2Fwcz1mdW5jdGlvbigpe2IuY2Fwc189e319O2IucHJvdG90eXBlLmdldENhcGFiaWxpdGllcz1mdW5jdGlvbigpe3ZhciBhPXRoaXM7Zy5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldENhcGFiaWxpdGllcygpIGNhbGxlZDogXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihjLGQpe2Eud2FpdFVudGlsQ29ubmVjdGVkKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldENhcGFiaWxpdGllc1wiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFthLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9OYXZpZ2F0b3JVc2VyTWVkaWFfdC5nZXRDYXBhYmlsaXRpZXMsXCJhdWRpb1wiKSxhLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9OYXZpZ2F0b3JVc2VyTWVkaWFfdC5nZXRDYXBhYmlsaXRpZXMsXCJ2aWRlb1wiKV0pfSkudGhlbihmdW5jdGlvbihkKXtiLmNhcHNfLmF1ZGlvPVxyXG5hLnBhcmFtMChkWzBdKTtiLmNhcHNfLnZpZGVvPWEucGFyYW0wKGRbMV0pO2MoYi5jYXBzXyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2I9YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLmdldENhcGFiaWxpdGllcygpIGZhaWxlZCFcIik7ZChiKX0pfSl9O2IucHJvdG90eXBlLnNldENvZGVjQ2FwYWJpbGl0aWVzPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7Zy5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldENvZGVjQ2FwYWJpbGl0aWVzIDogc2V0IGNvZGVjQ2FwYWJpbGl0aWVzIHRvIFwiK0pTT04uc3RyaW5naWZ5KGEpKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxkKXtiLndhaXRVbnRpbENvbm5lY3RlZChcIk5hdmlnYXRvclVzZXJNZWRpYS5zZXRDb2RlY0NhcGFiaWxpdGllc1wiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGIucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX05hdmlnYXRvclVzZXJNZWRpYV90LnNldENvZGVjQ2FwYWJpbGl0aWVzLFxyXG5hKX0pLnRoZW4oZnVuY3Rpb24oKXtnLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0Q29kZWNDYXBhYmlsaXRpZXMoKSBzdWNjZXNzLlwiKTtjKCEwKTtiLmdldENhcGFiaWxpdGllcygpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPWIubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRDb2RlY0NhcGFiaWxpdGllcygpIGZhaWxlZCFcIik7ZChhKX0pfSl9O2IucHJvdG90eXBlLndlYmtpdEdldFVzZXJNZWRpYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHRoaXMuZ2V0VXNlck1lZGlhKGEsYixjKX07Yi5wcm90b3R5cGUuTG9nVGVsZW1ldHJ5RGV2aWNlXz1mdW5jdGlvbihhKXt0cnl7aWYoXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBhLmF1ZGlvKXt2YXIgYj1hLmF1ZGlvLmRldmljZUlkLGM7dC5mb3JFYWNoKGZ1bmN0aW9uKGEpe2I9PWEuZGV2aWNlSWQmJihjPWEubGFiZWwpfSk7Zy5sb2dnZXIubG9nKGMpO3RoaXMuU2VuZFRlbGVtZXRyeURhdGEodi50ZWxfa2V5X0F1ZGlvRGV2aWNlVXNlZCxcclxuYywwKX1pZihcInVuZGVmaW5lZFwiIT09dHlwZW9mIGEudmlkZW8pe3ZhciBkPWEudmlkZW8ubWFuZGF0b3J5LnNvdXJjZUlkLGY7dC5mb3JFYWNoKGZ1bmN0aW9uKGEpe2Q9PWEuZGV2aWNlSWQmJihmPWEubGFiZWwpfSk7Zy5sb2dnZXIubG9nKGYpO3RoaXMuU2VuZFRlbGVtZXRyeURhdGEodi50ZWxfa2V5X1ZpZGVvRGV2aWNlVXNlZCxmLDApfX1jYXRjaChoKXtnLmxvZ2dlci5sb2coaCl9fTtiLnByb3RvdHlwZS5nZXRVc2VyTWVkaWE9ZnVuY3Rpb24oYSxiLGMpe2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRVc2VyTWVkaWEoKSBjYWxsZWQ6IFwiK0pTT04uc3RyaW5naWZ5KGEpKTtyZXR1cm4gYiYmYz90aGlzLmdldFVzZXJNZWRpYV92MShhLGIsYyk6dGhpcy5nZXRVc2VyTWVkaWFfdjIoYSl9O2IucHJvdG90eXBlLmdldFVzZXJNZWRpYV92Mj1mdW5jdGlvbihhKXt2YXIgYj10aGlzO2cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRVc2VyTWVkaWFfdjIoKSBjYWxsZWQ6IFwiK1xyXG5KU09OLnN0cmluZ2lmeShhKSk7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsZCl7Yi5nZXRVc2VyTWVkaWFQcml2YXRlKGEsZnVuY3Rpb24oYSl7Zy5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiZ2V0VXNlck1lZGlhX3YyOiByZXNvbHZpbmcgc3RyZWFtXCIpO2MoYSl9LGZ1bmN0aW9uKGEpe2cubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcImdldFVzZXJNZWRpYV92MjogcmVqZWN0aW5nIHN0cmVhbVwiKTtkKGEpfSl9KX07Yi5wcm90b3R5cGUuZ2V0VXNlck1lZGlhX3YxPWZ1bmN0aW9uKGEsYixjKXtnLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0VXNlck1lZGlhX3YxKCkgY2FsbGVkOiBcIitKU09OLnN0cmluZ2lmeShhKSk7cmV0dXJuIHRoaXMuZ2V0VXNlck1lZGlhUHJpdmF0ZShhLGIsYyl9O2IucHJvdG90eXBlLmdldFVzZXJNZWRpYVByaXZhdGU9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXM7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJOYXZpZ2F0b3JVc2VyTWVkaWEuZ2V0VXNlck1lZGlhUHJpdmF0ZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGI9XHJcbmQucmVnaXN0ZXJDYWxsYmFja3MoITAsITEscC5tZXRob2RfaWRfTmF2aWdhdG9yVXNlck1lZGlhX3QuZ2V0VXNlck1lZGlhKTthJiZcInVuZGVmaW5lZFwiIT09dHlwZW9mIGEuYXVkaW8mJjA9PU9iamVjdC5rZXlzKGEuYXVkaW8pLmxlbmd0aCYmKGEuYXVkaW89e2R1bW15OjF9KTtpZihhJiZcInVuZGVmaW5lZFwiIT09dHlwZW9mIGEudmlkZW8pe3ZhciBjPWEudmlkZW87dm9pZCAwPT1jLm1hbmRhdG9yeS5tYXhGcmFtZVJhdGUmJihjLm1hbmRhdG9yeS5tYXhGcmFtZVJhdGU9MzApO3ZvaWQgMD09Yy5tYW5kYXRvcnkubWluV2lkdGgmJihjLm1hbmRhdG9yeS5taW5XaWR0aD0zNjApO3ZvaWQgMD09Yy5tYW5kYXRvcnkubWF4V2lkdGgmJihjLm1hbmRhdG9yeS5tYXhXaWR0aD0xOTIwKTt2b2lkIDA9PWMubWFuZGF0b3J5Lm1pbkhlaWdodCYmKGMubWFuZGF0b3J5Lm1pbkhlaWdodD0xODApO3ZvaWQgMD09Yy5tYW5kYXRvcnkubWF4SGVpZ2h0JiYoYy5tYW5kYXRvcnkubWF4SGVpZ2h0PTEwODApfWQucmVtb3RlSW52b2tlKCExLFxyXG5wLm1ldGhvZF9pZF9OYXZpZ2F0b3JVc2VyTWVkaWFfdC5nZXRVc2VyTWVkaWEsYSxiLnN1Y2Nlc3MsYi5mYWlsKTtyZXR1cm4gYi5wcm9tKCl9KS50aGVuKGZ1bmN0aW9uKGEpe2cubG9nZ2VyLmxvZyhkLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRVc2VyTWVkaWFQcml2YXRlOiByZWNlaXZlZCBzdWNjZXNzIGNhbGxiYWNrIVwiKTtyZXR1cm4obmV3IHgobnVsbCxkLnBhcmFtMChhKS5vaWQsbC5Qcm94eU1vZGUuUmVtb3RlKSkuc3luY0JhcnJpZXIoKX0pLnRoZW4oZnVuY3Rpb24oZil7Zy5sb2dnZXIubG9nKGQudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFVzZXJNZWRpYVByaXZhdGU6IE1lZGlhU3RyZWFtIHJlYWR5IHRvIGRlbGl2ZXJcIixKU09OLnN0cmluZ2lmeShmKSk7MD09Zi5nZXRUcmFja3MoKS5sZW5ndGg/KGcubG9nZ2VyLmxvZyhkLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRVc2VyTWVkaWFQcml2YXRlOiByZXBvcnRpbmcgbm8gdHJhY2tzIGFzIGVycm9yLlwiKSxjKHtjb25zdHJhaW50TmFtZTpcIlwiLFxyXG5uYW1lOlwiT3ZlcmNvbnN0cmFpbmVkRXJyb3JcIixtZXNzYWdlOlwiXCJ9KSk6KGQuTG9nVGVsZW1ldHJ5RGV2aWNlXyhhKSxiKGYpKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7ZC5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLmdldFVzZXJNZWRpYVByaXZhdGUoKSBmYWlsZWQhXCIpO2suZ2V0UmVkaXJlY3RvcigpLmdldEZlYXR1cmVWYWx1ZShwLkZFQVRVUkVfbXNfdGVhbXNfMTkxMik/ZC5wYXJhbTAmJmE/YyhkLnBhcmFtMChhKSk6Yyh7Y29uc3RyYWludE5hbWU6XCJcIixuYW1lOlwiT3ZlcmNvbnN0cmFpbmVkRXJyb3JcIixtZXNzYWdlOlwiXCJ9KTpjKHtjb25zdHJhaW50TmFtZTpcIlwiLG5hbWU6XCJPdmVyY29uc3RyYWluZWRFcnJvclwiLG1lc3NhZ2U6XCJcIn0pfSl9O2IucHJvdG90eXBlLlNlbmRUZWxlbWV0cnlEYXRhPWZ1bmN0aW9uKGEsYixjKXtrLmdldFJlZGlyZWN0b3IoKS50ZWxlbWV0cnkuU2VuZFRlbGVtZXRyeURhdGEodi50ZWxfY21kLkRhdGEsYSxiLGMpfTtiLmNhcHNfPXt9O3JldHVybiBifShsLlByb3h5T2JqZWN0KTtcclxuYS5OYXZpZ2F0b3JVc2VyTWVkaWE9Yn0sNjUwOmZ1bmN0aW9uKGIsYSxjKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgZD1jKDk0Niksbj1jKDU1MCksZT1jKDkpLG09Yyg4NTEpLHA9Yyg1NTApLGw9YygzOTQpLGc7KGZ1bmN0aW9uKGEpe2FbYS5Vbmtub3duPTBdPVwiVW5rbm93blwiO2FbYS5XaW5kb3dzPTFdPVwiV2luZG93c1wiO2FbYS5MaW51eD0yXT1cIkxpbnV4XCJ9KShnPWEuUmVtb3RlVHlwZXx8KGEuUmVtb3RlVHlwZT17fSkpO3ZhciBrPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7fX0oKTthLlNlc3Npb25JbmZvPWs7Yj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt2YXIgYj10aGlzO3RoaXMuaXNyZW1vdGVfPSExO3RoaXMuaXNyZW1vdGVfPSEwO3RoaXMudHlwZV89Zy5XaW5kb3dzO3RoaXMuYWRkcmVzc189XCIwLjAuMC4wXCI7dGhpcy5zZXNzaW9uaW5mb189bnVsbDtkLmdldFJlZGlyZWN0b3IoKS5zZXRSZW1vdGVTZXNzaW9uSW5mb0NiKGZ1bmN0aW9uKCl7cmV0dXJuIGIucmVtb3RlU2Vzc2lvbkluZm8oKX0pO1xyXG50aGlzLmVuZ2luZWNvbnRyb2xfPW5ldyBlLkVuZ2luZUNvbnRyb2x9YS5wcm90b3R5cGUucmVsZWFzZT1mdW5jdGlvbigpe2QuZ2V0UmVkaXJlY3RvcigpLnNldFJlbW90ZVNlc3Npb25JbmZvQ2IobnVsbCl9O2EucHJvdG90eXBlLnVzZXJfZnJpZW5kbHlfaWQ9ZnVuY3Rpb24oKXtyZXR1cm5cIltSZW1vdGVTZXNzaW9uXVwifTthLnByb3RvdHlwZS5nZXRGZWF0dXJlRmxhZ3M9ZnVuY3Rpb24oKXt2YXIgYT17fTtudWxsIT09dGhpcy5lbmdpbmVjb250cm9sXyYmbnVsbCE9PXRoaXMuZW5naW5lY29udHJvbF8uZmVhdHVyZXNfJiZ2b2lkIDAhPT10aGlzLmVuZ2luZWNvbnRyb2xfLmZlYXR1cmVzXyYmdGhpcy5lbmdpbmVjb250cm9sXy5mZWF0dXJlc18uZm9yRWFjaChmdW5jdGlvbihiKXthW2IubmFtZV09Yi52YWx1ZX0pO3JldHVybiBhfTthLnByb3RvdHlwZS5pc0ZlYXR1cmVTdXBwb3J0ZWQ9ZnVuY3Rpb24oYSl7aWYoXCJ2aWRlb1wiPT09YSlyZXR1cm4hMDtpZighKGEgaW4gcC5mZWF0dXJlTmFtZU1hcCkpcmV0dXJuITE7XHJcbmE9cC5mZWF0dXJlTmFtZU1hcFthXTtmb3IodmFyIGI9dGhpcy5nZXRGZWF0dXJlRmxhZ3MoKSxjPTA7YzxhLmxlbmd0aDtjKyspaWYoIShhW2NdaW4gYil8fCEwIT09YlthW2NdXSlyZXR1cm4hMTtyZXR1cm4hMH07YS5pc0ZlYXR1cmVQc3RuU3VwcG9ydGVkPWZ1bmN0aW9uKCl7cmV0dXJuIGEucHN0bl99O2EuaXNGZWF0dXJlRHRtZlN1cHBvcnRlZD1mdW5jdGlvbigpe3JldHVybiBhLmR0bWZzd2l0Y2hffTthLmlzRmVhdHVyQXBwc2hhcmVTdXBwb3J0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gYS5hcHBzaGFyZV99O2EuaXNGZWF0dXJlV2VicnRjMWRvdDBTdXBwb3J0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gYS53ZWJydGMxZG90MF99O2EuaXNGZWF0dXJlRGF0YUNoYW5uZWxTdXBwb3J0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gYS5kYXRhY2hhbm5lbF99O2EuaXNGZWF0dXJlVmROb0J1ZmZlckxpbWl0U3VwcG9ydGVkPWZ1bmN0aW9uKCl7cmV0dXJuIGEudmRub2J1ZmxpbWl0X307YS5wcm90b3R5cGUuZ2V0U2Vzc2lvbkluZm89XHJcbmZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFNlc3Npb25JbmZvKCkgY2FsbGVkLlwiKTtyZXR1cm4gbnVsbCE9dGhpcy5zZXNzaW9uaW5mb18/UHJvbWlzZS5yZXNvbHZlKHRoaXMuc2Vzc2lvbmluZm9fKTpQcm9taXNlLnJlamVjdCgpfTthLnByb3RvdHlwZS5yZW1vdGVTZXNzaW9uSW5mbz1mdW5jdGlvbigpe3ZhciBiPXRoaXMsYz10aGlzO20ubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5yZW1vdGVTZXNzaW9uSW5mbygpIGNhbGxlZC5cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGcsZil7Yy5lbmdpbmVjb250cm9sXy5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oZCl7bS5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiZW5naW5lY29udHJvbCBpbmZvIHJlY2VpdmVkIVwiKTtjLnNlc3Npb25pbmZvXz1uZXcgaztjLnNlc3Npb25pbmZvXy50eXBlX3NjcmlwdD1uLkhEWE1TX1ZFUlNJT047Yy5zZXNzaW9uaW5mb18ud2VicnBjPVxyXG5kLnZlcnNpb25fLm1ham9yLnRvU3RyaW5nKCkrXCIuXCIrZC52ZXJzaW9uXy5taW5vci50b1N0cmluZygpK1wiLlwiK2QudmVyc2lvbl8ucmV2aXNpb24udG9TdHJpbmcoKStcIi5cIitkLnZlcnNpb25fLmJ1aWxkLnRvU3RyaW5nKCk7aWYodm9pZCAwIT1kLnZlcnNpb25zXyYmbnVsbCE9ZC52ZXJzaW9uc18pe2MuU2VuZFRlbGVtZXRyeURhdGEobC50ZWxfa2V5X1ZlclR5cGVTY3JpcHQsbi5IRFhNU19WRVJTSU9OLDApO2Zvcih2YXIgZj0wLHA9MCxDPWQudmVyc2lvbnNfO3A8Qy5sZW5ndGg7cCsrKXt2YXIgcj1DW3BdLHI9ci5tYWpvci50b1N0cmluZygpK1wiLlwiK3IubWlub3IudG9TdHJpbmcoKStcIi5cIityLnJldmlzaW9uLnRvU3RyaW5nKCkrXCIuXCIrci5idWlsZC50b1N0cmluZygpO3N3aXRjaChmKXtjYXNlIGUuVmVyc2lvblR5cGUuV2VicnBjOmMuc2Vzc2lvbmluZm9fLndlYnJwYz1yO2MuU2VuZFRlbGVtZXRyeURhdGEobC50ZWxfa2V5X1ZlcldlYnJwYyxyLDApO2JyZWFrO2Nhc2UgZS5WZXJzaW9uVHlwZS5XZWJydGNDb2RlY3M6Yy5zZXNzaW9uaW5mb18ud2VicnRjX2NvZGVjcz1cclxucjtjLlNlbmRUZWxlbWV0cnlEYXRhKGwudGVsX2tleV9WZXJXZWJydGNDb2RlY3MsciwwKTticmVhaztjYXNlIGUuVmVyc2lvblR5cGUuUmVjZWl2ZXI6Yy5zZXNzaW9uaW5mb18ucmVjZWl2ZXI9cjtjLlNlbmRUZWxlbWV0cnlEYXRhKGwudGVsX2tleV9WZXJSZWNlaXZlcixyLDApO2JyZWFrO2Nhc2UgZS5WZXJzaW9uVHlwZS5WZGE6Yy5zZXNzaW9uaW5mb18udmRhPXI7Yy5TZW5kVGVsZW1ldHJ5RGF0YShsLnRlbF9rZXlfVmVyVmRhLHIsMCk7YnJlYWs7Y2FzZSBlLlZlcnNpb25UeXBlLkVuZHBvaW50OmMuc2Vzc2lvbmluZm9fLmVuZHBvaW50PXI7Yy5TZW5kVGVsZW1ldHJ5RGF0YShsLnRlbF9rZXlfVmVyRW5kcG9pbnQsciwwKTticmVhaztkZWZhdWx0Om0ubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIlVua25vd24gdmVyc2lvbiB0eXBlIVwiKX1mKyt9fXZvaWQgMCE9ZC5vc2luZm9fJiZudWxsIT1kLm9zaW5mb18mJihjLnNlc3Npb25pbmZvXy5vc2luZm89ZC5vc2luZm9fLFxyXG5kLm9zaW5mb18uZmFtaWx5LmluY2x1ZGVzKFwiRGFyd2luXCIpJiZkLm9zaW5mb18uZWRpdGlvbi5pbmNsdWRlcyhcIk1hY1wiKT9jLnNlc3Npb25pbmZvXy5jbGllbnRQbGF0Zm9ybT1cIk1hY1wiOmMuc2Vzc2lvbmluZm9fLmNsaWVudFBsYXRmb3JtPWQub3NpbmZvXy5mYW1pbHksYy5TZW5kVGVsZW1ldHJ5RGF0YShsLnRlbF9rZXlfT1NGYW1pbHksZC5vc2luZm9fLmZhbWlseSwwKSxjLlNlbmRUZWxlbWV0cnlEYXRhKGwudGVsX2tleV9PU1ZlcnNpb24sZC5vc2luZm9fLnZlcnNpb24sMCksYy5TZW5kVGVsZW1ldHJ5RGF0YShsLnRlbF9rZXlfT1NBcmNoaXRlY3R1cmUsZC5vc2luZm9fLmFyY2hpdGVjdHVyZSwwKSxjLlNlbmRUZWxlbWV0cnlEYXRhKGwudGVsX2tleV9PU0Rpc3RybyxkLm9zaW5mb18uZGlzdHJvLDApLGMuU2VuZFRlbGVtZXRyeURhdGEobC50ZWxfa2V5X09TRWRpdGlvbixkLm9zaW5mb18uZWRpdGlvbiwwKSk7dm9pZCAwIT1kLmVuZHBvaW50aWRfJiZudWxsIT1kLmVuZHBvaW50aWRfJiZcclxuKGMuc2Vzc2lvbmluZm9fLmVuZHBvaW50SWQ9ZC5lbmRwb2ludGlkXy5tYWNoaW5lX2lkKTthLnBzdG5fPWIuaXNGZWF0dXJlU3VwcG9ydGVkKG4uRmVhdHVyZXMuRkVBVFVSRV9wdWJsaWNfcHN0bik7YS5kdG1mc3dpdGNoXz1iLmlzRmVhdHVyZVN1cHBvcnRlZChuLkZlYXR1cmVzLkZFQVRVUkVfcHVibGljX2R0bWYpO2EuYXBwc2hhcmVfPWIuaXNGZWF0dXJlU3VwcG9ydGVkKG4uRmVhdHVyZXMuRkVBVFVSRV9wdWJsaWNfYXBwX3NoYXJpbmcpO2Eud2VicnRjMWRvdDBfPWIuaXNGZWF0dXJlU3VwcG9ydGVkKG4uRmVhdHVyZXMuRkVBVFVSRV9wdWJsaWNfd2VicnRjMWRvdDApO2EuZGF0YWNoYW5uZWxfPWIuaXNGZWF0dXJlU3VwcG9ydGVkKG4uRmVhdHVyZXMuRkVBVFVSRV9wdWJsaWNfZGF0YV9jaGFubmVsKTthLnZkbm9idWZsaW1pdF89Yi5pc0ZlYXR1cmVTdXBwb3J0ZWQobi5GZWF0dXJlcy5GRUFUVVJFX3B1YmxpY192ZG5vYnVmbGltaXQpO2coYy5zZXNzaW9uaW5mb18pO2MuZW5naW5lY29udHJvbF8ucmVsZWFzZSgpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2QuZ2V0UmVkaXJlY3RvcigpLmlzUGluZ0FjdGl2ZSgpP1xyXG5jLnJldHJ5U2Vzc2lvbkluZm8oKTooZigpLGMuZW5naW5lY29udHJvbF8ucmVsZWFzZSgpLGMuZW5naW5lY29udHJvbF89bnVsbCl9KX0pfTthLnByb3RvdHlwZS5yZXRyeVNlc3Npb25JbmZvPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKFwiY2hlY2tpbmcgaWYgd2UgYXJlIGNvbm5lY3RlZC4uLlwiKTthLmVuZ2luZWNvbnRyb2xfLmJpbmQoKTtkLmdldFJlZGlyZWN0b3IoKS5oYW5kbGVSZW1vdGVTZXNzaW9uSW5mbygpfSwxNUUzKX07YS5wcm90b3R5cGUuU2VuZFRlbGVtZXRyeURhdGE9ZnVuY3Rpb24oYSxiLGMpe2QuZ2V0UmVkaXJlY3RvcigpLnRlbGVtZXRyeS5TZW5kVGVsZW1ldHJ5RGF0YShsLnRlbF9jbWQuRGF0YSxhLGIsYyl9O2EucHN0bl89ITE7YS5kdG1mc3dpdGNoXz0hMTthLmFwcHNoYXJlXz0hMTthLndlYnJ0YzFkb3QwXz0hMTthLmRhdGFjaGFubmVsXz0hMTthLnZkbm9idWZsaW1pdF89ITE7cmV0dXJuIGF9KCk7XHJcbmEuUmVtb3RlU2Vzc2lvbj1ifSwyNDpmdW5jdGlvbihiLGEsYyl7dmFyIGQ9dGhpcyYmdGhpcy5fX2V4dGVuZHN8fGZ1bmN0aW9uKCl7dmFyIGE9ZnVuY3Rpb24oYixjKXthPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihhLGIpe2EuX19wcm90b19fPWJ9fHxmdW5jdGlvbihhLGIpe2Zvcih2YXIgYyBpbiBiKWIuaGFzT3duUHJvcGVydHkoYykmJihhW2NdPWJbY10pfTtyZXR1cm4gYShiLGMpfTtyZXR1cm4gZnVuY3Rpb24oYixjKXtmdW5jdGlvbiBkKCl7dGhpcy5jb25zdHJ1Y3Rvcj1ifWEoYixjKTtiLnByb3RvdHlwZT1udWxsPT09Yz9PYmplY3QuY3JlYXRlKGMpOihkLnByb3RvdHlwZT1jLnByb3RvdHlwZSxuZXcgZCl9fSgpO09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBuPWMoNjU4KSxlPWMoNTUwKSxtPWMoODUxKSxwPWMoNTg5KSxsOyhmdW5jdGlvbihhKXthW2FbXCJuZXdcIl09XHJcbjBdPVwibmV3XCI7YVthLmNvbm5lY3Rpbmc9MV09XCJjb25uZWN0aW5nXCI7YVthLmNvbm5lY3RlZD0yXT1cImNvbm5lY3RlZFwiO2FbYS5jbG9zZWQ9M109XCJjbG9zZWRcIjthW2EubWF4PTRdPVwibWF4XCJ9KShsfHwobD17fSkpO2I9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjLGQpe3ZhciBnPWEuY2FsbCh0aGlzLGMsZS5jbGFzc19pZF90LlJUQ1NjdHBUcmFuc3BvcnQsZCxuLlByb3h5TW9kZS5SZW1vdGUpfHx0aGlzO20ubG9nZ2VyLmxvZyhnLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jb25zdHJ1Y3RvclwiKTtyZXR1cm4gZ31kKGIsYSk7Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllcigpIGNhbGxlZC5cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGIsYyl7YS53YWl0VW50aWxDb25uZWN0ZWQoXCJSVENTY3RwVHJhbnNwb3J0LnN5bmNCYXJyaWVyXCIpLnRoZW4oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLnN5bmNCYXJyaWVyQmFzZSBzdWNjZXNzLlwiKTtyZXR1cm4gUHJvbWlzZS5hbGwoW2EucmVtb3RlSW52b2tlKCExLGUubWV0aG9kX2lkX1JUQ1NjdHBUcmFuc3BvcnRfdC50cmFuc3BvcnQse30pLGEucmVtb3RlSW52b2tlKCExLGUubWV0aG9kX2lkX1JUQ1NjdHBUcmFuc3BvcnRfdC5zdGF0ZSxcIlwiKSxhLnJlbW90ZUludm9rZSghMSxlLm1ldGhvZF9pZF9SVENTY3RwVHJhbnNwb3J0X3QubWF4TWVzc2FnZVNpemUsMCksYS5yZW1vdGVJbnZva2UoITEsZS5tZXRob2RfaWRfUlRDU2N0cFRyYW5zcG9ydF90Lm1heENoYW5uZWxzLDApXSl9KS50aGVuKGZ1bmN0aW9uKGMpe3ZhciBkO2Q9Yy5tYXAoZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyYW0wKGIpfSk7Yz1kWzBdO2Euc2N0cHN0YXRlXz1kWzFdO2EubWF4TWVzc2FnZVNpemVfPWRbMl07YS5tYXhDaGFubmVsc189ZFszXTtkPWEudHJhbnNwb3J0Xzt2b2lkIDA9PWN8fCExIT09Yy5pc19udWxsfHxudWxsIT09YS50cmFuc3BvcnRfJiZcclxuYS50cmFuc3BvcnRfLm9iamVjdF9pZCgpPT1jLm9pZHx8KGQ9bmV3IHAuRHRsc1RyYW5zcG9ydChhLGMub2lkKSk7ZC5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oYyl7bS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1widHJhbnNwb3J0LnN5bmNCYXJyaWVyKCk6IHN1Y2Nlc3NcIik7YS50cmFuc3BvcnRfPWM7YihhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCJ0cmFuc3BvcnQuc3luY0JhcnJpZXIoKTogZmFpbGVkIVwiKTthLnRyYW5zcG9ydF89bnVsbDtiKGEpfSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2I9YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLnN5bmNCYXJyaWVyKCkgZmFpbGVkIVwiKTtjKGIpfSl9KX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwidHJhbnNwb3J0XCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfdHJhbnNwb3J0KCkgY2FsbGVkOiBcIitcclxudGhpcy50cmFuc3BvcnRfKTtyZXR1cm4gdGhpcy50cmFuc3BvcnRffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInN0YXRlXCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfc3RhdGUoKSBjYWxsZWQ6IFwiK3RoaXMuc2N0cHN0YXRlXyk7cmV0dXJuIHRoaXMuc2N0cHN0YXRlX30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJtYXhNZXNzYWdlU2l6ZVwiLHtnZXQ6ZnVuY3Rpb24oKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X21heE1lc3NhZ2VTaXplKCkgY2FsbGVkOiBcIit0aGlzLm1heE1lc3NhZ2VTaXplXyk7cmV0dXJuIHRoaXMubWF4TWVzc2FnZVNpemVffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcclxuXCJtYXhDaGFubmVsc1wiLHtnZXQ6ZnVuY3Rpb24oKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X21heENoYW5uZWxzKCkgY2FsbGVkOiBcIit0aGlzLm1heENoYW5uZWxzXyk7cmV0dXJuIHRoaXMubWF4Q2hhbm5lbHNffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9uc3RhdGVjaGFuZ2VcIix7Z2V0OmZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9vbnN0YXRlY2hhbmdlKCkgY2FsbGVkOiBcIit0aGlzLm9uc3RhdGVjaGFuZ2VfKTtyZXR1cm4gdGhpcy5vbnN0YXRlY2hhbmdlX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbnN0YXRlY2hhbmdlKCkgY2FsbGVkLlwiKTt0aGlzLm9uc3RhdGVjaGFuZ2VfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLm9uc3RhdGVjaGFuZ2VcIikudGhlbihmdW5jdGlvbigpe3ZhciBkPWMucmVnaXN0ZXJDYWxsYmFja3MoITEsYy5pc051bGxDYWxsYmFjayhhKSxlLm1ldGhvZF9pZF9SVENTY3RwVHJhbnNwb3J0X3Qub25zdGF0ZWNoYW5nZSk7ZC50aGVuKGZ1bmN0aW9uKGEpe20ubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbnN0YXRlY2hhbmdlIGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO2Muc2N0cHN0YXRlXz1iLmNvbnZlcnRTdGF0ZShjLnBhcmFtMChhKSk7bS5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wic2N0cHN0YXRlXzogXCIrYy5zY3Rwc3RhdGVfKTthPW5ldyBFdmVudChcIm9uc3RhdGVjaGFuZ2VcIik7Yy5vbnN0YXRlY2hhbmdlXyhhKX0pO3JldHVybiBjLnJlbW90ZUludm9rZSghMCxlLm1ldGhvZF9pZF9SVENTY3RwVHJhbnNwb3J0X3Qub25zdGF0ZWNoYW5nZSxkLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIub25zdGF0ZWNoYW5nZSgpIGZhaWxlZC5cIil9KX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtiLmNvbnZlcnRTdGF0ZT1mdW5jdGlvbihhKXtyZXR1cm4gYT09bFtcIm5ld1wiXT9cImNsb3NlZFwiOmE9PWwuY29ubmVjdGluZz9cImNvbm5lY3RpbmdcIjphPT1sLmNvbm5lY3RlZD9cImNvbm5lY3RlZFwiOlwiY2xvc2VkXCJ9O3JldHVybiBifShuLlByb3h5T2JqZWN0KTthLlJUQ1NjdHBUcmFuc3BvcnQ9Yjt2YXIgZzsoZnVuY3Rpb24oYSl7YVthLmNvbm5lY3Rpbmc9MF09XCJjb25uZWN0aW5nXCI7YVthLm9wZW49MV09XCJvcGVuXCI7YVthLmNsb3Npbmc9Ml09XCJjbG9zaW5nXCI7YVthLmNsb3NlZD0zXT1cImNsb3NlZFwifSkoZ3x8KGc9e30pKTtiPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYyxkLGcpe2M9YS5jYWxsKHRoaXMsYyxlLmNsYXNzX2lkX3QuUlRDRGF0YUNoYW5uZWwsZCxnKXx8dGhpcztjLmJpbmFyeVR5cGVfPVwiYmxvYlwiO20ubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuY29uc3RydWN0b3JcIik7cmV0dXJuIGN9ZChiLGEpO2IucHJvdG90eXBlLnN5bmNCYXJyaWVyPWZ1bmN0aW9uKCl7dmFyIGE9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2Eud2FpdFVudGlsQ29ubmVjdGVkKFwiUnRjRGF0YUNoYW5uZWwuc3luY0JhcnJpZXJcIikudGhlbihmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllciByZW1vdGUgaW52b2tpbmcuXCIpO3JldHVybiBQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEsZS5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5sYWJlbCxcIlwiKSxhLnJlbW90ZUludm9rZSghMSxlLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90Lm9yZGVyZWQsITApLGEucmVtb3RlSW52b2tlKCExLGUubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3QubWF4UGFja2V0TGlmZVRpbWUsXHJcbjApLGEucmVtb3RlSW52b2tlKCExLGUubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3QubWF4UmV0cmFuc21pdHMsMCksYS5yZW1vdGVJbnZva2UoITEsZS5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5wcm90b2NvbCxcIlwiKSxhLnJlbW90ZUludm9rZSghMSxlLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90Lm5lZ290aWF0ZWQsITEpLGEucmVtb3RlSW52b2tlKCExLGUubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3QuaWQsMCksYS5yZW1vdGVJbnZva2UoITEsZS5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5yZWFkeVN0YXRlLFwiXCIpLGEucmVtb3RlSW52b2tlKCExLGUubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3QuYnVmZmVyZWRBbW91bnQsMCksYS5yZW1vdGVJbnZva2UoITEsZS5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5idWZmZXJlZEFtb3VudExvd1RocmVzaG9sZCwwKV0pfSkudGhlbihmdW5jdGlvbihjKXttLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLnN5bmNCYXJyaWVyIHN1Y2Nlc3MuXCIpO3ZhciBkO2M9Yy5tYXAoZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyYW0wKGIpfSk7YS5sYWJlbF89Y1swXTthLm9yZGVyZWRfPWNbMV07YS5tYXhQYWNrZXRMaWZlVGltZV89Y1syXTthLm1heFJldHJhbnNtaXRzXz1jWzNdO2EucHJvdG9jb2xfPWNbNF07YS5uZWdvdGlhdGVkXz1jWzVdO2EuaWRfPWNbNl07ZD1jWzddO2EuYnVmZmVyZWRBbW91bnRfPWNbOF07YS5idWZmZXJlZEFtb3VudExvd1RocmVzaG9sZF89Y1s5XTthLnJlYWR5U3RhdGVfPWEudG9SVENEYXRhQ2hhbm5lbFN0YXRlKGQpO2IoYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2I9YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLnN5bmNCYXJyaWVyKCkgZmFpbGVkIVwiKTtjKGIpfSl9KX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwibGFiZWxcIix7Z2V0OmZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9sYWJlbCgpIGNhbGxlZDogXCIrXHJcbnRoaXMubGFiZWxfKTtyZXR1cm4gdGhpcy5sYWJlbF99LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib3JkZXJlZFwiLHtnZXQ6ZnVuY3Rpb24oKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X29yZGVyZWQoKSBjYWxsZWQ6IFwiK3RoaXMub3JkZXJlZF8pO3JldHVybiB0aGlzLm9yZGVyZWRffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm1heFBhY2tldExpZmVUaW1lXCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfbWF4UGFja2V0TGlmZVRpbWUoKSBjYWxsZWQ6IFwiK3RoaXMubWF4UGFja2V0TGlmZVRpbWVfKTtyZXR1cm4gdGhpcy5tYXhQYWNrZXRMaWZlVGltZV99LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFxyXG5cIm1heFJldHJhbnNtaXRzXCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfbWF4UmV0cmFuc21pdHMoKSBjYWxsZWQ6IFwiK3RoaXMubWF4UmV0cmFuc21pdHNfKTtyZXR1cm4gdGhpcy5tYXhSZXRyYW5zbWl0c199LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwicHJvdG9jb2xcIix7Z2V0OmZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9wcm90b2NvbCgpIGNhbGxlZDogXCIrdGhpcy5wcm90b2NvbF8pO3JldHVybiB0aGlzLnByb3RvY29sX30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJuZWdvdGlhdGVkXCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfbmVnb3RpYXRlZCgpIGNhbGxlZDogXCIrXHJcbnRoaXMubmVnb3RpYXRlZF8pO3JldHVybiB0aGlzLm5lZ290aWF0ZWRffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImlkXCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfaWQoKSBjYWxsZWQ6IFwiK3RoaXMuaWRfKTtyZXR1cm4gdGhpcy5pZF99LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwicmVhZHlTdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X3JlYWR5U3RhdGUoKSBjYWxsZWQ6IFwiK3RoaXMucmVhZHlTdGF0ZV8pO3JldHVybiB0aGlzLnJlYWR5U3RhdGVffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImJ1ZmZlcmVkQW1vdW50XCIsXHJcbntnZXQ6ZnVuY3Rpb24oKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X2J1ZmZlcmVkQW1vdW50KCkgY2FsbGVkOiBcIit0aGlzLmJ1ZmZlcmVkQW1vdW50Xyk7cmV0dXJuIHRoaXMuYnVmZmVyZWRBbW91bnRffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImJ1ZmZlcmVkQW1vdW50TG93VGhyZXNob2xkXCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfYnVmZmVyZWRBbW91bnRMb3dUaHJlc2hvbGQoKSBjYWxsZWQ6IFwiK3RoaXMuYnVmZmVyZWRBbW91bnRMb3dUaHJlc2hvbGRfKTtyZXR1cm4gdGhpcy5idWZmZXJlZEFtb3VudExvd1RocmVzaG9sZF99LHNldDpmdW5jdGlvbihhKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X2J1ZmZlcmVkQW1vdW50TG93VGhyZXNob2xkKCkgY2FsbGVkOiBcIitcclxuYSk7dGhpcy5idWZmZXJlZEFtb3VudExvd1RocmVzaG9sZF89YX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJiaW5hcnlUeXBlXCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfYmluYXJ5VHlwZSgpIGNhbGxlZDogXCIrdGhpcy5iaW5hcnlUeXBlXyk7cmV0dXJuIHRoaXMuYmluYXJ5VHlwZV99LHNldDpmdW5jdGlvbihhKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X2JpbmFyeVR5cGUoKSBjYWxsZWQ6IFwiK2EpO3RoaXMuYmluYXJ5VHlwZV89XCJibG9iXCI9PWF8fFwiYXJyYXlidWZmZXJcIj09YT9hOlwiYmxvYlwifSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9ub3BlblwiLHtnZXQ6ZnVuY3Rpb24oKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLmdldF9vbm9wZW4oKSBjYWxsZWQuXCIpO3JldHVybiB0aGlzLm9ub3Blbl99LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25vcGVuKCkgY2FsbGVkLlwiKTt0aGlzLm9ub3Blbl89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbm9wZW5cIikudGhlbihmdW5jdGlvbigpe3ZhciBjPWIucmVnaXN0ZXJDYWxsYmFja3MoITEsYi5pc051bGxDYWxsYmFjayhhKSxlLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90Lm9ub3Blbik7Yy50aGVuKGZ1bmN0aW9uKGEpe20ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbm9wZW4gY2FsbGJhY2sgcmVjZWl2ZWQhISFcIik7Yi5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25vcGVuIG5vdGlmeWluZy4uLlwiKTt2YXIgYT1uZXcgRXZlbnQoXCJvcGVuXCIsXHJcbnt9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcInRhcmdldFwiLHt3cml0YWJsZTohMSx2YWx1ZTpifSk7Yi5vbm9wZW5fKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllcigpOiBmYWlsZWQhXCIpfSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsZS5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5vbm9wZW4sYy5zdWNjZXNzKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25vcGVuKCkgZmFpbGVkLlwiKX0pfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9uYnVmZmVyZWRhbW91bnRsb3dcIix7Z2V0OmZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9vbmJ1ZmZlcmVkYW1vdW50bG93KCkgY2FsbGVkLlwiKTtyZXR1cm4gdGhpcy5vbmJ1ZmZlcmVkYW1vdW50bG93X30sXHJcbnNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25idWZmZXJlZGFtb3VudGxvdygpIGNhbGxlZC5cIik7dGhpcy5vbmJ1ZmZlcmVkYW1vdW50bG93Xz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uYnVmZmVyZWRhbW91bnRsb3dcIikudGhlbihmdW5jdGlvbigpe3ZhciBjPWIucmVnaXN0ZXJDYWxsYmFja3MoITEsYi5pc051bGxDYWxsYmFjayhhKSxlLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90Lm9uYnVmZmVyZWRhbW91bnRsb3cpO2MudGhlbihmdW5jdGlvbihhKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25idWZmZXJlZGFtb3VudGxvdyBjYWxsYmFjayByZWNlaXZlZCEhIVwiKTthPW5ldyBFdmVudChcIm9uYnVmZmVyZWRhbW91bnRsb3dcIik7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJ0YXJnZXRcIix7d3JpdGFibGU6ITEsdmFsdWU6Yn0pO1xyXG5iLm9uYnVmZmVyZWRhbW91bnRsb3dfKGEpfSk7cmV0dXJuIGIucmVtb3RlSW52b2tlKCEwLGUubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3Qub25idWZmZXJlZGFtb3VudGxvdyxjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmJ1ZmZlcmVkYW1vdW50bG93cygpIGZhaWxlZC5cIil9KX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbmVycm9yXCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfb25lcnJvcigpIGNhbGxlZC5cIik7cmV0dXJuIHRoaXMub25lcnJvcl99LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25lcnJvcigpIGNhbGxlZC5cIik7dGhpcy5vbmVycm9yXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5vbmVycm9yXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGIuaXNOdWxsQ2FsbGJhY2soYSksZS5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5vbmVycm9yKTtjLnRoZW4oZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uZXJyb3IgY2FsbGJhY2sgcmVjZWl2ZWQhXCIpO2E9Yi5wYXJhbTAoYSk7bS5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiZXJyb3I6IFwiK2EpO2E9bmV3IEV2ZW50KFwib25lcnJvclwiKTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcInRhcmdldFwiLHt3cml0YWJsZTohMSx2YWx1ZTpifSk7Yi5vbmVycm9yXyhhKX0pO3JldHVybiBiLnJlbW90ZUludm9rZSghMCxlLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90Lm9uZXJyb3IsYy5zdWNjZXNzKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25lcnJvcigpIGZhaWxlZC5cIil9KX0sXHJcbmVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25jbG9zaW5nXCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfb25jbG9zaW5nKCkgY2FsbGVkLlwiKTtyZXR1cm4gdGhpcy5vbmNsb3NpbmdffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uY2xvc2luZygpIGNhbGxlZC5cIik7dGhpcy5vbmNsb3NpbmdfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25jbG9zaW5nXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGIuaXNOdWxsQ2FsbGJhY2soYSksZS5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5vbmNsb3NpbmcpO2MudGhlbihmdW5jdGlvbihhKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLm9uY2xvc2luZyBjYWxsYmFjayByZWNlaXZlZCEhIVwiKTthPW5ldyBFdmVudChcIm9uY2xvc2luZ1wiKTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcInRhcmdldFwiLHt3cml0YWJsZTohMSx2YWx1ZTpifSk7Yi5vbmNsb3NpbmdfKGEpfSk7cmV0dXJuIGIucmVtb3RlSW52b2tlKCEwLGUubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3Qub25jbG9zaW5nLGMuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uY2xvc2luZygpIGZhaWxlZC5cIil9KX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbmNsb3NlXCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfb25jbG9zZSgpIGNhbGxlZC5cIik7cmV0dXJuIHRoaXMub25jbG9zZV99LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuc2V0X29uY2xvc2UoKSBjYWxsZWQuXCIpO3RoaXMub25jbG9zZV89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmNsb3NlXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGIuaXNOdWxsQ2FsbGJhY2soYSksZS5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5vbmNsb3NlKTtjLnRoZW4oZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uY2xvc2UgY2FsbGJhY2sgcmVjZWl2ZWQhISFcIik7YT1uZXcgRXZlbnQoXCJvbmNsb3NlXCIpO09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwidGFyZ2V0XCIse3dyaXRhYmxlOiExLHZhbHVlOmJ9KTtiLm9uY2xvc2VfKGEpfSk7cmV0dXJuIGIucmVtb3RlSW52b2tlKCEwLGUubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3Qub25jbG9zZSxjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIub25jbG9zZSgpIGZhaWxlZC5cIil9KX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbm1lc3NhZ2VcIix7Z2V0OmZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9vbm1lc3NhZ2UoKSBjYWxsZWQuXCIpO3JldHVybiB0aGlzLm9ubWVzc2FnZV99LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25tZXNzYWdlKCkgY2FsbGVkLlwiKTt0aGlzLm9ubWVzc2FnZV89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbm1lc3NhZ2VcIikudGhlbihmdW5jdGlvbigpe3ZhciBjPWIucmVnaXN0ZXJDYWxsYmFja3MoITEsYi5pc051bGxDYWxsYmFjayhhKSxlLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90Lm9ubWVzc2FnZSk7Yy50aGVuKGZ1bmN0aW9uKGEpe20ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIub25tZXNzYWdlIGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO3ZhciBjPWIucGFyYW0wKGEpO2E9bmV3IEV2ZW50KFwib25tZXNzYWdlXCIpO2MuYmluYXJ5P2EuZGF0YT1jLmRhdGFfYWI6KGM9YXRvYihjLmRhdGFfc3opLGEuZGF0YT1jKTtiLm9ubWVzc2FnZV8oYSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsZS5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5vbm1lc3NhZ2UsYy5zdWNjZXNzKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25tZXNzYWdlKCkgZmFpbGVkLlwiKX0pfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmNsb3NlPWZ1bmN0aW9uKCl7dmFyIGE9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY2xvc2UoKSBjYWxsZWQuXCIpO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiUlRDRGF0YUNoYW5uZWwuY2xvc2VcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBhLnJlbW90ZUludm9rZSghMSxcclxuZS5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5jbG9zZSl9KS50aGVuKGZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmNsb3NlOiBzdWNjZXNzLlwiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY2xvc2U6IGZhaWxlZC5cIil9KX07Yi5wcm90b3R5cGUudG9CeXRlQXJyYXk9ZnVuY3Rpb24oYSl7dmFyIGI9W107YT1uZXcgVWludDhBcnJheShhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXI/YTphLmJ1ZmZlcik7Zm9yKHZhciBjIGluIGEpYi5wdXNoKGFbY10pO3JldHVybiBifTtiLnByb3RvdHlwZS5zZW5kPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNlbmQoKSBjYWxsZWQuXCIpO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiUlRDRGF0YUNoYW5uZWwuc2VuZFwiKS50aGVuKGZ1bmN0aW9uKCl7aWYoXCJzdHJpbmdcIj09PXR5cGVvZiBhKXJldHVybiBtLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiZGF0YShzdHJpbmcpOiBcIithKSxiLnJlbW90ZUludm9rZSghMSxlLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90LnNlbmRfdGV4dCxhKTtpZihhIGluc3RhbmNlb2YgQmxvYilhLmFycmF5QnVmZmVyKCkudGhlbihmdW5jdGlvbihhKXthPWIudG9CeXRlQXJyYXkoYSk7cmV0dXJuIGIucmVtb3RlSW52b2tlKCExLGUubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3Quc2VuZF9iaW5hcnksYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLmFycmF5QnVmZmVyKCk6IGZhaWxlZC5cIil9KTtlbHNle3ZhciBjPWIudG9CeXRlQXJyYXkoYSk7cmV0dXJuIGIucmVtb3RlSW52b2tlKCExLGUubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3Quc2VuZF9iaW5hcnksYyl9fSkudGhlbihmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZW5kOiBzdWNjZXNzLlwiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLnNlbmQ6IGZhaWxlZC5cIil9KX07Yi5wcm90b3R5cGUudG9SVENEYXRhQ2hhbm5lbFN0YXRlPWZ1bmN0aW9uKGEpe3ZhciBiPVwiY2xvc2VkXCI7YT09Zy5jb25uZWN0aW5nP2I9XCJjb25uZWN0aW5nXCI6YT09Zy5vcGVuP2I9XCJvcGVuXCI6YT09Zy5jbG9zaW5nP2I9XCJjbG9zaW5nXCI6YT09Zy5jbG9zZWQmJihiPVwiY2xvc2VkXCIpO3JldHVybiBifTtyZXR1cm4gYn0obi5Qcm94eU9iamVjdCk7YS5SdGNEYXRhQ2hhbm5lbD1ifSw1ODk6ZnVuY3Rpb24oYixhLGMpe3ZhciBkPXRoaXMmJnRoaXMuX19leHRlbmRzfHxmdW5jdGlvbigpe3ZhciBhPWZ1bmN0aW9uKGIsYyl7YT1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oYSxiKXthLl9fcHJvdG9fXz1ifXx8ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGMgaW4gYiliLmhhc093blByb3BlcnR5KGMpJiYoYVtjXT1iW2NdKX07cmV0dXJuIGEoYixjKX07cmV0dXJuIGZ1bmN0aW9uKGIsYyl7ZnVuY3Rpb24gZCgpe3RoaXMuY29uc3RydWN0b3I9XHJcbmJ9YShiLGMpO2IucHJvdG90eXBlPW51bGw9PT1jP09iamVjdC5jcmVhdGUoYyk6KGQucHJvdG90eXBlPWMucHJvdG90eXBlLG5ldyBkKX19KCksZT10aGlzJiZ0aGlzLl9fYXdhaXRlcnx8ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIG5ldyAoY3x8KGM9UHJvbWlzZSkpKGZ1bmN0aW9uKGYsZyl7ZnVuY3Rpb24gZShhKXt0cnl7bihkLm5leHQoYSkpfWNhdGNoKGIpe2coYil9fWZ1bmN0aW9uIGgoYSl7dHJ5e24oZFtcInRocm93XCJdKGEpKX1jYXRjaChiKXtnKGIpfX1mdW5jdGlvbiBuKGEpe2EuZG9uZT9mKGEudmFsdWUpOihuZXcgYyhmdW5jdGlvbihiKXtiKGEudmFsdWUpfSkpLnRoZW4oZSxoKX1uKChkPWQuYXBwbHkoYSxifHxbXSkpLm5leHQoKSl9KX0saz10aGlzJiZ0aGlzLl9fZ2VuZXJhdG9yfHxmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGMoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBkKFthLGJdKX19ZnVuY3Rpb24gZChjKXtpZihnKXRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG5mb3IoO2Y7KXRyeXtpZihnPTEsZSYmKGg9Y1swXSYyP2VbXCJyZXR1cm5cIl06Y1swXT9lW1widGhyb3dcIl18fCgoaD1lW1wicmV0dXJuXCJdKSYmaC5jYWxsKGUpLDApOmUubmV4dCkmJiEoaD1oLmNhbGwoZSxjWzFdKSkuZG9uZSlyZXR1cm4gaDtpZihlPTAsaCljPVtjWzBdJjIsaC52YWx1ZV07c3dpdGNoKGNbMF0pe2Nhc2UgMDpjYXNlIDE6aD1jO2JyZWFrO2Nhc2UgNDpyZXR1cm4gZi5sYWJlbCsrLHt2YWx1ZTpjWzFdLGRvbmU6ITF9O2Nhc2UgNTpmLmxhYmVsKys7ZT1jWzFdO2M9WzBdO2NvbnRpbnVlO2Nhc2UgNzpjPWYub3BzLnBvcCgpO2YudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEoaD1mLnRyeXMsaD0wPGgubGVuZ3RoJiZoW2gubGVuZ3RoLTFdKSYmKDY9PT1jWzBdfHwyPT09Y1swXSkpe2Y9MDtjb250aW51ZX1pZigzPT09Y1swXSYmKCFofHxjWzFdPmhbMF0mJmNbMV08aFszXSkpZi5sYWJlbD1jWzFdO2Vsc2UgaWYoNj09PWNbMF0mJmYubGFiZWw8aFsxXSlmLmxhYmVsPVxyXG5oWzFdLGg9YztlbHNlIGlmKGgmJmYubGFiZWw8aFsyXSlmLmxhYmVsPWhbMl0sZi5vcHMucHVzaChjKTtlbHNle2hbMl0mJmYub3BzLnBvcCgpO2YudHJ5cy5wb3AoKTtjb250aW51ZX19Yz1iLmNhbGwoYSxmKX1jYXRjaChxKXtjPVs2LHFdLGU9MH1maW5hbGx5e2c9aD0wfWlmKGNbMF0mNSl0aHJvdyBjWzFdO3JldHVybnt2YWx1ZTpjWzBdP2NbMV06dm9pZCAwLGRvbmU6ITB9fXZhciBmPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZihoWzBdJjEpdGhyb3cgaFsxXTtyZXR1cm4gaFsxXX0sdHJ5czpbXSxvcHM6W119LGcsZSxoLG47JGpzY29tcC5pbml0U3ltYm9sKCk7JGpzY29tcC5pbml0U3ltYm9sKCk7JGpzY29tcC5pbml0U3ltYm9sSXRlcmF0b3IoKTtyZXR1cm4gbj17bmV4dDpjKDApLFwidGhyb3dcIjpjKDEpLFwicmV0dXJuXCI6YygyKX0sXCJmdW5jdGlvblwiPT09dHlwZW9mIFN5bWJvbCYmKG5bU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksbn07T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXHJcblwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBtPWMoNjU4KSxwPWMoNTUwKSxsPWMoODUxKSxnPWMoMTQ0KSxHPWMoNTE3KSx2PWMoNjUwKSx0PWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYyxkKXt2YXIgZj1hLmNhbGwodGhpcyxjLHAuY2xhc3NfaWRfdC5SVENEVE1GVG9uZUNoYW5nZUV2ZW50LGQsbS5Qcm94eU1vZGUuUmVtb3RlKXx8dGhpcztsLmxvZ2dlci5sb2coZi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY29uc3RydWN0b3JcIik7cmV0dXJuIGZ9ZChiLGEpO2IucHJvdG90eXBlLnN5bmNCYXJyaWVyPWZ1bmN0aW9uKCl7cmV0dXJuIGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIGEsYixjPXRoaXM7cmV0dXJuIGsodGhpcyxmdW5jdGlvbihkKXtzd2l0Y2goZC5sYWJlbCl7Y2FzZSAwOnJldHVybiBsLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIoKSBjYWxsZWQuXCIpLFs0LHRoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiRFRNRlRvbmVDaGFuZ2VFdmVudC5zeW5jQmFycmllclwiKV07XHJcbmNhc2UgMTpyZXR1cm4gZC5zZW50KCksWzQsUHJvbWlzZS5hbGwoW3RoaXMucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX1JUQ0RUTUZUb25lQ2hhbmdlRXZlbnRfdC50b25lLFwiXCIpLHRoaXMucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX1JUQ0RUTUZUb25lQ2hhbmdlRXZlbnRfdC50b25lX2J1ZmZlcixcIlwiKV0pXTtjYXNlIDI6cmV0dXJuIGI9ZC5zZW50KCksYT1iLm1hcChmdW5jdGlvbihhKXtyZXR1cm4gYy5wYXJhbTAoYSl9KSx0aGlzLnRvbmU9YVswXSx0aGlzLnRvbmVfYnVmZmVyXz1hWzFdLFsyLHRoaXNdfX0pfSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInRvbmVfYnVmZmVyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRvbmVfYnVmZmVyX30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtyZXR1cm4gYn0obS5Qcm94eU9iamVjdCk7YS5EVE1GVG9uZUNoYW5nZUV2ZW50PXQ7dmFyIHo9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjLFxyXG5kKXt2YXIgZj1hLmNhbGwodGhpcyxjLHAuY2xhc3NfaWRfdC5SVENEVE1GU2VuZGVyLGQsbS5Qcm94eU1vZGUuUmVtb3RlKXx8dGhpcztsLmxvZ2dlci5sb2coZi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY29uc3RydWN0b3JcIik7Zi5jYW5JbnNlcnREVE1GPSEwO2YudG9uZUJ1ZmZlcl89XCJcIjtyZXR1cm4gZn1kKGIsYSk7Yi5wcm90b3R5cGUuaW5zZXJ0RFRNRj1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpczt2b2lkIDA9PT1iJiYoYj0xMDApO3ZvaWQgMD09PWMmJihjPTcwKTtsLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuaW5zZXJ0RFRNRigpIGNhbGxlZCwgdG9uZXM6IFwiK2EpO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiRHRtZlNlbmRlci5pbnNlcnREVE1GXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gZC5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfUlRDRFRNRlNlbmRlcl90Lmluc2VydERUTUYsYSxiLGMpfSkudGhlbihmdW5jdGlvbigpe2wubG9nZ2VyLmxvZyhkLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuaW5zZXJ0RFRNRigpIHN1Y2Nlc3MsIHRvbmVzOiBcIithKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7ZC5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLmluc2VydERUTUYoKSBmYWlsZWQhXCIpfSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9udG9uZWNoYW5nZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbnRvbmVjaGFuZ2VffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztsLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29udG9uZWNoYW5nZSgpIGNhbGxlZC5cIik7dGhpcy5vbnRvbmVjaGFuZ2VfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJEdG1mU2VuZGVyLm9udG9uZWNoYW5nZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLHAubWV0aG9kX2lkX1JUQ0RUTUZTZW5kZXJfdC5vbnRvbmVjaGFuZ2UpO2MudGhlbihmdW5jdGlvbihhKXtsLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLm9udG9uZWNoYW5nZSBjYWxsYmFjayByZWNlaXZlZCFcIik7KG5ldyB0KGIsYi5wYXJhbTAoYSkub2lkKSkuc3luY0JhcnJpZXIoKS50aGVuKGZ1bmN0aW9uKGEpe2wubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcInRvbmU6IFwiK2EudG9uZStcIiB0b25lX2J1ZmZlcjogXCIrYS50b25lX2J1ZmZlcik7Yi50b25lQnVmZmVyXz1hLnRvbmVfYnVmZmVyO2Iub250b25lY2hhbmdlXyhhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnRvbmVFdnQuc3luY0JhcnJpZXIoKSBmYWlsZWQhXCIpfSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAscC5tZXRob2RfaWRfUlRDRFRNRlNlbmRlcl90Lm9udG9uZWNoYW5nZSxjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0X29udG9uZWNoYW5nZSgpIGZhaWxlZCFcIil9KX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXHJcblwidG9uZUJ1ZmZlclwiLHtnZXQ6ZnVuY3Rpb24oKXtsLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIudG9uZUJ1ZmZlcigpIGNhbGxlZC5cIik7cmV0dXJuIHRoaXMudG9uZUJ1ZmZlcl99LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7cmV0dXJuIGJ9KG0uUHJveHlPYmplY3QpO2EuRHRtZlNlbmRlcj16O3ZhciB1PWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYyxkKXt2YXIgZj1hLmNhbGwodGhpcyxjLHAuY2xhc3NfaWRfdC5SVENJY2VUcmFuc3BvcnQsZCxtLlByb3h5TW9kZS5SZW1vdGUpfHx0aGlzO2wubG9nZ2VyLmxvZyhmLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jb25zdHJ1Y3RvclwiKTtmLnNlbGVjdGVkUGFpcj1udWxsO2YubG9jYWxDYW5kaWRhdGVzXz1bXTtmLnJlbW90ZUNhbmRpZGF0ZXNfPVtdO3JldHVybiBmfWQoYixhKTtiLnByb3RvdHlwZS5zeW5jQmFycmllcj1mdW5jdGlvbigpe3ZhciBhPXRoaXM7bC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5zeW5jQmFycmllcigpIGNhbGxlZC5cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsZCl7YS53YWl0VW50aWxDb25uZWN0ZWQoXCJJY2VUcmFuc3BvcnQuc3luY0JhcnJpZXJcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfUlRDSWNlVHJhbnNwb3J0X3Qucm9sZSwwKSxhLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9SVENJY2VUcmFuc3BvcnRfdC5jb21wb25lbnQsMCksYS5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfUlRDSWNlVHJhbnNwb3J0X3Quc3RhdGUsMCksYS5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfUlRDSWNlVHJhbnNwb3J0X3QuZ2F0aGVyaW5nU3RhdGUsMCldKX0pLnRoZW4oZnVuY3Rpb24oZCl7bC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyIHN1Y2Nlc3MuXCIpO3ZhciBmPTAsaD0wO2Q9ZC5tYXAoZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyYW0wKGIpfSk7XHJcbmEucm9sZV89ZFswXTthLmNvbXBvbmVudF89ZFsxXTtmPWRbMl07aD1kWzNdO2Euc3RhdGVfPWIuY29udmVydFN0YXRlKGYpO2EuZ2F0aGVyaW5nU3RhdGVfPWIuY29udmVydEdhdGhlcmluZ1N0YXRlKGgpO2MoYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2I9YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLnN5bmNCYXJyaWVyKCkgZmFpbGVkIVwiKTtkKGIpfSl9KX07Yi5wcm90b3R5cGUuc3luY0NhbmRpZGF0ZXM9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2wubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQ2FuZGlkYXRlcygpIGNhbGxlZC5cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGIsYyl7YS53YWl0VW50aWxDb25uZWN0ZWQoXCJJY2VUcmFuc3BvcnQuc3luY0NhbmRpZGF0ZXNcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfUlRDSWNlVHJhbnNwb3J0X3QubG9jYWxjYW5kaWRhdGVzLFxyXG5bXSksYS5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfUlRDSWNlVHJhbnNwb3J0X3QucmVtb3RlY2FuZGlkYXRlcyxbXSldKX0pLnRoZW4oZnVuY3Rpb24oYyl7bC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNDYW5kaWRhdGVzIHN1Y2Nlc3MuXCIpO2M9Yy5tYXAoZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyYW0wKGIpfSk7YS5sb2NhbENhbmRpZGF0ZXNfPWNbMF07YS5yZW1vdGVDYW5kaWRhdGVzXz1jWzFdO2IoYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2I9YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLnN5bmNDYW5kaWRhdGVzKCkgZmFpbGVkIVwiKTtjKGIpfSl9KX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwicm9sZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yb2xlX30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJjb21wb25lbnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29tcG9uZW50X30sXHJcbmVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwiU3RhdGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdGVffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImdhdGhlcmluZ1N0YXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdhdGhlcmluZ1N0YXRlX30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbnN0YXRlY2hhbmdlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9uc3RhdGVjaGFuZ2VffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcztsLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uc3RhdGVjaGFuZ2UoKSBjYWxsZWQuXCIpO3RoaXMub25zdGF0ZWNoYW5nZV89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIkljZVRyYW5zcG9ydC5vbnN0YXRlY2hhbmdlXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgZD1cclxuYy5yZWdpc3RlckNhbGxiYWNrcyghMSxjLmlzTnVsbENhbGxiYWNrKGEpLHAubWV0aG9kX2lkX1JUQ0ljZVRyYW5zcG9ydF90Lm9uc3RhdGVjaGFuZ2UpO2QudGhlbihmdW5jdGlvbihhKXtsLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25zdGF0ZWNoYW5nZSBjYWxsYmFjayByZWNlaXZlZCFcIik7Yy5zeW5jQ2FuZGlkYXRlcygpLnRoZW4oZnVuY3Rpb24oYSl7bC5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wicmVjZWl2ZWQgdXBkYXRlZCBpY2UgY2FuZGlkYXRlcyFcIil9KTtjLnN0YXRlXz1iLmNvbnZlcnRTdGF0ZShjLnBhcmFtMChhKSk7bC5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wic3RhdGU6IFwiK2Muc3RhdGVfKTtjLm9uc3RhdGVjaGFuZ2VfKCl9KTtyZXR1cm4gYy5yZW1vdGVJbnZva2UoITAscC5tZXRob2RfaWRfUlRDSWNlVHJhbnNwb3J0X3Qub25zdGF0ZWNoYW5nZSxkLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtjLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXHJcblwiLnNldF9vbnN0YXRlY2hhbmdlIGZhaWxlZCFcIil9KX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbmdhdGhlcmluZ3N0YXRlY2hhbmdlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9uZ2F0aGVyaW5nc3RhdGVjaGFuZ2VffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcztsLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uZ2F0aGVyaW5nc3RhdGVjaGFuZ2UoKSBjYWxsZWQuXCIpO3RoaXMub25nYXRoZXJpbmdzdGF0ZWNoYW5nZV89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIkljZVRyYW5zcG9ydC5vbmdhdGhlcmluZ3N0YXRlY2hhbmdlXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgZD1jLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGMuaXNOdWxsQ2FsbGJhY2soYSkscC5tZXRob2RfaWRfUlRDSWNlVHJhbnNwb3J0X3Qub25nYXRoZXJpbmdzdGF0ZWNoYW5nZSk7ZC50aGVuKGZ1bmN0aW9uKGEpe2wubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIub25nYXRoZXJpbmdzdGF0ZWNoYW5nZSBjYWxsYmFjayByZWNlaXZlZCFcIik7Yy5zeW5jQ2FuZGlkYXRlcygpLnRoZW4oZnVuY3Rpb24oYSl7bC5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wicmVjZWl2ZWQgdXBkYXRlZCBpY2UgY2FuZGlkYXRlcyFcIil9KTtjLmdhdGhlcmluZ1N0YXRlXz1iLmNvbnZlcnRHYXRoZXJpbmdTdGF0ZShjLnBhcmFtMChhKSk7bC5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiZ2F0aGVyaW5nU3RhdGU6IFwiK2MuZ2F0aGVyaW5nU3RhdGVfKTtjLm9uZ2F0aGVyaW5nc3RhdGVjaGFuZ2VfKCl9KTtyZXR1cm4gYy5yZW1vdGVJbnZva2UoITAscC5tZXRob2RfaWRfUlRDSWNlVHJhbnNwb3J0X3Qub25nYXRoZXJpbmdzdGF0ZWNoYW5nZSxkLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtjLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0X29uZ2F0aGVyaW5nc3RhdGVjaGFuZ2UgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiEwLFxyXG5jb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbnNlbGVjdGVkY2FuZGlkYXRlcGFpcmNoYW5nZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbnNlbGVjdGVkY2FuZGlkYXRlcGFpcmNoYW5nZV99LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2wubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25zZWxlY3RlZGNhbmRpZGF0ZXBhaXJjaGFuZ2UoKSBjYWxsZWQuXCIpO3RoaXMub25zZWxlY3RlZGNhbmRpZGF0ZXBhaXJjaGFuZ2VfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJJY2VUcmFuc3BvcnQub25zZWxlY3RlZGNhbmRpZGF0ZXBhaXJjaGFuZ2VcIikudGhlbihmdW5jdGlvbigpe3ZhciBjPWIucmVnaXN0ZXJDYWxsYmFja3MoITEsYi5pc051bGxDYWxsYmFjayhhKSxwLm1ldGhvZF9pZF9SVENJY2VUcmFuc3BvcnRfdC5vbnNlbGVjdGVkY2FuZGlkYXRlcGFpcmNoYW5nZSk7Yy50aGVuKGZ1bmN0aW9uKGEpe2wubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIub25zZWxlY3RlZGNhbmRpZGF0ZXBhaXJjaGFuZ2UgY2FsbGJhY2sgcmVjZWl2ZWQhXCIpO2Iuc3luY0NhbmRpZGF0ZXMoKS50aGVuKGZ1bmN0aW9uKGEpe2wubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcInJlY2VpdmVkIHVwZGF0ZWQgaWNlIGNhbmRpZGF0ZXMhXCIpfSk7Yi5zZWxlY3RlZFBhaXI9Yi5wYXJhbTAoYSk7bC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wic2VsZWN0ZWRQYWlyOiBcIitiLnNlbGVjdGVkUGFpcik7Yi5vbnNlbGVjdGVkY2FuZGlkYXRlcGFpcmNoYW5nZV8oKX0pO3JldHVybiBiLnJlbW90ZUludm9rZSghMCxwLm1ldGhvZF9pZF9SVENJY2VUcmFuc3BvcnRfdC5vbnNlbGVjdGVkY2FuZGlkYXRlcGFpcmNoYW5nZSxjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0X29uc2VsZWN0ZWRjYW5kaWRhdGVwYWlyY2hhbmdlIGZhaWxlZCFcIil9KX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtcclxuYi5wcm90b3R5cGUuZ2V0TG9jYWxDYW5kaWRhdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubG9jYWxDYW5kaWRhdGVzX307Yi5wcm90b3R5cGUuZ2V0UmVtb3RlQ2FuZGlkYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlbW90ZUNhbmRpZGF0ZXNffTtiLnByb3RvdHlwZS5nZXRMb2NhbFBhcmFtZXRlcnM9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH07Yi5wcm90b3R5cGUuZ2V0UmVtb3RlUGFyYW1ldGVycz1mdW5jdGlvbigpe3JldHVybiBudWxsfTtiLnByb3RvdHlwZS5nZXRTZWxlY3RlZENhbmRpZGF0ZVBhaXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWxlY3RlZFBhaXJ9O2IuY29udmVydFN0YXRlPWZ1bmN0aW9uKGEpe3JldHVybiAwPT1hP1wibmV3XCI6MT09YT9cImNoZWNraW5nXCI6Mj09YT9cImNvbm5lY3RlZFwiOjM9PWE/XCJjb21wbGV0ZWRcIjo0PT1hP1wiZmFpbGVkXCI6NT09YT9cImRpc2Nvbm5lY3RlZFwiOlwiY2xvc2VkXCJ9O2IuY29udmVydEdhdGhlcmluZ1N0YXRlPWZ1bmN0aW9uKGEpe3JldHVybiAwPT1cclxuYT9cIm5ld1wiOjE9PWE/XCJnYXRoZXJpbmdcIjpcImNvbXBsZXRlXCJ9O3JldHVybiBifShtLlByb3h5T2JqZWN0KTthLkljZVRyYW5zcG9ydD11O3ZhciBmOyhmdW5jdGlvbihhKXthW2FbXCJuZXdcIl09MF09XCJuZXdcIjthW2EuY29ubmVjdGluZz0xXT1cImNvbm5lY3RpbmdcIjthW2EuY29ubmVjdGVkPTJdPVwiY29ubmVjdGVkXCI7YVthLmNsb3NlZD0zXT1cImNsb3NlZFwiO2FbYS5mYWlsZWQ9NF09XCJmYWlsZWRcIjthW2EubWF4PTVdPVwibWF4XCJ9KShmfHwoZj17fSkpO3ZhciBBPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYyxkKXt2YXIgZj1hLmNhbGwodGhpcyxjLHAuY2xhc3NfaWRfdC5SVENEdGxzVHJhbnNwb3J0LGQsbS5Qcm94eU1vZGUuUmVtb3RlKXx8dGhpcztsLmxvZ2dlci5sb2coZi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY29uc3RydWN0b3JcIik7Zi5zdGF0ZV89XCJuZXdcIjtmLnRyYW5zcG9ydF89bnVsbDtmLnJlbW90ZUNlcnRpZmljYXRlc189W107cmV0dXJuIGZ9ZChiLGEpO2IucHJvdG90eXBlLmR1bXBJbmZvPVxyXG5mdW5jdGlvbigpe2wubG9nZ2VyLmxvZyhcIkR0bHNUcmFuc3BvcnRbXCIrdGhpcy5vYmplY3RfaWQoKStcIl0uZHVtcEluZm8oKTpcIik7bC5sb2dnZXIubG9nKFwiICAgIC0gc3RhdGU6XCIrdGhpcy5zdGF0ZV8pO2wubG9nZ2VyLmxvZyhcIiAgICAtIHRyYW5zcG9ydDpcIit0aGlzLnRyYW5zcG9ydF8pfTtiLnByb3RvdHlwZS5zeW5jQmFycmllcj1mdW5jdGlvbigpe3ZhciBhPXRoaXM7bC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyKCkgY2FsbGVkLlwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxkKXthLndhaXRVbnRpbENvbm5lY3RlZChcIkR0bHNUcmFuc3BvcnQuc3luY0JhcnJpZXJcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfUlRDRHRsc1RyYW5zcG9ydF90LnRyYW5zcG9ydCx7fSksYS5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfUlRDRHRsc1RyYW5zcG9ydF90LnN0YXRlLFxyXG4wKSxhLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9SVENEdGxzVHJhbnNwb3J0X3QuZ2V0UmVtb3RlQ2VydGlmaWNhdGVzLFtdKV0pfSkudGhlbihmdW5jdGlvbihmKXt2YXIgZztsLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIgcmVtb3RlIHN1Y2Nlc3MuXCIpO3ZhciBoO2c9Zi5tYXAoZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyYW0wKGIpfSk7Zj1nWzBdO2g9Z1sxXTthLnJlbW90ZUNlcnRpZmljYXRlc189Z1syXTthLnN0YXRlXz1iLmNvbnZlcnRTdGF0ZShoKTtnPVtdO3ZvaWQgMD09Znx8MCE9Zi5pc19udWxsfHxudWxsIT09YS50cmFuc3BvcnRfJiZhLnRyYW5zcG9ydF8ub2JqZWN0X2lkKCk9PWYub2lkfHwoYS50cmFuc3BvcnRfPW5ldyB1KGEsZi5vaWQpLGcucHVzaChhLnRyYW5zcG9ydF8uc3luY0JhcnJpZXIoKSkpO1Byb21pc2UuYWxsKGcpLnRoZW4oZnVuY3Rpb24oKXtsLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIgc3VjY2Vzc1wiKTtcclxuYyhhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7Yj1hLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIucHJvcC5zeW5jQmFycmllciBmYWlsZWQhXCIpO2QoYil9KX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7Yj1hLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuc3luY0JhcnJpZXIgZmFpbGVkIVwiKTtkKGIpfSl9KX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwidHJhbnNwb3J0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRyYW5zcG9ydF99LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwic3RhdGVcIix7Z2V0OmZ1bmN0aW9uKCl7bC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9zdGF0ZSgpIGNhbGxlZDogXCIrdGhpcy5zdGF0ZV8pO3JldHVybiB0aGlzLnN0YXRlX30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtiLnByb3RvdHlwZS5nZXRSZW1vdGVDZXJ0aWZpY2F0ZXM9XHJcbmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVtb3RlQ2VydGlmaWNhdGVzX307T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25zdGF0ZWNoYW5nZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbnN0YXRlY2hhbmdlX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXM7bC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbnN0YXRlY2hhbmdlKCkgY2FsbGVkLlwiKTt0aGlzLm9uc3RhdGVjaGFuZ2VfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJEdGxzVHJhbnNwb3J0Lm9uc3RhdGVjaGFuZ2VcIikudGhlbihmdW5jdGlvbigpe3ZhciBkPWMucmVnaXN0ZXJDYWxsYmFja3MoITEsYy5pc051bGxDYWxsYmFjayhhKSxwLm1ldGhvZF9pZF9SVENEdGxzVHJhbnNwb3J0X3Qub25zdGF0ZWNoYW5nZSk7ZC50aGVuKGZ1bmN0aW9uKGEpe2wubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbnN0YXRlY2hhbmdlIGNhbGxiYWNrIHJlY2VpdmVkIVwiKTtcclxuYy5zdGF0ZV89Yi5jb252ZXJ0U3RhdGUoYy5wYXJhbTAoYSkpO2wubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcInN0YXRlXzogXCIrYy5zdGF0ZV8pO2Mub25zdGF0ZWNoYW5nZV8oKX0pO3JldHVybiBjLnJlbW90ZUludm9rZSghMCxwLm1ldGhvZF9pZF9SVENEdGxzVHJhbnNwb3J0X3Qub25zdGF0ZWNoYW5nZSxkLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtjLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0X29uc3RhdGVjaGFuZ2UgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9uZXJyb3JcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub25lcnJvcl99LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2wubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25lcnJvcigpIGNhbGxlZC5cIik7dGhpcy5vbmVycm9yXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiRHRsc1RyYW5zcG9ydC5vbmVycm9yXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1cclxuYi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLHAubWV0aG9kX2lkX1JUQ0R0bHNUcmFuc3BvcnRfdC5vbmVycm9yKTtjLnRoZW4oZnVuY3Rpb24oYSl7bC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uZXJyb3IgY2FsbGJhY2sgcmVjZWl2ZWQhXCIpO2E9Yi5wYXJhbTAoYSk7bC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiZXJyb3I6IFwiK2EpO2Iub25lcnJvcl8oYSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAscC5tZXRob2RfaWRfUlRDRHRsc1RyYW5zcG9ydF90Lm9uZXJyb3IsYy5zdWNjZXNzKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnNldF9vbmVycm9yIGZhaWxlZCFcIil9KX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtiLmNvbnZlcnRTdGF0ZT1mdW5jdGlvbihhKXtyZXR1cm4gYT09ZltcIm5ld1wiXT9cIm5ld1wiOmE9PWYuY29ubmVjdGluZz9cImNvbm5lY3RpbmdcIjpcclxuYT09Zi5jb25uZWN0ZWQ/XCJjb25uZWN0ZWRcIjphPT1mLmNsb3NlZD9cImNsb3NlZFwiOlwiZmFpbGVkXCJ9O3JldHVybiBifShtLlByb3h5T2JqZWN0KTthLkR0bHNUcmFuc3BvcnQ9QTtiPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYyxkLGYsZyl7Yz1hLmNhbGwodGhpcyxjLGQsZixnKXx8dGhpcztsLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY29uc3RydWN0b3IgYmFzZVwiKTtjLnRyYWNrXz1udWxsO2MudHJhbnNwb3J0Xz1udWxsO2MucnRjcFRyYW5zcG9ydF89bnVsbDtyZXR1cm4gY31kKGIsYSk7Yi5wcm90b3R5cGUuc3luY0JhcnJpZXJCYXNlPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztsLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXJCYXNlKCkgY2FsbGVkLlwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixjKXt2YXIgZCxmLGg7YSBpbnN0YW5jZW9mIHg/KGQ9cC5tZXRob2RfaWRfUlRDUnRwU2VuZGVyX3QudHJhY2ssZj1cclxucC5tZXRob2RfaWRfUlRDUnRwU2VuZGVyX3QudHJhbnNwb3J0LGg9cC5tZXRob2RfaWRfUlRDUnRwU2VuZGVyX3QucnRjcFRyYW5zcG9ydCk6YSBpbnN0YW5jZW9mIEQmJihkPXAubWV0aG9kX2lkX1JUQ1J0cFJlY2VpdmVyX3QudHJhY2ssZj1wLm1ldGhvZF9pZF9SVENSdHBSZWNlaXZlcl90LnRyYW5zcG9ydCxoPXAubWV0aG9kX2lkX1JUQ1J0cFJlY2VpdmVyX3QucnRjcFRyYW5zcG9ydCk7YS53YWl0VW50aWxDb25uZWN0ZWQoXCJSdHBTZW5kZXJSZWNlaXZlci5zeW5jQmFycmllckJhc2VcIikudGhlbihmdW5jdGlvbigpe3JldHVybiB2LlJlbW90ZVNlc3Npb24uaXNGZWF0dXJlUHN0blN1cHBvcnRlZCgpJiZ2LlJlbW90ZVNlc3Npb24uaXNGZWF0dXJlRHRtZlN1cHBvcnRlZCgpP1Byb21pc2UuYWxsKFthLnJlbW90ZUludm9rZSghMSxkLHtvaWQ6YS5vYmplY3RfaWQoKX0pLGEucmVtb3RlSW52b2tlKCExLGYse29pZDphLm9iamVjdF9pZCgpfSksYS5yZW1vdGVJbnZva2UoITEsaCxcclxue29pZDphLm9iamVjdF9pZCgpfSldKTpQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEsZCx7b2lkOmEub2JqZWN0X2lkKCl9KV0pfSkudGhlbihmdW5jdGlvbihkKXt2YXIgaDtsLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXJCYXNlIHJlbW90ZSBzdWNjZXNzLlwiKTt2YXIgZjtoPWQubWFwKGZ1bmN0aW9uKGIpe3JldHVybiBhLnBhcmFtMChiKX0pO2Q9aFswXTtmPWhbMV07aD1oWzJdO3ZhciBlPVtdO3ZvaWQgMCE9ZCYmITE9PT1kLmlzX251bGwmJihudWxsPT09YS50cmFja198fGEudHJhY2tfLm9iamVjdF9pZCgpIT1kLm9pZD9hLnRyYWNrXz1uZXcgZy5SZW1vdGVNZWRpYVRyYWNrKGEsZC5vaWQpOmEudHJhY2tfLmJpbmQoYSxkLm9pZCksZS5wdXNoKGEudHJhY2suc3luY0JhcnJpZXIoKSkpO3ZvaWQgMD09Znx8ITEhPT1mLmlzX251bGx8fG51bGwhPT1hLnRyYW5zcG9ydF8mJmEudHJhbnNwb3J0Xy5vYmplY3RfaWQoKT09Zi5vaWR8fChhLnRyYW5zcG9ydF89XHJcbm5ldyBBKGEsZi5vaWQpLGUucHVzaChhLnRyYW5zcG9ydF8uc3luY0JhcnJpZXIoKSkpO3ZvaWQgMD09aHx8ITEhPT1oLmlzX251bGx8fG51bGwhPT1hLnJ0Y3BUcmFuc3BvcnRfJiZhLnJ0Y3BUcmFuc3BvcnRfLm9iamVjdF9pZCgpPT1oLm9pZHx8KGEucnRjcFRyYW5zcG9ydF89bmV3IEEoYSxoLm9pZCksZS5wdXNoKGEucnRjcFRyYW5zcG9ydF8uc3luY0JhcnJpZXIoKSkpO1Byb21pc2UuYWxsKGUpLnRoZW4oZnVuY3Rpb24oKXtsLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucHJvcC5zeW5jQmFycmllckJhc2Ugc3VjY2Vzc1wiKTtiKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtiPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5wcm9wLnN5bmNCYXJyaWVyQmFzZSBmYWlsZWQhXCIpO2MoYil9KX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7Yj1hLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuc3luY0JhcnJpZXJCYXNlKCkgZmFpbGVkIVwiKTtjKGIpfSl9KX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFxyXG5cInRyYW5zcG9ydFwiLHtnZXQ6ZnVuY3Rpb24oKXtsLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0IHRyYW5zcG9ydCgpIGNhbGxlZC5cIik7cmV0dXJuIHRoaXMudHJhbnNwb3J0X30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJydGNwVHJhbnNwb3J0XCIse2dldDpmdW5jdGlvbigpe2wubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXQgcnRjcFRyYW5zcG9ydCgpIGNhbGxlZC5cIik7cmV0dXJuIHRoaXMucnRjcFRyYW5zcG9ydF99LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwidHJhY2tcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHJhY2tffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLnJlaW5pdFRyYWNrPWZ1bmN0aW9uKGEpe3RoaXMudHJhY2tfPVxyXG5hfTtiLnByb3RvdHlwZS5nZXRTdGF0cz1mdW5jdGlvbigpe2wubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRTdGF0cygpIGNhbGxlZC5cIik7dmFyIGE9dGhpcztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixjKXt2YXIgZD10aGlzO2EuaXNSZWRpcmVjdGVkKCk/YS53YWl0VW50aWxDb25uZWN0ZWQoXCJSdHBSZWNlaXZlci5nZXRTdGF0c1wiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM7ZCBpbnN0YW5jZW9mIHg/Yz1wLm1ldGhvZF9pZF9SVENSdHBTZW5kZXJfdC5nZXRTdGF0czpkIGluc3RhbmNlb2YgRCYmKGM9cC5tZXRob2RfaWRfUlRDUnRwUmVjZWl2ZXJfdC5nZXRTdGF0cyk7dmFyIGg9YS5yZWdpc3RlckNhbGxiYWNrcyghMCwhMSxjKTtoLnRoZW4oZnVuY3Rpb24oYSl7dm9pZCAwIT09YS5wYXJhbXMmJjAhPT1hLnBhcmFtcy5sZW5ndGgmJmIoRy5TdGF0c1JlcG9ydC5mcm9tSlNPTihKU09OLnBhcnNlKGEucGFyYW1zWzBdKSkpfSk7cmV0dXJuIGEucmVtb3RlSW52b2tlKCExLFxyXG5jLGguc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9ZC5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLmdldFN0YXRzKCkgZmFpbGVkIVwiKTtjKGEpfSk6KGwubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRTdGF0cygpOiBub3QgaW4gYWN0aXZlIHJlZGlyZWN0aW9uIVwiKSxiKCkpfSl9O3JldHVybiBifShtLlByb3h5T2JqZWN0KTthLlJ0cFNlbmRlclJlY2VpdmVyPWI7dmFyIHg9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjLGQsZixnKXtjPWEuY2FsbCh0aGlzLGMscC5jbGFzc19pZF90LlJUQ1J0cFNlbmRlcixkLGYpfHx0aGlzO2wubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jb25zdHJ1Y3RvclwiKTtjLmR0bWZfPW51bGw7Yy5wYXJhbXNfPW51bGw7Yy51bmlmaWVkXz1nO3JldHVybiBjfWQoYixhKTtiLnByb3RvdHlwZS5kdW1wSW5mbz1mdW5jdGlvbigpe2wubG9nZ2VyLmxvZyhcIlJ0cFNlbmRlcltcIit0aGlzLm9iamVjdF9pZCgpK1wiXS5kdW1wSW5mbygpOlwiKTtcclxudGhpcy50cmFjayYmdGhpcy50cmFjay5kdW1wSW5mbygpfTtiLnByb3RvdHlwZS5zeW5jQmFycmllcj1mdW5jdGlvbigpe3ZhciBiPXRoaXM7bC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyKCkgY2FsbGVkLlwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxkKXtiLndhaXRVbnRpbENvbm5lY3RlZChcIlJ0cFNlbmRlci5zeW5jQmFycmllclwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGEucHJvdG90eXBlLnN5bmNCYXJyaWVyQmFzZS5jYWxsKGIpfSkudGhlbihmdW5jdGlvbigpe2wubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllckJhc2Ugc3VjY2Vzcy5cIik7cmV0dXJuIHYuUmVtb3RlU2Vzc2lvbi5pc0ZlYXR1cmVQc3RuU3VwcG9ydGVkKCkmJnYuUmVtb3RlU2Vzc2lvbi5pc0ZlYXR1cmVEdG1mU3VwcG9ydGVkKCk/UHJvbWlzZS5hbGwoW2IucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX1JUQ1J0cFNlbmRlcl90LmR0bWYsXHJcbntvaWQ6Yi5vYmplY3RfaWQoKX0pLGIucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX1JUQ1J0cFNlbmRlcl90LmdldFBhcmFtZXRlcnMse29pZDpiLm9iamVjdF9pZCgpfSldKTpQcm9taXNlLmFsbChbXSl9KS50aGVuKGZ1bmN0aW9uKGEpe2wubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllciBzdWNjZXNzLlwiKTt2YXIgZDthPWEubWFwKGZ1bmN0aW9uKGEpe3JldHVybiBiLnBhcmFtMChhKX0pO2Q9YVswXTtiLnBhcmFtc189YVsxXTt2b2lkIDA9PWR8fCExIT09ZC5pc19udWxsfHxudWxsIT09Yi5kdG1mXyYmYi5kdG1mXy5vYmplY3RfaWQoKT09ZC5vaWR8fChiLmR0bWZfPW5ldyB6KGIsZC5vaWQpKTtjKGIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPWIubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zeW5jQmFycmllciBmYWlsZWQhXCIpO2QoYSl9KX0pfTtiLmdldENhcGFiaWxpdGllcz1mdW5jdGlvbihhKXtsLmxvZ2dlci5sb2codGhpcy5jb25zdHJ1Y3Rvci5uYW1lK1xyXG5cIi5nZXRDYXBhYmlsaXRpZXMoKSBjYWxsZWQuXCIpO3JldHVybiBnLk5hdmlnYXRvclVzZXJNZWRpYS5nZXRDYXBhYmlsaXRpZXMoYSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImR0bWZcIix7Z2V0OmZ1bmN0aW9uKCl7bC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldCBkdG1mKCkgY2FsbGVkLlwiKTtyZXR1cm4gdGhpcy5kdG1mX30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtiLnByb3RvdHlwZS5zZXRQYXJhbWV0ZXJzPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7bC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldFBhcmFtZXRlcnMoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihjLGQpe2Iud2FpdFVudGlsQ29ubmVjdGVkKFwiUnRwU2VuZGVyLnNldFBhcmFtZXRlcnNcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLmFsbChbYi5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfUlRDUnRwU2VuZGVyX3Quc2V0UGFyYW1ldGVycyxcclxuYSldKX0pLnRoZW4oZnVuY3Rpb24oZCl7bC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldFBhcmFtZXRlcnMoKTogc3VjY2Vzcy5cIik7YygpO2IucGFyYW1zXz1hfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPWIubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRQYXJhbWV0ZXJzKCkgZmFpbGVkIVwiKTtkKGEpfSl9KX07Yi5wcm90b3R5cGUuZ2V0UGFyYW1ldGVycz1mdW5jdGlvbigpe3ZhciBhPXRoaXM7bC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFBhcmFtZXRlcnMoKSBjYWxsZWQuXCIpO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFBhcmFtZXRlcnNcIikudGhlbihmdW5jdGlvbigpe2wubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRQYXJhbWV0ZXJzKCkgcmVtb3RlIGludm9raW5nXCIpO3JldHVybiBhLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9SVENSdHBTZW5kZXJfdC5nZXRQYXJhbWV0ZXJzLFxyXG57b2lkOmEub2JqZWN0X2lkKCl9KX0pLnRoZW4oZnVuY3Rpb24oYil7bC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFBhcmFtZXRlcnMoKSBzdWNjZXNzXCIpO2EucGFyYW1zXz1hLnBhcmFtMChiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLmdldFBhcmFtZXRlcnMoKSBmYWlsZWQhXCIpfSk7bC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFBhcmFtZXRlcnMoKSByZXR1cm5pbmc6IFwiK3RoaXMucGFyYW1zXyk7cmV0dXJuIHRoaXMucGFyYW1zX307Yi5wcm90b3R5cGUucmVwbGFjZVRyYWNrPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7bC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnJlcGxhY2VUcmFjaygpIGNhbGxlZC4gdHJhY2tfOlwiK3RoaXMudHJhY2tfK1wiLCB3aXRoVHJhY2s6XCIrYSk7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsZCl7Yi53YWl0VW50aWxDb25uZWN0ZWQoXCJSdHBTZW5kZXIucmVwbGFjZVRyYWNrXCIpLnRoZW4oZnVuY3Rpb24oKXtpZihhKXJldHVybiBQcm9taXNlLmFsbChbYi5yZW1vdGVJbnZva2UoITEsXHJcbnAubWV0aG9kX2lkX1JUQ1J0cFNlbmRlcl90LnJlcGxhY2VUcmFjayx7b2lkOmEub2JqZWN0X2lkKCl9KV0pO2lmKGIudW5pZmllZF8pcmV0dXJuIFByb21pc2UuYWxsKFtiLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9SVENSdHBTZW5kZXJfdC5yZXBsYWNlVHJhY2sse29pZDowfSldKTtsLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucmVwbGFjZVRyYWNrKCk6IGZhaWxlZCB3aXRoIG51bGwgdHJhY2shXCIpO2QoKX0pLnRoZW4oZnVuY3Rpb24oZCl7bC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLnJlcGxhY2VUcmFjaygpOiBzdWNjZXNzLlwiKTtjKCk7Yi5yZWluaXRUcmFjayhhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7YT1iLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIucmVwbGFjZVRyYWNrKCkgZmFpbGVkIVwiKTtkKGEpfSl9KX07cmV0dXJuIGJ9KGIpO2EuUnRwU2VuZGVyPXg7dmFyIEQ9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjLGQsZixnLFxyXG5lKXtjPWEuY2FsbCh0aGlzLGMscC5jbGFzc19pZF90LlJUQ1J0cFJlY2VpdmVyLGQsZil8fHRoaXM7bC5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNvbnN0cnVjdG9yXCIpO2MuY29udHJpYnNvdXJjZXNfPVtdO2Muc3luY3NvdXJjZXNfPVtdO2MucGFyYW1zXz1udWxsO2MudW5pZmllZF89ZztlJiYoYy50cmFja189ZSk7cmV0dXJuIGN9ZChiLGEpO2IucHJvdG90eXBlLmR1bXBJbmZvPWZ1bmN0aW9uKCl7bC5sb2dnZXIubG9nKFwiUnRwUmVjZWl2ZXJbXCIrdGhpcy5vYmplY3RfaWQoKStcIl0uZHVtcEluZm8oKTpcIik7dGhpcy50cmFjayYmdGhpcy50cmFjay5kdW1wSW5mbygpO3RoaXMudHJhbnNwb3J0JiZ0aGlzLnRyYW5zcG9ydC5kdW1wSW5mbygpfTtiLnByb3RvdHlwZS5zeW5jQmFycmllcj1mdW5jdGlvbigpe3ZhciBiPXRoaXM7bC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyKCkgY2FsbGVkLlwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxcclxuZCl7Yi53YWl0VW50aWxDb25uZWN0ZWQoXCJSdHBSZWNlaXZlci5zeW5jQmFycmllclwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGEucHJvdG90eXBlLnN5bmNCYXJyaWVyQmFzZS5jYWxsKGIpfSkudGhlbihmdW5jdGlvbigpe2wubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllckJhc2Ugc3VjY2Vzcy5cIik7cmV0dXJuIHYuUmVtb3RlU2Vzc2lvbi5pc0ZlYXR1cmVQc3RuU3VwcG9ydGVkKCkmJnYuUmVtb3RlU2Vzc2lvbi5pc0ZlYXR1cmVEdG1mU3VwcG9ydGVkKCk/UHJvbWlzZS5hbGwoW2IucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX1JUQ1J0cFJlY2VpdmVyX3QuZ2V0Q29udHJpYnV0aW5nU291cmNlcyxbXSksYi5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfUlRDUnRwUmVjZWl2ZXJfdC5nZXRTeW5jaHJvbml6YXRpb25Tb3VyY2VzLFtdKSxiLnJlbW90ZUludm9rZSghMSxwLm1ldGhvZF9pZF9SVENSdHBSZWNlaXZlcl90LmdldFBhcmFtZXRlcnMsXHJcbntvaWQ6Yi5vYmplY3RfaWQoKX0pXSk6UHJvbWlzZS5hbGwoW2IucmVtb3RlSW52b2tlKCExLHAubWV0aG9kX2lkX1JUQ1J0cFJlY2VpdmVyX3QuZ2V0Q29udHJpYnV0aW5nU291cmNlcyxbXSldKX0pLnRoZW4oZnVuY3Rpb24oYSl7bC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyIHN1Y2Nlc3MuXCIpO2E9YS5tYXAoZnVuY3Rpb24oYSl7cmV0dXJuIGIucGFyYW0wKGEpfSk7Yi5jb250cmlic291cmNlc189YVswXTtiLnN5bmNzb3VyY2VzXz1hWzFdO2IucGFyYW1zXz1hWzJdO2MoYil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnN5bmNCYXJyaWVyKCkgZmFpbGVkIVwiKTtkKGEpfSl9KX07Yi5nZXRDYXBhYmlsaXRpZXM9ZnVuY3Rpb24oYSl7bC5sb2dnZXIubG9nKHRoaXMuY29uc3RydWN0b3IubmFtZStcIi5nZXRDYXBhYmlsaXRpZXMoKSBjYWxsZWQuXCIpO3JldHVybiBnLk5hdmlnYXRvclVzZXJNZWRpYS5nZXRDYXBhYmlsaXRpZXMoYSl9O1xyXG5iLnByb3RvdHlwZS5nZXRDb250cmlidXRpbmdTb3VyY2VzPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztsLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0Q29udHJpYnV0aW5nU291cmNlcygpIGNhbGxlZC4gXCIrSlNPTi5zdHJpbmdpZnkodGhpcy5jb250cmlic291cmNlc18pKTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIlJ0cFJlY2VpdmVyLmdldENvbnRyaWJ1dGluZ1NvdXJjZXNcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEscC5tZXRob2RfaWRfUlRDUnRwUmVjZWl2ZXJfdC5nZXRDb250cmlidXRpbmdTb3VyY2VzLFtdKV0pfSkudGhlbihmdW5jdGlvbihiKXthLmNvbnRyaWJzb3VyY2VzXz1iLm1hcChmdW5jdGlvbihiKXtyZXR1cm4gYS5wYXJhbTAoYil9KVswXTtsLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCksXCIuZ2V0Q29udHJpYnV0aW5nU291cmNlcygpIHN1Y2Nlc3M6IFwiK0pTT04uc3RyaW5naWZ5KGEuY29udHJpYnNvdXJjZXNfKSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2EubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcclxuXCIuZ2V0Q29udHJpYnV0aW5nU291cmNlcygpIGZhaWxlZCFcIik7YS5jb250cmlic291cmNlc189W119KTtyZXR1cm4gdGhpcy5jb250cmlic291cmNlc199O2IucHJvdG90eXBlLmdldFBhcmFtZXRlcnM9ZnVuY3Rpb24oKXtsLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0UGFyYW1ldGVycygpIGNhbGxlZC5cIik7cmV0dXJuIHRoaXMucGFyYW1zX307Yi5wcm90b3R5cGUuZ2V0U3luY2hyb25pemF0aW9uU291cmNlcz1mdW5jdGlvbigpe2wubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRTeW5jaHJvbml6YXRpb25Tb3VyY2VzKCkgY2FsbGVkLlwiKTtyZXR1cm4gdGhpcy5zeW5jc291cmNlc199O3JldHVybiBifShiKTthLlJ0cFJlY2VpdmVyPUR9LDM3NzpmdW5jdGlvbihiLGEsYyl7dmFyIGQ9dGhpcyYmdGhpcy5fX2V4dGVuZHN8fGZ1bmN0aW9uKCl7dmFyIGE9ZnVuY3Rpb24oYixjKXthPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mXHJcbkFycmF5JiZmdW5jdGlvbihhLGIpe2EuX19wcm90b19fPWJ9fHxmdW5jdGlvbihhLGIpe2Zvcih2YXIgYyBpbiBiKWIuaGFzT3duUHJvcGVydHkoYykmJihhW2NdPWJbY10pfTtyZXR1cm4gYShiLGMpfTtyZXR1cm4gZnVuY3Rpb24oYixjKXtmdW5jdGlvbiBkKCl7dGhpcy5jb25zdHJ1Y3Rvcj1ifWEoYixjKTtiLnByb3RvdHlwZT1udWxsPT09Yz9PYmplY3QuY3JlYXRlKGMpOihkLnByb3RvdHlwZT1jLnByb3RvdHlwZSxuZXcgZCl9fSgpO09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBlPWMoNjU4KSxrPWMoNTUwKSxtPWMoODUxKSxwPWMoNTg5KTtiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe3RoaXMuZGlyZWN0aW9uPVwic2VuZHJlY3ZcIjt0aGlzLnNlbmRFbmNvZGluZ3M9W107dGhpcy5zdHJlYW1zPVtdO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jb25zdHJ1Y3RvclwiKX1hLnByb3RvdHlwZS51c2VyX2ZyaWVuZGx5X2lkPVxyXG5mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnN0cnVjdG9yLm5hbWV9O3JldHVybiBhfSgpO2EuUnRwVHJhbnNjZWl2ZXJJbml0PWI7dmFyIGw7KGZ1bmN0aW9uKGEpe2FbYS5rU2VuZFJlY3Y9MF09XCJrU2VuZFJlY3ZcIjthW2Eua1NlbmRPbmx5PTFdPVwia1NlbmRPbmx5XCI7YVthLmtSZWN2T25seT0yXT1cImtSZWN2T25seVwiO2FbYS5rSW5hY3RpdmU9M109XCJrSW5hY3RpdmVcIn0pKGx8fChsPXt9KSk7Yj1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKGMsZCxJLHUsZixBKXtjPWEuY2FsbCh0aGlzLGMsay5jbGFzc19pZF90LlJUQ1J0cFRyYW5zY2VpdmVyLGQsSSl8fHRoaXM7bS5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNvbnN0cnVjdG9yXCIpO2MudW5pZmllZF89dTtjLnNlbmRlcl89bmV3IHAuUnRwU2VuZGVyKGMsMCxlLlByb3h5TW9kZS5Qc2V1ZG8sdSk7Yy5yZWNlaXZlcl89QT9BOm5ldyBwLlJ0cFJlY2VpdmVyKGMsMCxlLlByb3h5TW9kZS5Qc2V1ZG8sdSk7Zj8oYy5kaXJlY3Rpb25fPVxyXG5jLnRvUnRwVHJhbnNjZWl2ZXJEaXJlY3Rpb24oZiksYy5jdXJyZW50RGlyZWN0aW9uXz1jLnRvUnRwVHJhbnNjZWl2ZXJEaXJlY3Rpb24oZikpOihjLmRpcmVjdGlvbl89bC5rU2VuZFJlY3YsYy5jdXJyZW50RGlyZWN0aW9uXz1sLmtTZW5kUmVjdik7cmV0dXJuIGN9ZChiLGEpO2IucHJvdG90eXBlLmR1bXBJbmZvPWZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmR1bXBJbmZvKCkgW2lkPVwiK3RoaXMubWlkK1wiXSBkaXJlY3Rpb249XCIrdGhpcy50b1JUQ1J0cFRyYW5zY2VpdmVyRGlyZWN0aW9uKHRoaXMuZGlyZWN0aW9uXyksXCIgY3VycmVudERpcmVjdGlvbj1cIit0aGlzLnRvUlRDUnRwVHJhbnNjZWl2ZXJEaXJlY3Rpb24odGhpcy5jdXJyZW50RGlyZWN0aW9uXykpO3RoaXMuc2VuZGVyJiZ0aGlzLnNlbmRlci5kdW1wSW5mbygpO3RoaXMucmVjZWl2ZXImJnRoaXMucmVjZWl2ZXIuZHVtcEluZm8oKX07Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9XHJcbmZ1bmN0aW9uKCl7dmFyIGE9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2Eud2FpdFVudGlsQ29ubmVjdGVkKFwiUnRwVHJhbnNjZWl2ZXIuc3luY0JhcnJpZXJcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEsay5tZXRob2RfaWRfUlRDUnRwVHJhbnNjZWl2ZXJfdC5taWQse29pZDphLm9iamVjdF9pZCgpfSksYS5yZW1vdGVJbnZva2UoITEsay5tZXRob2RfaWRfUlRDUnRwVHJhbnNjZWl2ZXJfdC5kaXJlY3Rpb24se29pZDphLm9iamVjdF9pZCgpfSksYS5yZW1vdGVJbnZva2UoITEsay5tZXRob2RfaWRfUlRDUnRwVHJhbnNjZWl2ZXJfdC5jdXJyZW50RGlyZWN0aW9uLHtvaWQ6YS5vYmplY3RfaWQoKX0pLGEucmVtb3RlSW52b2tlKCExLGsubWV0aG9kX2lkX1JUQ1J0cFRyYW5zY2VpdmVyX3Quc2VuZGVyLFxyXG57b2lkOmEub2JqZWN0X2lkKCl9KSxhLnJlbW90ZUludm9rZSghMSxrLm1ldGhvZF9pZF9SVENSdHBUcmFuc2NlaXZlcl90LnJlY2VpdmVyLHtvaWQ6YS5vYmplY3RfaWQoKX0pXSl9KS50aGVuKGZ1bmN0aW9uKGMpe3ZhciBkO20ubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllciByZW1vdGUgc3VjY2Vzcy5cIik7ZD1jLm1hcChmdW5jdGlvbihiKXtyZXR1cm4gYS5wYXJhbTAoYil9KTthLm1pZF89ZFswXTthLmRpcmVjdGlvbl89ZFsxXTthLmN1cnJlbnREaXJlY3Rpb25fPWRbMl07Yz1kWzNdO2Q9ZFs0XTt2YXIgZT1bXTt2b2lkIDAhPWMmJiExPT09Yy5pc19udWxsJiYoYS5zZW5kZXJfLmJpbmQoYSxjLm9pZCksZS5wdXNoKGEuc2VuZGVyXy5zeW5jQmFycmllcigpKSk7dm9pZCAwIT1kJiYhMT09PWQuaXNfbnVsbCYmKGEucmVjZWl2ZXJfLmJpbmQoYSxkLm9pZCksZS5wdXNoKGEucmVjZWl2ZXJfLnN5bmNCYXJyaWVyKCkpKTtpZigwPT1lLmxlbmd0aCltLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLnN5bmNCYXJyaWVyIHN1Y2Nlc3NcIiksYihhKTtlbHNlIHJldHVybiBtLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucHJvcC5zeW5jQmFycmllciBzdGFydFwiKSxQcm9taXNlLmFsbChlKX0pLnRoZW4oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIgc3VjY2Vzc1wiKTtiKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtiPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5zeW5jQmFycmllcigpIGZhaWxlZCFcIik7YyhiKX0pfSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm1pZFwiLHtnZXQ6ZnVuY3Rpb24oKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X21pZCgpIGNhbGxlZDogXCIrdGhpcy5taWRfKTtyZXR1cm4gdGhpcy5taWRffSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInNlbmRlclwiLFxyXG57Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VuZGVyX30sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJyZWNlaXZlclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZWNlaXZlcl99LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwiZGlyZWN0aW9uXCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfZGlyZWN0aW9uKCkgY2FsbGVkLiBcIit0aGlzLnRvUlRDUnRwVHJhbnNjZWl2ZXJEaXJlY3Rpb24odGhpcy5kaXJlY3Rpb25fKSk7cmV0dXJuIHRoaXMudG9SVENSdHBUcmFuc2NlaXZlckRpcmVjdGlvbih0aGlzLmRpcmVjdGlvbl8pfSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X2RpcmVjdGlvbigpIGNhbGxlZC4gXCIrXHJcbmEpO3RoaXMuZGlyZWN0aW9uXz10aGlzLnRvUnRwVHJhbnNjZWl2ZXJEaXJlY3Rpb24oYSk7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJSdHBUcmFuc2NlaXZlci5zZXRfZGlyZWN0aW9uXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsay5tZXRob2RfaWRfUlRDUnRwVHJhbnNjZWl2ZXJfdC5kaXJlY3Rpb24sYi50b1J0cFRyYW5zY2VpdmVyRGlyZWN0aW9uKGEpKX0pLnRoZW4oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X2RpcmVjdGlvbjogc3VjY2Vzcy5cIil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfZGlyZWN0aW9uKCkgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImN1cnJlbnREaXJlY3Rpb25cIix7Z2V0OmZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5nZXRfY3VycmVudERpcmVjdGlvbigpIGNhbGxlZC4gXCIrdGhpcy50b1JUQ1J0cFRyYW5zY2VpdmVyRGlyZWN0aW9uKHRoaXMuZGlyZWN0aW9uXykpO3JldHVybiB0aGlzLnRvUlRDUnRwVHJhbnNjZWl2ZXJEaXJlY3Rpb24odGhpcy5jdXJyZW50RGlyZWN0aW9uXyl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbigpe3ZhciBhPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnN0b3AoKSBjYWxsZWQuXCIpO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiUnRwVHJhbnNjZWl2ZXIuc3RvcFwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGEucmVtb3RlSW52b2tlKCEwLGsubWV0aG9kX2lkX1JUQ1J0cFRyYW5zY2VpdmVyX3Quc3RvcCl9KS50aGVuKGZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN0b3A6IHN1Y2Nlc3MuXCIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXHJcblwiLnN0b3AoKSBmYWlsZWQhXCIpfSl9O2IucHJvdG90eXBlLnNldENvZGVjUHJlZmVyZW5jZXM9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0Q29kZWNQcmVmZXJlbmNlcygpIGNhbGxlZC5cIik7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJSdHBUcmFuc2NlaXZlci5zZXRDb2RlY1ByZWZlcmVuY2VzXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsay5tZXRob2RfaWRfUlRDUnRwVHJhbnNjZWl2ZXJfdC5zZXRDb2RlY1ByZWZlcmVuY2VzLGEpfSkudGhlbihmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRDb2RlY1ByZWZlcmVuY2VzOiBzdWNjZXNzLlwiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnNldENvZGVjUHJlZmVyZW5jZXMoKSBmYWlsZWQhXCIpfSl9O2IucHJvdG90eXBlLnRvUnRwVHJhbnNjZWl2ZXJEaXJlY3Rpb249XHJcbmZ1bmN0aW9uKGEpe3ZhciBiPWwua1NlbmRSZWN2O3N3aXRjaChhKXtjYXNlIFwiaW5hY3RpdmVcIjpiPWwua0luYWN0aXZlO2JyZWFrO2Nhc2UgXCJyZWN2b25seVwiOmI9bC5rUmVjdk9ubHk7YnJlYWs7Y2FzZSBcInNlbmRvbmx5XCI6Yj1sLmtTZW5kT25seTticmVhaztjYXNlIFwic2VuZHJlY3ZcIjpiPWwua1NlbmRSZWN2O2JyZWFrO2RlZmF1bHQ6Yj1sLmtJbmFjdGl2ZX1yZXR1cm4gYn07Yi5wcm90b3R5cGUudG9SVENSdHBUcmFuc2NlaXZlckRpcmVjdGlvbj1mdW5jdGlvbihhKXt2YXIgYj1cInNlbmRyZWN2XCI7c3dpdGNoKGEpe2RlZmF1bHQ6Yj1cImluYWN0aXZlXCI7YnJlYWs7Y2FzZSBsLmtSZWN2T25seTpiPVwicmVjdm9ubHlcIjticmVhaztjYXNlIGwua1NlbmRPbmx5OmI9XCJzZW5kb25seVwiO2JyZWFrO2Nhc2UgbC5rU2VuZFJlY3Y6Yj1cInNlbmRyZWN2XCJ9cmV0dXJuIGJ9O3JldHVybiBifShlLlByb3h5T2JqZWN0KTthLlJ0cFRyYW5zY2VpdmVyPWJ9LDUwOTpmdW5jdGlvbihiLGEpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFxyXG5cIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTsoZnVuY3Rpb24oYSl7YVthLlVua25vd249MF09XCJVbmtub3duXCI7YVthLkNhcD0xXT1cIkNhcFwiO2FbYS5HZXRTb3VyY2VzPTJdPVwiR2V0U291cmNlc1wiO2FbYS5TZXRBY3RpdmU9M109XCJTZXRBY3RpdmVcIjthW2EuVG9wb2xvZ3lDaGFuZ2VkPTRdPVwiVG9wb2xvZ3lDaGFuZ2VkXCJ9KShhLnNzaGFyZV9jbWR8fChhLnNzaGFyZV9jbWQ9e30pKTsoZnVuY3Rpb24oYSl7YVthLlVua25vd249MF09XCJVbmtub3duXCI7YVthLkluaXRpYWxpemVkPTFdPVwiSW5pdGlhbGl6ZWRcIjthW2EuRXJyb3I9Ml09XCJFcnJvclwifSkoYS5zc2hhcmVfc3RhdGV8fChhLnNzaGFyZV9zdGF0ZT17fSkpO3ZhciBjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe31hLnByb3RvdHlwZS5vbkluaXRpYWxpemVkPWZ1bmN0aW9uKGEpe307YS5wcm90b3R5cGUub25Jbml0Q29tcGxldGU9ZnVuY3Rpb24oKXt9O2EucHJvdG90eXBlLm9uRXJyb3I9ZnVuY3Rpb24oYSl7fTthLnByb3RvdHlwZS5vbkdldFNvdXJjZXM9XHJcbmZ1bmN0aW9uKGEsYil7fTthLnByb3RvdHlwZS5vblNldEFjdGl2ZT1mdW5jdGlvbihhLGIpe307YS5wcm90b3R5cGUub25Ub3Bsb2d5Q2hhbmdlZD1mdW5jdGlvbigpe307cmV0dXJuIGF9KCk7YS5TY3JlZW5TaGFyZVV0aWw9Y30sNTE3OmZ1bmN0aW9uKGIsYSl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7dGhpcy5pdGVtcz1bXX1hLmZyb21KU09OPWZ1bmN0aW9uKGIpe2Zvcih2YXIgYz1uZXcgYSxlPTA7ZTxiLmxlbmd0aDtlKyspe3ZhciBsPWQuZnJvbUpTT04oYltlXSk7Yy5pdGVtcy5wdXNoKGwpfXJldHVybiBjfTthLnRvUlRDU3RhdHNSZXBvcnQ9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2EucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLml0ZW1zKX07YS5wcm90b3R5cGUucmVzdWx0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlbXN9O1xyXG5yZXR1cm4gYX0oKTthLlN0YXRzUmVwb3J0PWM7dmFyIGQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7dGhpcy5uYW1lc189W107dGhpcy5zdGF0Xz1uZXcgTWFwO3RoaXMuaWQ9XCJcIjt0aGlzLnRpbWVzdGFtcD0wO3RoaXMudHlwZT1cIlwifWEuZnJvbUpTT049ZnVuY3Rpb24oYil7dmFyIGM9bmV3IGE7Yy5pZD1iLmlkfHxcIlwiO2MudGltZXN0YW1wPWIudGltZXN0YW1wfHxcIlwiO2MudHlwZT1iLnR5cGV8fFwiXCI7T2JqZWN0LmtleXMoYikuZm9yRWFjaChmdW5jdGlvbihhKXtcImlkXCIhPT1hJiZcInRpbWVzdGFtcFwiIT09YSYmXCJ0eXBlXCIhPT1hJiYoYy5uYW1lc18ucHVzaChhKSxjLnN0YXRfLnNldChhLGJbYV0pKX0pO3JldHVybiBjfTthLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtyZXR1cm4gSlNPTi5zdHJpbmdpZnkoe2lkOnRoaXMuaWQsdGltZXN0YW1wOnRoaXMudGltZXN0YW1wLHR5cGU6dGhpcy50eXBlLHN0YXQ6dGhpcy5zdGF0X30pfTthLnByb3RvdHlwZS5uYW1lcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5hbWVzX307XHJcbmEucHJvdG90eXBlLnN0YXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuc3RhdF8uZ2V0KGEpfTtyZXR1cm4gYX0oKTthLlN0YXRzPWR9LDM5NDpmdW5jdGlvbihiLGEsYyl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGQ9Yyg5NDYpLGU9Yyg4NTEpOyhmdW5jdGlvbihhKXthW2EudW5rbm93bj0wXT1cInVua25vd25cIjthW2EuYWN0aXZlPTFdPVwiYWN0aXZlXCI7YVthLmlkbGU9Ml09XCJpZGxlXCJ9KShhLnRlbF9DYWxsU3RhdGV8fChhLnRlbF9DYWxsU3RhdGU9e30pKTsoZnVuY3Rpb24oYSl7YVthLnVua25vd249MF09XCJ1bmtub3duXCI7YVthLmluY29taW5nPTFdPVwiaW5jb21pbmdcIjthW2Eub3V0Z29pbmc9Ml09XCJvdXRnb2luZ1wifSkoYS50ZWxfQ2FsbERpcmVjdGlvbnx8KGEudGVsX0NhbGxEaXJlY3Rpb249e30pKTsoZnVuY3Rpb24oYSl7YVthLnVua25vd249MF09XCJ1bmtub3duXCI7YVthLmF1ZGlvPTFdPVwiYXVkaW9cIjthW2EudmlkZW89Ml09XHJcblwidmlkZW9cIjthW2EubXVsdGk9M109XCJtdWx0aVwiO2FbYS5kc2hhcmU9NF09XCJkc2hhcmVcIn0pKGEudGVsX0NhbGxUeXBlfHwoYS50ZWxfQ2FsbFR5cGU9e30pKTt2YXIgazsoZnVuY3Rpb24oYSl7YVthLlVua25vd249MF09XCJVbmtub3duXCI7YVthLkNhcD0xXT1cIkNhcFwiO2FbYS5Jbml0PTJdPVwiSW5pdFwiO2FbYS5EYXRhPTNdPVwiRGF0YVwifSkoaz1hLnRlbF9jbWR8fChhLnRlbF9jbWQ9e30pKTthLnRlbF9rZXlfQ29uZmVyZW5jZUNhbGxEdXJhdGlvbj1cIkNvbmZlcmVuY2VDYWxsRHVyYXRpb25cIjthLnRlbF9rZXlfQXVkaW9DYWxsRHVyYXRpb249XCJBdWRpb0NhbGxEdXJhdGlvblwiO2EudGVsX2tleV9WaWRlb0NhbGxEdXJhdGlvbj1cIlZpZGVvQ2FsbER1cmF0aW9uXCI7YS50ZWxfa2V5X1NjcmVlbnNoYXJpbmdDYWxsRHVyYXRpb249XCJTY3JlZW5zaGFyaW5nQ2FsbER1cmF0aW9uXCI7YS50ZWxfa2V5X0NhbGxFc3RJbmNvbWluZz1cIkNhbGxFc3RJbmNvbWluZ1wiO2EudGVsX2tleV9DYWxsRXN0T3V0Z29pbmc9XHJcblwiQ2FsbEVzdE91dGdvaW5nXCI7YS50ZWxfa2V5X0F1ZGlvRGV2aWNlVXNlZD1cIkF1ZGlvRGV2aWNlVXNlZFwiO2EudGVsX2tleV9WaWRlb0RldmljZVVzZWQ9XCJWaWRlb0RldmljZVVzZWRcIjthLnRlbF9rZXlfU3BlYWtlckRldmljZVVzZWQ9XCJTcGVha2VyRGV2aWNlVXNlZFwiO2EudGVsX2tleV9QZXJmQ2FsbERpcmVjdGlvbj1cIlBlcmZDYWxsRGlyZWN0aW9uXCI7YS50ZWxfa2V5X1BlcmZDYWxsU3RhdGU9XCJQZXJmQ2FsbFN0YXRlXCI7YS50ZWxfa2V5X1BlcmZDYWxsVHlwZT1cIlBlcmZDYWxsVHlwZVwiO2EudGVsX2tleV9WZXJXZWJycGM9XCJWZXJXZWJycGNcIjthLnRlbF9rZXlfVmVyV2VicnRjQ29kZWNzPVwiVmVyV2VicnRjQ29kZWNzXCI7YS50ZWxfa2V5X1ZlclJlY2VpdmVyPVwiVmVyUmVjZWl2ZXJcIjthLnRlbF9rZXlfVmVyVmRhPVwiVmVyVmRhXCI7YS50ZWxfa2V5X1ZlckVuZHBvaW50PVwiVmVyRW5kcG9pbnRcIjthLnRlbF9rZXlfVmVyVHlwZVNjcmlwdD1cIlZlclR5cGVTY3JpcHRcIjthLnRlbF9rZXlfT1NGYW1pbHk9XHJcblwiT1NGYW1pbHlcIjthLnRlbF9rZXlfT1NWZXJzaW9uPVwiT1NWZXJzaW9uXCI7YS50ZWxfa2V5X09TQXJjaGl0ZWN0dXJlPVwiT1NBcmNoaXRlY3R1cmVcIjthLnRlbF9rZXlfT1NEaXN0cm89XCJPU0Rpc3Ryb1wiO2EudGVsX2tleV9PU0VkaXRpb249XCJPU0VkaXRpb25cIjt2YXIgbT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixjLGQsZSl7dGhpcy5jbWQ9Yjt0aGlzLmtleT1jO3RoaXMudmFsdWU9ZDt0aGlzLmZsYWdzPWV9YS5wcm90b3R5cGUuU2VuZFRlbGVtZXRyeURhdGE9ZnVuY3Rpb24oYSl7YS5TZW5kVGVsZW1ldHJ5RGF0YSh0aGlzLmNtZCx0aGlzLmtleSx0aGlzLnZhbHVlLHRoaXMuZmxhZ3MpfTtyZXR1cm4gYX0oKTtiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe3RoaXMuaWQ9MDt0aGlzLmRlZmVycmVkRGF0YT1bXX1hLnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbigpe3RoaXMuaWQ9MDt0aGlzLmRlZmVycmVkRGF0YT1bXX07YS5wcm90b3R5cGUub25Jbml0aWFsaXplZD1mdW5jdGlvbihhKXtmb3IodGhpcy5pZD1cclxuYTt0aGlzLmRlZmVycmVkRGF0YSYmMDx0aGlzLmRlZmVycmVkRGF0YS5sZW5ndGg7KXRoaXMuZGVmZXJyZWREYXRhLnNoaWZ0KCkuU2VuZFRlbGVtZXRyeURhdGEodGhpcyl9O2EucHJvdG90eXBlLlNlbmRUZWxlbWV0cnlJbml0PWZ1bmN0aW9uKCl7MDx0aGlzLmlkJiZ0aGlzLnJlc2V0KCk7dHJ5e2QuZ2V0UmVkaXJlY3RvcigpLldTU2VuZE9iamVjdCh7djpcInRlbGVtZXRyeVwiLGhkcjp7Y29tbWFuZDprLkluaXQsaWQ6MH0saW5pdDp7ZG9tYWluOlwiSERYTU0gVGVhbXNcIixzdWJkb21haW46XCJUZWFtc1wiLGZlYXR1cmU6XCJtc3RlYW1zXCIsdmVyc2lvbjpcIjEuMS4xLjFcIn19KX1jYXRjaChhKXtlLmxvZ2dlci5sb2coYSl9fTthLnByb3RvdHlwZS5TZW5kVGVsZW1ldHJ5RGF0YT1mdW5jdGlvbihhLGIsYyxwKXtpZihhIT1rLkRhdGEpZS5sb2dnZXIubG9nKFwiaW52YWxpZCB0ZWxlbWV0cnkgY29tbWFuZCFcIik7ZWxzZSBpZigwPT10aGlzLmlkKXRoaXMuZGVmZXJyZWREYXRhLnB1c2gobmV3IG0oYSxcclxuYixjLHApKTtlbHNlIHRyeXtkLmdldFJlZGlyZWN0b3IoKS5XU1NlbmRPYmplY3Qoe3Y6XCJ0ZWxlbWV0cnlcIixoZHI6e2NvbW1hbmQ6YSxpZDp0aGlzLmlkfSxkYXRhOntrZXk6Yix2YWx1ZTpjLGZsYWdzOnB9fSl9Y2F0Y2godCl7ZS5sb2dnZXIubG9nKHQpfX07cmV0dXJuIGF9KCk7YS5UZWxlbWV0cnk9Yn0sMzA3OmZ1bmN0aW9uKGIsYSxjKXt2YXIgZD1jKDU1MCkuRmVhdHVyZXMsZT1jKDM2MCksaz1jKDE0NCksbT1jKDY3OSkscD1jKDk0NSksbD1jKDM2OCksZz1jKDg1MSkubG9nZ2VyLEc9Yyg2NTApLHY9YygyNDcpLmdjLHQ9Yyg5NDYpOyhmdW5jdGlvbihhLGIpe2EuQ2l0cml4V2ViUlRDPWIoKX0pKFwidW5kZWZpbmVkXCIhPT10eXBlb2Ygc2VsZj9zZWxmOnRoaXMsZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIpe3QuZ2V0UmVkaXJlY3RvcigpLlNlbmRUZWxlbWV0cnlEYXRhX1NwZWFrZXIoYil9ZnVuY3Rpb24gYigpe3ZhciBhPXdpbmRvdy5nZXRDaXRyaXhXZWJydGNSZWRpcjt2b2lkIDAhPT1cclxuYT9hKCkudGhlbihmdW5jdGlvbihhKXtnLmxvZyhcInN1Y2Vzc3Mgb24gY29ubmVjdCwgZ2V0Q2l0cml4V2VicnRjUmVkaXIgcmVnIHZhbHVlOlwiK2EpO1wiMVwiPT09YSYmbnVsbD09PUYmJihnLmxvZyhcInN1cHBvcnRlZCBjbGllbnRcIiksRj1uZXcgRy5SZW1vdGVTZXNzaW9uKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtnLmxvZyhcIkZhaWx1cmUgdG8gUmVhZCBXZWJydGMgcmVkaXIgUmVnIEtleVwiKTtBKCl9KTooZy5sb2coXCJ3aW5kb3cuZ2V0Q2l0cml4V2VicnRjUmVkaXIoKSBtZXRob2QgaXMgbm90IGF2YWlsYWJsZSB5ZXRcIiksQSgpKX1mdW5jdGlvbiBjKGEpe2lmKFwiMVwiPT09YSlnLmxvZyhcIlN1cHBvcnRlZCBjbGllbnRcIiksdC5nZXRSZWRpcmVjdG9yKCkucGluZ0Nvbm5lY3Rpb25CZWdpbighMCk7ZWxzZSBpZihcIjBcIj09PWEpe2cubG9nKFwiVkRJIEV2ZW50OiBVbnN1cHBvcnRlZCBjbGllbnQgcmVwb3J0ZWRcIik7dHJ5e0goe2V2ZW50OlwidmRpQ2xpZW50RGlzY29ubmVjdGVkXCIscmVhc29uOlwiZW5kcG9pbnRVbnN1cHBvcnRlZFwiLFxyXG5tc2c6XCJVbnN1cHBvcnRlZCBlbmRwb2ludCBjb25uZWN0ZWRcIn0pfWNhdGNoKGIpe2cubG9nKFwib25WTUV2ZW50KCk6IGV4Y2VwdGlvbjogXCIrYi5tZXNzYWdlKX19ZWxzZSBnLmxvZyhcIkNpdHJpeCBXZWJydGMgUmVkaXIgUmVnIEtleSB2YWx1ZSBpcyBpbmNvcnJlY3RcIil9ZnVuY3Rpb24gQSgpeyExPT09SiYmKGcubG9nKFwic3RhcnRpbmcgTVMgUmVnIHJldHJ5Li4uXCIpLEo9ITAseCgxMCkpfWZ1bmN0aW9uIHgoYSl7aWYoMD49YSl7Sj0hMTtnLmxvZyhcIlZESSBFdmVudDogUmVnIEtleSBub3QgVXBkYXRlZCBhZnRlciB0aW1lciByZXBvcnRlZCwgRmFsbGJhY2tcIik7dHJ5e0goe2V2ZW50OlwidmRpQ2xpZW50RGlzY29ubmVjdGVkXCIscmVhc29uOlwiZmFpbHVyZVwiLG1zZzpcIkNpdHJpeCBXZWJydGMgUmVkaXIgUmVnIEtleSBub3QgUHJlc2VudFwifSl9Y2F0Y2goYil7Zy5sb2coXCJvblZNRXZlbnQoKTogZXhjZXB0aW9uOiBcIitiLm1lc3NhZ2UpfX1lbHNle3ZhciBkPXdpbmRvdy5nZXRDaXRyaXhXZWJydGNSZWRpcjtcclxudm9pZCAwIT09ZD9kKCkudGhlbihmdW5jdGlvbihiKXtnLmxvZyhcIkNpdHJpeE1TVGVhbXNSZWRpciByZWcgdmFsdWU6XCIrYik7XCIwXCI9PT1ifHxcIjFcIj09PWI/KGMoYiksSj0hMSk6KGcubG9nKFwiTVMgVGVhbXMgUmVkaXIgUmVnIGtleSBub3QgdXBkYXRlZCAtIFN0YXJ0IHRpbWVyXCIpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtnLmxvZyhcIlRpbWVyIHdhaXRpbmcgZm9yIHJlZ2lzdHJ5IHRvIGJlIHVwZGF0ZWQgY291bnQgOlwiK2EpO3goLS1hKX0sMUUzKSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7Zy5sb2coXCJGYWlsdXJlIHRvIFJlYWQgTVMgVGVhbXMgcmVkaXIgUmVnIEtleSAtIFN0YXJ0IHRpbWVyXCIpO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtnLmxvZyhcIlRpbWVyIHdhaXRpbmcgZm9yIHJlZ2lzdHJ5IHRvIGJlIHVwZGF0ZWQgY291bnQgOlwiK2EpO3goLS1hKX0sMUUzKX0pOihnLmxvZyhcIndpbmRvdy5nZXRDaXRyaXhXZWJydGNSZWRpcigpIG1ldGhvZCBpcyBub3QgYXZhaWxhYmxlIHlldFwiKSxcclxuc2V0VGltZW91dChmdW5jdGlvbigpe2cubG9nKFwiVGltZXIgd2FpdGluZyBmb3IgcmVnaXN0cnkgdG8gYmUgdXBkYXRlZCBjb3VudCA6XCIrYSk7eCgtLWEpfSwxRTMpKX19ZnVuY3Rpb24gRCgpe2cubG9nKFwiVkRJOiBzZW5kU2Vzc2lvbkluZm9cIik7RiYmRi5nZXRTZXNzaW9uSW5mbygpLnRoZW4oZnVuY3Rpb24oYSl7Zy5sb2coXCJnZXRTZXNzaW9uSW5mbyBzdWNjZXNzISBpbmZvOlwiK0pTT04uc3RyaW5naWZ5KGEpKTt0cnl7SCh7ZXZlbnQ6XCJ2ZGlDbGllbnRDb25uZWN0ZWRcIix2ZXJzaW9uOmF9KX1jYXRjaChiKXtnLmxvZyhcIm9uVk1FdmVudCgpOiBleGNlcHRpb246IFwiK2IubWVzc2FnZSl9fSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2cubG9nKFwiZ2V0U2Vzc2lvbkluZm8gZmFpbHVyZSEgc2Vzc2lvbiBpcyBub3QgZnVsbHkgY29ubmVjdGVkIHlldC4uLlwiKX0pfXZhciBDPWUuUGVlckNvbm5lY3Rpb24scj1uZXcgay5OYXZpZ2F0b3JVc2VyTWVkaWEscT1rLk5hdmlnYXRvclVzZXJNZWRpYS5nZXRDYXBhYmlsaXRpZXMsXHJcbnc9bmV3IGsuUmVtb3RlRGV2aWNlcyxCPW5ldyBsLkZyYW1lVHJhY2tlcix5PTAsSD13aW5kb3cuVk1FdmVudENhbGxiYWNrLGg9ITE7d2luZG93Lm9uVmRpQ2xpZW50RGlzY29ubmVjdGVkPWZ1bmN0aW9uKGEpe2cubG9nKFwiVkRJIEV2ZW50OiB2ZGlDbGllbnREaXNjb25uZWN0ZWRcIik7Zy5sb2coXCJWREkgOiBjbGVhbnVwXCIpO3QuZ2V0UmVkaXJlY3RvcigpLmNsZWFyUmVxcygpO2suTmF2aWdhdG9yVXNlck1lZGlhLnJlc2V0Y2FwcygpO0I9dz1yPW51bGw7RiYmRi5yZWxlYXNlKCk7Rj1udWxsO3YucmVzZXQoKTtnLmxvZyhcIlZESSA6IGNsZWFudXAgZG9uZVwiKTtpZighMD09PWEmJiExPT09aCl7Zy5sb2coXCJWREkgRXZlbnQ6IHZkaUNsaWVudERpc2Nvbm5lY3RlZCB3aXRoIGZhaWx1cmUgcmVwb3J0ZWRcIik7aD0hMDt0cnl7SCh7ZXZlbnQ6XCJ2ZGlDbGllbnREaXNjb25uZWN0ZWRcIixyZWFzb246XCJmYWlsdXJlXCIsbXNnOlwiV2Vic29ja2V0IENvbm5lY3Rpb24gRmFpbHVyZVwifSl9Y2F0Y2goYil7Zy5sb2coXCJvblZNRXZlbnQoKTogZXhjZXB0aW9uOiBcIitcclxuYi5tZXNzYWdlKX19ZWxzZXtoPSExO3RyeXtIKHtldmVudDpcInZkaUNsaWVudERpc2Nvbm5lY3RlZFwiLHJlYXNvbjpcImVuZHBvaW50RGlzY29ubmVjdGVkXCJ9KX1jYXRjaChiKXtnLmxvZyhcIm9uVk1FdmVudCgpOiBleGNlcHRpb246IFwiK2IubWVzc2FnZSl9fX07dmFyIEY9bmV3IEcuUmVtb3RlU2Vzc2lvbjt3aW5kb3cub25WZGlDbGllbnREaXNjb25uZWN0ZWRUaW1lcj1mdW5jdGlvbigpe2cubG9nKFwiVkRJIEV2ZW50OiBvblZkaUNsaWVudERpc2Nvbm5lY3RlZFRpbWVyXCIpO251bGw9PT1GJiYoRj1uZXcgRy5SZW1vdGVTZXNzaW9uKX07d2luZG93Lm9uVmRpQ2xpZW50Q29ubmVjdGVkPWZ1bmN0aW9uKCl7Zy5sb2coXCJWREkgRXZlbnQ6IHZkaUNsaWVudENvbm5lY3RlZFwiKTtsLkZyYW1lVHJhY2tlci5zZW5kT3ZlcmxheUluZm8oKTtudWxsIT09dyYmdy5pc1ZhbGlkKCl8fCh3PW5ldyBrLlJlbW90ZURldmljZXMpO251bGwhPT1yJiZyLmlzVmFsaWQoKXx8KHI9bmV3IGsuTmF2aWdhdG9yVXNlck1lZGlhKTtcclxuci5nZXRDYXBhYmlsaXRpZXMoKS50aGVuKGZ1bmN0aW9uKGEpe2cubG9nKFwiLmdldENhcGFiaWxpdGllcygpIHN1Y2Nlc3MgXCIrYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7Zy5sb2coXCIuZ2V0Q2FwYWJpbGl0aWVzKCkgZmFpbHVyZVwiKX0pO0QoKTtuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwiZGV2aWNlY2hhbmdlXCIpKX07dmFyIEo9ITE7cmV0dXJue0ZlYXR1cmVzOmQsQ2l0cml4UGVlckNvbm5lY3Rpb246QyxnZXRVc2VyTWVkaWE6ZnVuY3Rpb24oYSxjLGQpe2IoKTtnLmxvZyhcIlZESSBTaGltIGdldFVzZXJNZWRpYVwiKTtudWxsIT09ciYmci5pc1ZhbGlkKCl8fChyPW5ldyBrLk5hdmlnYXRvclVzZXJNZWRpYSk7cmV0dXJuIHIud2Via2l0R2V0VXNlck1lZGlhKGEsYyxkKX0sZ2V0RGlzcGxheU1lZGlhOmZ1bmN0aW9uKGEpe2IoKTtnLmxvZyhcIlZESSBTaGltIGdldERpc3BsYXlNZWRpYVwiKTtudWxsIT09dyYmdy5pc1ZhbGlkKCl8fFxyXG4odz1uZXcgay5SZW1vdGVEZXZpY2VzKTtyZXR1cm4gdy5nZXREaXNwbGF5TWVkaWEoYSl9LGVudW1lcmF0ZURldmljZXM6ZnVuY3Rpb24oKXtiKCk7bnVsbCE9PXcmJncuaXNWYWxpZCgpfHwodz1uZXcgay5SZW1vdGVEZXZpY2VzKTtyZXR1cm4gdy5lbnVtZXJhdGVEZXZpY2VzKCl9LG1hcFZpZGVvRWxlbWVudDpmdW5jdGlvbihhKXtnLmxvZyhcIlZESSBOZXcgVmlkZW8gRWxlbWVudCBDcmVhdGVkLCBDcmVhdGluZyBNYXBwaW5nIHRvIFZEQVwiKTtudWxsPT09QiYmKEI9bmV3IGwuRnJhbWVUcmFja2VyKTt2b2lkIDAhPT1hLnJlbW90ZVZpZGVvRWxlbWVudD9nLmxvZyhcIlZpZGVvIGVsZW1lbnQgaXMgYWxyZWFkeSBjb25maWd1cmVkIVwiKTooYigpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwicmVtb3RlVmlkZW9FbGVtZW50XCIse3dyaXRhYmxlOiEwLHZhbHVlOm51bGx9KSxhLmlkfHwoYS5pZD1cImN0eC12aWQtXCIreSsrKSxhLnJlbW90ZVZpZGVvRWxlbWVudD1uZXcgbS5WaWRlb0VsZW1lbnQoYS5pZCksXHJcbmEucmVtb3RlVmlkZW9FbGVtZW50Lm9ubG9hZGVkbWV0YWRhdGE9ZnVuY3Rpb24oKXt2YXIgYj1uZXcgRXZlbnQoXCJsb2FkZWRtZXRhZGF0YVwiKTthLmRpc3BhdGNoRXZlbnQoYil9LGEucmVtb3RlVmlkZW9FbGVtZW50Lm9udGltZXVwZGF0ZT1mdW5jdGlvbigpe3ZhciBiPW5ldyBFdmVudChcInRpbWV1cGRhdGVcIik7YS5kaXNwYXRjaEV2ZW50KGIpfSxhLnJlbW90ZVZpZGVvRWxlbWVudC5vbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZT1mdW5jdGlvbigpe1wiY29ubmVjdGVkXCI9PT1hLnJlbW90ZVZpZGVvRWxlbWVudC5jb25uZWN0aW9uU3RhdGU/Qi50cmFjayhhLGZ1bmN0aW9uKGIpe2EucmVtb3RlVmlkZW9FbGVtZW50LnNldEZyYW1lKGIpfSk6Qi51bnRyYWNrKGEpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcInNpbmtJZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gYS5yZW1vdGVWaWRlb0VsZW1lbnQuc2lua0lkfSxzZXQ6ZnVuY3Rpb24oYil7Zy5sb2coXCJWREkgU2hpbSBzZXQgdmlkZW8gZWxlbWVudCBTaW5rSWQgdmFsdWUgPSBcIitcclxuYik7YS5yZW1vdGVWaWRlb0VsZW1lbnQuc2lua0lkPWJ9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJzcmNPYmplY3RcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGEucmVtb3RlVmlkZW9FbGVtZW50LnNyY09iamVjdH0sc2V0OmZ1bmN0aW9uKGIpe2cubG9nKFwiVkRJIFNoaW0gc2V0IHZpZGVvIGVsZW1lbnQgc3JjT2JqZWN0XCIpO2EucmVtb3RlVmlkZW9FbGVtZW50LnNyY09iamVjdD1ifX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwidmlkZW9XaWR0aFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gYS5yZW1vdGVWaWRlb0VsZW1lbnQudmlkZW9XaWR0aH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcInZpZGVvSGVpZ2h0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiBhLnJlbW90ZVZpZGVvRWxlbWVudC52aWRlb0hlaWdodH19KSl9LG1hcEF1ZGlvRWxlbWVudDpmdW5jdGlvbihjKXtnLmxvZyhcIlZESSBOZXcgQXVkaW8gRWxlbWVudCBDcmVhdGVkLCBDcmVhdGluZyBNYXBwaW5nIHRvIFZEQVwiKTtcclxuaWYodm9pZCAwIT09Yy5yZW1vdGVBdWRpb0VsZW1lbnQpZy5sb2coXCJBdWRpbyBlbGVtZW50IGlzIGFscmVhZHkgY29uZmlndXJlZCFcIik7ZWxzZXtiKCk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGMsXCJyZW1vdGVBdWRpb0VsZW1lbnRcIix7d3JpdGFibGU6ITAsdmFsdWU6bnVsbH0pO2MucmVtb3RlQXVkaW9FbGVtZW50PW5ldyBwLkF1ZGlvRWxlbWVudDt2YXIgZD1jLnJlbW90ZUF1ZGlvRWxlbWVudC5wbGF5O2MucGxheT1mdW5jdGlvbigpe2cubG9nKFwiVkRJIFNoaW0gcmVtb3RlIGF1ZGlvIHBsYXlcIik7cmV0dXJuIGQuYXBwbHkoYy5yZW1vdGVBdWRpb0VsZW1lbnQsYXJndW1lbnRzKX07dmFyIGg9Yy5yZW1vdGVBdWRpb0VsZW1lbnQucGF1c2U7Yy5wYXVzZT1mdW5jdGlvbigpe2cubG9nKFwiVkRJIFNoaW0gcmVtb3RlIGF1ZGlvIHBhdXNlXCIpO3JldHVybiBoLmFwcGx5KGMucmVtb3RlQXVkaW9FbGVtZW50LGFyZ3VtZW50cyl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShjLFwic2lua0lkXCIsXHJcbntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gYy5yZW1vdGVBdWRpb0VsZW1lbnQuc2lua0lkfSxzZXQ6ZnVuY3Rpb24oYSl7Zy5sb2coXCJWREkgU2hpbSBzZXQgYXVkaW8gZWxlbWVudCBTaW5rSWQgdmFsdWUgPSBcIithKTtjLnNldFNpbmtJZChhKS50aGVuKGZ1bmN0aW9uKCl7Zy5sb2coXCJWREkgU2hpbSBzZXQgYXVkaW8gZWxlbWVudCBTaW5rSWQgc3VjY2Vzc1wiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtnLmxvZyhcIlZESSBTaGltIHNldCBhdWRpbyBlbGVtZW50IFNpbmtJZCBmYWlsdXJlXCIpfSl9fSk7Yy5zZXRTaW5rSWQ9ZnVuY3Rpb24oYil7Zy5sb2coXCJWREkgU2hpbSBzZXQgYXVkaW8gZWxlbWVudCBTaW5rSWQgdmFsdWUgPSBcIitiKTt2YXIgZD1jLnJlbW90ZUF1ZGlvRWxlbWVudC5zZXRTaW5rSWQoYiksaDtrLmVudW1lcmF0ZWRkZWNpY2VzLmZvckVhY2goZnVuY3Rpb24oYSl7Yj09PWEuZGV2aWNlSWQmJihoPWEubGFiZWwpfSk7YShoKTtyZXR1cm4gZH07T2JqZWN0LmRlZmluZVByb3BlcnR5KGMsXHJcblwic3JjT2JqZWN0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiBjLnJlbW90ZUF1ZGlvRWxlbWVudC5zcmNPYmplY3R9LHNldDpmdW5jdGlvbihhKXtnLmxvZyhcIlZESSBTaGltIHNldCBhdWRpbyBlbGVtZW50IHNyY09iamVjdCBcIitKU09OLnN0cmluZ2lmeShhKSk7Yy5yZW1vdGVBdWRpb0VsZW1lbnQuc3JjT2JqZWN0PWF9fSl9fSxzZXRWTUV2ZW50Q2FsbGJhY2s6ZnVuY3Rpb24oYSl7SD1hO3QuZ2V0UmVkaXJlY3RvcigpLmlzQ29ubmVjdGVkKCkmJiF3aW5kb3cuVk1FdmVudENhbGxiYWNrJiZEKCk7d2luZG93LlZNRXZlbnRDYWxsYmFjaz1udWxsO2cubG9nKFwiVkRJIEV2ZW50IENhbGxiYWNrIFNldFwiKX0sYWRkQ2xpcFJlY3Q6ZnVuY3Rpb24oYSl7Zy5sb2coXCJWREkgQWRkaW5nIE9jY2x1c2lvbiBcIitKU09OLnN0cmluZ2lmeShhKSk7bnVsbD09PUImJihCPW5ldyBsLkZyYW1lVHJhY2tlcik7Qi5hZGRPY2NsdXNpb24oYSl9LHJlbW92ZUNsaXBSZWN0OmZ1bmN0aW9uKGEpe2cubG9nKFwiVkRJIFJlbW92aW5nIE9jY2x1c2lvbiBcIitcclxuSlNPTi5zdHJpbmdpZnkoYSkpO251bGw9PT1CJiYoQj1uZXcgbC5GcmFtZVRyYWNrZXIpO0IucmVtb3ZlT2NjbHVzaW9uKGEpfSxpbml0TG9nOmZ1bmN0aW9uKGEpe2cuc2V0TVNMb2dnZXIoYSk7Zy5sb2coXCJWREkgaW5pdCBsb2dnZXJcIil9LGlzRmVhdHVyZU9uOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT09Rj8hMTpGLmlzRmVhdHVyZVN1cHBvcnRlZChhKX0sb25Db25uZWN0aW9uQ2hhbmdlOmZ1bmN0aW9uKGEpe2cubG9nKFwiVkRJIDogb25Db25uZWN0aW9uQ2hhbmdlIHRvIFwiK2EpOyExPT09YT9nLmxvZyhcIkRpc2Nvbm5lY3RpbmcgZnJvbSB0aGUgVkRBXCIpOihnLmxvZyhcIkNvbm5lY3RpbmcgdG8gdGhlIFZEQVwiKSxhPXdpbmRvdy5nZXRDaXRyaXhXZWJydGNSZWRpcix2b2lkIDAhPT1hP2EoKS50aGVuKGZ1bmN0aW9uKGEpe2cubG9nKFwiU3VjZXNzcyBvbiBjb25uZWN0LCBDaXRyaXhNU1RlYW1zUmVkaXIgcmVnIHZhbHVlOlwiK2EpO1wiMFwiPT09YXx8XCIxXCI9PT1hP2MoYSk6KGcubG9nKFwiTVMgVGVhbXMgUmVkaXIgUmVnIGtleSBub3QgdXBkYXRlZCB5ZXRcIiksXHJcbkEoKSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7Zy5sb2coXCJGYWlsdXJlIHRvIFJlYWQgTVMgVGVhbXMgcmVkaXIgUmVnIEtleVwiKTtBKCl9KTooZy5sb2coXCJ3aW5kb3cuZ2V0Q2l0cml4V2VicnRjUmVkaXIoKSBtZXRob2QgaXMgbm90IGF2YWlsYWJsZSB5ZXRcIiksQSgpKSl9LHNldENvZGVjQ2FwYWJpbGl0aWVzOmZ1bmN0aW9uKGEpe2cubG9nKFwiVkRJIFNoaW0gc2V0Q29kZWNDYXBhYmlsaXRpZXNcIik7bnVsbCE9PXImJnIuaXNWYWxpZCgpfHwocj1uZXcgay5OYXZpZ2F0b3JVc2VyTWVkaWEpO3JldHVybiByLnNldENvZGVjQ2FwYWJpbGl0aWVzKGEpfSxjcmVhdGVNZWRpYVN0cmVhbTpmdW5jdGlvbihhKXtnLmxvZyhcIlZESSBTaGltIGNyZWF0ZU1lZGlhU3RyZWFtXCIpO2IoKTtyZXR1cm4gbmV3IGsuUmVtb3RlU3RyZWFtKG51bGwsMCwwLGEpfSxnZXRDYXBhYmlsaXRpZXM6ZnVuY3Rpb24oYSl7YigpO2cubG9nKFwiVkRJIFNoaW0gZ2V0Q2FwYWJpbGl0aWVzXCIpO251bGwhPT1yJiZyLmlzVmFsaWQoKXx8XHJcbihyPW5ldyBrLk5hdmlnYXRvclVzZXJNZWRpYSxxPWsuTmF2aWdhdG9yVXNlck1lZGlhLmdldENhcGFiaWxpdGllcyk7cmV0dXJuIHEuYXBwbHkocixhcmd1bWVudHMpfSxkZXN0cm95VmlkZW9FbGVtZW50OmZ1bmN0aW9uKGEsYil7Zy5sb2coXCJWREkgU2hpbSBkZXN0cm95VmlkZW9FbGVtZW50OiBcIik7aWYoYSl7dmFyIGM9YS5yZW1vdGVWaWRlb0VsZW1lbnQ7YyYmYy5kaXNwb3NlKCk7YS5yZW1vdGVWaWRlb0VsZW1lbnQ9dm9pZCAwfX0sZGVzdHJveUF1ZGlvRWxlbWVudDpmdW5jdGlvbihhLGIsYyl7Zy5sb2coXCJWREkgU2hpbSBkZXN0cm95QXVkaW9FbGVtZW50OiBcIik7YSYmKChiPWEucmVtb3RlQXVkaW9FbGVtZW50KSYmYi5kaXNwb3NlKCksYS5yZW1vdGVBdWRpb0VsZW1lbnQ9dm9pZCAwKX19fSl9LDY3OTpmdW5jdGlvbihiLGEsYyl7dmFyIGQ9dGhpcyYmdGhpcy5fX2V4dGVuZHN8fGZ1bmN0aW9uKCl7dmFyIGE9ZnVuY3Rpb24oYixjKXthPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8XHJcbntfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oYSxiKXthLl9fcHJvdG9fXz1ifXx8ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGMgaW4gYiliLmhhc093blByb3BlcnR5KGMpJiYoYVtjXT1iW2NdKX07cmV0dXJuIGEoYixjKX07cmV0dXJuIGZ1bmN0aW9uKGIsYyl7ZnVuY3Rpb24gZCgpe3RoaXMuY29uc3RydWN0b3I9Yn1hKGIsYyk7Yi5wcm90b3R5cGU9bnVsbD09PWM/T2JqZWN0LmNyZWF0ZShjKTooZC5wcm90b3R5cGU9Yy5wcm90b3R5cGUsbmV3IGQpfX0oKTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgZT1jKDY1OCksaz1jKDU1MCksbT1jKDg1MSkscD1jKDk0NiksbD1jKDU1MCksZz1mdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihhKXt0aGlzLng9TWF0aC5yb3VuZChhLngpKndpbmRvdy5kZXZpY2VQaXhlbFJhdGlvO3RoaXMueT1NYXRoLnJvdW5kKGEueSkqd2luZG93LmRldmljZVBpeGVsUmF0aW87dGhpcy53aWR0aD1cclxuTWF0aC5yb3VuZChhLndpZHRoKSp3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbzt0aGlzLmhlaWdodD1NYXRoLnJvdW5kKGEuaGVpZ2h0KSp3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpb319KCk7YS5WaWRlb1JlY3Q9Zzt2YXIgRzsoZnVuY3Rpb24oYSl7YVthLnBpeGVscz0wXT1cInBpeGVsc1wiO2FbYS5wZXJjZW50PTFdPVwicGVyY2VudFwifSkoR3x8KEc9e30pKTt2YXIgdj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYil7dGhpcy52YWx1ZT1wYXJzZUludChiKTt0aGlzLnVuaXRzPXRoaXMuZGV0ZWN0VW5pdHMoYil9YS5wcm90b3R5cGUuZGV0ZWN0VW5pdHM9ZnVuY3Rpb24oYSl7cmV0dXJuLTE9PT1hLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihcInB4XCIpP0cucGl4ZWxzOkcucGVyY2VudH07cmV0dXJuIGF9KCksdDsoZnVuY3Rpb24oYSl7YVthLmZpbGw9MF09XCJmaWxsXCI7YVthLmNvbnRhaW49MV09XCJjb250YWluXCI7YVthLmNvdmVyPTJdPVwiY292ZXJcIn0pKHR8fCh0PXt9KSk7dmFyIHo9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxcclxuYil7dGhpcy54PWE7dGhpcy55PWJ9fSgpLHU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsYyxkKXt0aGlzLmZpdD10aGlzLmNvbnZlcnRGaXQoYik7dGhpcy5wb3NpdGlvbj1uZXcgeihjLGQpfWEucHJvdG90eXBlLmNvbnZlcnRGaXQ9ZnVuY3Rpb24oYSl7cmV0dXJuXCJmaWxsXCI9PWE/dC5maWxsOlwiY29udGFpblwiPT1hP3QuY29udGFpbjpcImNvdmVyXCI9PWE/dC5jb3Zlcjp0LmZpbGx9O3JldHVybiBhfSgpO2I9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjKXt2YXIgZD1hLmNhbGwodGhpcyxudWxsLGsuY2xhc3NfaWRfdC5WaWRlb0VsZW1lbnQsMCxlLlByb3h5TW9kZS5Mb2NhbCl8fHRoaXM7ZC5zcmNPYmplY3RfPW51bGw7ZC5zaW5rSWRfPVwiXCI7ZC52aWRlb1dpZHRoPTA7ZC52aWRlb0hlaWdodD0wO2QuaXNMb2FkZWQ9ITE7ZC5jb25uZWN0aW9uU3RhdGU9XCJkaXNjb25uZWN0ZWRcIjtkLnN0eWxlT2JzZXJ2ZXI9bnVsbDtkLnBlbmRpbmdSZWxlYXNlXz0hMTtkLmFjdGl2ZUNvbm5lY3Rpb25FdmVudF89XHJcbm51bGw7ZC5jb25uZWN0aW9uRXZlbnRRdWV1ZV89W107ZC5lbGVtZW50SWQ9YztyZXR1cm4gZH1kKGIsYSk7Yi5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhcIlZpZGVvRWxlbWVudC5kaXNwb3NlIChlbGVtZW50SWQ6IFwiK3RoaXMuZWxlbWVudElkK1wiIG9pZDogXCIrdGhpcy5vYmplY3RfaWQoKStcIilcIik7dGhpcy5wZW5kaW5nUmVsZWFzZV89ITA7dGhpcy5zcmNPYmplY3Q9dGhpcy5vbnRpbWV1cGRhdGU9dGhpcy5vbmxvYWRlZG1ldGFkYXRhPW51bGx9O2IucHJvdG90eXBlLnNldFN0YXRlPWZ1bmN0aW9uKGEpe3RoaXMuY29ubmVjdGlvblN0YXRlPWE7aWYodGhpcy5vbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZV8pdGhpcy5vbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZV8oKX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwic2lua0lkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNpbmtJZF99LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO1xyXG50aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIlZpZGVvRWxlbWVudC5zaW5rSWRcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBiLnJlbW90ZUludm9rZSghMCxrLm1ldGhvZF9pZF9WaWRlb0VsZW1lbnRfdC5zaW5rSWQsYSl9KS50aGVuKGZ1bmN0aW9uKCl7Yi5zaW5rSWRfPWF9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfc2lua0lkKCkgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInNyY09iamVjdFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zcmNPYmplY3RffSxzZXQ6ZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNyY09iamVjdDogc2V0IHNyY09iamVjdC4uLiB0aGlzLnNyY09iamVjdDpcIit0aGlzLnNyY09iamVjdCtcIiBvYmo6XCIrYSk7aWYodGhpcy5zcmNPYmplY3RfIT09YSl7dmFyIGI9XHJcbnAuZ2V0UmVkaXJlY3RvcigpLmdldEZlYXR1cmVWYWx1ZShsLkZFQVRVUkVfbXNfdGVhbXNfMTkxMSk7bnVsbCE9PXRoaXMuc3JjT2JqZWN0XyYmKG51bGw9PT1hJiZiJiZ0aGlzLmRpc2Nvbm5lY3QoKSxifHx0aGlzLmRpc2Nvbm5lY3QoKSx0aGlzLmlzTG9hZGVkPSExKTt0aGlzLnNyY09iamVjdF89YTtudWxsIT09dGhpcy5zcmNPYmplY3RfJiZ0aGlzLmNvbm5lY3RUbyh0aGlzLnNyY09iamVjdF8pfX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZV99LHNldDpmdW5jdGlvbihhKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uY29ubmVjdGlvbnN0YXRlY2hhbmdlKCkgY2FsbGVkLlwiKTt0aGlzLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlXz1cclxuYX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbmxvYWRlZG1ldGFkYXRhXCIse3NldDpmdW5jdGlvbihhKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29ubG9hZGVkbWV0YWRhdGEoKSBjYWxsZWQuXCIpO3RoaXMub25sb2FkZWRtZXRhZGF0YV89YX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtiLnByb3RvdHlwZS5zZXR1cE9uVmlkZW9GcmFtZUNoYW5nZWQ9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9dGhpcy5yZWdpc3RlckNhbGxiYWNrcyghMSwhMSxrLm1ldGhvZF9pZF9WaWRlb0VsZW1lbnRfdC5vbnZpZGVvZnJhbWVjaGFuZ2VkKTtiLnRoZW4oZnVuY3Rpb24oYil7bS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLm9udmlkZW9mcmFtZWNoYW5nZWRcIixiLnBhcmFtcyk7YS52aWRlb1dpZHRoPWIucGFyYW1zWzBdfHwwO2EudmlkZW9IZWlnaHQ9XHJcbmIucGFyYW1zWzFdfHwwO2EuaXNMb2FkZWR8fChhLmlzTG9hZGVkPSEwLGEub25sb2FkZWRtZXRhZGF0YV8mJmEub25sb2FkZWRtZXRhZGF0YV8oKSl9KTt0aGlzLnJlbW90ZUludm9rZSghMCxrLm1ldGhvZF9pZF9WaWRlb0VsZW1lbnRfdC5vbnZpZGVvZnJhbWVjaGFuZ2VkLGIuc3VjY2Vzcyl9O2IucHJvdG90eXBlLnByb2Nlc3NDb25uZWN0aW9uRXZlbnQ9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2lmKDAhPT10aGlzLmNvbm5lY3Rpb25FdmVudFF1ZXVlXy5sZW5ndGgmJiF0aGlzLmFjdGl2ZUNvbm5lY3Rpb25FdmVudF8pe3ZhciBiPXRoaXMuY29ubmVjdGlvbkV2ZW50UXVldWVfLnBvcCgpO1wiY29ubmVjdFRvXCI9PWIub3BlcmF0aW9uP3RoaXMuYWN0aXZlQ29ubmVjdGlvbkV2ZW50Xz10aGlzLmNvbm5lY3RUb0FzeW5jKGIucGFyYW0pOlwiZGlzY29ubmVjdFwiPT1iLm9wZXJhdGlvbiYmKHRoaXMuYWN0aXZlQ29ubmVjdGlvbkV2ZW50Xz10aGlzLmRpc2Nvbm5lY3RBc3luYygpKTt0aGlzLmFjdGl2ZUNvbm5lY3Rpb25FdmVudF8udGhlbihmdW5jdGlvbigpe2EuYWN0aXZlQ29ubmVjdGlvbkV2ZW50Xz1cclxudm9pZCAwO2EucHJvY2Vzc0Nvbm5lY3Rpb25FdmVudCgpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIiA6IEZhaWxlZCB0byBoYW5kbGUgY29ubmVjdGlvbiBldmVudCEgXCIpO2EuYWN0aXZlQ29ubmVjdGlvbkV2ZW50Xz12b2lkIDA7YS5wcm9jZXNzQ29ubmVjdGlvbkV2ZW50KCl9KX19O2IucHJvdG90eXBlLmNvbm5lY3RUbz1mdW5jdGlvbihhKXt0aGlzLmNvbm5lY3Rpb25FdmVudFF1ZXVlXy5wdXNoKHtvcGVyYXRpb246XCJjb25uZWN0VG9cIixwYXJhbTphfSk7dGhpcy5wcm9jZXNzQ29ubmVjdGlvbkV2ZW50KCl9O2IucHJvdG90eXBlLmRpc2Nvbm5lY3Q9ZnVuY3Rpb24oKXt0aGlzLmNvbm5lY3Rpb25FdmVudFF1ZXVlXy5wdXNoKHtvcGVyYXRpb246XCJkaXNjb25uZWN0XCIscGFyYW06bnVsbH0pO3RoaXMucHJvY2Vzc0Nvbm5lY3Rpb25FdmVudCgpfTtiLnByb3RvdHlwZS5jb25uZWN0VG9Bc3luYz1mdW5jdGlvbihhKXt2YXIgYj1cclxudGhpcztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxkKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY29ubmVjdFRvOiBjb25uZWN0IG1lZGlhIHN0cmVhbSB3aXRoIGlkID0gXCIrYS5pZCtcIiwgY2xvbmVfaWQgPSBcIithLmNsb25lX3N0YXRlLmNsb25lX2lkKTtiLnN0cmVhbUlkXz1hLmlkO2Iud2FpdFVudGlsQ29ubmVjdGVkKFwiVmlkZW9FbGVtZW50LmNvbm5lY3RUb1wiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGEud2FpdFVudGlsQ29ubmVjdGVkKFwiTWVkaWFTdHJlYW0uY29ubmVjdFRvXCIpfSkudGhlbihmdW5jdGlvbigpe2Iuc2V0dXBPblZpZGVvRnJhbWVDaGFuZ2VkKCk7cmV0dXJuIGEuY2xvbmVfc3RhdGUuc3luY2hyb25pemUoYSl9KS50aGVuKGZ1bmN0aW9uKGEpe20ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jb25uZWN0VG86IHJlbW90ZSBpbnZva2luZ1wiKTt2YXIgYz1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCEwLCExLGsubWV0aG9kX2lkX1ZpZGVvRWxlbWVudF90LmNvbm5lY3RUbyk7XHJcbnJldHVybiBQcm9taXNlLmFsbChbYi5yZW1vdGVJbnZva2UoITEsay5tZXRob2RfaWRfVmlkZW9FbGVtZW50X3QuY29ubmVjdFRvLHtvaWQ6YS5vYmplY3RfaWQoKX0sYy5zdWNjZXNzLGMuZmFpbCksYy5wcm9tKCldKX0pLnRoZW4oZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLmNvbm5lY3RUbzogcmVtb3RlIG1lZGlhIHN0cmVhbSBpcyBjb25uZWN0ZWQhXCIpO2Iuc2V0U3RhdGUoXCJjb25uZWN0ZWRcIik7Yi53YXRjaCgpO2IudXBkYXRlVGltZXI9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtiLm9udGltZXVwZGF0ZSYmYi5vbnRpbWV1cGRhdGUoKX0sMjUwKTsoYT13aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYi5lbGVtZW50SWQpKSYmYi51cGRhdGVTdHlsZShhKTtjKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5jb25uZWN0VG86IGZhaWxlZCB0byBjb25uZWN0IVwiKTtkKCl9KX0pfTtiLnByb3RvdHlwZS5kaXNjb25uZWN0QXN5bmM9XHJcbmZ1bmN0aW9uKCl7dmFyIGE9dGhpcztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixjKXttLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZGlzY29ubmVjdDogZGlzY29ubmVjdGluZyBzdHJlYW0gOiBcIithLnN0cmVhbUlkXyk7YS51bndhdGNoKCk7YS53YWl0VW50aWxDb25uZWN0ZWQoXCJWaWRlb0VsZW1lbnQuZGlzY29ubmVjdFwiKS50aGVuKGZ1bmN0aW9uKCl7YS51cGRhdGVUaW1lciYmY2xlYXJJbnRlcnZhbChhLnVwZGF0ZVRpbWVyKTt2YXIgYj1hLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLCEwLGsubWV0aG9kX2lkX1ZpZGVvRWxlbWVudF90Lm9udmlkZW9mcmFtZWNoYW5nZWQpO2EucmVtb3RlSW52b2tlKCEwLGsubWV0aG9kX2lkX1ZpZGVvRWxlbWVudF90Lm9udmlkZW9mcmFtZWNoYW5nZWQsYi5zdWNjZXNzKTtyZXR1cm4gYS5yZW1vdGVJbnZva2UoITEsay5tZXRob2RfaWRfVmlkZW9FbGVtZW50X3QuZGlzY29ubmVjdCl9KS50aGVuKGZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5kaXNjb25uZWN0OiByZW1vdGUgbWVkaWEgc3RyZWFtIGlzIGRpc2Nvbm5lY3RlZCFcIik7YS5zZXRTdGF0ZShcImRpc2Nvbm5lY3RlZFwiKTsxPT1hLnBlbmRpbmdSZWxlYXNlXyYmKGEucGVuZGluZ1JlbGVhc2VfPSExLGEub25jb25uZWN0aW9uc3RhdGVjaGFuZ2U9bnVsbCxhLnJlbGVhc2UoKSk7YigpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuZGlzY29ubmVjdDogZmFpbGVkIHRvIGNvbm5lY3QhXCIpO2MoKX0pfSl9O2IucHJvdG90eXBlLnNldEZyYW1lPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldEZyYW1lOiBzZXQgdmlkZW8gZnJhbWUgdG9cIixhLngsYS55LGEud2lkdGgsYS5oZWlnaHQpO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiVmlkZW9FbGVtZW50LnNldEZyYW1lXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1uZXcgZyhhKTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITEsXHJcbmsubWV0aG9kX2lkX1ZpZGVvRWxlbWVudF90LnNldEZyYW1lLGMpfSkudGhlbihmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRGcmFtZTogc3VjY2VzcyFcIil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRGcmFtZTogZmFpbGVkIHRvIGNvbm5lY3QhXCIpfSl9O2IucHJvdG90eXBlLmFkZENsaXBSZWN0PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmFkZENsaXBSZWN0OiBcIixKU09OLnN0cmluZ2lmeShhKSk7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJWaWRlb0VsZW1lbnQuYWRkQ2xpcFJlY3RcIikudGhlbihmdW5jdGlvbigpe3ZhciBjPW5ldyBnKGEpO3JldHVybiBiLnJlbW90ZUludm9rZSghMSxrLm1ldGhvZF9pZF9WaWRlb0VsZW1lbnRfdC5hZGRDbGlwUmVjdCxjKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFxyXG5cIi5hZGRDbGlwUmVjdCBmYWlsZWQhXCIpfSl9O2IucHJvdG90eXBlLnJlbW92ZUNsaXBSZWN0PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnJlbW92ZUNsaXBSZWN0OiBcIixKU09OLnN0cmluZ2lmeShhKSk7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJWaWRlb0VsZW1lbnQucmVtb3ZlQ2xpcFJlY3RcIikudGhlbihmdW5jdGlvbigpe3ZhciBjPW5ldyBnKGEpO3JldHVybiBiLnJlbW90ZUludm9rZSghMSxrLm1ldGhvZF9pZF9WaWRlb0VsZW1lbnRfdC5yZW1vdmVDbGlwUmVjdCxjKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnJlbW92ZUNsaXBSZWN0IGZhaWxlZCFcIil9KX07Yi5wcm90b3R5cGUud2F0Y2g9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2lmKHAuZ2V0UmVkaXJlY3RvcigpLmdldEZlYXR1cmVWYWx1ZShsLkZFQVRVUkVfbXNfdGVhbXNfdmlkZW9fcGxhY2VtZW50KSl7dmFyIGI9XHJcbndpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmVsZW1lbnRJZCk7YiYmKHRoaXMudW53YXRjaCgpLHRoaXMuc3R5bGVPYnNlcnZlcj1uZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihiKXtiLmZvckVhY2goZnVuY3Rpb24oYil7XCJzdHlsZVwiPT1iLmF0dHJpYnV0ZU5hbWU/YS51cGRhdGVTdHlsZShiLnRhcmdldCk6YS5lbGVtZW50SWQ9Yi50YXJnZXQuaWR9KX0pLHRoaXMuc3R5bGVPYnNlcnZlci5vYnNlcnZlKGIse2F0dHJpYnV0ZXM6ITAsYXR0cmlidXRlT2xkVmFsdWU6ITAsYXR0cmlidXRlRmlsdGVyOltcInN0eWxlXCIsXCJpZFwiXX0pKX19O2IucHJvdG90eXBlLnVud2F0Y2g9ZnVuY3Rpb24oKXt0aGlzLnN0eWxlT2JzZXJ2ZXImJih0aGlzLnN0eWxlT2JzZXJ2ZXIuZGlzY29ubmVjdCgpLHRoaXMuc3R5bGVPYnNlcnZlcj1udWxsKX07Yi5wcm90b3R5cGUudXBkYXRlU3R5bGU9ZnVuY3Rpb24oYSl7aWYoXCJjb25uZWN0ZWRcIj09dGhpcy5jb25uZWN0aW9uU3RhdGUpe3ZhciBiPVxyXG53aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShhKS5nZXRQcm9wZXJ0eVZhbHVlKFwib2JqZWN0LWZpdFwiKSxjPXdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGEpLmdldFByb3BlcnR5VmFsdWUoXCJvYmplY3QtcG9zaXRpb25cIikuc3BsaXQoXCIgXCIpO2E9bmV3IHYoY1swXSk7Yz1uZXcgdihjWzFdKTt0aGlzLnBsYWNlbWVudD1uZXcgdShiLGEsYyl9ZWxzZSBtLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIudXBkYXRlU3R5bGU6IHZpZGVvIGVsZW1lbnQgaXMgbm90IGNvbm5lY3RlZFwiKX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwicGxhY2VtZW50XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnBsYWNlbWVudF99LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO3AuZ2V0UmVkaXJlY3RvcigpLmdldEZlYXR1cmVWYWx1ZShsLkZFQVRVUkVfbXNfdGVhbXNfdmlkZW9fcGxhY2VtZW50KT90aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIlZpZGVvRWxlbWVudC5wbGFjZW1lbnRcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBiLnJlbW90ZUludm9rZSghMCxcclxuay5tZXRob2RfaWRfVmlkZW9FbGVtZW50X3QucGxhY2VtZW50LGEpfSkudGhlbihmdW5jdGlvbigpe2IucGxhY2VtZW50Xz1hfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIucGxhY2VtZW50IHNldHRlcjogZmFpbGVkIHRvIGNvbm5lY3QhXCIpfSk6bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnBsYWNlbWVudDogdmlkZW8gcGxhY2VtZW50IGZlYXR1cmUgaXMgbm90IHN1cHBvcnRlZCBvbiBhIGNsaWVudFwiKX0sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITB9KTtyZXR1cm4gYn0oZS5Qcm94eU9iamVjdCk7YS5WaWRlb0VsZW1lbnQ9Yn0sMjY5OmZ1bmN0aW9uKGIsYSl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7YS5GRUFUVVJFX21zX3RlYW1zX3JlZGlyZWN0aW9uPVwibXNfdGVhbXNfcmVkaXJlY3Rpb25cIjthLkZFQVRVUkVfdW5zdXBwb3J0ZWQ9XCJ1bnN1cHBvcnRlZFwiO1xyXG52YXIgYz1mdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihhLGIsYyxkKXt0aGlzLm1ham9yPWE7dGhpcy5taW5vcj1iO3RoaXMucmV2aXNpb249Yzt0aGlzLmJ1aWxkPWR9fSgpO2EuVmVyc2lvbkRhdGE9YztjPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7fX0oKTthLkZlYXR1cmVEYXRhPWM7Yz1mdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihhLGIpe3RoaXMuZmF0dXJlPWE7dGhpcy52ZXJzaW9uPWJ9fSgpO2EuV2VicnBjRmVhdHVyZUluZm89YztjPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYixjLGQsZSl7dGhpcy5mYW1pbHk9YTt0aGlzLnZlcnNpb249Yjt0aGlzLmFyY2hpdGVjdHVyZT1jO3RoaXMuZGlzdHJvPWQ7dGhpcy5lZGl0aW9uPWV9fSgpO2EuT1NJbmZvPWM7Yz1mdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihhLGIpe3RoaXMubWFjaGluZV9pZD1hO3RoaXMudXNlcl9pZD1ifX0oKTthLkVuZHBvaW50SWQ9YztjPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGIsXHJcbmMsZCxlLGspe3ZvaWQgMD09PWsmJihrPWEuRkVBVFVSRV9tc190ZWFtc19yZWRpcmVjdGlvbik7dGhpcy5paWQ9Yjt0aGlzLm1pZD1jO3RoaXMubmFtZT1kO3RoaXMuaXNwcm9wPWU7dGhpcy5mZWF0dXJlPWt9fSgpO2EuV2VicnBjTWV0aG9kSW5mbz1jO2M9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiLGMpe3RoaXMuaWQ9YTt0aGlzLm5hbWU9Yjt0aGlzLm1ldGhvZHM9Y319KCk7YS5XZWJycGNDbGFzc0luZm89YztjPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYil7dGhpcy5uYW1lPWE7dGhpcy5jbGFzc2VzPWJ9fSgpO2EuV2VicnBjQ2xhc3NMaWJJbmZvPWN9LDU1MDpmdW5jdGlvbihiLGEsYyl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGQ9YygxODcpOyhmdW5jdGlvbihiKXtmb3IodmFyIGMgaW4gYilhLmhhc093blByb3BlcnR5KGMpfHwoYVtjXT1iW2NdKX0pKGMoMTg3KSk7Yj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt9XHJcbmEuZ2V0SW50ZXJmYWNlQnlpZD1mdW5jdGlvbihhKXtmb3IodmFyIGI9MCxjPWQuY2xhc3NfbGliX2luZm8uY2xhc3NlcztiPGMubGVuZ3RoO2IrKyl7dmFyIGU9Y1tiXTtpZihlLmlkPT1hKXJldHVybiBlfXJldHVybiBudWxsfTthLmdldE1ldGhvZEJ5aWQ9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldEludGVyZmFjZUJ5aWQoYSk7aWYobnVsbCE9Yylmb3IodmFyIGQ9MCxjPWMubWV0aG9kcztkPGMubGVuZ3RoO2QrKyl7dmFyIGU9Y1tkXTtpZihlLm1pZD09YilyZXR1cm4gZX1yZXR1cm4gbnVsbH07YS5nZXRNZXRob2RGZWF0dXJlQnlpZD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0SW50ZXJmYWNlQnlpZChhKTtpZihudWxsIT1jKWZvcih2YXIgZD0wLGM9Yy5tZXRob2RzO2Q8Yy5sZW5ndGg7ZCsrKXt2YXIgZT1jW2RdO2lmKGUubWlkPT1iKXJldHVybiBlLmZlYXR1cmV9cmV0dXJuIG51bGx9O2EuY29tcG9zZUNsYXNzSW5mb0RhdGE9ZnVuY3Rpb24oYSl7YT1hLmhkcjtcclxuaWYodm9pZCAwPT1hKXJldHVyblwiKioqIEludmFsaWQgcGFja2V0OiBDb3VsZG4ndCBmaW5kIGhkciBvYmplY3QgKioqXCI7dmFyIGI9YS5wcm9jO2lmKHZvaWQgMD09YilyZXR1cm5cIlwiO2E9Yi5paWQ7Zm9yKHZhciBiPWIubWV0aG9kaWQsYz0wLGU9ZC5jbGFzc19saWJfaW5mby5jbGFzc2VzO2M8ZS5sZW5ndGg7YysrKXt2YXIgZz1lW2NdO2lmKGcuaWQ9PWEpZm9yKHZhciBrPTAsbj1nLm1ldGhvZHM7azxuLmxlbmd0aDtrKyspe3ZhciB0PW5ba107aWYodC5taWQ9PWIpcmV0dXJuIGcubmFtZStcIjo6XCIrdC5uYW1lfX1yZXR1cm5cIlwifTtyZXR1cm4gYX0oKTthLldlYnJwY0NsYXNzTGliSW5mb1V0aWw9Yn0sMTg3OmZ1bmN0aW9uKGIsYSxjKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTtiPWMoMjY5KTtjPWMoMjY5KTthLlZlcnNpb25EYXRhPWMuVmVyc2lvbkRhdGE7YS5GZWF0dXJlRGF0YT1jLkZlYXR1cmVEYXRhO2EuT1NJbmZvPWMuT1NJbmZvO1xyXG5hLkVuZHBvaW50SWQ9Yy5FbmRwb2ludElkO2EuQlVJTERfVFlQRV9TREs9ITA7YS5IRFhNU19WRVJTSU9OPVwiMi4wLjAuNVwiO2EuRkVBVFVSRV92ZGFfc2VydmljZV9ub19idWZmZXJfbGltaXQ9XCJ3c3NlcnZpY2Vfbm9fYnVmZmVyX2xpbWl0XCI7YS5GRUFUVVJFX3ZkYV9hcHBfc2hhcmluZz1cIndlYnJ0Y19hcHBfc2hhcmluZ1wiO2EuRkVBVFVSRV92ZGFfbXVsdGlfd2luZG93PVwid2VicnRjX211bHRpX3dpbmRvd1wiO2EuRkVBVFVSRV9tc190ZWFtc19kZXNrdG9wX3NoYXJpbmc9XCJtc190ZWFtc19kZXNrdG9wX3NoYXJpbmdcIjthLkZFQVRVUkVfbXNfdGVhbXNfc3BlYWtpbmdfaW5kaWNhdG9yPVwibXNfdGVhbXNfc3BlYWtpbmdfaW5kaWNhdG9yXCI7YS5GRUFUVVJFX21zX3RlYW1zX2NvbW1vbl9tZWRpYV9jb25zdHJhaW50cz1cIm1zX3RlYW1zX2NvbW1vbl9tZWRpYV9jb25zdHJhaW50c1wiO2EuRkVBVFVSRV9tc190ZWFtc18xOTExPVwibXNfdGVhbXNfMTkxMVwiO2EuRkVBVFVSRV9tc190ZWFtc19wc3RuPVxyXG5cIm1zX3RlYW1zX3BzdG5cIjthLkZFQVRVUkVfbXNfdGVhbXNfMTkxMj1cIm1zX3RlYW1zXzE5MTJcIjthLkZFQVRVUkVfbXNfdGVhbXNfbXN0cmFja19jb25zdHJhaW50cz1cIm1zX3RlYW1zX21zdHJhY2tfY29uc3RyYWludHNcIjthLkZFQVRVUkVfbXNfdGVhbXNfb3NpbmZvPVwibXNfdGVhbXNfb3NpbmZvXCI7YS5GRUFUVVJFX21zX3RlYW1zX2VuZHBvaW50X2lkPVwibXNfdGVhbXNfZW5kcG9pbnRfaWRcIjthLkZFQVRVUkVfbXNfdGVhbXNfcmVtb3RlX2F1ZGlvX25vdGlmaWNhdGlvbnM9XCJtc190ZWFtc19yZW1vdGVfYXVkaW9fbm90aWZpY2F0aW9uc1wiO2EuRkVBVFVSRV9tc190ZWFtc19kZXZpY2VfZ3JvdXBfaWQ9XCJtc190ZWFtc19kZXZpY2VfZ3JvdXBfaWRcIjthLkZFQVRVUkVfbXNfdGVhbXNfZHRtZj1cIm1zX3RlYW1zX2R0bWZcIjthLkZFQVRVUkVfbXNfdGVhbXNfdmlkZW9fcGxhY2VtZW50PVwibXNfdGVhbXNfdmlkZW9fcGxhY2VtZW50XCI7YS5GRUFUVVJFX21zX3RlYW1zX2NvZGVjX2NhcGFiaWxpdHk9XHJcblwibXNfdGVhbXNfY29kZWNfY2FwYWJpbGl0eVwiO2EuRkVBVFVSRV9tc190ZWFtc19tdWx0aV93aW5kb3c9XCJtc190ZWFtc19tdWx0aV93aW5kb3dzXCI7YS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MD1cIm1zX3RlYW1zX3dlYnJ0Y18xLjBcIjthLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsPVwibXNfdGVhbXNfZGF0YV9jaGFubmVsXCI7YS5GRUFUVVJFX21zX3RlYW1zX25vX3ZkX2J1ZmZlcl9saW1pdD1cIm1zX3RlYW1zX25vX3ZkX2J1ZmZlcl9saW1pdFwiO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGIuRkVBVFVSRV9tc190ZWFtc19yZWRpcmVjdGlvbixuZXcgYi5WZXJzaW9uRGF0YSgxLDEsMCwwKSk7bmV3IGIuV2VicnBjRmVhdHVyZUluZm8oYS5GRUFUVVJFX21zX3RlYW1zX2Rlc2t0b3Bfc2hhcmluZyxuZXcgYi5WZXJzaW9uRGF0YSgxLDIsMCwwKSk7bmV3IGIuV2VicnBjRmVhdHVyZUluZm8oYS5GRUFUVVJFX21zX3RlYW1zX3NwZWFraW5nX2luZGljYXRvcixuZXcgYi5WZXJzaW9uRGF0YSgxLFxyXG4yLDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19jb21tb25fbWVkaWFfY29uc3RyYWludHMsbmV3IGIuVmVyc2lvbkRhdGEoMSw0LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc18xOTExLG5ldyBiLlZlcnNpb25EYXRhKDEsNCwwLDApKTtuZXcgYi5XZWJycGNGZWF0dXJlSW5mbyhhLkZFQVRVUkVfbXNfdGVhbXNfMTkxMixuZXcgYi5WZXJzaW9uRGF0YSgxLDUsMCwwKSk7bmV3IGIuV2VicnBjRmVhdHVyZUluZm8oYS5GRUFUVVJFX21zX3RlYW1zX21zdHJhY2tfY29uc3RyYWludHMsbmV3IGIuVmVyc2lvbkRhdGEoMSw2LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19wc3RuLG5ldyBiLlZlcnNpb25EYXRhKDEsNiwwLDApKTtuZXcgYi5XZWJycGNGZWF0dXJlSW5mbyhhLkZFQVRVUkVfbXNfdGVhbXNfb3NpbmZvLG5ldyBiLlZlcnNpb25EYXRhKDEsNywwLDApKTtcclxubmV3IGIuV2VicnBjRmVhdHVyZUluZm8oYS5GRUFUVVJFX21zX3RlYW1zX2VuZHBvaW50X2lkLG5ldyBiLlZlcnNpb25EYXRhKDEsNywwLDApKTtuZXcgYi5XZWJycGNGZWF0dXJlSW5mbyhhLkZFQVRVUkVfbXNfdGVhbXNfcmVtb3RlX2F1ZGlvX25vdGlmaWNhdGlvbnMsbmV3IGIuVmVyc2lvbkRhdGEoMSw3LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19kZXZpY2VfZ3JvdXBfaWQsbmV3IGIuVmVyc2lvbkRhdGEoMSw3LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19jb2RlY19jYXBhYmlsaXR5LG5ldyBiLlZlcnNpb25EYXRhKDEsNywwLDApKTtuZXcgYi5XZWJycGNGZWF0dXJlSW5mbyhhLkZFQVRVUkVfbXNfdGVhbXNfZHRtZixuZXcgYi5WZXJzaW9uRGF0YSgxLDcsMCwwKSk7bmV3IGIuV2VicnBjRmVhdHVyZUluZm8oYS5GRUFUVVJFX21zX3RlYW1zX3ZpZGVvX3BsYWNlbWVudCxuZXcgYi5WZXJzaW9uRGF0YSgxLFxyXG43LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDAsbmV3IGIuVmVyc2lvbkRhdGEoMSw4LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwsbmV3IGIuVmVyc2lvbkRhdGEoMSw4LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19tdWx0aV93aW5kb3csbmV3IGIuVmVyc2lvbkRhdGEoMSwxNCwwLDApKTtjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe31hLkZFQVRVUkVfcHVibGljX3NjcmVlbnNoYXJlPVwic2NyZWVuc2hhcmVcIjthLkZFQVRVUkVfcHVibGljX3JlZGlyZWN0aW9uPVwicmVkaXJlY3Rpb25cIjthLkZFQVRVUkVfcHVibGljX3NwZWFraW5nX2luZGljYXRvcj1cInNwZWFraW5nX2luZGljYXRvclwiO2EuRkVBVFVSRV9wdWJsaWNfcHN0bj1cInBzdG5cIjthLkZFQVRVUkVfcHVibGljX29zaW5mbz1cIm9zaW5mb1wiO2EuRkVBVFVSRV9wdWJsaWNfZW5kcG9pbnRfaWQ9XHJcblwiZW5kcG9pbnRpZFwiO2EuRkVBVFVSRV9wdWJsaWNfcmVtb3RlX2F1ZGlvX25vdGlmaWNhdGlvbnM9XCJyZW1vdGVhdWRpb25vdGlmaWNhdGlvbnNcIjthLkZFQVRVUkVfcHVibGljX2RldmljZV9ncm91cF9pZD1cImNvbXBvc2l0ZWRldmljZXNcIjthLkZFQVRVUkVfcHVibGljX2R0bWY9XCJkdG1mXCI7YS5GRUFUVVJFX3B1YmxpY19tb25pdG9yX3NoYXJpbmc9XCJtdWx0aW1vbml0b3JzY3JlZW5zaGFyZVwiO2EuRkVBVFVSRV9wdWJsaWNfYXBwX3NoYXJpbmc9XCJhcHBzaGFyZVwiO2EuRkVBVFVSRV9wdWJsaWNfY29kZWNfY2FwYWJpbGl0eT1cImNvZGVjX2NhcGFiaWxpdHlcIjthLkZFQVRVUkVfcHVibGljX3dlYnJ0YzFkb3QwPVwid2VicnRjMS4wXCI7YS5GRUFUVVJFX3B1YmxpY19kYXRhX2NoYW5uZWw9XCJkYXRhY2hhbm5lbFwiO2EuRkVBVFVSRV9wdWJsaWNfdmRub2J1ZmxpbWl0PVwidmRub2J1ZmxpbWl0XCI7YS5GRUFUVVJFX3B1YmxpY19tdWx0aV93aW5kb3c9XCJtdWx0aXdpbmRvd1wiO3JldHVybiBhfSgpO1xyXG5hLkZlYXR1cmVzPWM7YS5mZWF0dXJlTmFtZU1hcD17fTthLmZlYXR1cmVOYW1lTWFwW2MuRkVBVFVSRV9wdWJsaWNfc2NyZWVuc2hhcmVdPVthLkZFQVRVUkVfbXNfdGVhbXNfZGVza3RvcF9zaGFyaW5nXTthLmZlYXR1cmVOYW1lTWFwW2MuRkVBVFVSRV9wdWJsaWNfcmVkaXJlY3Rpb25dPVtiLkZFQVRVUkVfbXNfdGVhbXNfcmVkaXJlY3Rpb25dO2EuZmVhdHVyZU5hbWVNYXBbYy5GRUFUVVJFX3B1YmxpY19zcGVha2luZ19pbmRpY2F0b3JdPVthLkZFQVRVUkVfbXNfdGVhbXNfc3BlYWtpbmdfaW5kaWNhdG9yXTthLmZlYXR1cmVOYW1lTWFwW2MuRkVBVFVSRV9wdWJsaWNfcHN0bl09W2EuRkVBVFVSRV9tc190ZWFtc19wc3RuXTthLmZlYXR1cmVOYW1lTWFwW2MuRkVBVFVSRV9wdWJsaWNfb3NpbmZvXT1bYS5GRUFUVVJFX21zX3RlYW1zX29zaW5mb107YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX2VuZHBvaW50X2lkXT1bYS5GRUFUVVJFX21zX3RlYW1zX2VuZHBvaW50X2lkXTtcclxuYS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX3JlbW90ZV9hdWRpb19ub3RpZmljYXRpb25zXT1bYS5GRUFUVVJFX21zX3RlYW1zX3JlbW90ZV9hdWRpb19ub3RpZmljYXRpb25zXTthLmZlYXR1cmVOYW1lTWFwW2MuRkVBVFVSRV9wdWJsaWNfZGV2aWNlX2dyb3VwX2lkXT1bYS5GRUFUVVJFX21zX3RlYW1zX2RldmljZV9ncm91cF9pZF07YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX2R0bWZdPVthLkZFQVRVUkVfbXNfdGVhbXNfZHRtZl07YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX2NvZGVjX2NhcGFiaWxpdHldPVthLkZFQVRVUkVfbXNfdGVhbXNfY29kZWNfY2FwYWJpbGl0eV07YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX3dlYnJ0YzFkb3QwXT1bYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MF07YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX211bHRpX3dpbmRvd109W2EuRkVBVFVSRV9tc190ZWFtc19tdWx0aV93aW5kb3ddO1xyXG5hLmZlYXR1cmVOYW1lTWFwW2MuRkVBVFVSRV9wdWJsaWNfZGF0YV9jaGFubmVsXT1bYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbF07YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX3Zkbm9idWZsaW1pdF09W2EuRkVBVFVSRV9tc190ZWFtc19ub192ZF9idWZmZXJfbGltaXRdOyhmdW5jdGlvbihhKXthW2EuRW5naW5lQ29udHJvbD0wXT1cIkVuZ2luZUNvbnRyb2xcIjthW2EuUlRDUGVlckNvbm5lY3Rpb249MV09XCJSVENQZWVyQ29ubmVjdGlvblwiO2FbYS5SVENTZXNzaW9uRGVzY3JpcHRpb249Ml09XCJSVENTZXNzaW9uRGVzY3JpcHRpb25cIjthW2EuUlRDSWNlQ2FuZGlkYXRlPTNdPVwiUlRDSWNlQ2FuZGlkYXRlXCI7YVthLlJUQ0ljZUNhbmRpZGF0ZUV2ZW50PTRdPVwiUlRDSWNlQ2FuZGlkYXRlRXZlbnRcIjthW2EuTWVkaWFEZXZpY2VzPTVdPVwiTWVkaWFEZXZpY2VzXCI7YVthLk1lZGlhRGV2aWNlSW5mbz02XT1cIk1lZGlhRGV2aWNlSW5mb1wiO2FbYS5NZWRpYVN0cmVhbVRyYWNrPVxyXG43XT1cIk1lZGlhU3RyZWFtVHJhY2tcIjthW2EuTWVkaWFTdHJlYW1FdmVudD04XT1cIk1lZGlhU3RyZWFtRXZlbnRcIjthW2EuTWVkaWFTdHJlYW09OV09XCJNZWRpYVN0cmVhbVwiO2FbYS5OYXZpZ2F0b3JVc2VyTWVkaWE9MTBdPVwiTmF2aWdhdG9yVXNlck1lZGlhXCI7YVthLlZpZGVvRWxlbWVudD0xMV09XCJWaWRlb0VsZW1lbnRcIjthW2EuQXVkaW9FbGVtZW50PTEyXT1cIkF1ZGlvRWxlbWVudFwiO2FbYS5SVENSdHBSZWNlaXZlcj0xM109XCJSVENSdHBSZWNlaXZlclwiO2FbYS5SVENSdHBTZW5kZXI9MTRdPVwiUlRDUnRwU2VuZGVyXCI7YVthLlJUQ0R0bHNUcmFuc3BvcnQ9MTVdPVwiUlRDRHRsc1RyYW5zcG9ydFwiO2FbYS5SVENJY2VUcmFuc3BvcnQ9MTZdPVwiUlRDSWNlVHJhbnNwb3J0XCI7YVthLlJUQ0RUTUZTZW5kZXI9MTddPVwiUlRDRFRNRlNlbmRlclwiO2FbYS5SVENEVE1GVG9uZUNoYW5nZUV2ZW50PTE4XT1cIlJUQ0RUTUZUb25lQ2hhbmdlRXZlbnRcIjthW2EuUlRDSWNlQ2FuZGlkYXRlUGFpcj0xOV09XHJcblwiUlRDSWNlQ2FuZGlkYXRlUGFpclwiO2FbYS5SVENSdHBUcmFuc2NlaXZlcj0yMF09XCJSVENSdHBUcmFuc2NlaXZlclwiO2FbYS5yZXNlcnZlZDM9MjFdPVwicmVzZXJ2ZWQzXCI7YVthLnJlc2VydmVkND0yMl09XCJyZXNlcnZlZDRcIjthW2EucmVzZXJ2ZWQxPTIzXT1cInJlc2VydmVkMVwiO2FbYS5yZXNlcnZlZDI9MjRdPVwicmVzZXJ2ZWQyXCI7YVthLlJUQ0RhdGFDaGFubmVsPTI1XT1cIlJUQ0RhdGFDaGFubmVsXCI7YVthLlJUQ1NjdHBUcmFuc3BvcnQ9MjZdPVwiUlRDU2N0cFRyYW5zcG9ydFwifSkoYz1hLmNsYXNzX2lkX3R8fChhLmNsYXNzX2lkX3Q9e30pKTt2YXIgZDsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLnZlcnNpb249MV09XCJ2ZXJzaW9uXCI7YVthLmZlYXR1cmVfZmxhZ3M9Ml09XCJmZWF0dXJlX2ZsYWdzXCI7YVthLnZlcnNpb25faW5mbz0zXT1cInZlcnNpb25faW5mb1wiO2FbYS5vc2luZm89NF09XCJvc2luZm9cIjthW2EuZW5kcG9pbnRfaWQ9NV09XCJlbmRwb2ludF9pZFwifSkoZD1cclxuYS5tZXRob2RfaWRfRW5naW5lQ29udHJvbF90fHwoYS5tZXRob2RfaWRfRW5naW5lQ29udHJvbF90PXt9KSk7dmFyIGU7KGZ1bmN0aW9uKGEpe2FbYS5jdG9yPTBdPVwiY3RvclwiO2FbYS5sb2NhbERlc2NyaXB0aW9uPTFdPVwibG9jYWxEZXNjcmlwdGlvblwiO2FbYS5yZW1vdGVEZXNjcmlwdGlvbj0yXT1cInJlbW90ZURlc2NyaXB0aW9uXCI7YVthLnJlYWR5U3RhdGU9M109XCJyZWFkeVN0YXRlXCI7YVthLmljZVN0YXRlPTRdPVwiaWNlU3RhdGVcIjthW2EubG9jYWxTdHJlYW1zPTVdPVwibG9jYWxTdHJlYW1zXCI7YVthLnJlbW90ZVN0cmVhbXM9Nl09XCJyZW1vdGVTdHJlYW1zXCI7YVthLmNyZWF0ZU9mZmVyPTddPVwiY3JlYXRlT2ZmZXJcIjthW2EuY3JlYXRlQW5zd2VyPThdPVwiY3JlYXRlQW5zd2VyXCI7YVthLnNldExvY2FsRGVzY3JpcHRpb249OV09XCJzZXRMb2NhbERlc2NyaXB0aW9uXCI7YVthLnNldFJlbW90ZURlc2NyaXB0aW9uPTEwXT1cInNldFJlbW90ZURlc2NyaXB0aW9uXCI7YVthLnVwZGF0ZUljZT1cclxuMTFdPVwidXBkYXRlSWNlXCI7YVthLmFkZEljZUNhbmRpZGF0ZT0xMl09XCJhZGRJY2VDYW5kaWRhdGVcIjthW2EuYWRkU3RyZWFtPTEzXT1cImFkZFN0cmVhbVwiO2FbYS5yZW1vdmVTdHJlYW09MTRdPVwicmVtb3ZlU3RyZWFtXCI7YVthLmNsb3NlPTE1XT1cImNsb3NlXCI7YVthLmljZUNvbm5lY3Rpb25TdGF0ZT0xNl09XCJpY2VDb25uZWN0aW9uU3RhdGVcIjthW2EuaWNlR2F0aGVyaW5nU3RhdGU9MTddPVwiaWNlR2F0aGVyaW5nU3RhdGVcIjthW2Euc2lnbmFsaW5nU3RhdGU9MThdPVwic2lnbmFsaW5nU3RhdGVcIjthW2Eub25hZGRzdHJlYW09MTldPVwib25hZGRzdHJlYW1cIjthW2Eub25pY2VjYW5kaWRhdGU9MjBdPVwib25pY2VjYW5kaWRhdGVcIjthW2Eub25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2U9MjFdPVwib25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2VcIjthW2Eub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZT0yMl09XCJvbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlXCI7YVthLm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2U9XHJcbjIzXT1cIm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2VcIjthW2Eub25uZWdvdGlhdGlvbm5lZWRlZD0yNF09XCJvbm5lZ290aWF0aW9ubmVlZGVkXCI7YVthLm9ucmVtb3Zlc3RyZWFtPTI1XT1cIm9ucmVtb3Zlc3RyZWFtXCI7YVthLmdldFN0YXRzPTI2XT1cImdldFN0YXRzXCI7YVthLmdldFJlY2VpdmVycz0yN109XCJnZXRSZWNlaXZlcnNcIjthW2EuZ2V0U2VuZGVycz0yOF09XCJnZXRTZW5kZXJzXCI7YVthLmFkZFRyYWNrPTI5XT1cImFkZFRyYWNrXCI7YVthLnJlbW92ZVRyYWNrPTMwXT1cInJlbW92ZVRyYWNrXCI7YVthLm9udHJhY2s9MzFdPVwib250cmFja1wiO2FbYS5zZXRMb2NhbERlc2NyaXB0aW9uX3YyPTMyXT1cInNldExvY2FsRGVzY3JpcHRpb25fdjJcIjthW2Euc2V0UmVtb3RlRGVzY3JpcHRpb25fdjI9MzNdPVwic2V0UmVtb3RlRGVzY3JpcHRpb25fdjJcIjthW2EuYWRkVHJhbnNjZWl2ZXJXaXRoVHJhY2s9MzRdPVwiYWRkVHJhbnNjZWl2ZXJXaXRoVHJhY2tcIjthW2EuYWRkVHJhbnNjZWl2ZXJXaXRoS2luZD1cclxuMzVdPVwiYWRkVHJhbnNjZWl2ZXJXaXRoS2luZFwiO2FbYS5nZXRUcmFuc2NlaXZlcnM9MzZdPVwiZ2V0VHJhbnNjZWl2ZXJzXCI7YVthLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlPTM3XT1cIm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlXCI7YVthLnNjdHA9MzhdPVwic2N0cFwiO2FbYS5vbmRhdGFjaGFubmVsPTM5XT1cIm9uZGF0YWNoYW5uZWxcIjthW2EuY3JlYXRlRGF0YUNoYW5uZWw9NDBdPVwiY3JlYXRlRGF0YUNoYW5uZWxcIjthW2EuZ2V0U3RhdHNfdjI9NDFdPVwiZ2V0U3RhdHNfdjJcIn0pKGU9YS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdHx8KGEubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Q9e30pKTt2YXIgazsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLmVudW1lcmF0ZURldmljZXM9MV09XCJlbnVtZXJhdGVEZXZpY2VzXCI7YVthLmdldERpc3BsYXlNZWRpYT0yXT1cImdldERpc3BsYXlNZWRpYVwiO2FbYS5vbmRldmljZWNoYW5nZT0zXT1cIm9uZGV2aWNlY2hhbmdlXCJ9KShrPVxyXG5hLm1ldGhvZF9pZF9NZWRpYURldmljZXNfdHx8KGEubWV0aG9kX2lkX01lZGlhRGV2aWNlc190PXt9KSk7dmFyIG07KGZ1bmN0aW9uKGEpe2FbYS5jdG9yPTBdPVwiY3RvclwiO2FbYS5kZXZpY2VJZD0xXT1cImRldmljZUlkXCI7YVthLmtpbmQ9Ml09XCJraW5kXCI7YVthLmxhYmVsPTNdPVwibGFiZWxcIjthW2EuZ3JvdXBJZD00XT1cImdyb3VwSWRcIn0pKG09YS5tZXRob2RfaWRfTWVkaWFEZXZpY2VJbmZvX3R8fChhLm1ldGhvZF9pZF9NZWRpYURldmljZUluZm9fdD17fSkpO3ZhciBwOyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2EudHlwZT0xXT1cInR5cGVcIjthW2Euc2RwPTJdPVwic2RwXCJ9KShwPWEubWV0aG9kX2lkX1JUQ1Nlc3Npb25EZXNjcmlwdGlvbl90fHwoYS5tZXRob2RfaWRfUlRDU2Vzc2lvbkRlc2NyaXB0aW9uX3Q9e30pKTt2YXIgbDsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLmtpbmQ9MV09XCJraW5kXCI7YVthLmlkPTJdPVwiaWRcIjthW2EubGFiZWw9XHJcbjNdPVwibGFiZWxcIjthW2EuZW5hYmxlZD00XT1cImVuYWJsZWRcIjthW2EubXV0ZWQ9NV09XCJtdXRlZFwiO2FbYS5yZWFkeVN0YXRlPTZdPVwicmVhZHlTdGF0ZVwiO2FbYS5vbmVuZGVkPTddPVwib25lbmRlZFwiO2FbYS5vbm11dGU9OF09XCJvbm11dGVcIjthW2Eub251bm11dGU9OV09XCJvbnVubXV0ZVwiO2FbYS5jbG9uZT0xMF09XCJjbG9uZVwiO2FbYS5zdG9wPTExXT1cInN0b3BcIjthW2EuZ2V0Q2FwYWJpbGl0aWVzPTEyXT1cImdldENhcGFiaWxpdGllc1wiO2FbYS5nZXRTZXR0aW5ncz0xM109XCJnZXRTZXR0aW5nc1wiO2FbYS5hcHBseUNvbnN0cmFpbnRzPTE0XT1cImFwcGx5Q29uc3RyYWludHNcIjthW2EuZ2V0Q29uc3RyYWludHM9MTVdPVwiZ2V0Q29uc3RyYWludHNcIn0pKGw9YS5tZXRob2RfaWRfTWVkaWFTdHJlYW1UcmFja190fHwoYS5tZXRob2RfaWRfTWVkaWFTdHJlYW1UcmFja190PXt9KSk7dmFyIGc7KGZ1bmN0aW9uKGEpe2FbYS5jdG9yPTBdPVwiY3RvclwiO2FbYS5pZD0xXT1cImlkXCI7YVthLmdldEF1ZGlvVHJhY2tzPVxyXG4yXT1cImdldEF1ZGlvVHJhY2tzXCI7YVthLmdldFZpZGVvVHJhY2tzPTNdPVwiZ2V0VmlkZW9UcmFja3NcIjthW2EuZ2V0VHJhY2tzPTRdPVwiZ2V0VHJhY2tzXCI7YVthLmdldFRyYWNrQnlJZD01XT1cImdldFRyYWNrQnlJZFwiO2FbYS5hZGRUcmFjaz02XT1cImFkZFRyYWNrXCI7YVthLnJlbW92ZVRyYWNrPTddPVwicmVtb3ZlVHJhY2tcIjthW2EuY2xvbmU9OF09XCJjbG9uZVwiO2FbYS5hY3RpdmU9OV09XCJhY3RpdmVcIn0pKGc9YS5tZXRob2RfaWRfTWVkaWFTdHJlYW1fdHx8KGEubWV0aG9kX2lkX01lZGlhU3RyZWFtX3Q9e30pKTt2YXIgRzsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLmdldFVzZXJNZWRpYT0xXT1cImdldFVzZXJNZWRpYVwiO2FbYS5zZXRDb2RlY0NhcGFiaWxpdGllcz0yXT1cInNldENvZGVjQ2FwYWJpbGl0aWVzXCI7YVthLmdldENhcGFiaWxpdGllcz0zXT1cImdldENhcGFiaWxpdGllc1wifSkoRz1hLm1ldGhvZF9pZF9OYXZpZ2F0b3JVc2VyTWVkaWFfdHx8KGEubWV0aG9kX2lkX05hdmlnYXRvclVzZXJNZWRpYV90PVxyXG57fSkpO3ZhciB2OyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2EuY2FuZGlkYXRlPTFdPVwiY2FuZGlkYXRlXCI7YVthLnNkcE1pZD0yXT1cInNkcE1pZFwiO2FbYS5zZHBNTGluZUluZGV4PTNdPVwic2RwTUxpbmVJbmRleFwifSkodj1hLm1ldGhvZF9pZF9SVENJY2VDYW5kaWRhdGVfdHx8KGEubWV0aG9kX2lkX1JUQ0ljZUNhbmRpZGF0ZV90PXt9KSk7dmFyIHQ7KGZ1bmN0aW9uKGEpe2FbYS5jdG9yPTBdPVwiY3RvclwiO2FbYS5jYW5kaWRhdGU9MV09XCJjYW5kaWRhdGVcIn0pKHQ9YS5tZXRob2RfaWRfUlRDSWNlQ2FuZGlkYXRlRXZlbnRfdHx8KGEubWV0aG9kX2lkX1JUQ0ljZUNhbmRpZGF0ZUV2ZW50X3Q9e30pKTt2YXIgejsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLnN0cmVhbT0xXT1cInN0cmVhbVwifSkoej1hLm1ldGhvZF9pZF9NZWRpYVN0cmVhbUV2ZW50X3R8fChhLm1ldGhvZF9pZF9NZWRpYVN0cmVhbUV2ZW50X3Q9e30pKTt2YXIgdTsoZnVuY3Rpb24oYSl7YVthLmN0b3I9XHJcbjBdPVwiY3RvclwiO2FbYS5zaW5rSWQ9MV09XCJzaW5rSWRcIjthW2EuY29ubmVjdFRvPTJdPVwiY29ubmVjdFRvXCI7YVthLmRpc2Nvbm5lY3Q9M109XCJkaXNjb25uZWN0XCI7YVthLnNldEZyYW1lPTRdPVwic2V0RnJhbWVcIjthW2EuYWRkQ2xpcFJlY3Q9NV09XCJhZGRDbGlwUmVjdFwiO2FbYS5yZW1vdmVDbGlwUmVjdD02XT1cInJlbW92ZUNsaXBSZWN0XCI7YVthLm9uZXJyb3I9N109XCJvbmVycm9yXCI7YVthLm9udmlkZW9mcmFtZWNoYW5nZWQ9OF09XCJvbnZpZGVvZnJhbWVjaGFuZ2VkXCI7YVthLnBsYWNlbWVudD05XT1cInBsYWNlbWVudFwifSkodT1hLm1ldGhvZF9pZF9WaWRlb0VsZW1lbnRfdHx8KGEubWV0aG9kX2lkX1ZpZGVvRWxlbWVudF90PXt9KSk7dmFyIGY7KGZ1bmN0aW9uKGEpe2FbYS5jdG9yPTBdPVwiY3RvclwiO2FbYS5zaW5rSWQ9MV09XCJzaW5rSWRcIjthW2Euc3JjT2JqZWN0PTJdPVwic3JjT2JqZWN0XCI7YVthLnNyYz0zXT1cInNyY1wiO2FbYS5wbGF5PTRdPVwicGxheVwiO2FbYS5wYXVzZT01XT1cInBhdXNlXCJ9KShmPVxyXG5hLm1ldGhvZF9pZF9BdWRpb0VsZW1lbnRfdHx8KGEubWV0aG9kX2lkX0F1ZGlvRWxlbWVudF90PXt9KSk7dmFyIEE7KGZ1bmN0aW9uKGEpe2FbYS5jdG9yPTBdPVwiY3RvclwiO2FbYS50cmFjaz0xXT1cInRyYWNrXCI7YVthLmdldENvbnRyaWJ1dGluZ1NvdXJjZXM9Ml09XCJnZXRDb250cmlidXRpbmdTb3VyY2VzXCI7YVthLmdldFN5bmNocm9uaXphdGlvblNvdXJjZXM9M109XCJnZXRTeW5jaHJvbml6YXRpb25Tb3VyY2VzXCI7YVthLnRyYW5zcG9ydD00XT1cInRyYW5zcG9ydFwiO2FbYS5ydGNwVHJhbnNwb3J0PTVdPVwicnRjcFRyYW5zcG9ydFwiO2FbYS5nZXRDYXBhYmlsaXRpZXM9Nl09XCJnZXRDYXBhYmlsaXRpZXNcIjthW2EuZ2V0UGFyYW1ldGVycz03XT1cImdldFBhcmFtZXRlcnNcIjthW2EuZ2V0U3RhdHM9OF09XCJnZXRTdGF0c1wiO2FbYS5nZXRDYXBhYmlsaXRpZXNfdjI9OV09XCJnZXRDYXBhYmlsaXRpZXNfdjJcIn0pKEE9YS5tZXRob2RfaWRfUlRDUnRwUmVjZWl2ZXJfdHx8KGEubWV0aG9kX2lkX1JUQ1J0cFJlY2VpdmVyX3Q9XHJcbnt9KSk7dmFyIHg7KGZ1bmN0aW9uKGEpe2FbYS5jdG9yPTBdPVwiY3RvclwiO2FbYS50cmFjaz0xXT1cInRyYWNrXCI7YVthLnRyYW5zcG9ydD0yXT1cInRyYW5zcG9ydFwiO2FbYS5ydGNwVHJhbnNwb3J0PTNdPVwicnRjcFRyYW5zcG9ydFwiO2FbYS5kdG1mPTRdPVwiZHRtZlwiO2FbYS5nZXRDYXBhYmlsaXRpZXM9NV09XCJnZXRDYXBhYmlsaXRpZXNcIjthW2EuZ2V0UGFyYW1ldGVycz02XT1cImdldFBhcmFtZXRlcnNcIjthW2Euc2V0UGFyYW1ldGVycz03XT1cInNldFBhcmFtZXRlcnNcIjthW2EucmVwbGFjZVRyYWNrPThdPVwicmVwbGFjZVRyYWNrXCI7YVthLmdldFN0YXRzPTldPVwiZ2V0U3RhdHNcIjthW2Euc2V0U3RyZWFtcz0xMF09XCJzZXRTdHJlYW1zXCI7YVthLmdldENhcGFiaWxpdGllc192Mj0xMV09XCJnZXRDYXBhYmlsaXRpZXNfdjJcIn0pKHg9YS5tZXRob2RfaWRfUlRDUnRwU2VuZGVyX3R8fChhLm1ldGhvZF9pZF9SVENSdHBTZW5kZXJfdD17fSkpO3ZhciBEOyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cclxuXCJjdG9yXCI7YVthLnRyYW5zcG9ydD0xXT1cInRyYW5zcG9ydFwiO2FbYS5zdGF0ZT0yXT1cInN0YXRlXCI7YVthLmdldFJlbW90ZUNlcnRpZmljYXRlcz0zXT1cImdldFJlbW90ZUNlcnRpZmljYXRlc1wiO2FbYS5vbnN0YXRlY2hhbmdlPTRdPVwib25zdGF0ZWNoYW5nZVwiO2FbYS5vbmVycm9yPTVdPVwib25lcnJvclwifSkoRD1hLm1ldGhvZF9pZF9SVENEdGxzVHJhbnNwb3J0X3R8fChhLm1ldGhvZF9pZF9SVENEdGxzVHJhbnNwb3J0X3Q9e30pKTt2YXIgQzsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLnJvbGU9MV09XCJyb2xlXCI7YVthLmNvbXBvbmVudD0yXT1cImNvbXBvbmVudFwiO2FbYS5zdGF0ZT0zXT1cInN0YXRlXCI7YVthLmdhdGhlcmluZ1N0YXRlPTRdPVwiZ2F0aGVyaW5nU3RhdGVcIjthW2EubG9jYWxjYW5kaWRhdGVzPTVdPVwibG9jYWxjYW5kaWRhdGVzXCI7YVthLnJlbW90ZWNhbmRpZGF0ZXM9Nl09XCJyZW1vdGVjYW5kaWRhdGVzXCI7YVthLm9uc3RhdGVjaGFuZ2U9N109XCJvbnN0YXRlY2hhbmdlXCI7XHJcbmFbYS5vbmdhdGhlcmluZ3N0YXRlY2hhbmdlPThdPVwib25nYXRoZXJpbmdzdGF0ZWNoYW5nZVwiO2FbYS5vbnNlbGVjdGVkY2FuZGlkYXRlcGFpcmNoYW5nZT05XT1cIm9uc2VsZWN0ZWRjYW5kaWRhdGVwYWlyY2hhbmdlXCJ9KShDPWEubWV0aG9kX2lkX1JUQ0ljZVRyYW5zcG9ydF90fHwoYS5tZXRob2RfaWRfUlRDSWNlVHJhbnNwb3J0X3Q9e30pKTt2YXIgcjsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLmluc2VydERUTUY9MV09XCJpbnNlcnREVE1GXCI7YVthLm9udG9uZWNoYW5nZT0yXT1cIm9udG9uZWNoYW5nZVwiO2FbYS5jYW5JbnNlcnREVE1GPTNdPVwiY2FuSW5zZXJ0RFRNRlwiO2FbYS50b25lQnVmZmVyPTRdPVwidG9uZUJ1ZmZlclwifSkocj1hLm1ldGhvZF9pZF9SVENEVE1GU2VuZGVyX3R8fChhLm1ldGhvZF9pZF9SVENEVE1GU2VuZGVyX3Q9e30pKTt2YXIgcTsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLnRvbmU9MV09XCJ0b25lXCI7YVthLnRvbmVfYnVmZmVyPVxyXG4yXT1cInRvbmVfYnVmZmVyXCJ9KShxPWEubWV0aG9kX2lkX1JUQ0RUTUZUb25lQ2hhbmdlRXZlbnRfdHx8KGEubWV0aG9kX2lkX1JUQ0RUTUZUb25lQ2hhbmdlRXZlbnRfdD17fSkpO3ZhciB3OyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2EubG9jYWw9MV09XCJsb2NhbFwiO2FbYS5yZW1vdGU9Ml09XCJyZW1vdGVcIn0pKHc9YS5tZXRob2RfaWRfUlRDSWNlQ2FuZGlkYXRlUGFpcl90fHwoYS5tZXRob2RfaWRfUlRDSWNlQ2FuZGlkYXRlUGFpcl90PXt9KSk7dmFyIEI7KGZ1bmN0aW9uKGEpe2FbYS5jdG9yPTBdPVwiY3RvclwiO2FbYS5taWQ9MV09XCJtaWRcIjthW2Euc2VuZGVyPTJdPVwic2VuZGVyXCI7YVthLnJlY2VpdmVyPTNdPVwicmVjZWl2ZXJcIjthW2EuZGlyZWN0aW9uPTRdPVwiZGlyZWN0aW9uXCI7YVthLmN1cnJlbnREaXJlY3Rpb249NV09XCJjdXJyZW50RGlyZWN0aW9uXCI7YVthLnN0b3A9Nl09XCJzdG9wXCI7YVthLnNldENvZGVjUHJlZmVyZW5jZXM9N109XCJzZXRDb2RlY1ByZWZlcmVuY2VzXCJ9KShCPVxyXG5hLm1ldGhvZF9pZF9SVENSdHBUcmFuc2NlaXZlcl90fHwoYS5tZXRob2RfaWRfUlRDUnRwVHJhbnNjZWl2ZXJfdD17fSkpO3ZhciB5OyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2EubGFiZWw9MV09XCJsYWJlbFwiO2FbYS5vcmRlcmVkPTJdPVwib3JkZXJlZFwiO2FbYS5tYXhQYWNrZXRMaWZlVGltZT0zXT1cIm1heFBhY2tldExpZmVUaW1lXCI7YVthLm1heFJldHJhbnNtaXRzPTRdPVwibWF4UmV0cmFuc21pdHNcIjthW2EucHJvdG9jb2w9NV09XCJwcm90b2NvbFwiO2FbYS5uZWdvdGlhdGVkPTZdPVwibmVnb3RpYXRlZFwiO2FbYS5pZD03XT1cImlkXCI7YVthLnJlYWR5U3RhdGU9OF09XCJyZWFkeVN0YXRlXCI7YVthLmJ1ZmZlcmVkQW1vdW50PTldPVwiYnVmZmVyZWRBbW91bnRcIjthW2EuYnVmZmVyZWRBbW91bnRMb3dUaHJlc2hvbGQ9MTBdPVwiYnVmZmVyZWRBbW91bnRMb3dUaHJlc2hvbGRcIjthW2Eub25vcGVuPTExXT1cIm9ub3BlblwiO2FbYS5vbmJ1ZmZlcmVkYW1vdW50bG93PTEyXT1cIm9uYnVmZmVyZWRhbW91bnRsb3dcIjtcclxuYVthLm9uZXJyb3I9MTNdPVwib25lcnJvclwiO2FbYS5vbmNsb3Npbmc9MTRdPVwib25jbG9zaW5nXCI7YVthLm9uY2xvc2U9MTVdPVwib25jbG9zZVwiO2FbYS5vbm1lc3NhZ2U9MTZdPVwib25tZXNzYWdlXCI7YVthLmNsb3NlPTE3XT1cImNsb3NlXCI7YVthLnNlbmRfdGV4dD0xOF09XCJzZW5kX3RleHRcIjthW2Euc2VuZF9iaW5hcnk9MTldPVwic2VuZF9iaW5hcnlcIn0pKHk9YS5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdHx8KGEubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3Q9e30pKTt2YXIgSDsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLnRyYW5zcG9ydD0xXT1cInRyYW5zcG9ydFwiO2FbYS5zdGF0ZT0yXT1cInN0YXRlXCI7YVthLm1heE1lc3NhZ2VTaXplPTNdPVwibWF4TWVzc2FnZVNpemVcIjthW2EubWF4Q2hhbm5lbHM9NF09XCJtYXhDaGFubmVsc1wiO2FbYS5vbnN0YXRlY2hhbmdlPTVdPVwib25zdGF0ZWNoYW5nZVwifSkoSD1hLm1ldGhvZF9pZF9SVENTY3RwVHJhbnNwb3J0X3R8fChhLm1ldGhvZF9pZF9SVENTY3RwVHJhbnNwb3J0X3Q9XHJcbnt9KSk7YS5jbGFzc19saWJfaW5mbz1uZXcgYi5XZWJycGNDbGFzc0xpYkluZm8oXCJ3ZWJycGNfY2xhc3NfbGlicmFyeVwiLFtuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5FbmdpbmVDb250cm9sLFwiRW5naW5lQ29udHJvbFwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuRW5naW5lQ29udHJvbCxkLmN0b3IsXCJjdG9yXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5FbmdpbmVDb250cm9sLGQudmVyc2lvbixcInZlcnNpb25cIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkVuZ2luZUNvbnRyb2wsZC5mZWF0dXJlX2ZsYWdzLFwiZmVhdHVyZV9mbGFnc1wiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuRW5naW5lQ29udHJvbCxkLnZlcnNpb25faW5mbyxcInZlcnNpb25faW5mb1wiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kZXNrdG9wX3NoYXJpbmcpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5FbmdpbmVDb250cm9sLGQub3NpbmZvLFwib3NpbmZvXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX29zaW5mbyksXHJcbm5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5FbmdpbmVDb250cm9sLGQuZW5kcG9pbnRfaWQsXCJlbmRwb2ludF9pZFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19lbmRwb2ludF9pZCldKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5SVENQZWVyQ29ubmVjdGlvbixcIlJUQ1BlZXJDb25uZWN0aW9uXCIsW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLmN0b3IsXCJjdG9yXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLmxvY2FsRGVzY3JpcHRpb24sXCJsb2NhbERlc2NyaXB0aW9uXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLnJlbW90ZURlc2NyaXB0aW9uLFwicmVtb3RlRGVzY3JpcHRpb25cIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGUucmVhZHlTdGF0ZSxcInJlYWR5U3RhdGVcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLFxyXG5lLmljZVN0YXRlLFwiaWNlU3RhdGVcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGUubG9jYWxTdHJlYW1zLFwibG9jYWxTdHJlYW1zXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLnJlbW90ZVN0cmVhbXMsXCJyZW1vdGVTdHJlYW1zXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLmNyZWF0ZU9mZmVyLFwiY3JlYXRlT2ZmZXJcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGUuY3JlYXRlQW5zd2VyLFwiY3JlYXRlQW5zd2VyXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLnNldExvY2FsRGVzY3JpcHRpb24sXCJzZXRMb2NhbERlc2NyaXB0aW9uXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLnNldFJlbW90ZURlc2NyaXB0aW9uLFwic2V0UmVtb3RlRGVzY3JpcHRpb25cIixcclxuITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLnVwZGF0ZUljZSxcInVwZGF0ZUljZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24sZS5hZGRJY2VDYW5kaWRhdGUsXCJhZGRJY2VDYW5kaWRhdGVcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGUuYWRkU3RyZWFtLFwiYWRkU3RyZWFtXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLnJlbW92ZVN0cmVhbSxcInJlbW92ZVN0cmVhbVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24sZS5jbG9zZSxcImNsb3NlXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLmljZUNvbm5lY3Rpb25TdGF0ZSxcImljZUNvbm5lY3Rpb25TdGF0ZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24sXHJcbmUuaWNlR2F0aGVyaW5nU3RhdGUsXCJpY2VHYXRoZXJpbmdTdGF0ZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24sZS5zaWduYWxpbmdTdGF0ZSxcInNpZ25hbGluZ1N0YXRlXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLm9uYWRkc3RyZWFtLFwib25hZGRzdHJlYW1cIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGUub25pY2VjYW5kaWRhdGUsXCJvbmljZWNhbmRpZGF0ZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24sZS5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSxcIm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2UsXCJvbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixcclxuZS5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlLFwib25zaWduYWxpbmdzdGF0ZWNoYW5nZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24sZS5vbm5lZ290aWF0aW9ubmVlZGVkLFwib25uZWdvdGlhdGlvbm5lZWRlZFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24sZS5vbnJlbW92ZXN0cmVhbSxcIm9ucmVtb3Zlc3RyZWFtXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLmdldFN0YXRzLFwiZ2V0U3RhdHNcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGUuZ2V0UmVjZWl2ZXJzLFwiZ2V0UmVjZWl2ZXJzXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3NwZWFraW5nX2luZGljYXRvciksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGUuZ2V0U2VuZGVycyxcImdldFNlbmRlcnNcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksXHJcbm5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLmFkZFRyYWNrLFwiYWRkVHJhY2tcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGUucmVtb3ZlVHJhY2ssXCJyZW1vdmVUcmFja1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24sZS5vbnRyYWNrLFwib250cmFja1wiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24sZS5zZXRMb2NhbERlc2NyaXB0aW9uX3YyLFwic2V0TG9jYWxEZXNjcmlwdGlvbl92MlwiLCExLGEuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLnNldFJlbW90ZURlc2NyaXB0aW9uX3YyLFwic2V0UmVtb3RlRGVzY3JpcHRpb25fdjJcIixcclxuITEsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGUuYWRkVHJhbnNjZWl2ZXJXaXRoVHJhY2ssXCJhZGRUcmFuc2NlaXZlcldpdGhUcmFja1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLmFkZFRyYW5zY2VpdmVyV2l0aEtpbmQsXCJhZGRUcmFuc2NlaXZlcldpdGhLaW5kXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGUuZ2V0VHJhbnNjZWl2ZXJzLFwiZ2V0VHJhbnNjZWl2ZXJzXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGUub25jb25uZWN0aW9uc3RhdGVjaGFuZ2UsXCJvbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLFxyXG4hMCxhLkZFQVRVUkVfbXNfdGVhbXNfd2VicnRjXzFkb3QwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24sZS5zY3RwLFwic2N0cFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLm9uZGF0YWNoYW5uZWwsXCJvbmRhdGFjaGFubmVsXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGUuY3JlYXRlRGF0YUNoYW5uZWwsXCJjcmVhdGVEYXRhQ2hhbm5lbFwiLCExLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixlLmdldFN0YXRzX3YyLFwiZ2V0U3RhdHNfdjJcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfd2VicnRjXzFkb3QwKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLlJUQ1Nlc3Npb25EZXNjcmlwdGlvbixcclxuXCJSVENTZXNzaW9uRGVzY3JpcHRpb25cIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1Nlc3Npb25EZXNjcmlwdGlvbixwLmN0b3IsXCJjdG9yXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENTZXNzaW9uRGVzY3JpcHRpb24scC50eXBlLFwidHlwZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uLHAuc2RwLFwic2RwXCIsITApXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuUlRDSWNlQ2FuZGlkYXRlLFwiUlRDSWNlQ2FuZGlkYXRlXCIsW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VDYW5kaWRhdGUsdi5jdG9yLFwiY3RvclwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDSWNlQ2FuZGlkYXRlLHYuY2FuZGlkYXRlLFwiY2FuZGlkYXRlXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VDYW5kaWRhdGUsdi5zZHBNaWQsXCJzZHBNaWRcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZUNhbmRpZGF0ZSxcclxudi5zZHBNTGluZUluZGV4LFwic2RwTUxpbmVJbmRleFwiLCEwKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLlJUQ0ljZUNhbmRpZGF0ZUV2ZW50LFwiUlRDSWNlQ2FuZGlkYXRlRXZlbnRcIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZUNhbmRpZGF0ZUV2ZW50LHQuY3RvcixcImN0b3JcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZUNhbmRpZGF0ZUV2ZW50LHQuY2FuZGlkYXRlLFwiY2FuZGlkYXRlXCIsITApXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuTWVkaWFEZXZpY2VzLFwiTWVkaWFEZXZpY2VzXCIsW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYURldmljZXMsay5jdG9yLFwiY3RvclwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFEZXZpY2VzLGsuZW51bWVyYXRlRGV2aWNlcyxcImVudW1lcmF0ZURldmljZXNcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhRGV2aWNlcyxrLmdldERpc3BsYXlNZWRpYSxcImdldERpc3BsYXlNZWRpYVwiLFxyXG4hMSxhLkZFQVRVUkVfbXNfdGVhbXNfZGVza3RvcF9zaGFyaW5nKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFEZXZpY2VzLGsub25kZXZpY2VjaGFuZ2UsXCJvbmRldmljZWNoYW5nZVwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19zcGVha2luZ19pbmRpY2F0b3IpXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuTWVkaWFEZXZpY2VJbmZvLFwiTWVkaWFEZXZpY2VJbmZvXCIsW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYURldmljZUluZm8sbS5jdG9yLFwiY3RvclwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFEZXZpY2VJbmZvLG0uZGV2aWNlSWQsXCJkZXZpY2VJZFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFEZXZpY2VJbmZvLG0ua2luZCxcImtpbmRcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhRGV2aWNlSW5mbyxtLmxhYmVsLFwibGFiZWxcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhRGV2aWNlSW5mbyxcclxubS5ncm91cElkLFwiZ3JvdXBJZFwiLCEwKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssXCJNZWRpYVN0cmVhbVRyYWNrXCIsW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbVRyYWNrLGwuY3RvcixcImN0b3JcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbC5jbG9uZSxcImNsb25lXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbVRyYWNrLGwuc3RvcCxcInN0b3BcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbC5nZXRDYXBhYmlsaXRpZXMsXCJnZXRDYXBhYmlsaXRpZXNcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbC5nZXRTZXR0aW5ncyxcImdldFNldHRpbmdzXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbVRyYWNrLGwuYXBwbHlDb25zdHJhaW50cyxcImFwcGx5Q29uc3RyYWludHNcIixcclxuITEsYS5GRUFUVVJFX21zX3RlYW1zX2Rlc2t0b3Bfc2hhcmluZyksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbC5raW5kLFwia2luZFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW1UcmFjayxsLmlkLFwiaWRcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbC5sYWJlbCxcImxhYmVsXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbVRyYWNrLGwuZW5hYmxlZCxcImVuYWJsZWRcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbC5tdXRlZCxcIm11dGVkXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbVRyYWNrLGwucmVhZHlTdGF0ZSxcInJlYWR5U3RhdGVcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbC5vbmVuZGVkLFwib25lbmRlZFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW1UcmFjayxcclxubC5vbm11dGUsXCJvbm11dGVcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbC5vbnVubXV0ZSxcIm9udW5tdXRlXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbVRyYWNrLGwuZ2V0Q29uc3RyYWludHMsXCJnZXRDb25zdHJhaW50c1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc19tc3RyYWNrX2NvbnN0cmFpbnRzKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLk1lZGlhU3RyZWFtLFwiTWVkaWFTdHJlYW1cIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtLGcuY3RvcixcImN0b3JcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtLGcuaWQsXCJpZFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW0sZy5nZXRBdWRpb1RyYWNrcyxcImdldEF1ZGlvVHJhY2tzXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbSxnLmdldFZpZGVvVHJhY2tzLFwiZ2V0VmlkZW9UcmFja3NcIixcclxuITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbSxnLmdldFRyYWNrcyxcImdldFRyYWNrc1wiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW0sZy5nZXRUcmFja0J5SWQsXCJnZXRUcmFja0J5SWRcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtLGcuYWRkVHJhY2ssXCJhZGRUcmFja1wiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW0sZy5yZW1vdmVUcmFjayxcInJlbW92ZVRyYWNrXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbSxnLmNsb25lLFwiY2xvbmVcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtLGcuYWN0aXZlLFwiYWN0aXZlXCIsITApXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuTmF2aWdhdG9yVXNlck1lZGlhLFwiTmF2aWdhdG9yVXNlck1lZGlhXCIsW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5OYXZpZ2F0b3JVc2VyTWVkaWEsRy5jdG9yLFxyXG5cImN0b3JcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk5hdmlnYXRvclVzZXJNZWRpYSxHLmdldFVzZXJNZWRpYSxcImdldFVzZXJNZWRpYVwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTmF2aWdhdG9yVXNlck1lZGlhLEcuc2V0Q29kZWNDYXBhYmlsaXRpZXMsXCJzZXRDb2RlY0NhcGFiaWxpdGllc1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc19jb2RlY19jYXBhYmlsaXR5KSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTmF2aWdhdG9yVXNlck1lZGlhLEcuZ2V0Q2FwYWJpbGl0aWVzLFwiZ2V0UnRwQ2FwYWJpbGl0aWVzXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCldKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5NZWRpYVN0cmVhbUV2ZW50LFwiTWVkaWFTdHJlYW1FdmVudFwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW1FdmVudCx6LmN0b3IsXCJjdG9yXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbUV2ZW50LFxyXG56LnN0cmVhbSxcInN0cmVhbVwiLCEwKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLlZpZGVvRWxlbWVudCxcIlZpZGVvRWxlbWVudFwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuVmlkZW9FbGVtZW50LHUuY3RvcixcImN0b3JcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlZpZGVvRWxlbWVudCx1LnNpbmtJZCxcInNpbmtJZFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuVmlkZW9FbGVtZW50LHUuY29ubmVjdFRvLFwiY29ubmVjdFRvXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5WaWRlb0VsZW1lbnQsdS5kaXNjb25uZWN0LFwiZGlzY29ubmVjdFwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuVmlkZW9FbGVtZW50LHUuc2V0RnJhbWUsXCJzZXRGcmFtZVwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuVmlkZW9FbGVtZW50LHUuYWRkQ2xpcFJlY3QsXCJhZGRDbGlwUmVjdFwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuVmlkZW9FbGVtZW50LHUucmVtb3ZlQ2xpcFJlY3QsXHJcblwicmVtb3ZlQ2xpcFJlY3RcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlZpZGVvRWxlbWVudCx1Lm9uZXJyb3IsXCJvbmVycm9yXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5WaWRlb0VsZW1lbnQsdS5vbnZpZGVvZnJhbWVjaGFuZ2VkLFwib252aWRlb2ZyYW1lY2hhbmdlZFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuVmlkZW9FbGVtZW50LHUucGxhY2VtZW50LFwicGxhY2VtZW50XCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3ZpZGVvX3BsYWNlbWVudCldKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5BdWRpb0VsZW1lbnQsXCJBdWRpb0VsZW1lbnRcIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkF1ZGlvRWxlbWVudCxmLmN0b3IsXCJjdG9yXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5BdWRpb0VsZW1lbnQsZi5zaW5rSWQsXCJzaW5rSWRcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkF1ZGlvRWxlbWVudCxmLnNyY09iamVjdCxcInNyY09iamVjdFwiLFxyXG4hMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkF1ZGlvRWxlbWVudCxmLnNyYyxcInNyY1wiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuQXVkaW9FbGVtZW50LGYucGxheSxcInBsYXlcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkF1ZGlvRWxlbWVudCxmLnBhdXNlLFwicGF1c2VcIiwhMSldKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5SVENSdHBSZWNlaXZlcixcIlJUQ1J0cFJlY2VpdmVyXCIsW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBSZWNlaXZlcixBLmN0b3IsXCJjdG9yXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3NwZWFraW5nX2luZGljYXRvciksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFJlY2VpdmVyLEEudHJhY2ssXCJ0cmFja1wiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19zcGVha2luZ19pbmRpY2F0b3IpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBSZWNlaXZlcixBLmdldENvbnRyaWJ1dGluZ1NvdXJjZXMsXCJnZXRDb250cmlidXRpbmdTb3VyY2VzXCIsXHJcbiExLGEuRkVBVFVSRV9tc190ZWFtc19zcGVha2luZ19pbmRpY2F0b3IpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBSZWNlaXZlcixBLmdldFN5bmNocm9uaXphdGlvblNvdXJjZXMsXCJnZXRTeW5jaHJvbml6YXRpb25Tb3VyY2VzXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBSZWNlaXZlcixBLnRyYW5zcG9ydCxcInRyYW5zcG9ydFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwUmVjZWl2ZXIsQS5ydGNwVHJhbnNwb3J0LFwicnRjcHRyYW5zcG9ydFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwUmVjZWl2ZXIsQS5nZXRDYXBhYmlsaXRpZXMsXCJnZXRDYXBhYmlsaXRpZXNcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFJlY2VpdmVyLFxyXG5BLmdldFBhcmFtZXRlcnMsXCJnZXRQYXJhbWV0ZXJzXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBSZWNlaXZlcixBLmdldFN0YXRzLFwiZ2V0U3RhdHNcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFJlY2VpdmVyLEEuZ2V0Q2FwYWJpbGl0aWVzX3YyLFwiZ2V0Q2FwYWJpbGl0aWVzX3YyXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCldKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5SVENSdHBTZW5kZXIsXCJSVENSdHBTZW5kZXJcIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFNlbmRlcix4LmN0b3IsXCJjdG9yXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBTZW5kZXIseC50cmFjayxcInRyYWNrXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBTZW5kZXIsXHJcbngudHJhbnNwb3J0LFwidHJhbnNwb3J0XCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBTZW5kZXIseC5ydGNwVHJhbnNwb3J0LFwicnRjcFRyYW5zcG9ydFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwU2VuZGVyLHguZHRtZixcImR0bWZcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFNlbmRlcix4LmdldENhcGFiaWxpdGllcyxcImdldENhcGFiaWxpdGllc1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwU2VuZGVyLHguZ2V0UGFyYW1ldGVycyxcImdldFBhcmFtZXRlcnNcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFNlbmRlcix4LnNldFBhcmFtZXRlcnMsXCJzZXRQYXJhbWV0ZXJzXCIsITEsXHJcbmEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwU2VuZGVyLHgucmVwbGFjZVRyYWNrLFwicmVwbGFjZVRyYWNrXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBTZW5kZXIseC5nZXRTdGF0cyxcImdldFN0YXRzXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBTZW5kZXIseC5zZXRTdHJlYW1zLFwic2V0U3RyZWFtc1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwU2VuZGVyLHguZ2V0Q2FwYWJpbGl0aWVzX3YyLFwiZ2V0Q2FwYWJpbGl0aWVzX3YyXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCldKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5SVENEdGxzVHJhbnNwb3J0LFwiUlRDRHRsc1RyYW5zcG9ydFwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRHRsc1RyYW5zcG9ydCxcclxuRC5jdG9yLFwiY3RvclwiLCExLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRHRsc1RyYW5zcG9ydCxELnRyYW5zcG9ydCxcInRyYW5zcG9ydFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRHRsc1RyYW5zcG9ydCxELnN0YXRlLFwic3RhdGVcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0R0bHNUcmFuc3BvcnQsRC5nZXRSZW1vdGVDZXJ0aWZpY2F0ZXMsXCJnZXRSZW1vdGVDZXJ0aWZpY2F0ZXNcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0R0bHNUcmFuc3BvcnQsRC5vbnN0YXRlY2hhbmdlLFwib25zdGF0ZWNoYW5nZVwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRHRsc1RyYW5zcG9ydCxELm9uZXJyb3IsXCJvbmVycm9yXCIsXHJcbiEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLlJUQ0ljZVRyYW5zcG9ydCxcIlJUQ0ljZVRyYW5zcG9ydFwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDSWNlVHJhbnNwb3J0LEMuY3RvcixcImN0b3JcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZVRyYW5zcG9ydCxDLnJvbGUsXCJyb2xlXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VUcmFuc3BvcnQsQy5jb21wb25lbnQsXCJjb21wb25lbnRcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZVRyYW5zcG9ydCxDLnN0YXRlLFwic3RhdGVcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZVRyYW5zcG9ydCxDLmdhdGhlcmluZ1N0YXRlLFwiZ2F0aGVyaW5nU3RhdGVcIixcclxuITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VUcmFuc3BvcnQsQy5sb2NhbGNhbmRpZGF0ZXMsXCJsb2NhbGNhbmRpZGF0ZXNcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZVRyYW5zcG9ydCxDLnJlbW90ZWNhbmRpZGF0ZXMsXCJyZW1vdGVjYW5kaWRhdGVzXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VUcmFuc3BvcnQsQy5vbnN0YXRlY2hhbmdlLFwib25zdGF0ZWNoYW5nZVwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDSWNlVHJhbnNwb3J0LEMub25nYXRoZXJpbmdzdGF0ZWNoYW5nZSxcIm9uZ2F0aGVyaW5nc3RhdGVjaGFuZ2VcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZVRyYW5zcG9ydCxcclxuQy5vbnNlbGVjdGVkY2FuZGlkYXRlcGFpcmNoYW5nZSxcIm9uc2VsZWN0ZWRjYW5kaWRhdGVwYWlyY2hhbmdlXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuUlRDRFRNRlNlbmRlcixcIlJUQ0RUTUZTZW5kZXJcIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RUTUZTZW5kZXIsci5jdG9yLFwiY3RvclwiLCExLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRFRNRlNlbmRlcixyLmluc2VydERUTUYsXCJpbnNlcnREVE1GXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEVE1GU2VuZGVyLHIub250b25lY2hhbmdlLFwib250b25lY2hhbmdlXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEVE1GU2VuZGVyLHIuY2FuSW5zZXJ0RFRNRixcImNhbkluc2VydERUTUZcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksXHJcbm5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEVE1GU2VuZGVyLHIudG9uZUJ1ZmZlcixcInRvbmVCdWZmZXJcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0bildKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5SVENEVE1GVG9uZUNoYW5nZUV2ZW50LFwiUlRDRFRNRlRvbmVDaGFuZ2VFdmVudFwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRFRNRlRvbmVDaGFuZ2VFdmVudCxxLmN0b3IsXCJjdG9yXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEVE1GVG9uZUNoYW5nZUV2ZW50LHEudG9uZSxcInRvbmVcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RUTUZUb25lQ2hhbmdlRXZlbnQscS50b25lX2J1ZmZlcixcInRvbmVfYnVmZmVyXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuUlRDSWNlQ2FuZGlkYXRlUGFpcixcIlJUQ0ljZUNhbmRpZGF0ZVBhaXJcIixcclxuW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VDYW5kaWRhdGVQYWlyLHcuY3RvcixcImN0b3JcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZUNhbmRpZGF0ZVBhaXIsdy5sb2NhbCxcImxvY2FsXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VDYW5kaWRhdGVQYWlyLHcucmVtb3RlLFwicmVtb3RlXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuUlRDUnRwVHJhbnNjZWl2ZXIsXCJSVENSdHBUcmFuc2NlaXZlclwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwVHJhbnNjZWl2ZXIsQi5jdG9yLFwiY3RvclwiLCExLGEuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBUcmFuc2NlaXZlcixCLm1pZCxcIm1pZFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDApLFxyXG5uZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwVHJhbnNjZWl2ZXIsQi5zZW5kZXIsXCJzZW5kZXJcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfd2VicnRjXzFkb3QwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwVHJhbnNjZWl2ZXIsQi5yZWNlaXZlcixcInJlY2VpdmVyXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFRyYW5zY2VpdmVyLEIuZGlyZWN0aW9uLFwiZGlyZWN0aW9uXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFRyYW5zY2VpdmVyLEIuY3VycmVudERpcmVjdGlvbixcImN1cnJlbnREaXJlY3Rpb25cIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfd2VicnRjXzFkb3QwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwVHJhbnNjZWl2ZXIsQi5zdG9wLFwic3RvcFwiLCExLGEuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDApLFxyXG5uZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwVHJhbnNjZWl2ZXIsQi5zZXRDb2RlY1ByZWZlcmVuY2VzLFwic2V0Q29kZWNQcmVmZXJlbmNlc1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDApXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuUlRDRGF0YUNoYW5uZWwsXCJSVENEYXRhQ2hhbm5lbFwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwseS5jdG9yLFwiY3RvclwiLCExLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEYXRhQ2hhbm5lbCx5LmxhYmVsLFwibGFiZWxcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwseS5vcmRlcmVkLFwib3JkZXJlZFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEYXRhQ2hhbm5lbCx5Lm1heFBhY2tldExpZmVUaW1lLFxyXG5cIm1heFBhY2tldExpZmVUaW1lXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLHkubWF4UmV0cmFuc21pdHMsXCJtYXhSZXRyYW5zbWl0c1wiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEYXRhQ2hhbm5lbCx5LnByb3RvY29sLFwicHJvdG9jb2xcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwseS5uZWdvdGlhdGVkLFwibmVnb3RpYXRlZFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEYXRhQ2hhbm5lbCx5LmlkLFwiaWRcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwseS5yZWFkeVN0YXRlLFxyXG5cInJlYWR5U3RhdGVcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwseS5idWZmZXJlZEFtb3VudCxcImJ1ZmZlcmVkQW1vdW50XCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLHkuYnVmZmVyZWRBbW91bnRMb3dUaHJlc2hvbGQsXCJidWZmZXJlZEFtb3VudExvd1RocmVzaG9sZFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEYXRhQ2hhbm5lbCx5Lm9ub3BlbixcIm9ub3BlblwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEYXRhQ2hhbm5lbCx5Lm9uYnVmZmVyZWRhbW91bnRsb3csXCJvbmJ1ZmZlcmVkYW1vdW50bG93XCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksXHJcbm5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEYXRhQ2hhbm5lbCx5Lm9uZXJyb3IsXCJvbmVycm9yXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLHkub25jbG9zaW5nLFwib25jbG9zaW5nXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLHkub25jbG9zZSxcIm9uY2xvc2VcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwseS5vbm1lc3NhZ2UsXCJvbm1lc3NhZ2VcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwseS5jbG9zZSxcImNsb3NlXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLFxyXG55LnNlbmRfdGV4dCxcInNlbmRfdGV4dFwiLCExLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEYXRhQ2hhbm5lbCx5LnNlbmRfYmluYXJ5LFwic2VuZF9iaW5hcnlcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLlJUQ1NjdHBUcmFuc3BvcnQsXCJSVENTY3RwVHJhbnNwb3J0XCIsW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENTY3RwVHJhbnNwb3J0LEguY3RvcixcImN0b3JcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDU2N0cFRyYW5zcG9ydCxILnRyYW5zcG9ydCxcInRyYW5zcG9ydFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENTY3RwVHJhbnNwb3J0LEguc3RhdGUsXCJzdGF0ZVwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLFxyXG5uZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDU2N0cFRyYW5zcG9ydCxILm1heE1lc3NhZ2VTaXplLFwibWF4TWVzc2FnZVNpemVcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDU2N0cFRyYW5zcG9ydCxILm1heENoYW5uZWxzLFwibWF4Q2hhbm5lbHNcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDU2N0cFRyYW5zcG9ydCxILm9uc3RhdGVjaGFuZ2UsXCJvbnN0YXRlY2hhbmdlXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCldKV0pfSw1NDU6ZnVuY3Rpb24oYixhLGMpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBkPWMoNTUwKSxlOyhmdW5jdGlvbihhKXthW2EucmVxPTBdPVwicmVxXCI7YVthLnJlcGx5PTFdPVwicmVwbHlcIjthW2EuZXZlbnRfcmVxPTJdPVwiZXZlbnRfcmVxXCI7YVthLmV2ZW50X3JlcGx5PVxyXG4zXT1cImV2ZW50X3JlcGx5XCJ9KShlPWEud3NfbXNnX3R5cGVfdHx8KGEud3NfbXNnX3R5cGVfdD17fSkpO2I9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7fWEuY3JlYXRlTWVzc2FnZUJ5aWQ9ZnVuY3Rpb24oYSxiLGMsZSxrLG4pe2Zvcih2YXIgdD1bXSx6PTY7ejxhcmd1bWVudHMubGVuZ3RoO3orKyl0W3otNl09YXJndW1lbnRzW3pdOyh6PWQuV2VicnBjQ2xhc3NMaWJJbmZvVXRpbC5nZXRNZXRob2RCeWlkKGUsaykpJiZ6LmlzcHJvcHx8KGE9ITEpO3JldHVybiB0aGlzLmNyZWF0ZU1lc3NhZ2UuYXBwbHkodGhpcyxbYyxhLGIsZSxrLG5dLmNvbmNhdCh0KSl9O2EuY3JlYXRlTWVzc2FnZT1mdW5jdGlvbihhLGIsYyxkLGUsayl7Zm9yKHZhciBuPVtdLHo9Njt6PGFyZ3VtZW50cy5sZW5ndGg7eisrKW5bei02XT1hcmd1bWVudHNbel07cmV0dXJue3Y6XCJ3ZWJydGNcIixoZHI6e3ZlcnNpb246dGhpcy5fdmVyc2lvbixtc2dfdHlwZTp0aGlzLmdldE1zZ1R5cGUoYSksbW9kaWZpZXI6YixkZXN0cm95OmMsXHJcbnByb2M6e2lpZDpkLG1ldGhvZGlkOmV9fSxvYmpyZWY6e29pZDprfSxwYXJhbXM6bi5zbGljZSgpfX07YS5nZXRNc2dUeXBlPWZ1bmN0aW9uKGEpe3ZhciBiPVwiXCI7c3dpdGNoKGEpe2RlZmF1bHQ6Yj1cInJlcVwiO2JyZWFrO2Nhc2UgZS5yZXBseTpiPVwicmVwbHlcIjticmVhaztjYXNlIGUuZXZlbnRfcmVxOmI9XCJldmVudC1yZXFcIjticmVhaztjYXNlIGUuZXZlbnRfcmVwbHk6Yj1cImV2ZW50LXJlcGx5XCJ9cmV0dXJuIGJ9O2EuX3ZlcnNpb249MTtyZXR1cm4gYX0oKTthLldzSnNvblV0aWw9Yn19LGs9e307cmV0dXJuIGQoMzA3KX0oKX0pO1xyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IHsgXCJkZWZhdWx0XCI6IHJlcXVpcmUoXCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2NyZWF0ZVwiKSwgX19lc01vZHVsZTogdHJ1ZSB9OyIsIm1vZHVsZS5leHBvcnRzID0geyBcImRlZmF1bHRcIjogcmVxdWlyZShcImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZGVmaW5lLXByb3BlcnR5XCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07IiwibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3JcIiksIF9fZXNNb2R1bGU6IHRydWUgfTsiLCJtb2R1bGUuZXhwb3J0cyA9IHsgXCJkZWZhdWx0XCI6IHJlcXVpcmUoXCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2dldC1wcm90b3R5cGUtb2ZcIiksIF9fZXNNb2R1bGU6IHRydWUgfTsiLCJtb2R1bGUuZXhwb3J0cyA9IHsgXCJkZWZhdWx0XCI6IHJlcXVpcmUoXCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L3NldC1wcm90b3R5cGUtb2ZcIiksIF9fZXNNb2R1bGU6IHRydWUgfTsiLCJtb2R1bGUuZXhwb3J0cyA9IHsgXCJkZWZhdWx0XCI6IHJlcXVpcmUoXCJjb3JlLWpzL2xpYnJhcnkvZm4vcHJvbWlzZVwiKSwgX19lc01vZHVsZTogdHJ1ZSB9OyIsIm1vZHVsZS5leHBvcnRzID0geyBcImRlZmF1bHRcIjogcmVxdWlyZShcImNvcmUtanMvbGlicmFyeS9mbi9zeW1ib2xcIiksIF9fZXNNb2R1bGU6IHRydWUgfTsiLCJtb2R1bGUuZXhwb3J0cyA9IHsgXCJkZWZhdWx0XCI6IHJlcXVpcmUoXCJjb3JlLWpzL2xpYnJhcnkvZm4vc3ltYm9sL2l0ZXJhdG9yXCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cbnZhciBfcHJvbWlzZSA9IHJlcXVpcmUoXCIuLi9jb3JlLWpzL3Byb21pc2VcIik7XG5cbnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKGZuKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGdlbiA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBmdW5jdGlvbiBzdGVwKGtleSwgYXJnKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpO1xuICAgICAgICAgIHZhciB2YWx1ZSA9IGluZm8udmFsdWU7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaW5mby5kb25lKSB7XG4gICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIF9wcm9taXNlMi5kZWZhdWx0LnJlc29sdmUodmFsdWUpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBzdGVwKFwibmV4dFwiLCB2YWx1ZSk7XG4gICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgc3RlcChcInRocm93XCIsIGVycik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHN0ZXAoXCJuZXh0XCIpO1xuICAgIH0pO1xuICB9O1xufTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKGluc3RhbmNlLCBDb25zdHJ1Y3Rvcikge1xuICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7XG4gIH1cbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cbnZhciBfZGVmaW5lUHJvcGVydHkgPSByZXF1aXJlKFwiLi4vY29yZS1qcy9vYmplY3QvZGVmaW5lLXByb3BlcnR5XCIpO1xuXG52YXIgX2RlZmluZVByb3BlcnR5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RlZmluZVByb3BlcnR5KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldO1xuICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlO1xuICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlO1xuICAgICAgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcbiAgICAgICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7XG4gICAgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTtcbiAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTtcbiAgICByZXR1cm4gQ29uc3RydWN0b3I7XG4gIH07XG59KCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKFwiLi4vY29yZS1qcy9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZlwiKTtcblxudmFyIF9nZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQcm90b3R5cGVPZik7XG5cbnZhciBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gcmVxdWlyZShcIi4uL2NvcmUtanMvb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvclwiKTtcblxudmFyIF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7XG4gIGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTtcbiAgdmFyIGRlc2MgPSAoMCwgX2dldE93blByb3BlcnR5RGVzY3JpcHRvcjIuZGVmYXVsdCkob2JqZWN0LCBwcm9wZXJ0eSk7XG5cbiAgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkge1xuICAgIHZhciBwYXJlbnQgPSAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShvYmplY3QpO1xuXG4gICAgaWYgKHBhcmVudCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7XG4gICAgfVxuICB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7XG4gICAgcmV0dXJuIGRlc2MudmFsdWU7XG4gIH0gZWxzZSB7XG4gICAgdmFyIGdldHRlciA9IGRlc2MuZ2V0O1xuXG4gICAgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7XG4gIH1cbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cbnZhciBfc2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKFwiLi4vY29yZS1qcy9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZlwiKTtcblxudmFyIF9zZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZXRQcm90b3R5cGVPZik7XG5cbnZhciBfY3JlYXRlID0gcmVxdWlyZShcIi4uL2NvcmUtanMvb2JqZWN0L2NyZWF0ZVwiKTtcblxudmFyIF9jcmVhdGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3JlYXRlKTtcblxudmFyIF90eXBlb2YyID0gcmVxdWlyZShcIi4uL2hlbHBlcnMvdHlwZW9mXCIpO1xuXG52YXIgX3R5cGVvZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90eXBlb2YyKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7XG4gIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArICh0eXBlb2Ygc3VwZXJDbGFzcyA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoc3VwZXJDbGFzcykpKTtcbiAgfVxuXG4gIHN1YkNsYXNzLnByb3RvdHlwZSA9ICgwLCBfY3JlYXRlMi5kZWZhdWx0KShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7XG4gICAgY29uc3RydWN0b3I6IHtcbiAgICAgIHZhbHVlOiBzdWJDbGFzcyxcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9XG4gIH0pO1xuICBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mMi5kZWZhdWx0ID8gKDAsIF9zZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzcztcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cbnZhciBfdHlwZW9mMiA9IHJlcXVpcmUoXCIuLi9oZWxwZXJzL3R5cGVvZlwiKTtcblxudmFyIF90eXBlb2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHlwZW9mMik7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChzZWxmLCBjYWxsKSB7XG4gIGlmICghc2VsZikge1xuICAgIHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTtcbiAgfVxuXG4gIHJldHVybiBjYWxsICYmICgodHlwZW9mIGNhbGwgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogKDAsIF90eXBlb2YzLmRlZmF1bHQpKGNhbGwpKSA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmO1xufTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxudmFyIF9pdGVyYXRvciA9IHJlcXVpcmUoXCIuLi9jb3JlLWpzL3N5bWJvbC9pdGVyYXRvclwiKTtcblxudmFyIF9pdGVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pdGVyYXRvcik7XG5cbnZhciBfc3ltYm9sID0gcmVxdWlyZShcIi4uL2NvcmUtanMvc3ltYm9sXCIpO1xuXG52YXIgX3N5bWJvbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zeW1ib2wpO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIF9pdGVyYXRvcjIuZGVmYXVsdCA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IF9zeW1ib2wyLmRlZmF1bHQgJiYgb2JqICE9PSBfc3ltYm9sMi5kZWZhdWx0LnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5leHBvcnRzLmRlZmF1bHQgPSB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gXCJmdW5jdGlvblwiICYmIF90eXBlb2YoX2l0ZXJhdG9yMi5kZWZhdWx0KSA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHtcbiAgcmV0dXJuIHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihvYmopO1xufSA6IGZ1bmN0aW9uIChvYmopIHtcbiAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCAmJiBvYmogIT09IF9zeW1ib2wyLmRlZmF1bHQucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihvYmopO1xufTsiLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNC1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cbi8vIFRoaXMgbWV0aG9kIG9mIG9idGFpbmluZyBhIHJlZmVyZW5jZSB0byB0aGUgZ2xvYmFsIG9iamVjdCBuZWVkcyB0byBiZVxuLy8ga2VwdCBpZGVudGljYWwgdG8gdGhlIHdheSBpdCBpcyBvYnRhaW5lZCBpbiBydW50aW1lLmpzXG52YXIgZyA9IChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMgfSkoKSB8fCBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCk7XG5cbi8vIFVzZSBgZ2V0T3duUHJvcGVydHlOYW1lc2AgYmVjYXVzZSBub3QgYWxsIGJyb3dzZXJzIHN1cHBvcnQgY2FsbGluZ1xuLy8gYGhhc093blByb3BlcnR5YCBvbiB0aGUgZ2xvYmFsIGBzZWxmYCBvYmplY3QgaW4gYSB3b3JrZXIuIFNlZSAjMTgzLlxudmFyIGhhZFJ1bnRpbWUgPSBnLnJlZ2VuZXJhdG9yUnVudGltZSAmJlxuICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhnKS5pbmRleE9mKFwicmVnZW5lcmF0b3JSdW50aW1lXCIpID49IDA7XG5cbi8vIFNhdmUgdGhlIG9sZCByZWdlbmVyYXRvclJ1bnRpbWUgaW4gY2FzZSBpdCBuZWVkcyB0byBiZSByZXN0b3JlZCBsYXRlci5cbnZhciBvbGRSdW50aW1lID0gaGFkUnVudGltZSAmJiBnLnJlZ2VuZXJhdG9yUnVudGltZTtcblxuLy8gRm9yY2UgcmVldmFsdXRhdGlvbiBvZiBydW50aW1lLmpzLlxuZy5yZWdlbmVyYXRvclJ1bnRpbWUgPSB1bmRlZmluZWQ7XG5cbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIi4vcnVudGltZVwiKTtcblxuaWYgKGhhZFJ1bnRpbWUpIHtcbiAgLy8gUmVzdG9yZSB0aGUgb3JpZ2luYWwgcnVudGltZS5cbiAgZy5yZWdlbmVyYXRvclJ1bnRpbWUgPSBvbGRSdW50aW1lO1xufSBlbHNlIHtcbiAgLy8gUmVtb3ZlIHRoZSBnbG9iYWwgcHJvcGVydHkgYWRkZWQgYnkgcnVudGltZS5qcy5cbiAgdHJ5IHtcbiAgICBkZWxldGUgZy5yZWdlbmVyYXRvclJ1bnRpbWU7XG4gIH0gY2F0Y2goZSkge1xuICAgIGcucmVnZW5lcmF0b3JSdW50aW1lID0gdW5kZWZpbmVkO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNC1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cbiEoZnVuY3Rpb24oZ2xvYmFsKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBPcCA9IE9iamVjdC5wcm90b3R5cGU7XG4gIHZhciBoYXNPd24gPSBPcC5oYXNPd25Qcm9wZXJ0eTtcbiAgdmFyIHVuZGVmaW5lZDsgLy8gTW9yZSBjb21wcmVzc2libGUgdGhhbiB2b2lkIDAuXG4gIHZhciAkU3ltYm9sID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiID8gU3ltYm9sIDoge307XG4gIHZhciBpdGVyYXRvclN5bWJvbCA9ICRTeW1ib2wuaXRlcmF0b3IgfHwgXCJAQGl0ZXJhdG9yXCI7XG4gIHZhciBhc3luY0l0ZXJhdG9yU3ltYm9sID0gJFN5bWJvbC5hc3luY0l0ZXJhdG9yIHx8IFwiQEBhc3luY0l0ZXJhdG9yXCI7XG4gIHZhciB0b1N0cmluZ1RhZ1N5bWJvbCA9ICRTeW1ib2wudG9TdHJpbmdUYWcgfHwgXCJAQHRvU3RyaW5nVGFnXCI7XG5cbiAgdmFyIGluTW9kdWxlID0gdHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIjtcbiAgdmFyIHJ1bnRpbWUgPSBnbG9iYWwucmVnZW5lcmF0b3JSdW50aW1lO1xuICBpZiAocnVudGltZSkge1xuICAgIGlmIChpbk1vZHVsZSkge1xuICAgICAgLy8gSWYgcmVnZW5lcmF0b3JSdW50aW1lIGlzIGRlZmluZWQgZ2xvYmFsbHkgYW5kIHdlJ3JlIGluIGEgbW9kdWxlLFxuICAgICAgLy8gbWFrZSB0aGUgZXhwb3J0cyBvYmplY3QgaWRlbnRpY2FsIHRvIHJlZ2VuZXJhdG9yUnVudGltZS5cbiAgICAgIG1vZHVsZS5leHBvcnRzID0gcnVudGltZTtcbiAgICB9XG4gICAgLy8gRG9uJ3QgYm90aGVyIGV2YWx1YXRpbmcgdGhlIHJlc3Qgb2YgdGhpcyBmaWxlIGlmIHRoZSBydW50aW1lIHdhc1xuICAgIC8vIGFscmVhZHkgZGVmaW5lZCBnbG9iYWxseS5cbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBEZWZpbmUgdGhlIHJ1bnRpbWUgZ2xvYmFsbHkgKGFzIGV4cGVjdGVkIGJ5IGdlbmVyYXRlZCBjb2RlKSBhcyBlaXRoZXJcbiAgLy8gbW9kdWxlLmV4cG9ydHMgKGlmIHdlJ3JlIGluIGEgbW9kdWxlKSBvciBhIG5ldywgZW1wdHkgb2JqZWN0LlxuICBydW50aW1lID0gZ2xvYmFsLnJlZ2VuZXJhdG9yUnVudGltZSA9IGluTW9kdWxlID8gbW9kdWxlLmV4cG9ydHMgOiB7fTtcblxuICBmdW5jdGlvbiB3cmFwKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSB7XG4gICAgLy8gSWYgb3V0ZXJGbiBwcm92aWRlZCBhbmQgb3V0ZXJGbi5wcm90b3R5cGUgaXMgYSBHZW5lcmF0b3IsIHRoZW4gb3V0ZXJGbi5wcm90b3R5cGUgaW5zdGFuY2VvZiBHZW5lcmF0b3IuXG4gICAgdmFyIHByb3RvR2VuZXJhdG9yID0gb3V0ZXJGbiAmJiBvdXRlckZuLnByb3RvdHlwZSBpbnN0YW5jZW9mIEdlbmVyYXRvciA/IG91dGVyRm4gOiBHZW5lcmF0b3I7XG4gICAgdmFyIGdlbmVyYXRvciA9IE9iamVjdC5jcmVhdGUocHJvdG9HZW5lcmF0b3IucHJvdG90eXBlKTtcbiAgICB2YXIgY29udGV4dCA9IG5ldyBDb250ZXh0KHRyeUxvY3NMaXN0IHx8IFtdKTtcblxuICAgIC8vIFRoZSAuX2ludm9rZSBtZXRob2QgdW5pZmllcyB0aGUgaW1wbGVtZW50YXRpb25zIG9mIHRoZSAubmV4dCxcbiAgICAvLyAudGhyb3csIGFuZCAucmV0dXJuIG1ldGhvZHMuXG4gICAgZ2VuZXJhdG9yLl9pbnZva2UgPSBtYWtlSW52b2tlTWV0aG9kKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpO1xuXG4gICAgcmV0dXJuIGdlbmVyYXRvcjtcbiAgfVxuICBydW50aW1lLndyYXAgPSB3cmFwO1xuXG4gIC8vIFRyeS9jYXRjaCBoZWxwZXIgdG8gbWluaW1pemUgZGVvcHRpbWl6YXRpb25zLiBSZXR1cm5zIGEgY29tcGxldGlvblxuICAvLyByZWNvcmQgbGlrZSBjb250ZXh0LnRyeUVudHJpZXNbaV0uY29tcGxldGlvbi4gVGhpcyBpbnRlcmZhY2UgY291bGRcbiAgLy8gaGF2ZSBiZWVuIChhbmQgd2FzIHByZXZpb3VzbHkpIGRlc2lnbmVkIHRvIHRha2UgYSBjbG9zdXJlIHRvIGJlXG4gIC8vIGludm9rZWQgd2l0aG91dCBhcmd1bWVudHMsIGJ1dCBpbiBhbGwgdGhlIGNhc2VzIHdlIGNhcmUgYWJvdXQgd2VcbiAgLy8gYWxyZWFkeSBoYXZlIGFuIGV4aXN0aW5nIG1ldGhvZCB3ZSB3YW50IHRvIGNhbGwsIHNvIHRoZXJlJ3Mgbm8gbmVlZFxuICAvLyB0byBjcmVhdGUgYSBuZXcgZnVuY3Rpb24gb2JqZWN0LiBXZSBjYW4gZXZlbiBnZXQgYXdheSB3aXRoIGFzc3VtaW5nXG4gIC8vIHRoZSBtZXRob2QgdGFrZXMgZXhhY3RseSBvbmUgYXJndW1lbnQsIHNpbmNlIHRoYXQgaGFwcGVucyB0byBiZSB0cnVlXG4gIC8vIGluIGV2ZXJ5IGNhc2UsIHNvIHdlIGRvbid0IGhhdmUgdG8gdG91Y2ggdGhlIGFyZ3VtZW50cyBvYmplY3QuIFRoZVxuICAvLyBvbmx5IGFkZGl0aW9uYWwgYWxsb2NhdGlvbiByZXF1aXJlZCBpcyB0aGUgY29tcGxldGlvbiByZWNvcmQsIHdoaWNoXG4gIC8vIGhhcyBhIHN0YWJsZSBzaGFwZSBhbmQgc28gaG9wZWZ1bGx5IHNob3VsZCBiZSBjaGVhcCB0byBhbGxvY2F0ZS5cbiAgZnVuY3Rpb24gdHJ5Q2F0Y2goZm4sIG9iaiwgYXJnKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiB7IHR5cGU6IFwibm9ybWFsXCIsIGFyZzogZm4uY2FsbChvYmosIGFyZykgfTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJldHVybiB7IHR5cGU6IFwidGhyb3dcIiwgYXJnOiBlcnIgfTtcbiAgICB9XG4gIH1cblxuICB2YXIgR2VuU3RhdGVTdXNwZW5kZWRTdGFydCA9IFwic3VzcGVuZGVkU3RhcnRcIjtcbiAgdmFyIEdlblN0YXRlU3VzcGVuZGVkWWllbGQgPSBcInN1c3BlbmRlZFlpZWxkXCI7XG4gIHZhciBHZW5TdGF0ZUV4ZWN1dGluZyA9IFwiZXhlY3V0aW5nXCI7XG4gIHZhciBHZW5TdGF0ZUNvbXBsZXRlZCA9IFwiY29tcGxldGVkXCI7XG5cbiAgLy8gUmV0dXJuaW5nIHRoaXMgb2JqZWN0IGZyb20gdGhlIGlubmVyRm4gaGFzIHRoZSBzYW1lIGVmZmVjdCBhc1xuICAvLyBicmVha2luZyBvdXQgb2YgdGhlIGRpc3BhdGNoIHN3aXRjaCBzdGF0ZW1lbnQuXG4gIHZhciBDb250aW51ZVNlbnRpbmVsID0ge307XG5cbiAgLy8gRHVtbXkgY29uc3RydWN0b3IgZnVuY3Rpb25zIHRoYXQgd2UgdXNlIGFzIHRoZSAuY29uc3RydWN0b3IgYW5kXG4gIC8vIC5jb25zdHJ1Y3Rvci5wcm90b3R5cGUgcHJvcGVydGllcyBmb3IgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIEdlbmVyYXRvclxuICAvLyBvYmplY3RzLiBGb3IgZnVsbCBzcGVjIGNvbXBsaWFuY2UsIHlvdSBtYXkgd2lzaCB0byBjb25maWd1cmUgeW91clxuICAvLyBtaW5pZmllciBub3QgdG8gbWFuZ2xlIHRoZSBuYW1lcyBvZiB0aGVzZSB0d28gZnVuY3Rpb25zLlxuICBmdW5jdGlvbiBHZW5lcmF0b3IoKSB7fVxuICBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvbigpIHt9XG4gIGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKCkge31cblxuICAvLyBUaGlzIGlzIGEgcG9seWZpbGwgZm9yICVJdGVyYXRvclByb3RvdHlwZSUgZm9yIGVudmlyb25tZW50cyB0aGF0XG4gIC8vIGRvbid0IG5hdGl2ZWx5IHN1cHBvcnQgaXQuXG4gIHZhciBJdGVyYXRvclByb3RvdHlwZSA9IHt9O1xuICBJdGVyYXRvclByb3RvdHlwZVtpdGVyYXRvclN5bWJvbF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgdmFyIGdldFByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mO1xuICB2YXIgTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUgPSBnZXRQcm90byAmJiBnZXRQcm90byhnZXRQcm90byh2YWx1ZXMoW10pKSk7XG4gIGlmIChOYXRpdmVJdGVyYXRvclByb3RvdHlwZSAmJlxuICAgICAgTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUgIT09IE9wICYmXG4gICAgICBoYXNPd24uY2FsbChOYXRpdmVJdGVyYXRvclByb3RvdHlwZSwgaXRlcmF0b3JTeW1ib2wpKSB7XG4gICAgLy8gVGhpcyBlbnZpcm9ubWVudCBoYXMgYSBuYXRpdmUgJUl0ZXJhdG9yUHJvdG90eXBlJTsgdXNlIGl0IGluc3RlYWRcbiAgICAvLyBvZiB0aGUgcG9seWZpbGwuXG4gICAgSXRlcmF0b3JQcm90b3R5cGUgPSBOYXRpdmVJdGVyYXRvclByb3RvdHlwZTtcbiAgfVxuXG4gIHZhciBHcCA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLnByb3RvdHlwZSA9XG4gICAgR2VuZXJhdG9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSXRlcmF0b3JQcm90b3R5cGUpO1xuICBHZW5lcmF0b3JGdW5jdGlvbi5wcm90b3R5cGUgPSBHcC5jb25zdHJ1Y3RvciA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlO1xuICBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEdlbmVyYXRvckZ1bmN0aW9uO1xuICBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZVt0b1N0cmluZ1RhZ1N5bWJvbF0gPVxuICAgIEdlbmVyYXRvckZ1bmN0aW9uLmRpc3BsYXlOYW1lID0gXCJHZW5lcmF0b3JGdW5jdGlvblwiO1xuXG4gIC8vIEhlbHBlciBmb3IgZGVmaW5pbmcgdGhlIC5uZXh0LCAudGhyb3csIGFuZCAucmV0dXJuIG1ldGhvZHMgb2YgdGhlXG4gIC8vIEl0ZXJhdG9yIGludGVyZmFjZSBpbiB0ZXJtcyBvZiBhIHNpbmdsZSAuX2ludm9rZSBtZXRob2QuXG4gIGZ1bmN0aW9uIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhwcm90b3R5cGUpIHtcbiAgICBbXCJuZXh0XCIsIFwidGhyb3dcIiwgXCJyZXR1cm5cIl0uZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHtcbiAgICAgIHByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oYXJnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnZva2UobWV0aG9kLCBhcmcpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIHJ1bnRpbWUuaXNHZW5lcmF0b3JGdW5jdGlvbiA9IGZ1bmN0aW9uKGdlbkZ1bikge1xuICAgIHZhciBjdG9yID0gdHlwZW9mIGdlbkZ1biA9PT0gXCJmdW5jdGlvblwiICYmIGdlbkZ1bi5jb25zdHJ1Y3RvcjtcbiAgICByZXR1cm4gY3RvclxuICAgICAgPyBjdG9yID09PSBHZW5lcmF0b3JGdW5jdGlvbiB8fFxuICAgICAgICAvLyBGb3IgdGhlIG5hdGl2ZSBHZW5lcmF0b3JGdW5jdGlvbiBjb25zdHJ1Y3RvciwgdGhlIGJlc3Qgd2UgY2FuXG4gICAgICAgIC8vIGRvIGlzIHRvIGNoZWNrIGl0cyAubmFtZSBwcm9wZXJ0eS5cbiAgICAgICAgKGN0b3IuZGlzcGxheU5hbWUgfHwgY3Rvci5uYW1lKSA9PT0gXCJHZW5lcmF0b3JGdW5jdGlvblwiXG4gICAgICA6IGZhbHNlO1xuICB9O1xuXG4gIHJ1bnRpbWUubWFyayA9IGZ1bmN0aW9uKGdlbkZ1bikge1xuICAgIGlmIChPYmplY3Quc2V0UHJvdG90eXBlT2YpIHtcbiAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihnZW5GdW4sIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZ2VuRnVuLl9fcHJvdG9fXyA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlO1xuICAgICAgaWYgKCEodG9TdHJpbmdUYWdTeW1ib2wgaW4gZ2VuRnVuKSkge1xuICAgICAgICBnZW5GdW5bdG9TdHJpbmdUYWdTeW1ib2xdID0gXCJHZW5lcmF0b3JGdW5jdGlvblwiO1xuICAgICAgfVxuICAgIH1cbiAgICBnZW5GdW4ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShHcCk7XG4gICAgcmV0dXJuIGdlbkZ1bjtcbiAgfTtcblxuICAvLyBXaXRoaW4gdGhlIGJvZHkgb2YgYW55IGFzeW5jIGZ1bmN0aW9uLCBgYXdhaXQgeGAgaXMgdHJhbnNmb3JtZWQgdG9cbiAgLy8gYHlpZWxkIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCh4KWAsIHNvIHRoYXQgdGhlIHJ1bnRpbWUgY2FuIHRlc3RcbiAgLy8gYGhhc093bi5jYWxsKHZhbHVlLCBcIl9fYXdhaXRcIilgIHRvIGRldGVybWluZSBpZiB0aGUgeWllbGRlZCB2YWx1ZSBpc1xuICAvLyBtZWFudCB0byBiZSBhd2FpdGVkLlxuICBydW50aW1lLmF3cmFwID0gZnVuY3Rpb24oYXJnKSB7XG4gICAgcmV0dXJuIHsgX19hd2FpdDogYXJnIH07XG4gIH07XG5cbiAgZnVuY3Rpb24gQXN5bmNJdGVyYXRvcihnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBpbnZva2UobWV0aG9kLCBhcmcsIHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKGdlbmVyYXRvclttZXRob2RdLCBnZW5lcmF0b3IsIGFyZyk7XG4gICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICByZWplY3QocmVjb3JkLmFyZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgcmVzdWx0ID0gcmVjb3JkLmFyZztcbiAgICAgICAgdmFyIHZhbHVlID0gcmVzdWx0LnZhbHVlO1xuICAgICAgICBpZiAodmFsdWUgJiZcbiAgICAgICAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJlxuICAgICAgICAgICAgaGFzT3duLmNhbGwodmFsdWUsIFwiX19hd2FpdFwiKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsdWUuX19hd2FpdCkudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgaW52b2tlKFwibmV4dFwiLCB2YWx1ZSwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgIGludm9rZShcInRocm93XCIsIGVyciwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oZnVuY3Rpb24odW53cmFwcGVkKSB7XG4gICAgICAgICAgLy8gV2hlbiBhIHlpZWxkZWQgUHJvbWlzZSBpcyByZXNvbHZlZCwgaXRzIGZpbmFsIHZhbHVlIGJlY29tZXNcbiAgICAgICAgICAvLyB0aGUgLnZhbHVlIG9mIHRoZSBQcm9taXNlPHt2YWx1ZSxkb25lfT4gcmVzdWx0IGZvciB0aGVcbiAgICAgICAgICAvLyBjdXJyZW50IGl0ZXJhdGlvbi4gSWYgdGhlIFByb21pc2UgaXMgcmVqZWN0ZWQsIGhvd2V2ZXIsIHRoZVxuICAgICAgICAgIC8vIHJlc3VsdCBmb3IgdGhpcyBpdGVyYXRpb24gd2lsbCBiZSByZWplY3RlZCB3aXRoIHRoZSBzYW1lXG4gICAgICAgICAgLy8gcmVhc29uLiBOb3RlIHRoYXQgcmVqZWN0aW9ucyBvZiB5aWVsZGVkIFByb21pc2VzIGFyZSBub3RcbiAgICAgICAgICAvLyB0aHJvd24gYmFjayBpbnRvIHRoZSBnZW5lcmF0b3IgZnVuY3Rpb24sIGFzIGlzIHRoZSBjYXNlXG4gICAgICAgICAgLy8gd2hlbiBhbiBhd2FpdGVkIFByb21pc2UgaXMgcmVqZWN0ZWQuIFRoaXMgZGlmZmVyZW5jZSBpblxuICAgICAgICAgIC8vIGJlaGF2aW9yIGJldHdlZW4geWllbGQgYW5kIGF3YWl0IGlzIGltcG9ydGFudCwgYmVjYXVzZSBpdFxuICAgICAgICAgIC8vIGFsbG93cyB0aGUgY29uc3VtZXIgdG8gZGVjaWRlIHdoYXQgdG8gZG8gd2l0aCB0aGUgeWllbGRlZFxuICAgICAgICAgIC8vIHJlamVjdGlvbiAoc3dhbGxvdyBpdCBhbmQgY29udGludWUsIG1hbnVhbGx5IC50aHJvdyBpdCBiYWNrXG4gICAgICAgICAgLy8gaW50byB0aGUgZ2VuZXJhdG9yLCBhYmFuZG9uIGl0ZXJhdGlvbiwgd2hhdGV2ZXIpLiBXaXRoXG4gICAgICAgICAgLy8gYXdhaXQsIGJ5IGNvbnRyYXN0LCB0aGVyZSBpcyBubyBvcHBvcnR1bml0eSB0byBleGFtaW5lIHRoZVxuICAgICAgICAgIC8vIHJlamVjdGlvbiByZWFzb24gb3V0c2lkZSB0aGUgZ2VuZXJhdG9yIGZ1bmN0aW9uLCBzbyB0aGVcbiAgICAgICAgICAvLyBvbmx5IG9wdGlvbiBpcyB0byB0aHJvdyBpdCBmcm9tIHRoZSBhd2FpdCBleHByZXNzaW9uLCBhbmRcbiAgICAgICAgICAvLyBsZXQgdGhlIGdlbmVyYXRvciBmdW5jdGlvbiBoYW5kbGUgdGhlIGV4Y2VwdGlvbi5cbiAgICAgICAgICByZXN1bHQudmFsdWUgPSB1bndyYXBwZWQ7XG4gICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICB9LCByZWplY3QpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBwcmV2aW91c1Byb21pc2U7XG5cbiAgICBmdW5jdGlvbiBlbnF1ZXVlKG1ldGhvZCwgYXJnKSB7XG4gICAgICBmdW5jdGlvbiBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZygpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgIGludm9rZShtZXRob2QsIGFyZywgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBwcmV2aW91c1Byb21pc2UgPVxuICAgICAgICAvLyBJZiBlbnF1ZXVlIGhhcyBiZWVuIGNhbGxlZCBiZWZvcmUsIHRoZW4gd2Ugd2FudCB0byB3YWl0IHVudGlsXG4gICAgICAgIC8vIGFsbCBwcmV2aW91cyBQcm9taXNlcyBoYXZlIGJlZW4gcmVzb2x2ZWQgYmVmb3JlIGNhbGxpbmcgaW52b2tlLFxuICAgICAgICAvLyBzbyB0aGF0IHJlc3VsdHMgYXJlIGFsd2F5cyBkZWxpdmVyZWQgaW4gdGhlIGNvcnJlY3Qgb3JkZXIuIElmXG4gICAgICAgIC8vIGVucXVldWUgaGFzIG5vdCBiZWVuIGNhbGxlZCBiZWZvcmUsIHRoZW4gaXQgaXMgaW1wb3J0YW50IHRvXG4gICAgICAgIC8vIGNhbGwgaW52b2tlIGltbWVkaWF0ZWx5LCB3aXRob3V0IHdhaXRpbmcgb24gYSBjYWxsYmFjayB0byBmaXJlLFxuICAgICAgICAvLyBzbyB0aGF0IHRoZSBhc3luYyBnZW5lcmF0b3IgZnVuY3Rpb24gaGFzIHRoZSBvcHBvcnR1bml0eSB0byBkb1xuICAgICAgICAvLyBhbnkgbmVjZXNzYXJ5IHNldHVwIGluIGEgcHJlZGljdGFibGUgd2F5LiBUaGlzIHByZWRpY3RhYmlsaXR5XG4gICAgICAgIC8vIGlzIHdoeSB0aGUgUHJvbWlzZSBjb25zdHJ1Y3RvciBzeW5jaHJvbm91c2x5IGludm9rZXMgaXRzXG4gICAgICAgIC8vIGV4ZWN1dG9yIGNhbGxiYWNrLCBhbmQgd2h5IGFzeW5jIGZ1bmN0aW9ucyBzeW5jaHJvbm91c2x5XG4gICAgICAgIC8vIGV4ZWN1dGUgY29kZSBiZWZvcmUgdGhlIGZpcnN0IGF3YWl0LiBTaW5jZSB3ZSBpbXBsZW1lbnQgc2ltcGxlXG4gICAgICAgIC8vIGFzeW5jIGZ1bmN0aW9ucyBpbiB0ZXJtcyBvZiBhc3luYyBnZW5lcmF0b3JzLCBpdCBpcyBlc3BlY2lhbGx5XG4gICAgICAgIC8vIGltcG9ydGFudCB0byBnZXQgdGhpcyByaWdodCwgZXZlbiB0aG91Z2ggaXQgcmVxdWlyZXMgY2FyZS5cbiAgICAgICAgcHJldmlvdXNQcm9taXNlID8gcHJldmlvdXNQcm9taXNlLnRoZW4oXG4gICAgICAgICAgY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcsXG4gICAgICAgICAgLy8gQXZvaWQgcHJvcGFnYXRpbmcgZmFpbHVyZXMgdG8gUHJvbWlzZXMgcmV0dXJuZWQgYnkgbGF0ZXJcbiAgICAgICAgICAvLyBpbnZvY2F0aW9ucyBvZiB0aGUgaXRlcmF0b3IuXG4gICAgICAgICAgY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmdcbiAgICAgICAgKSA6IGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCk7XG4gICAgfVxuXG4gICAgLy8gRGVmaW5lIHRoZSB1bmlmaWVkIGhlbHBlciBtZXRob2QgdGhhdCBpcyB1c2VkIHRvIGltcGxlbWVudCAubmV4dCxcbiAgICAvLyAudGhyb3csIGFuZCAucmV0dXJuIChzZWUgZGVmaW5lSXRlcmF0b3JNZXRob2RzKS5cbiAgICB0aGlzLl9pbnZva2UgPSBlbnF1ZXVlO1xuICB9XG5cbiAgZGVmaW5lSXRlcmF0b3JNZXRob2RzKEFzeW5jSXRlcmF0b3IucHJvdG90eXBlKTtcbiAgQXN5bmNJdGVyYXRvci5wcm90b3R5cGVbYXN5bmNJdGVyYXRvclN5bWJvbF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIHJ1bnRpbWUuQXN5bmNJdGVyYXRvciA9IEFzeW5jSXRlcmF0b3I7XG5cbiAgLy8gTm90ZSB0aGF0IHNpbXBsZSBhc3luYyBmdW5jdGlvbnMgYXJlIGltcGxlbWVudGVkIG9uIHRvcCBvZlxuICAvLyBBc3luY0l0ZXJhdG9yIG9iamVjdHM7IHRoZXkganVzdCByZXR1cm4gYSBQcm9taXNlIGZvciB0aGUgdmFsdWUgb2ZcbiAgLy8gdGhlIGZpbmFsIHJlc3VsdCBwcm9kdWNlZCBieSB0aGUgaXRlcmF0b3IuXG4gIHJ1bnRpbWUuYXN5bmMgPSBmdW5jdGlvbihpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCkge1xuICAgIHZhciBpdGVyID0gbmV3IEFzeW5jSXRlcmF0b3IoXG4gICAgICB3cmFwKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KVxuICAgICk7XG5cbiAgICByZXR1cm4gcnVudGltZS5pc0dlbmVyYXRvckZ1bmN0aW9uKG91dGVyRm4pXG4gICAgICA/IGl0ZXIgLy8gSWYgb3V0ZXJGbiBpcyBhIGdlbmVyYXRvciwgcmV0dXJuIHRoZSBmdWxsIGl0ZXJhdG9yLlxuICAgICAgOiBpdGVyLm5leHQoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgIHJldHVybiByZXN1bHQuZG9uZSA/IHJlc3VsdC52YWx1ZSA6IGl0ZXIubmV4dCgpO1xuICAgICAgICB9KTtcbiAgfTtcblxuICBmdW5jdGlvbiBtYWtlSW52b2tlTWV0aG9kKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpIHtcbiAgICB2YXIgc3RhdGUgPSBHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0O1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGludm9rZShtZXRob2QsIGFyZykge1xuICAgICAgaWYgKHN0YXRlID09PSBHZW5TdGF0ZUV4ZWN1dGluZykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBydW5uaW5nXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlQ29tcGxldGVkKSB7XG4gICAgICAgIGlmIChtZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIHRocm93IGFyZztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJlIGZvcmdpdmluZywgcGVyIDI1LjMuMy4zLjMgb2YgdGhlIHNwZWM6XG4gICAgICAgIC8vIGh0dHBzOi8vcGVvcGxlLm1vemlsbGEub3JnL35qb3JlbmRvcmZmL2VzNi1kcmFmdC5odG1sI3NlYy1nZW5lcmF0b3JyZXN1bWVcbiAgICAgICAgcmV0dXJuIGRvbmVSZXN1bHQoKTtcbiAgICAgIH1cblxuICAgICAgY29udGV4dC5tZXRob2QgPSBtZXRob2Q7XG4gICAgICBjb250ZXh0LmFyZyA9IGFyZztcblxuICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgdmFyIGRlbGVnYXRlID0gY29udGV4dC5kZWxlZ2F0ZTtcbiAgICAgICAgaWYgKGRlbGVnYXRlKSB7XG4gICAgICAgICAgdmFyIGRlbGVnYXRlUmVzdWx0ID0gbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCk7XG4gICAgICAgICAgaWYgKGRlbGVnYXRlUmVzdWx0KSB7XG4gICAgICAgICAgICBpZiAoZGVsZWdhdGVSZXN1bHQgPT09IENvbnRpbnVlU2VudGluZWwpIGNvbnRpbnVlO1xuICAgICAgICAgICAgcmV0dXJuIGRlbGVnYXRlUmVzdWx0O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjb250ZXh0Lm1ldGhvZCA9PT0gXCJuZXh0XCIpIHtcbiAgICAgICAgICAvLyBTZXR0aW5nIGNvbnRleHQuX3NlbnQgZm9yIGxlZ2FjeSBzdXBwb3J0IG9mIEJhYmVsJ3NcbiAgICAgICAgICAvLyBmdW5jdGlvbi5zZW50IGltcGxlbWVudGF0aW9uLlxuICAgICAgICAgIGNvbnRleHQuc2VudCA9IGNvbnRleHQuX3NlbnQgPSBjb250ZXh0LmFyZztcblxuICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHQubWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlU3VzcGVuZGVkU3RhcnQpIHtcbiAgICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7XG4gICAgICAgICAgICB0aHJvdyBjb250ZXh0LmFyZztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb250ZXh0LmRpc3BhdGNoRXhjZXB0aW9uKGNvbnRleHQuYXJnKTtcblxuICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHQubWV0aG9kID09PSBcInJldHVyblwiKSB7XG4gICAgICAgICAgY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgY29udGV4dC5hcmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUV4ZWN1dGluZztcblxuICAgICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goaW5uZXJGbiwgc2VsZiwgY29udGV4dCk7XG4gICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJub3JtYWxcIikge1xuICAgICAgICAgIC8vIElmIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24gZnJvbSBpbm5lckZuLCB3ZSBsZWF2ZSBzdGF0ZSA9PT1cbiAgICAgICAgICAvLyBHZW5TdGF0ZUV4ZWN1dGluZyBhbmQgbG9vcCBiYWNrIGZvciBhbm90aGVyIGludm9jYXRpb24uXG4gICAgICAgICAgc3RhdGUgPSBjb250ZXh0LmRvbmVcbiAgICAgICAgICAgID8gR2VuU3RhdGVDb21wbGV0ZWRcbiAgICAgICAgICAgIDogR2VuU3RhdGVTdXNwZW5kZWRZaWVsZDtcblxuICAgICAgICAgIGlmIChyZWNvcmQuYXJnID09PSBDb250aW51ZVNlbnRpbmVsKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IHJlY29yZC5hcmcsXG4gICAgICAgICAgICBkb25lOiBjb250ZXh0LmRvbmVcbiAgICAgICAgICB9O1xuXG4gICAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7XG4gICAgICAgICAgLy8gRGlzcGF0Y2ggdGhlIGV4Y2VwdGlvbiBieSBsb29waW5nIGJhY2sgYXJvdW5kIHRvIHRoZVxuICAgICAgICAgIC8vIGNvbnRleHQuZGlzcGF0Y2hFeGNlcHRpb24oY29udGV4dC5hcmcpIGNhbGwgYWJvdmUuXG4gICAgICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgICAgY29udGV4dC5hcmcgPSByZWNvcmQuYXJnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8vIENhbGwgZGVsZWdhdGUuaXRlcmF0b3JbY29udGV4dC5tZXRob2RdKGNvbnRleHQuYXJnKSBhbmQgaGFuZGxlIHRoZVxuICAvLyByZXN1bHQsIGVpdGhlciBieSByZXR1cm5pbmcgYSB7IHZhbHVlLCBkb25lIH0gcmVzdWx0IGZyb20gdGhlXG4gIC8vIGRlbGVnYXRlIGl0ZXJhdG9yLCBvciBieSBtb2RpZnlpbmcgY29udGV4dC5tZXRob2QgYW5kIGNvbnRleHQuYXJnLFxuICAvLyBzZXR0aW5nIGNvbnRleHQuZGVsZWdhdGUgdG8gbnVsbCwgYW5kIHJldHVybmluZyB0aGUgQ29udGludWVTZW50aW5lbC5cbiAgZnVuY3Rpb24gbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCkge1xuICAgIHZhciBtZXRob2QgPSBkZWxlZ2F0ZS5pdGVyYXRvcltjb250ZXh0Lm1ldGhvZF07XG4gICAgaWYgKG1ldGhvZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAvLyBBIC50aHJvdyBvciAucmV0dXJuIHdoZW4gdGhlIGRlbGVnYXRlIGl0ZXJhdG9yIGhhcyBubyAudGhyb3dcbiAgICAgIC8vIG1ldGhvZCBhbHdheXMgdGVybWluYXRlcyB0aGUgeWllbGQqIGxvb3AuXG4gICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcblxuICAgICAgaWYgKGNvbnRleHQubWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgaWYgKGRlbGVnYXRlLml0ZXJhdG9yLnJldHVybikge1xuICAgICAgICAgIC8vIElmIHRoZSBkZWxlZ2F0ZSBpdGVyYXRvciBoYXMgYSByZXR1cm4gbWV0aG9kLCBnaXZlIGl0IGFcbiAgICAgICAgICAvLyBjaGFuY2UgdG8gY2xlYW4gdXAuXG4gICAgICAgICAgY29udGV4dC5tZXRob2QgPSBcInJldHVyblwiO1xuICAgICAgICAgIGNvbnRleHQuYXJnID0gdW5kZWZpbmVkO1xuICAgICAgICAgIG1heWJlSW52b2tlRGVsZWdhdGUoZGVsZWdhdGUsIGNvbnRleHQpO1xuXG4gICAgICAgICAgaWYgKGNvbnRleHQubWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICAgIC8vIElmIG1heWJlSW52b2tlRGVsZWdhdGUoY29udGV4dCkgY2hhbmdlZCBjb250ZXh0Lm1ldGhvZCBmcm9tXG4gICAgICAgICAgICAvLyBcInJldHVyblwiIHRvIFwidGhyb3dcIiwgbGV0IHRoYXQgb3ZlcnJpZGUgdGhlIFR5cGVFcnJvciBiZWxvdy5cbiAgICAgICAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnRleHQubWV0aG9kID0gXCJ0aHJvd1wiO1xuICAgICAgICBjb250ZXh0LmFyZyA9IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgICAgXCJUaGUgaXRlcmF0b3IgZG9lcyBub3QgcHJvdmlkZSBhICd0aHJvdycgbWV0aG9kXCIpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9XG5cbiAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2gobWV0aG9kLCBkZWxlZ2F0ZS5pdGVyYXRvciwgY29udGV4dC5hcmcpO1xuXG4gICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgIGNvbnRleHQubWV0aG9kID0gXCJ0aHJvd1wiO1xuICAgICAgY29udGV4dC5hcmcgPSByZWNvcmQuYXJnO1xuICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9XG5cbiAgICB2YXIgaW5mbyA9IHJlY29yZC5hcmc7XG5cbiAgICBpZiAoISBpbmZvKSB7XG4gICAgICBjb250ZXh0Lm1ldGhvZCA9IFwidGhyb3dcIjtcbiAgICAgIGNvbnRleHQuYXJnID0gbmV3IFR5cGVFcnJvcihcIml0ZXJhdG9yIHJlc3VsdCBpcyBub3QgYW4gb2JqZWN0XCIpO1xuICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9XG5cbiAgICBpZiAoaW5mby5kb25lKSB7XG4gICAgICAvLyBBc3NpZ24gdGhlIHJlc3VsdCBvZiB0aGUgZmluaXNoZWQgZGVsZWdhdGUgdG8gdGhlIHRlbXBvcmFyeVxuICAgICAgLy8gdmFyaWFibGUgc3BlY2lmaWVkIGJ5IGRlbGVnYXRlLnJlc3VsdE5hbWUgKHNlZSBkZWxlZ2F0ZVlpZWxkKS5cbiAgICAgIGNvbnRleHRbZGVsZWdhdGUucmVzdWx0TmFtZV0gPSBpbmZvLnZhbHVlO1xuXG4gICAgICAvLyBSZXN1bWUgZXhlY3V0aW9uIGF0IHRoZSBkZXNpcmVkIGxvY2F0aW9uIChzZWUgZGVsZWdhdGVZaWVsZCkuXG4gICAgICBjb250ZXh0Lm5leHQgPSBkZWxlZ2F0ZS5uZXh0TG9jO1xuXG4gICAgICAvLyBJZiBjb250ZXh0Lm1ldGhvZCB3YXMgXCJ0aHJvd1wiIGJ1dCB0aGUgZGVsZWdhdGUgaGFuZGxlZCB0aGVcbiAgICAgIC8vIGV4Y2VwdGlvbiwgbGV0IHRoZSBvdXRlciBnZW5lcmF0b3IgcHJvY2VlZCBub3JtYWxseS4gSWZcbiAgICAgIC8vIGNvbnRleHQubWV0aG9kIHdhcyBcIm5leHRcIiwgZm9yZ2V0IGNvbnRleHQuYXJnIHNpbmNlIGl0IGhhcyBiZWVuXG4gICAgICAvLyBcImNvbnN1bWVkXCIgYnkgdGhlIGRlbGVnYXRlIGl0ZXJhdG9yLiBJZiBjb250ZXh0Lm1ldGhvZCB3YXNcbiAgICAgIC8vIFwicmV0dXJuXCIsIGFsbG93IHRoZSBvcmlnaW5hbCAucmV0dXJuIGNhbGwgdG8gY29udGludWUgaW4gdGhlXG4gICAgICAvLyBvdXRlciBnZW5lcmF0b3IuXG4gICAgICBpZiAoY29udGV4dC5tZXRob2QgIT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgY29udGV4dC5tZXRob2QgPSBcIm5leHRcIjtcbiAgICAgICAgY29udGV4dC5hcmcgPSB1bmRlZmluZWQ7XG4gICAgICB9XG5cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gUmUteWllbGQgdGhlIHJlc3VsdCByZXR1cm5lZCBieSB0aGUgZGVsZWdhdGUgbWV0aG9kLlxuICAgICAgcmV0dXJuIGluZm87XG4gICAgfVxuXG4gICAgLy8gVGhlIGRlbGVnYXRlIGl0ZXJhdG9yIGlzIGZpbmlzaGVkLCBzbyBmb3JnZXQgaXQgYW5kIGNvbnRpbnVlIHdpdGhcbiAgICAvLyB0aGUgb3V0ZXIgZ2VuZXJhdG9yLlxuICAgIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsO1xuICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICB9XG5cbiAgLy8gRGVmaW5lIEdlbmVyYXRvci5wcm90b3R5cGUue25leHQsdGhyb3cscmV0dXJufSBpbiB0ZXJtcyBvZiB0aGVcbiAgLy8gdW5pZmllZCAuX2ludm9rZSBoZWxwZXIgbWV0aG9kLlxuICBkZWZpbmVJdGVyYXRvck1ldGhvZHMoR3ApO1xuXG4gIEdwW3RvU3RyaW5nVGFnU3ltYm9sXSA9IFwiR2VuZXJhdG9yXCI7XG5cbiAgLy8gQSBHZW5lcmF0b3Igc2hvdWxkIGFsd2F5cyByZXR1cm4gaXRzZWxmIGFzIHRoZSBpdGVyYXRvciBvYmplY3Qgd2hlbiB0aGVcbiAgLy8gQEBpdGVyYXRvciBmdW5jdGlvbiBpcyBjYWxsZWQgb24gaXQuIFNvbWUgYnJvd3NlcnMnIGltcGxlbWVudGF0aW9ucyBvZiB0aGVcbiAgLy8gaXRlcmF0b3IgcHJvdG90eXBlIGNoYWluIGluY29ycmVjdGx5IGltcGxlbWVudCB0aGlzLCBjYXVzaW5nIHRoZSBHZW5lcmF0b3JcbiAgLy8gb2JqZWN0IHRvIG5vdCBiZSByZXR1cm5lZCBmcm9tIHRoaXMgY2FsbC4gVGhpcyBlbnN1cmVzIHRoYXQgZG9lc24ndCBoYXBwZW4uXG4gIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVnZW5lcmF0b3IvaXNzdWVzLzI3NCBmb3IgbW9yZSBkZXRhaWxzLlxuICBHcFtpdGVyYXRvclN5bWJvbF0gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBHcC50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBcIltvYmplY3QgR2VuZXJhdG9yXVwiO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHB1c2hUcnlFbnRyeShsb2NzKSB7XG4gICAgdmFyIGVudHJ5ID0geyB0cnlMb2M6IGxvY3NbMF0gfTtcblxuICAgIGlmICgxIGluIGxvY3MpIHtcbiAgICAgIGVudHJ5LmNhdGNoTG9jID0gbG9jc1sxXTtcbiAgICB9XG5cbiAgICBpZiAoMiBpbiBsb2NzKSB7XG4gICAgICBlbnRyeS5maW5hbGx5TG9jID0gbG9jc1syXTtcbiAgICAgIGVudHJ5LmFmdGVyTG9jID0gbG9jc1szXTtcbiAgICB9XG5cbiAgICB0aGlzLnRyeUVudHJpZXMucHVzaChlbnRyeSk7XG4gIH1cblxuICBmdW5jdGlvbiByZXNldFRyeUVudHJ5KGVudHJ5KSB7XG4gICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb24gfHwge307XG4gICAgcmVjb3JkLnR5cGUgPSBcIm5vcm1hbFwiO1xuICAgIGRlbGV0ZSByZWNvcmQuYXJnO1xuICAgIGVudHJ5LmNvbXBsZXRpb24gPSByZWNvcmQ7XG4gIH1cblxuICBmdW5jdGlvbiBDb250ZXh0KHRyeUxvY3NMaXN0KSB7XG4gICAgLy8gVGhlIHJvb3QgZW50cnkgb2JqZWN0IChlZmZlY3RpdmVseSBhIHRyeSBzdGF0ZW1lbnQgd2l0aG91dCBhIGNhdGNoXG4gICAgLy8gb3IgYSBmaW5hbGx5IGJsb2NrKSBnaXZlcyB1cyBhIHBsYWNlIHRvIHN0b3JlIHZhbHVlcyB0aHJvd24gZnJvbVxuICAgIC8vIGxvY2F0aW9ucyB3aGVyZSB0aGVyZSBpcyBubyBlbmNsb3NpbmcgdHJ5IHN0YXRlbWVudC5cbiAgICB0aGlzLnRyeUVudHJpZXMgPSBbeyB0cnlMb2M6IFwicm9vdFwiIH1dO1xuICAgIHRyeUxvY3NMaXN0LmZvckVhY2gocHVzaFRyeUVudHJ5LCB0aGlzKTtcbiAgICB0aGlzLnJlc2V0KHRydWUpO1xuICB9XG5cbiAgcnVudGltZS5rZXlzID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgdmFyIGtleXMgPSBbXTtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7XG4gICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICB9XG4gICAga2V5cy5yZXZlcnNlKCk7XG5cbiAgICAvLyBSYXRoZXIgdGhhbiByZXR1cm5pbmcgYW4gb2JqZWN0IHdpdGggYSBuZXh0IG1ldGhvZCwgd2Uga2VlcFxuICAgIC8vIHRoaW5ncyBzaW1wbGUgYW5kIHJldHVybiB0aGUgbmV4dCBmdW5jdGlvbiBpdHNlbGYuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICB3aGlsZSAoa2V5cy5sZW5ndGgpIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXMucG9wKCk7XG4gICAgICAgIGlmIChrZXkgaW4gb2JqZWN0KSB7XG4gICAgICAgICAgbmV4dC52YWx1ZSA9IGtleTtcbiAgICAgICAgICBuZXh0LmRvbmUgPSBmYWxzZTtcbiAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBUbyBhdm9pZCBjcmVhdGluZyBhbiBhZGRpdGlvbmFsIG9iamVjdCwgd2UganVzdCBoYW5nIHRoZSAudmFsdWVcbiAgICAgIC8vIGFuZCAuZG9uZSBwcm9wZXJ0aWVzIG9mZiB0aGUgbmV4dCBmdW5jdGlvbiBvYmplY3QgaXRzZWxmLiBUaGlzXG4gICAgICAvLyBhbHNvIGVuc3VyZXMgdGhhdCB0aGUgbWluaWZpZXIgd2lsbCBub3QgYW5vbnltaXplIHRoZSBmdW5jdGlvbi5cbiAgICAgIG5leHQuZG9uZSA9IHRydWU7XG4gICAgICByZXR1cm4gbmV4dDtcbiAgICB9O1xuICB9O1xuXG4gIGZ1bmN0aW9uIHZhbHVlcyhpdGVyYWJsZSkge1xuICAgIGlmIChpdGVyYWJsZSkge1xuICAgICAgdmFyIGl0ZXJhdG9yTWV0aG9kID0gaXRlcmFibGVbaXRlcmF0b3JTeW1ib2xdO1xuICAgICAgaWYgKGl0ZXJhdG9yTWV0aG9kKSB7XG4gICAgICAgIHJldHVybiBpdGVyYXRvck1ldGhvZC5jYWxsKGl0ZXJhYmxlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBpdGVyYWJsZS5uZXh0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhYmxlO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWlzTmFOKGl0ZXJhYmxlLmxlbmd0aCkpIHtcbiAgICAgICAgdmFyIGkgPSAtMSwgbmV4dCA9IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgd2hpbGUgKCsraSA8IGl0ZXJhYmxlLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGhhc093bi5jYWxsKGl0ZXJhYmxlLCBpKSkge1xuICAgICAgICAgICAgICBuZXh0LnZhbHVlID0gaXRlcmFibGVbaV07XG4gICAgICAgICAgICAgIG5leHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBuZXh0LnZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICAgIG5leHQuZG9uZSA9IHRydWU7XG5cbiAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gbmV4dC5uZXh0ID0gbmV4dDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gYW4gaXRlcmF0b3Igd2l0aCBubyB2YWx1ZXMuXG4gICAgcmV0dXJuIHsgbmV4dDogZG9uZVJlc3VsdCB9O1xuICB9XG4gIHJ1bnRpbWUudmFsdWVzID0gdmFsdWVzO1xuXG4gIGZ1bmN0aW9uIGRvbmVSZXN1bHQoKSB7XG4gICAgcmV0dXJuIHsgdmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZSB9O1xuICB9XG5cbiAgQ29udGV4dC5wcm90b3R5cGUgPSB7XG4gICAgY29uc3RydWN0b3I6IENvbnRleHQsXG5cbiAgICByZXNldDogZnVuY3Rpb24oc2tpcFRlbXBSZXNldCkge1xuICAgICAgdGhpcy5wcmV2ID0gMDtcbiAgICAgIHRoaXMubmV4dCA9IDA7XG4gICAgICAvLyBSZXNldHRpbmcgY29udGV4dC5fc2VudCBmb3IgbGVnYWN5IHN1cHBvcnQgb2YgQmFiZWwnc1xuICAgICAgLy8gZnVuY3Rpb24uc2VudCBpbXBsZW1lbnRhdGlvbi5cbiAgICAgIHRoaXMuc2VudCA9IHRoaXMuX3NlbnQgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICB0aGlzLm1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgdGhpcy5hcmcgPSB1bmRlZmluZWQ7XG5cbiAgICAgIHRoaXMudHJ5RW50cmllcy5mb3JFYWNoKHJlc2V0VHJ5RW50cnkpO1xuXG4gICAgICBpZiAoIXNraXBUZW1wUmVzZXQpIHtcbiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiB0aGlzKSB7XG4gICAgICAgICAgLy8gTm90IHN1cmUgYWJvdXQgdGhlIG9wdGltYWwgb3JkZXIgb2YgdGhlc2UgY29uZGl0aW9uczpcbiAgICAgICAgICBpZiAobmFtZS5jaGFyQXQoMCkgPT09IFwidFwiICYmXG4gICAgICAgICAgICAgIGhhc093bi5jYWxsKHRoaXMsIG5hbWUpICYmXG4gICAgICAgICAgICAgICFpc05hTigrbmFtZS5zbGljZSgxKSkpIHtcbiAgICAgICAgICAgIHRoaXNbbmFtZV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIHN0b3A6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5kb25lID0gdHJ1ZTtcblxuICAgICAgdmFyIHJvb3RFbnRyeSA9IHRoaXMudHJ5RW50cmllc1swXTtcbiAgICAgIHZhciByb290UmVjb3JkID0gcm9vdEVudHJ5LmNvbXBsZXRpb247XG4gICAgICBpZiAocm9vdFJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgdGhyb3cgcm9vdFJlY29yZC5hcmc7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLnJ2YWw7XG4gICAgfSxcblxuICAgIGRpc3BhdGNoRXhjZXB0aW9uOiBmdW5jdGlvbihleGNlcHRpb24pIHtcbiAgICAgIGlmICh0aGlzLmRvbmUpIHtcbiAgICAgICAgdGhyb3cgZXhjZXB0aW9uO1xuICAgICAgfVxuXG4gICAgICB2YXIgY29udGV4dCA9IHRoaXM7XG4gICAgICBmdW5jdGlvbiBoYW5kbGUobG9jLCBjYXVnaHQpIHtcbiAgICAgICAgcmVjb3JkLnR5cGUgPSBcInRocm93XCI7XG4gICAgICAgIHJlY29yZC5hcmcgPSBleGNlcHRpb247XG4gICAgICAgIGNvbnRleHQubmV4dCA9IGxvYztcblxuICAgICAgICBpZiAoY2F1Z2h0KSB7XG4gICAgICAgICAgLy8gSWYgdGhlIGRpc3BhdGNoZWQgZXhjZXB0aW9uIHdhcyBjYXVnaHQgYnkgYSBjYXRjaCBibG9jayxcbiAgICAgICAgICAvLyB0aGVuIGxldCB0aGF0IGNhdGNoIGJsb2NrIGhhbmRsZSB0aGUgZXhjZXB0aW9uIG5vcm1hbGx5LlxuICAgICAgICAgIGNvbnRleHQubWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICAgICAgY29udGV4dC5hcmcgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gISEgY2F1Z2h0O1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG5cbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gXCJyb290XCIpIHtcbiAgICAgICAgICAvLyBFeGNlcHRpb24gdGhyb3duIG91dHNpZGUgb2YgYW55IHRyeSBibG9jayB0aGF0IGNvdWxkIGhhbmRsZVxuICAgICAgICAgIC8vIGl0LCBzbyBzZXQgdGhlIGNvbXBsZXRpb24gdmFsdWUgb2YgdGhlIGVudGlyZSBmdW5jdGlvbiB0b1xuICAgICAgICAgIC8vIHRocm93IHRoZSBleGNlcHRpb24uXG4gICAgICAgICAgcmV0dXJuIGhhbmRsZShcImVuZFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPD0gdGhpcy5wcmV2KSB7XG4gICAgICAgICAgdmFyIGhhc0NhdGNoID0gaGFzT3duLmNhbGwoZW50cnksIFwiY2F0Y2hMb2NcIik7XG4gICAgICAgICAgdmFyIGhhc0ZpbmFsbHkgPSBoYXNPd24uY2FsbChlbnRyeSwgXCJmaW5hbGx5TG9jXCIpO1xuXG4gICAgICAgICAgaWYgKGhhc0NhdGNoICYmIGhhc0ZpbmFsbHkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5jYXRjaExvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmNhdGNoTG9jLCB0cnVlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmZpbmFsbHlMb2MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSBlbHNlIGlmIChoYXNDYXRjaCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmNhdGNoTG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuY2F0Y2hMb2MsIHRydWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSBlbHNlIGlmIChoYXNGaW5hbGx5KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmZpbmFsbHlMb2MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRyeSBzdGF0ZW1lbnQgd2l0aG91dCBjYXRjaCBvciBmaW5hbGx5XCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBhYnJ1cHQ6IGZ1bmN0aW9uKHR5cGUsIGFyZykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPD0gdGhpcy5wcmV2ICYmXG4gICAgICAgICAgICBoYXNPd24uY2FsbChlbnRyeSwgXCJmaW5hbGx5TG9jXCIpICYmXG4gICAgICAgICAgICB0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgdmFyIGZpbmFsbHlFbnRyeSA9IGVudHJ5O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChmaW5hbGx5RW50cnkgJiZcbiAgICAgICAgICAodHlwZSA9PT0gXCJicmVha1wiIHx8XG4gICAgICAgICAgIHR5cGUgPT09IFwiY29udGludWVcIikgJiZcbiAgICAgICAgICBmaW5hbGx5RW50cnkudHJ5TG9jIDw9IGFyZyAmJlxuICAgICAgICAgIGFyZyA8PSBmaW5hbGx5RW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAvLyBJZ25vcmUgdGhlIGZpbmFsbHkgZW50cnkgaWYgY29udHJvbCBpcyBub3QganVtcGluZyB0byBhXG4gICAgICAgIC8vIGxvY2F0aW9uIG91dHNpZGUgdGhlIHRyeS9jYXRjaCBibG9jay5cbiAgICAgICAgZmluYWxseUVudHJ5ID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgdmFyIHJlY29yZCA9IGZpbmFsbHlFbnRyeSA/IGZpbmFsbHlFbnRyeS5jb21wbGV0aW9uIDoge307XG4gICAgICByZWNvcmQudHlwZSA9IHR5cGU7XG4gICAgICByZWNvcmQuYXJnID0gYXJnO1xuXG4gICAgICBpZiAoZmluYWxseUVudHJ5KSB7XG4gICAgICAgIHRoaXMubWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICAgIHRoaXMubmV4dCA9IGZpbmFsbHlFbnRyeS5maW5hbGx5TG9jO1xuICAgICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuY29tcGxldGUocmVjb3JkKTtcbiAgICB9LFxuXG4gICAgY29tcGxldGU6IGZ1bmN0aW9uKHJlY29yZCwgYWZ0ZXJMb2MpIHtcbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIHRocm93IHJlY29yZC5hcmc7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJicmVha1wiIHx8XG4gICAgICAgICAgcmVjb3JkLnR5cGUgPT09IFwiY29udGludWVcIikge1xuICAgICAgICB0aGlzLm5leHQgPSByZWNvcmQuYXJnO1xuICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gXCJyZXR1cm5cIikge1xuICAgICAgICB0aGlzLnJ2YWwgPSB0aGlzLmFyZyA9IHJlY29yZC5hcmc7XG4gICAgICAgIHRoaXMubWV0aG9kID0gXCJyZXR1cm5cIjtcbiAgICAgICAgdGhpcy5uZXh0ID0gXCJlbmRcIjtcbiAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwibm9ybWFsXCIgJiYgYWZ0ZXJMb2MpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gYWZ0ZXJMb2M7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH0sXG5cbiAgICBmaW5pc2g6IGZ1bmN0aW9uKGZpbmFsbHlMb2MpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkuZmluYWxseUxvYyA9PT0gZmluYWxseUxvYykge1xuICAgICAgICAgIHRoaXMuY29tcGxldGUoZW50cnkuY29tcGxldGlvbiwgZW50cnkuYWZ0ZXJMb2MpO1xuICAgICAgICAgIHJlc2V0VHJ5RW50cnkoZW50cnkpO1xuICAgICAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIFwiY2F0Y2hcIjogZnVuY3Rpb24odHJ5TG9jKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gdHJ5TG9jKSB7XG4gICAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG4gICAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICAgIHZhciB0aHJvd24gPSByZWNvcmQuYXJnO1xuICAgICAgICAgICAgcmVzZXRUcnlFbnRyeShlbnRyeSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aHJvd247XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gVGhlIGNvbnRleHQuY2F0Y2ggbWV0aG9kIG11c3Qgb25seSBiZSBjYWxsZWQgd2l0aCBhIGxvY2F0aW9uXG4gICAgICAvLyBhcmd1bWVudCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEga25vd24gY2F0Y2ggYmxvY2suXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbGxlZ2FsIGNhdGNoIGF0dGVtcHRcIik7XG4gICAgfSxcblxuICAgIGRlbGVnYXRlWWllbGQ6IGZ1bmN0aW9uKGl0ZXJhYmxlLCByZXN1bHROYW1lLCBuZXh0TG9jKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlID0ge1xuICAgICAgICBpdGVyYXRvcjogdmFsdWVzKGl0ZXJhYmxlKSxcbiAgICAgICAgcmVzdWx0TmFtZTogcmVzdWx0TmFtZSxcbiAgICAgICAgbmV4dExvYzogbmV4dExvY1xuICAgICAgfTtcblxuICAgICAgaWYgKHRoaXMubWV0aG9kID09PSBcIm5leHRcIikge1xuICAgICAgICAvLyBEZWxpYmVyYXRlbHkgZm9yZ2V0IHRoZSBsYXN0IHNlbnQgdmFsdWUgc28gdGhhdCB3ZSBkb24ndFxuICAgICAgICAvLyBhY2NpZGVudGFsbHkgcGFzcyBpdCBvbiB0byB0aGUgZGVsZWdhdGUuXG4gICAgICAgIHRoaXMuYXJnID0gdW5kZWZpbmVkO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9XG4gIH07XG59KShcbiAgLy8gSW4gc2xvcHB5IG1vZGUsIHVuYm91bmQgYHRoaXNgIHJlZmVycyB0byB0aGUgZ2xvYmFsIG9iamVjdCwgZmFsbGJhY2sgdG9cbiAgLy8gRnVuY3Rpb24gY29uc3RydWN0b3IgaWYgd2UncmUgaW4gZ2xvYmFsIHN0cmljdCBtb2RlLiBUaGF0IGlzIHNhZGx5IGEgZm9ybVxuICAvLyBvZiBpbmRpcmVjdCBldmFsIHdoaWNoIHZpb2xhdGVzIENvbnRlbnQgU2VjdXJpdHkgUG9saWN5LlxuICAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzIH0pKCkgfHwgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpXG4pO1xuIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwicmVnZW5lcmF0b3ItcnVudGltZVwiKTtcbiIsInJlcXVpcmUoJy4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5jcmVhdGUnKTtcbnZhciAkT2JqZWN0ID0gcmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9fY29yZScpLk9iamVjdDtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gY3JlYXRlKFAsIEQpIHtcbiAgcmV0dXJuICRPYmplY3QuY3JlYXRlKFAsIEQpO1xufTtcbiIsInJlcXVpcmUoJy4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5kZWZpbmUtcHJvcGVydHknKTtcbnZhciAkT2JqZWN0ID0gcmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9fY29yZScpLk9iamVjdDtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYykge1xuICByZXR1cm4gJE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBkZXNjKTtcbn07XG4iLCJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yJyk7XG52YXIgJE9iamVjdCA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvX2NvcmUnKS5PYmplY3Q7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KSB7XG4gIHJldHVybiAkT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KTtcbn07XG4iLCJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LXByb3RvdHlwZS1vZicpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzL19jb3JlJykuT2JqZWN0LmdldFByb3RvdHlwZU9mO1xuIiwicmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LnNldC1wcm90b3R5cGUtb2YnKTtcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9fY29yZScpLk9iamVjdC5zZXRQcm90b3R5cGVPZjtcbiIsInJlcXVpcmUoJy4uL21vZHVsZXMvZXM2Lm9iamVjdC50by1zdHJpbmcnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnN0cmluZy5pdGVyYXRvcicpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5wcm9taXNlJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNy5wcm9taXNlLmZpbmFsbHknKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM3LnByb21pc2UudHJ5Jyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4uL21vZHVsZXMvX2NvcmUnKS5Qcm9taXNlO1xuIiwicmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczYuc3ltYm9sJyk7XG5yZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nJyk7XG5yZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNy5zeW1ib2wuYXN5bmMtaXRlcmF0b3InKTtcbnJlcXVpcmUoJy4uLy4uL21vZHVsZXMvZXM3LnN5bWJvbC5vYnNlcnZhYmxlJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvX2NvcmUnKS5TeW1ib2w7XG4iLCJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3InKTtcbnJlcXVpcmUoJy4uLy4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZScpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzL193a3MtZXh0JykuZignaXRlcmF0b3InKTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIGlmICh0eXBlb2YgaXQgIT0gJ2Z1bmN0aW9uJykgdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTtcbiAgcmV0dXJuIGl0O1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKCkgeyAvKiBlbXB0eSAqLyB9O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQsIENvbnN0cnVjdG9yLCBuYW1lLCBmb3JiaWRkZW5GaWVsZCkge1xuICBpZiAoIShpdCBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSB8fCAoZm9yYmlkZGVuRmllbGQgIT09IHVuZGVmaW5lZCAmJiBmb3JiaWRkZW5GaWVsZCBpbiBpdCkpIHtcbiAgICB0aHJvdyBUeXBlRXJyb3IobmFtZSArICc6IGluY29ycmVjdCBpbnZvY2F0aW9uIScpO1xuICB9IHJldHVybiBpdDtcbn07XG4iLCJ2YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIGlmICghaXNPYmplY3QoaXQpKSB0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhbiBvYmplY3QhJyk7XG4gIHJldHVybiBpdDtcbn07XG4iLCIvLyBmYWxzZSAtPiBBcnJheSNpbmRleE9mXG4vLyB0cnVlICAtPiBBcnJheSNpbmNsdWRlc1xudmFyIHRvSU9iamVjdCA9IHJlcXVpcmUoJy4vX3RvLWlvYmplY3QnKTtcbnZhciB0b0xlbmd0aCA9IHJlcXVpcmUoJy4vX3RvLWxlbmd0aCcpO1xudmFyIHRvQWJzb2x1dGVJbmRleCA9IHJlcXVpcmUoJy4vX3RvLWFic29sdXRlLWluZGV4Jyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChJU19JTkNMVURFUykge1xuICByZXR1cm4gZnVuY3Rpb24gKCR0aGlzLCBlbCwgZnJvbUluZGV4KSB7XG4gICAgdmFyIE8gPSB0b0lPYmplY3QoJHRoaXMpO1xuICAgIHZhciBsZW5ndGggPSB0b0xlbmd0aChPLmxlbmd0aCk7XG4gICAgdmFyIGluZGV4ID0gdG9BYnNvbHV0ZUluZGV4KGZyb21JbmRleCwgbGVuZ3RoKTtcbiAgICB2YXIgdmFsdWU7XG4gICAgLy8gQXJyYXkjaW5jbHVkZXMgdXNlcyBTYW1lVmFsdWVaZXJvIGVxdWFsaXR5IGFsZ29yaXRobVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1zZWxmLWNvbXBhcmVcbiAgICBpZiAoSVNfSU5DTFVERVMgJiYgZWwgIT0gZWwpIHdoaWxlIChsZW5ndGggPiBpbmRleCkge1xuICAgICAgdmFsdWUgPSBPW2luZGV4KytdO1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNlbGYtY29tcGFyZVxuICAgICAgaWYgKHZhbHVlICE9IHZhbHVlKSByZXR1cm4gdHJ1ZTtcbiAgICAvLyBBcnJheSNpbmRleE9mIGlnbm9yZXMgaG9sZXMsIEFycmF5I2luY2x1ZGVzIC0gbm90XG4gICAgfSBlbHNlIGZvciAoO2xlbmd0aCA+IGluZGV4OyBpbmRleCsrKSBpZiAoSVNfSU5DTFVERVMgfHwgaW5kZXggaW4gTykge1xuICAgICAgaWYgKE9baW5kZXhdID09PSBlbCkgcmV0dXJuIElTX0lOQ0xVREVTIHx8IGluZGV4IHx8IDA7XG4gICAgfSByZXR1cm4gIUlTX0lOQ0xVREVTICYmIC0xO1xuICB9O1xufTtcbiIsIi8vIGdldHRpbmcgdGFnIGZyb20gMTkuMS4zLjYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZygpXG52YXIgY29mID0gcmVxdWlyZSgnLi9fY29mJyk7XG52YXIgVEFHID0gcmVxdWlyZSgnLi9fd2tzJykoJ3RvU3RyaW5nVGFnJyk7XG4vLyBFUzMgd3JvbmcgaGVyZVxudmFyIEFSRyA9IGNvZihmdW5jdGlvbiAoKSB7IHJldHVybiBhcmd1bWVudHM7IH0oKSkgPT0gJ0FyZ3VtZW50cyc7XG5cbi8vIGZhbGxiYWNrIGZvciBJRTExIFNjcmlwdCBBY2Nlc3MgRGVuaWVkIGVycm9yXG52YXIgdHJ5R2V0ID0gZnVuY3Rpb24gKGl0LCBrZXkpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gaXRba2V5XTtcbiAgfSBjYXRjaCAoZSkgeyAvKiBlbXB0eSAqLyB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICB2YXIgTywgVCwgQjtcbiAgcmV0dXJuIGl0ID09PSB1bmRlZmluZWQgPyAnVW5kZWZpbmVkJyA6IGl0ID09PSBudWxsID8gJ051bGwnXG4gICAgLy8gQEB0b1N0cmluZ1RhZyBjYXNlXG4gICAgOiB0eXBlb2YgKFQgPSB0cnlHZXQoTyA9IE9iamVjdChpdCksIFRBRykpID09ICdzdHJpbmcnID8gVFxuICAgIC8vIGJ1aWx0aW5UYWcgY2FzZVxuICAgIDogQVJHID8gY29mKE8pXG4gICAgLy8gRVMzIGFyZ3VtZW50cyBmYWxsYmFja1xuICAgIDogKEIgPSBjb2YoTykpID09ICdPYmplY3QnICYmIHR5cGVvZiBPLmNhbGxlZSA9PSAnZnVuY3Rpb24nID8gJ0FyZ3VtZW50cycgOiBCO1xufTtcbiIsInZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpO1xufTtcbiIsInZhciBjb3JlID0gbW9kdWxlLmV4cG9ydHMgPSB7IHZlcnNpb246ICcyLjYuMTInIH07XG5pZiAodHlwZW9mIF9fZSA9PSAnbnVtYmVyJykgX19lID0gY29yZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZlxuIiwiLy8gb3B0aW9uYWwgLyBzaW1wbGUgY29udGV4dCBiaW5kaW5nXG52YXIgYUZ1bmN0aW9uID0gcmVxdWlyZSgnLi9fYS1mdW5jdGlvbicpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZm4sIHRoYXQsIGxlbmd0aCkge1xuICBhRnVuY3Rpb24oZm4pO1xuICBpZiAodGhhdCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZm47XG4gIHN3aXRjaCAobGVuZ3RoKSB7XG4gICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEpO1xuICAgIH07XG4gICAgY2FzZSAyOiByZXR1cm4gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIpO1xuICAgIH07XG4gICAgY2FzZSAzOiByZXR1cm4gZnVuY3Rpb24gKGEsIGIsIGMpIHtcbiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIsIGMpO1xuICAgIH07XG4gIH1cbiAgcmV0dXJuIGZ1bmN0aW9uICgvKiAuLi5hcmdzICovKSB7XG4gICAgcmV0dXJuIGZuLmFwcGx5KHRoYXQsIGFyZ3VtZW50cyk7XG4gIH07XG59O1xuIiwiLy8gNy4yLjEgUmVxdWlyZU9iamVjdENvZXJjaWJsZShhcmd1bWVudClcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIGlmIChpdCA9PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcihcIkNhbid0IGNhbGwgbWV0aG9kIG9uICBcIiArIGl0KTtcbiAgcmV0dXJuIGl0O1xufTtcbiIsIi8vIFRoYW5rJ3MgSUU4IGZvciBoaXMgZnVubnkgZGVmaW5lUHJvcGVydHlcbm1vZHVsZS5leHBvcnRzID0gIXJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAnYScsIHsgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiA3OyB9IH0pLmEgIT0gNztcbn0pO1xuIiwidmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG52YXIgZG9jdW1lbnQgPSByZXF1aXJlKCcuL19nbG9iYWwnKS5kb2N1bWVudDtcbi8vIHR5cGVvZiBkb2N1bWVudC5jcmVhdGVFbGVtZW50IGlzICdvYmplY3QnIGluIG9sZCBJRVxudmFyIGlzID0gaXNPYmplY3QoZG9jdW1lbnQpICYmIGlzT2JqZWN0KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGlzID8gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChpdCkgOiB7fTtcbn07XG4iLCIvLyBJRSA4LSBkb24ndCBlbnVtIGJ1ZyBrZXlzXG5tb2R1bGUuZXhwb3J0cyA9IChcbiAgJ2NvbnN0cnVjdG9yLGhhc093blByb3BlcnR5LGlzUHJvdG90eXBlT2YscHJvcGVydHlJc0VudW1lcmFibGUsdG9Mb2NhbGVTdHJpbmcsdG9TdHJpbmcsdmFsdWVPZidcbikuc3BsaXQoJywnKTtcbiIsIi8vIGFsbCBlbnVtZXJhYmxlIG9iamVjdCBrZXlzLCBpbmNsdWRlcyBzeW1ib2xzXG52YXIgZ2V0S2V5cyA9IHJlcXVpcmUoJy4vX29iamVjdC1rZXlzJyk7XG52YXIgZ09QUyA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BzJyk7XG52YXIgcElFID0gcmVxdWlyZSgnLi9fb2JqZWN0LXBpZScpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgdmFyIHJlc3VsdCA9IGdldEtleXMoaXQpO1xuICB2YXIgZ2V0U3ltYm9scyA9IGdPUFMuZjtcbiAgaWYgKGdldFN5bWJvbHMpIHtcbiAgICB2YXIgc3ltYm9scyA9IGdldFN5bWJvbHMoaXQpO1xuICAgIHZhciBpc0VudW0gPSBwSUUuZjtcbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIGtleTtcbiAgICB3aGlsZSAoc3ltYm9scy5sZW5ndGggPiBpKSBpZiAoaXNFbnVtLmNhbGwoaXQsIGtleSA9IHN5bWJvbHNbaSsrXSkpIHJlc3VsdC5wdXNoKGtleSk7XG4gIH0gcmV0dXJuIHJlc3VsdDtcbn07XG4iLCJ2YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJyk7XG52YXIgY29yZSA9IHJlcXVpcmUoJy4vX2NvcmUnKTtcbnZhciBjdHggPSByZXF1aXJlKCcuL19jdHgnKTtcbnZhciBoaWRlID0gcmVxdWlyZSgnLi9faGlkZScpO1xudmFyIGhhcyA9IHJlcXVpcmUoJy4vX2hhcycpO1xudmFyIFBST1RPVFlQRSA9ICdwcm90b3R5cGUnO1xuXG52YXIgJGV4cG9ydCA9IGZ1bmN0aW9uICh0eXBlLCBuYW1lLCBzb3VyY2UpIHtcbiAgdmFyIElTX0ZPUkNFRCA9IHR5cGUgJiAkZXhwb3J0LkY7XG4gIHZhciBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HO1xuICB2YXIgSVNfU1RBVElDID0gdHlwZSAmICRleHBvcnQuUztcbiAgdmFyIElTX1BST1RPID0gdHlwZSAmICRleHBvcnQuUDtcbiAgdmFyIElTX0JJTkQgPSB0eXBlICYgJGV4cG9ydC5CO1xuICB2YXIgSVNfV1JBUCA9IHR5cGUgJiAkZXhwb3J0Llc7XG4gIHZhciBleHBvcnRzID0gSVNfR0xPQkFMID8gY29yZSA6IGNvcmVbbmFtZV0gfHwgKGNvcmVbbmFtZV0gPSB7fSk7XG4gIHZhciBleHBQcm90byA9IGV4cG9ydHNbUFJPVE9UWVBFXTtcbiAgdmFyIHRhcmdldCA9IElTX0dMT0JBTCA/IGdsb2JhbCA6IElTX1NUQVRJQyA/IGdsb2JhbFtuYW1lXSA6IChnbG9iYWxbbmFtZV0gfHwge30pW1BST1RPVFlQRV07XG4gIHZhciBrZXksIG93biwgb3V0O1xuICBpZiAoSVNfR0xPQkFMKSBzb3VyY2UgPSBuYW1lO1xuICBmb3IgKGtleSBpbiBzb3VyY2UpIHtcbiAgICAvLyBjb250YWlucyBpbiBuYXRpdmVcbiAgICBvd24gPSAhSVNfRk9SQ0VEICYmIHRhcmdldCAmJiB0YXJnZXRba2V5XSAhPT0gdW5kZWZpbmVkO1xuICAgIGlmIChvd24gJiYgaGFzKGV4cG9ydHMsIGtleSkpIGNvbnRpbnVlO1xuICAgIC8vIGV4cG9ydCBuYXRpdmUgb3IgcGFzc2VkXG4gICAgb3V0ID0gb3duID8gdGFyZ2V0W2tleV0gOiBzb3VyY2Vba2V5XTtcbiAgICAvLyBwcmV2ZW50IGdsb2JhbCBwb2xsdXRpb24gZm9yIG5hbWVzcGFjZXNcbiAgICBleHBvcnRzW2tleV0gPSBJU19HTE9CQUwgJiYgdHlwZW9mIHRhcmdldFtrZXldICE9ICdmdW5jdGlvbicgPyBzb3VyY2Vba2V5XVxuICAgIC8vIGJpbmQgdGltZXJzIHRvIGdsb2JhbCBmb3IgY2FsbCBmcm9tIGV4cG9ydCBjb250ZXh0XG4gICAgOiBJU19CSU5EICYmIG93biA/IGN0eChvdXQsIGdsb2JhbClcbiAgICAvLyB3cmFwIGdsb2JhbCBjb25zdHJ1Y3RvcnMgZm9yIHByZXZlbnQgY2hhbmdlIHRoZW0gaW4gbGlicmFyeVxuICAgIDogSVNfV1JBUCAmJiB0YXJnZXRba2V5XSA9PSBvdXQgPyAoZnVuY3Rpb24gKEMpIHtcbiAgICAgIHZhciBGID0gZnVuY3Rpb24gKGEsIGIsIGMpIHtcbiAgICAgICAgaWYgKHRoaXMgaW5zdGFuY2VvZiBDKSB7XG4gICAgICAgICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjYXNlIDA6IHJldHVybiBuZXcgQygpO1xuICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gbmV3IEMoYSk7XG4gICAgICAgICAgICBjYXNlIDI6IHJldHVybiBuZXcgQyhhLCBiKTtcbiAgICAgICAgICB9IHJldHVybiBuZXcgQyhhLCBiLCBjKTtcbiAgICAgICAgfSByZXR1cm4gQy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICAgIEZbUFJPVE9UWVBFXSA9IENbUFJPVE9UWVBFXTtcbiAgICAgIHJldHVybiBGO1xuICAgIC8vIG1ha2Ugc3RhdGljIHZlcnNpb25zIGZvciBwcm90b3R5cGUgbWV0aG9kc1xuICAgIH0pKG91dCkgOiBJU19QUk9UTyAmJiB0eXBlb2Ygb3V0ID09ICdmdW5jdGlvbicgPyBjdHgoRnVuY3Rpb24uY2FsbCwgb3V0KSA6IG91dDtcbiAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUubWV0aG9kcy4lTkFNRSVcbiAgICBpZiAoSVNfUFJPVE8pIHtcbiAgICAgIChleHBvcnRzLnZpcnR1YWwgfHwgKGV4cG9ydHMudmlydHVhbCA9IHt9KSlba2V5XSA9IG91dDtcbiAgICAgIC8vIGV4cG9ydCBwcm90byBtZXRob2RzIHRvIGNvcmUuJUNPTlNUUlVDVE9SJS5wcm90b3R5cGUuJU5BTUUlXG4gICAgICBpZiAodHlwZSAmICRleHBvcnQuUiAmJiBleHBQcm90byAmJiAhZXhwUHJvdG9ba2V5XSkgaGlkZShleHBQcm90bywga2V5LCBvdXQpO1xuICAgIH1cbiAgfVxufTtcbi8vIHR5cGUgYml0bWFwXG4kZXhwb3J0LkYgPSAxOyAgIC8vIGZvcmNlZFxuJGV4cG9ydC5HID0gMjsgICAvLyBnbG9iYWxcbiRleHBvcnQuUyA9IDQ7ICAgLy8gc3RhdGljXG4kZXhwb3J0LlAgPSA4OyAgIC8vIHByb3RvXG4kZXhwb3J0LkIgPSAxNjsgIC8vIGJpbmRcbiRleHBvcnQuVyA9IDMyOyAgLy8gd3JhcFxuJGV4cG9ydC5VID0gNjQ7ICAvLyBzYWZlXG4kZXhwb3J0LlIgPSAxMjg7IC8vIHJlYWwgcHJvdG8gbWV0aG9kIGZvciBgbGlicmFyeWBcbm1vZHVsZS5leHBvcnRzID0gJGV4cG9ydDtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGV4ZWMpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gISFleGVjKCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufTtcbiIsInZhciBjdHggPSByZXF1aXJlKCcuL19jdHgnKTtcbnZhciBjYWxsID0gcmVxdWlyZSgnLi9faXRlci1jYWxsJyk7XG52YXIgaXNBcnJheUl0ZXIgPSByZXF1aXJlKCcuL19pcy1hcnJheS1pdGVyJyk7XG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciB0b0xlbmd0aCA9IHJlcXVpcmUoJy4vX3RvLWxlbmd0aCcpO1xudmFyIGdldEl0ZXJGbiA9IHJlcXVpcmUoJy4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kJyk7XG52YXIgQlJFQUsgPSB7fTtcbnZhciBSRVRVUk4gPSB7fTtcbnZhciBleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXRlcmFibGUsIGVudHJpZXMsIGZuLCB0aGF0LCBJVEVSQVRPUikge1xuICB2YXIgaXRlckZuID0gSVRFUkFUT1IgPyBmdW5jdGlvbiAoKSB7IHJldHVybiBpdGVyYWJsZTsgfSA6IGdldEl0ZXJGbihpdGVyYWJsZSk7XG4gIHZhciBmID0gY3R4KGZuLCB0aGF0LCBlbnRyaWVzID8gMiA6IDEpO1xuICB2YXIgaW5kZXggPSAwO1xuICB2YXIgbGVuZ3RoLCBzdGVwLCBpdGVyYXRvciwgcmVzdWx0O1xuICBpZiAodHlwZW9mIGl0ZXJGbiAhPSAnZnVuY3Rpb24nKSB0aHJvdyBUeXBlRXJyb3IoaXRlcmFibGUgKyAnIGlzIG5vdCBpdGVyYWJsZSEnKTtcbiAgLy8gZmFzdCBjYXNlIGZvciBhcnJheXMgd2l0aCBkZWZhdWx0IGl0ZXJhdG9yXG4gIGlmIChpc0FycmF5SXRlcihpdGVyRm4pKSBmb3IgKGxlbmd0aCA9IHRvTGVuZ3RoKGl0ZXJhYmxlLmxlbmd0aCk7IGxlbmd0aCA+IGluZGV4OyBpbmRleCsrKSB7XG4gICAgcmVzdWx0ID0gZW50cmllcyA/IGYoYW5PYmplY3Qoc3RlcCA9IGl0ZXJhYmxlW2luZGV4XSlbMF0sIHN0ZXBbMV0pIDogZihpdGVyYWJsZVtpbmRleF0pO1xuICAgIGlmIChyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKSByZXR1cm4gcmVzdWx0O1xuICB9IGVsc2UgZm9yIChpdGVyYXRvciA9IGl0ZXJGbi5jYWxsKGl0ZXJhYmxlKTsgIShzdGVwID0gaXRlcmF0b3IubmV4dCgpKS5kb25lOykge1xuICAgIHJlc3VsdCA9IGNhbGwoaXRlcmF0b3IsIGYsIHN0ZXAudmFsdWUsIGVudHJpZXMpO1xuICAgIGlmIChyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKSByZXR1cm4gcmVzdWx0O1xuICB9XG59O1xuZXhwb3J0cy5CUkVBSyA9IEJSRUFLO1xuZXhwb3J0cy5SRVRVUk4gPSBSRVRVUk47XG4iLCIvLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOFxudmFyIGdsb2JhbCA9IG1vZHVsZS5leHBvcnRzID0gdHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuTWF0aCA9PSBNYXRoXG4gID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1uZXctZnVuY1xuICA6IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5pZiAodHlwZW9mIF9fZyA9PSAnbnVtYmVyJykgX19nID0gZ2xvYmFsOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmXG4iLCJ2YXIgaGFzT3duUHJvcGVydHkgPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0LCBrZXkpIHtcbiAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoaXQsIGtleSk7XG59O1xuIiwidmFyIGRQID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJyk7XG52YXIgY3JlYXRlRGVzYyA9IHJlcXVpcmUoJy4vX3Byb3BlcnR5LWRlc2MnKTtcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSA/IGZ1bmN0aW9uIChvYmplY3QsIGtleSwgdmFsdWUpIHtcbiAgcmV0dXJuIGRQLmYob2JqZWN0LCBrZXksIGNyZWF0ZURlc2MoMSwgdmFsdWUpKTtcbn0gOiBmdW5jdGlvbiAob2JqZWN0LCBrZXksIHZhbHVlKSB7XG4gIG9iamVjdFtrZXldID0gdmFsdWU7XG4gIHJldHVybiBvYmplY3Q7XG59O1xuIiwidmFyIGRvY3VtZW50ID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykuZG9jdW1lbnQ7XG5tb2R1bGUuZXhwb3J0cyA9IGRvY3VtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcbiIsIm1vZHVsZS5leHBvcnRzID0gIXJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykgJiYgIXJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlcXVpcmUoJy4vX2RvbS1jcmVhdGUnKSgnZGl2JyksICdhJywgeyBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDc7IH0gfSkuYSAhPSA3O1xufSk7XG4iLCIvLyBmYXN0IGFwcGx5LCBodHRwOi8vanNwZXJmLmxua2l0LmNvbS9mYXN0LWFwcGx5LzVcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGZuLCBhcmdzLCB0aGF0KSB7XG4gIHZhciB1biA9IHRoYXQgPT09IHVuZGVmaW5lZDtcbiAgc3dpdGNoIChhcmdzLmxlbmd0aCkge1xuICAgIGNhc2UgMDogcmV0dXJuIHVuID8gZm4oKVxuICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0KTtcbiAgICBjYXNlIDE6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0pXG4gICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0pO1xuICAgIGNhc2UgMjogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSlcbiAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCwgYXJnc1swXSwgYXJnc1sxXSk7XG4gICAgY2FzZSAzOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKVxuICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTtcbiAgICBjYXNlIDQ6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pXG4gICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pO1xuICB9IHJldHVybiBmbi5hcHBseSh0aGF0LCBhcmdzKTtcbn07XG4iLCIvLyBmYWxsYmFjayBmb3Igbm9uLWFycmF5LWxpa2UgRVMzIGFuZCBub24tZW51bWVyYWJsZSBvbGQgVjggc3RyaW5nc1xudmFyIGNvZiA9IHJlcXVpcmUoJy4vX2NvZicpO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXByb3RvdHlwZS1idWlsdGluc1xubW9kdWxlLmV4cG9ydHMgPSBPYmplY3QoJ3onKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKSA/IE9iamVjdCA6IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gY29mKGl0KSA9PSAnU3RyaW5nJyA/IGl0LnNwbGl0KCcnKSA6IE9iamVjdChpdCk7XG59O1xuIiwiLy8gY2hlY2sgb24gZGVmYXVsdCBBcnJheSBpdGVyYXRvclxudmFyIEl0ZXJhdG9ycyA9IHJlcXVpcmUoJy4vX2l0ZXJhdG9ycycpO1xudmFyIElURVJBVE9SID0gcmVxdWlyZSgnLi9fd2tzJykoJ2l0ZXJhdG9yJyk7XG52YXIgQXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGl0ICE9PSB1bmRlZmluZWQgJiYgKEl0ZXJhdG9ycy5BcnJheSA9PT0gaXQgfHwgQXJyYXlQcm90b1tJVEVSQVRPUl0gPT09IGl0KTtcbn07XG4iLCIvLyA3LjIuMiBJc0FycmF5KGFyZ3VtZW50KVxudmFyIGNvZiA9IHJlcXVpcmUoJy4vX2NvZicpO1xubW9kdWxlLmV4cG9ydHMgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIGlzQXJyYXkoYXJnKSB7XG4gIHJldHVybiBjb2YoYXJnKSA9PSAnQXJyYXknO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiB0eXBlb2YgaXQgPT09ICdvYmplY3QnID8gaXQgIT09IG51bGwgOiB0eXBlb2YgaXQgPT09ICdmdW5jdGlvbic7XG59O1xuIiwiLy8gY2FsbCBzb21ldGhpbmcgb24gaXRlcmF0b3Igc3RlcCB3aXRoIHNhZmUgY2xvc2luZyBvbiBlcnJvclxudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdGVyYXRvciwgZm4sIHZhbHVlLCBlbnRyaWVzKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGVudHJpZXMgPyBmbihhbk9iamVjdCh2YWx1ZSlbMF0sIHZhbHVlWzFdKSA6IGZuKHZhbHVlKTtcbiAgLy8gNy40LjYgSXRlcmF0b3JDbG9zZShpdGVyYXRvciwgY29tcGxldGlvbilcbiAgfSBjYXRjaCAoZSkge1xuICAgIHZhciByZXQgPSBpdGVyYXRvclsncmV0dXJuJ107XG4gICAgaWYgKHJldCAhPT0gdW5kZWZpbmVkKSBhbk9iamVjdChyZXQuY2FsbChpdGVyYXRvcikpO1xuICAgIHRocm93IGU7XG4gIH1cbn07XG4iLCIndXNlIHN0cmljdCc7XG52YXIgY3JlYXRlID0gcmVxdWlyZSgnLi9fb2JqZWN0LWNyZWF0ZScpO1xudmFyIGRlc2NyaXB0b3IgPSByZXF1aXJlKCcuL19wcm9wZXJ0eS1kZXNjJyk7XG52YXIgc2V0VG9TdHJpbmdUYWcgPSByZXF1aXJlKCcuL19zZXQtdG8tc3RyaW5nLXRhZycpO1xudmFyIEl0ZXJhdG9yUHJvdG90eXBlID0ge307XG5cbi8vIDI1LjEuMi4xLjEgJUl0ZXJhdG9yUHJvdG90eXBlJVtAQGl0ZXJhdG9yXSgpXG5yZXF1aXJlKCcuL19oaWRlJykoSXRlcmF0b3JQcm90b3R5cGUsIHJlcXVpcmUoJy4vX3drcycpKCdpdGVyYXRvcicpLCBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9KTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpIHtcbiAgQ29uc3RydWN0b3IucHJvdG90eXBlID0gY3JlYXRlKEl0ZXJhdG9yUHJvdG90eXBlLCB7IG5leHQ6IGRlc2NyaXB0b3IoMSwgbmV4dCkgfSk7XG4gIHNldFRvU3RyaW5nVGFnKENvbnN0cnVjdG9yLCBOQU1FICsgJyBJdGVyYXRvcicpO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBMSUJSQVJZID0gcmVxdWlyZSgnLi9fbGlicmFyeScpO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciByZWRlZmluZSA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lJyk7XG52YXIgaGlkZSA9IHJlcXVpcmUoJy4vX2hpZGUnKTtcbnZhciBJdGVyYXRvcnMgPSByZXF1aXJlKCcuL19pdGVyYXRvcnMnKTtcbnZhciAkaXRlckNyZWF0ZSA9IHJlcXVpcmUoJy4vX2l0ZXItY3JlYXRlJyk7XG52YXIgc2V0VG9TdHJpbmdUYWcgPSByZXF1aXJlKCcuL19zZXQtdG8tc3RyaW5nLXRhZycpO1xudmFyIGdldFByb3RvdHlwZU9mID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdwbycpO1xudmFyIElURVJBVE9SID0gcmVxdWlyZSgnLi9fd2tzJykoJ2l0ZXJhdG9yJyk7XG52YXIgQlVHR1kgPSAhKFtdLmtleXMgJiYgJ25leHQnIGluIFtdLmtleXMoKSk7IC8vIFNhZmFyaSBoYXMgYnVnZ3kgaXRlcmF0b3JzIHcvbyBgbmV4dGBcbnZhciBGRl9JVEVSQVRPUiA9ICdAQGl0ZXJhdG9yJztcbnZhciBLRVlTID0gJ2tleXMnO1xudmFyIFZBTFVFUyA9ICd2YWx1ZXMnO1xuXG52YXIgcmV0dXJuVGhpcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH07XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKEJhc2UsIE5BTUUsIENvbnN0cnVjdG9yLCBuZXh0LCBERUZBVUxULCBJU19TRVQsIEZPUkNFRCkge1xuICAkaXRlckNyZWF0ZShDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCk7XG4gIHZhciBnZXRNZXRob2QgPSBmdW5jdGlvbiAoa2luZCkge1xuICAgIGlmICghQlVHR1kgJiYga2luZCBpbiBwcm90bykgcmV0dXJuIHByb3RvW2tpbmRdO1xuICAgIHN3aXRjaCAoa2luZCkge1xuICAgICAgY2FzZSBLRVlTOiByZXR1cm4gZnVuY3Rpb24ga2V5cygpIHsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTtcbiAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCkgeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9O1xuICAgIH0gcmV0dXJuIGZ1bmN0aW9uIGVudHJpZXMoKSB7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07XG4gIH07XG4gIHZhciBUQUcgPSBOQU1FICsgJyBJdGVyYXRvcic7XG4gIHZhciBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVM7XG4gIHZhciBWQUxVRVNfQlVHID0gZmFsc2U7XG4gIHZhciBwcm90byA9IEJhc2UucHJvdG90eXBlO1xuICB2YXIgJG5hdGl2ZSA9IHByb3RvW0lURVJBVE9SXSB8fCBwcm90b1tGRl9JVEVSQVRPUl0gfHwgREVGQVVMVCAmJiBwcm90b1tERUZBVUxUXTtcbiAgdmFyICRkZWZhdWx0ID0gJG5hdGl2ZSB8fCBnZXRNZXRob2QoREVGQVVMVCk7XG4gIHZhciAkZW50cmllcyA9IERFRkFVTFQgPyAhREVGX1ZBTFVFUyA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKCdlbnRyaWVzJykgOiB1bmRlZmluZWQ7XG4gIHZhciAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZTtcbiAgdmFyIG1ldGhvZHMsIGtleSwgSXRlcmF0b3JQcm90b3R5cGU7XG4gIC8vIEZpeCBuYXRpdmVcbiAgaWYgKCRhbnlOYXRpdmUpIHtcbiAgICBJdGVyYXRvclByb3RvdHlwZSA9IGdldFByb3RvdHlwZU9mKCRhbnlOYXRpdmUuY2FsbChuZXcgQmFzZSgpKSk7XG4gICAgaWYgKEl0ZXJhdG9yUHJvdG90eXBlICE9PSBPYmplY3QucHJvdG90eXBlICYmIEl0ZXJhdG9yUHJvdG90eXBlLm5leHQpIHtcbiAgICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnNcbiAgICAgIHNldFRvU3RyaW5nVGFnKEl0ZXJhdG9yUHJvdG90eXBlLCBUQUcsIHRydWUpO1xuICAgICAgLy8gZml4IGZvciBzb21lIG9sZCBlbmdpbmVzXG4gICAgICBpZiAoIUxJQlJBUlkgJiYgdHlwZW9mIEl0ZXJhdG9yUHJvdG90eXBlW0lURVJBVE9SXSAhPSAnZnVuY3Rpb24nKSBoaWRlKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUiwgcmV0dXJuVGhpcyk7XG4gICAgfVxuICB9XG4gIC8vIGZpeCBBcnJheSN7dmFsdWVzLCBAQGl0ZXJhdG9yfS5uYW1lIGluIFY4IC8gRkZcbiAgaWYgKERFRl9WQUxVRVMgJiYgJG5hdGl2ZSAmJiAkbmF0aXZlLm5hbWUgIT09IFZBTFVFUykge1xuICAgIFZBTFVFU19CVUcgPSB0cnVlO1xuICAgICRkZWZhdWx0ID0gZnVuY3Rpb24gdmFsdWVzKCkgeyByZXR1cm4gJG5hdGl2ZS5jYWxsKHRoaXMpOyB9O1xuICB9XG4gIC8vIERlZmluZSBpdGVyYXRvclxuICBpZiAoKCFMSUJSQVJZIHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpIHtcbiAgICBoaWRlKHByb3RvLCBJVEVSQVRPUiwgJGRlZmF1bHQpO1xuICB9XG4gIC8vIFBsdWcgZm9yIGxpYnJhcnlcbiAgSXRlcmF0b3JzW05BTUVdID0gJGRlZmF1bHQ7XG4gIEl0ZXJhdG9yc1tUQUddID0gcmV0dXJuVGhpcztcbiAgaWYgKERFRkFVTFQpIHtcbiAgICBtZXRob2RzID0ge1xuICAgICAgdmFsdWVzOiBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSxcbiAgICAgIGtleXM6IElTX1NFVCA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKEtFWVMpLFxuICAgICAgZW50cmllczogJGVudHJpZXNcbiAgICB9O1xuICAgIGlmIChGT1JDRUQpIGZvciAoa2V5IGluIG1ldGhvZHMpIHtcbiAgICAgIGlmICghKGtleSBpbiBwcm90bykpIHJlZGVmaW5lKHByb3RvLCBrZXksIG1ldGhvZHNba2V5XSk7XG4gICAgfSBlbHNlICRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogKEJVR0dZIHx8IFZBTFVFU19CVUcpLCBOQU1FLCBtZXRob2RzKTtcbiAgfVxuICByZXR1cm4gbWV0aG9kcztcbn07XG4iLCJ2YXIgSVRFUkFUT1IgPSByZXF1aXJlKCcuL193a3MnKSgnaXRlcmF0b3InKTtcbnZhciBTQUZFX0NMT1NJTkcgPSBmYWxzZTtcblxudHJ5IHtcbiAgdmFyIHJpdGVyID0gWzddW0lURVJBVE9SXSgpO1xuICByaXRlclsncmV0dXJuJ10gPSBmdW5jdGlvbiAoKSB7IFNBRkVfQ0xPU0lORyA9IHRydWU7IH07XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby10aHJvdy1saXRlcmFsXG4gIEFycmF5LmZyb20ocml0ZXIsIGZ1bmN0aW9uICgpIHsgdGhyb3cgMjsgfSk7XG59IGNhdGNoIChlKSB7IC8qIGVtcHR5ICovIH1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZXhlYywgc2tpcENsb3NpbmcpIHtcbiAgaWYgKCFza2lwQ2xvc2luZyAmJiAhU0FGRV9DTE9TSU5HKSByZXR1cm4gZmFsc2U7XG4gIHZhciBzYWZlID0gZmFsc2U7XG4gIHRyeSB7XG4gICAgdmFyIGFyciA9IFs3XTtcbiAgICB2YXIgaXRlciA9IGFycltJVEVSQVRPUl0oKTtcbiAgICBpdGVyLm5leHQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB7IGRvbmU6IHNhZmUgPSB0cnVlIH07IH07XG4gICAgYXJyW0lURVJBVE9SXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGl0ZXI7IH07XG4gICAgZXhlYyhhcnIpO1xuICB9IGNhdGNoIChlKSB7IC8qIGVtcHR5ICovIH1cbiAgcmV0dXJuIHNhZmU7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZG9uZSwgdmFsdWUpIHtcbiAgcmV0dXJuIHsgdmFsdWU6IHZhbHVlLCBkb25lOiAhIWRvbmUgfTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IHt9O1xuIiwibW9kdWxlLmV4cG9ydHMgPSB0cnVlO1xuIiwidmFyIE1FVEEgPSByZXF1aXJlKCcuL191aWQnKSgnbWV0YScpO1xudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG52YXIgaGFzID0gcmVxdWlyZSgnLi9faGFzJyk7XG52YXIgc2V0RGVzYyA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmY7XG52YXIgaWQgPSAwO1xudmFyIGlzRXh0ZW5zaWJsZSA9IE9iamVjdC5pc0V4dGVuc2libGUgfHwgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdHJ1ZTtcbn07XG52YXIgRlJFRVpFID0gIXJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gaXNFeHRlbnNpYmxlKE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh7fSkpO1xufSk7XG52YXIgc2V0TWV0YSA9IGZ1bmN0aW9uIChpdCkge1xuICBzZXREZXNjKGl0LCBNRVRBLCB7IHZhbHVlOiB7XG4gICAgaTogJ08nICsgKytpZCwgLy8gb2JqZWN0IElEXG4gICAgdzoge30gICAgICAgICAgLy8gd2VhayBjb2xsZWN0aW9ucyBJRHNcbiAgfSB9KTtcbn07XG52YXIgZmFzdEtleSA9IGZ1bmN0aW9uIChpdCwgY3JlYXRlKSB7XG4gIC8vIHJldHVybiBwcmltaXRpdmUgd2l0aCBwcmVmaXhcbiAgaWYgKCFpc09iamVjdChpdCkpIHJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCcgPyBpdCA6ICh0eXBlb2YgaXQgPT0gJ3N0cmluZycgPyAnUycgOiAnUCcpICsgaXQ7XG4gIGlmICghaGFzKGl0LCBNRVRBKSkge1xuICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0XG4gICAgaWYgKCFpc0V4dGVuc2libGUoaXQpKSByZXR1cm4gJ0YnO1xuICAgIC8vIG5vdCBuZWNlc3NhcnkgdG8gYWRkIG1ldGFkYXRhXG4gICAgaWYgKCFjcmVhdGUpIHJldHVybiAnRSc7XG4gICAgLy8gYWRkIG1pc3NpbmcgbWV0YWRhdGFcbiAgICBzZXRNZXRhKGl0KTtcbiAgLy8gcmV0dXJuIG9iamVjdCBJRFxuICB9IHJldHVybiBpdFtNRVRBXS5pO1xufTtcbnZhciBnZXRXZWFrID0gZnVuY3Rpb24gKGl0LCBjcmVhdGUpIHtcbiAgaWYgKCFoYXMoaXQsIE1FVEEpKSB7XG4gICAgLy8gY2FuJ3Qgc2V0IG1ldGFkYXRhIHRvIHVuY2F1Z2h0IGZyb3plbiBvYmplY3RcbiAgICBpZiAoIWlzRXh0ZW5zaWJsZShpdCkpIHJldHVybiB0cnVlO1xuICAgIC8vIG5vdCBuZWNlc3NhcnkgdG8gYWRkIG1ldGFkYXRhXG4gICAgaWYgKCFjcmVhdGUpIHJldHVybiBmYWxzZTtcbiAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YVxuICAgIHNldE1ldGEoaXQpO1xuICAvLyByZXR1cm4gaGFzaCB3ZWFrIGNvbGxlY3Rpb25zIElEc1xuICB9IHJldHVybiBpdFtNRVRBXS53O1xufTtcbi8vIGFkZCBtZXRhZGF0YSBvbiBmcmVlemUtZmFtaWx5IG1ldGhvZHMgY2FsbGluZ1xudmFyIG9uRnJlZXplID0gZnVuY3Rpb24gKGl0KSB7XG4gIGlmIChGUkVFWkUgJiYgbWV0YS5ORUVEICYmIGlzRXh0ZW5zaWJsZShpdCkgJiYgIWhhcyhpdCwgTUVUQSkpIHNldE1ldGEoaXQpO1xuICByZXR1cm4gaXQ7XG59O1xudmFyIG1ldGEgPSBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgS0VZOiBNRVRBLFxuICBORUVEOiBmYWxzZSxcbiAgZmFzdEtleTogZmFzdEtleSxcbiAgZ2V0V2VhazogZ2V0V2VhayxcbiAgb25GcmVlemU6IG9uRnJlZXplXG59O1xuIiwidmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIG1hY3JvdGFzayA9IHJlcXVpcmUoJy4vX3Rhc2snKS5zZXQ7XG52YXIgT2JzZXJ2ZXIgPSBnbG9iYWwuTXV0YXRpb25PYnNlcnZlciB8fCBnbG9iYWwuV2ViS2l0TXV0YXRpb25PYnNlcnZlcjtcbnZhciBwcm9jZXNzID0gZ2xvYmFsLnByb2Nlc3M7XG52YXIgUHJvbWlzZSA9IGdsb2JhbC5Qcm9taXNlO1xudmFyIGlzTm9kZSA9IHJlcXVpcmUoJy4vX2NvZicpKHByb2Nlc3MpID09ICdwcm9jZXNzJztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBoZWFkLCBsYXN0LCBub3RpZnk7XG5cbiAgdmFyIGZsdXNoID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBwYXJlbnQsIGZuO1xuICAgIGlmIChpc05vZGUgJiYgKHBhcmVudCA9IHByb2Nlc3MuZG9tYWluKSkgcGFyZW50LmV4aXQoKTtcbiAgICB3aGlsZSAoaGVhZCkge1xuICAgICAgZm4gPSBoZWFkLmZuO1xuICAgICAgaGVhZCA9IGhlYWQubmV4dDtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZuKCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGlmIChoZWFkKSBub3RpZnkoKTtcbiAgICAgICAgZWxzZSBsYXN0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aHJvdyBlO1xuICAgICAgfVxuICAgIH0gbGFzdCA9IHVuZGVmaW5lZDtcbiAgICBpZiAocGFyZW50KSBwYXJlbnQuZW50ZXIoKTtcbiAgfTtcblxuICAvLyBOb2RlLmpzXG4gIGlmIChpc05vZGUpIHtcbiAgICBub3RpZnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBwcm9jZXNzLm5leHRUaWNrKGZsdXNoKTtcbiAgICB9O1xuICAvLyBicm93c2VycyB3aXRoIE11dGF0aW9uT2JzZXJ2ZXIsIGV4Y2VwdCBpT1MgU2FmYXJpIC0gaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvaXNzdWVzLzMzOVxuICB9IGVsc2UgaWYgKE9ic2VydmVyICYmICEoZ2xvYmFsLm5hdmlnYXRvciAmJiBnbG9iYWwubmF2aWdhdG9yLnN0YW5kYWxvbmUpKSB7XG4gICAgdmFyIHRvZ2dsZSA9IHRydWU7XG4gICAgdmFyIG5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJyk7XG4gICAgbmV3IE9ic2VydmVyKGZsdXNoKS5vYnNlcnZlKG5vZGUsIHsgY2hhcmFjdGVyRGF0YTogdHJ1ZSB9KTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXdcbiAgICBub3RpZnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBub2RlLmRhdGEgPSB0b2dnbGUgPSAhdG9nZ2xlO1xuICAgIH07XG4gIC8vIGVudmlyb25tZW50cyB3aXRoIG1heWJlIG5vbi1jb21wbGV0ZWx5IGNvcnJlY3QsIGJ1dCBleGlzdGVudCBQcm9taXNlXG4gIH0gZWxzZSBpZiAoUHJvbWlzZSAmJiBQcm9taXNlLnJlc29sdmUpIHtcbiAgICAvLyBQcm9taXNlLnJlc29sdmUgd2l0aG91dCBhbiBhcmd1bWVudCB0aHJvd3MgYW4gZXJyb3IgaW4gTEcgV2ViT1MgMlxuICAgIHZhciBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKHVuZGVmaW5lZCk7XG4gICAgbm90aWZ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcHJvbWlzZS50aGVuKGZsdXNoKTtcbiAgICB9O1xuICAvLyBmb3Igb3RoZXIgZW52aXJvbm1lbnRzIC0gbWFjcm90YXNrIGJhc2VkIG9uOlxuICAvLyAtIHNldEltbWVkaWF0ZVxuICAvLyAtIE1lc3NhZ2VDaGFubmVsXG4gIC8vIC0gd2luZG93LnBvc3RNZXNzYWdcbiAgLy8gLSBvbnJlYWR5c3RhdGVjaGFuZ2VcbiAgLy8gLSBzZXRUaW1lb3V0XG4gIH0gZWxzZSB7XG4gICAgbm90aWZ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgLy8gc3RyYW5nZSBJRSArIHdlYnBhY2sgZGV2IHNlcnZlciBidWcgLSB1c2UgLmNhbGwoZ2xvYmFsKVxuICAgICAgbWFjcm90YXNrLmNhbGwoZ2xvYmFsLCBmbHVzaCk7XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAoZm4pIHtcbiAgICB2YXIgdGFzayA9IHsgZm46IGZuLCBuZXh0OiB1bmRlZmluZWQgfTtcbiAgICBpZiAobGFzdCkgbGFzdC5uZXh0ID0gdGFzaztcbiAgICBpZiAoIWhlYWQpIHtcbiAgICAgIGhlYWQgPSB0YXNrO1xuICAgICAgbm90aWZ5KCk7XG4gICAgfSBsYXN0ID0gdGFzaztcbiAgfTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG4vLyAyNS40LjEuNSBOZXdQcm9taXNlQ2FwYWJpbGl0eShDKVxudmFyIGFGdW5jdGlvbiA9IHJlcXVpcmUoJy4vX2EtZnVuY3Rpb24nKTtcblxuZnVuY3Rpb24gUHJvbWlzZUNhcGFiaWxpdHkoQykge1xuICB2YXIgcmVzb2x2ZSwgcmVqZWN0O1xuICB0aGlzLnByb21pc2UgPSBuZXcgQyhmdW5jdGlvbiAoJCRyZXNvbHZlLCAkJHJlamVjdCkge1xuICAgIGlmIChyZXNvbHZlICE9PSB1bmRlZmluZWQgfHwgcmVqZWN0ICE9PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcignQmFkIFByb21pc2UgY29uc3RydWN0b3InKTtcbiAgICByZXNvbHZlID0gJCRyZXNvbHZlO1xuICAgIHJlamVjdCA9ICQkcmVqZWN0O1xuICB9KTtcbiAgdGhpcy5yZXNvbHZlID0gYUZ1bmN0aW9uKHJlc29sdmUpO1xuICB0aGlzLnJlamVjdCA9IGFGdW5jdGlvbihyZWplY3QpO1xufVxuXG5tb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gKEMpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlQ2FwYWJpbGl0eShDKTtcbn07XG4iLCIvLyAxOS4xLjIuMiAvIDE1LjIuMy41IE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSlcbnZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpO1xudmFyIGRQcyA9IHJlcXVpcmUoJy4vX29iamVjdC1kcHMnKTtcbnZhciBlbnVtQnVnS2V5cyA9IHJlcXVpcmUoJy4vX2VudW0tYnVnLWtleXMnKTtcbnZhciBJRV9QUk9UTyA9IHJlcXVpcmUoJy4vX3NoYXJlZC1rZXknKSgnSUVfUFJPVE8nKTtcbnZhciBFbXB0eSA9IGZ1bmN0aW9uICgpIHsgLyogZW1wdHkgKi8gfTtcbnZhciBQUk9UT1RZUEUgPSAncHJvdG90eXBlJztcblxuLy8gQ3JlYXRlIG9iamVjdCB3aXRoIGZha2UgYG51bGxgIHByb3RvdHlwZTogdXNlIGlmcmFtZSBPYmplY3Qgd2l0aCBjbGVhcmVkIHByb3RvdHlwZVxudmFyIGNyZWF0ZURpY3QgPSBmdW5jdGlvbiAoKSB7XG4gIC8vIFRocmFzaCwgd2FzdGUgYW5kIHNvZG9teTogSUUgR0MgYnVnXG4gIHZhciBpZnJhbWUgPSByZXF1aXJlKCcuL19kb20tY3JlYXRlJykoJ2lmcmFtZScpO1xuICB2YXIgaSA9IGVudW1CdWdLZXlzLmxlbmd0aDtcbiAgdmFyIGx0ID0gJzwnO1xuICB2YXIgZ3QgPSAnPic7XG4gIHZhciBpZnJhbWVEb2N1bWVudDtcbiAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIHJlcXVpcmUoJy4vX2h0bWwnKS5hcHBlbmRDaGlsZChpZnJhbWUpO1xuICBpZnJhbWUuc3JjID0gJ2phdmFzY3JpcHQ6JzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zY3JpcHQtdXJsXG4gIC8vIGNyZWF0ZURpY3QgPSBpZnJhbWUuY29udGVudFdpbmRvdy5PYmplY3Q7XG4gIC8vIGh0bWwucmVtb3ZlQ2hpbGQoaWZyYW1lKTtcbiAgaWZyYW1lRG9jdW1lbnQgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDtcbiAgaWZyYW1lRG9jdW1lbnQub3BlbigpO1xuICBpZnJhbWVEb2N1bWVudC53cml0ZShsdCArICdzY3JpcHQnICsgZ3QgKyAnZG9jdW1lbnQuRj1PYmplY3QnICsgbHQgKyAnL3NjcmlwdCcgKyBndCk7XG4gIGlmcmFtZURvY3VtZW50LmNsb3NlKCk7XG4gIGNyZWF0ZURpY3QgPSBpZnJhbWVEb2N1bWVudC5GO1xuICB3aGlsZSAoaS0tKSBkZWxldGUgY3JlYXRlRGljdFtQUk9UT1RZUEVdW2VudW1CdWdLZXlzW2ldXTtcbiAgcmV0dXJuIGNyZWF0ZURpY3QoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmNyZWF0ZSB8fCBmdW5jdGlvbiBjcmVhdGUoTywgUHJvcGVydGllcykge1xuICB2YXIgcmVzdWx0O1xuICBpZiAoTyAhPT0gbnVsbCkge1xuICAgIEVtcHR5W1BST1RPVFlQRV0gPSBhbk9iamVjdChPKTtcbiAgICByZXN1bHQgPSBuZXcgRW1wdHkoKTtcbiAgICBFbXB0eVtQUk9UT1RZUEVdID0gbnVsbDtcbiAgICAvLyBhZGQgXCJfX3Byb3RvX19cIiBmb3IgT2JqZWN0LmdldFByb3RvdHlwZU9mIHBvbHlmaWxsXG4gICAgcmVzdWx0W0lFX1BST1RPXSA9IE87XG4gIH0gZWxzZSByZXN1bHQgPSBjcmVhdGVEaWN0KCk7XG4gIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBkUHMocmVzdWx0LCBQcm9wZXJ0aWVzKTtcbn07XG4iLCJ2YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciBJRThfRE9NX0RFRklORSA9IHJlcXVpcmUoJy4vX2llOC1kb20tZGVmaW5lJyk7XG52YXIgdG9QcmltaXRpdmUgPSByZXF1aXJlKCcuL190by1wcmltaXRpdmUnKTtcbnZhciBkUCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcblxuZXhwb3J0cy5mID0gcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpIHtcbiAgYW5PYmplY3QoTyk7XG4gIFAgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTtcbiAgYW5PYmplY3QoQXR0cmlidXRlcyk7XG4gIGlmIChJRThfRE9NX0RFRklORSkgdHJ5IHtcbiAgICByZXR1cm4gZFAoTywgUCwgQXR0cmlidXRlcyk7XG4gIH0gY2F0Y2ggKGUpIHsgLyogZW1wdHkgKi8gfVxuICBpZiAoJ2dldCcgaW4gQXR0cmlidXRlcyB8fCAnc2V0JyBpbiBBdHRyaWJ1dGVzKSB0aHJvdyBUeXBlRXJyb3IoJ0FjY2Vzc29ycyBub3Qgc3VwcG9ydGVkIScpO1xuICBpZiAoJ3ZhbHVlJyBpbiBBdHRyaWJ1dGVzKSBPW1BdID0gQXR0cmlidXRlcy52YWx1ZTtcbiAgcmV0dXJuIE87XG59O1xuIiwidmFyIGRQID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJyk7XG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciBnZXRLZXlzID0gcmVxdWlyZSgnLi9fb2JqZWN0LWtleXMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpIHtcbiAgYW5PYmplY3QoTyk7XG4gIHZhciBrZXlzID0gZ2V0S2V5cyhQcm9wZXJ0aWVzKTtcbiAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICB2YXIgaSA9IDA7XG4gIHZhciBQO1xuICB3aGlsZSAobGVuZ3RoID4gaSkgZFAuZihPLCBQID0ga2V5c1tpKytdLCBQcm9wZXJ0aWVzW1BdKTtcbiAgcmV0dXJuIE87XG59O1xuIiwidmFyIHBJRSA9IHJlcXVpcmUoJy4vX29iamVjdC1waWUnKTtcbnZhciBjcmVhdGVEZXNjID0gcmVxdWlyZSgnLi9fcHJvcGVydHktZGVzYycpO1xudmFyIHRvSU9iamVjdCA9IHJlcXVpcmUoJy4vX3RvLWlvYmplY3QnKTtcbnZhciB0b1ByaW1pdGl2ZSA9IHJlcXVpcmUoJy4vX3RvLXByaW1pdGl2ZScpO1xudmFyIGhhcyA9IHJlcXVpcmUoJy4vX2hhcycpO1xudmFyIElFOF9ET01fREVGSU5FID0gcmVxdWlyZSgnLi9faWU4LWRvbS1kZWZpbmUnKTtcbnZhciBnT1BEID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcblxuZXhwb3J0cy5mID0gcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSA/IGdPUEQgOiBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkge1xuICBPID0gdG9JT2JqZWN0KE8pO1xuICBQID0gdG9QcmltaXRpdmUoUCwgdHJ1ZSk7XG4gIGlmIChJRThfRE9NX0RFRklORSkgdHJ5IHtcbiAgICByZXR1cm4gZ09QRChPLCBQKTtcbiAgfSBjYXRjaCAoZSkgeyAvKiBlbXB0eSAqLyB9XG4gIGlmIChoYXMoTywgUCkpIHJldHVybiBjcmVhdGVEZXNjKCFwSUUuZi5jYWxsKE8sIFApLCBPW1BdKTtcbn07XG4iLCIvLyBmYWxsYmFjayBmb3IgSUUxMSBidWdneSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB3aXRoIGlmcmFtZSBhbmQgd2luZG93XG52YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpO1xudmFyIGdPUE4gPSByZXF1aXJlKCcuL19vYmplY3QtZ29wbicpLmY7XG52YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcblxudmFyIHdpbmRvd05hbWVzID0gdHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXNcbiAgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh3aW5kb3cpIDogW107XG5cbnZhciBnZXRXaW5kb3dOYW1lcyA9IGZ1bmN0aW9uIChpdCkge1xuICB0cnkge1xuICAgIHJldHVybiBnT1BOKGl0KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB3aW5kb3dOYW1lcy5zbGljZSgpO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCkge1xuICByZXR1cm4gd2luZG93TmFtZXMgJiYgdG9TdHJpbmcuY2FsbChpdCkgPT0gJ1tvYmplY3QgV2luZG93XScgPyBnZXRXaW5kb3dOYW1lcyhpdCkgOiBnT1BOKHRvSU9iamVjdChpdCkpO1xufTtcbiIsIi8vIDE5LjEuMi43IC8gMTUuMi4zLjQgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTylcbnZhciAka2V5cyA9IHJlcXVpcmUoJy4vX29iamVjdC1rZXlzLWludGVybmFsJyk7XG52YXIgaGlkZGVuS2V5cyA9IHJlcXVpcmUoJy4vX2VudW0tYnVnLWtleXMnKS5jb25jYXQoJ2xlbmd0aCcsICdwcm90b3R5cGUnKTtcblxuZXhwb3J0cy5mID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgfHwgZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhPKSB7XG4gIHJldHVybiAka2V5cyhPLCBoaWRkZW5LZXlzKTtcbn07XG4iLCJleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzO1xuIiwiLy8gMTkuMS4yLjkgLyAxNS4yLjMuMiBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTylcbnZhciBoYXMgPSByZXF1aXJlKCcuL19oYXMnKTtcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpO1xudmFyIElFX1BST1RPID0gcmVxdWlyZSgnLi9fc2hhcmVkLWtleScpKCdJRV9QUk9UTycpO1xudmFyIE9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTtcblxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gKE8pIHtcbiAgTyA9IHRvT2JqZWN0KE8pO1xuICBpZiAoaGFzKE8sIElFX1BST1RPKSkgcmV0dXJuIE9bSUVfUFJPVE9dO1xuICBpZiAodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcikge1xuICAgIHJldHVybiBPLmNvbnN0cnVjdG9yLnByb3RvdHlwZTtcbiAgfSByZXR1cm4gTyBpbnN0YW5jZW9mIE9iamVjdCA/IE9iamVjdFByb3RvIDogbnVsbDtcbn07XG4iLCJ2YXIgaGFzID0gcmVxdWlyZSgnLi9faGFzJyk7XG52YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpO1xudmFyIGFycmF5SW5kZXhPZiA9IHJlcXVpcmUoJy4vX2FycmF5LWluY2x1ZGVzJykoZmFsc2UpO1xudmFyIElFX1BST1RPID0gcmVxdWlyZSgnLi9fc2hhcmVkLWtleScpKCdJRV9QUk9UTycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChvYmplY3QsIG5hbWVzKSB7XG4gIHZhciBPID0gdG9JT2JqZWN0KG9iamVjdCk7XG4gIHZhciBpID0gMDtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICB2YXIga2V5O1xuICBmb3IgKGtleSBpbiBPKSBpZiAoa2V5ICE9IElFX1BST1RPKSBoYXMoTywga2V5KSAmJiByZXN1bHQucHVzaChrZXkpO1xuICAvLyBEb24ndCBlbnVtIGJ1ZyAmIGhpZGRlbiBrZXlzXG4gIHdoaWxlIChuYW1lcy5sZW5ndGggPiBpKSBpZiAoaGFzKE8sIGtleSA9IG5hbWVzW2krK10pKSB7XG4gICAgfmFycmF5SW5kZXhPZihyZXN1bHQsIGtleSkgfHwgcmVzdWx0LnB1c2goa2V5KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcbiIsIi8vIDE5LjEuMi4xNCAvIDE1LjIuMy4xNCBPYmplY3Qua2V5cyhPKVxudmFyICRrZXlzID0gcmVxdWlyZSgnLi9fb2JqZWN0LWtleXMtaW50ZXJuYWwnKTtcbnZhciBlbnVtQnVnS2V5cyA9IHJlcXVpcmUoJy4vX2VudW0tYnVnLWtleXMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKE8pIHtcbiAgcmV0dXJuICRrZXlzKE8sIGVudW1CdWdLZXlzKTtcbn07XG4iLCJleHBvcnRzLmYgPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcbiIsIi8vIG1vc3QgT2JqZWN0IG1ldGhvZHMgYnkgRVM2IHNob3VsZCBhY2NlcHQgcHJpbWl0aXZlc1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciBjb3JlID0gcmVxdWlyZSgnLi9fY29yZScpO1xudmFyIGZhaWxzID0gcmVxdWlyZSgnLi9fZmFpbHMnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKEtFWSwgZXhlYykge1xuICB2YXIgZm4gPSAoY29yZS5PYmplY3QgfHwge30pW0tFWV0gfHwgT2JqZWN0W0tFWV07XG4gIHZhciBleHAgPSB7fTtcbiAgZXhwW0tFWV0gPSBleGVjKGZuKTtcbiAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbiAoKSB7IGZuKDEpOyB9KSwgJ09iamVjdCcsIGV4cCk7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZXhlYykge1xuICB0cnkge1xuICAgIHJldHVybiB7IGU6IGZhbHNlLCB2OiBleGVjKCkgfTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB7IGU6IHRydWUsIHY6IGUgfTtcbiAgfVxufTtcbiIsInZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpO1xudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG52YXIgbmV3UHJvbWlzZUNhcGFiaWxpdHkgPSByZXF1aXJlKCcuL19uZXctcHJvbWlzZS1jYXBhYmlsaXR5Jyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKEMsIHgpIHtcbiAgYW5PYmplY3QoQyk7XG4gIGlmIChpc09iamVjdCh4KSAmJiB4LmNvbnN0cnVjdG9yID09PSBDKSByZXR1cm4geDtcbiAgdmFyIHByb21pc2VDYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkuZihDKTtcbiAgdmFyIHJlc29sdmUgPSBwcm9taXNlQ2FwYWJpbGl0eS5yZXNvbHZlO1xuICByZXNvbHZlKHgpO1xuICByZXR1cm4gcHJvbWlzZUNhcGFiaWxpdHkucHJvbWlzZTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChiaXRtYXAsIHZhbHVlKSB7XG4gIHJldHVybiB7XG4gICAgZW51bWVyYWJsZTogIShiaXRtYXAgJiAxKSxcbiAgICBjb25maWd1cmFibGU6ICEoYml0bWFwICYgMiksXG4gICAgd3JpdGFibGU6ICEoYml0bWFwICYgNCksXG4gICAgdmFsdWU6IHZhbHVlXG4gIH07XG59O1xuIiwidmFyIGhpZGUgPSByZXF1aXJlKCcuL19oaWRlJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh0YXJnZXQsIHNyYywgc2FmZSkge1xuICBmb3IgKHZhciBrZXkgaW4gc3JjKSB7XG4gICAgaWYgKHNhZmUgJiYgdGFyZ2V0W2tleV0pIHRhcmdldFtrZXldID0gc3JjW2tleV07XG4gICAgZWxzZSBoaWRlKHRhcmdldCwga2V5LCBzcmNba2V5XSk7XG4gIH0gcmV0dXJuIHRhcmdldDtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vX2hpZGUnKTtcbiIsIi8vIFdvcmtzIHdpdGggX19wcm90b19fIG9ubHkuIE9sZCB2OCBjYW4ndCB3b3JrIHdpdGggbnVsbCBwcm90byBvYmplY3RzLlxuLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi9cbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgY2hlY2sgPSBmdW5jdGlvbiAoTywgcHJvdG8pIHtcbiAgYW5PYmplY3QoTyk7XG4gIGlmICghaXNPYmplY3QocHJvdG8pICYmIHByb3RvICE9PSBudWxsKSB0aHJvdyBUeXBlRXJyb3IocHJvdG8gKyBcIjogY2FuJ3Qgc2V0IGFzIHByb3RvdHlwZSFcIik7XG59O1xubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHNldDogT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8ICgnX19wcm90b19fJyBpbiB7fSA/IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgICBmdW5jdGlvbiAodGVzdCwgYnVnZ3ksIHNldCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgc2V0ID0gcmVxdWlyZSgnLi9fY3R4JykoRnVuY3Rpb24uY2FsbCwgcmVxdWlyZSgnLi9fb2JqZWN0LWdvcGQnKS5mKE9iamVjdC5wcm90b3R5cGUsICdfX3Byb3RvX18nKS5zZXQsIDIpO1xuICAgICAgICBzZXQodGVzdCwgW10pO1xuICAgICAgICBidWdneSA9ICEodGVzdCBpbnN0YW5jZW9mIEFycmF5KTtcbiAgICAgIH0gY2F0Y2ggKGUpIHsgYnVnZ3kgPSB0cnVlOyB9XG4gICAgICByZXR1cm4gZnVuY3Rpb24gc2V0UHJvdG90eXBlT2YoTywgcHJvdG8pIHtcbiAgICAgICAgY2hlY2soTywgcHJvdG8pO1xuICAgICAgICBpZiAoYnVnZ3kpIE8uX19wcm90b19fID0gcHJvdG87XG4gICAgICAgIGVsc2Ugc2V0KE8sIHByb3RvKTtcbiAgICAgICAgcmV0dXJuIE87XG4gICAgICB9O1xuICAgIH0oe30sIGZhbHNlKSA6IHVuZGVmaW5lZCksXG4gIGNoZWNrOiBjaGVja1xufTtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBnbG9iYWwgPSByZXF1aXJlKCcuL19nbG9iYWwnKTtcbnZhciBjb3JlID0gcmVxdWlyZSgnLi9fY29yZScpO1xudmFyIGRQID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJyk7XG52YXIgREVTQ1JJUFRPUlMgPSByZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpO1xudmFyIFNQRUNJRVMgPSByZXF1aXJlKCcuL193a3MnKSgnc3BlY2llcycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChLRVkpIHtcbiAgdmFyIEMgPSB0eXBlb2YgY29yZVtLRVldID09ICdmdW5jdGlvbicgPyBjb3JlW0tFWV0gOiBnbG9iYWxbS0VZXTtcbiAgaWYgKERFU0NSSVBUT1JTICYmIEMgJiYgIUNbU1BFQ0lFU10pIGRQLmYoQywgU1BFQ0lFUywge1xuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH1cbiAgfSk7XG59O1xuIiwidmFyIGRlZiA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmY7XG52YXIgaGFzID0gcmVxdWlyZSgnLi9faGFzJyk7XG52YXIgVEFHID0gcmVxdWlyZSgnLi9fd2tzJykoJ3RvU3RyaW5nVGFnJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0LCB0YWcsIHN0YXQpIHtcbiAgaWYgKGl0ICYmICFoYXMoaXQgPSBzdGF0ID8gaXQgOiBpdC5wcm90b3R5cGUsIFRBRykpIGRlZihpdCwgVEFHLCB7IGNvbmZpZ3VyYWJsZTogdHJ1ZSwgdmFsdWU6IHRhZyB9KTtcbn07XG4iLCJ2YXIgc2hhcmVkID0gcmVxdWlyZSgnLi9fc2hhcmVkJykoJ2tleXMnKTtcbnZhciB1aWQgPSByZXF1aXJlKCcuL191aWQnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGtleSkge1xuICByZXR1cm4gc2hhcmVkW2tleV0gfHwgKHNoYXJlZFtrZXldID0gdWlkKGtleSkpO1xufTtcbiIsInZhciBjb3JlID0gcmVxdWlyZSgnLi9fY29yZScpO1xudmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIFNIQVJFRCA9ICdfX2NvcmUtanNfc2hhcmVkX18nO1xudmFyIHN0b3JlID0gZ2xvYmFsW1NIQVJFRF0gfHwgKGdsb2JhbFtTSEFSRURdID0ge30pO1xuXG4obW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICByZXR1cm4gc3RvcmVba2V5XSB8fCAoc3RvcmVba2V5XSA9IHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZSA6IHt9KTtcbn0pKCd2ZXJzaW9ucycsIFtdKS5wdXNoKHtcbiAgdmVyc2lvbjogY29yZS52ZXJzaW9uLFxuICBtb2RlOiByZXF1aXJlKCcuL19saWJyYXJ5JykgPyAncHVyZScgOiAnZ2xvYmFsJyxcbiAgY29weXJpZ2h0OiAnwqkgMjAyMCBEZW5pcyBQdXNoa2FyZXYgKHpsb2lyb2NrLnJ1KSdcbn0pO1xuIiwiLy8gNy4zLjIwIFNwZWNpZXNDb25zdHJ1Y3RvcihPLCBkZWZhdWx0Q29uc3RydWN0b3IpXG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciBhRnVuY3Rpb24gPSByZXF1aXJlKCcuL19hLWZ1bmN0aW9uJyk7XG52YXIgU1BFQ0lFUyA9IHJlcXVpcmUoJy4vX3drcycpKCdzcGVjaWVzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChPLCBEKSB7XG4gIHZhciBDID0gYW5PYmplY3QoTykuY29uc3RydWN0b3I7XG4gIHZhciBTO1xuICByZXR1cm4gQyA9PT0gdW5kZWZpbmVkIHx8IChTID0gYW5PYmplY3QoQylbU1BFQ0lFU10pID09IHVuZGVmaW5lZCA/IEQgOiBhRnVuY3Rpb24oUyk7XG59O1xuIiwidmFyIHRvSW50ZWdlciA9IHJlcXVpcmUoJy4vX3RvLWludGVnZXInKTtcbnZhciBkZWZpbmVkID0gcmVxdWlyZSgnLi9fZGVmaW5lZCcpO1xuLy8gdHJ1ZSAgLT4gU3RyaW5nI2F0XG4vLyBmYWxzZSAtPiBTdHJpbmcjY29kZVBvaW50QXRcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFRPX1NUUklORykge1xuICByZXR1cm4gZnVuY3Rpb24gKHRoYXQsIHBvcykge1xuICAgIHZhciBzID0gU3RyaW5nKGRlZmluZWQodGhhdCkpO1xuICAgIHZhciBpID0gdG9JbnRlZ2VyKHBvcyk7XG4gICAgdmFyIGwgPSBzLmxlbmd0aDtcbiAgICB2YXIgYSwgYjtcbiAgICBpZiAoaSA8IDAgfHwgaSA+PSBsKSByZXR1cm4gVE9fU1RSSU5HID8gJycgOiB1bmRlZmluZWQ7XG4gICAgYSA9IHMuY2hhckNvZGVBdChpKTtcbiAgICByZXR1cm4gYSA8IDB4ZDgwMCB8fCBhID4gMHhkYmZmIHx8IGkgKyAxID09PSBsIHx8IChiID0gcy5jaGFyQ29kZUF0KGkgKyAxKSkgPCAweGRjMDAgfHwgYiA+IDB4ZGZmZlxuICAgICAgPyBUT19TVFJJTkcgPyBzLmNoYXJBdChpKSA6IGFcbiAgICAgIDogVE9fU1RSSU5HID8gcy5zbGljZShpLCBpICsgMikgOiAoYSAtIDB4ZDgwMCA8PCAxMCkgKyAoYiAtIDB4ZGMwMCkgKyAweDEwMDAwO1xuICB9O1xufTtcbiIsInZhciBjdHggPSByZXF1aXJlKCcuL19jdHgnKTtcbnZhciBpbnZva2UgPSByZXF1aXJlKCcuL19pbnZva2UnKTtcbnZhciBodG1sID0gcmVxdWlyZSgnLi9faHRtbCcpO1xudmFyIGNlbCA9IHJlcXVpcmUoJy4vX2RvbS1jcmVhdGUnKTtcbnZhciBnbG9iYWwgPSByZXF1aXJlKCcuL19nbG9iYWwnKTtcbnZhciBwcm9jZXNzID0gZ2xvYmFsLnByb2Nlc3M7XG52YXIgc2V0VGFzayA9IGdsb2JhbC5zZXRJbW1lZGlhdGU7XG52YXIgY2xlYXJUYXNrID0gZ2xvYmFsLmNsZWFySW1tZWRpYXRlO1xudmFyIE1lc3NhZ2VDaGFubmVsID0gZ2xvYmFsLk1lc3NhZ2VDaGFubmVsO1xudmFyIERpc3BhdGNoID0gZ2xvYmFsLkRpc3BhdGNoO1xudmFyIGNvdW50ZXIgPSAwO1xudmFyIHF1ZXVlID0ge307XG52YXIgT05SRUFEWVNUQVRFQ0hBTkdFID0gJ29ucmVhZHlzdGF0ZWNoYW5nZSc7XG52YXIgZGVmZXIsIGNoYW5uZWwsIHBvcnQ7XG52YXIgcnVuID0gZnVuY3Rpb24gKCkge1xuICB2YXIgaWQgPSArdGhpcztcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXByb3RvdHlwZS1idWlsdGluc1xuICBpZiAocXVldWUuaGFzT3duUHJvcGVydHkoaWQpKSB7XG4gICAgdmFyIGZuID0gcXVldWVbaWRdO1xuICAgIGRlbGV0ZSBxdWV1ZVtpZF07XG4gICAgZm4oKTtcbiAgfVxufTtcbnZhciBsaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudCkge1xuICBydW4uY2FsbChldmVudC5kYXRhKTtcbn07XG4vLyBOb2RlLmpzIDAuOSsgJiBJRTEwKyBoYXMgc2V0SW1tZWRpYXRlLCBvdGhlcndpc2U6XG5pZiAoIXNldFRhc2sgfHwgIWNsZWFyVGFzaykge1xuICBzZXRUYXNrID0gZnVuY3Rpb24gc2V0SW1tZWRpYXRlKGZuKSB7XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICB2YXIgaSA9IDE7XG4gICAgd2hpbGUgKGFyZ3VtZW50cy5sZW5ndGggPiBpKSBhcmdzLnB1c2goYXJndW1lbnRzW2krK10pO1xuICAgIHF1ZXVlWysrY291bnRlcl0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tbmV3LWZ1bmNcbiAgICAgIGludm9rZSh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyA/IGZuIDogRnVuY3Rpb24oZm4pLCBhcmdzKTtcbiAgICB9O1xuICAgIGRlZmVyKGNvdW50ZXIpO1xuICAgIHJldHVybiBjb3VudGVyO1xuICB9O1xuICBjbGVhclRhc2sgPSBmdW5jdGlvbiBjbGVhckltbWVkaWF0ZShpZCkge1xuICAgIGRlbGV0ZSBxdWV1ZVtpZF07XG4gIH07XG4gIC8vIE5vZGUuanMgMC44LVxuICBpZiAocmVxdWlyZSgnLi9fY29mJykocHJvY2VzcykgPT0gJ3Byb2Nlc3MnKSB7XG4gICAgZGVmZXIgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgIHByb2Nlc3MubmV4dFRpY2soY3R4KHJ1biwgaWQsIDEpKTtcbiAgICB9O1xuICAvLyBTcGhlcmUgKEpTIGdhbWUgZW5naW5lKSBEaXNwYXRjaCBBUElcbiAgfSBlbHNlIGlmIChEaXNwYXRjaCAmJiBEaXNwYXRjaC5ub3cpIHtcbiAgICBkZWZlciA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgRGlzcGF0Y2gubm93KGN0eChydW4sIGlkLCAxKSk7XG4gICAgfTtcbiAgLy8gQnJvd3NlcnMgd2l0aCBNZXNzYWdlQ2hhbm5lbCwgaW5jbHVkZXMgV2ViV29ya2Vyc1xuICB9IGVsc2UgaWYgKE1lc3NhZ2VDaGFubmVsKSB7XG4gICAgY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpO1xuICAgIHBvcnQgPSBjaGFubmVsLnBvcnQyO1xuICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gbGlzdGVuZXI7XG4gICAgZGVmZXIgPSBjdHgocG9ydC5wb3N0TWVzc2FnZSwgcG9ydCwgMSk7XG4gIC8vIEJyb3dzZXJzIHdpdGggcG9zdE1lc3NhZ2UsIHNraXAgV2ViV29ya2Vyc1xuICAvLyBJRTggaGFzIHBvc3RNZXNzYWdlLCBidXQgaXQncyBzeW5jICYgdHlwZW9mIGl0cyBwb3N0TWVzc2FnZSBpcyAnb2JqZWN0J1xuICB9IGVsc2UgaWYgKGdsb2JhbC5hZGRFdmVudExpc3RlbmVyICYmIHR5cGVvZiBwb3N0TWVzc2FnZSA9PSAnZnVuY3Rpb24nICYmICFnbG9iYWwuaW1wb3J0U2NyaXB0cykge1xuICAgIGRlZmVyID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICBnbG9iYWwucG9zdE1lc3NhZ2UoaWQgKyAnJywgJyonKTtcbiAgICB9O1xuICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgbGlzdGVuZXIsIGZhbHNlKTtcbiAgLy8gSUU4LVxuICB9IGVsc2UgaWYgKE9OUkVBRFlTVEFURUNIQU5HRSBpbiBjZWwoJ3NjcmlwdCcpKSB7XG4gICAgZGVmZXIgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgIGh0bWwuYXBwZW5kQ2hpbGQoY2VsKCdzY3JpcHQnKSlbT05SRUFEWVNUQVRFQ0hBTkdFXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaHRtbC5yZW1vdmVDaGlsZCh0aGlzKTtcbiAgICAgICAgcnVuLmNhbGwoaWQpO1xuICAgICAgfTtcbiAgICB9O1xuICAvLyBSZXN0IG9sZCBicm93c2Vyc1xuICB9IGVsc2Uge1xuICAgIGRlZmVyID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICBzZXRUaW1lb3V0KGN0eChydW4sIGlkLCAxKSwgMCk7XG4gICAgfTtcbiAgfVxufVxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHNldDogc2V0VGFzayxcbiAgY2xlYXI6IGNsZWFyVGFza1xufTtcbiIsInZhciB0b0ludGVnZXIgPSByZXF1aXJlKCcuL190by1pbnRlZ2VyJyk7XG52YXIgbWF4ID0gTWF0aC5tYXg7XG52YXIgbWluID0gTWF0aC5taW47XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpbmRleCwgbGVuZ3RoKSB7XG4gIGluZGV4ID0gdG9JbnRlZ2VyKGluZGV4KTtcbiAgcmV0dXJuIGluZGV4IDwgMCA/IG1heChpbmRleCArIGxlbmd0aCwgMCkgOiBtaW4oaW5kZXgsIGxlbmd0aCk7XG59O1xuIiwiLy8gNy4xLjQgVG9JbnRlZ2VyXG52YXIgY2VpbCA9IE1hdGguY2VpbDtcbnZhciBmbG9vciA9IE1hdGguZmxvb3I7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gaXNOYU4oaXQgPSAraXQpID8gMCA6IChpdCA+IDAgPyBmbG9vciA6IGNlaWwpKGl0KTtcbn07XG4iLCIvLyB0byBpbmRleGVkIG9iamVjdCwgdG9PYmplY3Qgd2l0aCBmYWxsYmFjayBmb3Igbm9uLWFycmF5LWxpa2UgRVMzIHN0cmluZ3NcbnZhciBJT2JqZWN0ID0gcmVxdWlyZSgnLi9faW9iamVjdCcpO1xudmFyIGRlZmluZWQgPSByZXF1aXJlKCcuL19kZWZpbmVkJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gSU9iamVjdChkZWZpbmVkKGl0KSk7XG59O1xuIiwiLy8gNy4xLjE1IFRvTGVuZ3RoXG52YXIgdG9JbnRlZ2VyID0gcmVxdWlyZSgnLi9fdG8taW50ZWdlcicpO1xudmFyIG1pbiA9IE1hdGgubWluO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGl0ID4gMCA/IG1pbih0b0ludGVnZXIoaXQpLCAweDFmZmZmZmZmZmZmZmZmKSA6IDA7IC8vIHBvdygyLCA1MykgLSAxID09IDkwMDcxOTkyNTQ3NDA5OTFcbn07XG4iLCIvLyA3LjEuMTMgVG9PYmplY3QoYXJndW1lbnQpXG52YXIgZGVmaW5lZCA9IHJlcXVpcmUoJy4vX2RlZmluZWQnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBPYmplY3QoZGVmaW5lZChpdCkpO1xufTtcbiIsIi8vIDcuMS4xIFRvUHJpbWl0aXZlKGlucHV0IFssIFByZWZlcnJlZFR5cGVdKVxudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG4vLyBpbnN0ZWFkIG9mIHRoZSBFUzYgc3BlYyB2ZXJzaW9uLCB3ZSBkaWRuJ3QgaW1wbGVtZW50IEBAdG9QcmltaXRpdmUgY2FzZVxuLy8gYW5kIHRoZSBzZWNvbmQgYXJndW1lbnQgLSBmbGFnIC0gcHJlZmVycmVkIHR5cGUgaXMgYSBzdHJpbmdcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0LCBTKSB7XG4gIGlmICghaXNPYmplY3QoaXQpKSByZXR1cm4gaXQ7XG4gIHZhciBmbiwgdmFsO1xuICBpZiAoUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSkgcmV0dXJuIHZhbDtcbiAgaWYgKHR5cGVvZiAoZm4gPSBpdC52YWx1ZU9mKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpIHJldHVybiB2YWw7XG4gIGlmICghUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSkgcmV0dXJuIHZhbDtcbiAgdGhyb3cgVHlwZUVycm9yKFwiQ2FuJ3QgY29udmVydCBvYmplY3QgdG8gcHJpbWl0aXZlIHZhbHVlXCIpO1xufTtcbiIsInZhciBpZCA9IDA7XG52YXIgcHggPSBNYXRoLnJhbmRvbSgpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoa2V5KSB7XG4gIHJldHVybiAnU3ltYm9sKCcuY29uY2F0KGtleSA9PT0gdW5kZWZpbmVkID8gJycgOiBrZXksICcpXycsICgrK2lkICsgcHgpLnRvU3RyaW5nKDM2KSk7XG59O1xuIiwidmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIG5hdmlnYXRvciA9IGdsb2JhbC5uYXZpZ2F0b3I7XG5cbm1vZHVsZS5leHBvcnRzID0gbmF2aWdhdG9yICYmIG5hdmlnYXRvci51c2VyQWdlbnQgfHwgJyc7XG4iLCJ2YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJyk7XG52YXIgY29yZSA9IHJlcXVpcmUoJy4vX2NvcmUnKTtcbnZhciBMSUJSQVJZID0gcmVxdWlyZSgnLi9fbGlicmFyeScpO1xudmFyIHdrc0V4dCA9IHJlcXVpcmUoJy4vX3drcy1leHQnKTtcbnZhciBkZWZpbmVQcm9wZXJ0eSA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmY7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gIHZhciAkU3ltYm9sID0gY29yZS5TeW1ib2wgfHwgKGNvcmUuU3ltYm9sID0gTElCUkFSWSA/IHt9IDogZ2xvYmFsLlN5bWJvbCB8fCB7fSk7XG4gIGlmIChuYW1lLmNoYXJBdCgwKSAhPSAnXycgJiYgIShuYW1lIGluICRTeW1ib2wpKSBkZWZpbmVQcm9wZXJ0eSgkU3ltYm9sLCBuYW1lLCB7IHZhbHVlOiB3a3NFeHQuZihuYW1lKSB9KTtcbn07XG4iLCJleHBvcnRzLmYgPSByZXF1aXJlKCcuL193a3MnKTtcbiIsInZhciBzdG9yZSA9IHJlcXVpcmUoJy4vX3NoYXJlZCcpKCd3a3MnKTtcbnZhciB1aWQgPSByZXF1aXJlKCcuL191aWQnKTtcbnZhciBTeW1ib2wgPSByZXF1aXJlKCcuL19nbG9iYWwnKS5TeW1ib2w7XG52YXIgVVNFX1NZTUJPTCA9IHR5cGVvZiBTeW1ib2wgPT0gJ2Z1bmN0aW9uJztcblxudmFyICRleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobmFtZSkge1xuICByZXR1cm4gc3RvcmVbbmFtZV0gfHwgKHN0b3JlW25hbWVdID1cbiAgICBVU0VfU1lNQk9MICYmIFN5bWJvbFtuYW1lXSB8fCAoVVNFX1NZTUJPTCA/IFN5bWJvbCA6IHVpZCkoJ1N5bWJvbC4nICsgbmFtZSkpO1xufTtcblxuJGV4cG9ydHMuc3RvcmUgPSBzdG9yZTtcbiIsInZhciBjbGFzc29mID0gcmVxdWlyZSgnLi9fY2xhc3NvZicpO1xudmFyIElURVJBVE9SID0gcmVxdWlyZSgnLi9fd2tzJykoJ2l0ZXJhdG9yJyk7XG52YXIgSXRlcmF0b3JzID0gcmVxdWlyZSgnLi9faXRlcmF0b3JzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vX2NvcmUnKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAoaXQgIT0gdW5kZWZpbmVkKSByZXR1cm4gaXRbSVRFUkFUT1JdXG4gICAgfHwgaXRbJ0BAaXRlcmF0b3InXVxuICAgIHx8IEl0ZXJhdG9yc1tjbGFzc29mKGl0KV07XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGFkZFRvVW5zY29wYWJsZXMgPSByZXF1aXJlKCcuL19hZGQtdG8tdW5zY29wYWJsZXMnKTtcbnZhciBzdGVwID0gcmVxdWlyZSgnLi9faXRlci1zdGVwJyk7XG52YXIgSXRlcmF0b3JzID0gcmVxdWlyZSgnLi9faXRlcmF0b3JzJyk7XG52YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpO1xuXG4vLyAyMi4xLjMuNCBBcnJheS5wcm90b3R5cGUuZW50cmllcygpXG4vLyAyMi4xLjMuMTMgQXJyYXkucHJvdG90eXBlLmtleXMoKVxuLy8gMjIuMS4zLjI5IEFycmF5LnByb3RvdHlwZS52YWx1ZXMoKVxuLy8gMjIuMS4zLjMwIEFycmF5LnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vX2l0ZXItZGVmaW5lJykoQXJyYXksICdBcnJheScsIGZ1bmN0aW9uIChpdGVyYXRlZCwga2luZCkge1xuICB0aGlzLl90ID0gdG9JT2JqZWN0KGl0ZXJhdGVkKTsgLy8gdGFyZ2V0XG4gIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4XG4gIHRoaXMuX2sgPSBraW5kOyAgICAgICAgICAgICAgICAvLyBraW5kXG4vLyAyMi4xLjUuMi4xICVBcnJheUl0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KClcbn0sIGZ1bmN0aW9uICgpIHtcbiAgdmFyIE8gPSB0aGlzLl90O1xuICB2YXIga2luZCA9IHRoaXMuX2s7XG4gIHZhciBpbmRleCA9IHRoaXMuX2krKztcbiAgaWYgKCFPIHx8IGluZGV4ID49IE8ubGVuZ3RoKSB7XG4gICAgdGhpcy5fdCA9IHVuZGVmaW5lZDtcbiAgICByZXR1cm4gc3RlcCgxKTtcbiAgfVxuICBpZiAoa2luZCA9PSAna2V5cycpIHJldHVybiBzdGVwKDAsIGluZGV4KTtcbiAgaWYgKGtpbmQgPT0gJ3ZhbHVlcycpIHJldHVybiBzdGVwKDAsIE9baW5kZXhdKTtcbiAgcmV0dXJuIHN0ZXAoMCwgW2luZGV4LCBPW2luZGV4XV0pO1xufSwgJ3ZhbHVlcycpO1xuXG4vLyBhcmd1bWVudHNMaXN0W0BAaXRlcmF0b3JdIGlzICVBcnJheVByb3RvX3ZhbHVlcyUgKDkuNC40LjYsIDkuNC40LjcpXG5JdGVyYXRvcnMuQXJndW1lbnRzID0gSXRlcmF0b3JzLkFycmF5O1xuXG5hZGRUb1Vuc2NvcGFibGVzKCdrZXlzJyk7XG5hZGRUb1Vuc2NvcGFibGVzKCd2YWx1ZXMnKTtcbmFkZFRvVW5zY29wYWJsZXMoJ2VudHJpZXMnKTtcbiIsInZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG4vLyAxOS4xLjIuMiAvIDE1LjIuMy41IE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSlcbiRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0JywgeyBjcmVhdGU6IHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKSB9KTtcbiIsInZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG4vLyAxOS4xLjIuNCAvIDE1LjIuMy42IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKVxuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSwgJ09iamVjdCcsIHsgZGVmaW5lUHJvcGVydHk6IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmYgfSk7XG4iLCIvLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApXG52YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpO1xudmFyICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSByZXF1aXJlKCcuL19vYmplY3QtZ29wZCcpLmY7XG5cbnJlcXVpcmUoJy4vX29iamVjdC1zYXAnKSgnZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yJywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpIHtcbiAgICByZXR1cm4gJGdldE93blByb3BlcnR5RGVzY3JpcHRvcih0b0lPYmplY3QoaXQpLCBrZXkpO1xuICB9O1xufSk7XG4iLCIvLyAxOS4xLjIuOSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTylcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpO1xudmFyICRnZXRQcm90b3R5cGVPZiA9IHJlcXVpcmUoJy4vX29iamVjdC1ncG8nKTtcblxucmVxdWlyZSgnLi9fb2JqZWN0LXNhcCcpKCdnZXRQcm90b3R5cGVPZicsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGdldFByb3RvdHlwZU9mKGl0KSB7XG4gICAgcmV0dXJuICRnZXRQcm90b3R5cGVPZih0b09iamVjdChpdCkpO1xuICB9O1xufSk7XG4iLCIvLyAxOS4xLjMuMTkgT2JqZWN0LnNldFByb3RvdHlwZU9mKE8sIHByb3RvKVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbiRleHBvcnQoJGV4cG9ydC5TLCAnT2JqZWN0JywgeyBzZXRQcm90b3R5cGVPZjogcmVxdWlyZSgnLi9fc2V0LXByb3RvJykuc2V0IH0pO1xuIiwiIiwiJ3VzZSBzdHJpY3QnO1xudmFyIExJQlJBUlkgPSByZXF1aXJlKCcuL19saWJyYXJ5Jyk7XG52YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJyk7XG52YXIgY3R4ID0gcmVxdWlyZSgnLi9fY3R4Jyk7XG52YXIgY2xhc3NvZiA9IHJlcXVpcmUoJy4vX2NsYXNzb2YnKTtcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKTtcbnZhciBhRnVuY3Rpb24gPSByZXF1aXJlKCcuL19hLWZ1bmN0aW9uJyk7XG52YXIgYW5JbnN0YW5jZSA9IHJlcXVpcmUoJy4vX2FuLWluc3RhbmNlJyk7XG52YXIgZm9yT2YgPSByZXF1aXJlKCcuL19mb3Itb2YnKTtcbnZhciBzcGVjaWVzQ29uc3RydWN0b3IgPSByZXF1aXJlKCcuL19zcGVjaWVzLWNvbnN0cnVjdG9yJyk7XG52YXIgdGFzayA9IHJlcXVpcmUoJy4vX3Rhc2snKS5zZXQ7XG52YXIgbWljcm90YXNrID0gcmVxdWlyZSgnLi9fbWljcm90YXNrJykoKTtcbnZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eU1vZHVsZSA9IHJlcXVpcmUoJy4vX25ldy1wcm9taXNlLWNhcGFiaWxpdHknKTtcbnZhciBwZXJmb3JtID0gcmVxdWlyZSgnLi9fcGVyZm9ybScpO1xudmFyIHVzZXJBZ2VudCA9IHJlcXVpcmUoJy4vX3VzZXItYWdlbnQnKTtcbnZhciBwcm9taXNlUmVzb2x2ZSA9IHJlcXVpcmUoJy4vX3Byb21pc2UtcmVzb2x2ZScpO1xudmFyIFBST01JU0UgPSAnUHJvbWlzZSc7XG52YXIgVHlwZUVycm9yID0gZ2xvYmFsLlR5cGVFcnJvcjtcbnZhciBwcm9jZXNzID0gZ2xvYmFsLnByb2Nlc3M7XG52YXIgdmVyc2lvbnMgPSBwcm9jZXNzICYmIHByb2Nlc3MudmVyc2lvbnM7XG52YXIgdjggPSB2ZXJzaW9ucyAmJiB2ZXJzaW9ucy52OCB8fCAnJztcbnZhciAkUHJvbWlzZSA9IGdsb2JhbFtQUk9NSVNFXTtcbnZhciBpc05vZGUgPSBjbGFzc29mKHByb2Nlc3MpID09ICdwcm9jZXNzJztcbnZhciBlbXB0eSA9IGZ1bmN0aW9uICgpIHsgLyogZW1wdHkgKi8gfTtcbnZhciBJbnRlcm5hbCwgbmV3R2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5LCBPd25Qcm9taXNlQ2FwYWJpbGl0eSwgV3JhcHBlcjtcbnZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IG5ld0dlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5TW9kdWxlLmY7XG5cbnZhciBVU0VfTkFUSVZFID0gISFmdW5jdGlvbiAoKSB7XG4gIHRyeSB7XG4gICAgLy8gY29ycmVjdCBzdWJjbGFzc2luZyB3aXRoIEBAc3BlY2llcyBzdXBwb3J0XG4gICAgdmFyIHByb21pc2UgPSAkUHJvbWlzZS5yZXNvbHZlKDEpO1xuICAgIHZhciBGYWtlUHJvbWlzZSA9IChwcm9taXNlLmNvbnN0cnVjdG9yID0ge30pW3JlcXVpcmUoJy4vX3drcycpKCdzcGVjaWVzJyldID0gZnVuY3Rpb24gKGV4ZWMpIHtcbiAgICAgIGV4ZWMoZW1wdHksIGVtcHR5KTtcbiAgICB9O1xuICAgIC8vIHVuaGFuZGxlZCByZWplY3Rpb25zIHRyYWNraW5nIHN1cHBvcnQsIE5vZGVKUyBQcm9taXNlIHdpdGhvdXQgaXQgZmFpbHMgQEBzcGVjaWVzIHRlc3RcbiAgICByZXR1cm4gKGlzTm9kZSB8fCB0eXBlb2YgUHJvbWlzZVJlamVjdGlvbkV2ZW50ID09ICdmdW5jdGlvbicpXG4gICAgICAmJiBwcm9taXNlLnRoZW4oZW1wdHkpIGluc3RhbmNlb2YgRmFrZVByb21pc2VcbiAgICAgIC8vIHY4IDYuNiAoTm9kZSAxMCBhbmQgQ2hyb21lIDY2KSBoYXZlIGEgYnVnIHdpdGggcmVzb2x2aW5nIGN1c3RvbSB0aGVuYWJsZXNcbiAgICAgIC8vIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTgzMDU2NVxuICAgICAgLy8gd2UgY2FuJ3QgZGV0ZWN0IGl0IHN5bmNocm9ub3VzbHksIHNvIGp1c3QgY2hlY2sgdmVyc2lvbnNcbiAgICAgICYmIHY4LmluZGV4T2YoJzYuNicpICE9PSAwXG4gICAgICAmJiB1c2VyQWdlbnQuaW5kZXhPZignQ2hyb21lLzY2JykgPT09IC0xO1xuICB9IGNhdGNoIChlKSB7IC8qIGVtcHR5ICovIH1cbn0oKTtcblxuLy8gaGVscGVyc1xudmFyIGlzVGhlbmFibGUgPSBmdW5jdGlvbiAoaXQpIHtcbiAgdmFyIHRoZW47XG4gIHJldHVybiBpc09iamVjdChpdCkgJiYgdHlwZW9mICh0aGVuID0gaXQudGhlbikgPT0gJ2Z1bmN0aW9uJyA/IHRoZW4gOiBmYWxzZTtcbn07XG52YXIgbm90aWZ5ID0gZnVuY3Rpb24gKHByb21pc2UsIGlzUmVqZWN0KSB7XG4gIGlmIChwcm9taXNlLl9uKSByZXR1cm47XG4gIHByb21pc2UuX24gPSB0cnVlO1xuICB2YXIgY2hhaW4gPSBwcm9taXNlLl9jO1xuICBtaWNyb3Rhc2soZnVuY3Rpb24gKCkge1xuICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3Y7XG4gICAgdmFyIG9rID0gcHJvbWlzZS5fcyA9PSAxO1xuICAgIHZhciBpID0gMDtcbiAgICB2YXIgcnVuID0gZnVuY3Rpb24gKHJlYWN0aW9uKSB7XG4gICAgICB2YXIgaGFuZGxlciA9IG9rID8gcmVhY3Rpb24ub2sgOiByZWFjdGlvbi5mYWlsO1xuICAgICAgdmFyIHJlc29sdmUgPSByZWFjdGlvbi5yZXNvbHZlO1xuICAgICAgdmFyIHJlamVjdCA9IHJlYWN0aW9uLnJlamVjdDtcbiAgICAgIHZhciBkb21haW4gPSByZWFjdGlvbi5kb21haW47XG4gICAgICB2YXIgcmVzdWx0LCB0aGVuLCBleGl0ZWQ7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoaGFuZGxlcikge1xuICAgICAgICAgIGlmICghb2spIHtcbiAgICAgICAgICAgIGlmIChwcm9taXNlLl9oID09IDIpIG9uSGFuZGxlVW5oYW5kbGVkKHByb21pc2UpO1xuICAgICAgICAgICAgcHJvbWlzZS5faCA9IDE7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChoYW5kbGVyID09PSB0cnVlKSByZXN1bHQgPSB2YWx1ZTtcbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChkb21haW4pIGRvbWFpbi5lbnRlcigpO1xuICAgICAgICAgICAgcmVzdWx0ID0gaGFuZGxlcih2YWx1ZSk7IC8vIG1heSB0aHJvd1xuICAgICAgICAgICAgaWYgKGRvbWFpbikge1xuICAgICAgICAgICAgICBkb21haW4uZXhpdCgpO1xuICAgICAgICAgICAgICBleGl0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAocmVzdWx0ID09PSByZWFjdGlvbi5wcm9taXNlKSB7XG4gICAgICAgICAgICByZWplY3QoVHlwZUVycm9yKCdQcm9taXNlLWNoYWluIGN5Y2xlJykpO1xuICAgICAgICAgIH0gZWxzZSBpZiAodGhlbiA9IGlzVGhlbmFibGUocmVzdWx0KSkge1xuICAgICAgICAgICAgdGhlbi5jYWxsKHJlc3VsdCwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICB9IGVsc2UgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICB9IGVsc2UgcmVqZWN0KHZhbHVlKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgaWYgKGRvbWFpbiAmJiAhZXhpdGVkKSBkb21haW4uZXhpdCgpO1xuICAgICAgICByZWplY3QoZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB3aGlsZSAoY2hhaW4ubGVuZ3RoID4gaSkgcnVuKGNoYWluW2krK10pOyAvLyB2YXJpYWJsZSBsZW5ndGggLSBjYW4ndCB1c2UgZm9yRWFjaFxuICAgIHByb21pc2UuX2MgPSBbXTtcbiAgICBwcm9taXNlLl9uID0gZmFsc2U7XG4gICAgaWYgKGlzUmVqZWN0ICYmICFwcm9taXNlLl9oKSBvblVuaGFuZGxlZChwcm9taXNlKTtcbiAgfSk7XG59O1xudmFyIG9uVW5oYW5kbGVkID0gZnVuY3Rpb24gKHByb21pc2UpIHtcbiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24gKCkge1xuICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3Y7XG4gICAgdmFyIHVuaGFuZGxlZCA9IGlzVW5oYW5kbGVkKHByb21pc2UpO1xuICAgIHZhciByZXN1bHQsIGhhbmRsZXIsIGNvbnNvbGU7XG4gICAgaWYgKHVuaGFuZGxlZCkge1xuICAgICAgcmVzdWx0ID0gcGVyZm9ybShmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChpc05vZGUpIHtcbiAgICAgICAgICBwcm9jZXNzLmVtaXQoJ3VuaGFuZGxlZFJlamVjdGlvbicsIHZhbHVlLCBwcm9taXNlKTtcbiAgICAgICAgfSBlbHNlIGlmIChoYW5kbGVyID0gZ2xvYmFsLm9udW5oYW5kbGVkcmVqZWN0aW9uKSB7XG4gICAgICAgICAgaGFuZGxlcih7IHByb21pc2U6IHByb21pc2UsIHJlYXNvbjogdmFsdWUgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoKGNvbnNvbGUgPSBnbG9iYWwuY29uc29sZSkgJiYgY29uc29sZS5lcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbicsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICAvLyBCcm93c2VycyBzaG91bGQgbm90IHRyaWdnZXIgYHJlamVjdGlvbkhhbmRsZWRgIGV2ZW50IGlmIGl0IHdhcyBoYW5kbGVkIGhlcmUsIE5vZGVKUyAtIHNob3VsZFxuICAgICAgcHJvbWlzZS5faCA9IGlzTm9kZSB8fCBpc1VuaGFuZGxlZChwcm9taXNlKSA/IDIgOiAxO1xuICAgIH0gcHJvbWlzZS5fYSA9IHVuZGVmaW5lZDtcbiAgICBpZiAodW5oYW5kbGVkICYmIHJlc3VsdC5lKSB0aHJvdyByZXN1bHQudjtcbiAgfSk7XG59O1xudmFyIGlzVW5oYW5kbGVkID0gZnVuY3Rpb24gKHByb21pc2UpIHtcbiAgcmV0dXJuIHByb21pc2UuX2ggIT09IDEgJiYgKHByb21pc2UuX2EgfHwgcHJvbWlzZS5fYykubGVuZ3RoID09PSAwO1xufTtcbnZhciBvbkhhbmRsZVVuaGFuZGxlZCA9IGZ1bmN0aW9uIChwcm9taXNlKSB7XG4gIHRhc2suY2FsbChnbG9iYWwsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaGFuZGxlcjtcbiAgICBpZiAoaXNOb2RlKSB7XG4gICAgICBwcm9jZXNzLmVtaXQoJ3JlamVjdGlvbkhhbmRsZWQnLCBwcm9taXNlKTtcbiAgICB9IGVsc2UgaWYgKGhhbmRsZXIgPSBnbG9iYWwub25yZWplY3Rpb25oYW5kbGVkKSB7XG4gICAgICBoYW5kbGVyKHsgcHJvbWlzZTogcHJvbWlzZSwgcmVhc29uOiBwcm9taXNlLl92IH0pO1xuICAgIH1cbiAgfSk7XG59O1xudmFyICRyZWplY3QgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgdmFyIHByb21pc2UgPSB0aGlzO1xuICBpZiAocHJvbWlzZS5fZCkgcmV0dXJuO1xuICBwcm9taXNlLl9kID0gdHJ1ZTtcbiAgcHJvbWlzZSA9IHByb21pc2UuX3cgfHwgcHJvbWlzZTsgLy8gdW53cmFwXG4gIHByb21pc2UuX3YgPSB2YWx1ZTtcbiAgcHJvbWlzZS5fcyA9IDI7XG4gIGlmICghcHJvbWlzZS5fYSkgcHJvbWlzZS5fYSA9IHByb21pc2UuX2Muc2xpY2UoKTtcbiAgbm90aWZ5KHByb21pc2UsIHRydWUpO1xufTtcbnZhciAkcmVzb2x2ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICB2YXIgcHJvbWlzZSA9IHRoaXM7XG4gIHZhciB0aGVuO1xuICBpZiAocHJvbWlzZS5fZCkgcmV0dXJuO1xuICBwcm9taXNlLl9kID0gdHJ1ZTtcbiAgcHJvbWlzZSA9IHByb21pc2UuX3cgfHwgcHJvbWlzZTsgLy8gdW53cmFwXG4gIHRyeSB7XG4gICAgaWYgKHByb21pc2UgPT09IHZhbHVlKSB0aHJvdyBUeXBlRXJyb3IoXCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZlwiKTtcbiAgICBpZiAodGhlbiA9IGlzVGhlbmFibGUodmFsdWUpKSB7XG4gICAgICBtaWNyb3Rhc2soZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgd3JhcHBlciA9IHsgX3c6IHByb21pc2UsIF9kOiBmYWxzZSB9OyAvLyB3cmFwXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdGhlbi5jYWxsKHZhbHVlLCBjdHgoJHJlc29sdmUsIHdyYXBwZXIsIDEpLCBjdHgoJHJlamVjdCwgd3JhcHBlciwgMSkpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgJHJlamVjdC5jYWxsKHdyYXBwZXIsIGUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcHJvbWlzZS5fdiA9IHZhbHVlO1xuICAgICAgcHJvbWlzZS5fcyA9IDE7XG4gICAgICBub3RpZnkocHJvbWlzZSwgZmFsc2UpO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgICRyZWplY3QuY2FsbCh7IF93OiBwcm9taXNlLCBfZDogZmFsc2UgfSwgZSk7IC8vIHdyYXBcbiAgfVxufTtcblxuLy8gY29uc3RydWN0b3IgcG9seWZpbGxcbmlmICghVVNFX05BVElWRSkge1xuICAvLyAyNS40LjMuMSBQcm9taXNlKGV4ZWN1dG9yKVxuICAkUHJvbWlzZSA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpIHtcbiAgICBhbkluc3RhbmNlKHRoaXMsICRQcm9taXNlLCBQUk9NSVNFLCAnX2gnKTtcbiAgICBhRnVuY3Rpb24oZXhlY3V0b3IpO1xuICAgIEludGVybmFsLmNhbGwodGhpcyk7XG4gICAgdHJ5IHtcbiAgICAgIGV4ZWN1dG9yKGN0eCgkcmVzb2x2ZSwgdGhpcywgMSksIGN0eCgkcmVqZWN0LCB0aGlzLCAxKSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAkcmVqZWN0LmNhbGwodGhpcywgZXJyKTtcbiAgICB9XG4gIH07XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuICBJbnRlcm5hbCA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3IpIHtcbiAgICB0aGlzLl9jID0gW107ICAgICAgICAgICAgIC8vIDwtIGF3YWl0aW5nIHJlYWN0aW9uc1xuICAgIHRoaXMuX2EgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gY2hlY2tlZCBpbiBpc1VuaGFuZGxlZCByZWFjdGlvbnNcbiAgICB0aGlzLl9zID0gMDsgICAgICAgICAgICAgIC8vIDwtIHN0YXRlXG4gICAgdGhpcy5fZCA9IGZhbHNlOyAgICAgICAgICAvLyA8LSBkb25lXG4gICAgdGhpcy5fdiA9IHVuZGVmaW5lZDsgICAgICAvLyA8LSB2YWx1ZVxuICAgIHRoaXMuX2ggPSAwOyAgICAgICAgICAgICAgLy8gPC0gcmVqZWN0aW9uIHN0YXRlLCAwIC0gZGVmYXVsdCwgMSAtIGhhbmRsZWQsIDIgLSB1bmhhbmRsZWRcbiAgICB0aGlzLl9uID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIG5vdGlmeVxuICB9O1xuICBJbnRlcm5hbC5wcm90b3R5cGUgPSByZXF1aXJlKCcuL19yZWRlZmluZS1hbGwnKSgkUHJvbWlzZS5wcm90b3R5cGUsIHtcbiAgICAvLyAyNS40LjUuMyBQcm9taXNlLnByb3RvdHlwZS50aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKVxuICAgIHRoZW46IGZ1bmN0aW9uIHRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcbiAgICAgIHZhciByZWFjdGlvbiA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KHNwZWNpZXNDb25zdHJ1Y3Rvcih0aGlzLCAkUHJvbWlzZSkpO1xuICAgICAgcmVhY3Rpb24ub2sgPSB0eXBlb2Ygb25GdWxmaWxsZWQgPT0gJ2Z1bmN0aW9uJyA/IG9uRnVsZmlsbGVkIDogdHJ1ZTtcbiAgICAgIHJlYWN0aW9uLmZhaWwgPSB0eXBlb2Ygb25SZWplY3RlZCA9PSAnZnVuY3Rpb24nICYmIG9uUmVqZWN0ZWQ7XG4gICAgICByZWFjdGlvbi5kb21haW4gPSBpc05vZGUgPyBwcm9jZXNzLmRvbWFpbiA6IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMuX2MucHVzaChyZWFjdGlvbik7XG4gICAgICBpZiAodGhpcy5fYSkgdGhpcy5fYS5wdXNoKHJlYWN0aW9uKTtcbiAgICAgIGlmICh0aGlzLl9zKSBub3RpZnkodGhpcywgZmFsc2UpO1xuICAgICAgcmV0dXJuIHJlYWN0aW9uLnByb21pc2U7XG4gICAgfSxcbiAgICAvLyAyNS40LjUuMSBQcm9taXNlLnByb3RvdHlwZS5jYXRjaChvblJlamVjdGVkKVxuICAgICdjYXRjaCc6IGZ1bmN0aW9uIChvblJlamVjdGVkKSB7XG4gICAgICByZXR1cm4gdGhpcy50aGVuKHVuZGVmaW5lZCwgb25SZWplY3RlZCk7XG4gICAgfVxuICB9KTtcbiAgT3duUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHByb21pc2UgPSBuZXcgSW50ZXJuYWwoKTtcbiAgICB0aGlzLnByb21pc2UgPSBwcm9taXNlO1xuICAgIHRoaXMucmVzb2x2ZSA9IGN0eCgkcmVzb2x2ZSwgcHJvbWlzZSwgMSk7XG4gICAgdGhpcy5yZWplY3QgPSBjdHgoJHJlamVjdCwgcHJvbWlzZSwgMSk7XG4gIH07XG4gIG5ld1Byb21pc2VDYXBhYmlsaXR5TW9kdWxlLmYgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IGZ1bmN0aW9uIChDKSB7XG4gICAgcmV0dXJuIEMgPT09ICRQcm9taXNlIHx8IEMgPT09IFdyYXBwZXJcbiAgICAgID8gbmV3IE93blByb21pc2VDYXBhYmlsaXR5KEMpXG4gICAgICA6IG5ld0dlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eShDKTtcbiAgfTtcbn1cblxuJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwgeyBQcm9taXNlOiAkUHJvbWlzZSB9KTtcbnJlcXVpcmUoJy4vX3NldC10by1zdHJpbmctdGFnJykoJFByb21pc2UsIFBST01JU0UpO1xucmVxdWlyZSgnLi9fc2V0LXNwZWNpZXMnKShQUk9NSVNFKTtcbldyYXBwZXIgPSByZXF1aXJlKCcuL19jb3JlJylbUFJPTUlTRV07XG5cbi8vIHN0YXRpY3NcbiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIFBST01JU0UsIHtcbiAgLy8gMjUuNC40LjUgUHJvbWlzZS5yZWplY3QocilcbiAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3Qocikge1xuICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcyk7XG4gICAgdmFyICQkcmVqZWN0ID0gY2FwYWJpbGl0eS5yZWplY3Q7XG4gICAgJCRyZWplY3Qocik7XG4gICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTtcbiAgfVxufSk7XG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIChMSUJSQVJZIHx8ICFVU0VfTkFUSVZFKSwgUFJPTUlTRSwge1xuICAvLyAyNS40LjQuNiBQcm9taXNlLnJlc29sdmUoeClcbiAgcmVzb2x2ZTogZnVuY3Rpb24gcmVzb2x2ZSh4KSB7XG4gICAgcmV0dXJuIHByb21pc2VSZXNvbHZlKExJQlJBUlkgJiYgdGhpcyA9PT0gV3JhcHBlciA/ICRQcm9taXNlIDogdGhpcywgeCk7XG4gIH1cbn0pO1xuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhKFVTRV9OQVRJVkUgJiYgcmVxdWlyZSgnLi9faXRlci1kZXRlY3QnKShmdW5jdGlvbiAoaXRlcikge1xuICAkUHJvbWlzZS5hbGwoaXRlcilbJ2NhdGNoJ10oZW1wdHkpO1xufSkpLCBQUk9NSVNFLCB7XG4gIC8vIDI1LjQuNC4xIFByb21pc2UuYWxsKGl0ZXJhYmxlKVxuICBhbGw6IGZ1bmN0aW9uIGFsbChpdGVyYWJsZSkge1xuICAgIHZhciBDID0gdGhpcztcbiAgICB2YXIgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KEMpO1xuICAgIHZhciByZXNvbHZlID0gY2FwYWJpbGl0eS5yZXNvbHZlO1xuICAgIHZhciByZWplY3QgPSBjYXBhYmlsaXR5LnJlamVjdDtcbiAgICB2YXIgcmVzdWx0ID0gcGVyZm9ybShmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdmFsdWVzID0gW107XG4gICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgdmFyIHJlbWFpbmluZyA9IDE7XG4gICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uIChwcm9taXNlKSB7XG4gICAgICAgIHZhciAkaW5kZXggPSBpbmRleCsrO1xuICAgICAgICB2YXIgYWxyZWFkeUNhbGxlZCA9IGZhbHNlO1xuICAgICAgICB2YWx1ZXMucHVzaCh1bmRlZmluZWQpO1xuICAgICAgICByZW1haW5pbmcrKztcbiAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKGFscmVhZHlDYWxsZWQpIHJldHVybjtcbiAgICAgICAgICBhbHJlYWR5Q2FsbGVkID0gdHJ1ZTtcbiAgICAgICAgICB2YWx1ZXNbJGluZGV4XSA9IHZhbHVlO1xuICAgICAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTtcbiAgICAgICAgfSwgcmVqZWN0KTtcbiAgICAgIH0pO1xuICAgICAgLS1yZW1haW5pbmcgfHwgcmVzb2x2ZSh2YWx1ZXMpO1xuICAgIH0pO1xuICAgIGlmIChyZXN1bHQuZSkgcmVqZWN0KHJlc3VsdC52KTtcbiAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlO1xuICB9LFxuICAvLyAyNS40LjQuNCBQcm9taXNlLnJhY2UoaXRlcmFibGUpXG4gIHJhY2U6IGZ1bmN0aW9uIHJhY2UoaXRlcmFibGUpIHtcbiAgICB2YXIgQyA9IHRoaXM7XG4gICAgdmFyIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKTtcbiAgICB2YXIgcmVqZWN0ID0gY2FwYWJpbGl0eS5yZWplY3Q7XG4gICAgdmFyIHJlc3VsdCA9IHBlcmZvcm0oZnVuY3Rpb24gKCkge1xuICAgICAgZm9yT2YoaXRlcmFibGUsIGZhbHNlLCBmdW5jdGlvbiAocHJvbWlzZSkge1xuICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihjYXBhYmlsaXR5LnJlc29sdmUsIHJlamVjdCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBpZiAocmVzdWx0LmUpIHJlamVjdChyZXN1bHQudik7XG4gICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTtcbiAgfVxufSk7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgJGF0ID0gcmVxdWlyZSgnLi9fc3RyaW5nLWF0JykodHJ1ZSk7XG5cbi8vIDIxLjEuMy4yNyBTdHJpbmcucHJvdG90eXBlW0BAaXRlcmF0b3JdKClcbnJlcXVpcmUoJy4vX2l0ZXItZGVmaW5lJykoU3RyaW5nLCAnU3RyaW5nJywgZnVuY3Rpb24gKGl0ZXJhdGVkKSB7XG4gIHRoaXMuX3QgPSBTdHJpbmcoaXRlcmF0ZWQpOyAvLyB0YXJnZXRcbiAgdGhpcy5faSA9IDA7ICAgICAgICAgICAgICAgIC8vIG5leHQgaW5kZXhcbi8vIDIxLjEuNS4yLjEgJVN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KClcbn0sIGZ1bmN0aW9uICgpIHtcbiAgdmFyIE8gPSB0aGlzLl90O1xuICB2YXIgaW5kZXggPSB0aGlzLl9pO1xuICB2YXIgcG9pbnQ7XG4gIGlmIChpbmRleCA+PSBPLmxlbmd0aCkgcmV0dXJuIHsgdmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZSB9O1xuICBwb2ludCA9ICRhdChPLCBpbmRleCk7XG4gIHRoaXMuX2kgKz0gcG9pbnQubGVuZ3RoO1xuICByZXR1cm4geyB2YWx1ZTogcG9pbnQsIGRvbmU6IGZhbHNlIH07XG59KTtcbiIsIid1c2Ugc3RyaWN0Jztcbi8vIEVDTUFTY3JpcHQgNiBzeW1ib2xzIHNoaW1cbnZhciBnbG9iYWwgPSByZXF1aXJlKCcuL19nbG9iYWwnKTtcbnZhciBoYXMgPSByZXF1aXJlKCcuL19oYXMnKTtcbnZhciBERVNDUklQVE9SUyA9IHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJyk7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIHJlZGVmaW5lID0gcmVxdWlyZSgnLi9fcmVkZWZpbmUnKTtcbnZhciBNRVRBID0gcmVxdWlyZSgnLi9fbWV0YScpLktFWTtcbnZhciAkZmFpbHMgPSByZXF1aXJlKCcuL19mYWlscycpO1xudmFyIHNoYXJlZCA9IHJlcXVpcmUoJy4vX3NoYXJlZCcpO1xudmFyIHNldFRvU3RyaW5nVGFnID0gcmVxdWlyZSgnLi9fc2V0LXRvLXN0cmluZy10YWcnKTtcbnZhciB1aWQgPSByZXF1aXJlKCcuL191aWQnKTtcbnZhciB3a3MgPSByZXF1aXJlKCcuL193a3MnKTtcbnZhciB3a3NFeHQgPSByZXF1aXJlKCcuL193a3MtZXh0Jyk7XG52YXIgd2tzRGVmaW5lID0gcmVxdWlyZSgnLi9fd2tzLWRlZmluZScpO1xudmFyIGVudW1LZXlzID0gcmVxdWlyZSgnLi9fZW51bS1rZXlzJyk7XG52YXIgaXNBcnJheSA9IHJlcXVpcmUoJy4vX2lzLWFycmF5Jyk7XG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xudmFyIHRvT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8tb2JqZWN0Jyk7XG52YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpO1xudmFyIHRvUHJpbWl0aXZlID0gcmVxdWlyZSgnLi9fdG8tcHJpbWl0aXZlJyk7XG52YXIgY3JlYXRlRGVzYyA9IHJlcXVpcmUoJy4vX3Byb3BlcnR5LWRlc2MnKTtcbnZhciBfY3JlYXRlID0gcmVxdWlyZSgnLi9fb2JqZWN0LWNyZWF0ZScpO1xudmFyIGdPUE5FeHQgPSByZXF1aXJlKCcuL19vYmplY3QtZ29wbi1leHQnKTtcbnZhciAkR09QRCA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJyk7XG52YXIgJEdPUFMgPSByZXF1aXJlKCcuL19vYmplY3QtZ29wcycpO1xudmFyICREUCA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpO1xudmFyICRrZXlzID0gcmVxdWlyZSgnLi9fb2JqZWN0LWtleXMnKTtcbnZhciBnT1BEID0gJEdPUEQuZjtcbnZhciBkUCA9ICREUC5mO1xudmFyIGdPUE4gPSBnT1BORXh0LmY7XG52YXIgJFN5bWJvbCA9IGdsb2JhbC5TeW1ib2w7XG52YXIgJEpTT04gPSBnbG9iYWwuSlNPTjtcbnZhciBfc3RyaW5naWZ5ID0gJEpTT04gJiYgJEpTT04uc3RyaW5naWZ5O1xudmFyIFBST1RPVFlQRSA9ICdwcm90b3R5cGUnO1xudmFyIEhJRERFTiA9IHdrcygnX2hpZGRlbicpO1xudmFyIFRPX1BSSU1JVElWRSA9IHdrcygndG9QcmltaXRpdmUnKTtcbnZhciBpc0VudW0gPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcbnZhciBTeW1ib2xSZWdpc3RyeSA9IHNoYXJlZCgnc3ltYm9sLXJlZ2lzdHJ5Jyk7XG52YXIgQWxsU3ltYm9scyA9IHNoYXJlZCgnc3ltYm9scycpO1xudmFyIE9QU3ltYm9scyA9IHNoYXJlZCgnb3Atc3ltYm9scycpO1xudmFyIE9iamVjdFByb3RvID0gT2JqZWN0W1BST1RPVFlQRV07XG52YXIgVVNFX05BVElWRSA9IHR5cGVvZiAkU3ltYm9sID09ICdmdW5jdGlvbicgJiYgISEkR09QUy5mO1xudmFyIFFPYmplY3QgPSBnbG9iYWwuUU9iamVjdDtcbi8vIERvbid0IHVzZSBzZXR0ZXJzIGluIFF0IFNjcmlwdCwgaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvaXNzdWVzLzE3M1xudmFyIHNldHRlciA9ICFRT2JqZWN0IHx8ICFRT2JqZWN0W1BST1RPVFlQRV0gfHwgIVFPYmplY3RbUFJPVE9UWVBFXS5maW5kQ2hpbGQ7XG5cbi8vIGZhbGxiYWNrIGZvciBvbGQgQW5kcm9pZCwgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC92OC9pc3N1ZXMvZGV0YWlsP2lkPTY4N1xudmFyIHNldFN5bWJvbERlc2MgPSBERVNDUklQVE9SUyAmJiAkZmFpbHMoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gX2NyZWF0ZShkUCh7fSwgJ2EnLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBkUCh0aGlzLCAnYScsIHsgdmFsdWU6IDcgfSkuYTsgfVxuICB9KSkuYSAhPSA3O1xufSkgPyBmdW5jdGlvbiAoaXQsIGtleSwgRCkge1xuICB2YXIgcHJvdG9EZXNjID0gZ09QRChPYmplY3RQcm90bywga2V5KTtcbiAgaWYgKHByb3RvRGVzYykgZGVsZXRlIE9iamVjdFByb3RvW2tleV07XG4gIGRQKGl0LCBrZXksIEQpO1xuICBpZiAocHJvdG9EZXNjICYmIGl0ICE9PSBPYmplY3RQcm90bykgZFAoT2JqZWN0UHJvdG8sIGtleSwgcHJvdG9EZXNjKTtcbn0gOiBkUDtcblxudmFyIHdyYXAgPSBmdW5jdGlvbiAodGFnKSB7XG4gIHZhciBzeW0gPSBBbGxTeW1ib2xzW3RhZ10gPSBfY3JlYXRlKCRTeW1ib2xbUFJPVE9UWVBFXSk7XG4gIHN5bS5fayA9IHRhZztcbiAgcmV0dXJuIHN5bTtcbn07XG5cbnZhciBpc1N5bWJvbCA9IFVTRV9OQVRJVkUgJiYgdHlwZW9mICRTeW1ib2wuaXRlcmF0b3IgPT0gJ3N5bWJvbCcgPyBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIHR5cGVvZiBpdCA9PSAnc3ltYm9sJztcbn0gOiBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGl0IGluc3RhbmNlb2YgJFN5bWJvbDtcbn07XG5cbnZhciAkZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBEKSB7XG4gIGlmIChpdCA9PT0gT2JqZWN0UHJvdG8pICRkZWZpbmVQcm9wZXJ0eShPUFN5bWJvbHMsIGtleSwgRCk7XG4gIGFuT2JqZWN0KGl0KTtcbiAga2V5ID0gdG9QcmltaXRpdmUoa2V5LCB0cnVlKTtcbiAgYW5PYmplY3QoRCk7XG4gIGlmIChoYXMoQWxsU3ltYm9scywga2V5KSkge1xuICAgIGlmICghRC5lbnVtZXJhYmxlKSB7XG4gICAgICBpZiAoIWhhcyhpdCwgSElEREVOKSkgZFAoaXQsIEhJRERFTiwgY3JlYXRlRGVzYygxLCB7fSkpO1xuICAgICAgaXRbSElEREVOXVtrZXldID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pIGl0W0hJRERFTl1ba2V5XSA9IGZhbHNlO1xuICAgICAgRCA9IF9jcmVhdGUoRCwgeyBlbnVtZXJhYmxlOiBjcmVhdGVEZXNjKDAsIGZhbHNlKSB9KTtcbiAgICB9IHJldHVybiBzZXRTeW1ib2xEZXNjKGl0LCBrZXksIEQpO1xuICB9IHJldHVybiBkUChpdCwga2V5LCBEKTtcbn07XG52YXIgJGRlZmluZVByb3BlcnRpZXMgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKGl0LCBQKSB7XG4gIGFuT2JqZWN0KGl0KTtcbiAgdmFyIGtleXMgPSBlbnVtS2V5cyhQID0gdG9JT2JqZWN0KFApKTtcbiAgdmFyIGkgPSAwO1xuICB2YXIgbCA9IGtleXMubGVuZ3RoO1xuICB2YXIga2V5O1xuICB3aGlsZSAobCA+IGkpICRkZWZpbmVQcm9wZXJ0eShpdCwga2V5ID0ga2V5c1tpKytdLCBQW2tleV0pO1xuICByZXR1cm4gaXQ7XG59O1xudmFyICRjcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoaXQsIFApIHtcbiAgcmV0dXJuIFAgPT09IHVuZGVmaW5lZCA/IF9jcmVhdGUoaXQpIDogJGRlZmluZVByb3BlcnRpZXMoX2NyZWF0ZShpdCksIFApO1xufTtcbnZhciAkcHJvcGVydHlJc0VudW1lcmFibGUgPSBmdW5jdGlvbiBwcm9wZXJ0eUlzRW51bWVyYWJsZShrZXkpIHtcbiAgdmFyIEUgPSBpc0VudW0uY2FsbCh0aGlzLCBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpKTtcbiAgaWYgKHRoaXMgPT09IE9iamVjdFByb3RvICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoT1BTeW1ib2xzLCBrZXkpKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiBFIHx8ICFoYXModGhpcywga2V5KSB8fCAhaGFzKEFsbFN5bWJvbHMsIGtleSkgfHwgaGFzKHRoaXMsIEhJRERFTikgJiYgdGhpc1tISURERU5dW2tleV0gPyBFIDogdHJ1ZTtcbn07XG52YXIgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KSB7XG4gIGl0ID0gdG9JT2JqZWN0KGl0KTtcbiAga2V5ID0gdG9QcmltaXRpdmUoa2V5LCB0cnVlKTtcbiAgaWYgKGl0ID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSkgcmV0dXJuO1xuICB2YXIgRCA9IGdPUEQoaXQsIGtleSk7XG4gIGlmIChEICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICEoaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSkpIEQuZW51bWVyYWJsZSA9IHRydWU7XG4gIHJldHVybiBEO1xufTtcbnZhciAkZ2V0T3duUHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpIHtcbiAgdmFyIG5hbWVzID0gZ09QTih0b0lPYmplY3QoaXQpKTtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICB2YXIgaSA9IDA7XG4gIHZhciBrZXk7XG4gIHdoaWxlIChuYW1lcy5sZW5ndGggPiBpKSB7XG4gICAgaWYgKCFoYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYga2V5ICE9IEhJRERFTiAmJiBrZXkgIT0gTUVUQSkgcmVzdWx0LnB1c2goa2V5KTtcbiAgfSByZXR1cm4gcmVzdWx0O1xufTtcbnZhciAkZ2V0T3duUHJvcGVydHlTeW1ib2xzID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlTeW1ib2xzKGl0KSB7XG4gIHZhciBJU19PUCA9IGl0ID09PSBPYmplY3RQcm90bztcbiAgdmFyIG5hbWVzID0gZ09QTihJU19PUCA/IE9QU3ltYm9scyA6IHRvSU9iamVjdChpdCkpO1xuICB2YXIgcmVzdWx0ID0gW107XG4gIHZhciBpID0gMDtcbiAgdmFyIGtleTtcbiAgd2hpbGUgKG5hbWVzLmxlbmd0aCA+IGkpIHtcbiAgICBpZiAoaGFzKEFsbFN5bWJvbHMsIGtleSA9IG5hbWVzW2krK10pICYmIChJU19PUCA/IGhhcyhPYmplY3RQcm90bywga2V5KSA6IHRydWUpKSByZXN1bHQucHVzaChBbGxTeW1ib2xzW2tleV0pO1xuICB9IHJldHVybiByZXN1bHQ7XG59O1xuXG4vLyAxOS40LjEuMSBTeW1ib2woW2Rlc2NyaXB0aW9uXSlcbmlmICghVVNFX05BVElWRSkge1xuICAkU3ltYm9sID0gZnVuY3Rpb24gU3ltYm9sKCkge1xuICAgIGlmICh0aGlzIGluc3RhbmNlb2YgJFN5bWJvbCkgdGhyb3cgVHlwZUVycm9yKCdTeW1ib2wgaXMgbm90IGEgY29uc3RydWN0b3IhJyk7XG4gICAgdmFyIHRhZyA9IHVpZChhcmd1bWVudHMubGVuZ3RoID4gMCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7XG4gICAgdmFyICRzZXQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIGlmICh0aGlzID09PSBPYmplY3RQcm90bykgJHNldC5jYWxsKE9QU3ltYm9scywgdmFsdWUpO1xuICAgICAgaWYgKGhhcyh0aGlzLCBISURERU4pICYmIGhhcyh0aGlzW0hJRERFTl0sIHRhZykpIHRoaXNbSElEREVOXVt0YWddID0gZmFsc2U7XG4gICAgICBzZXRTeW1ib2xEZXNjKHRoaXMsIHRhZywgY3JlYXRlRGVzYygxLCB2YWx1ZSkpO1xuICAgIH07XG4gICAgaWYgKERFU0NSSVBUT1JTICYmIHNldHRlcikgc2V0U3ltYm9sRGVzYyhPYmplY3RQcm90bywgdGFnLCB7IGNvbmZpZ3VyYWJsZTogdHJ1ZSwgc2V0OiAkc2V0IH0pO1xuICAgIHJldHVybiB3cmFwKHRhZyk7XG4gIH07XG4gIHJlZGVmaW5lKCRTeW1ib2xbUFJPVE9UWVBFXSwgJ3RvU3RyaW5nJywgZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2s7XG4gIH0pO1xuXG4gICRHT1BELmYgPSAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO1xuICAkRFAuZiA9ICRkZWZpbmVQcm9wZXJ0eTtcbiAgcmVxdWlyZSgnLi9fb2JqZWN0LWdvcG4nKS5mID0gZ09QTkV4dC5mID0gJGdldE93blByb3BlcnR5TmFtZXM7XG4gIHJlcXVpcmUoJy4vX29iamVjdC1waWUnKS5mID0gJHByb3BlcnR5SXNFbnVtZXJhYmxlO1xuICAkR09QUy5mID0gJGdldE93blByb3BlcnR5U3ltYm9scztcblxuICBpZiAoREVTQ1JJUFRPUlMgJiYgIXJlcXVpcmUoJy4vX2xpYnJhcnknKSkge1xuICAgIHJlZGVmaW5lKE9iamVjdFByb3RvLCAncHJvcGVydHlJc0VudW1lcmFibGUnLCAkcHJvcGVydHlJc0VudW1lcmFibGUsIHRydWUpO1xuICB9XG5cbiAgd2tzRXh0LmYgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHJldHVybiB3cmFwKHdrcyhuYW1lKSk7XG4gIH07XG59XG5cbiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHsgU3ltYm9sOiAkU3ltYm9sIH0pO1xuXG5mb3IgKHZhciBlczZTeW1ib2xzID0gKFxuICAvLyAxOS40LjIuMiwgMTkuNC4yLjMsIDE5LjQuMi40LCAxOS40LjIuNiwgMTkuNC4yLjgsIDE5LjQuMi45LCAxOS40LjIuMTAsIDE5LjQuMi4xMSwgMTkuNC4yLjEyLCAxOS40LjIuMTMsIDE5LjQuMi4xNFxuICAnaGFzSW5zdGFuY2UsaXNDb25jYXRTcHJlYWRhYmxlLGl0ZXJhdG9yLG1hdGNoLHJlcGxhY2Usc2VhcmNoLHNwZWNpZXMsc3BsaXQsdG9QcmltaXRpdmUsdG9TdHJpbmdUYWcsdW5zY29wYWJsZXMnXG4pLnNwbGl0KCcsJyksIGogPSAwOyBlczZTeW1ib2xzLmxlbmd0aCA+IGo7KXdrcyhlczZTeW1ib2xzW2orK10pO1xuXG5mb3IgKHZhciB3ZWxsS25vd25TeW1ib2xzID0gJGtleXMod2tzLnN0b3JlKSwgayA9IDA7IHdlbGxLbm93blN5bWJvbHMubGVuZ3RoID4gazspIHdrc0RlZmluZSh3ZWxsS25vd25TeW1ib2xzW2srK10pO1xuXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnU3ltYm9sJywge1xuICAvLyAxOS40LjIuMSBTeW1ib2wuZm9yKGtleSlcbiAgJ2Zvcic6IGZ1bmN0aW9uIChrZXkpIHtcbiAgICByZXR1cm4gaGFzKFN5bWJvbFJlZ2lzdHJ5LCBrZXkgKz0gJycpXG4gICAgICA/IFN5bWJvbFJlZ2lzdHJ5W2tleV1cbiAgICAgIDogU3ltYm9sUmVnaXN0cnlba2V5XSA9ICRTeW1ib2woa2V5KTtcbiAgfSxcbiAgLy8gMTkuNC4yLjUgU3ltYm9sLmtleUZvcihzeW0pXG4gIGtleUZvcjogZnVuY3Rpb24ga2V5Rm9yKHN5bSkge1xuICAgIGlmICghaXNTeW1ib2woc3ltKSkgdGhyb3cgVHlwZUVycm9yKHN5bSArICcgaXMgbm90IGEgc3ltYm9sIScpO1xuICAgIGZvciAodmFyIGtleSBpbiBTeW1ib2xSZWdpc3RyeSkgaWYgKFN5bWJvbFJlZ2lzdHJ5W2tleV0gPT09IHN5bSkgcmV0dXJuIGtleTtcbiAgfSxcbiAgdXNlU2V0dGVyOiBmdW5jdGlvbiAoKSB7IHNldHRlciA9IHRydWU7IH0sXG4gIHVzZVNpbXBsZTogZnVuY3Rpb24gKCkgeyBzZXR0ZXIgPSBmYWxzZTsgfVxufSk7XG5cbiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsICdPYmplY3QnLCB7XG4gIC8vIDE5LjEuMi4yIE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSlcbiAgY3JlYXRlOiAkY3JlYXRlLFxuICAvLyAxOS4xLjIuNCBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcylcbiAgZGVmaW5lUHJvcGVydHk6ICRkZWZpbmVQcm9wZXJ0eSxcbiAgLy8gMTkuMS4yLjMgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcylcbiAgZGVmaW5lUHJvcGVydGllczogJGRlZmluZVByb3BlcnRpZXMsXG4gIC8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUClcbiAgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLFxuICAvLyAxOS4xLjIuNyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKVxuICBnZXRPd25Qcm9wZXJ0eU5hbWVzOiAkZ2V0T3duUHJvcGVydHlOYW1lcyxcbiAgLy8gMTkuMS4yLjggT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhPKVxuICBnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6ICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHNcbn0pO1xuXG4vLyBDaHJvbWUgMzggYW5kIDM5IGBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzYCBmYWlscyBvbiBwcmltaXRpdmVzXG4vLyBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvdjgvaXNzdWVzL2RldGFpbD9pZD0zNDQzXG52YXIgRkFJTFNfT05fUFJJTUlUSVZFUyA9ICRmYWlscyhmdW5jdGlvbiAoKSB7ICRHT1BTLmYoMSk7IH0pO1xuXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIEZBSUxTX09OX1BSSU1JVElWRVMsICdPYmplY3QnLCB7XG4gIGdldE93blByb3BlcnR5U3ltYm9sczogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlTeW1ib2xzKGl0KSB7XG4gICAgcmV0dXJuICRHT1BTLmYodG9PYmplY3QoaXQpKTtcbiAgfVxufSk7XG5cbi8vIDI0LjMuMiBKU09OLnN0cmluZ2lmeSh2YWx1ZSBbLCByZXBsYWNlciBbLCBzcGFjZV1dKVxuJEpTT04gJiYgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoIVVTRV9OQVRJVkUgfHwgJGZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgdmFyIFMgPSAkU3ltYm9sKCk7XG4gIC8vIE1TIEVkZ2UgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIHt9XG4gIC8vIFdlYktpdCBjb252ZXJ0cyBzeW1ib2wgdmFsdWVzIHRvIEpTT04gYXMgbnVsbFxuICAvLyBWOCB0aHJvd3Mgb24gYm94ZWQgc3ltYm9sc1xuICByZXR1cm4gX3N0cmluZ2lmeShbU10pICE9ICdbbnVsbF0nIHx8IF9zdHJpbmdpZnkoeyBhOiBTIH0pICE9ICd7fScgfHwgX3N0cmluZ2lmeShPYmplY3QoUykpICE9ICd7fSc7XG59KSksICdKU09OJywge1xuICBzdHJpbmdpZnk6IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCkge1xuICAgIHZhciBhcmdzID0gW2l0XTtcbiAgICB2YXIgaSA9IDE7XG4gICAgdmFyIHJlcGxhY2VyLCAkcmVwbGFjZXI7XG4gICAgd2hpbGUgKGFyZ3VtZW50cy5sZW5ndGggPiBpKSBhcmdzLnB1c2goYXJndW1lbnRzW2krK10pO1xuICAgICRyZXBsYWNlciA9IHJlcGxhY2VyID0gYXJnc1sxXTtcbiAgICBpZiAoIWlzT2JqZWN0KHJlcGxhY2VyKSAmJiBpdCA9PT0gdW5kZWZpbmVkIHx8IGlzU3ltYm9sKGl0KSkgcmV0dXJuOyAvLyBJRTggcmV0dXJucyBzdHJpbmcgb24gdW5kZWZpbmVkXG4gICAgaWYgKCFpc0FycmF5KHJlcGxhY2VyKSkgcmVwbGFjZXIgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgaWYgKHR5cGVvZiAkcmVwbGFjZXIgPT0gJ2Z1bmN0aW9uJykgdmFsdWUgPSAkcmVwbGFjZXIuY2FsbCh0aGlzLCBrZXksIHZhbHVlKTtcbiAgICAgIGlmICghaXNTeW1ib2wodmFsdWUpKSByZXR1cm4gdmFsdWU7XG4gICAgfTtcbiAgICBhcmdzWzFdID0gcmVwbGFjZXI7XG4gICAgcmV0dXJuIF9zdHJpbmdpZnkuYXBwbHkoJEpTT04sIGFyZ3MpO1xuICB9XG59KTtcblxuLy8gMTkuNC4zLjQgU3ltYm9sLnByb3RvdHlwZVtAQHRvUHJpbWl0aXZlXShoaW50KVxuJFN5bWJvbFtQUk9UT1RZUEVdW1RPX1BSSU1JVElWRV0gfHwgcmVxdWlyZSgnLi9faGlkZScpKCRTeW1ib2xbUFJPVE9UWVBFXSwgVE9fUFJJTUlUSVZFLCAkU3ltYm9sW1BST1RPVFlQRV0udmFsdWVPZik7XG4vLyAxOS40LjMuNSBTeW1ib2wucHJvdG90eXBlW0BAdG9TdHJpbmdUYWddXG5zZXRUb1N0cmluZ1RhZygkU3ltYm9sLCAnU3ltYm9sJyk7XG4vLyAyMC4yLjEuOSBNYXRoW0BAdG9TdHJpbmdUYWddXG5zZXRUb1N0cmluZ1RhZyhNYXRoLCAnTWF0aCcsIHRydWUpO1xuLy8gMjQuMy4zIEpTT05bQEB0b1N0cmluZ1RhZ11cbnNldFRvU3RyaW5nVGFnKGdsb2JhbC5KU09OLCAnSlNPTicsIHRydWUpO1xuIiwiLy8gaHR0cHM6Ly9naXRodWIuY29tL3RjMzkvcHJvcG9zYWwtcHJvbWlzZS1maW5hbGx5XG4ndXNlIHN0cmljdCc7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIGNvcmUgPSByZXF1aXJlKCcuL19jb3JlJyk7XG52YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJyk7XG52YXIgc3BlY2llc0NvbnN0cnVjdG9yID0gcmVxdWlyZSgnLi9fc3BlY2llcy1jb25zdHJ1Y3RvcicpO1xudmFyIHByb21pc2VSZXNvbHZlID0gcmVxdWlyZSgnLi9fcHJvbWlzZS1yZXNvbHZlJyk7XG5cbiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5SLCAnUHJvbWlzZScsIHsgJ2ZpbmFsbHknOiBmdW5jdGlvbiAob25GaW5hbGx5KSB7XG4gIHZhciBDID0gc3BlY2llc0NvbnN0cnVjdG9yKHRoaXMsIGNvcmUuUHJvbWlzZSB8fCBnbG9iYWwuUHJvbWlzZSk7XG4gIHZhciBpc0Z1bmN0aW9uID0gdHlwZW9mIG9uRmluYWxseSA9PSAnZnVuY3Rpb24nO1xuICByZXR1cm4gdGhpcy50aGVuKFxuICAgIGlzRnVuY3Rpb24gPyBmdW5jdGlvbiAoeCkge1xuICAgICAgcmV0dXJuIHByb21pc2VSZXNvbHZlKEMsIG9uRmluYWxseSgpKS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHg7IH0pO1xuICAgIH0gOiBvbkZpbmFsbHksXG4gICAgaXNGdW5jdGlvbiA/IGZ1bmN0aW9uIChlKSB7XG4gICAgICByZXR1cm4gcHJvbWlzZVJlc29sdmUoQywgb25GaW5hbGx5KCkpLnRoZW4oZnVuY3Rpb24gKCkgeyB0aHJvdyBlOyB9KTtcbiAgICB9IDogb25GaW5hbGx5XG4gICk7XG59IH0pO1xuIiwiJ3VzZSBzdHJpY3QnO1xuLy8gaHR0cHM6Ly9naXRodWIuY29tL3RjMzkvcHJvcG9zYWwtcHJvbWlzZS10cnlcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgbmV3UHJvbWlzZUNhcGFiaWxpdHkgPSByZXF1aXJlKCcuL19uZXctcHJvbWlzZS1jYXBhYmlsaXR5Jyk7XG52YXIgcGVyZm9ybSA9IHJlcXVpcmUoJy4vX3BlcmZvcm0nKTtcblxuJGV4cG9ydCgkZXhwb3J0LlMsICdQcm9taXNlJywgeyAndHJ5JzogZnVuY3Rpb24gKGNhbGxiYWNrZm4pIHtcbiAgdmFyIHByb21pc2VDYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkuZih0aGlzKTtcbiAgdmFyIHJlc3VsdCA9IHBlcmZvcm0oY2FsbGJhY2tmbik7XG4gIChyZXN1bHQuZSA/IHByb21pc2VDYXBhYmlsaXR5LnJlamVjdCA6IHByb21pc2VDYXBhYmlsaXR5LnJlc29sdmUpKHJlc3VsdC52KTtcbiAgcmV0dXJuIHByb21pc2VDYXBhYmlsaXR5LnByb21pc2U7XG59IH0pO1xuIiwicmVxdWlyZSgnLi9fd2tzLWRlZmluZScpKCdhc3luY0l0ZXJhdG9yJyk7XG4iLCJyZXF1aXJlKCcuL193a3MtZGVmaW5lJykoJ29ic2VydmFibGUnKTtcbiIsInJlcXVpcmUoJy4vZXM2LmFycmF5Lml0ZXJhdG9yJyk7XG52YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJyk7XG52YXIgaGlkZSA9IHJlcXVpcmUoJy4vX2hpZGUnKTtcbnZhciBJdGVyYXRvcnMgPSByZXF1aXJlKCcuL19pdGVyYXRvcnMnKTtcbnZhciBUT19TVFJJTkdfVEFHID0gcmVxdWlyZSgnLi9fd2tzJykoJ3RvU3RyaW5nVGFnJyk7XG5cbnZhciBET01JdGVyYWJsZXMgPSAoJ0NTU1J1bGVMaXN0LENTU1N0eWxlRGVjbGFyYXRpb24sQ1NTVmFsdWVMaXN0LENsaWVudFJlY3RMaXN0LERPTVJlY3RMaXN0LERPTVN0cmluZ0xpc3QsJyArXG4gICdET01Ub2tlbkxpc3QsRGF0YVRyYW5zZmVySXRlbUxpc3QsRmlsZUxpc3QsSFRNTEFsbENvbGxlY3Rpb24sSFRNTENvbGxlY3Rpb24sSFRNTEZvcm1FbGVtZW50LEhUTUxTZWxlY3RFbGVtZW50LCcgK1xuICAnTWVkaWFMaXN0LE1pbWVUeXBlQXJyYXksTmFtZWROb2RlTWFwLE5vZGVMaXN0LFBhaW50UmVxdWVzdExpc3QsUGx1Z2luLFBsdWdpbkFycmF5LFNWR0xlbmd0aExpc3QsU1ZHTnVtYmVyTGlzdCwnICtcbiAgJ1NWR1BhdGhTZWdMaXN0LFNWR1BvaW50TGlzdCxTVkdTdHJpbmdMaXN0LFNWR1RyYW5zZm9ybUxpc3QsU291cmNlQnVmZmVyTGlzdCxTdHlsZVNoZWV0TGlzdCxUZXh0VHJhY2tDdWVMaXN0LCcgK1xuICAnVGV4dFRyYWNrTGlzdCxUb3VjaExpc3QnKS5zcGxpdCgnLCcpO1xuXG5mb3IgKHZhciBpID0gMDsgaSA8IERPTUl0ZXJhYmxlcy5sZW5ndGg7IGkrKykge1xuICB2YXIgTkFNRSA9IERPTUl0ZXJhYmxlc1tpXTtcbiAgdmFyIENvbGxlY3Rpb24gPSBnbG9iYWxbTkFNRV07XG4gIHZhciBwcm90byA9IENvbGxlY3Rpb24gJiYgQ29sbGVjdGlvbi5wcm90b3R5cGU7XG4gIGlmIChwcm90byAmJiAhcHJvdG9bVE9fU1RSSU5HX1RBR10pIGhpZGUocHJvdG8sIFRPX1NUUklOR19UQUcsIE5BTUUpO1xuICBJdGVyYXRvcnNbTkFNRV0gPSBJdGVyYXRvcnMuQXJyYXk7XG59XG4iLCIvKlxuICogIENvcHlyaWdodCAoYykgMjAxNyBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZVxuICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZVxuICogIHRyZWUuXG4gKi9cbiAvKiBlc2xpbnQtZW52IG5vZGUgKi9cbid1c2Ugc3RyaWN0JztcblxudmFyIFNEUFV0aWxzID0gcmVxdWlyZSgnc2RwJyk7XG5cbmZ1bmN0aW9uIGZpeFN0YXRzVHlwZShzdGF0KSB7XG4gIHJldHVybiB7XG4gICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJyxcbiAgICBvdXRib3VuZHJ0cDogJ291dGJvdW5kLXJ0cCcsXG4gICAgY2FuZGlkYXRlcGFpcjogJ2NhbmRpZGF0ZS1wYWlyJyxcbiAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsXG4gICAgcmVtb3RlY2FuZGlkYXRlOiAncmVtb3RlLWNhbmRpZGF0ZSdcbiAgfVtzdGF0LnR5cGVdIHx8IHN0YXQudHlwZTtcbn1cblxuZnVuY3Rpb24gd3JpdGVNZWRpYVNlY3Rpb24odHJhbnNjZWl2ZXIsIGNhcHMsIHR5cGUsIHN0cmVhbSwgZHRsc1JvbGUpIHtcbiAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlUnRwRGVzY3JpcHRpb24odHJhbnNjZWl2ZXIua2luZCwgY2Fwcyk7XG5cbiAgLy8gTWFwIElDRSBwYXJhbWV0ZXJzICh1ZnJhZywgcHdkKSB0byBTRFAuXG4gIHNkcCArPSBTRFBVdGlscy53cml0ZUljZVBhcmFtZXRlcnMoXG4gICAgICB0cmFuc2NlaXZlci5pY2VHYXRoZXJlci5nZXRMb2NhbFBhcmFtZXRlcnMoKSk7XG5cbiAgLy8gTWFwIERUTFMgcGFyYW1ldGVycyB0byBTRFAuXG4gIHNkcCArPSBTRFBVdGlscy53cml0ZUR0bHNQYXJhbWV0ZXJzKFxuICAgICAgdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydC5nZXRMb2NhbFBhcmFtZXRlcnMoKSxcbiAgICAgIHR5cGUgPT09ICdvZmZlcicgPyAnYWN0cGFzcycgOiBkdGxzUm9sZSB8fCAnYWN0aXZlJyk7XG5cbiAgc2RwICs9ICdhPW1pZDonICsgdHJhbnNjZWl2ZXIubWlkICsgJ1xcclxcbic7XG5cbiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlciAmJiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcikge1xuICAgIHNkcCArPSAnYT1zZW5kcmVjdlxcclxcbic7XG4gIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7XG4gICAgc2RwICs9ICdhPXNlbmRvbmx5XFxyXFxuJztcbiAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5ydHBSZWNlaXZlcikge1xuICAgIHNkcCArPSAnYT1yZWN2b25seVxcclxcbic7XG4gIH0gZWxzZSB7XG4gICAgc2RwICs9ICdhPWluYWN0aXZlXFxyXFxuJztcbiAgfVxuXG4gIGlmICh0cmFuc2NlaXZlci5ydHBTZW5kZXIpIHtcbiAgICB2YXIgdHJhY2tJZCA9IHRyYW5zY2VpdmVyLnJ0cFNlbmRlci5faW5pdGlhbFRyYWNrSWQgfHxcbiAgICAgICAgdHJhbnNjZWl2ZXIucnRwU2VuZGVyLnRyYWNrLmlkO1xuICAgIHRyYW5zY2VpdmVyLnJ0cFNlbmRlci5faW5pdGlhbFRyYWNrSWQgPSB0cmFja0lkO1xuICAgIC8vIHNwZWMuXG4gICAgdmFyIG1zaWQgPSAnbXNpZDonICsgKHN0cmVhbSA/IHN0cmVhbS5pZCA6ICctJykgKyAnICcgK1xuICAgICAgICB0cmFja0lkICsgJ1xcclxcbic7XG4gICAgc2RwICs9ICdhPScgKyBtc2lkO1xuICAgIC8vIGZvciBDaHJvbWUuIExlZ2FjeSBzaG91bGQgbm8gbG9uZ2VyIGJlIHJlcXVpcmVkLlxuICAgIHNkcCArPSAnYT1zc3JjOicgKyB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnNzcmMgK1xuICAgICAgICAnICcgKyBtc2lkO1xuXG4gICAgLy8gUlRYXG4gICAgaWYgKHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7XG4gICAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHguc3NyYyArXG4gICAgICAgICAgJyAnICsgbXNpZDtcbiAgICAgIHNkcCArPSAnYT1zc3JjLWdyb3VwOkZJRCAnICtcbiAgICAgICAgICB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnNzcmMgKyAnICcgK1xuICAgICAgICAgIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4LnNzcmMgK1xuICAgICAgICAgICdcXHJcXG4nO1xuICAgIH1cbiAgfVxuICAvLyBGSVhNRTogdGhpcyBzaG91bGQgYmUgd3JpdHRlbiBieSB3cml0ZVJ0cERlc2NyaXB0aW9uLlxuICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICtcbiAgICAgICcgY25hbWU6JyArIFNEUFV0aWxzLmxvY2FsQ05hbWUgKyAnXFxyXFxuJztcbiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlciAmJiB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eCkge1xuICAgIHNkcCArPSAnYT1zc3JjOicgKyB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICtcbiAgICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcXHJcXG4nO1xuICB9XG4gIHJldHVybiBzZHA7XG59XG5cbi8vIEVkZ2UgZG9lcyBub3QgbGlrZVxuLy8gMSkgc3R1bjogZmlsdGVyZWQgYWZ0ZXIgMTQzOTMgdW5sZXNzID90cmFuc3BvcnQ9dWRwIGlzIHByZXNlbnRcbi8vIDIpIHR1cm46IHRoYXQgZG9lcyBub3QgaGF2ZSBhbGwgb2YgdHVybjpob3N0OnBvcnQ/dHJhbnNwb3J0PXVkcFxuLy8gMykgdHVybjogd2l0aCBpcHY2IGFkZHJlc3Nlc1xuLy8gNCkgdHVybjogb2NjdXJyaW5nIG11bGlwbGUgdGltZXNcbmZ1bmN0aW9uIGZpbHRlckljZVNlcnZlcnMoaWNlU2VydmVycywgZWRnZVZlcnNpb24pIHtcbiAgdmFyIGhhc1R1cm4gPSBmYWxzZTtcbiAgaWNlU2VydmVycyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoaWNlU2VydmVycykpO1xuICByZXR1cm4gaWNlU2VydmVycy5maWx0ZXIoZnVuY3Rpb24oc2VydmVyKSB7XG4gICAgaWYgKHNlcnZlciAmJiAoc2VydmVyLnVybHMgfHwgc2VydmVyLnVybCkpIHtcbiAgICAgIHZhciB1cmxzID0gc2VydmVyLnVybHMgfHwgc2VydmVyLnVybDtcbiAgICAgIGlmIChzZXJ2ZXIudXJsICYmICFzZXJ2ZXIudXJscykge1xuICAgICAgICBjb25zb2xlLndhcm4oJ1JUQ0ljZVNlcnZlci51cmwgaXMgZGVwcmVjYXRlZCEgVXNlIHVybHMgaW5zdGVhZC4nKTtcbiAgICAgIH1cbiAgICAgIHZhciBpc1N0cmluZyA9IHR5cGVvZiB1cmxzID09PSAnc3RyaW5nJztcbiAgICAgIGlmIChpc1N0cmluZykge1xuICAgICAgICB1cmxzID0gW3VybHNdO1xuICAgICAgfVxuICAgICAgdXJscyA9IHVybHMuZmlsdGVyKGZ1bmN0aW9uKHVybCkge1xuICAgICAgICB2YXIgdmFsaWRUdXJuID0gdXJsLmluZGV4T2YoJ3R1cm46JykgPT09IDAgJiZcbiAgICAgICAgICAgIHVybC5pbmRleE9mKCd0cmFuc3BvcnQ9dWRwJykgIT09IC0xICYmXG4gICAgICAgICAgICB1cmwuaW5kZXhPZigndHVybjpbJykgPT09IC0xICYmXG4gICAgICAgICAgICAhaGFzVHVybjtcblxuICAgICAgICBpZiAodmFsaWRUdXJuKSB7XG4gICAgICAgICAgaGFzVHVybiA9IHRydWU7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVybC5pbmRleE9mKCdzdHVuOicpID09PSAwICYmIGVkZ2VWZXJzaW9uID49IDE0MzkzICYmXG4gICAgICAgICAgICB1cmwuaW5kZXhPZignP3RyYW5zcG9ydD11ZHAnKSA9PT0gLTE7XG4gICAgICB9KTtcblxuICAgICAgZGVsZXRlIHNlcnZlci51cmw7XG4gICAgICBzZXJ2ZXIudXJscyA9IGlzU3RyaW5nID8gdXJsc1swXSA6IHVybHM7XG4gICAgICByZXR1cm4gISF1cmxzLmxlbmd0aDtcbiAgICB9XG4gIH0pO1xufVxuXG4vLyBEZXRlcm1pbmVzIHRoZSBpbnRlcnNlY3Rpb24gb2YgbG9jYWwgYW5kIHJlbW90ZSBjYXBhYmlsaXRpZXMuXG5mdW5jdGlvbiBnZXRDb21tb25DYXBhYmlsaXRpZXMobG9jYWxDYXBhYmlsaXRpZXMsIHJlbW90ZUNhcGFiaWxpdGllcykge1xuICB2YXIgY29tbW9uQ2FwYWJpbGl0aWVzID0ge1xuICAgIGNvZGVjczogW10sXG4gICAgaGVhZGVyRXh0ZW5zaW9uczogW10sXG4gICAgZmVjTWVjaGFuaXNtczogW11cbiAgfTtcblxuICB2YXIgZmluZENvZGVjQnlQYXlsb2FkVHlwZSA9IGZ1bmN0aW9uKHB0LCBjb2RlY3MpIHtcbiAgICBwdCA9IHBhcnNlSW50KHB0LCAxMCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2RlY3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChjb2RlY3NbaV0ucGF5bG9hZFR5cGUgPT09IHB0IHx8XG4gICAgICAgICAgY29kZWNzW2ldLnByZWZlcnJlZFBheWxvYWRUeXBlID09PSBwdCkge1xuICAgICAgICByZXR1cm4gY29kZWNzW2ldO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICB2YXIgcnR4Q2FwYWJpbGl0eU1hdGNoZXMgPSBmdW5jdGlvbihsUnR4LCByUnR4LCBsQ29kZWNzLCByQ29kZWNzKSB7XG4gICAgdmFyIGxDb2RlYyA9IGZpbmRDb2RlY0J5UGF5bG9hZFR5cGUobFJ0eC5wYXJhbWV0ZXJzLmFwdCwgbENvZGVjcyk7XG4gICAgdmFyIHJDb2RlYyA9IGZpbmRDb2RlY0J5UGF5bG9hZFR5cGUoclJ0eC5wYXJhbWV0ZXJzLmFwdCwgckNvZGVjcyk7XG4gICAgcmV0dXJuIGxDb2RlYyAmJiByQ29kZWMgJiZcbiAgICAgICAgbENvZGVjLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gckNvZGVjLm5hbWUudG9Mb3dlckNhc2UoKTtcbiAgfTtcblxuICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZm9yRWFjaChmdW5jdGlvbihsQ29kZWMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlbW90ZUNhcGFiaWxpdGllcy5jb2RlY3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciByQ29kZWMgPSByZW1vdGVDYXBhYmlsaXRpZXMuY29kZWNzW2ldO1xuICAgICAgaWYgKGxDb2RlYy5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IHJDb2RlYy5uYW1lLnRvTG93ZXJDYXNlKCkgJiZcbiAgICAgICAgICBsQ29kZWMuY2xvY2tSYXRlID09PSByQ29kZWMuY2xvY2tSYXRlKSB7XG4gICAgICAgIGlmIChsQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpID09PSAncnR4JyAmJlxuICAgICAgICAgICAgbENvZGVjLnBhcmFtZXRlcnMgJiYgckNvZGVjLnBhcmFtZXRlcnMuYXB0KSB7XG4gICAgICAgICAgLy8gZm9yIFJUWCB3ZSBuZWVkIHRvIGZpbmQgdGhlIGxvY2FsIHJ0eCB0aGF0IGhhcyBhIGFwdFxuICAgICAgICAgIC8vIHdoaWNoIHBvaW50cyB0byB0aGUgc2FtZSBsb2NhbCBjb2RlYyBhcyB0aGUgcmVtb3RlIG9uZS5cbiAgICAgICAgICBpZiAoIXJ0eENhcGFiaWxpdHlNYXRjaGVzKGxDb2RlYywgckNvZGVjLFxuICAgICAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MsIHJlbW90ZUNhcGFiaWxpdGllcy5jb2RlY3MpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgckNvZGVjID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyQ29kZWMpKTsgLy8gZGVlcGNvcHlcbiAgICAgICAgLy8gbnVtYmVyIG9mIGNoYW5uZWxzIGlzIHRoZSBoaWdoZXN0IGNvbW1vbiBudW1iZXIgb2YgY2hhbm5lbHNcbiAgICAgICAgckNvZGVjLm51bUNoYW5uZWxzID0gTWF0aC5taW4obENvZGVjLm51bUNoYW5uZWxzLFxuICAgICAgICAgICAgckNvZGVjLm51bUNoYW5uZWxzKTtcbiAgICAgICAgLy8gcHVzaCByQ29kZWMgc28gd2UgcmVwbHkgd2l0aCBvZmZlcmVyIHBheWxvYWQgdHlwZVxuICAgICAgICBjb21tb25DYXBhYmlsaXRpZXMuY29kZWNzLnB1c2gockNvZGVjKTtcblxuICAgICAgICAvLyBkZXRlcm1pbmUgY29tbW9uIGZlZWRiYWNrIG1lY2hhbmlzbXNcbiAgICAgICAgckNvZGVjLnJ0Y3BGZWVkYmFjayA9IHJDb2RlYy5ydGNwRmVlZGJhY2suZmlsdGVyKGZ1bmN0aW9uKGZiKSB7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBsQ29kZWMucnRjcEZlZWRiYWNrLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICBpZiAobENvZGVjLnJ0Y3BGZWVkYmFja1tqXS50eXBlID09PSBmYi50eXBlICYmXG4gICAgICAgICAgICAgICAgbENvZGVjLnJ0Y3BGZWVkYmFja1tqXS5wYXJhbWV0ZXIgPT09IGZiLnBhcmFtZXRlcikge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gRklYTUU6IGFsc28gbmVlZCB0byBkZXRlcm1pbmUgLnBhcmFtZXRlcnNcbiAgICAgICAgLy8gIHNlZSBodHRwczovL2dpdGh1Yi5jb20vb3BlbnBlZXIvb3J0Yy9pc3N1ZXMvNTY5XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgbG9jYWxDYXBhYmlsaXRpZXMuaGVhZGVyRXh0ZW5zaW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGxIZWFkZXJFeHRlbnNpb24pIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlbW90ZUNhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zLmxlbmd0aDtcbiAgICAgICAgIGkrKykge1xuICAgICAgdmFyIHJIZWFkZXJFeHRlbnNpb24gPSByZW1vdGVDYXBhYmlsaXRpZXMuaGVhZGVyRXh0ZW5zaW9uc1tpXTtcbiAgICAgIGlmIChsSGVhZGVyRXh0ZW5zaW9uLnVyaSA9PT0gckhlYWRlckV4dGVuc2lvbi51cmkpIHtcbiAgICAgICAgY29tbW9uQ2FwYWJpbGl0aWVzLmhlYWRlckV4dGVuc2lvbnMucHVzaChySGVhZGVyRXh0ZW5zaW9uKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICAvLyBGSVhNRTogZmVjTWVjaGFuaXNtc1xuICByZXR1cm4gY29tbW9uQ2FwYWJpbGl0aWVzO1xufVxuXG4vLyBpcyBhY3Rpb249c2V0TG9jYWxEZXNjcmlwdGlvbiB3aXRoIHR5cGUgYWxsb3dlZCBpbiBzaWduYWxpbmdTdGF0ZVxuZnVuY3Rpb24gaXNBY3Rpb25BbGxvd2VkSW5TaWduYWxpbmdTdGF0ZShhY3Rpb24sIHR5cGUsIHNpZ25hbGluZ1N0YXRlKSB7XG4gIHJldHVybiB7XG4gICAgb2ZmZXI6IHtcbiAgICAgIHNldExvY2FsRGVzY3JpcHRpb246IFsnc3RhYmxlJywgJ2hhdmUtbG9jYWwtb2ZmZXInXSxcbiAgICAgIHNldFJlbW90ZURlc2NyaXB0aW9uOiBbJ3N0YWJsZScsICdoYXZlLXJlbW90ZS1vZmZlciddXG4gICAgfSxcbiAgICBhbnN3ZXI6IHtcbiAgICAgIHNldExvY2FsRGVzY3JpcHRpb246IFsnaGF2ZS1yZW1vdGUtb2ZmZXInLCAnaGF2ZS1sb2NhbC1wcmFuc3dlciddLFxuICAgICAgc2V0UmVtb3RlRGVzY3JpcHRpb246IFsnaGF2ZS1sb2NhbC1vZmZlcicsICdoYXZlLXJlbW90ZS1wcmFuc3dlciddXG4gICAgfVxuICB9W3R5cGVdW2FjdGlvbl0uaW5kZXhPZihzaWduYWxpbmdTdGF0ZSkgIT09IC0xO1xufVxuXG5mdW5jdGlvbiBtYXliZUFkZENhbmRpZGF0ZShpY2VUcmFuc3BvcnQsIGNhbmRpZGF0ZSkge1xuICAvLyBFZGdlJ3MgaW50ZXJuYWwgcmVwcmVzZW50YXRpb24gYWRkcyBzb21lIGZpZWxkcyB0aGVyZWZvcmVcbiAgLy8gbm90IGFsbCBmaWVsZNGVIGFyZSB0YWtlbiBpbnRvIGFjY291bnQuXG4gIHZhciBhbHJlYWR5QWRkZWQgPSBpY2VUcmFuc3BvcnQuZ2V0UmVtb3RlQ2FuZGlkYXRlcygpXG4gICAgICAuZmluZChmdW5jdGlvbihyZW1vdGVDYW5kaWRhdGUpIHtcbiAgICAgICAgcmV0dXJuIGNhbmRpZGF0ZS5mb3VuZGF0aW9uID09PSByZW1vdGVDYW5kaWRhdGUuZm91bmRhdGlvbiAmJlxuICAgICAgICAgICAgY2FuZGlkYXRlLmlwID09PSByZW1vdGVDYW5kaWRhdGUuaXAgJiZcbiAgICAgICAgICAgIGNhbmRpZGF0ZS5wb3J0ID09PSByZW1vdGVDYW5kaWRhdGUucG9ydCAmJlxuICAgICAgICAgICAgY2FuZGlkYXRlLnByaW9yaXR5ID09PSByZW1vdGVDYW5kaWRhdGUucHJpb3JpdHkgJiZcbiAgICAgICAgICAgIGNhbmRpZGF0ZS5wcm90b2NvbCA9PT0gcmVtb3RlQ2FuZGlkYXRlLnByb3RvY29sICYmXG4gICAgICAgICAgICBjYW5kaWRhdGUudHlwZSA9PT0gcmVtb3RlQ2FuZGlkYXRlLnR5cGU7XG4gICAgICB9KTtcbiAgaWYgKCFhbHJlYWR5QWRkZWQpIHtcbiAgICBpY2VUcmFuc3BvcnQuYWRkUmVtb3RlQ2FuZGlkYXRlKGNhbmRpZGF0ZSk7XG4gIH1cbiAgcmV0dXJuICFhbHJlYWR5QWRkZWQ7XG59XG5cblxuZnVuY3Rpb24gbWFrZUVycm9yKG5hbWUsIGRlc2NyaXB0aW9uKSB7XG4gIHZhciBlID0gbmV3IEVycm9yKGRlc2NyaXB0aW9uKTtcbiAgZS5uYW1lID0gbmFtZTtcbiAgLy8gbGVnYWN5IGVycm9yIGNvZGVzIGZyb20gaHR0cHM6Ly9oZXljYW0uZ2l0aHViLmlvL3dlYmlkbC8jaWRsLURPTUV4Y2VwdGlvbi1lcnJvci1uYW1lc1xuICBlLmNvZGUgPSB7XG4gICAgTm90U3VwcG9ydGVkRXJyb3I6IDksXG4gICAgSW52YWxpZFN0YXRlRXJyb3I6IDExLFxuICAgIEludmFsaWRBY2Nlc3NFcnJvcjogMTUsXG4gICAgVHlwZUVycm9yOiB1bmRlZmluZWQsXG4gICAgT3BlcmF0aW9uRXJyb3I6IHVuZGVmaW5lZFxuICB9W25hbWVdO1xuICByZXR1cm4gZTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih3aW5kb3csIGVkZ2VWZXJzaW9uKSB7XG4gIC8vIGh0dHBzOi8vdzNjLmdpdGh1Yi5pby9tZWRpYWNhcHR1cmUtbWFpbi8jbWVkaWFzdHJlYW1cbiAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGFkZCB0aGUgdHJhY2sgdG8gdGhlIHN0cmVhbSBhbmRcbiAgLy8gZGlzcGF0Y2ggdGhlIGV2ZW50IG91cnNlbHZlcy5cbiAgZnVuY3Rpb24gYWRkVHJhY2tUb1N0cmVhbUFuZEZpcmVFdmVudCh0cmFjaywgc3RyZWFtKSB7XG4gICAgc3RyZWFtLmFkZFRyYWNrKHRyYWNrKTtcbiAgICBzdHJlYW0uZGlzcGF0Y2hFdmVudChuZXcgd2luZG93Lk1lZGlhU3RyZWFtVHJhY2tFdmVudCgnYWRkdHJhY2snLFxuICAgICAgICB7dHJhY2s6IHRyYWNrfSkpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlVHJhY2tGcm9tU3RyZWFtQW5kRmlyZUV2ZW50KHRyYWNrLCBzdHJlYW0pIHtcbiAgICBzdHJlYW0ucmVtb3ZlVHJhY2sodHJhY2spO1xuICAgIHN0cmVhbS5kaXNwYXRjaEV2ZW50KG5ldyB3aW5kb3cuTWVkaWFTdHJlYW1UcmFja0V2ZW50KCdyZW1vdmV0cmFjaycsXG4gICAgICAgIHt0cmFjazogdHJhY2t9KSk7XG4gIH1cblxuICBmdW5jdGlvbiBmaXJlQWRkVHJhY2socGMsIHRyYWNrLCByZWNlaXZlciwgc3RyZWFtcykge1xuICAgIHZhciB0cmFja0V2ZW50ID0gbmV3IEV2ZW50KCd0cmFjaycpO1xuICAgIHRyYWNrRXZlbnQudHJhY2sgPSB0cmFjaztcbiAgICB0cmFja0V2ZW50LnJlY2VpdmVyID0gcmVjZWl2ZXI7XG4gICAgdHJhY2tFdmVudC50cmFuc2NlaXZlciA9IHtyZWNlaXZlcjogcmVjZWl2ZXJ9O1xuICAgIHRyYWNrRXZlbnQuc3RyZWFtcyA9IHN0cmVhbXM7XG4gICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBwYy5fZGlzcGF0Y2hFdmVudCgndHJhY2snLCB0cmFja0V2ZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIHZhciBSVENQZWVyQ29ubmVjdGlvbiA9IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgIHZhciBwYyA9IHRoaXM7XG5cbiAgICB2YXIgX2V2ZW50VGFyZ2V0ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIFsnYWRkRXZlbnRMaXN0ZW5lcicsICdyZW1vdmVFdmVudExpc3RlbmVyJywgJ2Rpc3BhdGNoRXZlbnQnXVxuICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHtcbiAgICAgICAgICBwY1ttZXRob2RdID0gX2V2ZW50VGFyZ2V0W21ldGhvZF0uYmluZChfZXZlbnRUYXJnZXQpO1xuICAgICAgICB9KTtcblxuICAgIHRoaXMuY2FuVHJpY2tsZUljZUNhbmRpZGF0ZXMgPSBudWxsO1xuXG4gICAgdGhpcy5uZWVkTmVnb3RpYXRpb24gPSBmYWxzZTtcblxuICAgIHRoaXMubG9jYWxTdHJlYW1zID0gW107XG4gICAgdGhpcy5yZW1vdGVTdHJlYW1zID0gW107XG5cbiAgICB0aGlzLl9sb2NhbERlc2NyaXB0aW9uID0gbnVsbDtcbiAgICB0aGlzLl9yZW1vdGVEZXNjcmlwdGlvbiA9IG51bGw7XG5cbiAgICB0aGlzLnNpZ25hbGluZ1N0YXRlID0gJ3N0YWJsZSc7XG4gICAgdGhpcy5pY2VDb25uZWN0aW9uU3RhdGUgPSAnbmV3JztcbiAgICB0aGlzLmNvbm5lY3Rpb25TdGF0ZSA9ICduZXcnO1xuICAgIHRoaXMuaWNlR2F0aGVyaW5nU3RhdGUgPSAnbmV3JztcblxuICAgIGNvbmZpZyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY29uZmlnIHx8IHt9KSk7XG5cbiAgICB0aGlzLnVzaW5nQnVuZGxlID0gY29uZmlnLmJ1bmRsZVBvbGljeSA9PT0gJ21heC1idW5kbGUnO1xuICAgIGlmIChjb25maWcucnRjcE11eFBvbGljeSA9PT0gJ25lZ290aWF0ZScpIHtcbiAgICAgIHRocm93KG1ha2VFcnJvcignTm90U3VwcG9ydGVkRXJyb3InLFxuICAgICAgICAgICdydGNwTXV4UG9saWN5IFxcJ25lZ290aWF0ZVxcJyBpcyBub3Qgc3VwcG9ydGVkJykpO1xuICAgIH0gZWxzZSBpZiAoIWNvbmZpZy5ydGNwTXV4UG9saWN5KSB7XG4gICAgICBjb25maWcucnRjcE11eFBvbGljeSA9ICdyZXF1aXJlJztcbiAgICB9XG5cbiAgICBzd2l0Y2ggKGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHtcbiAgICAgIGNhc2UgJ2FsbCc6XG4gICAgICBjYXNlICdyZWxheSc6XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgY29uZmlnLmljZVRyYW5zcG9ydFBvbGljeSA9ICdhbGwnO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICBzd2l0Y2ggKGNvbmZpZy5idW5kbGVQb2xpY3kpIHtcbiAgICAgIGNhc2UgJ2JhbGFuY2VkJzpcbiAgICAgIGNhc2UgJ21heC1jb21wYXQnOlxuICAgICAgY2FzZSAnbWF4LWJ1bmRsZSc6XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgY29uZmlnLmJ1bmRsZVBvbGljeSA9ICdiYWxhbmNlZCc7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGNvbmZpZy5pY2VTZXJ2ZXJzID0gZmlsdGVySWNlU2VydmVycyhjb25maWcuaWNlU2VydmVycyB8fCBbXSwgZWRnZVZlcnNpb24pO1xuXG4gICAgdGhpcy5faWNlR2F0aGVyZXJzID0gW107XG4gICAgaWYgKGNvbmZpZy5pY2VDYW5kaWRhdGVQb29sU2l6ZSkge1xuICAgICAgZm9yICh2YXIgaSA9IGNvbmZpZy5pY2VDYW5kaWRhdGVQb29sU2l6ZTsgaSA+IDA7IGktLSkge1xuICAgICAgICB0aGlzLl9pY2VHYXRoZXJlcnMucHVzaChuZXcgd2luZG93LlJUQ0ljZUdhdGhlcmVyKHtcbiAgICAgICAgICBpY2VTZXJ2ZXJzOiBjb25maWcuaWNlU2VydmVycyxcbiAgICAgICAgICBnYXRoZXJQb2xpY3k6IGNvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3lcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25maWcuaWNlQ2FuZGlkYXRlUG9vbFNpemUgPSAwO1xuICAgIH1cblxuICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcblxuICAgIC8vIHBlci10cmFjayBpY2VHYXRoZXJzLCBpY2VUcmFuc3BvcnRzLCBkdGxzVHJhbnNwb3J0cywgcnRwU2VuZGVycywgLi4uXG4gICAgLy8gZXZlcnl0aGluZyB0aGF0IGlzIG5lZWRlZCB0byBkZXNjcmliZSBhIFNEUCBtLWxpbmUuXG4gICAgdGhpcy50cmFuc2NlaXZlcnMgPSBbXTtcblxuICAgIHRoaXMuX3NkcFNlc3Npb25JZCA9IFNEUFV0aWxzLmdlbmVyYXRlU2Vzc2lvbklkKCk7XG4gICAgdGhpcy5fc2RwU2Vzc2lvblZlcnNpb24gPSAwO1xuXG4gICAgdGhpcy5fZHRsc1JvbGUgPSB1bmRlZmluZWQ7IC8vIHJvbGUgZm9yIGE9c2V0dXAgdG8gdXNlIGluIGFuc3dlcnMuXG5cbiAgICB0aGlzLl9pc0Nsb3NlZCA9IGZhbHNlO1xuICB9O1xuXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUsICdsb2NhbERlc2NyaXB0aW9uJywge1xuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2xvY2FsRGVzY3JpcHRpb247XG4gICAgfVxuICB9KTtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSwgJ3JlbW90ZURlc2NyaXB0aW9uJywge1xuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3JlbW90ZURlc2NyaXB0aW9uO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gc2V0IHVwIGV2ZW50IGhhbmRsZXJzIG9uIHByb3RvdHlwZVxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUub25pY2VjYW5kaWRhdGUgPSBudWxsO1xuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUub25hZGRzdHJlYW0gPSBudWxsO1xuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUub250cmFjayA9IG51bGw7XG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5vbnJlbW92ZXN0cmVhbSA9IG51bGw7XG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlID0gbnVsbDtcbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlID0gbnVsbDtcbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlID0gbnVsbDtcbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2UgPSBudWxsO1xuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUub25uZWdvdGlhdGlvbm5lZWRlZCA9IG51bGw7XG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5vbmRhdGFjaGFubmVsID0gbnVsbDtcblxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX2Rpc3BhdGNoRXZlbnQgPSBmdW5jdGlvbihuYW1lLCBldmVudCkge1xuICAgIGlmICh0aGlzLl9pc0Nsb3NlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgIGlmICh0eXBlb2YgdGhpc1snb24nICsgbmFtZV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRoaXNbJ29uJyArIG5hbWVdKGV2ZW50KTtcbiAgICB9XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ2ljZWdhdGhlcmluZ3N0YXRlY2hhbmdlJyk7XG4gICAgdGhpcy5fZGlzcGF0Y2hFdmVudCgnaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2UnLCBldmVudCk7XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldENvbmZpZ3VyYXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5fY29uZmlnO1xuICB9O1xuXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRMb2NhbFN0cmVhbXMgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5sb2NhbFN0cmVhbXM7XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFJlbW90ZVN0cmVhbXMgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5yZW1vdGVTdHJlYW1zO1xuICB9O1xuXG4gIC8vIGludGVybmFsIGhlbHBlciB0byBjcmVhdGUgYSB0cmFuc2NlaXZlciBvYmplY3QuXG4gIC8vICh3aGljaCBpcyBub3QgeWV0IHRoZSBzYW1lIGFzIHRoZSBXZWJSVEMgMS4wIHRyYW5zY2VpdmVyKVxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX2NyZWF0ZVRyYW5zY2VpdmVyID0gZnVuY3Rpb24oa2luZCwgZG9Ob3RBZGQpIHtcbiAgICB2YXIgaGFzQnVuZGxlVHJhbnNwb3J0ID0gdGhpcy50cmFuc2NlaXZlcnMubGVuZ3RoID4gMDtcbiAgICB2YXIgdHJhbnNjZWl2ZXIgPSB7XG4gICAgICB0cmFjazogbnVsbCxcbiAgICAgIGljZUdhdGhlcmVyOiBudWxsLFxuICAgICAgaWNlVHJhbnNwb3J0OiBudWxsLFxuICAgICAgZHRsc1RyYW5zcG9ydDogbnVsbCxcbiAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzOiBudWxsLFxuICAgICAgcmVtb3RlQ2FwYWJpbGl0aWVzOiBudWxsLFxuICAgICAgcnRwU2VuZGVyOiBudWxsLFxuICAgICAgcnRwUmVjZWl2ZXI6IG51bGwsXG4gICAgICBraW5kOiBraW5kLFxuICAgICAgbWlkOiBudWxsLFxuICAgICAgc2VuZEVuY29kaW5nUGFyYW1ldGVyczogbnVsbCxcbiAgICAgIHJlY3ZFbmNvZGluZ1BhcmFtZXRlcnM6IG51bGwsXG4gICAgICBzdHJlYW06IG51bGwsXG4gICAgICBhc3NvY2lhdGVkUmVtb3RlTWVkaWFTdHJlYW1zOiBbXSxcbiAgICAgIHdhbnRSZWNlaXZlOiB0cnVlXG4gICAgfTtcbiAgICBpZiAodGhpcy51c2luZ0J1bmRsZSAmJiBoYXNCdW5kbGVUcmFuc3BvcnQpIHtcbiAgICAgIHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCA9IHRoaXMudHJhbnNjZWl2ZXJzWzBdLmljZVRyYW5zcG9ydDtcbiAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQgPSB0aGlzLnRyYW5zY2VpdmVyc1swXS5kdGxzVHJhbnNwb3J0O1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgdHJhbnNwb3J0cyA9IHRoaXMuX2NyZWF0ZUljZUFuZER0bHNUcmFuc3BvcnRzKCk7XG4gICAgICB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQgPSB0cmFuc3BvcnRzLmljZVRyYW5zcG9ydDtcbiAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQgPSB0cmFuc3BvcnRzLmR0bHNUcmFuc3BvcnQ7XG4gICAgfVxuICAgIGlmICghZG9Ob3RBZGQpIHtcbiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzLnB1c2godHJhbnNjZWl2ZXIpO1xuICAgIH1cbiAgICByZXR1cm4gdHJhbnNjZWl2ZXI7XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFRyYWNrID0gZnVuY3Rpb24odHJhY2ssIHN0cmVhbSkge1xuICAgIGlmICh0aGlzLl9pc0Nsb3NlZCkge1xuICAgICAgdGhyb3cgbWFrZUVycm9yKCdJbnZhbGlkU3RhdGVFcnJvcicsXG4gICAgICAgICAgJ0F0dGVtcHRlZCB0byBjYWxsIGFkZFRyYWNrIG9uIGEgY2xvc2VkIHBlZXJjb25uZWN0aW9uLicpO1xuICAgIH1cblxuICAgIHZhciBhbHJlYWR5RXhpc3RzID0gdGhpcy50cmFuc2NlaXZlcnMuZmluZChmdW5jdGlvbihzKSB7XG4gICAgICByZXR1cm4gcy50cmFjayA9PT0gdHJhY2s7XG4gICAgfSk7XG5cbiAgICBpZiAoYWxyZWFkeUV4aXN0cykge1xuICAgICAgdGhyb3cgbWFrZUVycm9yKCdJbnZhbGlkQWNjZXNzRXJyb3InLCAnVHJhY2sgYWxyZWFkeSBleGlzdHMuJyk7XG4gICAgfVxuXG4gICAgdmFyIHRyYW5zY2VpdmVyO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFuc2NlaXZlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghdGhpcy50cmFuc2NlaXZlcnNbaV0udHJhY2sgJiZcbiAgICAgICAgICB0aGlzLnRyYW5zY2VpdmVyc1tpXS5raW5kID09PSB0cmFjay5raW5kKSB7XG4gICAgICAgIHRyYW5zY2VpdmVyID0gdGhpcy50cmFuc2NlaXZlcnNbaV07XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghdHJhbnNjZWl2ZXIpIHtcbiAgICAgIHRyYW5zY2VpdmVyID0gdGhpcy5fY3JlYXRlVHJhbnNjZWl2ZXIodHJhY2sua2luZCk7XG4gICAgfVxuXG4gICAgdGhpcy5fbWF5YmVGaXJlTmVnb3RpYXRpb25OZWVkZWQoKTtcblxuICAgIGlmICh0aGlzLmxvY2FsU3RyZWFtcy5pbmRleE9mKHN0cmVhbSkgPT09IC0xKSB7XG4gICAgICB0aGlzLmxvY2FsU3RyZWFtcy5wdXNoKHN0cmVhbSk7XG4gICAgfVxuXG4gICAgdHJhbnNjZWl2ZXIudHJhY2sgPSB0cmFjaztcbiAgICB0cmFuc2NlaXZlci5zdHJlYW0gPSBzdHJlYW07XG4gICAgdHJhbnNjZWl2ZXIucnRwU2VuZGVyID0gbmV3IHdpbmRvdy5SVENSdHBTZW5kZXIodHJhY2ssXG4gICAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQpO1xuICAgIHJldHVybiB0cmFuc2NlaXZlci5ydHBTZW5kZXI7XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgIHZhciBwYyA9IHRoaXM7XG4gICAgaWYgKGVkZ2VWZXJzaW9uID49IDE1MDI1KSB7XG4gICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykge1xuICAgICAgICBwYy5hZGRUcmFjayh0cmFjaywgc3RyZWFtKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDbG9uZSBpcyBuZWNlc3NhcnkgZm9yIGxvY2FsIGRlbW9zIG1vc3RseSwgYXR0YWNoaW5nIGRpcmVjdGx5XG4gICAgICAvLyB0byB0d28gZGlmZmVyZW50IHNlbmRlcnMgZG9lcyBub3Qgd29yayAoYnVpbGQgMTA1NDcpLlxuICAgICAgLy8gRml4ZWQgaW4gMTUwMjUgKG9yIGVhcmxpZXIpXG4gICAgICB2YXIgY2xvbmVkU3RyZWFtID0gc3RyZWFtLmNsb25lKCk7XG4gICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaywgaWR4KSB7XG4gICAgICAgIHZhciBjbG9uZWRUcmFjayA9IGNsb25lZFN0cmVhbS5nZXRUcmFja3MoKVtpZHhdO1xuICAgICAgICB0cmFjay5hZGRFdmVudExpc3RlbmVyKCdlbmFibGVkJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICBjbG9uZWRUcmFjay5lbmFibGVkID0gZXZlbnQuZW5hYmxlZDtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIGNsb25lZFN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7XG4gICAgICAgIHBjLmFkZFRyYWNrKHRyYWNrLCBjbG9uZWRTdHJlYW0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVUcmFjayA9IGZ1bmN0aW9uKHNlbmRlcikge1xuICAgIGlmICh0aGlzLl9pc0Nsb3NlZCkge1xuICAgICAgdGhyb3cgbWFrZUVycm9yKCdJbnZhbGlkU3RhdGVFcnJvcicsXG4gICAgICAgICAgJ0F0dGVtcHRlZCB0byBjYWxsIHJlbW92ZVRyYWNrIG9uIGEgY2xvc2VkIHBlZXJjb25uZWN0aW9uLicpO1xuICAgIH1cblxuICAgIGlmICghKHNlbmRlciBpbnN0YW5jZW9mIHdpbmRvdy5SVENSdHBTZW5kZXIpKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudCAxIG9mIFJUQ1BlZXJDb25uZWN0aW9uLnJlbW92ZVRyYWNrICcgK1xuICAgICAgICAgICdkb2VzIG5vdCBpbXBsZW1lbnQgaW50ZXJmYWNlIFJUQ1J0cFNlbmRlci4nKTtcbiAgICB9XG5cbiAgICB2YXIgdHJhbnNjZWl2ZXIgPSB0aGlzLnRyYW5zY2VpdmVycy5maW5kKGZ1bmN0aW9uKHQpIHtcbiAgICAgIHJldHVybiB0LnJ0cFNlbmRlciA9PT0gc2VuZGVyO1xuICAgIH0pO1xuXG4gICAgaWYgKCF0cmFuc2NlaXZlcikge1xuICAgICAgdGhyb3cgbWFrZUVycm9yKCdJbnZhbGlkQWNjZXNzRXJyb3InLFxuICAgICAgICAgICdTZW5kZXIgd2FzIG5vdCBjcmVhdGVkIGJ5IHRoaXMgY29ubmVjdGlvbi4nKTtcbiAgICB9XG4gICAgdmFyIHN0cmVhbSA9IHRyYW5zY2VpdmVyLnN0cmVhbTtcblxuICAgIHRyYW5zY2VpdmVyLnJ0cFNlbmRlci5zdG9wKCk7XG4gICAgdHJhbnNjZWl2ZXIucnRwU2VuZGVyID0gbnVsbDtcbiAgICB0cmFuc2NlaXZlci50cmFjayA9IG51bGw7XG4gICAgdHJhbnNjZWl2ZXIuc3RyZWFtID0gbnVsbDtcblxuICAgIC8vIHJlbW92ZSB0aGUgc3RyZWFtIGZyb20gdGhlIHNldCBvZiBsb2NhbCBzdHJlYW1zXG4gICAgdmFyIGxvY2FsU3RyZWFtcyA9IHRoaXMudHJhbnNjZWl2ZXJzLm1hcChmdW5jdGlvbih0KSB7XG4gICAgICByZXR1cm4gdC5zdHJlYW07XG4gICAgfSk7XG4gICAgaWYgKGxvY2FsU3RyZWFtcy5pbmRleE9mKHN0cmVhbSkgPT09IC0xICYmXG4gICAgICAgIHRoaXMubG9jYWxTdHJlYW1zLmluZGV4T2Yoc3RyZWFtKSA+IC0xKSB7XG4gICAgICB0aGlzLmxvY2FsU3RyZWFtcy5zcGxpY2UodGhpcy5sb2NhbFN0cmVhbXMuaW5kZXhPZihzdHJlYW0pLCAxKTtcbiAgICB9XG5cbiAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpO1xuICB9O1xuXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVTdHJlYW0gPSBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICB2YXIgcGMgPSB0aGlzO1xuICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7XG4gICAgICB2YXIgc2VuZGVyID0gcGMuZ2V0U2VuZGVycygpLmZpbmQoZnVuY3Rpb24ocykge1xuICAgICAgICByZXR1cm4gcy50cmFjayA9PT0gdHJhY2s7XG4gICAgICB9KTtcbiAgICAgIGlmIChzZW5kZXIpIHtcbiAgICAgICAgcGMucmVtb3ZlVHJhY2soc2VuZGVyKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U2VuZGVycyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnRyYW5zY2VpdmVycy5maWx0ZXIoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHtcbiAgICAgIHJldHVybiAhIXRyYW5zY2VpdmVyLnJ0cFNlbmRlcjtcbiAgICB9KVxuICAgIC5tYXAoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHtcbiAgICAgIHJldHVybiB0cmFuc2NlaXZlci5ydHBTZW5kZXI7XG4gICAgfSk7XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFJlY2VpdmVycyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnRyYW5zY2VpdmVycy5maWx0ZXIoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHtcbiAgICAgIHJldHVybiAhIXRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyO1xuICAgIH0pXG4gICAgLm1hcChmdW5jdGlvbih0cmFuc2NlaXZlcikge1xuICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyO1xuICAgIH0pO1xuICB9O1xuXG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9jcmVhdGVJY2VHYXRoZXJlciA9IGZ1bmN0aW9uKHNkcE1MaW5lSW5kZXgsXG4gICAgICB1c2luZ0J1bmRsZSkge1xuICAgIHZhciBwYyA9IHRoaXM7XG4gICAgaWYgKHVzaW5nQnVuZGxlICYmIHNkcE1MaW5lSW5kZXggPiAwKSB7XG4gICAgICByZXR1cm4gdGhpcy50cmFuc2NlaXZlcnNbMF0uaWNlR2F0aGVyZXI7XG4gICAgfSBlbHNlIGlmICh0aGlzLl9pY2VHYXRoZXJlcnMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gdGhpcy5faWNlR2F0aGVyZXJzLnNoaWZ0KCk7XG4gICAgfVxuICAgIHZhciBpY2VHYXRoZXJlciA9IG5ldyB3aW5kb3cuUlRDSWNlR2F0aGVyZXIoe1xuICAgICAgaWNlU2VydmVyczogdGhpcy5fY29uZmlnLmljZVNlcnZlcnMsXG4gICAgICBnYXRoZXJQb2xpY3k6IHRoaXMuX2NvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3lcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaWNlR2F0aGVyZXIsICdzdGF0ZScsXG4gICAgICAgIHt2YWx1ZTogJ25ldycsIHdyaXRhYmxlOiB0cnVlfVxuICAgICk7XG5cbiAgICB0aGlzLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5idWZmZXJlZENhbmRpZGF0ZUV2ZW50cyA9IFtdO1xuICAgIHRoaXMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLmJ1ZmZlckNhbmRpZGF0ZXMgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgdmFyIGVuZCA9ICFldmVudC5jYW5kaWRhdGUgfHwgT2JqZWN0LmtleXMoZXZlbnQuY2FuZGlkYXRlKS5sZW5ndGggPT09IDA7XG4gICAgICAvLyBwb2x5ZmlsbCBzaW5jZSBSVENJY2VHYXRoZXJlci5zdGF0ZSBpcyBub3QgaW1wbGVtZW50ZWQgaW5cbiAgICAgIC8vIEVkZ2UgMTA1NDcgeWV0LlxuICAgICAgaWNlR2F0aGVyZXIuc3RhdGUgPSBlbmQgPyAnY29tcGxldGVkJyA6ICdnYXRoZXJpbmcnO1xuICAgICAgaWYgKHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5idWZmZXJlZENhbmRpZGF0ZUV2ZW50cyAhPT0gbnVsbCkge1xuICAgICAgICBwYy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uYnVmZmVyZWRDYW5kaWRhdGVFdmVudHMucHVzaChldmVudCk7XG4gICAgICB9XG4gICAgfTtcbiAgICBpY2VHYXRoZXJlci5hZGRFdmVudExpc3RlbmVyKCdsb2NhbGNhbmRpZGF0ZScsXG4gICAgICB0aGlzLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5idWZmZXJDYW5kaWRhdGVzKTtcbiAgICByZXR1cm4gaWNlR2F0aGVyZXI7XG4gIH07XG5cbiAgLy8gc3RhcnQgZ2F0aGVyaW5nIGZyb20gYW4gUlRDSWNlR2F0aGVyZXIuXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fZ2F0aGVyID0gZnVuY3Rpb24obWlkLCBzZHBNTGluZUluZGV4KSB7XG4gICAgdmFyIHBjID0gdGhpcztcbiAgICB2YXIgaWNlR2F0aGVyZXIgPSB0aGlzLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5pY2VHYXRoZXJlcjtcbiAgICBpZiAoaWNlR2F0aGVyZXIub25sb2NhbGNhbmRpZGF0ZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgYnVmZmVyZWRDYW5kaWRhdGVFdmVudHMgPVxuICAgICAgdGhpcy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uYnVmZmVyZWRDYW5kaWRhdGVFdmVudHM7XG4gICAgdGhpcy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uYnVmZmVyZWRDYW5kaWRhdGVFdmVudHMgPSBudWxsO1xuICAgIGljZUdhdGhlcmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2xvY2FsY2FuZGlkYXRlJyxcbiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLmJ1ZmZlckNhbmRpZGF0ZXMpO1xuICAgIGljZUdhdGhlcmVyLm9ubG9jYWxjYW5kaWRhdGUgPSBmdW5jdGlvbihldnQpIHtcbiAgICAgIGlmIChwYy51c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCkge1xuICAgICAgICAvLyBpZiB3ZSBrbm93IHRoYXQgd2UgdXNlIGJ1bmRsZSB3ZSBjYW4gZHJvcCBjYW5kaWRhdGVzIHdpdGhcbiAgICAgICAgLy8g0ZVkcE1MaW5lSW5kZXggPiAwLiBJZiB3ZSBkb24ndCBkbyB0aGlzIHRoZW4gb3VyIHN0YXRlIGdldHNcbiAgICAgICAgLy8gY29uZnVzZWQgc2luY2Ugd2UgZGlzcG9zZSB0aGUgZXh0cmEgaWNlIGdhdGhlcmVyLlxuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ2ljZWNhbmRpZGF0ZScpO1xuICAgICAgZXZlbnQuY2FuZGlkYXRlID0ge3NkcE1pZDogbWlkLCBzZHBNTGluZUluZGV4OiBzZHBNTGluZUluZGV4fTtcblxuICAgICAgdmFyIGNhbmQgPSBldnQuY2FuZGlkYXRlO1xuICAgICAgLy8gRWRnZSBlbWl0cyBhbiBlbXB0eSBvYmplY3QgZm9yIFJUQ0ljZUNhbmRpZGF0ZUNvbXBsZXRl4oClXG4gICAgICB2YXIgZW5kID0gIWNhbmQgfHwgT2JqZWN0LmtleXMoY2FuZCkubGVuZ3RoID09PSAwO1xuICAgICAgaWYgKGVuZCkge1xuICAgICAgICAvLyBwb2x5ZmlsbCBzaW5jZSBSVENJY2VHYXRoZXJlci5zdGF0ZSBpcyBub3QgaW1wbGVtZW50ZWQgaW5cbiAgICAgICAgLy8gRWRnZSAxMDU0NyB5ZXQuXG4gICAgICAgIGlmIChpY2VHYXRoZXJlci5zdGF0ZSA9PT0gJ25ldycgfHwgaWNlR2F0aGVyZXIuc3RhdGUgPT09ICdnYXRoZXJpbmcnKSB7XG4gICAgICAgICAgaWNlR2F0aGVyZXIuc3RhdGUgPSAnY29tcGxldGVkJztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGljZUdhdGhlcmVyLnN0YXRlID09PSAnbmV3Jykge1xuICAgICAgICAgIGljZUdhdGhlcmVyLnN0YXRlID0gJ2dhdGhlcmluZyc7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUlRDSWNlQ2FuZGlkYXRlIGRvZXNuJ3QgaGF2ZSBhIGNvbXBvbmVudCwgbmVlZHMgdG8gYmUgYWRkZWRcbiAgICAgICAgY2FuZC5jb21wb25lbnQgPSAxO1xuICAgICAgICAvLyBhbHNvIHRoZSB1c2VybmFtZUZyYWdtZW50LiBUT0RPOiB1cGRhdGUgU0RQIHRvIHRha2UgYm90aCB2YXJpYW50cy5cbiAgICAgICAgY2FuZC51ZnJhZyA9IGljZUdhdGhlcmVyLmdldExvY2FsUGFyYW1ldGVycygpLnVzZXJuYW1lRnJhZ21lbnQ7XG5cbiAgICAgICAgdmFyIHNlcmlhbGl6ZWRDYW5kaWRhdGUgPSBTRFBVdGlscy53cml0ZUNhbmRpZGF0ZShjYW5kKTtcbiAgICAgICAgZXZlbnQuY2FuZGlkYXRlID0gT2JqZWN0LmFzc2lnbihldmVudC5jYW5kaWRhdGUsXG4gICAgICAgICAgICBTRFBVdGlscy5wYXJzZUNhbmRpZGF0ZShzZXJpYWxpemVkQ2FuZGlkYXRlKSk7XG5cbiAgICAgICAgZXZlbnQuY2FuZGlkYXRlLmNhbmRpZGF0ZSA9IHNlcmlhbGl6ZWRDYW5kaWRhdGU7XG4gICAgICAgIGV2ZW50LmNhbmRpZGF0ZS50b0pTT04gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2FuZGlkYXRlOiBldmVudC5jYW5kaWRhdGUuY2FuZGlkYXRlLFxuICAgICAgICAgICAgc2RwTWlkOiBldmVudC5jYW5kaWRhdGUuc2RwTWlkLFxuICAgICAgICAgICAgc2RwTUxpbmVJbmRleDogZXZlbnQuY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXgsXG4gICAgICAgICAgICB1c2VybmFtZUZyYWdtZW50OiBldmVudC5jYW5kaWRhdGUudXNlcm5hbWVGcmFnbWVudFxuICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIHVwZGF0ZSBsb2NhbCBkZXNjcmlwdGlvbi5cbiAgICAgIHZhciBzZWN0aW9ucyA9IFNEUFV0aWxzLmdldE1lZGlhU2VjdGlvbnMocGMuX2xvY2FsRGVzY3JpcHRpb24uc2RwKTtcbiAgICAgIGlmICghZW5kKSB7XG4gICAgICAgIHNlY3Rpb25zW2V2ZW50LmNhbmRpZGF0ZS5zZHBNTGluZUluZGV4XSArPVxuICAgICAgICAgICAgJ2E9JyArIGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUgKyAnXFxyXFxuJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlY3Rpb25zW2V2ZW50LmNhbmRpZGF0ZS5zZHBNTGluZUluZGV4XSArPVxuICAgICAgICAgICAgJ2E9ZW5kLW9mLWNhbmRpZGF0ZXNcXHJcXG4nO1xuICAgICAgfVxuICAgICAgcGMuX2xvY2FsRGVzY3JpcHRpb24uc2RwID1cbiAgICAgICAgICBTRFBVdGlscy5nZXREZXNjcmlwdGlvbihwYy5fbG9jYWxEZXNjcmlwdGlvbi5zZHApICtcbiAgICAgICAgICBzZWN0aW9ucy5qb2luKCcnKTtcbiAgICAgIHZhciBjb21wbGV0ZSA9IHBjLnRyYW5zY2VpdmVycy5ldmVyeShmdW5jdGlvbih0cmFuc2NlaXZlcikge1xuICAgICAgICByZXR1cm4gdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIgJiZcbiAgICAgICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLnN0YXRlID09PSAnY29tcGxldGVkJztcbiAgICAgIH0pO1xuXG4gICAgICBpZiAocGMuaWNlR2F0aGVyaW5nU3RhdGUgIT09ICdnYXRoZXJpbmcnKSB7XG4gICAgICAgIHBjLmljZUdhdGhlcmluZ1N0YXRlID0gJ2dhdGhlcmluZyc7XG4gICAgICAgIHBjLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UoKTtcbiAgICAgIH1cblxuICAgICAgLy8gRW1pdCBjYW5kaWRhdGUuIEFsc28gZW1pdCBudWxsIGNhbmRpZGF0ZSB3aGVuIGFsbCBnYXRoZXJlcnMgYXJlXG4gICAgICAvLyBjb21wbGV0ZS5cbiAgICAgIGlmICghZW5kKSB7XG4gICAgICAgIHBjLl9kaXNwYXRjaEV2ZW50KCdpY2VjYW5kaWRhdGUnLCBldmVudCk7XG4gICAgICB9XG4gICAgICBpZiAoY29tcGxldGUpIHtcbiAgICAgICAgcGMuX2Rpc3BhdGNoRXZlbnQoJ2ljZWNhbmRpZGF0ZScsIG5ldyBFdmVudCgnaWNlY2FuZGlkYXRlJykpO1xuICAgICAgICBwYy5pY2VHYXRoZXJpbmdTdGF0ZSA9ICdjb21wbGV0ZSc7XG4gICAgICAgIHBjLl9lbWl0R2F0aGVyaW5nU3RhdGVDaGFuZ2UoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gZW1pdCBhbHJlYWR5IGdhdGhlcmVkIGNhbmRpZGF0ZXMuXG4gICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBidWZmZXJlZENhbmRpZGF0ZUV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWNlR2F0aGVyZXIub25sb2NhbGNhbmRpZGF0ZShlKTtcbiAgICAgIH0pO1xuICAgIH0sIDApO1xuICB9O1xuXG4gIC8vIENyZWF0ZSBJQ0UgdHJhbnNwb3J0IGFuZCBEVExTIHRyYW5zcG9ydC5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9jcmVhdGVJY2VBbmREdGxzVHJhbnNwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwYyA9IHRoaXM7XG4gICAgdmFyIGljZVRyYW5zcG9ydCA9IG5ldyB3aW5kb3cuUlRDSWNlVHJhbnNwb3J0KG51bGwpO1xuICAgIGljZVRyYW5zcG9ydC5vbmljZXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICBwYy5fdXBkYXRlSWNlQ29ubmVjdGlvblN0YXRlKCk7XG4gICAgICBwYy5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7XG4gICAgfTtcblxuICAgIHZhciBkdGxzVHJhbnNwb3J0ID0gbmV3IHdpbmRvdy5SVENEdGxzVHJhbnNwb3J0KGljZVRyYW5zcG9ydCk7XG4gICAgZHRsc1RyYW5zcG9ydC5vbmR0bHNzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcGMuX3VwZGF0ZUNvbm5lY3Rpb25TdGF0ZSgpO1xuICAgIH07XG4gICAgZHRsc1RyYW5zcG9ydC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAvLyBvbmVycm9yIGRvZXMgbm90IHNldCBzdGF0ZSB0byBmYWlsZWQgYnkgaXRzZWxmLlxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGR0bHNUcmFuc3BvcnQsICdzdGF0ZScsXG4gICAgICAgICAge3ZhbHVlOiAnZmFpbGVkJywgd3JpdGFibGU6IHRydWV9KTtcbiAgICAgIHBjLl91cGRhdGVDb25uZWN0aW9uU3RhdGUoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGljZVRyYW5zcG9ydDogaWNlVHJhbnNwb3J0LFxuICAgICAgZHRsc1RyYW5zcG9ydDogZHRsc1RyYW5zcG9ydFxuICAgIH07XG4gIH07XG5cbiAgLy8gRGVzdHJveSBJQ0UgZ2F0aGVyZXIsIElDRSB0cmFuc3BvcnQgYW5kIERUTFMgdHJhbnNwb3J0LlxuICAvLyBXaXRob3V0IHRyaWdnZXJpbmcgdGhlIGNhbGxiYWNrcy5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9kaXNwb3NlSWNlQW5kRHRsc1RyYW5zcG9ydHMgPSBmdW5jdGlvbihcbiAgICAgIHNkcE1MaW5lSW5kZXgpIHtcbiAgICB2YXIgaWNlR2F0aGVyZXIgPSB0aGlzLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5pY2VHYXRoZXJlcjtcbiAgICBpZiAoaWNlR2F0aGVyZXIpIHtcbiAgICAgIGRlbGV0ZSBpY2VHYXRoZXJlci5vbmxvY2FsY2FuZGlkYXRlO1xuICAgICAgZGVsZXRlIHRoaXMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLmljZUdhdGhlcmVyO1xuICAgIH1cbiAgICB2YXIgaWNlVHJhbnNwb3J0ID0gdGhpcy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uaWNlVHJhbnNwb3J0O1xuICAgIGlmIChpY2VUcmFuc3BvcnQpIHtcbiAgICAgIGRlbGV0ZSBpY2VUcmFuc3BvcnQub25pY2VzdGF0ZWNoYW5nZTtcbiAgICAgIGRlbGV0ZSB0aGlzLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5pY2VUcmFuc3BvcnQ7XG4gICAgfVxuICAgIHZhciBkdGxzVHJhbnNwb3J0ID0gdGhpcy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uZHRsc1RyYW5zcG9ydDtcbiAgICBpZiAoZHRsc1RyYW5zcG9ydCkge1xuICAgICAgZGVsZXRlIGR0bHNUcmFuc3BvcnQub25kdGxzc3RhdGVjaGFuZ2U7XG4gICAgICBkZWxldGUgZHRsc1RyYW5zcG9ydC5vbmVycm9yO1xuICAgICAgZGVsZXRlIHRoaXMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLmR0bHNUcmFuc3BvcnQ7XG4gICAgfVxuICB9O1xuXG4gIC8vIFN0YXJ0IHRoZSBSVFAgU2VuZGVyIGFuZCBSZWNlaXZlciBmb3IgYSB0cmFuc2NlaXZlci5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl90cmFuc2NlaXZlID0gZnVuY3Rpb24odHJhbnNjZWl2ZXIsXG4gICAgICBzZW5kLCByZWN2KSB7XG4gICAgdmFyIHBhcmFtcyA9IGdldENvbW1vbkNhcGFiaWxpdGllcyh0cmFuc2NlaXZlci5sb2NhbENhcGFiaWxpdGllcyxcbiAgICAgICAgdHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzKTtcbiAgICBpZiAoc2VuZCAmJiB0cmFuc2NlaXZlci5ydHBTZW5kZXIpIHtcbiAgICAgIHBhcmFtcy5lbmNvZGluZ3MgPSB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzO1xuICAgICAgcGFyYW1zLnJ0Y3AgPSB7XG4gICAgICAgIGNuYW1lOiBTRFBVdGlscy5sb2NhbENOYW1lLFxuICAgICAgICBjb21wb3VuZDogdHJhbnNjZWl2ZXIucnRjcFBhcmFtZXRlcnMuY29tcG91bmRcbiAgICAgIH07XG4gICAgICBpZiAodHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycy5sZW5ndGgpIHtcbiAgICAgICAgcGFyYW1zLnJ0Y3Auc3NyYyA9IHRyYW5zY2VpdmVyLnJlY3ZFbmNvZGluZ1BhcmFtZXRlcnNbMF0uc3NyYztcbiAgICAgIH1cbiAgICAgIHRyYW5zY2VpdmVyLnJ0cFNlbmRlci5zZW5kKHBhcmFtcyk7XG4gICAgfVxuICAgIGlmIChyZWN2ICYmIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyICYmIHBhcmFtcy5jb2RlY3MubGVuZ3RoID4gMCkge1xuICAgICAgLy8gcmVtb3ZlIFJUWCBmaWVsZCBpbiBFZGdlIDE0OTQyXG4gICAgICBpZiAodHJhbnNjZWl2ZXIua2luZCA9PT0gJ3ZpZGVvJ1xuICAgICAgICAgICYmIHRyYW5zY2VpdmVyLnJlY3ZFbmNvZGluZ1BhcmFtZXRlcnNcbiAgICAgICAgICAmJiBlZGdlVmVyc2lvbiA8IDE1MDE5KSB7XG4gICAgICAgIHRyYW5zY2VpdmVyLnJlY3ZFbmNvZGluZ1BhcmFtZXRlcnMuZm9yRWFjaChmdW5jdGlvbihwKSB7XG4gICAgICAgICAgZGVsZXRlIHAucnR4O1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh0cmFuc2NlaXZlci5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzLmxlbmd0aCkge1xuICAgICAgICBwYXJhbXMuZW5jb2RpbmdzID0gdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcmFtcy5lbmNvZGluZ3MgPSBbe31dO1xuICAgICAgfVxuICAgICAgcGFyYW1zLnJ0Y3AgPSB7XG4gICAgICAgIGNvbXBvdW5kOiB0cmFuc2NlaXZlci5ydGNwUGFyYW1ldGVycy5jb21wb3VuZFxuICAgICAgfTtcbiAgICAgIGlmICh0cmFuc2NlaXZlci5ydGNwUGFyYW1ldGVycy5jbmFtZSkge1xuICAgICAgICBwYXJhbXMucnRjcC5jbmFtZSA9IHRyYW5zY2VpdmVyLnJ0Y3BQYXJhbWV0ZXJzLmNuYW1lO1xuICAgICAgfVxuICAgICAgaWYgKHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoKSB7XG4gICAgICAgIHBhcmFtcy5ydGNwLnNzcmMgPSB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnNzcmM7XG4gICAgICB9XG4gICAgICB0cmFuc2NlaXZlci5ydHBSZWNlaXZlci5yZWNlaXZlKHBhcmFtcyk7XG4gICAgfVxuICB9O1xuXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXRMb2NhbERlc2NyaXB0aW9uID0gZnVuY3Rpb24oZGVzY3JpcHRpb24pIHtcbiAgICB2YXIgcGMgPSB0aGlzO1xuXG4gICAgLy8gTm90ZTogcHJhbnN3ZXIgaXMgbm90IHN1cHBvcnRlZC5cbiAgICBpZiAoWydvZmZlcicsICdhbnN3ZXInXS5pbmRleE9mKGRlc2NyaXB0aW9uLnR5cGUpID09PSAtMSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG1ha2VFcnJvcignVHlwZUVycm9yJyxcbiAgICAgICAgICAnVW5zdXBwb3J0ZWQgdHlwZSBcIicgKyBkZXNjcmlwdGlvbi50eXBlICsgJ1wiJykpO1xuICAgIH1cblxuICAgIGlmICghaXNBY3Rpb25BbGxvd2VkSW5TaWduYWxpbmdTdGF0ZSgnc2V0TG9jYWxEZXNjcmlwdGlvbicsXG4gICAgICAgIGRlc2NyaXB0aW9uLnR5cGUsIHBjLnNpZ25hbGluZ1N0YXRlKSB8fCBwYy5faXNDbG9zZWQpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChtYWtlRXJyb3IoJ0ludmFsaWRTdGF0ZUVycm9yJyxcbiAgICAgICAgICAnQ2FuIG5vdCBzZXQgbG9jYWwgJyArIGRlc2NyaXB0aW9uLnR5cGUgK1xuICAgICAgICAgICcgaW4gc3RhdGUgJyArIHBjLnNpZ25hbGluZ1N0YXRlKSk7XG4gICAgfVxuXG4gICAgdmFyIHNlY3Rpb25zO1xuICAgIHZhciBzZXNzaW9ucGFydDtcbiAgICBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ29mZmVyJykge1xuICAgICAgLy8gVkVSWSBsaW1pdGVkIHN1cHBvcnQgZm9yIFNEUCBtdW5naW5nLiBMaW1pdGVkIHRvOlxuICAgICAgLy8gKiBjaGFuZ2luZyB0aGUgb3JkZXIgb2YgY29kZWNzXG4gICAgICBzZWN0aW9ucyA9IFNEUFV0aWxzLnNwbGl0U2VjdGlvbnMoZGVzY3JpcHRpb24uc2RwKTtcbiAgICAgIHNlc3Npb25wYXJ0ID0gc2VjdGlvbnMuc2hpZnQoKTtcbiAgICAgIHNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZHBNTGluZUluZGV4KSB7XG4gICAgICAgIHZhciBjYXBzID0gU0RQVXRpbHMucGFyc2VSdHBQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7XG4gICAgICAgIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5sb2NhbENhcGFiaWxpdGllcyA9IGNhcHM7XG4gICAgICB9KTtcblxuICAgICAgcGMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIsIHNkcE1MaW5lSW5kZXgpIHtcbiAgICAgICAgcGMuX2dhdGhlcih0cmFuc2NlaXZlci5taWQsIHNkcE1MaW5lSW5kZXgpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnYW5zd2VyJykge1xuICAgICAgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKHBjLl9yZW1vdGVEZXNjcmlwdGlvbi5zZHApO1xuICAgICAgc2Vzc2lvbnBhcnQgPSBzZWN0aW9ucy5zaGlmdCgpO1xuICAgICAgdmFyIGlzSWNlTGl0ZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LFxuICAgICAgICAgICdhPWljZS1saXRlJykubGVuZ3RoID4gMDtcbiAgICAgIHNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZHBNTGluZUluZGV4KSB7XG4gICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XTtcbiAgICAgICAgdmFyIGljZUdhdGhlcmVyID0gdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXI7XG4gICAgICAgIHZhciBpY2VUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQ7XG4gICAgICAgIHZhciBkdGxzVHJhbnNwb3J0ID0gdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydDtcbiAgICAgICAgdmFyIGxvY2FsQ2FwYWJpbGl0aWVzID0gdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXM7XG4gICAgICAgIHZhciByZW1vdGVDYXBhYmlsaXRpZXMgPSB0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXM7XG5cbiAgICAgICAgLy8gdHJlYXQgYnVuZGxlLW9ubHkgYXMgbm90LXJlamVjdGVkLlxuICAgICAgICB2YXIgcmVqZWN0ZWQgPSBTRFBVdGlscy5pc1JlamVjdGVkKG1lZGlhU2VjdGlvbikgJiZcbiAgICAgICAgICAgIFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiwgJ2E9YnVuZGxlLW9ubHknKS5sZW5ndGggPT09IDA7XG5cbiAgICAgICAgaWYgKCFyZWplY3RlZCAmJiAhdHJhbnNjZWl2ZXIucmVqZWN0ZWQpIHtcbiAgICAgICAgICB2YXIgcmVtb3RlSWNlUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldEljZVBhcmFtZXRlcnMoXG4gICAgICAgICAgICAgIG1lZGlhU2VjdGlvbiwgc2Vzc2lvbnBhcnQpO1xuICAgICAgICAgIHZhciByZW1vdGVEdGxzUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzKFxuICAgICAgICAgICAgICBtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KTtcbiAgICAgICAgICBpZiAoaXNJY2VMaXRlKSB7XG4gICAgICAgICAgICByZW1vdGVEdGxzUGFyYW1ldGVycy5yb2xlID0gJ3NlcnZlcic7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCFwYy51c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICBwYy5fZ2F0aGVyKHRyYW5zY2VpdmVyLm1pZCwgc2RwTUxpbmVJbmRleCk7XG4gICAgICAgICAgICBpZiAoaWNlVHJhbnNwb3J0LnN0YXRlID09PSAnbmV3Jykge1xuICAgICAgICAgICAgICBpY2VUcmFuc3BvcnQuc3RhcnQoaWNlR2F0aGVyZXIsIHJlbW90ZUljZVBhcmFtZXRlcnMsXG4gICAgICAgICAgICAgICAgICBpc0ljZUxpdGUgPyAnY29udHJvbGxpbmcnIDogJ2NvbnRyb2xsZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkdGxzVHJhbnNwb3J0LnN0YXRlID09PSAnbmV3Jykge1xuICAgICAgICAgICAgICBkdGxzVHJhbnNwb3J0LnN0YXJ0KHJlbW90ZUR0bHNQYXJhbWV0ZXJzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBDYWxjdWxhdGUgaW50ZXJzZWN0aW9uIG9mIGNhcGFiaWxpdGllcy5cbiAgICAgICAgICB2YXIgcGFyYW1zID0gZ2V0Q29tbW9uQ2FwYWJpbGl0aWVzKGxvY2FsQ2FwYWJpbGl0aWVzLFxuICAgICAgICAgICAgICByZW1vdGVDYXBhYmlsaXRpZXMpO1xuXG4gICAgICAgICAgLy8gU3RhcnQgdGhlIFJUQ1J0cFNlbmRlci4gVGhlIFJUQ1J0cFJlY2VpdmVyIGZvciB0aGlzXG4gICAgICAgICAgLy8gdHJhbnNjZWl2ZXIgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIGluIHNldFJlbW90ZURlc2NyaXB0aW9uLlxuICAgICAgICAgIHBjLl90cmFuc2NlaXZlKHRyYW5zY2VpdmVyLFxuICAgICAgICAgICAgICBwYXJhbXMuY29kZWNzLmxlbmd0aCA+IDAsXG4gICAgICAgICAgICAgIGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcGMuX2xvY2FsRGVzY3JpcHRpb24gPSB7XG4gICAgICB0eXBlOiBkZXNjcmlwdGlvbi50eXBlLFxuICAgICAgc2RwOiBkZXNjcmlwdGlvbi5zZHBcbiAgICB9O1xuICAgIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnb2ZmZXInKSB7XG4gICAgICBwYy5fdXBkYXRlU2lnbmFsaW5nU3RhdGUoJ2hhdmUtbG9jYWwtb2ZmZXInKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdzdGFibGUnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldFJlbW90ZURlc2NyaXB0aW9uID0gZnVuY3Rpb24oZGVzY3JpcHRpb24pIHtcbiAgICB2YXIgcGMgPSB0aGlzO1xuXG4gICAgLy8gTm90ZTogcHJhbnN3ZXIgaXMgbm90IHN1cHBvcnRlZC5cbiAgICBpZiAoWydvZmZlcicsICdhbnN3ZXInXS5pbmRleE9mKGRlc2NyaXB0aW9uLnR5cGUpID09PSAtMSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG1ha2VFcnJvcignVHlwZUVycm9yJyxcbiAgICAgICAgICAnVW5zdXBwb3J0ZWQgdHlwZSBcIicgKyBkZXNjcmlwdGlvbi50eXBlICsgJ1wiJykpO1xuICAgIH1cblxuICAgIGlmICghaXNBY3Rpb25BbGxvd2VkSW5TaWduYWxpbmdTdGF0ZSgnc2V0UmVtb3RlRGVzY3JpcHRpb24nLFxuICAgICAgICBkZXNjcmlwdGlvbi50eXBlLCBwYy5zaWduYWxpbmdTdGF0ZSkgfHwgcGMuX2lzQ2xvc2VkKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobWFrZUVycm9yKCdJbnZhbGlkU3RhdGVFcnJvcicsXG4gICAgICAgICAgJ0NhbiBub3Qgc2V0IHJlbW90ZSAnICsgZGVzY3JpcHRpb24udHlwZSArXG4gICAgICAgICAgJyBpbiBzdGF0ZSAnICsgcGMuc2lnbmFsaW5nU3RhdGUpKTtcbiAgICB9XG5cbiAgICB2YXIgc3RyZWFtcyA9IHt9O1xuICAgIHBjLnJlbW90ZVN0cmVhbXMuZm9yRWFjaChmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgIHN0cmVhbXNbc3RyZWFtLmlkXSA9IHN0cmVhbTtcbiAgICB9KTtcbiAgICB2YXIgcmVjZWl2ZXJMaXN0ID0gW107XG4gICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhkZXNjcmlwdGlvbi5zZHApO1xuICAgIHZhciBzZXNzaW9ucGFydCA9IHNlY3Rpb25zLnNoaWZ0KCk7XG4gICAgdmFyIGlzSWNlTGl0ZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LFxuICAgICAgICAnYT1pY2UtbGl0ZScpLmxlbmd0aCA+IDA7XG4gICAgdmFyIHVzaW5nQnVuZGxlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgoc2Vzc2lvbnBhcnQsXG4gICAgICAgICdhPWdyb3VwOkJVTkRMRSAnKS5sZW5ndGggPiAwO1xuICAgIHBjLnVzaW5nQnVuZGxlID0gdXNpbmdCdW5kbGU7XG4gICAgdmFyIGljZU9wdGlvbnMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChzZXNzaW9ucGFydCxcbiAgICAgICAgJ2E9aWNlLW9wdGlvbnM6JylbMF07XG4gICAgaWYgKGljZU9wdGlvbnMpIHtcbiAgICAgIHBjLmNhblRyaWNrbGVJY2VDYW5kaWRhdGVzID0gaWNlT3B0aW9ucy5zdWJzdHIoMTQpLnNwbGl0KCcgJylcbiAgICAgICAgICAuaW5kZXhPZigndHJpY2tsZScpID49IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBjLmNhblRyaWNrbGVJY2VDYW5kaWRhdGVzID0gZmFsc2U7XG4gICAgfVxuXG4gICAgc2VjdGlvbnMuZm9yRWFjaChmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNkcE1MaW5lSW5kZXgpIHtcbiAgICAgIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTtcbiAgICAgIHZhciBraW5kID0gU0RQVXRpbHMuZ2V0S2luZChtZWRpYVNlY3Rpb24pO1xuICAgICAgLy8gdHJlYXQgYnVuZGxlLW9ubHkgYXMgbm90LXJlamVjdGVkLlxuICAgICAgdmFyIHJlamVjdGVkID0gU0RQVXRpbHMuaXNSZWplY3RlZChtZWRpYVNlY3Rpb24pICYmXG4gICAgICAgICAgU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1idW5kbGUtb25seScpLmxlbmd0aCA9PT0gMDtcbiAgICAgIHZhciBwcm90b2NvbCA9IGxpbmVzWzBdLnN1YnN0cigyKS5zcGxpdCgnICcpWzJdO1xuXG4gICAgICB2YXIgZGlyZWN0aW9uID0gU0RQVXRpbHMuZ2V0RGlyZWN0aW9uKG1lZGlhU2VjdGlvbiwgc2Vzc2lvbnBhcnQpO1xuICAgICAgdmFyIHJlbW90ZU1zaWQgPSBTRFBVdGlscy5wYXJzZU1zaWQobWVkaWFTZWN0aW9uKTtcblxuICAgICAgdmFyIG1pZCA9IFNEUFV0aWxzLmdldE1pZChtZWRpYVNlY3Rpb24pIHx8IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpO1xuXG4gICAgICAvLyBSZWplY3QgZGF0YWNoYW5uZWxzIHdoaWNoIGFyZSBub3QgaW1wbGVtZW50ZWQgeWV0LlxuICAgICAgaWYgKHJlamVjdGVkIHx8IChraW5kID09PSAnYXBwbGljYXRpb24nICYmIChwcm90b2NvbCA9PT0gJ0RUTFMvU0NUUCcgfHxcbiAgICAgICAgICBwcm90b2NvbCA9PT0gJ1VEUC9EVExTL1NDVFAnKSkpIHtcbiAgICAgICAgLy8gVE9ETzogdGhpcyBpcyBkYW5nZXJvdXMgaW4gdGhlIGNhc2Ugd2hlcmUgYSBub24tcmVqZWN0ZWQgbS1saW5lXG4gICAgICAgIC8vICAgICBiZWNvbWVzIHJlamVjdGVkLlxuICAgICAgICBwYy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0gPSB7XG4gICAgICAgICAgbWlkOiBtaWQsXG4gICAgICAgICAga2luZDoga2luZCxcbiAgICAgICAgICBwcm90b2NvbDogcHJvdG9jb2wsXG4gICAgICAgICAgcmVqZWN0ZWQ6IHRydWVcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXJlamVjdGVkICYmIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSAmJlxuICAgICAgICAgIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZWplY3RlZCkge1xuICAgICAgICAvLyByZWN5Y2xlIGEgcmVqZWN0ZWQgdHJhbnNjZWl2ZXIuXG4gICAgICAgIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHBjLl9jcmVhdGVUcmFuc2NlaXZlcihraW5kLCB0cnVlKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHRyYW5zY2VpdmVyO1xuICAgICAgdmFyIGljZUdhdGhlcmVyO1xuICAgICAgdmFyIGljZVRyYW5zcG9ydDtcbiAgICAgIHZhciBkdGxzVHJhbnNwb3J0O1xuICAgICAgdmFyIHJ0cFJlY2VpdmVyO1xuICAgICAgdmFyIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7XG4gICAgICB2YXIgcmVjdkVuY29kaW5nUGFyYW1ldGVycztcbiAgICAgIHZhciBsb2NhbENhcGFiaWxpdGllcztcblxuICAgICAgdmFyIHRyYWNrO1xuICAgICAgLy8gRklYTUU6IGVuc3VyZSB0aGUgbWVkaWFTZWN0aW9uIGhhcyBydGNwLW11eCBzZXQuXG4gICAgICB2YXIgcmVtb3RlQ2FwYWJpbGl0aWVzID0gU0RQVXRpbHMucGFyc2VSdHBQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7XG4gICAgICB2YXIgcmVtb3RlSWNlUGFyYW1ldGVycztcbiAgICAgIHZhciByZW1vdGVEdGxzUGFyYW1ldGVycztcbiAgICAgIGlmICghcmVqZWN0ZWQpIHtcbiAgICAgICAgcmVtb3RlSWNlUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldEljZVBhcmFtZXRlcnMobWVkaWFTZWN0aW9uLFxuICAgICAgICAgICAgc2Vzc2lvbnBhcnQpO1xuICAgICAgICByZW1vdGVEdGxzUGFyYW1ldGVycyA9IFNEUFV0aWxzLmdldER0bHNQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbixcbiAgICAgICAgICAgIHNlc3Npb25wYXJ0KTtcbiAgICAgICAgcmVtb3RlRHRsc1BhcmFtZXRlcnMucm9sZSA9ICdjbGllbnQnO1xuICAgICAgfVxuICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVycyA9XG4gICAgICAgICAgU0RQVXRpbHMucGFyc2VSdHBFbmNvZGluZ1BhcmFtZXRlcnMobWVkaWFTZWN0aW9uKTtcblxuICAgICAgdmFyIHJ0Y3BQYXJhbWV0ZXJzID0gU0RQVXRpbHMucGFyc2VSdGNwUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24pO1xuXG4gICAgICB2YXIgaXNDb21wbGV0ZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbixcbiAgICAgICAgICAnYT1lbmQtb2YtY2FuZGlkYXRlcycsIHNlc3Npb25wYXJ0KS5sZW5ndGggPiAwO1xuICAgICAgdmFyIGNhbmRzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1jYW5kaWRhdGU6JylcbiAgICAgICAgICAubWFwKGZ1bmN0aW9uKGNhbmQpIHtcbiAgICAgICAgICAgIHJldHVybiBTRFBVdGlscy5wYXJzZUNhbmRpZGF0ZShjYW5kKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24oY2FuZCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhbmQuY29tcG9uZW50ID09PSAxO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAvLyBDaGVjayBpZiB3ZSBjYW4gdXNlIEJVTkRMRSBhbmQgZGlzcG9zZSB0cmFuc3BvcnRzLlxuICAgICAgaWYgKChkZXNjcmlwdGlvbi50eXBlID09PSAnb2ZmZXInIHx8IGRlc2NyaXB0aW9uLnR5cGUgPT09ICdhbnN3ZXInKSAmJlxuICAgICAgICAgICFyZWplY3RlZCAmJiB1c2luZ0J1bmRsZSAmJiBzZHBNTGluZUluZGV4ID4gMCAmJlxuICAgICAgICAgIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSkge1xuICAgICAgICBwYy5fZGlzcG9zZUljZUFuZER0bHNUcmFuc3BvcnRzKHNkcE1MaW5lSW5kZXgpO1xuICAgICAgICBwYy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uaWNlR2F0aGVyZXIgPVxuICAgICAgICAgICAgcGMudHJhbnNjZWl2ZXJzWzBdLmljZUdhdGhlcmVyO1xuICAgICAgICBwYy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uaWNlVHJhbnNwb3J0ID1cbiAgICAgICAgICAgIHBjLnRyYW5zY2VpdmVyc1swXS5pY2VUcmFuc3BvcnQ7XG4gICAgICAgIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5kdGxzVHJhbnNwb3J0ID1cbiAgICAgICAgICAgIHBjLnRyYW5zY2VpdmVyc1swXS5kdGxzVHJhbnNwb3J0O1xuICAgICAgICBpZiAocGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLnJ0cFNlbmRlcikge1xuICAgICAgICAgIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5ydHBTZW5kZXIuc2V0VHJhbnNwb3J0KFxuICAgICAgICAgICAgICBwYy50cmFuc2NlaXZlcnNbMF0uZHRsc1RyYW5zcG9ydCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5ydHBSZWNlaXZlcikge1xuICAgICAgICAgIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5ydHBSZWNlaXZlci5zZXRUcmFuc3BvcnQoXG4gICAgICAgICAgICAgIHBjLnRyYW5zY2VpdmVyc1swXS5kdGxzVHJhbnNwb3J0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGRlc2NyaXB0aW9uLnR5cGUgPT09ICdvZmZlcicgJiYgIXJlamVjdGVkKSB7XG4gICAgICAgIHRyYW5zY2VpdmVyID0gcGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdIHx8XG4gICAgICAgICAgICBwYy5fY3JlYXRlVHJhbnNjZWl2ZXIoa2luZCk7XG4gICAgICAgIHRyYW5zY2VpdmVyLm1pZCA9IG1pZDtcblxuICAgICAgICBpZiAoIXRyYW5zY2VpdmVyLmljZUdhdGhlcmVyKSB7XG4gICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIgPSBwYy5fY3JlYXRlSWNlR2F0aGVyZXIoc2RwTUxpbmVJbmRleCxcbiAgICAgICAgICAgICAgdXNpbmdCdW5kbGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNhbmRzLmxlbmd0aCAmJiB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQuc3RhdGUgPT09ICduZXcnKSB7XG4gICAgICAgICAgaWYgKGlzQ29tcGxldGUgJiYgKCF1c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSkge1xuICAgICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnNldFJlbW90ZUNhbmRpZGF0ZXMoY2FuZHMpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYW5kcy5mb3JFYWNoKGZ1bmN0aW9uKGNhbmRpZGF0ZSkge1xuICAgICAgICAgICAgICBtYXliZUFkZENhbmRpZGF0ZSh0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQsIGNhbmRpZGF0ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBsb2NhbENhcGFiaWxpdGllcyA9IHdpbmRvdy5SVENSdHBSZWNlaXZlci5nZXRDYXBhYmlsaXRpZXMoa2luZCk7XG5cbiAgICAgICAgLy8gZmlsdGVyIFJUWCB1bnRpbCBhZGRpdGlvbmFsIHN0dWZmIG5lZWRlZCBmb3IgUlRYIGlzIGltcGxlbWVudGVkXG4gICAgICAgIC8vIGluIGFkYXB0ZXIuanNcbiAgICAgICAgaWYgKGVkZ2VWZXJzaW9uIDwgMTUwMTkpIHtcbiAgICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKFxuICAgICAgICAgICAgICBmdW5jdGlvbihjb2RlYykge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb2RlYy5uYW1lICE9PSAncnR4JztcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzID0gdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVycyB8fCBbe1xuICAgICAgICAgIHNzcmM6ICgyICogc2RwTUxpbmVJbmRleCArIDIpICogMTAwMVxuICAgICAgICB9XTtcblxuICAgICAgICAvLyBUT0RPOiByZXdyaXRlIHRvIHVzZSBodHRwOi8vdzNjLmdpdGh1Yi5pby93ZWJydGMtcGMvI3NldC1hc3NvY2lhdGVkLXJlbW90ZS1zdHJlYW1zXG4gICAgICAgIHZhciBpc05ld1RyYWNrID0gZmFsc2U7XG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICdzZW5kcmVjdicgfHwgZGlyZWN0aW9uID09PSAnc2VuZG9ubHknKSB7XG4gICAgICAgICAgaXNOZXdUcmFjayA9ICF0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjtcbiAgICAgICAgICBydHBSZWNlaXZlciA9IHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyIHx8XG4gICAgICAgICAgICAgIG5ldyB3aW5kb3cuUlRDUnRwUmVjZWl2ZXIodHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydCwga2luZCk7XG5cbiAgICAgICAgICBpZiAoaXNOZXdUcmFjaykge1xuICAgICAgICAgICAgdmFyIHN0cmVhbTtcbiAgICAgICAgICAgIHRyYWNrID0gcnRwUmVjZWl2ZXIudHJhY2s7XG4gICAgICAgICAgICAvLyBGSVhNRTogZG9lcyBub3Qgd29yayB3aXRoIFBsYW4gQi5cbiAgICAgICAgICAgIGlmIChyZW1vdGVNc2lkICYmIHJlbW90ZU1zaWQuc3RyZWFtID09PSAnLScpIHtcbiAgICAgICAgICAgICAgLy8gbm8tb3AuIGEgc3RyZWFtIGlkIG9mICctJyBtZWFuczogbm8gYXNzb2NpYXRlZCBzdHJlYW0uXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlbW90ZU1zaWQpIHtcbiAgICAgICAgICAgICAgaWYgKCFzdHJlYW1zW3JlbW90ZU1zaWQuc3RyZWFtXSkge1xuICAgICAgICAgICAgICAgIHN0cmVhbXNbcmVtb3RlTXNpZC5zdHJlYW1dID0gbmV3IHdpbmRvdy5NZWRpYVN0cmVhbSgpO1xuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzdHJlYW1zW3JlbW90ZU1zaWQuc3RyZWFtXSwgJ2lkJywge1xuICAgICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbW90ZU1zaWQuc3RyZWFtO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0cmFjaywgJ2lkJywge1xuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gcmVtb3RlTXNpZC50cmFjaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBzdHJlYW0gPSBzdHJlYW1zW3JlbW90ZU1zaWQuc3RyZWFtXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlmICghc3RyZWFtcy5kZWZhdWx0KSB7XG4gICAgICAgICAgICAgICAgc3RyZWFtcy5kZWZhdWx0ID0gbmV3IHdpbmRvdy5NZWRpYVN0cmVhbSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHN0cmVhbSA9IHN0cmVhbXMuZGVmYXVsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdHJlYW0pIHtcbiAgICAgICAgICAgICAgYWRkVHJhY2tUb1N0cmVhbUFuZEZpcmVFdmVudCh0cmFjaywgc3RyZWFtKTtcbiAgICAgICAgICAgICAgdHJhbnNjZWl2ZXIuYXNzb2NpYXRlZFJlbW90ZU1lZGlhU3RyZWFtcy5wdXNoKHN0cmVhbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWNlaXZlckxpc3QucHVzaChbdHJhY2ssIHJ0cFJlY2VpdmVyLCBzdHJlYW1dKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIgJiYgdHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIudHJhY2spIHtcbiAgICAgICAgICB0cmFuc2NlaXZlci5hc3NvY2lhdGVkUmVtb3RlTWVkaWFTdHJlYW1zLmZvckVhY2goZnVuY3Rpb24ocykge1xuICAgICAgICAgICAgdmFyIG5hdGl2ZVRyYWNrID0gcy5nZXRUcmFja3MoKS5maW5kKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHQuaWQgPT09IHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnRyYWNrLmlkO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAobmF0aXZlVHJhY2spIHtcbiAgICAgICAgICAgICAgcmVtb3ZlVHJhY2tGcm9tU3RyZWFtQW5kRmlyZUV2ZW50KG5hdGl2ZVRyYWNrLCBzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0cmFuc2NlaXZlci5hc3NvY2lhdGVkUmVtb3RlTWVkaWFTdHJlYW1zID0gW107XG4gICAgICAgIH1cblxuICAgICAgICB0cmFuc2NlaXZlci5sb2NhbENhcGFiaWxpdGllcyA9IGxvY2FsQ2FwYWJpbGl0aWVzO1xuICAgICAgICB0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXMgPSByZW1vdGVDYXBhYmlsaXRpZXM7XG4gICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyID0gcnRwUmVjZWl2ZXI7XG4gICAgICAgIHRyYW5zY2VpdmVyLnJ0Y3BQYXJhbWV0ZXJzID0gcnRjcFBhcmFtZXRlcnM7XG4gICAgICAgIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnMgPSBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzO1xuICAgICAgICB0cmFuc2NlaXZlci5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID0gcmVjdkVuY29kaW5nUGFyYW1ldGVycztcblxuICAgICAgICAvLyBTdGFydCB0aGUgUlRDUnRwUmVjZWl2ZXIgbm93LiBUaGUgUlRQU2VuZGVyIGlzIHN0YXJ0ZWQgaW5cbiAgICAgICAgLy8gc2V0TG9jYWxEZXNjcmlwdGlvbi5cbiAgICAgICAgcGMuX3RyYW5zY2VpdmUocGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLFxuICAgICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgICBpc05ld1RyYWNrKTtcbiAgICAgIH0gZWxzZSBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ2Fuc3dlcicgJiYgIXJlamVjdGVkKSB7XG4gICAgICAgIHRyYW5zY2VpdmVyID0gcGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdO1xuICAgICAgICBpY2VHYXRoZXJlciA9IHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyO1xuICAgICAgICBpY2VUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQ7XG4gICAgICAgIGR0bHNUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0O1xuICAgICAgICBydHBSZWNlaXZlciA9IHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyO1xuICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzID0gdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVycztcbiAgICAgICAgbG9jYWxDYXBhYmlsaXRpZXMgPSB0cmFuc2NlaXZlci5sb2NhbENhcGFiaWxpdGllcztcblxuICAgICAgICBwYy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0ucmVjdkVuY29kaW5nUGFyYW1ldGVycyA9XG4gICAgICAgICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzO1xuICAgICAgICBwYy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0ucmVtb3RlQ2FwYWJpbGl0aWVzID1cbiAgICAgICAgICAgIHJlbW90ZUNhcGFiaWxpdGllcztcbiAgICAgICAgcGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLnJ0Y3BQYXJhbWV0ZXJzID0gcnRjcFBhcmFtZXRlcnM7XG5cbiAgICAgICAgaWYgKGNhbmRzLmxlbmd0aCAmJiBpY2VUcmFuc3BvcnQuc3RhdGUgPT09ICduZXcnKSB7XG4gICAgICAgICAgaWYgKChpc0ljZUxpdGUgfHwgaXNDb21wbGV0ZSkgJiZcbiAgICAgICAgICAgICAgKCF1c2luZ0J1bmRsZSB8fCBzZHBNTGluZUluZGV4ID09PSAwKSkge1xuICAgICAgICAgICAgaWNlVHJhbnNwb3J0LnNldFJlbW90ZUNhbmRpZGF0ZXMoY2FuZHMpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYW5kcy5mb3JFYWNoKGZ1bmN0aW9uKGNhbmRpZGF0ZSkge1xuICAgICAgICAgICAgICBtYXliZUFkZENhbmRpZGF0ZSh0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQsIGNhbmRpZGF0ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXVzaW5nQnVuZGxlIHx8IHNkcE1MaW5lSW5kZXggPT09IDApIHtcbiAgICAgICAgICBpZiAoaWNlVHJhbnNwb3J0LnN0YXRlID09PSAnbmV3Jykge1xuICAgICAgICAgICAgaWNlVHJhbnNwb3J0LnN0YXJ0KGljZUdhdGhlcmVyLCByZW1vdGVJY2VQYXJhbWV0ZXJzLFxuICAgICAgICAgICAgICAgICdjb250cm9sbGluZycpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZHRsc1RyYW5zcG9ydC5zdGF0ZSA9PT0gJ25ldycpIHtcbiAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQuc3RhcnQocmVtb3RlRHRsc1BhcmFtZXRlcnMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHRoZSBvZmZlciBjb250YWluZWQgUlRYIGJ1dCB0aGUgYW5zd2VyIGRpZCBub3QsXG4gICAgICAgIC8vIHJlbW92ZSBSVFggZnJvbSBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzLlxuICAgICAgICB2YXIgY29tbW9uQ2FwYWJpbGl0aWVzID0gZ2V0Q29tbW9uQ2FwYWJpbGl0aWVzKFxuICAgICAgICAgIHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzLFxuICAgICAgICAgIHRyYW5zY2VpdmVyLnJlbW90ZUNhcGFiaWxpdGllcyk7XG5cbiAgICAgICAgdmFyIGhhc1J0eCA9IGNvbW1vbkNhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKGZ1bmN0aW9uKGMpIHtcbiAgICAgICAgICByZXR1cm4gYy5uYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdydHgnO1xuICAgICAgICB9KS5sZW5ndGg7XG4gICAgICAgIGlmICghaGFzUnR4ICYmIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7XG4gICAgICAgICAgZGVsZXRlIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4O1xuICAgICAgICB9XG5cbiAgICAgICAgcGMuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsXG4gICAgICAgICAgICBkaXJlY3Rpb24gPT09ICdzZW5kcmVjdicgfHwgZGlyZWN0aW9uID09PSAncmVjdm9ubHknLFxuICAgICAgICAgICAgZGlyZWN0aW9uID09PSAnc2VuZHJlY3YnIHx8IGRpcmVjdGlvbiA9PT0gJ3NlbmRvbmx5Jyk7XG5cbiAgICAgICAgLy8gVE9ETzogcmV3cml0ZSB0byB1c2UgaHR0cDovL3czYy5naXRodWIuaW8vd2VicnRjLXBjLyNzZXQtYXNzb2NpYXRlZC1yZW1vdGUtc3RyZWFtc1xuICAgICAgICBpZiAocnRwUmVjZWl2ZXIgJiZcbiAgICAgICAgICAgIChkaXJlY3Rpb24gPT09ICdzZW5kcmVjdicgfHwgZGlyZWN0aW9uID09PSAnc2VuZG9ubHknKSkge1xuICAgICAgICAgIHRyYWNrID0gcnRwUmVjZWl2ZXIudHJhY2s7XG4gICAgICAgICAgaWYgKHJlbW90ZU1zaWQpIHtcbiAgICAgICAgICAgIGlmICghc3RyZWFtc1tyZW1vdGVNc2lkLnN0cmVhbV0pIHtcbiAgICAgICAgICAgICAgc3RyZWFtc1tyZW1vdGVNc2lkLnN0cmVhbV0gPSBuZXcgd2luZG93Lk1lZGlhU3RyZWFtKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhZGRUcmFja1RvU3RyZWFtQW5kRmlyZUV2ZW50KHRyYWNrLCBzdHJlYW1zW3JlbW90ZU1zaWQuc3RyZWFtXSk7XG4gICAgICAgICAgICByZWNlaXZlckxpc3QucHVzaChbdHJhY2ssIHJ0cFJlY2VpdmVyLCBzdHJlYW1zW3JlbW90ZU1zaWQuc3RyZWFtXV0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIXN0cmVhbXMuZGVmYXVsdCkge1xuICAgICAgICAgICAgICBzdHJlYW1zLmRlZmF1bHQgPSBuZXcgd2luZG93Lk1lZGlhU3RyZWFtKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhZGRUcmFja1RvU3RyZWFtQW5kRmlyZUV2ZW50KHRyYWNrLCBzdHJlYW1zLmRlZmF1bHQpO1xuICAgICAgICAgICAgcmVjZWl2ZXJMaXN0LnB1c2goW3RyYWNrLCBydHBSZWNlaXZlciwgc3RyZWFtcy5kZWZhdWx0XSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEZJWE1FOiBhY3R1YWxseSB0aGUgcmVjZWl2ZXIgc2hvdWxkIGJlIGNyZWF0ZWQgbGF0ZXIuXG4gICAgICAgICAgZGVsZXRlIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAocGMuX2R0bHNSb2xlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHBjLl9kdGxzUm9sZSA9IGRlc2NyaXB0aW9uLnR5cGUgPT09ICdvZmZlcicgPyAnYWN0aXZlJyA6ICdwYXNzaXZlJztcbiAgICB9XG5cbiAgICBwYy5fcmVtb3RlRGVzY3JpcHRpb24gPSB7XG4gICAgICB0eXBlOiBkZXNjcmlwdGlvbi50eXBlLFxuICAgICAgc2RwOiBkZXNjcmlwdGlvbi5zZHBcbiAgICB9O1xuICAgIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnb2ZmZXInKSB7XG4gICAgICBwYy5fdXBkYXRlU2lnbmFsaW5nU3RhdGUoJ2hhdmUtcmVtb3RlLW9mZmVyJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBjLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnc3RhYmxlJyk7XG4gICAgfVxuICAgIE9iamVjdC5rZXlzKHN0cmVhbXMpLmZvckVhY2goZnVuY3Rpb24oc2lkKSB7XG4gICAgICB2YXIgc3RyZWFtID0gc3RyZWFtc1tzaWRdO1xuICAgICAgaWYgKHN0cmVhbS5nZXRUcmFja3MoKS5sZW5ndGgpIHtcbiAgICAgICAgaWYgKHBjLnJlbW90ZVN0cmVhbXMuaW5kZXhPZihzdHJlYW0pID09PSAtMSkge1xuICAgICAgICAgIHBjLnJlbW90ZVN0cmVhbXMucHVzaChzdHJlYW0pO1xuICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnYWRkc3RyZWFtJyk7XG4gICAgICAgICAgZXZlbnQuc3RyZWFtID0gc3RyZWFtO1xuICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcGMuX2Rpc3BhdGNoRXZlbnQoJ2FkZHN0cmVhbScsIGV2ZW50KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlY2VpdmVyTGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICB2YXIgdHJhY2sgPSBpdGVtWzBdO1xuICAgICAgICAgIHZhciByZWNlaXZlciA9IGl0ZW1bMV07XG4gICAgICAgICAgaWYgKHN0cmVhbS5pZCAhPT0gaXRlbVsyXS5pZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmaXJlQWRkVHJhY2socGMsIHRyYWNrLCByZWNlaXZlciwgW3N0cmVhbV0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZWNlaXZlckxpc3QuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICBpZiAoaXRlbVsyXSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBmaXJlQWRkVHJhY2socGMsIGl0ZW1bMF0sIGl0ZW1bMV0sIFtdKTtcbiAgICB9KTtcblxuICAgIC8vIGNoZWNrIHdoZXRoZXIgYWRkSWNlQ2FuZGlkYXRlKHt9KSB3YXMgY2FsbGVkIHdpdGhpbiBmb3VyIHNlY29uZHMgYWZ0ZXJcbiAgICAvLyBzZXRSZW1vdGVEZXNjcmlwdGlvbi5cbiAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIGlmICghKHBjICYmIHBjLnRyYW5zY2VpdmVycykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgcGMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHtcbiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCAmJlxuICAgICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0YXRlID09PSAnbmV3JyAmJlxuICAgICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LmdldFJlbW90ZUNhbmRpZGF0ZXMoKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdUaW1lb3V0IGZvciBhZGRSZW1vdGVDYW5kaWRhdGUuIENvbnNpZGVyIHNlbmRpbmcgJyArXG4gICAgICAgICAgICAgICdhbiBlbmQtb2YtY2FuZGlkYXRlcyBub3RpZmljYXRpb24nKTtcbiAgICAgICAgICB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQuYWRkUmVtb3RlQ2FuZGlkYXRlKHt9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSwgNDAwMCk7XG5cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikge1xuICAgICAgLyogbm90IHlldFxuICAgICAgaWYgKHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyKSB7XG4gICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmNsb3NlKCk7XG4gICAgICB9XG4gICAgICAqL1xuICAgICAgaWYgKHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCkge1xuICAgICAgICB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQuc3RvcCgpO1xuICAgICAgfVxuICAgICAgaWYgKHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQpIHtcbiAgICAgICAgdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydC5zdG9wKCk7XG4gICAgICB9XG4gICAgICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7XG4gICAgICAgIHRyYW5zY2VpdmVyLnJ0cFNlbmRlci5zdG9wKCk7XG4gICAgICB9XG4gICAgICBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHtcbiAgICAgICAgdHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIuc3RvcCgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIC8vIEZJWE1FOiBjbGVhbiB1cCB0cmFja3MsIGxvY2FsIHN0cmVhbXMsIHJlbW90ZSBzdHJlYW1zLCBldGNcbiAgICB0aGlzLl9pc0Nsb3NlZCA9IHRydWU7XG4gICAgdGhpcy5fdXBkYXRlU2lnbmFsaW5nU3RhdGUoJ2Nsb3NlZCcpO1xuICB9O1xuXG4gIC8vIFVwZGF0ZSB0aGUgc2lnbmFsaW5nIHN0YXRlLlxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlID0gZnVuY3Rpb24obmV3U3RhdGUpIHtcbiAgICB0aGlzLnNpZ25hbGluZ1N0YXRlID0gbmV3U3RhdGU7XG4gICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdzaWduYWxpbmdzdGF0ZWNoYW5nZScpO1xuICAgIHRoaXMuX2Rpc3BhdGNoRXZlbnQoJ3NpZ25hbGluZ3N0YXRlY2hhbmdlJywgZXZlbnQpO1xuICB9O1xuXG4gIC8vIERldGVybWluZSB3aGV0aGVyIHRvIGZpcmUgdGhlIG5lZ290aWF0aW9ubmVlZGVkIGV2ZW50LlxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX21heWJlRmlyZU5lZ290aWF0aW9uTmVlZGVkID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHBjID0gdGhpcztcbiAgICBpZiAodGhpcy5zaWduYWxpbmdTdGF0ZSAhPT0gJ3N0YWJsZScgfHwgdGhpcy5uZWVkTmVnb3RpYXRpb24gPT09IHRydWUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5uZWVkTmVnb3RpYXRpb24gPSB0cnVlO1xuICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHBjLm5lZWROZWdvdGlhdGlvbikge1xuICAgICAgICBwYy5uZWVkTmVnb3RpYXRpb24gPSBmYWxzZTtcbiAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCduZWdvdGlhdGlvbm5lZWRlZCcpO1xuICAgICAgICBwYy5fZGlzcGF0Y2hFdmVudCgnbmVnb3RpYXRpb25uZWVkZWQnLCBldmVudCk7XG4gICAgICB9XG4gICAgfSwgMCk7XG4gIH07XG5cbiAgLy8gVXBkYXRlIHRoZSBpY2UgY29ubmVjdGlvbiBzdGF0ZS5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl91cGRhdGVJY2VDb25uZWN0aW9uU3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbmV3U3RhdGU7XG4gICAgdmFyIHN0YXRlcyA9IHtcbiAgICAgICduZXcnOiAwLFxuICAgICAgY2xvc2VkOiAwLFxuICAgICAgY2hlY2tpbmc6IDAsXG4gICAgICBjb25uZWN0ZWQ6IDAsXG4gICAgICBjb21wbGV0ZWQ6IDAsXG4gICAgICBkaXNjb25uZWN0ZWQ6IDAsXG4gICAgICBmYWlsZWQ6IDBcbiAgICB9O1xuICAgIHRoaXMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHtcbiAgICAgIGlmICh0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQgJiYgIXRyYW5zY2VpdmVyLnJlamVjdGVkKSB7XG4gICAgICAgIHN0YXRlc1t0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQuc3RhdGVdKys7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBuZXdTdGF0ZSA9ICduZXcnO1xuICAgIGlmIChzdGF0ZXMuZmFpbGVkID4gMCkge1xuICAgICAgbmV3U3RhdGUgPSAnZmFpbGVkJztcbiAgICB9IGVsc2UgaWYgKHN0YXRlcy5jaGVja2luZyA+IDApIHtcbiAgICAgIG5ld1N0YXRlID0gJ2NoZWNraW5nJztcbiAgICB9IGVsc2UgaWYgKHN0YXRlcy5kaXNjb25uZWN0ZWQgPiAwKSB7XG4gICAgICBuZXdTdGF0ZSA9ICdkaXNjb25uZWN0ZWQnO1xuICAgIH0gZWxzZSBpZiAoc3RhdGVzLm5ldyA+IDApIHtcbiAgICAgIG5ld1N0YXRlID0gJ25ldyc7XG4gICAgfSBlbHNlIGlmIChzdGF0ZXMuY29ubmVjdGVkID4gMCkge1xuICAgICAgbmV3U3RhdGUgPSAnY29ubmVjdGVkJztcbiAgICB9IGVsc2UgaWYgKHN0YXRlcy5jb21wbGV0ZWQgPiAwKSB7XG4gICAgICBuZXdTdGF0ZSA9ICdjb21wbGV0ZWQnO1xuICAgIH1cblxuICAgIGlmIChuZXdTdGF0ZSAhPT0gdGhpcy5pY2VDb25uZWN0aW9uU3RhdGUpIHtcbiAgICAgIHRoaXMuaWNlQ29ubmVjdGlvblN0YXRlID0gbmV3U3RhdGU7XG4gICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ2ljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZScpO1xuICAgICAgdGhpcy5fZGlzcGF0Y2hFdmVudCgnaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlJywgZXZlbnQpO1xuICAgIH1cbiAgfTtcblxuICAvLyBVcGRhdGUgdGhlIGNvbm5lY3Rpb24gc3RhdGUuXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fdXBkYXRlQ29ubmVjdGlvblN0YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIG5ld1N0YXRlO1xuICAgIHZhciBzdGF0ZXMgPSB7XG4gICAgICAnbmV3JzogMCxcbiAgICAgIGNsb3NlZDogMCxcbiAgICAgIGNvbm5lY3Rpbmc6IDAsXG4gICAgICBjb25uZWN0ZWQ6IDAsXG4gICAgICBjb21wbGV0ZWQ6IDAsXG4gICAgICBkaXNjb25uZWN0ZWQ6IDAsXG4gICAgICBmYWlsZWQ6IDBcbiAgICB9O1xuICAgIHRoaXMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHtcbiAgICAgIGlmICh0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQgJiYgdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydCAmJlxuICAgICAgICAgICF0cmFuc2NlaXZlci5yZWplY3RlZCkge1xuICAgICAgICBzdGF0ZXNbdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LnN0YXRlXSsrO1xuICAgICAgICBzdGF0ZXNbdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydC5zdGF0ZV0rKztcbiAgICAgIH1cbiAgICB9KTtcbiAgICAvLyBJQ0VUcmFuc3BvcnQuY29tcGxldGVkIGFuZCBjb25uZWN0ZWQgYXJlIHRoZSBzYW1lIGZvciB0aGlzIHB1cnBvc2UuXG4gICAgc3RhdGVzLmNvbm5lY3RlZCArPSBzdGF0ZXMuY29tcGxldGVkO1xuXG4gICAgbmV3U3RhdGUgPSAnbmV3JztcbiAgICBpZiAoc3RhdGVzLmZhaWxlZCA+IDApIHtcbiAgICAgIG5ld1N0YXRlID0gJ2ZhaWxlZCc7XG4gICAgfSBlbHNlIGlmIChzdGF0ZXMuY29ubmVjdGluZyA+IDApIHtcbiAgICAgIG5ld1N0YXRlID0gJ2Nvbm5lY3RpbmcnO1xuICAgIH0gZWxzZSBpZiAoc3RhdGVzLmRpc2Nvbm5lY3RlZCA+IDApIHtcbiAgICAgIG5ld1N0YXRlID0gJ2Rpc2Nvbm5lY3RlZCc7XG4gICAgfSBlbHNlIGlmIChzdGF0ZXMubmV3ID4gMCkge1xuICAgICAgbmV3U3RhdGUgPSAnbmV3JztcbiAgICB9IGVsc2UgaWYgKHN0YXRlcy5jb25uZWN0ZWQgPiAwKSB7XG4gICAgICBuZXdTdGF0ZSA9ICdjb25uZWN0ZWQnO1xuICAgIH1cblxuICAgIGlmIChuZXdTdGF0ZSAhPT0gdGhpcy5jb25uZWN0aW9uU3RhdGUpIHtcbiAgICAgIHRoaXMuY29ubmVjdGlvblN0YXRlID0gbmV3U3RhdGU7XG4gICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ2Nvbm5lY3Rpb25zdGF0ZWNoYW5nZScpO1xuICAgICAgdGhpcy5fZGlzcGF0Y2hFdmVudCgnY29ubmVjdGlvbnN0YXRlY2hhbmdlJywgZXZlbnQpO1xuICAgIH1cbiAgfTtcblxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY3JlYXRlT2ZmZXIgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgcGMgPSB0aGlzO1xuXG4gICAgaWYgKHBjLl9pc0Nsb3NlZCkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG1ha2VFcnJvcignSW52YWxpZFN0YXRlRXJyb3InLFxuICAgICAgICAgICdDYW4gbm90IGNhbGwgY3JlYXRlT2ZmZXIgYWZ0ZXIgY2xvc2UnKSk7XG4gICAgfVxuXG4gICAgdmFyIG51bUF1ZGlvVHJhY2tzID0gcGMudHJhbnNjZWl2ZXJzLmZpbHRlcihmdW5jdGlvbih0KSB7XG4gICAgICByZXR1cm4gdC5raW5kID09PSAnYXVkaW8nO1xuICAgIH0pLmxlbmd0aDtcbiAgICB2YXIgbnVtVmlkZW9UcmFja3MgPSBwYy50cmFuc2NlaXZlcnMuZmlsdGVyKGZ1bmN0aW9uKHQpIHtcbiAgICAgIHJldHVybiB0LmtpbmQgPT09ICd2aWRlbyc7XG4gICAgfSkubGVuZ3RoO1xuXG4gICAgLy8gRGV0ZXJtaW5lIG51bWJlciBvZiBhdWRpbyBhbmQgdmlkZW8gdHJhY2tzIHdlIG5lZWQgdG8gc2VuZC9yZWN2LlxuICAgIHZhciBvZmZlck9wdGlvbnMgPSBhcmd1bWVudHNbMF07XG4gICAgaWYgKG9mZmVyT3B0aW9ucykge1xuICAgICAgLy8gUmVqZWN0IENocm9tZSBsZWdhY3kgY29uc3RyYWludHMuXG4gICAgICBpZiAob2ZmZXJPcHRpb25zLm1hbmRhdG9yeSB8fCBvZmZlck9wdGlvbnMub3B0aW9uYWwpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgICAgICAgICdMZWdhY3kgbWFuZGF0b3J5L29wdGlvbmFsIGNvbnN0cmFpbnRzIG5vdCBzdXBwb3J0ZWQuJyk7XG4gICAgICB9XG4gICAgICBpZiAob2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW8gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAob2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW8gPT09IHRydWUpIHtcbiAgICAgICAgICBudW1BdWRpb1RyYWNrcyA9IDE7XG4gICAgICAgIH0gZWxzZSBpZiAob2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW8gPT09IGZhbHNlKSB7XG4gICAgICAgICAgbnVtQXVkaW9UcmFja3MgPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG51bUF1ZGlvVHJhY2tzID0gb2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW87XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVWaWRlbyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmIChvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVWaWRlbyA9PT0gdHJ1ZSkge1xuICAgICAgICAgIG51bVZpZGVvVHJhY2tzID0gMTtcbiAgICAgICAgfSBlbHNlIGlmIChvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVWaWRlbyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICBudW1WaWRlb1RyYWNrcyA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbnVtVmlkZW9UcmFja3MgPSBvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVWaWRlbztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHBjLnRyYW5zY2VpdmVycy5mb3JFYWNoKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7XG4gICAgICBpZiAodHJhbnNjZWl2ZXIua2luZCA9PT0gJ2F1ZGlvJykge1xuICAgICAgICBudW1BdWRpb1RyYWNrcy0tO1xuICAgICAgICBpZiAobnVtQXVkaW9UcmFja3MgPCAwKSB7XG4gICAgICAgICAgdHJhbnNjZWl2ZXIud2FudFJlY2VpdmUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5raW5kID09PSAndmlkZW8nKSB7XG4gICAgICAgIG51bVZpZGVvVHJhY2tzLS07XG4gICAgICAgIGlmIChudW1WaWRlb1RyYWNrcyA8IDApIHtcbiAgICAgICAgICB0cmFuc2NlaXZlci53YW50UmVjZWl2ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBDcmVhdGUgTS1saW5lcyBmb3IgcmVjdm9ubHkgc3RyZWFtcy5cbiAgICB3aGlsZSAobnVtQXVkaW9UcmFja3MgPiAwIHx8IG51bVZpZGVvVHJhY2tzID4gMCkge1xuICAgICAgaWYgKG51bUF1ZGlvVHJhY2tzID4gMCkge1xuICAgICAgICBwYy5fY3JlYXRlVHJhbnNjZWl2ZXIoJ2F1ZGlvJyk7XG4gICAgICAgIG51bUF1ZGlvVHJhY2tzLS07XG4gICAgICB9XG4gICAgICBpZiAobnVtVmlkZW9UcmFja3MgPiAwKSB7XG4gICAgICAgIHBjLl9jcmVhdGVUcmFuc2NlaXZlcigndmlkZW8nKTtcbiAgICAgICAgbnVtVmlkZW9UcmFja3MtLTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgc2RwID0gU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUocGMuX3NkcFNlc3Npb25JZCxcbiAgICAgICAgcGMuX3NkcFNlc3Npb25WZXJzaW9uKyspO1xuICAgIHBjLnRyYW5zY2VpdmVycy5mb3JFYWNoKGZ1bmN0aW9uKHRyYW5zY2VpdmVyLCBzZHBNTGluZUluZGV4KSB7XG4gICAgICAvLyBGb3IgZWFjaCB0cmFjaywgY3JlYXRlIGFuIGljZSBnYXRoZXJlciwgaWNlIHRyYW5zcG9ydCxcbiAgICAgIC8vIGR0bHMgdHJhbnNwb3J0LCBwb3RlbnRpYWxseSBydHBzZW5kZXIgYW5kIHJ0cHJlY2VpdmVyLlxuICAgICAgdmFyIHRyYWNrID0gdHJhbnNjZWl2ZXIudHJhY2s7XG4gICAgICB2YXIga2luZCA9IHRyYW5zY2VpdmVyLmtpbmQ7XG4gICAgICB2YXIgbWlkID0gdHJhbnNjZWl2ZXIubWlkIHx8IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpO1xuICAgICAgdHJhbnNjZWl2ZXIubWlkID0gbWlkO1xuXG4gICAgICBpZiAoIXRyYW5zY2VpdmVyLmljZUdhdGhlcmVyKSB7XG4gICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyID0gcGMuX2NyZWF0ZUljZUdhdGhlcmVyKHNkcE1MaW5lSW5kZXgsXG4gICAgICAgICAgICBwYy51c2luZ0J1bmRsZSk7XG4gICAgICB9XG5cbiAgICAgIHZhciBsb2NhbENhcGFiaWxpdGllcyA9IHdpbmRvdy5SVENSdHBTZW5kZXIuZ2V0Q2FwYWJpbGl0aWVzKGtpbmQpO1xuICAgICAgLy8gZmlsdGVyIFJUWCB1bnRpbCBhZGRpdGlvbmFsIHN0dWZmIG5lZWRlZCBmb3IgUlRYIGlzIGltcGxlbWVudGVkXG4gICAgICAvLyBpbiBhZGFwdGVyLmpzXG4gICAgICBpZiAoZWRnZVZlcnNpb24gPCAxNTAxOSkge1xuICAgICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MgPSBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKFxuICAgICAgICAgICAgZnVuY3Rpb24oY29kZWMpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGNvZGVjLm5hbWUgIT09ICdydHgnO1xuICAgICAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBsb2NhbENhcGFiaWxpdGllcy5jb2RlY3MuZm9yRWFjaChmdW5jdGlvbihjb2RlYykge1xuICAgICAgICAvLyB3b3JrIGFyb3VuZCBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3Avd2VicnRjL2lzc3Vlcy9kZXRhaWw/aWQ9NjU1MlxuICAgICAgICAvLyBieSBhZGRpbmcgbGV2ZWwtYXN5bW1ldHJ5LWFsbG93ZWQ9MVxuICAgICAgICBpZiAoY29kZWMubmFtZSA9PT0gJ0gyNjQnICYmXG4gICAgICAgICAgICBjb2RlYy5wYXJhbWV0ZXJzWydsZXZlbC1hc3ltbWV0cnktYWxsb3dlZCddID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBjb2RlYy5wYXJhbWV0ZXJzWydsZXZlbC1hc3ltbWV0cnktYWxsb3dlZCddID0gJzEnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZm9yIHN1YnNlcXVlbnQgb2ZmZXJzLCB3ZSBtaWdodCBoYXZlIHRvIHJlLXVzZSB0aGUgcGF5bG9hZFxuICAgICAgICAvLyB0eXBlIG9mIHRoZSBsYXN0IG9mZmVyLlxuICAgICAgICBpZiAodHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzICYmXG4gICAgICAgICAgICB0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXMuY29kZWNzKSB7XG4gICAgICAgICAgdHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzLmNvZGVjcy5mb3JFYWNoKGZ1bmN0aW9uKHJlbW90ZUNvZGVjKSB7XG4gICAgICAgICAgICBpZiAoY29kZWMubmFtZS50b0xvd2VyQ2FzZSgpID09PSByZW1vdGVDb2RlYy5uYW1lLnRvTG93ZXJDYXNlKCkgJiZcbiAgICAgICAgICAgICAgICBjb2RlYy5jbG9ja1JhdGUgPT09IHJlbW90ZUNvZGVjLmNsb2NrUmF0ZSkge1xuICAgICAgICAgICAgICBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSA9IHJlbW90ZUNvZGVjLnBheWxvYWRUeXBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzLmhlYWRlckV4dGVuc2lvbnMuZm9yRWFjaChmdW5jdGlvbihoZHJFeHQpIHtcbiAgICAgICAgdmFyIHJlbW90ZUV4dGVuc2lvbnMgPSB0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXMgJiZcbiAgICAgICAgICAgIHRyYW5zY2VpdmVyLnJlbW90ZUNhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zIHx8IFtdO1xuICAgICAgICByZW1vdGVFeHRlbnNpb25zLmZvckVhY2goZnVuY3Rpb24ockhkckV4dCkge1xuICAgICAgICAgIGlmIChoZHJFeHQudXJpID09PSBySGRyRXh0LnVyaSkge1xuICAgICAgICAgICAgaGRyRXh0LmlkID0gckhkckV4dC5pZDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIGdlbmVyYXRlIGFuIHNzcmMgbm93LCB0byBiZSB1c2VkIGxhdGVyIGluIHJ0cFNlbmRlci5zZW5kXG4gICAgICB2YXIgc2VuZEVuY29kaW5nUGFyYW1ldGVycyA9IHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnMgfHwgW3tcbiAgICAgICAgc3NyYzogKDIgKiBzZHBNTGluZUluZGV4ICsgMSkgKiAxMDAxXG4gICAgICB9XTtcbiAgICAgIGlmICh0cmFjaykge1xuICAgICAgICAvLyBhZGQgUlRYXG4gICAgICAgIGlmIChlZGdlVmVyc2lvbiA+PSAxNTAxOSAmJiBraW5kID09PSAndmlkZW8nICYmXG4gICAgICAgICAgICAhc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHgpIHtcbiAgICAgICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eCA9IHtcbiAgICAgICAgICAgIHNzcmM6IHNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0uc3NyYyArIDFcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICh0cmFuc2NlaXZlci53YW50UmVjZWl2ZSkge1xuICAgICAgICB0cmFuc2NlaXZlci5ydHBSZWNlaXZlciA9IG5ldyB3aW5kb3cuUlRDUnRwUmVjZWl2ZXIoXG4gICAgICAgICAgICB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0LCBraW5kKTtcbiAgICAgIH1cblxuICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMgPSBsb2NhbENhcGFiaWxpdGllcztcbiAgICAgIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnMgPSBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzO1xuICAgIH0pO1xuXG4gICAgLy8gYWx3YXlzIG9mZmVyIEJVTkRMRSBhbmQgZGlzcG9zZSBvbiByZXR1cm4gaWYgbm90IHN1cHBvcnRlZC5cbiAgICBpZiAocGMuX2NvbmZpZy5idW5kbGVQb2xpY3kgIT09ICdtYXgtY29tcGF0Jykge1xuICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgcGMudHJhbnNjZWl2ZXJzLm1hcChmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiB0Lm1pZDtcbiAgICAgIH0pLmpvaW4oJyAnKSArICdcXHJcXG4nO1xuICAgIH1cbiAgICBzZHAgKz0gJ2E9aWNlLW9wdGlvbnM6dHJpY2tsZVxcclxcbic7XG5cbiAgICBwYy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlciwgc2RwTUxpbmVJbmRleCkge1xuICAgICAgc2RwICs9IHdyaXRlTWVkaWFTZWN0aW9uKHRyYW5zY2VpdmVyLCB0cmFuc2NlaXZlci5sb2NhbENhcGFiaWxpdGllcyxcbiAgICAgICAgICAnb2ZmZXInLCB0cmFuc2NlaXZlci5zdHJlYW0sIHBjLl9kdGxzUm9sZSk7XG4gICAgICBzZHAgKz0gJ2E9cnRjcC1yc2l6ZVxcclxcbic7XG5cbiAgICAgIGlmICh0cmFuc2NlaXZlci5pY2VHYXRoZXJlciAmJiBwYy5pY2VHYXRoZXJpbmdTdGF0ZSAhPT0gJ25ldycgJiZcbiAgICAgICAgICAoc2RwTUxpbmVJbmRleCA9PT0gMCB8fCAhcGMudXNpbmdCdW5kbGUpKSB7XG4gICAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmdldExvY2FsQ2FuZGlkYXRlcygpLmZvckVhY2goZnVuY3Rpb24oY2FuZCkge1xuICAgICAgICAgIGNhbmQuY29tcG9uZW50ID0gMTtcbiAgICAgICAgICBzZHAgKz0gJ2E9JyArIFNEUFV0aWxzLndyaXRlQ2FuZGlkYXRlKGNhbmQpICsgJ1xcclxcbic7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICh0cmFuc2NlaXZlci5pY2VHYXRoZXJlci5zdGF0ZSA9PT0gJ2NvbXBsZXRlZCcpIHtcbiAgICAgICAgICBzZHAgKz0gJ2E9ZW5kLW9mLWNhbmRpZGF0ZXNcXHJcXG4nO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB2YXIgZGVzYyA9IG5ldyB3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHtcbiAgICAgIHR5cGU6ICdvZmZlcicsXG4gICAgICBzZHA6IHNkcFxuICAgIH0pO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGVzYyk7XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmNyZWF0ZUFuc3dlciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwYyA9IHRoaXM7XG5cbiAgICBpZiAocGMuX2lzQ2xvc2VkKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobWFrZUVycm9yKCdJbnZhbGlkU3RhdGVFcnJvcicsXG4gICAgICAgICAgJ0NhbiBub3QgY2FsbCBjcmVhdGVBbnN3ZXIgYWZ0ZXIgY2xvc2UnKSk7XG4gICAgfVxuXG4gICAgaWYgKCEocGMuc2lnbmFsaW5nU3RhdGUgPT09ICdoYXZlLXJlbW90ZS1vZmZlcicgfHxcbiAgICAgICAgcGMuc2lnbmFsaW5nU3RhdGUgPT09ICdoYXZlLWxvY2FsLXByYW5zd2VyJykpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChtYWtlRXJyb3IoJ0ludmFsaWRTdGF0ZUVycm9yJyxcbiAgICAgICAgICAnQ2FuIG5vdCBjYWxsIGNyZWF0ZUFuc3dlciBpbiBzaWduYWxpbmdTdGF0ZSAnICsgcGMuc2lnbmFsaW5nU3RhdGUpKTtcbiAgICB9XG5cbiAgICB2YXIgc2RwID0gU0RQVXRpbHMud3JpdGVTZXNzaW9uQm9pbGVycGxhdGUocGMuX3NkcFNlc3Npb25JZCxcbiAgICAgICAgcGMuX3NkcFNlc3Npb25WZXJzaW9uKyspO1xuICAgIGlmIChwYy51c2luZ0J1bmRsZSkge1xuICAgICAgc2RwICs9ICdhPWdyb3VwOkJVTkRMRSAnICsgcGMudHJhbnNjZWl2ZXJzLm1hcChmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiB0Lm1pZDtcbiAgICAgIH0pLmpvaW4oJyAnKSArICdcXHJcXG4nO1xuICAgIH1cbiAgICBzZHAgKz0gJ2E9aWNlLW9wdGlvbnM6dHJpY2tsZVxcclxcbic7XG5cbiAgICB2YXIgbWVkaWFTZWN0aW9uc0luT2ZmZXIgPSBTRFBVdGlscy5nZXRNZWRpYVNlY3Rpb25zKFxuICAgICAgICBwYy5fcmVtb3RlRGVzY3JpcHRpb24uc2RwKS5sZW5ndGg7XG4gICAgcGMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIsIHNkcE1MaW5lSW5kZXgpIHtcbiAgICAgIGlmIChzZHBNTGluZUluZGV4ICsgMSA+IG1lZGlhU2VjdGlvbnNJbk9mZmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0cmFuc2NlaXZlci5yZWplY3RlZCkge1xuICAgICAgICBpZiAodHJhbnNjZWl2ZXIua2luZCA9PT0gJ2FwcGxpY2F0aW9uJykge1xuICAgICAgICAgIGlmICh0cmFuc2NlaXZlci5wcm90b2NvbCA9PT0gJ0RUTFMvU0NUUCcpIHsgLy8gbGVnYWN5IGZtdFxuICAgICAgICAgICAgc2RwICs9ICdtPWFwcGxpY2F0aW9uIDAgRFRMUy9TQ1RQIDUwMDBcXHJcXG4nO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZHAgKz0gJ209YXBwbGljYXRpb24gMCAnICsgdHJhbnNjZWl2ZXIucHJvdG9jb2wgK1xuICAgICAgICAgICAgICAgICcgd2VicnRjLWRhdGFjaGFubmVsXFxyXFxuJztcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIua2luZCA9PT0gJ2F1ZGlvJykge1xuICAgICAgICAgIHNkcCArPSAnbT1hdWRpbyAwIFVEUC9UTFMvUlRQL1NBVlBGIDBcXHJcXG4nICtcbiAgICAgICAgICAgICAgJ2E9cnRwbWFwOjAgUENNVS84MDAwXFxyXFxuJztcbiAgICAgICAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5raW5kID09PSAndmlkZW8nKSB7XG4gICAgICAgICAgc2RwICs9ICdtPXZpZGVvIDAgVURQL1RMUy9SVFAvU0FWUEYgMTIwXFxyXFxuJyArXG4gICAgICAgICAgICAgICdhPXJ0cG1hcDoxMjAgVlA4LzkwMDAwXFxyXFxuJztcbiAgICAgICAgfVxuICAgICAgICBzZHAgKz0gJ2M9SU4gSVA0IDAuMC4wLjBcXHJcXG4nICtcbiAgICAgICAgICAgICdhPWluYWN0aXZlXFxyXFxuJyArXG4gICAgICAgICAgICAnYT1taWQ6JyArIHRyYW5zY2VpdmVyLm1pZCArICdcXHJcXG4nO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIEZJWE1FOiBsb29rIGF0IGRpcmVjdGlvbi5cbiAgICAgIGlmICh0cmFuc2NlaXZlci5zdHJlYW0pIHtcbiAgICAgICAgdmFyIGxvY2FsVHJhY2s7XG4gICAgICAgIGlmICh0cmFuc2NlaXZlci5raW5kID09PSAnYXVkaW8nKSB7XG4gICAgICAgICAgbG9jYWxUcmFjayA9IHRyYW5zY2VpdmVyLnN0cmVhbS5nZXRBdWRpb1RyYWNrcygpWzBdO1xuICAgICAgICB9IGVsc2UgaWYgKHRyYW5zY2VpdmVyLmtpbmQgPT09ICd2aWRlbycpIHtcbiAgICAgICAgICBsb2NhbFRyYWNrID0gdHJhbnNjZWl2ZXIuc3RyZWFtLmdldFZpZGVvVHJhY2tzKClbMF07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxvY2FsVHJhY2spIHtcbiAgICAgICAgICAvLyBhZGQgUlRYXG4gICAgICAgICAgaWYgKGVkZ2VWZXJzaW9uID49IDE1MDE5ICYmIHRyYW5zY2VpdmVyLmtpbmQgPT09ICd2aWRlbycgJiZcbiAgICAgICAgICAgICAgIXRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7XG4gICAgICAgICAgICB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eCA9IHtcbiAgICAgICAgICAgICAgc3NyYzogdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsgMVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ2FsY3VsYXRlIGludGVyc2VjdGlvbiBvZiBjYXBhYmlsaXRpZXMuXG4gICAgICB2YXIgY29tbW9uQ2FwYWJpbGl0aWVzID0gZ2V0Q29tbW9uQ2FwYWJpbGl0aWVzKFxuICAgICAgICAgIHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzLFxuICAgICAgICAgIHRyYW5zY2VpdmVyLnJlbW90ZUNhcGFiaWxpdGllcyk7XG5cbiAgICAgIHZhciBoYXNSdHggPSBjb21tb25DYXBhYmlsaXRpZXMuY29kZWNzLmZpbHRlcihmdW5jdGlvbihjKSB7XG4gICAgICAgIHJldHVybiBjLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ3J0eCc7XG4gICAgICB9KS5sZW5ndGg7XG4gICAgICBpZiAoIWhhc1J0eCAmJiB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eCkge1xuICAgICAgICBkZWxldGUgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHg7XG4gICAgICB9XG5cbiAgICAgIHNkcCArPSB3cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwgY29tbW9uQ2FwYWJpbGl0aWVzLFxuICAgICAgICAgICdhbnN3ZXInLCB0cmFuc2NlaXZlci5zdHJlYW0sIHBjLl9kdGxzUm9sZSk7XG4gICAgICBpZiAodHJhbnNjZWl2ZXIucnRjcFBhcmFtZXRlcnMgJiZcbiAgICAgICAgICB0cmFuc2NlaXZlci5ydGNwUGFyYW1ldGVycy5yZWR1Y2VkU2l6ZSkge1xuICAgICAgICBzZHAgKz0gJ2E9cnRjcC1yc2l6ZVxcclxcbic7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB2YXIgZGVzYyA9IG5ldyB3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHtcbiAgICAgIHR5cGU6ICdhbnN3ZXInLFxuICAgICAgc2RwOiBzZHBcbiAgICB9KTtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGRlc2MpO1xuICB9O1xuXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5hZGRJY2VDYW5kaWRhdGUgPSBmdW5jdGlvbihjYW5kaWRhdGUpIHtcbiAgICB2YXIgcGMgPSB0aGlzO1xuICAgIHZhciBzZWN0aW9ucztcbiAgICBpZiAoY2FuZGlkYXRlICYmICEoY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXggIT09IHVuZGVmaW5lZCB8fFxuICAgICAgICBjYW5kaWRhdGUuc2RwTWlkKSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBUeXBlRXJyb3IoJ3NkcE1MaW5lSW5kZXggb3Igc2RwTWlkIHJlcXVpcmVkJykpO1xuICAgIH1cblxuICAgIC8vIFRPRE86IG5lZWRzIHRvIGdvIGludG8gb3BzIHF1ZXVlLlxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIGlmICghcGMuX3JlbW90ZURlc2NyaXB0aW9uKSB7XG4gICAgICAgIHJldHVybiByZWplY3QobWFrZUVycm9yKCdJbnZhbGlkU3RhdGVFcnJvcicsXG4gICAgICAgICAgICAnQ2FuIG5vdCBhZGQgSUNFIGNhbmRpZGF0ZSB3aXRob3V0IGEgcmVtb3RlIGRlc2NyaXB0aW9uJykpO1xuICAgICAgfSBlbHNlIGlmICghY2FuZGlkYXRlIHx8IGNhbmRpZGF0ZS5jYW5kaWRhdGUgPT09ICcnKSB7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcGMudHJhbnNjZWl2ZXJzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgaWYgKHBjLnRyYW5zY2VpdmVyc1tqXS5yZWplY3RlZCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHBjLnRyYW5zY2VpdmVyc1tqXS5pY2VUcmFuc3BvcnQuYWRkUmVtb3RlQ2FuZGlkYXRlKHt9KTtcbiAgICAgICAgICBzZWN0aW9ucyA9IFNEUFV0aWxzLmdldE1lZGlhU2VjdGlvbnMocGMuX3JlbW90ZURlc2NyaXB0aW9uLnNkcCk7XG4gICAgICAgICAgc2VjdGlvbnNbal0gKz0gJ2E9ZW5kLW9mLWNhbmRpZGF0ZXNcXHJcXG4nO1xuICAgICAgICAgIHBjLl9yZW1vdGVEZXNjcmlwdGlvbi5zZHAgPVxuICAgICAgICAgICAgICBTRFBVdGlscy5nZXREZXNjcmlwdGlvbihwYy5fcmVtb3RlRGVzY3JpcHRpb24uc2RwKSArXG4gICAgICAgICAgICAgIHNlY3Rpb25zLmpvaW4oJycpO1xuICAgICAgICAgIGlmIChwYy51c2luZ0J1bmRsZSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgc2RwTUxpbmVJbmRleCA9IGNhbmRpZGF0ZS5zZHBNTGluZUluZGV4O1xuICAgICAgICBpZiAoY2FuZGlkYXRlLnNkcE1pZCkge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGMudHJhbnNjZWl2ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocGMudHJhbnNjZWl2ZXJzW2ldLm1pZCA9PT0gY2FuZGlkYXRlLnNkcE1pZCkge1xuICAgICAgICAgICAgICBzZHBNTGluZUluZGV4ID0gaTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciB0cmFuc2NlaXZlciA9IHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XTtcbiAgICAgICAgaWYgKHRyYW5zY2VpdmVyKSB7XG4gICAgICAgICAgaWYgKHRyYW5zY2VpdmVyLnJlamVjdGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgY2FuZCA9IE9iamVjdC5rZXlzKGNhbmRpZGF0ZS5jYW5kaWRhdGUpLmxlbmd0aCA+IDAgP1xuICAgICAgICAgICAgICBTRFBVdGlscy5wYXJzZUNhbmRpZGF0ZShjYW5kaWRhdGUuY2FuZGlkYXRlKSA6IHt9O1xuICAgICAgICAgIC8vIElnbm9yZSBDaHJvbWUncyBpbnZhbGlkIGNhbmRpZGF0ZXMgc2luY2UgRWRnZSBkb2VzIG5vdCBsaWtlIHRoZW0uXG4gICAgICAgICAgaWYgKGNhbmQucHJvdG9jb2wgPT09ICd0Y3AnICYmIChjYW5kLnBvcnQgPT09IDAgfHwgY2FuZC5wb3J0ID09PSA5KSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gSWdub3JlIFJUQ1AgY2FuZGlkYXRlcywgd2UgYXNzdW1lIFJUQ1AtTVVYLlxuICAgICAgICAgIGlmIChjYW5kLmNvbXBvbmVudCAmJiBjYW5kLmNvbXBvbmVudCAhPT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gd2hlbiB1c2luZyBidW5kbGUsIGF2b2lkIGFkZGluZyBjYW5kaWRhdGVzIHRvIHRoZSB3cm9uZ1xuICAgICAgICAgIC8vIGljZSB0cmFuc3BvcnQuIEFuZCBhdm9pZCBhZGRpbmcgY2FuZGlkYXRlcyBhZGRlZCBpbiB0aGUgU0RQLlxuICAgICAgICAgIGlmIChzZHBNTGluZUluZGV4ID09PSAwIHx8IChzZHBNTGluZUluZGV4ID4gMCAmJlxuICAgICAgICAgICAgICB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQgIT09IHBjLnRyYW5zY2VpdmVyc1swXS5pY2VUcmFuc3BvcnQpKSB7XG4gICAgICAgICAgICBpZiAoIW1heWJlQWRkQ2FuZGlkYXRlKHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCwgY2FuZCkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChtYWtlRXJyb3IoJ09wZXJhdGlvbkVycm9yJyxcbiAgICAgICAgICAgICAgICAgICdDYW4gbm90IGFkZCBJQ0UgY2FuZGlkYXRlJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIHVwZGF0ZSB0aGUgcmVtb3RlRGVzY3JpcHRpb24uXG4gICAgICAgICAgdmFyIGNhbmRpZGF0ZVN0cmluZyA9IGNhbmRpZGF0ZS5jYW5kaWRhdGUudHJpbSgpO1xuICAgICAgICAgIGlmIChjYW5kaWRhdGVTdHJpbmcuaW5kZXhPZignYT0nKSA9PT0gMCkge1xuICAgICAgICAgICAgY2FuZGlkYXRlU3RyaW5nID0gY2FuZGlkYXRlU3RyaW5nLnN1YnN0cigyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgc2VjdGlvbnMgPSBTRFBVdGlscy5nZXRNZWRpYVNlY3Rpb25zKHBjLl9yZW1vdGVEZXNjcmlwdGlvbi5zZHApO1xuICAgICAgICAgIHNlY3Rpb25zW3NkcE1MaW5lSW5kZXhdICs9ICdhPScgK1xuICAgICAgICAgICAgICAoY2FuZC50eXBlID8gY2FuZGlkYXRlU3RyaW5nIDogJ2VuZC1vZi1jYW5kaWRhdGVzJylcbiAgICAgICAgICAgICAgKyAnXFxyXFxuJztcbiAgICAgICAgICBwYy5fcmVtb3RlRGVzY3JpcHRpb24uc2RwID1cbiAgICAgICAgICAgICAgU0RQVXRpbHMuZ2V0RGVzY3JpcHRpb24ocGMuX3JlbW90ZURlc2NyaXB0aW9uLnNkcCkgK1xuICAgICAgICAgICAgICBzZWN0aW9ucy5qb2luKCcnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gcmVqZWN0KG1ha2VFcnJvcignT3BlcmF0aW9uRXJyb3InLFxuICAgICAgICAgICAgICAnQ2FuIG5vdCBhZGQgSUNFIGNhbmRpZGF0ZScpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmVzb2x2ZSgpO1xuICAgIH0pO1xuICB9O1xuXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgaWYgKHNlbGVjdG9yICYmIHNlbGVjdG9yIGluc3RhbmNlb2Ygd2luZG93Lk1lZGlhU3RyZWFtVHJhY2spIHtcbiAgICAgIHZhciBzZW5kZXJPclJlY2VpdmVyID0gbnVsbDtcbiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHtcbiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlciAmJlxuICAgICAgICAgICAgdHJhbnNjZWl2ZXIucnRwU2VuZGVyLnRyYWNrID09PSBzZWxlY3Rvcikge1xuICAgICAgICAgIHNlbmRlck9yUmVjZWl2ZXIgPSB0cmFuc2NlaXZlci5ydHBTZW5kZXI7XG4gICAgICAgIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIgJiZcbiAgICAgICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnRyYWNrID09PSBzZWxlY3Rvcikge1xuICAgICAgICAgIHNlbmRlck9yUmVjZWl2ZXIgPSB0cmFuc2NlaXZlci5ydHBSZWNlaXZlcjtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAoIXNlbmRlck9yUmVjZWl2ZXIpIHtcbiAgICAgICAgdGhyb3cgbWFrZUVycm9yKCdJbnZhbGlkQWNjZXNzRXJyb3InLCAnSW52YWxpZCBzZWxlY3Rvci4nKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzZW5kZXJPclJlY2VpdmVyLmdldFN0YXRzKCk7XG4gICAgfVxuXG4gICAgdmFyIHByb21pc2VzID0gW107XG4gICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikge1xuICAgICAgWydydHBTZW5kZXInLCAncnRwUmVjZWl2ZXInLCAnaWNlR2F0aGVyZXInLCAnaWNlVHJhbnNwb3J0JyxcbiAgICAgICAgICAnZHRsc1RyYW5zcG9ydCddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgICAgICAgICBpZiAodHJhbnNjZWl2ZXJbbWV0aG9kXSkge1xuICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKHRyYW5zY2VpdmVyW21ldGhvZF0uZ2V0U3RhdHMoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uKGFsbFN0YXRzKSB7XG4gICAgICB2YXIgcmVzdWx0cyA9IG5ldyBNYXAoKTtcbiAgICAgIGFsbFN0YXRzLmZvckVhY2goZnVuY3Rpb24oc3RhdHMpIHtcbiAgICAgICAgc3RhdHMuZm9yRWFjaChmdW5jdGlvbihzdGF0KSB7XG4gICAgICAgICAgcmVzdWx0cy5zZXQoc3RhdC5pZCwgc3RhdCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9KTtcbiAgfTtcblxuICAvLyBmaXggbG93LWxldmVsIHN0YXQgbmFtZXMgYW5kIHJldHVybiBNYXAgaW5zdGVhZCBvZiBvYmplY3QuXG4gIHZhciBvcnRjT2JqZWN0cyA9IFsnUlRDUnRwU2VuZGVyJywgJ1JUQ1J0cFJlY2VpdmVyJywgJ1JUQ0ljZUdhdGhlcmVyJyxcbiAgICAnUlRDSWNlVHJhbnNwb3J0JywgJ1JUQ0R0bHNUcmFuc3BvcnQnXTtcbiAgb3J0Y09iamVjdHMuZm9yRWFjaChmdW5jdGlvbihvcnRjT2JqZWN0TmFtZSkge1xuICAgIHZhciBvYmogPSB3aW5kb3dbb3J0Y09iamVjdE5hbWVdO1xuICAgIGlmIChvYmogJiYgb2JqLnByb3RvdHlwZSAmJiBvYmoucHJvdG90eXBlLmdldFN0YXRzKSB7XG4gICAgICB2YXIgbmF0aXZlR2V0c3RhdHMgPSBvYmoucHJvdG90eXBlLmdldFN0YXRzO1xuICAgICAgb2JqLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmF0aXZlR2V0c3RhdHMuYXBwbHkodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24obmF0aXZlU3RhdHMpIHtcbiAgICAgICAgICB2YXIgbWFwU3RhdHMgPSBuZXcgTWFwKCk7XG4gICAgICAgICAgT2JqZWN0LmtleXMobmF0aXZlU3RhdHMpLmZvckVhY2goZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgICAgIG5hdGl2ZVN0YXRzW2lkXS50eXBlID0gZml4U3RhdHNUeXBlKG5hdGl2ZVN0YXRzW2lkXSk7XG4gICAgICAgICAgICBtYXBTdGF0cy5zZXQoaWQsIG5hdGl2ZVN0YXRzW2lkXSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIG1hcFN0YXRzO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfVxuICB9KTtcblxuICAvLyBsZWdhY3kgY2FsbGJhY2sgc2hpbXMuIFNob3VsZCBiZSBtb3ZlZCB0byBhZGFwdGVyLmpzIHNvbWUgZGF5cy5cbiAgdmFyIG1ldGhvZHMgPSBbJ2NyZWF0ZU9mZmVyJywgJ2NyZWF0ZUFuc3dlciddO1xuICBtZXRob2RzLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdO1xuICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIGlmICh0eXBlb2YgYXJnc1swXSA9PT0gJ2Z1bmN0aW9uJyB8fFxuICAgICAgICAgIHR5cGVvZiBhcmdzWzFdID09PSAnZnVuY3Rpb24nKSB7IC8vIGxlZ2FjeVxuICAgICAgICByZXR1cm4gbmF0aXZlTWV0aG9kLmFwcGx5KHRoaXMsIFthcmd1bWVudHNbMl1dKVxuICAgICAgICAudGhlbihmdW5jdGlvbihkZXNjcmlwdGlvbikge1xuICAgICAgICAgIGlmICh0eXBlb2YgYXJnc1swXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgYXJnc1swXS5hcHBseShudWxsLCBbZGVzY3JpcHRpb25dKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBhcmdzWzFdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBhcmdzWzFdLmFwcGx5KG51bGwsIFtlcnJvcl0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmF0aXZlTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfSk7XG5cbiAgbWV0aG9kcyA9IFsnc2V0TG9jYWxEZXNjcmlwdGlvbicsICdzZXRSZW1vdGVEZXNjcmlwdGlvbicsICdhZGRJY2VDYW5kaWRhdGUnXTtcbiAgbWV0aG9kcy5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTtcbiAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICBpZiAodHlwZW9mIGFyZ3NbMV0gPT09ICdmdW5jdGlvbicgfHxcbiAgICAgICAgICB0eXBlb2YgYXJnc1syXSA9PT0gJ2Z1bmN0aW9uJykgeyAvLyBsZWdhY3lcbiAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmICh0eXBlb2YgYXJnc1sxXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgYXJnc1sxXS5hcHBseShudWxsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBhcmdzWzJdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBhcmdzWzJdLmFwcGx5KG51bGwsIFtlcnJvcl0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmF0aXZlTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gZ2V0U3RhdHMgaXMgc3BlY2lhbC4gSXQgZG9lc24ndCBoYXZlIGEgc3BlYyBsZWdhY3kgbWV0aG9kIHlldCB3ZSBzdXBwb3J0XG4gIC8vIGdldFN0YXRzKHNvbWV0aGluZywgY2IpIHdpdGhvdXQgZXJyb3IgY2FsbGJhY2tzLlxuICBbJ2dldFN0YXRzJ10uZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHtcbiAgICB2YXIgbmF0aXZlTWV0aG9kID0gUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlW21ldGhvZF07XG4gICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgaWYgKHR5cGVvZiBhcmdzWzFdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiBuYXRpdmVNZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGFyZ3NbMV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGFyZ3NbMV0uYXBwbHkobnVsbCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuYXRpdmVNZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9KTtcblxuICByZXR1cm4gUlRDUGVlckNvbm5lY3Rpb247XG59O1xuIiwiLyogZXNsaW50LWVudiBub2RlICovXG4ndXNlIHN0cmljdCc7XG5cbi8vIFNEUCBoZWxwZXJzLlxudmFyIFNEUFV0aWxzID0ge307XG5cbi8vIEdlbmVyYXRlIGFuIGFscGhhbnVtZXJpYyBpZGVudGlmaWVyIGZvciBjbmFtZSBvciBtaWRzLlxuLy8gVE9ETzogdXNlIFVVSURzIGluc3RlYWQ/IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2plZC85ODI4ODNcblNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllciA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDEwKTtcbn07XG5cbi8vIFRoZSBSVENQIENOQU1FIHVzZWQgYnkgYWxsIHBlZXJjb25uZWN0aW9ucyBmcm9tIHRoZSBzYW1lIEpTLlxuU0RQVXRpbHMubG9jYWxDTmFtZSA9IFNEUFV0aWxzLmdlbmVyYXRlSWRlbnRpZmllcigpO1xuXG4vLyBTcGxpdHMgU0RQIGludG8gbGluZXMsIGRlYWxpbmcgd2l0aCBib3RoIENSTEYgYW5kIExGLlxuU0RQVXRpbHMuc3BsaXRMaW5lcyA9IGZ1bmN0aW9uKGJsb2IpIHtcbiAgcmV0dXJuIGJsb2IudHJpbSgpLnNwbGl0KCdcXG4nKS5tYXAoZnVuY3Rpb24obGluZSkge1xuICAgIHJldHVybiBsaW5lLnRyaW0oKTtcbiAgfSk7XG59O1xuLy8gU3BsaXRzIFNEUCBpbnRvIHNlc3Npb25wYXJ0IGFuZCBtZWRpYXNlY3Rpb25zLiBFbnN1cmVzIENSTEYuXG5TRFBVdGlscy5zcGxpdFNlY3Rpb25zID0gZnVuY3Rpb24oYmxvYikge1xuICB2YXIgcGFydHMgPSBibG9iLnNwbGl0KCdcXG5tPScpO1xuICByZXR1cm4gcGFydHMubWFwKGZ1bmN0aW9uKHBhcnQsIGluZGV4KSB7XG4gICAgcmV0dXJuIChpbmRleCA+IDAgPyAnbT0nICsgcGFydCA6IHBhcnQpLnRyaW0oKSArICdcXHJcXG4nO1xuICB9KTtcbn07XG5cbi8vIHJldHVybnMgdGhlIHNlc3Npb24gZGVzY3JpcHRpb24uXG5TRFBVdGlscy5nZXREZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKGJsb2IpIHtcbiAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhibG9iKTtcbiAgcmV0dXJuIHNlY3Rpb25zICYmIHNlY3Rpb25zWzBdO1xufTtcblxuLy8gcmV0dXJucyB0aGUgaW5kaXZpZHVhbCBtZWRpYSBzZWN0aW9ucy5cblNEUFV0aWxzLmdldE1lZGlhU2VjdGlvbnMgPSBmdW5jdGlvbihibG9iKSB7XG4gIHZhciBzZWN0aW9ucyA9IFNEUFV0aWxzLnNwbGl0U2VjdGlvbnMoYmxvYik7XG4gIHNlY3Rpb25zLnNoaWZ0KCk7XG4gIHJldHVybiBzZWN0aW9ucztcbn07XG5cbi8vIFJldHVybnMgbGluZXMgdGhhdCBzdGFydCB3aXRoIGEgY2VydGFpbiBwcmVmaXguXG5TRFBVdGlscy5tYXRjaFByZWZpeCA9IGZ1bmN0aW9uKGJsb2IsIHByZWZpeCkge1xuICByZXR1cm4gU0RQVXRpbHMuc3BsaXRMaW5lcyhibG9iKS5maWx0ZXIoZnVuY3Rpb24obGluZSkge1xuICAgIHJldHVybiBsaW5lLmluZGV4T2YocHJlZml4KSA9PT0gMDtcbiAgfSk7XG59O1xuXG4vLyBQYXJzZXMgYW4gSUNFIGNhbmRpZGF0ZSBsaW5lLiBTYW1wbGUgaW5wdXQ6XG4vLyBjYW5kaWRhdGU6NzAyNzg2MzUwIDIgdWRwIDQxODE5OTAyIDguOC44LjggNjA3NjkgdHlwIHJlbGF5IHJhZGRyIDguOC44Ljhcbi8vIHJwb3J0IDU1OTk2XCJcblNEUFV0aWxzLnBhcnNlQ2FuZGlkYXRlID0gZnVuY3Rpb24obGluZSkge1xuICB2YXIgcGFydHM7XG4gIC8vIFBhcnNlIGJvdGggdmFyaWFudHMuXG4gIGlmIChsaW5lLmluZGV4T2YoJ2E9Y2FuZGlkYXRlOicpID09PSAwKSB7XG4gICAgcGFydHMgPSBsaW5lLnN1YnN0cmluZygxMikuc3BsaXQoJyAnKTtcbiAgfSBlbHNlIHtcbiAgICBwYXJ0cyA9IGxpbmUuc3Vic3RyaW5nKDEwKS5zcGxpdCgnICcpO1xuICB9XG5cbiAgdmFyIGNhbmRpZGF0ZSA9IHtcbiAgICBmb3VuZGF0aW9uOiBwYXJ0c1swXSxcbiAgICBjb21wb25lbnQ6IHBhcnNlSW50KHBhcnRzWzFdLCAxMCksXG4gICAgcHJvdG9jb2w6IHBhcnRzWzJdLnRvTG93ZXJDYXNlKCksXG4gICAgcHJpb3JpdHk6IHBhcnNlSW50KHBhcnRzWzNdLCAxMCksXG4gICAgaXA6IHBhcnRzWzRdLFxuICAgIGFkZHJlc3M6IHBhcnRzWzRdLCAvLyBhZGRyZXNzIGlzIGFuIGFsaWFzIGZvciBpcC5cbiAgICBwb3J0OiBwYXJzZUludChwYXJ0c1s1XSwgMTApLFxuICAgIC8vIHNraXAgcGFydHNbNl0gPT0gJ3R5cCdcbiAgICB0eXBlOiBwYXJ0c1s3XVxuICB9O1xuXG4gIGZvciAodmFyIGkgPSA4OyBpIDwgcGFydHMubGVuZ3RoOyBpICs9IDIpIHtcbiAgICBzd2l0Y2ggKHBhcnRzW2ldKSB7XG4gICAgICBjYXNlICdyYWRkcic6XG4gICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyA9IHBhcnRzW2kgKyAxXTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdycG9ydCc6XG4gICAgICAgIGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCA9IHBhcnNlSW50KHBhcnRzW2kgKyAxXSwgMTApO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3RjcHR5cGUnOlxuICAgICAgICBjYW5kaWRhdGUudGNwVHlwZSA9IHBhcnRzW2kgKyAxXTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICd1ZnJhZyc6XG4gICAgICAgIGNhbmRpZGF0ZS51ZnJhZyA9IHBhcnRzW2kgKyAxXTsgLy8gZm9yIGJhY2t3YXJkIGNvbXBhYmlsaXR5LlxuICAgICAgICBjYW5kaWRhdGUudXNlcm5hbWVGcmFnbWVudCA9IHBhcnRzW2kgKyAxXTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OiAvLyBleHRlbnNpb24gaGFuZGxpbmcsIGluIHBhcnRpY3VsYXIgdWZyYWdcbiAgICAgICAgY2FuZGlkYXRlW3BhcnRzW2ldXSA9IHBhcnRzW2kgKyAxXTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIHJldHVybiBjYW5kaWRhdGU7XG59O1xuXG4vLyBUcmFuc2xhdGVzIGEgY2FuZGlkYXRlIG9iamVjdCBpbnRvIFNEUCBjYW5kaWRhdGUgYXR0cmlidXRlLlxuU0RQVXRpbHMud3JpdGVDYW5kaWRhdGUgPSBmdW5jdGlvbihjYW5kaWRhdGUpIHtcbiAgdmFyIHNkcCA9IFtdO1xuICBzZHAucHVzaChjYW5kaWRhdGUuZm91bmRhdGlvbik7XG4gIHNkcC5wdXNoKGNhbmRpZGF0ZS5jb21wb25lbnQpO1xuICBzZHAucHVzaChjYW5kaWRhdGUucHJvdG9jb2wudG9VcHBlckNhc2UoKSk7XG4gIHNkcC5wdXNoKGNhbmRpZGF0ZS5wcmlvcml0eSk7XG4gIHNkcC5wdXNoKGNhbmRpZGF0ZS5hZGRyZXNzIHx8IGNhbmRpZGF0ZS5pcCk7XG4gIHNkcC5wdXNoKGNhbmRpZGF0ZS5wb3J0KTtcblxuICB2YXIgdHlwZSA9IGNhbmRpZGF0ZS50eXBlO1xuICBzZHAucHVzaCgndHlwJyk7XG4gIHNkcC5wdXNoKHR5cGUpO1xuICBpZiAodHlwZSAhPT0gJ2hvc3QnICYmIGNhbmRpZGF0ZS5yZWxhdGVkQWRkcmVzcyAmJlxuICAgICAgY2FuZGlkYXRlLnJlbGF0ZWRQb3J0KSB7XG4gICAgc2RwLnB1c2goJ3JhZGRyJyk7XG4gICAgc2RwLnB1c2goY2FuZGlkYXRlLnJlbGF0ZWRBZGRyZXNzKTtcbiAgICBzZHAucHVzaCgncnBvcnQnKTtcbiAgICBzZHAucHVzaChjYW5kaWRhdGUucmVsYXRlZFBvcnQpO1xuICB9XG4gIGlmIChjYW5kaWRhdGUudGNwVHlwZSAmJiBjYW5kaWRhdGUucHJvdG9jb2wudG9Mb3dlckNhc2UoKSA9PT0gJ3RjcCcpIHtcbiAgICBzZHAucHVzaCgndGNwdHlwZScpO1xuICAgIHNkcC5wdXNoKGNhbmRpZGF0ZS50Y3BUeXBlKTtcbiAgfVxuICBpZiAoY2FuZGlkYXRlLnVzZXJuYW1lRnJhZ21lbnQgfHwgY2FuZGlkYXRlLnVmcmFnKSB7XG4gICAgc2RwLnB1c2goJ3VmcmFnJyk7XG4gICAgc2RwLnB1c2goY2FuZGlkYXRlLnVzZXJuYW1lRnJhZ21lbnQgfHwgY2FuZGlkYXRlLnVmcmFnKTtcbiAgfVxuICByZXR1cm4gJ2NhbmRpZGF0ZTonICsgc2RwLmpvaW4oJyAnKTtcbn07XG5cbi8vIFBhcnNlcyBhbiBpY2Utb3B0aW9ucyBsaW5lLCByZXR1cm5zIGFuIGFycmF5IG9mIG9wdGlvbiB0YWdzLlxuLy8gYT1pY2Utb3B0aW9uczpmb28gYmFyXG5TRFBVdGlscy5wYXJzZUljZU9wdGlvbnMgPSBmdW5jdGlvbihsaW5lKSB7XG4gIHJldHVybiBsaW5lLnN1YnN0cigxNCkuc3BsaXQoJyAnKTtcbn07XG5cbi8vIFBhcnNlcyBhbiBydHBtYXAgbGluZSwgcmV0dXJucyBSVENSdHBDb2RkZWNQYXJhbWV0ZXJzLiBTYW1wbGUgaW5wdXQ6XG4vLyBhPXJ0cG1hcDoxMTEgb3B1cy80ODAwMC8yXG5TRFBVdGlscy5wYXJzZVJ0cE1hcCA9IGZ1bmN0aW9uKGxpbmUpIHtcbiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIoOSkuc3BsaXQoJyAnKTtcbiAgdmFyIHBhcnNlZCA9IHtcbiAgICBwYXlsb2FkVHlwZTogcGFyc2VJbnQocGFydHMuc2hpZnQoKSwgMTApIC8vIHdhczogaWRcbiAgfTtcblxuICBwYXJ0cyA9IHBhcnRzWzBdLnNwbGl0KCcvJyk7XG5cbiAgcGFyc2VkLm5hbWUgPSBwYXJ0c1swXTtcbiAgcGFyc2VkLmNsb2NrUmF0ZSA9IHBhcnNlSW50KHBhcnRzWzFdLCAxMCk7IC8vIHdhczogY2xvY2tyYXRlXG4gIHBhcnNlZC5jaGFubmVscyA9IHBhcnRzLmxlbmd0aCA9PT0gMyA/IHBhcnNlSW50KHBhcnRzWzJdLCAxMCkgOiAxO1xuICAvLyBsZWdhY3kgYWxpYXMsIGdvdCByZW5hbWVkIGJhY2sgdG8gY2hhbm5lbHMgaW4gT1JUQy5cbiAgcGFyc2VkLm51bUNoYW5uZWxzID0gcGFyc2VkLmNoYW5uZWxzO1xuICByZXR1cm4gcGFyc2VkO1xufTtcblxuLy8gR2VuZXJhdGUgYW4gYT1ydHBtYXAgbGluZSBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvclxuLy8gUlRDUnRwQ29kZWNQYXJhbWV0ZXJzLlxuU0RQVXRpbHMud3JpdGVSdHBNYXAgPSBmdW5jdGlvbihjb2RlYykge1xuICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTtcbiAgaWYgKGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlICE9PSB1bmRlZmluZWQpIHtcbiAgICBwdCA9IGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlO1xuICB9XG4gIHZhciBjaGFubmVscyA9IGNvZGVjLmNoYW5uZWxzIHx8IGNvZGVjLm51bUNoYW5uZWxzIHx8IDE7XG4gIHJldHVybiAnYT1ydHBtYXA6JyArIHB0ICsgJyAnICsgY29kZWMubmFtZSArICcvJyArIGNvZGVjLmNsb2NrUmF0ZSArXG4gICAgICAoY2hhbm5lbHMgIT09IDEgPyAnLycgKyBjaGFubmVscyA6ICcnKSArICdcXHJcXG4nO1xufTtcblxuLy8gUGFyc2VzIGFuIGE9ZXh0bWFwIGxpbmUgKGhlYWRlcmV4dGVuc2lvbiBmcm9tIFJGQyA1Mjg1KS4gU2FtcGxlIGlucHV0OlxuLy8gYT1leHRtYXA6MiB1cm46aWV0ZjpwYXJhbXM6cnRwLWhkcmV4dDp0b2Zmc2V0XG4vLyBhPWV4dG1hcDoyL3NlbmRvbmx5IHVybjppZXRmOnBhcmFtczpydHAtaGRyZXh0OnRvZmZzZXRcblNEUFV0aWxzLnBhcnNlRXh0bWFwID0gZnVuY3Rpb24obGluZSkge1xuICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cig5KS5zcGxpdCgnICcpO1xuICByZXR1cm4ge1xuICAgIGlkOiBwYXJzZUludChwYXJ0c1swXSwgMTApLFxuICAgIGRpcmVjdGlvbjogcGFydHNbMF0uaW5kZXhPZignLycpID4gMCA/IHBhcnRzWzBdLnNwbGl0KCcvJylbMV0gOiAnc2VuZHJlY3YnLFxuICAgIHVyaTogcGFydHNbMV1cbiAgfTtcbn07XG5cbi8vIEdlbmVyYXRlcyBhPWV4dG1hcCBsaW5lIGZyb20gUlRDUnRwSGVhZGVyRXh0ZW5zaW9uUGFyYW1ldGVycyBvclxuLy8gUlRDUnRwSGVhZGVyRXh0ZW5zaW9uLlxuU0RQVXRpbHMud3JpdGVFeHRtYXAgPSBmdW5jdGlvbihoZWFkZXJFeHRlbnNpb24pIHtcbiAgcmV0dXJuICdhPWV4dG1hcDonICsgKGhlYWRlckV4dGVuc2lvbi5pZCB8fCBoZWFkZXJFeHRlbnNpb24ucHJlZmVycmVkSWQpICtcbiAgICAgIChoZWFkZXJFeHRlbnNpb24uZGlyZWN0aW9uICYmIGhlYWRlckV4dGVuc2lvbi5kaXJlY3Rpb24gIT09ICdzZW5kcmVjdidcbiAgICAgICAgPyAnLycgKyBoZWFkZXJFeHRlbnNpb24uZGlyZWN0aW9uXG4gICAgICAgIDogJycpICtcbiAgICAgICcgJyArIGhlYWRlckV4dGVuc2lvbi51cmkgKyAnXFxyXFxuJztcbn07XG5cbi8vIFBhcnNlcyBhbiBmdG1wIGxpbmUsIHJldHVybnMgZGljdGlvbmFyeS4gU2FtcGxlIGlucHV0OlxuLy8gYT1mbXRwOjk2IHZicj1vbjtjbmc9b25cbi8vIEFsc28gZGVhbHMgd2l0aCB2YnI9b247IGNuZz1vblxuU0RQVXRpbHMucGFyc2VGbXRwID0gZnVuY3Rpb24obGluZSkge1xuICB2YXIgcGFyc2VkID0ge307XG4gIHZhciBrdjtcbiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIobGluZS5pbmRleE9mKCcgJykgKyAxKS5zcGxpdCgnOycpO1xuICBmb3IgKHZhciBqID0gMDsgaiA8IHBhcnRzLmxlbmd0aDsgaisrKSB7XG4gICAga3YgPSBwYXJ0c1tqXS50cmltKCkuc3BsaXQoJz0nKTtcbiAgICBwYXJzZWRba3ZbMF0udHJpbSgpXSA9IGt2WzFdO1xuICB9XG4gIHJldHVybiBwYXJzZWQ7XG59O1xuXG4vLyBHZW5lcmF0ZXMgYW4gYT1mdG1wIGxpbmUgZnJvbSBSVENSdHBDb2RlY0NhcGFiaWxpdHkgb3IgUlRDUnRwQ29kZWNQYXJhbWV0ZXJzLlxuU0RQVXRpbHMud3JpdGVGbXRwID0gZnVuY3Rpb24oY29kZWMpIHtcbiAgdmFyIGxpbmUgPSAnJztcbiAgdmFyIHB0ID0gY29kZWMucGF5bG9hZFR5cGU7XG4gIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTtcbiAgfVxuICBpZiAoY29kZWMucGFyYW1ldGVycyAmJiBPYmplY3Qua2V5cyhjb2RlYy5wYXJhbWV0ZXJzKS5sZW5ndGgpIHtcbiAgICB2YXIgcGFyYW1zID0gW107XG4gICAgT2JqZWN0LmtleXMoY29kZWMucGFyYW1ldGVycykuZm9yRWFjaChmdW5jdGlvbihwYXJhbSkge1xuICAgICAgaWYgKGNvZGVjLnBhcmFtZXRlcnNbcGFyYW1dKSB7XG4gICAgICAgIHBhcmFtcy5wdXNoKHBhcmFtICsgJz0nICsgY29kZWMucGFyYW1ldGVyc1twYXJhbV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFyYW1zLnB1c2gocGFyYW0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGxpbmUgKz0gJ2E9Zm10cDonICsgcHQgKyAnICcgKyBwYXJhbXMuam9pbignOycpICsgJ1xcclxcbic7XG4gIH1cbiAgcmV0dXJuIGxpbmU7XG59O1xuXG4vLyBQYXJzZXMgYW4gcnRjcC1mYiBsaW5lLCByZXR1cm5zIFJUQ1BSdGNwRmVlZGJhY2sgb2JqZWN0LiBTYW1wbGUgaW5wdXQ6XG4vLyBhPXJ0Y3AtZmI6OTggbmFjayBycHNpXG5TRFBVdGlscy5wYXJzZVJ0Y3BGYiA9IGZ1bmN0aW9uKGxpbmUpIHtcbiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIobGluZS5pbmRleE9mKCcgJykgKyAxKS5zcGxpdCgnICcpO1xuICByZXR1cm4ge1xuICAgIHR5cGU6IHBhcnRzLnNoaWZ0KCksXG4gICAgcGFyYW1ldGVyOiBwYXJ0cy5qb2luKCcgJylcbiAgfTtcbn07XG4vLyBHZW5lcmF0ZSBhPXJ0Y3AtZmIgbGluZXMgZnJvbSBSVENSdHBDb2RlY0NhcGFiaWxpdHkgb3IgUlRDUnRwQ29kZWNQYXJhbWV0ZXJzLlxuU0RQVXRpbHMud3JpdGVSdGNwRmIgPSBmdW5jdGlvbihjb2RlYykge1xuICB2YXIgbGluZXMgPSAnJztcbiAgdmFyIHB0ID0gY29kZWMucGF5bG9hZFR5cGU7XG4gIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcHQgPSBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTtcbiAgfVxuICBpZiAoY29kZWMucnRjcEZlZWRiYWNrICYmIGNvZGVjLnJ0Y3BGZWVkYmFjay5sZW5ndGgpIHtcbiAgICAvLyBGSVhNRTogc3BlY2lhbCBoYW5kbGluZyBmb3IgdHJyLWludD9cbiAgICBjb2RlYy5ydGNwRmVlZGJhY2suZm9yRWFjaChmdW5jdGlvbihmYikge1xuICAgICAgbGluZXMgKz0gJ2E9cnRjcC1mYjonICsgcHQgKyAnICcgKyBmYi50eXBlICtcbiAgICAgIChmYi5wYXJhbWV0ZXIgJiYgZmIucGFyYW1ldGVyLmxlbmd0aCA/ICcgJyArIGZiLnBhcmFtZXRlciA6ICcnKSArXG4gICAgICAgICAgJ1xcclxcbic7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIGxpbmVzO1xufTtcblxuLy8gUGFyc2VzIGFuIFJGQyA1NTc2IHNzcmMgbWVkaWEgYXR0cmlidXRlLiBTYW1wbGUgaW5wdXQ6XG4vLyBhPXNzcmM6MzczNTkyODU1OSBjbmFtZTpzb21ldGhpbmdcblNEUFV0aWxzLnBhcnNlU3NyY01lZGlhID0gZnVuY3Rpb24obGluZSkge1xuICB2YXIgc3AgPSBsaW5lLmluZGV4T2YoJyAnKTtcbiAgdmFyIHBhcnRzID0ge1xuICAgIHNzcmM6IHBhcnNlSW50KGxpbmUuc3Vic3RyKDcsIHNwIC0gNyksIDEwKVxuICB9O1xuICB2YXIgY29sb24gPSBsaW5lLmluZGV4T2YoJzonLCBzcCk7XG4gIGlmIChjb2xvbiA+IC0xKSB7XG4gICAgcGFydHMuYXR0cmlidXRlID0gbGluZS5zdWJzdHIoc3AgKyAxLCBjb2xvbiAtIHNwIC0gMSk7XG4gICAgcGFydHMudmFsdWUgPSBsaW5lLnN1YnN0cihjb2xvbiArIDEpO1xuICB9IGVsc2Uge1xuICAgIHBhcnRzLmF0dHJpYnV0ZSA9IGxpbmUuc3Vic3RyKHNwICsgMSk7XG4gIH1cbiAgcmV0dXJuIHBhcnRzO1xufTtcblxuU0RQVXRpbHMucGFyc2VTc3JjR3JvdXAgPSBmdW5jdGlvbihsaW5lKSB7XG4gIHZhciBwYXJ0cyA9IGxpbmUuc3Vic3RyKDEzKS5zcGxpdCgnICcpO1xuICByZXR1cm4ge1xuICAgIHNlbWFudGljczogcGFydHMuc2hpZnQoKSxcbiAgICBzc3JjczogcGFydHMubWFwKGZ1bmN0aW9uKHNzcmMpIHtcbiAgICAgIHJldHVybiBwYXJzZUludChzc3JjLCAxMCk7XG4gICAgfSlcbiAgfTtcbn07XG5cbi8vIEV4dHJhY3RzIHRoZSBNSUQgKFJGQyA1ODg4KSBmcm9tIGEgbWVkaWEgc2VjdGlvbi5cbi8vIHJldHVybnMgdGhlIE1JRCBvciB1bmRlZmluZWQgaWYgbm8gbWlkIGxpbmUgd2FzIGZvdW5kLlxuU0RQVXRpbHMuZ2V0TWlkID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uKSB7XG4gIHZhciBtaWQgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPW1pZDonKVswXTtcbiAgaWYgKG1pZCkge1xuICAgIHJldHVybiBtaWQuc3Vic3RyKDYpO1xuICB9XG59O1xuXG5TRFBVdGlscy5wYXJzZUZpbmdlcnByaW50ID0gZnVuY3Rpb24obGluZSkge1xuICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cigxNCkuc3BsaXQoJyAnKTtcbiAgcmV0dXJuIHtcbiAgICBhbGdvcml0aG06IHBhcnRzWzBdLnRvTG93ZXJDYXNlKCksIC8vIGFsZ29yaXRobSBpcyBjYXNlLXNlbnNpdGl2ZSBpbiBFZGdlLlxuICAgIHZhbHVlOiBwYXJ0c1sxXVxuICB9O1xufTtcblxuLy8gRXh0cmFjdHMgRFRMUyBwYXJhbWV0ZXJzIGZyb20gU0RQIG1lZGlhIHNlY3Rpb24gb3Igc2Vzc2lvbnBhcnQuXG4vLyBGSVhNRTogZm9yIGNvbnNpc3RlbmN5IHdpdGggb3RoZXIgZnVuY3Rpb25zIHRoaXMgc2hvdWxkIG9ubHlcbi8vICAgZ2V0IHRoZSBmaW5nZXJwcmludCBsaW5lIGFzIGlucHV0LiBTZWUgYWxzbyBnZXRJY2VQYXJhbWV0ZXJzLlxuU0RQVXRpbHMuZ2V0RHRsc1BhcmFtZXRlcnMgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KSB7XG4gIHZhciBsaW5lcyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiArIHNlc3Npb25wYXJ0LFxuICAgICdhPWZpbmdlcnByaW50OicpO1xuICAvLyBOb3RlOiBhPXNldHVwIGxpbmUgaXMgaWdub3JlZCBzaW5jZSB3ZSB1c2UgdGhlICdhdXRvJyByb2xlLlxuICAvLyBOb3RlMjogJ2FsZ29yaXRobScgaXMgbm90IGNhc2Ugc2Vuc2l0aXZlIGV4Y2VwdCBpbiBFZGdlLlxuICByZXR1cm4ge1xuICAgIHJvbGU6ICdhdXRvJyxcbiAgICBmaW5nZXJwcmludHM6IGxpbmVzLm1hcChTRFBVdGlscy5wYXJzZUZpbmdlcnByaW50KVxuICB9O1xufTtcblxuLy8gU2VyaWFsaXplcyBEVExTIHBhcmFtZXRlcnMgdG8gU0RQLlxuU0RQVXRpbHMud3JpdGVEdGxzUGFyYW1ldGVycyA9IGZ1bmN0aW9uKHBhcmFtcywgc2V0dXBUeXBlKSB7XG4gIHZhciBzZHAgPSAnYT1zZXR1cDonICsgc2V0dXBUeXBlICsgJ1xcclxcbic7XG4gIHBhcmFtcy5maW5nZXJwcmludHMuZm9yRWFjaChmdW5jdGlvbihmcCkge1xuICAgIHNkcCArPSAnYT1maW5nZXJwcmludDonICsgZnAuYWxnb3JpdGhtICsgJyAnICsgZnAudmFsdWUgKyAnXFxyXFxuJztcbiAgfSk7XG4gIHJldHVybiBzZHA7XG59O1xuXG4vLyBQYXJzZXMgYT1jcnlwdG8gbGluZXMgaW50b1xuLy8gICBodHRwczovL3Jhd2dpdC5jb20vYWJvYmEvZWRnZXJ0Yy9tYXN0ZXIvbXNvcnRjLXJzNC5odG1sI2RpY3Rpb25hcnktcnRjc3J0cHNkZXNwYXJhbWV0ZXJzLW1lbWJlcnNcblNEUFV0aWxzLnBhcnNlQ3J5cHRvTGluZSA9IGZ1bmN0aW9uKGxpbmUpIHtcbiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIoOSkuc3BsaXQoJyAnKTtcbiAgcmV0dXJuIHtcbiAgICB0YWc6IHBhcnNlSW50KHBhcnRzWzBdLCAxMCksXG4gICAgY3J5cHRvU3VpdGU6IHBhcnRzWzFdLFxuICAgIGtleVBhcmFtczogcGFydHNbMl0sXG4gICAgc2Vzc2lvblBhcmFtczogcGFydHMuc2xpY2UoMyksXG4gIH07XG59O1xuXG5TRFBVdGlscy53cml0ZUNyeXB0b0xpbmUgPSBmdW5jdGlvbihwYXJhbWV0ZXJzKSB7XG4gIHJldHVybiAnYT1jcnlwdG86JyArIHBhcmFtZXRlcnMudGFnICsgJyAnICtcbiAgICBwYXJhbWV0ZXJzLmNyeXB0b1N1aXRlICsgJyAnICtcbiAgICAodHlwZW9mIHBhcmFtZXRlcnMua2V5UGFyYW1zID09PSAnb2JqZWN0J1xuICAgICAgPyBTRFBVdGlscy53cml0ZUNyeXB0b0tleVBhcmFtcyhwYXJhbWV0ZXJzLmtleVBhcmFtcylcbiAgICAgIDogcGFyYW1ldGVycy5rZXlQYXJhbXMpICtcbiAgICAocGFyYW1ldGVycy5zZXNzaW9uUGFyYW1zID8gJyAnICsgcGFyYW1ldGVycy5zZXNzaW9uUGFyYW1zLmpvaW4oJyAnKSA6ICcnKSArXG4gICAgJ1xcclxcbic7XG59O1xuXG4vLyBQYXJzZXMgdGhlIGNyeXB0byBrZXkgcGFyYW1ldGVycyBpbnRvXG4vLyAgIGh0dHBzOi8vcmF3Z2l0LmNvbS9hYm9iYS9lZGdlcnRjL21hc3Rlci9tc29ydGMtcnM0Lmh0bWwjcnRjc3J0cGtleXBhcmFtKlxuU0RQVXRpbHMucGFyc2VDcnlwdG9LZXlQYXJhbXMgPSBmdW5jdGlvbihrZXlQYXJhbXMpIHtcbiAgaWYgKGtleVBhcmFtcy5pbmRleE9mKCdpbmxpbmU6JykgIT09IDApIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICB2YXIgcGFydHMgPSBrZXlQYXJhbXMuc3Vic3RyKDcpLnNwbGl0KCd8Jyk7XG4gIHJldHVybiB7XG4gICAga2V5TWV0aG9kOiAnaW5saW5lJyxcbiAgICBrZXlTYWx0OiBwYXJ0c1swXSxcbiAgICBsaWZlVGltZTogcGFydHNbMV0sXG4gICAgbWtpVmFsdWU6IHBhcnRzWzJdID8gcGFydHNbMl0uc3BsaXQoJzonKVswXSA6IHVuZGVmaW5lZCxcbiAgICBta2lMZW5ndGg6IHBhcnRzWzJdID8gcGFydHNbMl0uc3BsaXQoJzonKVsxXSA6IHVuZGVmaW5lZCxcbiAgfTtcbn07XG5cblNEUFV0aWxzLndyaXRlQ3J5cHRvS2V5UGFyYW1zID0gZnVuY3Rpb24oa2V5UGFyYW1zKSB7XG4gIHJldHVybiBrZXlQYXJhbXMua2V5TWV0aG9kICsgJzonXG4gICAgKyBrZXlQYXJhbXMua2V5U2FsdCArXG4gICAgKGtleVBhcmFtcy5saWZlVGltZSA/ICd8JyArIGtleVBhcmFtcy5saWZlVGltZSA6ICcnKSArXG4gICAgKGtleVBhcmFtcy5ta2lWYWx1ZSAmJiBrZXlQYXJhbXMubWtpTGVuZ3RoXG4gICAgICA/ICd8JyArIGtleVBhcmFtcy5ta2lWYWx1ZSArICc6JyArIGtleVBhcmFtcy5ta2lMZW5ndGhcbiAgICAgIDogJycpO1xufTtcblxuLy8gRXh0cmFjdHMgYWxsIFNERVMgcGFyYW10ZXJzLlxuU0RQVXRpbHMuZ2V0Q3J5cHRvUGFyYW1ldGVycyA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbiwgc2Vzc2lvbnBhcnQpIHtcbiAgdmFyIGxpbmVzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uICsgc2Vzc2lvbnBhcnQsXG4gICAgJ2E9Y3J5cHRvOicpO1xuICByZXR1cm4gbGluZXMubWFwKFNEUFV0aWxzLnBhcnNlQ3J5cHRvTGluZSk7XG59O1xuXG4vLyBQYXJzZXMgSUNFIGluZm9ybWF0aW9uIGZyb20gU0RQIG1lZGlhIHNlY3Rpb24gb3Igc2Vzc2lvbnBhcnQuXG4vLyBGSVhNRTogZm9yIGNvbnNpc3RlbmN5IHdpdGggb3RoZXIgZnVuY3Rpb25zIHRoaXMgc2hvdWxkIG9ubHlcbi8vICAgZ2V0IHRoZSBpY2UtdWZyYWcgYW5kIGljZS1wd2QgbGluZXMgYXMgaW5wdXQuXG5TRFBVdGlscy5nZXRJY2VQYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkge1xuICB2YXIgdWZyYWcgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24gKyBzZXNzaW9ucGFydCxcbiAgICAnYT1pY2UtdWZyYWc6JylbMF07XG4gIHZhciBwd2QgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24gKyBzZXNzaW9ucGFydCxcbiAgICAnYT1pY2UtcHdkOicpWzBdO1xuICBpZiAoISh1ZnJhZyAmJiBwd2QpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICB1c2VybmFtZUZyYWdtZW50OiB1ZnJhZy5zdWJzdHIoMTIpLFxuICAgIHBhc3N3b3JkOiBwd2Quc3Vic3RyKDEwKSxcbiAgfTtcbn07XG5cbi8vIFNlcmlhbGl6ZXMgSUNFIHBhcmFtZXRlcnMgdG8gU0RQLlxuU0RQVXRpbHMud3JpdGVJY2VQYXJhbWV0ZXJzID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gIHJldHVybiAnYT1pY2UtdWZyYWc6JyArIHBhcmFtcy51c2VybmFtZUZyYWdtZW50ICsgJ1xcclxcbicgK1xuICAgICAgJ2E9aWNlLXB3ZDonICsgcGFyYW1zLnBhc3N3b3JkICsgJ1xcclxcbic7XG59O1xuXG4vLyBQYXJzZXMgdGhlIFNEUCBtZWRpYSBzZWN0aW9uIGFuZCByZXR1cm5zIFJUQ1J0cFBhcmFtZXRlcnMuXG5TRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHtcbiAgdmFyIGRlc2NyaXB0aW9uID0ge1xuICAgIGNvZGVjczogW10sXG4gICAgaGVhZGVyRXh0ZW5zaW9uczogW10sXG4gICAgZmVjTWVjaGFuaXNtczogW10sXG4gICAgcnRjcDogW11cbiAgfTtcbiAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pO1xuICB2YXIgbWxpbmUgPSBsaW5lc1swXS5zcGxpdCgnICcpO1xuICBmb3IgKHZhciBpID0gMzsgaSA8IG1saW5lLmxlbmd0aDsgaSsrKSB7IC8vIGZpbmQgYWxsIGNvZGVjcyBmcm9tIG1saW5lWzMuLl1cbiAgICB2YXIgcHQgPSBtbGluZVtpXTtcbiAgICB2YXIgcnRwbWFwbGluZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KFxuICAgICAgbWVkaWFTZWN0aW9uLCAnYT1ydHBtYXA6JyArIHB0ICsgJyAnKVswXTtcbiAgICBpZiAocnRwbWFwbGluZSkge1xuICAgICAgdmFyIGNvZGVjID0gU0RQVXRpbHMucGFyc2VSdHBNYXAocnRwbWFwbGluZSk7XG4gICAgICB2YXIgZm10cHMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChcbiAgICAgICAgbWVkaWFTZWN0aW9uLCAnYT1mbXRwOicgKyBwdCArICcgJyk7XG4gICAgICAvLyBPbmx5IHRoZSBmaXJzdCBhPWZtdHA6PHB0PiBpcyBjb25zaWRlcmVkLlxuICAgICAgY29kZWMucGFyYW1ldGVycyA9IGZtdHBzLmxlbmd0aCA/IFNEUFV0aWxzLnBhcnNlRm10cChmbXRwc1swXSkgOiB7fTtcbiAgICAgIGNvZGVjLnJ0Y3BGZWVkYmFjayA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KFxuICAgICAgICBtZWRpYVNlY3Rpb24sICdhPXJ0Y3AtZmI6JyArIHB0ICsgJyAnKVxuICAgICAgICAubWFwKFNEUFV0aWxzLnBhcnNlUnRjcEZiKTtcbiAgICAgIGRlc2NyaXB0aW9uLmNvZGVjcy5wdXNoKGNvZGVjKTtcbiAgICAgIC8vIHBhcnNlIEZFQyBtZWNoYW5pc21zIGZyb20gcnRwbWFwIGxpbmVzLlxuICAgICAgc3dpdGNoIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgY2FzZSAnUkVEJzpcbiAgICAgICAgY2FzZSAnVUxQRkVDJzpcbiAgICAgICAgICBkZXNjcmlwdGlvbi5mZWNNZWNoYW5pc21zLnB1c2goY29kZWMubmFtZS50b1VwcGVyQ2FzZSgpKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDogLy8gb25seSBSRUQgYW5kIFVMUEZFQyBhcmUgcmVjb2duaXplZCBhcyBGRUMgbWVjaGFuaXNtcy5cbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1leHRtYXA6JykuZm9yRWFjaChmdW5jdGlvbihsaW5lKSB7XG4gICAgZGVzY3JpcHRpb24uaGVhZGVyRXh0ZW5zaW9ucy5wdXNoKFNEUFV0aWxzLnBhcnNlRXh0bWFwKGxpbmUpKTtcbiAgfSk7XG4gIC8vIEZJWE1FOiBwYXJzZSBydGNwLlxuICByZXR1cm4gZGVzY3JpcHRpb247XG59O1xuXG4vLyBHZW5lcmF0ZXMgcGFydHMgb2YgdGhlIFNEUCBtZWRpYSBzZWN0aW9uIGRlc2NyaWJpbmcgdGhlIGNhcGFiaWxpdGllcyAvXG4vLyBwYXJhbWV0ZXJzLlxuU0RQVXRpbHMud3JpdGVSdHBEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKGtpbmQsIGNhcHMpIHtcbiAgdmFyIHNkcCA9ICcnO1xuXG4gIC8vIEJ1aWxkIHRoZSBtbGluZS5cbiAgc2RwICs9ICdtPScgKyBraW5kICsgJyAnO1xuICBzZHAgKz0gY2Fwcy5jb2RlY3MubGVuZ3RoID4gMCA/ICc5JyA6ICcwJzsgLy8gcmVqZWN0IGlmIG5vIGNvZGVjcy5cbiAgc2RwICs9ICcgVURQL1RMUy9SVFAvU0FWUEYgJztcbiAgc2RwICs9IGNhcHMuY29kZWNzLm1hcChmdW5jdGlvbihjb2RlYykge1xuICAgIGlmIChjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGU7XG4gICAgfVxuICAgIHJldHVybiBjb2RlYy5wYXlsb2FkVHlwZTtcbiAgfSkuam9pbignICcpICsgJ1xcclxcbic7XG5cbiAgc2RwICs9ICdjPUlOIElQNCAwLjAuMC4wXFxyXFxuJztcbiAgc2RwICs9ICdhPXJ0Y3A6OSBJTiBJUDQgMC4wLjAuMFxcclxcbic7XG5cbiAgLy8gQWRkIGE9cnRwbWFwIGxpbmVzIGZvciBlYWNoIGNvZGVjLiBBbHNvIGZtdHAgYW5kIHJ0Y3AtZmIuXG4gIGNhcHMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHtcbiAgICBzZHAgKz0gU0RQVXRpbHMud3JpdGVSdHBNYXAoY29kZWMpO1xuICAgIHNkcCArPSBTRFBVdGlscy53cml0ZUZtdHAoY29kZWMpO1xuICAgIHNkcCArPSBTRFBVdGlscy53cml0ZVJ0Y3BGYihjb2RlYyk7XG4gIH0pO1xuICB2YXIgbWF4cHRpbWUgPSAwO1xuICBjYXBzLmNvZGVjcy5mb3JFYWNoKGZ1bmN0aW9uKGNvZGVjKSB7XG4gICAgaWYgKGNvZGVjLm1heHB0aW1lID4gbWF4cHRpbWUpIHtcbiAgICAgIG1heHB0aW1lID0gY29kZWMubWF4cHRpbWU7XG4gICAgfVxuICB9KTtcbiAgaWYgKG1heHB0aW1lID4gMCkge1xuICAgIHNkcCArPSAnYT1tYXhwdGltZTonICsgbWF4cHRpbWUgKyAnXFxyXFxuJztcbiAgfVxuICBzZHAgKz0gJ2E9cnRjcC1tdXhcXHJcXG4nO1xuXG4gIGlmIChjYXBzLmhlYWRlckV4dGVuc2lvbnMpIHtcbiAgICBjYXBzLmhlYWRlckV4dGVuc2lvbnMuZm9yRWFjaChmdW5jdGlvbihleHRlbnNpb24pIHtcbiAgICAgIHNkcCArPSBTRFBVdGlscy53cml0ZUV4dG1hcChleHRlbnNpb24pO1xuICAgIH0pO1xuICB9XG4gIC8vIEZJWE1FOiB3cml0ZSBmZWNNZWNoYW5pc21zLlxuICByZXR1cm4gc2RwO1xufTtcblxuLy8gUGFyc2VzIHRoZSBTRFAgbWVkaWEgc2VjdGlvbiBhbmQgcmV0dXJucyBhbiBhcnJheSBvZlxuLy8gUlRDUnRwRW5jb2RpbmdQYXJhbWV0ZXJzLlxuU0RQVXRpbHMucGFyc2VSdHBFbmNvZGluZ1BhcmFtZXRlcnMgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHtcbiAgdmFyIGVuY29kaW5nUGFyYW1ldGVycyA9IFtdO1xuICB2YXIgZGVzY3JpcHRpb24gPSBTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMobWVkaWFTZWN0aW9uKTtcbiAgdmFyIGhhc1JlZCA9IGRlc2NyaXB0aW9uLmZlY01lY2hhbmlzbXMuaW5kZXhPZignUkVEJykgIT09IC0xO1xuICB2YXIgaGFzVWxwZmVjID0gZGVzY3JpcHRpb24uZmVjTWVjaGFuaXNtcy5pbmRleE9mKCdVTFBGRUMnKSAhPT0gLTE7XG5cbiAgLy8gZmlsdGVyIGE9c3NyYzouLi4gY25hbWU6LCBpZ25vcmUgUGxhbkItbXNpZFxuICB2YXIgc3NyY3MgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXNzcmM6JylcbiAgICAubWFwKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgIHJldHVybiBTRFBVdGlscy5wYXJzZVNzcmNNZWRpYShsaW5lKTtcbiAgICB9KVxuICAgIC5maWx0ZXIoZnVuY3Rpb24ocGFydHMpIHtcbiAgICAgIHJldHVybiBwYXJ0cy5hdHRyaWJ1dGUgPT09ICdjbmFtZSc7XG4gICAgfSk7XG4gIHZhciBwcmltYXJ5U3NyYyA9IHNzcmNzLmxlbmd0aCA+IDAgJiYgc3NyY3NbMF0uc3NyYztcbiAgdmFyIHNlY29uZGFyeVNzcmM7XG5cbiAgdmFyIGZsb3dzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjLWdyb3VwOkZJRCcpXG4gICAgLm1hcChmdW5jdGlvbihsaW5lKSB7XG4gICAgICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cigxNykuc3BsaXQoJyAnKTtcbiAgICAgIHJldHVybiBwYXJ0cy5tYXAoZnVuY3Rpb24ocGFydCkge1xuICAgICAgICByZXR1cm4gcGFyc2VJbnQocGFydCwgMTApO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIGlmIChmbG93cy5sZW5ndGggPiAwICYmIGZsb3dzWzBdLmxlbmd0aCA+IDEgJiYgZmxvd3NbMF1bMF0gPT09IHByaW1hcnlTc3JjKSB7XG4gICAgc2Vjb25kYXJ5U3NyYyA9IGZsb3dzWzBdWzFdO1xuICB9XG5cbiAgZGVzY3JpcHRpb24uY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHtcbiAgICBpZiAoY29kZWMubmFtZS50b1VwcGVyQ2FzZSgpID09PSAnUlRYJyAmJiBjb2RlYy5wYXJhbWV0ZXJzLmFwdCkge1xuICAgICAgdmFyIGVuY1BhcmFtID0ge1xuICAgICAgICBzc3JjOiBwcmltYXJ5U3NyYyxcbiAgICAgICAgY29kZWNQYXlsb2FkVHlwZTogcGFyc2VJbnQoY29kZWMucGFyYW1ldGVycy5hcHQsIDEwKVxuICAgICAgfTtcbiAgICAgIGlmIChwcmltYXJ5U3NyYyAmJiBzZWNvbmRhcnlTc3JjKSB7XG4gICAgICAgIGVuY1BhcmFtLnJ0eCA9IHtzc3JjOiBzZWNvbmRhcnlTc3JjfTtcbiAgICAgIH1cbiAgICAgIGVuY29kaW5nUGFyYW1ldGVycy5wdXNoKGVuY1BhcmFtKTtcbiAgICAgIGlmIChoYXNSZWQpIHtcbiAgICAgICAgZW5jUGFyYW0gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGVuY1BhcmFtKSk7XG4gICAgICAgIGVuY1BhcmFtLmZlYyA9IHtcbiAgICAgICAgICBzc3JjOiBwcmltYXJ5U3NyYyxcbiAgICAgICAgICBtZWNoYW5pc206IGhhc1VscGZlYyA/ICdyZWQrdWxwZmVjJyA6ICdyZWQnXG4gICAgICAgIH07XG4gICAgICAgIGVuY29kaW5nUGFyYW1ldGVycy5wdXNoKGVuY1BhcmFtKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBpZiAoZW5jb2RpbmdQYXJhbWV0ZXJzLmxlbmd0aCA9PT0gMCAmJiBwcmltYXJ5U3NyYykge1xuICAgIGVuY29kaW5nUGFyYW1ldGVycy5wdXNoKHtcbiAgICAgIHNzcmM6IHByaW1hcnlTc3JjXG4gICAgfSk7XG4gIH1cblxuICAvLyB3ZSBzdXBwb3J0IGJvdGggYj1BUyBhbmQgYj1USUFTIGJ1dCBpbnRlcnByZXQgQVMgYXMgVElBUy5cbiAgdmFyIGJhbmR3aWR0aCA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiwgJ2I9Jyk7XG4gIGlmIChiYW5kd2lkdGgubGVuZ3RoKSB7XG4gICAgaWYgKGJhbmR3aWR0aFswXS5pbmRleE9mKCdiPVRJQVM6JykgPT09IDApIHtcbiAgICAgIGJhbmR3aWR0aCA9IHBhcnNlSW50KGJhbmR3aWR0aFswXS5zdWJzdHIoNyksIDEwKTtcbiAgICB9IGVsc2UgaWYgKGJhbmR3aWR0aFswXS5pbmRleE9mKCdiPUFTOicpID09PSAwKSB7XG4gICAgICAvLyB1c2UgZm9ybXVsYSBmcm9tIEpTRVAgdG8gY29udmVydCBiPUFTIHRvIFRJQVMgdmFsdWUuXG4gICAgICBiYW5kd2lkdGggPSBwYXJzZUludChiYW5kd2lkdGhbMF0uc3Vic3RyKDUpLCAxMCkgKiAxMDAwICogMC45NVxuICAgICAgICAgIC0gKDUwICogNDAgKiA4KTtcbiAgICB9IGVsc2Uge1xuICAgICAgYmFuZHdpZHRoID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBlbmNvZGluZ1BhcmFtZXRlcnMuZm9yRWFjaChmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgIHBhcmFtcy5tYXhCaXRyYXRlID0gYmFuZHdpZHRoO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBlbmNvZGluZ1BhcmFtZXRlcnM7XG59O1xuXG4vLyBwYXJzZXMgaHR0cDovL2RyYWZ0Lm9ydGMub3JnLyNydGNydGNwcGFyYW1ldGVycypcblNEUFV0aWxzLnBhcnNlUnRjcFBhcmFtZXRlcnMgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHtcbiAgdmFyIHJ0Y3BQYXJhbWV0ZXJzID0ge307XG5cbiAgLy8gR2V0cyB0aGUgZmlyc3QgU1NSQy4gTm90ZSB0aGEgd2l0aCBSVFggdGhlcmUgbWlnaHQgYmUgbXVsdGlwbGVcbiAgLy8gU1NSQ3MuXG4gIHZhciByZW1vdGVTc3JjID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjOicpXG4gICAgLm1hcChmdW5jdGlvbihsaW5lKSB7XG4gICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7XG4gICAgfSlcbiAgICAuZmlsdGVyKGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIG9iai5hdHRyaWJ1dGUgPT09ICdjbmFtZSc7XG4gICAgfSlbMF07XG4gIGlmIChyZW1vdGVTc3JjKSB7XG4gICAgcnRjcFBhcmFtZXRlcnMuY25hbWUgPSByZW1vdGVTc3JjLnZhbHVlO1xuICAgIHJ0Y3BQYXJhbWV0ZXJzLnNzcmMgPSByZW1vdGVTc3JjLnNzcmM7XG4gIH1cblxuICAvLyBFZGdlIHVzZXMgdGhlIGNvbXBvdW5kIGF0dHJpYnV0ZSBpbnN0ZWFkIG9mIHJlZHVjZWRTaXplXG4gIC8vIGNvbXBvdW5kIGlzICFyZWR1Y2VkU2l6ZVxuICB2YXIgcnNpemUgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXJ0Y3AtcnNpemUnKTtcbiAgcnRjcFBhcmFtZXRlcnMucmVkdWNlZFNpemUgPSByc2l6ZS5sZW5ndGggPiAwO1xuICBydGNwUGFyYW1ldGVycy5jb21wb3VuZCA9IHJzaXplLmxlbmd0aCA9PT0gMDtcblxuICAvLyBwYXJzZXMgdGhlIHJ0Y3AtbXV4IGF0dHLRlmJ1dGUuXG4gIC8vIE5vdGUgdGhhdCBFZGdlIGRvZXMgbm90IHN1cHBvcnQgdW5tdXhlZCBSVENQLlxuICB2YXIgbXV4ID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1ydGNwLW11eCcpO1xuICBydGNwUGFyYW1ldGVycy5tdXggPSBtdXgubGVuZ3RoID4gMDtcblxuICByZXR1cm4gcnRjcFBhcmFtZXRlcnM7XG59O1xuXG4vLyBwYXJzZXMgZWl0aGVyIGE9bXNpZDogb3IgYT1zc3JjOi4uLiBtc2lkIGxpbmVzIGFuZCByZXR1cm5zXG4vLyB0aGUgaWQgb2YgdGhlIE1lZGlhU3RyZWFtIGFuZCBNZWRpYVN0cmVhbVRyYWNrLlxuU0RQVXRpbHMucGFyc2VNc2lkID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uKSB7XG4gIHZhciBwYXJ0cztcbiAgdmFyIHNwZWMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPW1zaWQ6Jyk7XG4gIGlmIChzcGVjLmxlbmd0aCA9PT0gMSkge1xuICAgIHBhcnRzID0gc3BlY1swXS5zdWJzdHIoNykuc3BsaXQoJyAnKTtcbiAgICByZXR1cm4ge3N0cmVhbTogcGFydHNbMF0sIHRyYWNrOiBwYXJ0c1sxXX07XG4gIH1cbiAgdmFyIHBsYW5CID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zc3JjOicpXG4gICAgLm1hcChmdW5jdGlvbihsaW5lKSB7XG4gICAgICByZXR1cm4gU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEobGluZSk7XG4gICAgfSlcbiAgICAuZmlsdGVyKGZ1bmN0aW9uKG1zaWRQYXJ0cykge1xuICAgICAgcmV0dXJuIG1zaWRQYXJ0cy5hdHRyaWJ1dGUgPT09ICdtc2lkJztcbiAgICB9KTtcbiAgaWYgKHBsYW5CLmxlbmd0aCA+IDApIHtcbiAgICBwYXJ0cyA9IHBsYW5CWzBdLnZhbHVlLnNwbGl0KCcgJyk7XG4gICAgcmV0dXJuIHtzdHJlYW06IHBhcnRzWzBdLCB0cmFjazogcGFydHNbMV19O1xuICB9XG59O1xuXG4vLyBTQ1RQXG4vLyBwYXJzZXMgZHJhZnQtaWV0Zi1tbXVzaWMtc2N0cC1zZHAtMjYgZmlyc3QgYW5kIGZhbGxzIGJhY2tcbi8vIHRvIGRyYWZ0LWlldGYtbW11c2ljLXNjdHAtc2RwLTA1XG5TRFBVdGlscy5wYXJzZVNjdHBEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbikge1xuICB2YXIgbWxpbmUgPSBTRFBVdGlscy5wYXJzZU1MaW5lKG1lZGlhU2VjdGlvbik7XG4gIHZhciBtYXhTaXplTGluZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiwgJ2E9bWF4LW1lc3NhZ2Utc2l6ZTonKTtcbiAgdmFyIG1heE1lc3NhZ2VTaXplO1xuICBpZiAobWF4U2l6ZUxpbmUubGVuZ3RoID4gMCkge1xuICAgIG1heE1lc3NhZ2VTaXplID0gcGFyc2VJbnQobWF4U2l6ZUxpbmVbMF0uc3Vic3RyKDE5KSwgMTApO1xuICB9XG4gIGlmIChpc05hTihtYXhNZXNzYWdlU2l6ZSkpIHtcbiAgICBtYXhNZXNzYWdlU2l6ZSA9IDY1NTM2O1xuICB9XG4gIHZhciBzY3RwUG9ydCA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiwgJ2E9c2N0cC1wb3J0OicpO1xuICBpZiAoc2N0cFBvcnQubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiB7XG4gICAgICBwb3J0OiBwYXJzZUludChzY3RwUG9ydFswXS5zdWJzdHIoMTIpLCAxMCksXG4gICAgICBwcm90b2NvbDogbWxpbmUuZm10LFxuICAgICAgbWF4TWVzc2FnZVNpemU6IG1heE1lc3NhZ2VTaXplXG4gICAgfTtcbiAgfVxuICB2YXIgc2N0cE1hcExpbmVzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zY3RwbWFwOicpO1xuICBpZiAoc2N0cE1hcExpbmVzLmxlbmd0aCA+IDApIHtcbiAgICB2YXIgcGFydHMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXNjdHBtYXA6JylbMF1cbiAgICAgIC5zdWJzdHIoMTApXG4gICAgICAuc3BsaXQoJyAnKTtcbiAgICByZXR1cm4ge1xuICAgICAgcG9ydDogcGFyc2VJbnQocGFydHNbMF0sIDEwKSxcbiAgICAgIHByb3RvY29sOiBwYXJ0c1sxXSxcbiAgICAgIG1heE1lc3NhZ2VTaXplOiBtYXhNZXNzYWdlU2l6ZVxuICAgIH07XG4gIH1cbn07XG5cbi8vIFNDVFBcbi8vIG91dHB1dHMgdGhlIGRyYWZ0LWlldGYtbW11c2ljLXNjdHAtc2RwLTI2IHZlcnNpb24gdGhhdCBhbGwgYnJvd3NlcnNcbi8vIHN1cHBvcnQgYnkgbm93IHJlY2VpdmluZyBpbiB0aGlzIGZvcm1hdCwgdW5sZXNzIHdlIG9yaWdpbmFsbHkgcGFyc2VkXG4vLyBhcyB0aGUgZHJhZnQtaWV0Zi1tbXVzaWMtc2N0cC1zZHAtMDUgZm9ybWF0IChpbmRpY2F0ZWQgYnkgdGhlIG0tbGluZVxuLy8gcHJvdG9jb2wgb2YgRFRMUy9TQ1RQIC0tIHdpdGhvdXQgVURQLyBvciBUQ1AvKVxuU0RQVXRpbHMud3JpdGVTY3RwRGVzY3JpcHRpb24gPSBmdW5jdGlvbihtZWRpYSwgc2N0cCkge1xuICB2YXIgb3V0cHV0ID0gW107XG4gIGlmIChtZWRpYS5wcm90b2NvbCAhPT0gJ0RUTFMvU0NUUCcpIHtcbiAgICBvdXRwdXQgPSBbXG4gICAgICAnbT0nICsgbWVkaWEua2luZCArICcgOSAnICsgbWVkaWEucHJvdG9jb2wgKyAnICcgKyBzY3RwLnByb3RvY29sICsgJ1xcclxcbicsXG4gICAgICAnYz1JTiBJUDQgMC4wLjAuMFxcclxcbicsXG4gICAgICAnYT1zY3RwLXBvcnQ6JyArIHNjdHAucG9ydCArICdcXHJcXG4nXG4gICAgXTtcbiAgfSBlbHNlIHtcbiAgICBvdXRwdXQgPSBbXG4gICAgICAnbT0nICsgbWVkaWEua2luZCArICcgOSAnICsgbWVkaWEucHJvdG9jb2wgKyAnICcgKyBzY3RwLnBvcnQgKyAnXFxyXFxuJyxcbiAgICAgICdjPUlOIElQNCAwLjAuMC4wXFxyXFxuJyxcbiAgICAgICdhPXNjdHBtYXA6JyArIHNjdHAucG9ydCArICcgJyArIHNjdHAucHJvdG9jb2wgKyAnIDY1NTM1XFxyXFxuJ1xuICAgIF07XG4gIH1cbiAgaWYgKHNjdHAubWF4TWVzc2FnZVNpemUgIT09IHVuZGVmaW5lZCkge1xuICAgIG91dHB1dC5wdXNoKCdhPW1heC1tZXNzYWdlLXNpemU6JyArIHNjdHAubWF4TWVzc2FnZVNpemUgKyAnXFxyXFxuJyk7XG4gIH1cbiAgcmV0dXJuIG91dHB1dC5qb2luKCcnKTtcbn07XG5cbi8vIEdlbmVyYXRlIGEgc2Vzc2lvbiBJRCBmb3IgU0RQLlxuLy8gaHR0cHM6Ly90b29scy5pZXRmLm9yZy9odG1sL2RyYWZ0LWlldGYtcnRjd2ViLWpzZXAtMjAjc2VjdGlvbi01LjIuMVxuLy8gcmVjb21tZW5kcyB1c2luZyBhIGNyeXB0b2dyYXBoaWNhbGx5IHJhbmRvbSArdmUgNjQtYml0IHZhbHVlXG4vLyBidXQgcmlnaHQgbm93IHRoaXMgc2hvdWxkIGJlIGFjY2VwdGFibGUgYW5kIHdpdGhpbiB0aGUgcmlnaHQgcmFuZ2VcblNEUFV0aWxzLmdlbmVyYXRlU2Vzc2lvbklkID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKCkuc3Vic3RyKDIsIDIxKTtcbn07XG5cbi8vIFdyaXRlIGJvaWxkZXIgcGxhdGUgZm9yIHN0YXJ0IG9mIFNEUFxuLy8gc2Vzc0lkIGFyZ3VtZW50IGlzIG9wdGlvbmFsIC0gaWYgbm90IHN1cHBsaWVkIGl0IHdpbGxcbi8vIGJlIGdlbmVyYXRlZCByYW5kb21seVxuLy8gc2Vzc1ZlcnNpb24gaXMgb3B0aW9uYWwgYW5kIGRlZmF1bHRzIHRvIDJcbi8vIHNlc3NVc2VyIGlzIG9wdGlvbmFsIGFuZCBkZWZhdWx0cyB0byAndGhpc2lzYWRhcHRlcm9ydGMnXG5TRFBVdGlscy53cml0ZVNlc3Npb25Cb2lsZXJwbGF0ZSA9IGZ1bmN0aW9uKHNlc3NJZCwgc2Vzc1Zlciwgc2Vzc1VzZXIpIHtcbiAgdmFyIHNlc3Npb25JZDtcbiAgdmFyIHZlcnNpb24gPSBzZXNzVmVyICE9PSB1bmRlZmluZWQgPyBzZXNzVmVyIDogMjtcbiAgaWYgKHNlc3NJZCkge1xuICAgIHNlc3Npb25JZCA9IHNlc3NJZDtcbiAgfSBlbHNlIHtcbiAgICBzZXNzaW9uSWQgPSBTRFBVdGlscy5nZW5lcmF0ZVNlc3Npb25JZCgpO1xuICB9XG4gIHZhciB1c2VyID0gc2Vzc1VzZXIgfHwgJ3RoaXNpc2FkYXB0ZXJvcnRjJztcbiAgLy8gRklYTUU6IHNlc3MtaWQgc2hvdWxkIGJlIGFuIE5UUCB0aW1lc3RhbXAuXG4gIHJldHVybiAndj0wXFxyXFxuJyArXG4gICAgICAnbz0nICsgdXNlciArICcgJyArIHNlc3Npb25JZCArICcgJyArIHZlcnNpb24gK1xuICAgICAgICAnIElOIElQNCAxMjcuMC4wLjFcXHJcXG4nICtcbiAgICAgICdzPS1cXHJcXG4nICtcbiAgICAgICd0PTAgMFxcclxcbic7XG59O1xuXG5TRFBVdGlscy53cml0ZU1lZGlhU2VjdGlvbiA9IGZ1bmN0aW9uKHRyYW5zY2VpdmVyLCBjYXBzLCB0eXBlLCBzdHJlYW0pIHtcbiAgdmFyIHNkcCA9IFNEUFV0aWxzLndyaXRlUnRwRGVzY3JpcHRpb24odHJhbnNjZWl2ZXIua2luZCwgY2Fwcyk7XG5cbiAgLy8gTWFwIElDRSBwYXJhbWV0ZXJzICh1ZnJhZywgcHdkKSB0byBTRFAuXG4gIHNkcCArPSBTRFBVdGlscy53cml0ZUljZVBhcmFtZXRlcnMoXG4gICAgdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIuZ2V0TG9jYWxQYXJhbWV0ZXJzKCkpO1xuXG4gIC8vIE1hcCBEVExTIHBhcmFtZXRlcnMgdG8gU0RQLlxuICBzZHAgKz0gU0RQVXRpbHMud3JpdGVEdGxzUGFyYW1ldGVycyhcbiAgICB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0LmdldExvY2FsUGFyYW1ldGVycygpLFxuICAgIHR5cGUgPT09ICdvZmZlcicgPyAnYWN0cGFzcycgOiAnYWN0aXZlJyk7XG5cbiAgc2RwICs9ICdhPW1pZDonICsgdHJhbnNjZWl2ZXIubWlkICsgJ1xcclxcbic7XG5cbiAgaWYgKHRyYW5zY2VpdmVyLmRpcmVjdGlvbikge1xuICAgIHNkcCArPSAnYT0nICsgdHJhbnNjZWl2ZXIuZGlyZWN0aW9uICsgJ1xcclxcbic7XG4gIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyICYmIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyKSB7XG4gICAgc2RwICs9ICdhPXNlbmRyZWN2XFxyXFxuJztcbiAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5ydHBTZW5kZXIpIHtcbiAgICBzZHAgKz0gJ2E9c2VuZG9ubHlcXHJcXG4nO1xuICB9IGVsc2UgaWYgKHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyKSB7XG4gICAgc2RwICs9ICdhPXJlY3Zvbmx5XFxyXFxuJztcbiAgfSBlbHNlIHtcbiAgICBzZHAgKz0gJ2E9aW5hY3RpdmVcXHJcXG4nO1xuICB9XG5cbiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlcikge1xuICAgIC8vIHNwZWMuXG4gICAgdmFyIG1zaWQgPSAnbXNpZDonICsgc3RyZWFtLmlkICsgJyAnICtcbiAgICAgICAgdHJhbnNjZWl2ZXIucnRwU2VuZGVyLnRyYWNrLmlkICsgJ1xcclxcbic7XG4gICAgc2RwICs9ICdhPScgKyBtc2lkO1xuXG4gICAgLy8gZm9yIENocm9tZS5cbiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICtcbiAgICAgICAgJyAnICsgbXNpZDtcbiAgICBpZiAodHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHgpIHtcbiAgICAgIHNkcCArPSAnYT1zc3JjOicgKyB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICtcbiAgICAgICAgICAnICcgKyBtc2lkO1xuICAgICAgc2RwICs9ICdhPXNzcmMtZ3JvdXA6RklEICcgK1xuICAgICAgICAgIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0uc3NyYyArICcgJyArXG4gICAgICAgICAgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHguc3NyYyArXG4gICAgICAgICAgJ1xcclxcbic7XG4gICAgfVxuICB9XG4gIC8vIEZJWE1FOiB0aGlzIHNob3VsZCBiZSB3cml0dGVuIGJ5IHdyaXRlUnRwRGVzY3JpcHRpb24uXG4gIHNkcCArPSAnYT1zc3JjOicgKyB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnNzcmMgK1xuICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcXHJcXG4nO1xuICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyICYmIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7XG4gICAgc2RwICs9ICdhPXNzcmM6JyArIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4LnNzcmMgK1xuICAgICAgICAnIGNuYW1lOicgKyBTRFBVdGlscy5sb2NhbENOYW1lICsgJ1xcclxcbic7XG4gIH1cbiAgcmV0dXJuIHNkcDtcbn07XG5cbi8vIEdldHMgdGhlIGRpcmVjdGlvbiBmcm9tIHRoZSBtZWRpYVNlY3Rpb24gb3IgdGhlIHNlc3Npb25wYXJ0LlxuU0RQVXRpbHMuZ2V0RGlyZWN0aW9uID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkge1xuICAvLyBMb29rIGZvciBzZW5kcmVjdiwgc2VuZG9ubHksIHJlY3Zvbmx5LCBpbmFjdGl2ZSwgZGVmYXVsdCB0byBzZW5kcmVjdi5cbiAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgc3dpdGNoIChsaW5lc1tpXSkge1xuICAgICAgY2FzZSAnYT1zZW5kcmVjdic6XG4gICAgICBjYXNlICdhPXNlbmRvbmx5JzpcbiAgICAgIGNhc2UgJ2E9cmVjdm9ubHknOlxuICAgICAgY2FzZSAnYT1pbmFjdGl2ZSc6XG4gICAgICAgIHJldHVybiBsaW5lc1tpXS5zdWJzdHIoMik7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICAvLyBGSVhNRTogV2hhdCBzaG91bGQgaGFwcGVuIGhlcmU/XG4gICAgfVxuICB9XG4gIGlmIChzZXNzaW9ucGFydCkge1xuICAgIHJldHVybiBTRFBVdGlscy5nZXREaXJlY3Rpb24oc2Vzc2lvbnBhcnQpO1xuICB9XG4gIHJldHVybiAnc2VuZHJlY3YnO1xufTtcblxuU0RQVXRpbHMuZ2V0S2luZCA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbikge1xuICB2YXIgbGluZXMgPSBTRFBVdGlscy5zcGxpdExpbmVzKG1lZGlhU2VjdGlvbik7XG4gIHZhciBtbGluZSA9IGxpbmVzWzBdLnNwbGl0KCcgJyk7XG4gIHJldHVybiBtbGluZVswXS5zdWJzdHIoMik7XG59O1xuXG5TRFBVdGlscy5pc1JlamVjdGVkID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uKSB7XG4gIHJldHVybiBtZWRpYVNlY3Rpb24uc3BsaXQoJyAnLCAyKVsxXSA9PT0gJzAnO1xufTtcblxuU0RQVXRpbHMucGFyc2VNTGluZSA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbikge1xuICB2YXIgbGluZXMgPSBTRFBVdGlscy5zcGxpdExpbmVzKG1lZGlhU2VjdGlvbik7XG4gIHZhciBwYXJ0cyA9IGxpbmVzWzBdLnN1YnN0cigyKS5zcGxpdCgnICcpO1xuICByZXR1cm4ge1xuICAgIGtpbmQ6IHBhcnRzWzBdLFxuICAgIHBvcnQ6IHBhcnNlSW50KHBhcnRzWzFdLCAxMCksXG4gICAgcHJvdG9jb2w6IHBhcnRzWzJdLFxuICAgIGZtdDogcGFydHMuc2xpY2UoMykuam9pbignICcpXG4gIH07XG59O1xuXG5TRFBVdGlscy5wYXJzZU9MaW5lID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uKSB7XG4gIHZhciBsaW5lID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnbz0nKVswXTtcbiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIoMikuc3BsaXQoJyAnKTtcbiAgcmV0dXJuIHtcbiAgICB1c2VybmFtZTogcGFydHNbMF0sXG4gICAgc2Vzc2lvbklkOiBwYXJ0c1sxXSxcbiAgICBzZXNzaW9uVmVyc2lvbjogcGFyc2VJbnQocGFydHNbMl0sIDEwKSxcbiAgICBuZXRUeXBlOiBwYXJ0c1szXSxcbiAgICBhZGRyZXNzVHlwZTogcGFydHNbNF0sXG4gICAgYWRkcmVzczogcGFydHNbNV1cbiAgfTtcbn07XG5cbi8vIGEgdmVyeSBuYWl2ZSBpbnRlcnByZXRhdGlvbiBvZiBhIHZhbGlkIFNEUC5cblNEUFV0aWxzLmlzVmFsaWRTRFAgPSBmdW5jdGlvbihibG9iKSB7XG4gIGlmICh0eXBlb2YgYmxvYiAhPT0gJ3N0cmluZycgfHwgYmxvYi5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhibG9iKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgIGlmIChsaW5lc1tpXS5sZW5ndGggPCAyIHx8IGxpbmVzW2ldLmNoYXJBdCgxKSAhPT0gJz0nKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vIFRPRE86IGNoZWNrIHRoZSBtb2RpZmllciBhIGJpdCBtb3JlLlxuICB9XG4gIHJldHVybiB0cnVlO1xufTtcblxuLy8gRXhwb3NlIHB1YmxpYyBtZXRob2RzLlxuaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKSB7XG4gIG1vZHVsZS5leHBvcnRzID0gU0RQVXRpbHM7XG59XG4iLCIvKipcbiAqIENvbnZlcnQgYXJyYXkgb2YgMTYgYnl0ZSB2YWx1ZXMgdG8gVVVJRCBzdHJpbmcgZm9ybWF0IG9mIHRoZSBmb3JtOlxuICogWFhYWFhYWFgtWFhYWC1YWFhYLVhYWFgtWFhYWFhYWFhYWFhYXG4gKi9cbnZhciBieXRlVG9IZXggPSBbXTtcbmZvciAodmFyIGkgPSAwOyBpIDwgMjU2OyArK2kpIHtcbiAgYnl0ZVRvSGV4W2ldID0gKGkgKyAweDEwMCkudG9TdHJpbmcoMTYpLnN1YnN0cigxKTtcbn1cblxuZnVuY3Rpb24gYnl0ZXNUb1V1aWQoYnVmLCBvZmZzZXQpIHtcbiAgdmFyIGkgPSBvZmZzZXQgfHwgMDtcbiAgdmFyIGJ0aCA9IGJ5dGVUb0hleDtcbiAgLy8gam9pbiB1c2VkIHRvIGZpeCBtZW1vcnkgaXNzdWUgY2F1c2VkIGJ5IGNvbmNhdGVuYXRpb246IGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC92OC9pc3N1ZXMvZGV0YWlsP2lkPTMxNzUjYzRcbiAgcmV0dXJuIChbXG4gICAgYnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXSxcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLCAnLScsXG4gICAgYnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXSwgJy0nLFxuICAgIGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sICctJyxcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLCAnLScsXG4gICAgYnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXSxcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLFxuICAgIGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV1cbiAgXSkuam9pbignJyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYnl0ZXNUb1V1aWQ7XG4iLCIvLyBVbmlxdWUgSUQgY3JlYXRpb24gcmVxdWlyZXMgYSBoaWdoIHF1YWxpdHkgcmFuZG9tICMgZ2VuZXJhdG9yLiAgSW4gdGhlXG4vLyBicm93c2VyIHRoaXMgaXMgYSBsaXR0bGUgY29tcGxpY2F0ZWQgZHVlIHRvIHVua25vd24gcXVhbGl0eSBvZiBNYXRoLnJhbmRvbSgpXG4vLyBhbmQgaW5jb25zaXN0ZW50IHN1cHBvcnQgZm9yIHRoZSBgY3J5cHRvYCBBUEkuICBXZSBkbyB0aGUgYmVzdCB3ZSBjYW4gdmlhXG4vLyBmZWF0dXJlLWRldGVjdGlvblxuXG4vLyBnZXRSYW5kb21WYWx1ZXMgbmVlZHMgdG8gYmUgaW52b2tlZCBpbiBhIGNvbnRleHQgd2hlcmUgXCJ0aGlzXCIgaXMgYSBDcnlwdG9cbi8vIGltcGxlbWVudGF0aW9uLiBBbHNvLCBmaW5kIHRoZSBjb21wbGV0ZSBpbXBsZW1lbnRhdGlvbiBvZiBjcnlwdG8gb24gSUUxMS5cbnZhciBnZXRSYW5kb21WYWx1ZXMgPSAodHlwZW9mKGNyeXB0bykgIT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQoY3J5cHRvKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAodHlwZW9mKG1zQ3J5cHRvKSAhPSAndW5kZWZpbmVkJyAmJiB0eXBlb2Ygd2luZG93Lm1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcyA9PSAnZnVuY3Rpb24nICYmIG1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKG1zQ3J5cHRvKSk7XG5cbmlmIChnZXRSYW5kb21WYWx1ZXMpIHtcbiAgLy8gV0hBVFdHIGNyeXB0byBSTkcgLSBodHRwOi8vd2lraS53aGF0d2cub3JnL3dpa2kvQ3J5cHRvXG4gIHZhciBybmRzOCA9IG5ldyBVaW50OEFycmF5KDE2KTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZlxuXG4gIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gd2hhdHdnUk5HKCkge1xuICAgIGdldFJhbmRvbVZhbHVlcyhybmRzOCk7XG4gICAgcmV0dXJuIHJuZHM4O1xuICB9O1xufSBlbHNlIHtcbiAgLy8gTWF0aC5yYW5kb20oKS1iYXNlZCAoUk5HKVxuICAvL1xuICAvLyBJZiBhbGwgZWxzZSBmYWlscywgdXNlIE1hdGgucmFuZG9tKCkuICBJdCdzIGZhc3QsIGJ1dCBpcyBvZiB1bnNwZWNpZmllZFxuICAvLyBxdWFsaXR5LlxuICB2YXIgcm5kcyA9IG5ldyBBcnJheSgxNik7XG5cbiAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBtYXRoUk5HKCkge1xuICAgIGZvciAodmFyIGkgPSAwLCByOyBpIDwgMTY7IGkrKykge1xuICAgICAgaWYgKChpICYgMHgwMykgPT09IDApIHIgPSBNYXRoLnJhbmRvbSgpICogMHgxMDAwMDAwMDA7XG4gICAgICBybmRzW2ldID0gciA+Pj4gKChpICYgMHgwMykgPDwgMykgJiAweGZmO1xuICAgIH1cblxuICAgIHJldHVybiBybmRzO1xuICB9O1xufVxuIiwidmFyIHJuZyA9IHJlcXVpcmUoJy4vbGliL3JuZycpO1xudmFyIGJ5dGVzVG9VdWlkID0gcmVxdWlyZSgnLi9saWIvYnl0ZXNUb1V1aWQnKTtcblxuZnVuY3Rpb24gdjQob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgdmFyIGkgPSBidWYgJiYgb2Zmc2V0IHx8IDA7XG5cbiAgaWYgKHR5cGVvZihvcHRpb25zKSA9PSAnc3RyaW5nJykge1xuICAgIGJ1ZiA9IG9wdGlvbnMgPT09ICdiaW5hcnknID8gbmV3IEFycmF5KDE2KSA6IG51bGw7XG4gICAgb3B0aW9ucyA9IG51bGw7XG4gIH1cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgdmFyIHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpO1xuXG4gIC8vIFBlciA0LjQsIHNldCBiaXRzIGZvciB2ZXJzaW9uIGFuZCBgY2xvY2tfc2VxX2hpX2FuZF9yZXNlcnZlZGBcbiAgcm5kc1s2XSA9IChybmRzWzZdICYgMHgwZikgfCAweDQwO1xuICBybmRzWzhdID0gKHJuZHNbOF0gJiAweDNmKSB8IDB4ODA7XG5cbiAgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG4gIGlmIChidWYpIHtcbiAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgMTY7ICsraWkpIHtcbiAgICAgIGJ1ZltpICsgaWldID0gcm5kc1tpaV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGJ1ZiB8fCBieXRlc1RvVXVpZChybmRzKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB2NDtcbiIsIi8qXG4gKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlXG4gKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlXG4gKiAgdHJlZS5cbiAqL1xuIC8qIGVzbGludC1lbnYgbm9kZSAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBhZGFwdGVyRmFjdG9yeSA9IHJlcXVpcmUoJy4vYWRhcHRlcl9mYWN0b3J5LmpzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGFkYXB0ZXJGYWN0b3J5KHt3aW5kb3c6IGdsb2JhbC53aW5kb3d9KTtcbiIsIi8qXG4gKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlXG4gKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlXG4gKiAgdHJlZS5cbiAqL1xuIC8qIGVzbGludC1lbnYgbm9kZSAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vdXRpbHMnKTtcbi8vIFNoaW1taW5nIHN0YXJ0cyBoZXJlLlxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihkZXBlbmRlbmNpZXMsIG9wdHMpIHtcbiAgdmFyIHdpbmRvdyA9IGRlcGVuZGVuY2llcyAmJiBkZXBlbmRlbmNpZXMud2luZG93O1xuXG4gIHZhciBvcHRpb25zID0ge1xuICAgIHNoaW1DaHJvbWU6IHRydWUsXG4gICAgc2hpbUZpcmVmb3g6IHRydWUsXG4gICAgc2hpbUVkZ2U6IHRydWUsXG4gICAgc2hpbVNhZmFyaTogdHJ1ZSxcbiAgfTtcblxuICBmb3IgKHZhciBrZXkgaW4gb3B0cykge1xuICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKG9wdHMsIGtleSkpIHtcbiAgICAgIG9wdGlvbnNba2V5XSA9IG9wdHNba2V5XTtcbiAgICB9XG4gIH1cblxuICAvLyBVdGlscy5cbiAgdmFyIGxvZ2dpbmcgPSB1dGlscy5sb2c7XG4gIHZhciBicm93c2VyRGV0YWlscyA9IHV0aWxzLmRldGVjdEJyb3dzZXIod2luZG93KTtcblxuICAvLyBVbmNvbW1lbnQgdGhlIGxpbmUgYmVsb3cgaWYgeW91IHdhbnQgbG9nZ2luZyB0byBvY2N1ciwgaW5jbHVkaW5nIGxvZ2dpbmdcbiAgLy8gZm9yIHRoZSBzd2l0Y2ggc3RhdGVtZW50IGJlbG93LiBDYW4gYWxzbyBiZSB0dXJuZWQgb24gaW4gdGhlIGJyb3dzZXIgdmlhXG4gIC8vIGFkYXB0ZXIuZGlzYWJsZUxvZyhmYWxzZSksIGJ1dCB0aGVuIGxvZ2dpbmcgZnJvbSB0aGUgc3dpdGNoIHN0YXRlbWVudCBiZWxvd1xuICAvLyB3aWxsIG5vdCBhcHBlYXIuXG4gIC8vIHJlcXVpcmUoJy4vdXRpbHMnKS5kaXNhYmxlTG9nKGZhbHNlKTtcblxuICAvLyBCcm93c2VyIHNoaW1zLlxuICB2YXIgY2hyb21lU2hpbSA9IHJlcXVpcmUoJy4vY2hyb21lL2Nocm9tZV9zaGltJykgfHwgbnVsbDtcbiAgdmFyIGVkZ2VTaGltID0gcmVxdWlyZSgnLi9lZGdlL2VkZ2Vfc2hpbScpIHx8IG51bGw7XG4gIHZhciBmaXJlZm94U2hpbSA9IHJlcXVpcmUoJy4vZmlyZWZveC9maXJlZm94X3NoaW0nKSB8fCBudWxsO1xuICB2YXIgc2FmYXJpU2hpbSA9IHJlcXVpcmUoJy4vc2FmYXJpL3NhZmFyaV9zaGltJykgfHwgbnVsbDtcbiAgdmFyIGNvbW1vblNoaW0gPSByZXF1aXJlKCcuL2NvbW1vbl9zaGltJykgfHwgbnVsbDtcblxuICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLlxuICB2YXIgYWRhcHRlciA9IHtcbiAgICBicm93c2VyRGV0YWlsczogYnJvd3NlckRldGFpbHMsXG4gICAgY29tbW9uU2hpbTogY29tbW9uU2hpbSxcbiAgICBleHRyYWN0VmVyc2lvbjogdXRpbHMuZXh0cmFjdFZlcnNpb24sXG4gICAgZGlzYWJsZUxvZzogdXRpbHMuZGlzYWJsZUxvZyxcbiAgICBkaXNhYmxlV2FybmluZ3M6IHV0aWxzLmRpc2FibGVXYXJuaW5nc1xuICB9O1xuXG4gIC8vIFNoaW0gYnJvd3NlciBpZiBmb3VuZC5cbiAgc3dpdGNoIChicm93c2VyRGV0YWlscy5icm93c2VyKSB7XG4gICAgY2FzZSAnY2hyb21lJzpcbiAgICAgIGlmICghY2hyb21lU2hpbSB8fCAhY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24gfHxcbiAgICAgICAgICAhb3B0aW9ucy5zaGltQ2hyb21lKSB7XG4gICAgICAgIGxvZ2dpbmcoJ0Nocm9tZSBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTtcbiAgICAgICAgcmV0dXJuIGFkYXB0ZXI7XG4gICAgICB9XG4gICAgICBsb2dnaW5nKCdhZGFwdGVyLmpzIHNoaW1taW5nIGNocm9tZS4nKTtcbiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuXG4gICAgICBhZGFwdGVyLmJyb3dzZXJTaGltID0gY2hyb21lU2hpbTtcbiAgICAgIGNvbW1vblNoaW0uc2hpbUNyZWF0ZU9iamVjdFVSTCh3aW5kb3cpO1xuXG4gICAgICBjaHJvbWVTaGltLnNoaW1HZXRVc2VyTWVkaWEod2luZG93KTtcbiAgICAgIGNocm9tZVNoaW0uc2hpbU1lZGlhU3RyZWFtKHdpbmRvdyk7XG4gICAgICBjaHJvbWVTaGltLnNoaW1Tb3VyY2VPYmplY3Qod2luZG93KTtcbiAgICAgIGNocm9tZVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uKHdpbmRvdyk7XG4gICAgICBjaHJvbWVTaGltLnNoaW1PblRyYWNrKHdpbmRvdyk7XG4gICAgICBjaHJvbWVTaGltLnNoaW1BZGRUcmFja1JlbW92ZVRyYWNrKHdpbmRvdyk7XG4gICAgICBjaHJvbWVTaGltLnNoaW1HZXRTZW5kZXJzV2l0aER0bWYod2luZG93KTtcbiAgICAgIGNocm9tZVNoaW0uc2hpbVNlbmRlclJlY2VpdmVyR2V0U3RhdHMod2luZG93KTtcbiAgICAgIGNocm9tZVNoaW0uZml4TmVnb3RpYXRpb25OZWVkZWQod2luZG93KTtcblxuICAgICAgY29tbW9uU2hpbS5zaGltUlRDSWNlQ2FuZGlkYXRlKHdpbmRvdyk7XG4gICAgICBjb21tb25TaGltLnNoaW1NYXhNZXNzYWdlU2l6ZSh3aW5kb3cpO1xuICAgICAgY29tbW9uU2hpbS5zaGltU2VuZFRocm93VHlwZUVycm9yKHdpbmRvdyk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdmaXJlZm94JzpcbiAgICAgIGlmICghZmlyZWZveFNoaW0gfHwgIWZpcmVmb3hTaGltLnNoaW1QZWVyQ29ubmVjdGlvbiB8fFxuICAgICAgICAgICFvcHRpb25zLnNoaW1GaXJlZm94KSB7XG4gICAgICAgIGxvZ2dpbmcoJ0ZpcmVmb3ggc2hpbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhpcyBhZGFwdGVyIHJlbGVhc2UuJyk7XG4gICAgICAgIHJldHVybiBhZGFwdGVyO1xuICAgICAgfVxuICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBmaXJlZm94LicpO1xuICAgICAgLy8gRXhwb3J0IHRvIHRoZSBhZGFwdGVyIGdsb2JhbCBvYmplY3QgdmlzaWJsZSBpbiB0aGUgYnJvd3Nlci5cbiAgICAgIGFkYXB0ZXIuYnJvd3NlclNoaW0gPSBmaXJlZm94U2hpbTtcbiAgICAgIGNvbW1vblNoaW0uc2hpbUNyZWF0ZU9iamVjdFVSTCh3aW5kb3cpO1xuXG4gICAgICBmaXJlZm94U2hpbS5zaGltR2V0VXNlck1lZGlhKHdpbmRvdyk7XG4gICAgICBmaXJlZm94U2hpbS5zaGltU291cmNlT2JqZWN0KHdpbmRvdyk7XG4gICAgICBmaXJlZm94U2hpbS5zaGltUGVlckNvbm5lY3Rpb24od2luZG93KTtcbiAgICAgIGZpcmVmb3hTaGltLnNoaW1PblRyYWNrKHdpbmRvdyk7XG4gICAgICBmaXJlZm94U2hpbS5zaGltUmVtb3ZlU3RyZWFtKHdpbmRvdyk7XG4gICAgICBmaXJlZm94U2hpbS5zaGltU2VuZGVyR2V0U3RhdHMod2luZG93KTtcbiAgICAgIGZpcmVmb3hTaGltLnNoaW1SZWNlaXZlckdldFN0YXRzKHdpbmRvdyk7XG4gICAgICBmaXJlZm94U2hpbS5zaGltUlRDRGF0YUNoYW5uZWwod2luZG93KTtcblxuICAgICAgY29tbW9uU2hpbS5zaGltUlRDSWNlQ2FuZGlkYXRlKHdpbmRvdyk7XG4gICAgICBjb21tb25TaGltLnNoaW1NYXhNZXNzYWdlU2l6ZSh3aW5kb3cpO1xuICAgICAgY29tbW9uU2hpbS5zaGltU2VuZFRocm93VHlwZUVycm9yKHdpbmRvdyk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdlZGdlJzpcbiAgICAgIGlmICghZWRnZVNoaW0gfHwgIWVkZ2VTaGltLnNoaW1QZWVyQ29ubmVjdGlvbiB8fCAhb3B0aW9ucy5zaGltRWRnZSkge1xuICAgICAgICBsb2dnaW5nKCdNUyBlZGdlIHNoaW0gaXMgbm90IGluY2x1ZGVkIGluIHRoaXMgYWRhcHRlciByZWxlYXNlLicpO1xuICAgICAgICByZXR1cm4gYWRhcHRlcjtcbiAgICAgIH1cbiAgICAgIGxvZ2dpbmcoJ2FkYXB0ZXIuanMgc2hpbW1pbmcgZWRnZS4nKTtcbiAgICAgIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuXG4gICAgICBhZGFwdGVyLmJyb3dzZXJTaGltID0gZWRnZVNoaW07XG4gICAgICBjb21tb25TaGltLnNoaW1DcmVhdGVPYmplY3RVUkwod2luZG93KTtcblxuICAgICAgZWRnZVNoaW0uc2hpbUdldFVzZXJNZWRpYSh3aW5kb3cpO1xuICAgICAgZWRnZVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uKHdpbmRvdyk7XG4gICAgICBlZGdlU2hpbS5zaGltUmVwbGFjZVRyYWNrKHdpbmRvdyk7XG4gICAgICBlZGdlU2hpbS5zaGltR2V0RGlzcGxheU1lZGlhKHdpbmRvdyk7XG5cbiAgICAgIC8vIHRoZSBlZGdlIHNoaW0gaW1wbGVtZW50cyB0aGUgZnVsbCBSVENJY2VDYW5kaWRhdGUgb2JqZWN0LlxuXG4gICAgICBjb21tb25TaGltLnNoaW1NYXhNZXNzYWdlU2l6ZSh3aW5kb3cpO1xuICAgICAgY29tbW9uU2hpbS5zaGltU2VuZFRocm93VHlwZUVycm9yKHdpbmRvdyk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdzYWZhcmknOlxuICAgICAgaWYgKCFzYWZhcmlTaGltIHx8ICFvcHRpb25zLnNoaW1TYWZhcmkpIHtcbiAgICAgICAgbG9nZ2luZygnU2FmYXJpIHNoaW0gaXMgbm90IGluY2x1ZGVkIGluIHRoaXMgYWRhcHRlciByZWxlYXNlLicpO1xuICAgICAgICByZXR1cm4gYWRhcHRlcjtcbiAgICAgIH1cbiAgICAgIGxvZ2dpbmcoJ2FkYXB0ZXIuanMgc2hpbW1pbmcgc2FmYXJpLicpO1xuICAgICAgLy8gRXhwb3J0IHRvIHRoZSBhZGFwdGVyIGdsb2JhbCBvYmplY3QgdmlzaWJsZSBpbiB0aGUgYnJvd3Nlci5cbiAgICAgIGFkYXB0ZXIuYnJvd3NlclNoaW0gPSBzYWZhcmlTaGltO1xuICAgICAgY29tbW9uU2hpbS5zaGltQ3JlYXRlT2JqZWN0VVJMKHdpbmRvdyk7XG5cbiAgICAgIHNhZmFyaVNoaW0uc2hpbVJUQ0ljZVNlcnZlclVybHMod2luZG93KTtcbiAgICAgIHNhZmFyaVNoaW0uc2hpbUNyZWF0ZU9mZmVyTGVnYWN5KHdpbmRvdyk7XG4gICAgICBzYWZhcmlTaGltLnNoaW1DYWxsYmFja3NBUEkod2luZG93KTtcbiAgICAgIHNhZmFyaVNoaW0uc2hpbUxvY2FsU3RyZWFtc0FQSSh3aW5kb3cpO1xuICAgICAgc2FmYXJpU2hpbS5zaGltUmVtb3RlU3RyZWFtc0FQSSh3aW5kb3cpO1xuICAgICAgc2FmYXJpU2hpbS5zaGltVHJhY2tFdmVudFRyYW5zY2VpdmVyKHdpbmRvdyk7XG4gICAgICBzYWZhcmlTaGltLnNoaW1HZXRVc2VyTWVkaWEod2luZG93KTtcblxuICAgICAgY29tbW9uU2hpbS5zaGltUlRDSWNlQ2FuZGlkYXRlKHdpbmRvdyk7XG4gICAgICBjb21tb25TaGltLnNoaW1NYXhNZXNzYWdlU2l6ZSh3aW5kb3cpO1xuICAgICAgY29tbW9uU2hpbS5zaGltU2VuZFRocm93VHlwZUVycm9yKHdpbmRvdyk7XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgbG9nZ2luZygnVW5zdXBwb3J0ZWQgYnJvd3NlciEnKTtcbiAgICAgIGJyZWFrO1xuICB9XG5cbiAgcmV0dXJuIGFkYXB0ZXI7XG59O1xuIiwiXG4vKlxuICogIENvcHlyaWdodCAoYykgMjAxNiBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZVxuICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZVxuICogIHRyZWUuXG4gKi9cbiAvKiBlc2xpbnQtZW52IG5vZGUgKi9cbid1c2Ugc3RyaWN0JztcbnZhciB1dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzLmpzJyk7XG52YXIgbG9nZ2luZyA9IHV0aWxzLmxvZztcblxuLyogaXRlcmF0ZXMgdGhlIHN0YXRzIGdyYXBoIHJlY3Vyc2l2ZWx5LiAqL1xuZnVuY3Rpb24gd2Fsa1N0YXRzKHN0YXRzLCBiYXNlLCByZXN1bHRTZXQpIHtcbiAgaWYgKCFiYXNlIHx8IHJlc3VsdFNldC5oYXMoYmFzZS5pZCkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgcmVzdWx0U2V0LnNldChiYXNlLmlkLCBiYXNlKTtcbiAgT2JqZWN0LmtleXMoYmFzZSkuZm9yRWFjaChmdW5jdGlvbihuYW1lKSB7XG4gICAgaWYgKG5hbWUuZW5kc1dpdGgoJ0lkJykpIHtcbiAgICAgIHdhbGtTdGF0cyhzdGF0cywgc3RhdHMuZ2V0KGJhc2VbbmFtZV0pLCByZXN1bHRTZXQpO1xuICAgIH0gZWxzZSBpZiAobmFtZS5lbmRzV2l0aCgnSWRzJykpIHtcbiAgICAgIGJhc2VbbmFtZV0uZm9yRWFjaChmdW5jdGlvbihpZCkge1xuICAgICAgICB3YWxrU3RhdHMoc3RhdHMsIHN0YXRzLmdldChpZCksIHJlc3VsdFNldCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKiBmaWx0ZXIgZ2V0U3RhdHMgZm9yIGEgc2VuZGVyL3JlY2VpdmVyIHRyYWNrLiAqL1xuZnVuY3Rpb24gZmlsdGVyU3RhdHMocmVzdWx0LCB0cmFjaywgb3V0Ym91bmQpIHtcbiAgdmFyIHN0cmVhbVN0YXRzVHlwZSA9IG91dGJvdW5kID8gJ291dGJvdW5kLXJ0cCcgOiAnaW5ib3VuZC1ydHAnO1xuICB2YXIgZmlsdGVyZWRSZXN1bHQgPSBuZXcgTWFwKCk7XG4gIGlmICh0cmFjayA9PT0gbnVsbCkge1xuICAgIHJldHVybiBmaWx0ZXJlZFJlc3VsdDtcbiAgfVxuICB2YXIgdHJhY2tTdGF0cyA9IFtdO1xuICByZXN1bHQuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSkge1xuICAgIGlmICh2YWx1ZS50eXBlID09PSAndHJhY2snICYmXG4gICAgICAgIHZhbHVlLnRyYWNrSWRlbnRpZmllciA9PT0gdHJhY2suaWQpIHtcbiAgICAgIHRyYWNrU3RhdHMucHVzaCh2YWx1ZSk7XG4gICAgfVxuICB9KTtcbiAgdHJhY2tTdGF0cy5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrU3RhdCkge1xuICAgIHJlc3VsdC5mb3JFYWNoKGZ1bmN0aW9uKHN0YXRzKSB7XG4gICAgICBpZiAoc3RhdHMudHlwZSA9PT0gc3RyZWFtU3RhdHNUeXBlICYmIHN0YXRzLnRyYWNrSWQgPT09IHRyYWNrU3RhdC5pZCkge1xuICAgICAgICB3YWxrU3RhdHMocmVzdWx0LCBzdGF0cywgZmlsdGVyZWRSZXN1bHQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbiAgcmV0dXJuIGZpbHRlcmVkUmVzdWx0O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgc2hpbUdldFVzZXJNZWRpYTogcmVxdWlyZSgnLi9nZXR1c2VybWVkaWEnKSxcbiAgc2hpbU1lZGlhU3RyZWFtOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICB3aW5kb3cuTWVkaWFTdHJlYW0gPSB3aW5kb3cuTWVkaWFTdHJlYW0gfHwgd2luZG93LndlYmtpdE1lZGlhU3RyZWFtO1xuICB9LFxuXG4gIHNoaW1PblRyYWNrOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmICEoJ29udHJhY2snIGluXG4gICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSwgJ29udHJhY2snLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX29udHJhY2s7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24oZikge1xuICAgICAgICAgIGlmICh0aGlzLl9vbnRyYWNrKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RyYWNrJywgdGhpcy5fb250cmFjayk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrID0gZik7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICB2YXIgb3JpZ1NldFJlbW90ZURlc2NyaXB0aW9uID1cbiAgICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldFJlbW90ZURlc2NyaXB0aW9uO1xuICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXRSZW1vdGVEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgICBpZiAoIXBjLl9vbnRyYWNrcG9seSkge1xuICAgICAgICAgIHBjLl9vbnRyYWNrcG9seSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIC8vIG9uYWRkc3RyZWFtIGRvZXMgbm90IGZpcmUgd2hlbiBhIHRyYWNrIGlzIGFkZGVkIHRvIGFuIGV4aXN0aW5nXG4gICAgICAgICAgICAvLyBzdHJlYW0uIEJ1dCBzdHJlYW0ub25hZGR0cmFjayBpcyBpbXBsZW1lbnRlZCBzbyB3ZSB1c2UgdGhhdC5cbiAgICAgICAgICAgIGUuc3RyZWFtLmFkZEV2ZW50TGlzdGVuZXIoJ2FkZHRyYWNrJywgZnVuY3Rpb24odGUpIHtcbiAgICAgICAgICAgICAgdmFyIHJlY2VpdmVyO1xuICAgICAgICAgICAgICBpZiAod2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRSZWNlaXZlcnMpIHtcbiAgICAgICAgICAgICAgICByZWNlaXZlciA9IHBjLmdldFJlY2VpdmVycygpLmZpbmQoZnVuY3Rpb24ocikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHIudHJhY2sgJiYgci50cmFjay5pZCA9PT0gdGUudHJhY2suaWQ7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVjZWl2ZXIgPSB7dHJhY2s6IHRlLnRyYWNrfTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTtcbiAgICAgICAgICAgICAgZXZlbnQudHJhY2sgPSB0ZS50cmFjaztcbiAgICAgICAgICAgICAgZXZlbnQucmVjZWl2ZXIgPSByZWNlaXZlcjtcbiAgICAgICAgICAgICAgZXZlbnQudHJhbnNjZWl2ZXIgPSB7cmVjZWl2ZXI6IHJlY2VpdmVyfTtcbiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07XG4gICAgICAgICAgICAgIHBjLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBlLnN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7XG4gICAgICAgICAgICAgIHZhciByZWNlaXZlcjtcbiAgICAgICAgICAgICAgaWYgKHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0UmVjZWl2ZXJzKSB7XG4gICAgICAgICAgICAgICAgcmVjZWl2ZXIgPSBwYy5nZXRSZWNlaXZlcnMoKS5maW5kKGZ1bmN0aW9uKHIpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByLnRyYWNrICYmIHIudHJhY2suaWQgPT09IHRyYWNrLmlkO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlY2VpdmVyID0ge3RyYWNrOiB0cmFja307XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCd0cmFjaycpO1xuICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRyYWNrO1xuICAgICAgICAgICAgICBldmVudC5yZWNlaXZlciA9IHJlY2VpdmVyO1xuICAgICAgICAgICAgICBldmVudC50cmFuc2NlaXZlciA9IHtyZWNlaXZlcjogcmVjZWl2ZXJ9O1xuICAgICAgICAgICAgICBldmVudC5zdHJlYW1zID0gW2Uuc3RyZWFtXTtcbiAgICAgICAgICAgICAgcGMuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIHBjLmFkZEV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHBjLl9vbnRyYWNrcG9seSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9yaWdTZXRSZW1vdGVEZXNjcmlwdGlvbi5hcHBseShwYywgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGV2ZW4gaWYgUlRDUnRwVHJhbnNjZWl2ZXIgaXMgaW4gd2luZG93LCBpdCBpcyBvbmx5IHVzZWQgYW5kXG4gICAgICAvLyBlbWl0dGVkIGluIHVuaWZpZWQtcGxhbi4gVW5mb3J0dW5hdGVseSB0aGlzIG1lYW5zIHdlIG5lZWRcbiAgICAgIC8vIHRvIHVuY29uZGl0aW9uYWxseSB3cmFwIHRoZSBldmVudC5cbiAgICAgIHV0aWxzLndyYXBQZWVyQ29ubmVjdGlvbkV2ZW50KHdpbmRvdywgJ3RyYWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAoIWUudHJhbnNjZWl2ZXIpIHtcbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgJ3RyYW5zY2VpdmVyJyxcbiAgICAgICAgICAgIHt2YWx1ZToge3JlY2VpdmVyOiBlLnJlY2VpdmVyfX0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlO1xuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIHNoaW1HZXRTZW5kZXJzV2l0aER0bWY6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIC8vIE92ZXJyaWRlcyBhZGRUcmFjay9yZW1vdmVUcmFjaywgZGVwZW5kcyBvbiBzaGltQWRkVHJhY2tSZW1vdmVUcmFjay5cbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmXG4gICAgICAgICEoJ2dldFNlbmRlcnMnIGluIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpICYmXG4gICAgICAgICdjcmVhdGVEVE1GU2VuZGVyJyBpbiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlKSB7XG4gICAgICB2YXIgc2hpbVNlbmRlcldpdGhEdG1mID0gZnVuY3Rpb24ocGMsIHRyYWNrKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdHJhY2s6IHRyYWNrLFxuICAgICAgICAgIGdldCBkdG1mKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2R0bWYgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICBpZiAodHJhY2sua2luZCA9PT0gJ2F1ZGlvJykge1xuICAgICAgICAgICAgICAgIHRoaXMuX2R0bWYgPSBwYy5jcmVhdGVEVE1GU2VuZGVyKHRyYWNrKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kdG1mID0gbnVsbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2R0bWY7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBfcGM6IHBjXG4gICAgICAgIH07XG4gICAgICB9O1xuXG4gICAgICAvLyBhdWdtZW50IGFkZFRyYWNrIHdoZW4gZ2V0U2VuZGVycyBpcyBub3QgYXZhaWxhYmxlLlxuICAgICAgaWYgKCF3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFNlbmRlcnMpIHtcbiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTZW5kZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5fc2VuZGVycyA9IHRoaXMuX3NlbmRlcnMgfHwgW107XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbmRlcnMuc2xpY2UoKTsgLy8gcmV0dXJuIGEgY29weSBvZiB0aGUgaW50ZXJuYWwgc3RhdGUuXG4gICAgICAgIH07XG4gICAgICAgIHZhciBvcmlnQWRkVHJhY2sgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFRyYWNrO1xuICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFRyYWNrID0gZnVuY3Rpb24odHJhY2ssIHN0cmVhbSkge1xuICAgICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgICAgdmFyIHNlbmRlciA9IG9yaWdBZGRUcmFjay5hcHBseShwYywgYXJndW1lbnRzKTtcbiAgICAgICAgICBpZiAoIXNlbmRlcikge1xuICAgICAgICAgICAgc2VuZGVyID0gc2hpbVNlbmRlcldpdGhEdG1mKHBjLCB0cmFjayk7XG4gICAgICAgICAgICBwYy5fc2VuZGVycy5wdXNoKHNlbmRlcik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBzZW5kZXI7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIG9yaWdSZW1vdmVUcmFjayA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUucmVtb3ZlVHJhY2s7XG4gICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUucmVtb3ZlVHJhY2sgPSBmdW5jdGlvbihzZW5kZXIpIHtcbiAgICAgICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgICAgIG9yaWdSZW1vdmVUcmFjay5hcHBseShwYywgYXJndW1lbnRzKTtcbiAgICAgICAgICB2YXIgaWR4ID0gcGMuX3NlbmRlcnMuaW5kZXhPZihzZW5kZXIpO1xuICAgICAgICAgIGlmIChpZHggIT09IC0xKSB7XG4gICAgICAgICAgICBwYy5fc2VuZGVycy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICB2YXIgb3JpZ0FkZFN0cmVhbSA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkU3RyZWFtO1xuICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5hZGRTdHJlYW0gPSBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgICAgcGMuX3NlbmRlcnMgPSBwYy5fc2VuZGVycyB8fCBbXTtcbiAgICAgICAgb3JpZ0FkZFN0cmVhbS5hcHBseShwYywgW3N0cmVhbV0pO1xuICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykge1xuICAgICAgICAgIHBjLl9zZW5kZXJzLnB1c2goc2hpbVNlbmRlcldpdGhEdG1mKHBjLCB0cmFjaykpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIHZhciBvcmlnUmVtb3ZlU3RyZWFtID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVTdHJlYW07XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgICBwYy5fc2VuZGVycyA9IHBjLl9zZW5kZXJzIHx8IFtdO1xuICAgICAgICBvcmlnUmVtb3ZlU3RyZWFtLmFwcGx5KHBjLCBbc3RyZWFtXSk7XG5cbiAgICAgICAgc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHtcbiAgICAgICAgICB2YXIgc2VuZGVyID0gcGMuX3NlbmRlcnMuZmluZChmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICByZXR1cm4gcy50cmFjayA9PT0gdHJhY2s7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKHNlbmRlcikge1xuICAgICAgICAgICAgcGMuX3NlbmRlcnMuc3BsaWNlKHBjLl9zZW5kZXJzLmluZGV4T2Yoc2VuZGVyKSwgMSk7IC8vIHJlbW92ZSBzZW5kZXJcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnICYmIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiAmJlxuICAgICAgICAgICAgICAgJ2dldFNlbmRlcnMnIGluIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgJiZcbiAgICAgICAgICAgICAgICdjcmVhdGVEVE1GU2VuZGVyJyBpbiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlICYmXG4gICAgICAgICAgICAgICB3aW5kb3cuUlRDUnRwU2VuZGVyICYmXG4gICAgICAgICAgICAgICAhKCdkdG1mJyBpbiB3aW5kb3cuUlRDUnRwU2VuZGVyLnByb3RvdHlwZSkpIHtcbiAgICAgIHZhciBvcmlnR2V0U2VuZGVycyA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U2VuZGVycztcbiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U2VuZGVycyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgICB2YXIgc2VuZGVycyA9IG9yaWdHZXRTZW5kZXJzLmFwcGx5KHBjLCBbXSk7XG4gICAgICAgIHNlbmRlcnMuZm9yRWFjaChmdW5jdGlvbihzZW5kZXIpIHtcbiAgICAgICAgICBzZW5kZXIuX3BjID0gcGM7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gc2VuZGVycztcbiAgICAgIH07XG5cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUnRwU2VuZGVyLnByb3RvdHlwZSwgJ2R0bWYnLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHRoaXMuX2R0bWYgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMudHJhY2sua2luZCA9PT0gJ2F1ZGlvJykge1xuICAgICAgICAgICAgICB0aGlzLl9kdG1mID0gdGhpcy5fcGMuY3JlYXRlRFRNRlNlbmRlcih0aGlzLnRyYWNrKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuX2R0bWYgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGhpcy5fZHRtZjtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIHNoaW1TZW5kZXJSZWNlaXZlckdldFN0YXRzOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICBpZiAoISh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JyAmJiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gJiZcbiAgICAgICAgd2luZG93LlJUQ1J0cFNlbmRlciAmJiB3aW5kb3cuUlRDUnRwUmVjZWl2ZXIpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gc2hpbSBzZW5kZXIgc3RhdHMuXG4gICAgaWYgKCEoJ2dldFN0YXRzJyBpbiB3aW5kb3cuUlRDUnRwU2VuZGVyLnByb3RvdHlwZSkpIHtcbiAgICAgIHZhciBvcmlnR2V0U2VuZGVycyA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U2VuZGVycztcbiAgICAgIGlmIChvcmlnR2V0U2VuZGVycykge1xuICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFNlbmRlcnMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgICAgIHZhciBzZW5kZXJzID0gb3JpZ0dldFNlbmRlcnMuYXBwbHkocGMsIFtdKTtcbiAgICAgICAgICBzZW5kZXJzLmZvckVhY2goZnVuY3Rpb24oc2VuZGVyKSB7XG4gICAgICAgICAgICBzZW5kZXIuX3BjID0gcGM7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIHNlbmRlcnM7XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHZhciBvcmlnQWRkVHJhY2sgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFRyYWNrO1xuICAgICAgaWYgKG9yaWdBZGRUcmFjaykge1xuICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFRyYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIHNlbmRlciA9IG9yaWdBZGRUcmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgIHNlbmRlci5fcGMgPSB0aGlzO1xuICAgICAgICAgIHJldHVybiBzZW5kZXI7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICB3aW5kb3cuUlRDUnRwU2VuZGVyLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VuZGVyID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BjLmdldFN0YXRzKCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAvKiBOb3RlOiB0aGlzIHdpbGwgaW5jbHVkZSBzdGF0cyBvZiBhbGwgc2VuZGVycyB0aGF0XG4gICAgICAgICAgICogICBzZW5kIGEgdHJhY2sgd2l0aCB0aGUgc2FtZSBpZCBhcyBzZW5kZXIudHJhY2sgYXNcbiAgICAgICAgICAgKiAgIGl0IGlzIG5vdCBwb3NzaWJsZSB0byBpZGVudGlmeSB0aGUgUlRDUnRwU2VuZGVyLlxuICAgICAgICAgICAqL1xuICAgICAgICAgIHJldHVybiBmaWx0ZXJTdGF0cyhyZXN1bHQsIHNlbmRlci50cmFjaywgdHJ1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBzaGltIHJlY2VpdmVyIHN0YXRzLlxuICAgIGlmICghKCdnZXRTdGF0cycgaW4gd2luZG93LlJUQ1J0cFJlY2VpdmVyLnByb3RvdHlwZSkpIHtcbiAgICAgIHZhciBvcmlnR2V0UmVjZWl2ZXJzID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRSZWNlaXZlcnM7XG4gICAgICBpZiAob3JpZ0dldFJlY2VpdmVycykge1xuICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFJlY2VpdmVycyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgICAgdmFyIHJlY2VpdmVycyA9IG9yaWdHZXRSZWNlaXZlcnMuYXBwbHkocGMsIFtdKTtcbiAgICAgICAgICByZWNlaXZlcnMuZm9yRWFjaChmdW5jdGlvbihyZWNlaXZlcikge1xuICAgICAgICAgICAgcmVjZWl2ZXIuX3BjID0gcGM7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIHJlY2VpdmVycztcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHV0aWxzLndyYXBQZWVyQ29ubmVjdGlvbkV2ZW50KHdpbmRvdywgJ3RyYWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICBlLnJlY2VpdmVyLl9wYyA9IGUuc3JjRWxlbWVudDtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgICB9KTtcbiAgICAgIHdpbmRvdy5SVENSdHBSZWNlaXZlci5wcm90b3R5cGUuZ2V0U3RhdHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHJlY2VpdmVyID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BjLmdldFN0YXRzKCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICByZXR1cm4gZmlsdGVyU3RhdHMocmVzdWx0LCByZWNlaXZlci50cmFjaywgZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgaWYgKCEoJ2dldFN0YXRzJyBpbiB3aW5kb3cuUlRDUnRwU2VuZGVyLnByb3RvdHlwZSAmJlxuICAgICAgICAnZ2V0U3RhdHMnIGluIHdpbmRvdy5SVENSdHBSZWNlaXZlci5wcm90b3R5cGUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gc2hpbSBSVENQZWVyQ29ubmVjdGlvbi5nZXRTdGF0cyh0cmFjaykuXG4gICAgdmFyIG9yaWdHZXRTdGF0cyA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHM7XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMCAmJlxuICAgICAgICAgIGFyZ3VtZW50c1swXSBpbnN0YW5jZW9mIHdpbmRvdy5NZWRpYVN0cmVhbVRyYWNrKSB7XG4gICAgICAgIHZhciB0cmFjayA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgdmFyIHNlbmRlcjtcbiAgICAgICAgdmFyIHJlY2VpdmVyO1xuICAgICAgICB2YXIgZXJyO1xuICAgICAgICBwYy5nZXRTZW5kZXJzKCkuZm9yRWFjaChmdW5jdGlvbihzKSB7XG4gICAgICAgICAgaWYgKHMudHJhY2sgPT09IHRyYWNrKSB7XG4gICAgICAgICAgICBpZiAoc2VuZGVyKSB7XG4gICAgICAgICAgICAgIGVyciA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzZW5kZXIgPSBzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHBjLmdldFJlY2VpdmVycygpLmZvckVhY2goZnVuY3Rpb24ocikge1xuICAgICAgICAgIGlmIChyLnRyYWNrID09PSB0cmFjaykge1xuICAgICAgICAgICAgaWYgKHJlY2VpdmVyKSB7XG4gICAgICAgICAgICAgIGVyciA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZWNlaXZlciA9IHI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByLnRyYWNrID09PSB0cmFjaztcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChlcnIgfHwgKHNlbmRlciAmJiByZWNlaXZlcikpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IERPTUV4Y2VwdGlvbihcbiAgICAgICAgICAgICdUaGVyZSBhcmUgbW9yZSB0aGFuIG9uZSBzZW5kZXIgb3IgcmVjZWl2ZXIgZm9yIHRoZSB0cmFjay4nLFxuICAgICAgICAgICAgJ0ludmFsaWRBY2Nlc3NFcnJvcicpKTtcbiAgICAgICAgfSBlbHNlIGlmIChzZW5kZXIpIHtcbiAgICAgICAgICByZXR1cm4gc2VuZGVyLmdldFN0YXRzKCk7XG4gICAgICAgIH0gZWxzZSBpZiAocmVjZWl2ZXIpIHtcbiAgICAgICAgICByZXR1cm4gcmVjZWl2ZXIuZ2V0U3RhdHMoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IERPTUV4Y2VwdGlvbihcbiAgICAgICAgICAnVGhlcmUgaXMgbm8gc2VuZGVyIG9yIHJlY2VpdmVyIGZvciB0aGUgdHJhY2suJyxcbiAgICAgICAgICAnSW52YWxpZEFjY2Vzc0Vycm9yJykpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseShwYywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9LFxuXG4gIHNoaW1Tb3VyY2VPYmplY3Q6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIHZhciBVUkwgPSB3aW5kb3cgJiYgd2luZG93LlVSTDtcblxuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0Jykge1xuICAgICAgaWYgKHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50ICYmXG4gICAgICAgICEoJ3NyY09iamVjdCcgaW4gd2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlKSkge1xuICAgICAgICAvLyBTaGltIHRoZSBzcmNPYmplY3QgcHJvcGVydHksIG9uY2UsIHdoZW4gSFRNTE1lZGlhRWxlbWVudCBpcyBmb3VuZC5cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyY09iamVjdCcsIHtcbiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NyY09iamVjdDtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNldDogZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAvLyBVc2UgX3NyY09iamVjdCBhcyBhIHByaXZhdGUgcHJvcGVydHkgZm9yIHRoaXMgc2hpbVxuICAgICAgICAgICAgdGhpcy5fc3JjT2JqZWN0ID0gc3RyZWFtO1xuICAgICAgICAgICAgaWYgKHRoaXMuc3JjKSB7XG4gICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodGhpcy5zcmMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXN0cmVhbSkge1xuICAgICAgICAgICAgICB0aGlzLnNyYyA9ICcnO1xuICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7XG4gICAgICAgICAgICAvLyBXZSBuZWVkIHRvIHJlY3JlYXRlIHRoZSBibG9iIHVybCB3aGVuIGEgdHJhY2sgaXMgYWRkZWQgb3JcbiAgICAgICAgICAgIC8vIHJlbW92ZWQuIERvaW5nIGl0IG1hbnVhbGx5IHNpbmNlIHdlIHdhbnQgdG8gYXZvaWQgYSByZWN1cnNpb24uXG4gICAgICAgICAgICBzdHJlYW0uYWRkRXZlbnRMaXN0ZW5lcignYWRkdHJhY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgaWYgKHNlbGYuc3JjKSB7XG4gICAgICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTChzZWxmLnNyYyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgc2VsZi5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHN0cmVhbS5hZGRFdmVudExpc3RlbmVyKCdyZW1vdmV0cmFjaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBpZiAoc2VsZi5zcmMpIHtcbiAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHNlbGYuc3JjKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBzZWxmLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIHNoaW1BZGRUcmFja1JlbW92ZVRyYWNrV2l0aE5hdGl2ZTogZnVuY3Rpb24od2luZG93KSB7XG4gICAgLy8gc2hpbSBhZGRUcmFjay9yZW1vdmVUcmFjayB3aXRoIG5hdGl2ZSB2YXJpYW50cyBpbiBvcmRlciB0byBtYWtlXG4gICAgLy8gdGhlIGludGVyYWN0aW9ucyB3aXRoIGxlZ2FjeSBnZXRMb2NhbFN0cmVhbXMgYmVoYXZlIGFzIGluIG90aGVyIGJyb3dzZXJzLlxuICAgIC8vIEtlZXBzIGEgbWFwcGluZyBzdHJlYW0uaWQgPT4gW3N0cmVhbSwgcnRwc2VuZGVycy4uLl1cbiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldExvY2FsU3RyZWFtcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgIHRoaXMuX3NoaW1tZWRMb2NhbFN0cmVhbXMgPSB0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zIHx8IHt9O1xuICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuX3NoaW1tZWRMb2NhbFN0cmVhbXMpLm1hcChmdW5jdGlvbihzdHJlYW1JZCkge1xuICAgICAgICByZXR1cm4gcGMuX3NoaW1tZWRMb2NhbFN0cmVhbXNbc3RyZWFtSWRdWzBdO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHZhciBvcmlnQWRkVHJhY2sgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFRyYWNrO1xuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkVHJhY2sgPSBmdW5jdGlvbih0cmFjaywgc3RyZWFtKSB7XG4gICAgICBpZiAoIXN0cmVhbSkge1xuICAgICAgICByZXR1cm4gb3JpZ0FkZFRyYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgICB0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zID0gdGhpcy5fc2hpbW1lZExvY2FsU3RyZWFtcyB8fCB7fTtcblxuICAgICAgdmFyIHNlbmRlciA9IG9yaWdBZGRUcmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKCF0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zW3N0cmVhbS5pZF0pIHtcbiAgICAgICAgdGhpcy5fc2hpbW1lZExvY2FsU3RyZWFtc1tzdHJlYW0uaWRdID0gW3N0cmVhbSwgc2VuZGVyXTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fc2hpbW1lZExvY2FsU3RyZWFtc1tzdHJlYW0uaWRdLmluZGV4T2Yoc2VuZGVyKSA9PT0gLTEpIHtcbiAgICAgICAgdGhpcy5fc2hpbW1lZExvY2FsU3RyZWFtc1tzdHJlYW0uaWRdLnB1c2goc2VuZGVyKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzZW5kZXI7XG4gICAgfTtcblxuICAgIHZhciBvcmlnQWRkU3RyZWFtID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5hZGRTdHJlYW07XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5hZGRTdHJlYW0gPSBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICB0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zID0gdGhpcy5fc2hpbW1lZExvY2FsU3RyZWFtcyB8fCB7fTtcblxuICAgICAgc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHtcbiAgICAgICAgdmFyIGFscmVhZHlFeGlzdHMgPSBwYy5nZXRTZW5kZXJzKCkuZmluZChmdW5jdGlvbihzKSB7XG4gICAgICAgICAgcmV0dXJuIHMudHJhY2sgPT09IHRyYWNrO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGFscmVhZHlFeGlzdHMpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRE9NRXhjZXB0aW9uKCdUcmFjayBhbHJlYWR5IGV4aXN0cy4nLFxuICAgICAgICAgICAgICAnSW52YWxpZEFjY2Vzc0Vycm9yJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgdmFyIGV4aXN0aW5nU2VuZGVycyA9IHBjLmdldFNlbmRlcnMoKTtcbiAgICAgIG9yaWdBZGRTdHJlYW0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHZhciBuZXdTZW5kZXJzID0gcGMuZ2V0U2VuZGVycygpLmZpbHRlcihmdW5jdGlvbihuZXdTZW5kZXIpIHtcbiAgICAgICAgcmV0dXJuIGV4aXN0aW5nU2VuZGVycy5pbmRleE9mKG5ld1NlbmRlcikgPT09IC0xO1xuICAgICAgfSk7XG4gICAgICB0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zW3N0cmVhbS5pZF0gPSBbc3RyZWFtXS5jb25jYXQobmV3U2VuZGVycyk7XG4gICAgfTtcblxuICAgIHZhciBvcmlnUmVtb3ZlU3RyZWFtID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVTdHJlYW07XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVTdHJlYW0gPSBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgIHRoaXMuX3NoaW1tZWRMb2NhbFN0cmVhbXMgPSB0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zIHx8IHt9O1xuICAgICAgZGVsZXRlIHRoaXMuX3NoaW1tZWRMb2NhbFN0cmVhbXNbc3RyZWFtLmlkXTtcbiAgICAgIHJldHVybiBvcmlnUmVtb3ZlU3RyZWFtLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcblxuICAgIHZhciBvcmlnUmVtb3ZlVHJhY2sgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVRyYWNrO1xuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUucmVtb3ZlVHJhY2sgPSBmdW5jdGlvbihzZW5kZXIpIHtcbiAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICB0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zID0gdGhpcy5fc2hpbW1lZExvY2FsU3RyZWFtcyB8fCB7fTtcbiAgICAgIGlmIChzZW5kZXIpIHtcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5fc2hpbW1lZExvY2FsU3RyZWFtcykuZm9yRWFjaChmdW5jdGlvbihzdHJlYW1JZCkge1xuICAgICAgICAgIHZhciBpZHggPSBwYy5fc2hpbW1lZExvY2FsU3RyZWFtc1tzdHJlYW1JZF0uaW5kZXhPZihzZW5kZXIpO1xuICAgICAgICAgIGlmIChpZHggIT09IC0xKSB7XG4gICAgICAgICAgICBwYy5fc2hpbW1lZExvY2FsU3RyZWFtc1tzdHJlYW1JZF0uc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChwYy5fc2hpbW1lZExvY2FsU3RyZWFtc1tzdHJlYW1JZF0ubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICBkZWxldGUgcGMuX3NoaW1tZWRMb2NhbFN0cmVhbXNbc3RyZWFtSWRdO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gb3JpZ1JlbW92ZVRyYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfSxcblxuICBzaGltQWRkVHJhY2tSZW1vdmVUcmFjazogZnVuY3Rpb24od2luZG93KSB7XG4gICAgaWYgKCF3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGJyb3dzZXJEZXRhaWxzID0gdXRpbHMuZGV0ZWN0QnJvd3Nlcih3aW5kb3cpO1xuICAgIC8vIHNoaW0gYWRkVHJhY2sgYW5kIHJlbW92ZVRyYWNrLlxuICAgIGlmICh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFRyYWNrICYmXG4gICAgICAgIGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPj0gNjUpIHtcbiAgICAgIHJldHVybiB0aGlzLnNoaW1BZGRUcmFja1JlbW92ZVRyYWNrV2l0aE5hdGl2ZSh3aW5kb3cpO1xuICAgIH1cblxuICAgIC8vIGFsc28gc2hpbSBwYy5nZXRMb2NhbFN0cmVhbXMgd2hlbiBhZGRUcmFjayBpcyBzaGltbWVkXG4gICAgLy8gdG8gcmV0dXJuIHRoZSBvcmlnaW5hbCBzdHJlYW1zLlxuICAgIHZhciBvcmlnR2V0TG9jYWxTdHJlYW1zID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVxuICAgICAgICAuZ2V0TG9jYWxTdHJlYW1zO1xuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0TG9jYWxTdHJlYW1zID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgdmFyIG5hdGl2ZVN0cmVhbXMgPSBvcmlnR2V0TG9jYWxTdHJlYW1zLmFwcGx5KHRoaXMpO1xuICAgICAgcGMuX3JldmVyc2VTdHJlYW1zID0gcGMuX3JldmVyc2VTdHJlYW1zIHx8IHt9O1xuICAgICAgcmV0dXJuIG5hdGl2ZVN0cmVhbXMubWFwKGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgICByZXR1cm4gcGMuX3JldmVyc2VTdHJlYW1zW3N0cmVhbS5pZF07XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdmFyIG9yaWdBZGRTdHJlYW0gPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFN0cmVhbTtcbiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgIHBjLl9zdHJlYW1zID0gcGMuX3N0cmVhbXMgfHwge307XG4gICAgICBwYy5fcmV2ZXJzZVN0cmVhbXMgPSBwYy5fcmV2ZXJzZVN0cmVhbXMgfHwge307XG5cbiAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7XG4gICAgICAgIHZhciBhbHJlYWR5RXhpc3RzID0gcGMuZ2V0U2VuZGVycygpLmZpbmQoZnVuY3Rpb24ocykge1xuICAgICAgICAgIHJldHVybiBzLnRyYWNrID09PSB0cmFjaztcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChhbHJlYWR5RXhpc3RzKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignVHJhY2sgYWxyZWFkeSBleGlzdHMuJyxcbiAgICAgICAgICAgICAgJ0ludmFsaWRBY2Nlc3NFcnJvcicpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIC8vIEFkZCBpZGVudGl0eSBtYXBwaW5nIGZvciBjb25zaXN0ZW5jeSB3aXRoIGFkZFRyYWNrLlxuICAgICAgLy8gVW5sZXNzIHRoaXMgaXMgYmVpbmcgdXNlZCB3aXRoIGEgc3RyZWFtIGZyb20gYWRkVHJhY2suXG4gICAgICBpZiAoIXBjLl9yZXZlcnNlU3RyZWFtc1tzdHJlYW0uaWRdKSB7XG4gICAgICAgIHZhciBuZXdTdHJlYW0gPSBuZXcgd2luZG93Lk1lZGlhU3RyZWFtKHN0cmVhbS5nZXRUcmFja3MoKSk7XG4gICAgICAgIHBjLl9zdHJlYW1zW3N0cmVhbS5pZF0gPSBuZXdTdHJlYW07XG4gICAgICAgIHBjLl9yZXZlcnNlU3RyZWFtc1tuZXdTdHJlYW0uaWRdID0gc3RyZWFtO1xuICAgICAgICBzdHJlYW0gPSBuZXdTdHJlYW07XG4gICAgICB9XG4gICAgICBvcmlnQWRkU3RyZWFtLmFwcGx5KHBjLCBbc3RyZWFtXSk7XG4gICAgfTtcblxuICAgIHZhciBvcmlnUmVtb3ZlU3RyZWFtID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVTdHJlYW07XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVTdHJlYW0gPSBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICBwYy5fc3RyZWFtcyA9IHBjLl9zdHJlYW1zIHx8IHt9O1xuICAgICAgcGMuX3JldmVyc2VTdHJlYW1zID0gcGMuX3JldmVyc2VTdHJlYW1zIHx8IHt9O1xuXG4gICAgICBvcmlnUmVtb3ZlU3RyZWFtLmFwcGx5KHBjLCBbKHBjLl9zdHJlYW1zW3N0cmVhbS5pZF0gfHwgc3RyZWFtKV0pO1xuICAgICAgZGVsZXRlIHBjLl9yZXZlcnNlU3RyZWFtc1socGMuX3N0cmVhbXNbc3RyZWFtLmlkXSA/XG4gICAgICAgICAgcGMuX3N0cmVhbXNbc3RyZWFtLmlkXS5pZCA6IHN0cmVhbS5pZCldO1xuICAgICAgZGVsZXRlIHBjLl9zdHJlYW1zW3N0cmVhbS5pZF07XG4gICAgfTtcblxuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkVHJhY2sgPSBmdW5jdGlvbih0cmFjaywgc3RyZWFtKSB7XG4gICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgaWYgKHBjLnNpZ25hbGluZ1N0YXRlID09PSAnY2xvc2VkJykge1xuICAgICAgICB0aHJvdyBuZXcgRE9NRXhjZXB0aW9uKFxuICAgICAgICAgICdUaGUgUlRDUGVlckNvbm5lY3Rpb25cXCdzIHNpZ25hbGluZ1N0YXRlIGlzIFxcJ2Nsb3NlZFxcJy4nLFxuICAgICAgICAgICdJbnZhbGlkU3RhdGVFcnJvcicpO1xuICAgICAgfVxuICAgICAgdmFyIHN0cmVhbXMgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgICBpZiAoc3RyZWFtcy5sZW5ndGggIT09IDEgfHxcbiAgICAgICAgICAhc3RyZWFtc1swXS5nZXRUcmFja3MoKS5maW5kKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiB0ID09PSB0cmFjaztcbiAgICAgICAgICB9KSkge1xuICAgICAgICAvLyB0aGlzIGlzIG5vdCBmdWxseSBjb3JyZWN0IGJ1dCBhbGwgd2UgY2FuIG1hbmFnZSB3aXRob3V0XG4gICAgICAgIC8vIFtbYXNzb2NpYXRlZCBNZWRpYVN0cmVhbXNdXSBpbnRlcm5hbCBzbG90LlxuICAgICAgICB0aHJvdyBuZXcgRE9NRXhjZXB0aW9uKFxuICAgICAgICAgICdUaGUgYWRhcHRlci5qcyBhZGRUcmFjayBwb2x5ZmlsbCBvbmx5IHN1cHBvcnRzIGEgc2luZ2xlICcgK1xuICAgICAgICAgICcgc3RyZWFtIHdoaWNoIGlzIGFzc29jaWF0ZWQgd2l0aCB0aGUgc3BlY2lmaWVkIHRyYWNrLicsXG4gICAgICAgICAgJ05vdFN1cHBvcnRlZEVycm9yJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBhbHJlYWR5RXhpc3RzID0gcGMuZ2V0U2VuZGVycygpLmZpbmQoZnVuY3Rpb24ocykge1xuICAgICAgICByZXR1cm4gcy50cmFjayA9PT0gdHJhY2s7XG4gICAgICB9KTtcbiAgICAgIGlmIChhbHJlYWR5RXhpc3RzKSB7XG4gICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oJ1RyYWNrIGFscmVhZHkgZXhpc3RzLicsXG4gICAgICAgICAgICAnSW52YWxpZEFjY2Vzc0Vycm9yJyk7XG4gICAgICB9XG5cbiAgICAgIHBjLl9zdHJlYW1zID0gcGMuX3N0cmVhbXMgfHwge307XG4gICAgICBwYy5fcmV2ZXJzZVN0cmVhbXMgPSBwYy5fcmV2ZXJzZVN0cmVhbXMgfHwge307XG4gICAgICB2YXIgb2xkU3RyZWFtID0gcGMuX3N0cmVhbXNbc3RyZWFtLmlkXTtcbiAgICAgIGlmIChvbGRTdHJlYW0pIHtcbiAgICAgICAgLy8gdGhpcyBpcyB1c2luZyBvZGQgQ2hyb21lIGJlaGF2aW91ciwgdXNlIHdpdGggY2F1dGlvbjpcbiAgICAgICAgLy8gaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL3dlYnJ0Yy9pc3N1ZXMvZGV0YWlsP2lkPTc4MTVcbiAgICAgICAgLy8gTm90ZTogd2UgcmVseSBvbiB0aGUgaGlnaC1sZXZlbCBhZGRUcmFjay9kdG1mIHNoaW0gdG9cbiAgICAgICAgLy8gY3JlYXRlIHRoZSBzZW5kZXIgd2l0aCBhIGR0bWYgc2VuZGVyLlxuICAgICAgICBvbGRTdHJlYW0uYWRkVHJhY2sodHJhY2spO1xuXG4gICAgICAgIC8vIFRyaWdnZXIgT05OIGFzeW5jLlxuICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHBjLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCduZWdvdGlhdGlvbm5lZWRlZCcpKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgbmV3U3RyZWFtID0gbmV3IHdpbmRvdy5NZWRpYVN0cmVhbShbdHJhY2tdKTtcbiAgICAgICAgcGMuX3N0cmVhbXNbc3RyZWFtLmlkXSA9IG5ld1N0cmVhbTtcbiAgICAgICAgcGMuX3JldmVyc2VTdHJlYW1zW25ld1N0cmVhbS5pZF0gPSBzdHJlYW07XG4gICAgICAgIHBjLmFkZFN0cmVhbShuZXdTdHJlYW0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHBjLmdldFNlbmRlcnMoKS5maW5kKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgcmV0dXJuIHMudHJhY2sgPT09IHRyYWNrO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8vIHJlcGxhY2UgdGhlIGludGVybmFsIHN0cmVhbSBpZCB3aXRoIHRoZSBleHRlcm5hbCBvbmUgYW5kXG4gICAgLy8gdmljZSB2ZXJzYS5cbiAgICBmdW5jdGlvbiByZXBsYWNlSW50ZXJuYWxTdHJlYW1JZChwYywgZGVzY3JpcHRpb24pIHtcbiAgICAgIHZhciBzZHAgPSBkZXNjcmlwdGlvbi5zZHA7XG4gICAgICBPYmplY3Qua2V5cyhwYy5fcmV2ZXJzZVN0cmVhbXMgfHwgW10pLmZvckVhY2goZnVuY3Rpb24oaW50ZXJuYWxJZCkge1xuICAgICAgICB2YXIgZXh0ZXJuYWxTdHJlYW0gPSBwYy5fcmV2ZXJzZVN0cmVhbXNbaW50ZXJuYWxJZF07XG4gICAgICAgIHZhciBpbnRlcm5hbFN0cmVhbSA9IHBjLl9zdHJlYW1zW2V4dGVybmFsU3RyZWFtLmlkXTtcbiAgICAgICAgc2RwID0gc2RwLnJlcGxhY2UobmV3IFJlZ0V4cChpbnRlcm5hbFN0cmVhbS5pZCwgJ2cnKSxcbiAgICAgICAgICAgIGV4dGVybmFsU3RyZWFtLmlkKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oe1xuICAgICAgICB0eXBlOiBkZXNjcmlwdGlvbi50eXBlLFxuICAgICAgICBzZHA6IHNkcFxuICAgICAgfSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHJlcGxhY2VFeHRlcm5hbFN0cmVhbUlkKHBjLCBkZXNjcmlwdGlvbikge1xuICAgICAgdmFyIHNkcCA9IGRlc2NyaXB0aW9uLnNkcDtcbiAgICAgIE9iamVjdC5rZXlzKHBjLl9yZXZlcnNlU3RyZWFtcyB8fCBbXSkuZm9yRWFjaChmdW5jdGlvbihpbnRlcm5hbElkKSB7XG4gICAgICAgIHZhciBleHRlcm5hbFN0cmVhbSA9IHBjLl9yZXZlcnNlU3RyZWFtc1tpbnRlcm5hbElkXTtcbiAgICAgICAgdmFyIGludGVybmFsU3RyZWFtID0gcGMuX3N0cmVhbXNbZXh0ZXJuYWxTdHJlYW0uaWRdO1xuICAgICAgICBzZHAgPSBzZHAucmVwbGFjZShuZXcgUmVnRXhwKGV4dGVybmFsU3RyZWFtLmlkLCAnZycpLFxuICAgICAgICAgICAgaW50ZXJuYWxTdHJlYW0uaWQpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7XG4gICAgICAgIHR5cGU6IGRlc2NyaXB0aW9uLnR5cGUsXG4gICAgICAgIHNkcDogc2RwXG4gICAgICB9KTtcbiAgICB9XG4gICAgWydjcmVhdGVPZmZlcicsICdjcmVhdGVBbnN3ZXInXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTtcbiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgICAgdmFyIGlzTGVnYWN5Q2FsbCA9IGFyZ3VtZW50cy5sZW5ndGggJiZcbiAgICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdmdW5jdGlvbic7XG4gICAgICAgIGlmIChpc0xlZ2FjeUNhbGwpIHtcbiAgICAgICAgICByZXR1cm4gbmF0aXZlTWV0aG9kLmFwcGx5KHBjLCBbXG4gICAgICAgICAgICBmdW5jdGlvbihkZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgICB2YXIgZGVzYyA9IHJlcGxhY2VJbnRlcm5hbFN0cmVhbUlkKHBjLCBkZXNjcmlwdGlvbik7XG4gICAgICAgICAgICAgIGFyZ3NbMF0uYXBwbHkobnVsbCwgW2Rlc2NdKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgaWYgKGFyZ3NbMV0pIHtcbiAgICAgICAgICAgICAgICBhcmdzWzFdLmFwcGx5KG51bGwsIGVycik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIGFyZ3VtZW50c1syXVxuICAgICAgICAgIF0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuYXRpdmVNZXRob2QuYXBwbHkocGMsIGFyZ3VtZW50cylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oZGVzY3JpcHRpb24pIHtcbiAgICAgICAgICByZXR1cm4gcmVwbGFjZUludGVybmFsU3RyZWFtSWQocGMsIGRlc2NyaXB0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgdmFyIG9yaWdTZXRMb2NhbERlc2NyaXB0aW9uID1cbiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXRMb2NhbERlc2NyaXB0aW9uO1xuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuc2V0TG9jYWxEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCB8fCAhYXJndW1lbnRzWzBdLnR5cGUpIHtcbiAgICAgICAgcmV0dXJuIG9yaWdTZXRMb2NhbERlc2NyaXB0aW9uLmFwcGx5KHBjLCBhcmd1bWVudHMpO1xuICAgICAgfVxuICAgICAgYXJndW1lbnRzWzBdID0gcmVwbGFjZUV4dGVybmFsU3RyZWFtSWQocGMsIGFyZ3VtZW50c1swXSk7XG4gICAgICByZXR1cm4gb3JpZ1NldExvY2FsRGVzY3JpcHRpb24uYXBwbHkocGMsIGFyZ3VtZW50cyk7XG4gICAgfTtcblxuICAgIC8vIFRPRE86IG1hbmdsZSBnZXRTdGF0czogaHR0cHM6Ly93M2MuZ2l0aHViLmlvL3dlYnJ0Yy1zdGF0cy8jZG9tLXJ0Y21lZGlhc3RyZWFtc3RhdHMtc3RyZWFtaWRlbnRpZmllclxuXG4gICAgdmFyIG9yaWdMb2NhbERlc2NyaXB0aW9uID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihcbiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSwgJ2xvY2FsRGVzY3JpcHRpb24nKTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSxcbiAgICAgICAgJ2xvY2FsRGVzY3JpcHRpb24nLCB7XG4gICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSBvcmlnTG9jYWxEZXNjcmlwdGlvbi5nZXQuYXBwbHkodGhpcyk7XG4gICAgICAgICAgICBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlcGxhY2VJbnRlcm5hbFN0cmVhbUlkKHBjLCBkZXNjcmlwdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUucmVtb3ZlVHJhY2sgPSBmdW5jdGlvbihzZW5kZXIpIHtcbiAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICBpZiAocGMuc2lnbmFsaW5nU3RhdGUgPT09ICdjbG9zZWQnKSB7XG4gICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oXG4gICAgICAgICAgJ1RoZSBSVENQZWVyQ29ubmVjdGlvblxcJ3Mgc2lnbmFsaW5nU3RhdGUgaXMgXFwnY2xvc2VkXFwnLicsXG4gICAgICAgICAgJ0ludmFsaWRTdGF0ZUVycm9yJyk7XG4gICAgICB9XG4gICAgICAvLyBXZSBjYW4gbm90IHlldCBjaGVjayBmb3Igc2VuZGVyIGluc3RhbmNlb2YgUlRDUnRwU2VuZGVyXG4gICAgICAvLyBzaW5jZSB3ZSBzaGltIFJUUFNlbmRlci4gU28gd2UgY2hlY2sgaWYgc2VuZGVyLl9wYyBpcyBzZXQuXG4gICAgICBpZiAoIXNlbmRlci5fcGMpIHtcbiAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignQXJndW1lbnQgMSBvZiBSVENQZWVyQ29ubmVjdGlvbi5yZW1vdmVUcmFjayAnICtcbiAgICAgICAgICAgICdkb2VzIG5vdCBpbXBsZW1lbnQgaW50ZXJmYWNlIFJUQ1J0cFNlbmRlci4nLCAnVHlwZUVycm9yJyk7XG4gICAgICB9XG4gICAgICB2YXIgaXNMb2NhbCA9IHNlbmRlci5fcGMgPT09IHBjO1xuICAgICAgaWYgKCFpc0xvY2FsKSB7XG4gICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oJ1NlbmRlciB3YXMgbm90IGNyZWF0ZWQgYnkgdGhpcyBjb25uZWN0aW9uLicsXG4gICAgICAgICAgICAnSW52YWxpZEFjY2Vzc0Vycm9yJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFNlYXJjaCBmb3IgdGhlIG5hdGl2ZSBzdHJlYW0gdGhlIHNlbmRlcnMgdHJhY2sgYmVsb25ncyB0by5cbiAgICAgIHBjLl9zdHJlYW1zID0gcGMuX3N0cmVhbXMgfHwge307XG4gICAgICB2YXIgc3RyZWFtO1xuICAgICAgT2JqZWN0LmtleXMocGMuX3N0cmVhbXMpLmZvckVhY2goZnVuY3Rpb24oc3RyZWFtaWQpIHtcbiAgICAgICAgdmFyIGhhc1RyYWNrID0gcGMuX3N0cmVhbXNbc3RyZWFtaWRdLmdldFRyYWNrcygpLmZpbmQoZnVuY3Rpb24odHJhY2spIHtcbiAgICAgICAgICByZXR1cm4gc2VuZGVyLnRyYWNrID09PSB0cmFjaztcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChoYXNUcmFjaykge1xuICAgICAgICAgIHN0cmVhbSA9IHBjLl9zdHJlYW1zW3N0cmVhbWlkXTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGlmIChzdHJlYW0pIHtcbiAgICAgICAgaWYgKHN0cmVhbS5nZXRUcmFja3MoKS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAvLyBpZiB0aGlzIGlzIHRoZSBsYXN0IHRyYWNrIG9mIHRoZSBzdHJlYW0sIHJlbW92ZSB0aGUgc3RyZWFtLiBUaGlzXG4gICAgICAgICAgLy8gdGFrZXMgY2FyZSBvZiBhbnkgc2hpbW1lZCBfc2VuZGVycy5cbiAgICAgICAgICBwYy5yZW1vdmVTdHJlYW0ocGMuX3JldmVyc2VTdHJlYW1zW3N0cmVhbS5pZF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIHJlbHlpbmcgb24gdGhlIHNhbWUgb2RkIGNocm9tZSBiZWhhdmlvdXIgYXMgYWJvdmUuXG4gICAgICAgICAgc3RyZWFtLnJlbW92ZVRyYWNrKHNlbmRlci50cmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgcGMuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ25lZ290aWF0aW9ubmVlZGVkJykpO1xuICAgICAgfVxuICAgIH07XG4gIH0sXG5cbiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICB2YXIgYnJvd3NlckRldGFpbHMgPSB1dGlscy5kZXRlY3RCcm93c2VyKHdpbmRvdyk7XG5cbiAgICAvLyBUaGUgUlRDUGVlckNvbm5lY3Rpb24gb2JqZWN0LlxuICAgIGlmICghd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmIHdpbmRvdy53ZWJraXRSVENQZWVyQ29ubmVjdGlvbikge1xuICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uID0gZnVuY3Rpb24ocGNDb25maWcsIHBjQ29uc3RyYWludHMpIHtcbiAgICAgICAgLy8gVHJhbnNsYXRlIGljZVRyYW5zcG9ydFBvbGljeSB0byBpY2VUcmFuc3BvcnRzLFxuICAgICAgICAvLyBzZWUgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD00ODY5XG4gICAgICAgIC8vIHRoaXMgd2FzIGZpeGVkIGluIE01NiBhbG9uZyB3aXRoIHVucHJlZml4aW5nIFJUQ1BlZXJDb25uZWN0aW9uLlxuICAgICAgICBsb2dnaW5nKCdQZWVyQ29ubmVjdGlvbicpO1xuICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5KSB7XG4gICAgICAgICAgcGNDb25maWcuaWNlVHJhbnNwb3J0cyA9IHBjQ29uZmlnLmljZVRyYW5zcG9ydFBvbGljeTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBuZXcgd2luZG93LndlYmtpdFJUQ1BlZXJDb25uZWN0aW9uKHBjQ29uZmlnLCBwY0NvbnN0cmFpbnRzKTtcbiAgICAgIH07XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlID1cbiAgICAgICAgICB3aW5kb3cud2Via2l0UlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlO1xuICAgICAgLy8gd3JhcCBzdGF0aWMgbWV0aG9kcy4gQ3VycmVudGx5IGp1c3QgZ2VuZXJhdGVDZXJ0aWZpY2F0ZS5cbiAgICAgIGlmICh3aW5kb3cud2Via2l0UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZSkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLCAnZ2VuZXJhdGVDZXJ0aWZpY2F0ZScsIHtcbiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy53ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5nZW5lcmF0ZUNlcnRpZmljYXRlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIG9yaWdHZXRTdGF0cyA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHM7XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKHNlbGVjdG9yLFxuICAgICAgICBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHtcbiAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcblxuICAgICAgLy8gSWYgc2VsZWN0b3IgaXMgYSBmdW5jdGlvbiB0aGVuIHdlIGFyZSBpbiB0aGUgb2xkIHN0eWxlIHN0YXRzIHNvIGp1c3RcbiAgICAgIC8vIHBhc3MgYmFjayB0aGUgb3JpZ2luYWwgZ2V0U3RhdHMgZm9ybWF0IHRvIGF2b2lkIGJyZWFraW5nIG9sZCB1c2Vycy5cbiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMCAmJiB0eXBlb2Ygc2VsZWN0b3IgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICAvLyBXaGVuIHNwZWMtc3R5bGUgZ2V0U3RhdHMgaXMgc3VwcG9ydGVkLCByZXR1cm4gdGhvc2Ugd2hlbiBjYWxsZWQgd2l0aFxuICAgICAgLy8gZWl0aGVyIG5vIGFyZ3VtZW50cyBvciB0aGUgc2VsZWN0b3IgYXJndW1lbnQgaXMgbnVsbC5cbiAgICAgIGlmIChvcmlnR2V0U3RhdHMubGVuZ3RoID09PSAwICYmIChhcmd1bWVudHMubGVuZ3RoID09PSAwIHx8XG4gICAgICAgICAgdHlwZW9mIGFyZ3VtZW50c1swXSAhPT0gJ2Z1bmN0aW9uJykpIHtcbiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbXSk7XG4gICAgICB9XG5cbiAgICAgIHZhciBmaXhDaHJvbWVTdGF0c18gPSBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICB2YXIgc3RhbmRhcmRSZXBvcnQgPSB7fTtcbiAgICAgICAgdmFyIHJlcG9ydHMgPSByZXNwb25zZS5yZXN1bHQoKTtcbiAgICAgICAgcmVwb3J0cy5mb3JFYWNoKGZ1bmN0aW9uKHJlcG9ydCkge1xuICAgICAgICAgIHZhciBzdGFuZGFyZFN0YXRzID0ge1xuICAgICAgICAgICAgaWQ6IHJlcG9ydC5pZCxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogcmVwb3J0LnRpbWVzdGFtcCxcbiAgICAgICAgICAgIHR5cGU6IHtcbiAgICAgICAgICAgICAgbG9jYWxjYW5kaWRhdGU6ICdsb2NhbC1jYW5kaWRhdGUnLFxuICAgICAgICAgICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJ1xuICAgICAgICAgICAgfVtyZXBvcnQudHlwZV0gfHwgcmVwb3J0LnR5cGVcbiAgICAgICAgICB9O1xuICAgICAgICAgIHJlcG9ydC5uYW1lcygpLmZvckVhY2goZnVuY3Rpb24obmFtZSkge1xuICAgICAgICAgICAgc3RhbmRhcmRTdGF0c1tuYW1lXSA9IHJlcG9ydC5zdGF0KG5hbWUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHN0YW5kYXJkUmVwb3J0W3N0YW5kYXJkU3RhdHMuaWRdID0gc3RhbmRhcmRTdGF0cztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHN0YW5kYXJkUmVwb3J0O1xuICAgICAgfTtcblxuICAgICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydFxuICAgICAgdmFyIG1ha2VNYXBTdGF0cyA9IGZ1bmN0aW9uKHN0YXRzKSB7XG4gICAgICAgIHJldHVybiBuZXcgTWFwKE9iamVjdC5rZXlzKHN0YXRzKS5tYXAoZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgICAgcmV0dXJuIFtrZXksIHN0YXRzW2tleV1dO1xuICAgICAgICB9KSk7XG4gICAgICB9O1xuXG4gICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+PSAyKSB7XG4gICAgICAgIHZhciBzdWNjZXNzQ2FsbGJhY2tXcmFwcGVyXyA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgYXJnc1sxXShtYWtlTWFwU3RhdHMoZml4Q2hyb21lU3RhdHNfKHJlc3BvbnNlKSkpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBvcmlnR2V0U3RhdHMuYXBwbHkodGhpcywgW3N1Y2Nlc3NDYWxsYmFja1dyYXBwZXJfLFxuICAgICAgICAgIGFyZ3VtZW50c1swXV0pO1xuICAgICAgfVxuXG4gICAgICAvLyBwcm9taXNlLXN1cHBvcnRcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgb3JpZ0dldFN0YXRzLmFwcGx5KHBjLCBbXG4gICAgICAgICAgZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJlc29sdmUobWFrZU1hcFN0YXRzKGZpeENocm9tZVN0YXRzXyhyZXNwb25zZSkpKTtcbiAgICAgICAgICB9LCByZWplY3RdKTtcbiAgICAgIH0pLnRoZW4oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKTtcbiAgICB9O1xuXG4gICAgLy8gYWRkIHByb21pc2Ugc3VwcG9ydCAtLSBuYXRpdmVseSBhdmFpbGFibGUgaW4gQ2hyb21lIDUxXG4gICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1MSkge1xuICAgICAgWydzZXRMb2NhbERlc2NyaXB0aW9uJywgJ3NldFJlbW90ZURlc2NyaXB0aW9uJywgJ2FkZEljZUNhbmRpZGF0ZSddXG4gICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgICAgICAgICB2YXIgbmF0aXZlTWV0aG9kID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdO1xuICAgICAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIG5hdGl2ZU1ldGhvZC5hcHBseShwYywgW2FyZ3NbMF0sIHJlc29sdmUsIHJlamVjdF0pO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgYXJnc1sxXS5hcHBseShudWxsLCBbXSk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA+PSAzKSB7XG4gICAgICAgICAgICAgICAgICBhcmdzWzJdLmFwcGx5KG51bGwsIFtlcnJdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBwcm9taXNlIHN1cHBvcnQgZm9yIGNyZWF0ZU9mZmVyIGFuZCBjcmVhdGVBbnN3ZXIuIEF2YWlsYWJsZSAod2l0aG91dFxuICAgIC8vIGJ1Z3MpIHNpbmNlIE01MjogY3JidWcvNjE5Mjg5XG4gICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1Mikge1xuICAgICAgWydjcmVhdGVPZmZlcicsICdjcmVhdGVBbnN3ZXInXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgICAgICB2YXIgbmF0aXZlTWV0aG9kID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdO1xuICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMSB8fCAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSAmJlxuICAgICAgICAgICAgICB0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnb2JqZWN0JykpIHtcbiAgICAgICAgICAgIHZhciBvcHRzID0gYXJndW1lbnRzLmxlbmd0aCA9PT0gMSA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHBjLCBbcmVzb2x2ZSwgcmVqZWN0LCBvcHRzXSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gc2hpbSBpbXBsaWNpdCBjcmVhdGlvbiBvZiBSVENTZXNzaW9uRGVzY3JpcHRpb24vUlRDSWNlQ2FuZGlkYXRlXG4gICAgWydzZXRMb2NhbERlc2NyaXB0aW9uJywgJ3NldFJlbW90ZURlc2NyaXB0aW9uJywgJ2FkZEljZUNhbmRpZGF0ZSddXG4gICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlW21ldGhvZF07XG4gICAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBhcmd1bWVudHNbMF0gPSBuZXcgKChtZXRob2QgPT09ICdhZGRJY2VDYW5kaWRhdGUnKSA/XG4gICAgICAgICAgICAgICAgd2luZG93LlJUQ0ljZUNhbmRpZGF0ZSA6XG4gICAgICAgICAgICAgICAgd2luZG93LlJUQ1Nlc3Npb25EZXNjcmlwdGlvbikoYXJndW1lbnRzWzBdKTtcbiAgICAgICAgICAgIHJldHVybiBuYXRpdmVNZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgIC8vIHN1cHBvcnQgZm9yIGFkZEljZUNhbmRpZGF0ZShudWxsIG9yIHVuZGVmaW5lZClcbiAgICB2YXIgbmF0aXZlQWRkSWNlQ2FuZGlkYXRlID1cbiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5hZGRJY2VDYW5kaWRhdGU7XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5hZGRJY2VDYW5kaWRhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghYXJndW1lbnRzWzBdKSB7XG4gICAgICAgIGlmIChhcmd1bWVudHNbMV0pIHtcbiAgICAgICAgICBhcmd1bWVudHNbMV0uYXBwbHkobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5hdGl2ZUFkZEljZUNhbmRpZGF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH07XG4gIH0sXG5cbiAgZml4TmVnb3RpYXRpb25OZWVkZWQ6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIHV0aWxzLndyYXBQZWVyQ29ubmVjdGlvbkV2ZW50KHdpbmRvdywgJ25lZ290aWF0aW9ubmVlZGVkJywgZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIHBjID0gZS50YXJnZXQ7XG4gICAgICBpZiAocGMuc2lnbmFsaW5nU3RhdGUgIT09ICdzdGFibGUnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBlO1xuICAgIH0pO1xuICB9LFxuXG4gIHNoaW1HZXREaXNwbGF5TWVkaWE6IGZ1bmN0aW9uKHdpbmRvdywgZ2V0U291cmNlSWQpIHtcbiAgICBpZiAoIXdpbmRvdy5uYXZpZ2F0b3IgfHwgIXdpbmRvdy5uYXZpZ2F0b3IubWVkaWFEZXZpY2VzIHx8XG4gICAgICAgICdnZXREaXNwbGF5TWVkaWEnIGluIHdpbmRvdy5uYXZpZ2F0b3IubWVkaWFEZXZpY2VzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIGdldFNvdXJjZUlkIGlzIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgcHJvbWlzZSByZXNvbHZpbmcgd2l0aFxuICAgIC8vIHRoZSBzb3VyY2VJZCBvZiB0aGUgc2NyZWVuL3dpbmRvdy90YWIgdG8gYmUgc2hhcmVkLlxuICAgIGlmICh0eXBlb2YgZ2V0U291cmNlSWQgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ3NoaW1HZXREaXNwbGF5TWVkaWE6IGdldFNvdXJjZUlkIGFyZ3VtZW50IGlzIG5vdCAnICtcbiAgICAgICAgICAnYSBmdW5jdGlvbicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB3aW5kb3cubmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXREaXNwbGF5TWVkaWEgPSBmdW5jdGlvbihjb25zdHJhaW50cykge1xuICAgICAgcmV0dXJuIGdldFNvdXJjZUlkKGNvbnN0cmFpbnRzKVxuICAgICAgICAudGhlbihmdW5jdGlvbihzb3VyY2VJZCkge1xuICAgICAgICAgIHZhciB3aWR0aFNwZWNpZmllZCA9IGNvbnN0cmFpbnRzLnZpZGVvICYmIGNvbnN0cmFpbnRzLnZpZGVvLndpZHRoO1xuICAgICAgICAgIHZhciBoZWlnaHRTcGVjaWZpZWQgPSBjb25zdHJhaW50cy52aWRlbyAmJiBjb25zdHJhaW50cy52aWRlby5oZWlnaHQ7XG4gICAgICAgICAgdmFyIGZyYW1lUmF0ZVNwZWNpZmllZCA9IGNvbnN0cmFpbnRzLnZpZGVvICYmXG4gICAgICAgICAgICBjb25zdHJhaW50cy52aWRlby5mcmFtZVJhdGU7XG4gICAgICAgICAgY29uc3RyYWludHMudmlkZW8gPSB7XG4gICAgICAgICAgICBtYW5kYXRvcnk6IHtcbiAgICAgICAgICAgICAgY2hyb21lTWVkaWFTb3VyY2U6ICdkZXNrdG9wJyxcbiAgICAgICAgICAgICAgY2hyb21lTWVkaWFTb3VyY2VJZDogc291cmNlSWQsXG4gICAgICAgICAgICAgIG1heEZyYW1lUmF0ZTogZnJhbWVSYXRlU3BlY2lmaWVkIHx8IDNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICAgIGlmICh3aWR0aFNwZWNpZmllZCkge1xuICAgICAgICAgICAgY29uc3RyYWludHMudmlkZW8ubWFuZGF0b3J5Lm1heFdpZHRoID0gd2lkdGhTcGVjaWZpZWQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChoZWlnaHRTcGVjaWZpZWQpIHtcbiAgICAgICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvLm1hbmRhdG9yeS5tYXhIZWlnaHQgPSBoZWlnaHRTcGVjaWZpZWQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB3aW5kb3cubmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHdpbmRvdy5uYXZpZ2F0b3IuZ2V0RGlzcGxheU1lZGlhID0gZnVuY3Rpb24oY29uc3RyYWludHMpIHtcbiAgICAgIHV0aWxzLmRlcHJlY2F0ZWQoJ25hdmlnYXRvci5nZXREaXNwbGF5TWVkaWEnLFxuICAgICAgICAgICduYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldERpc3BsYXlNZWRpYScpO1xuICAgICAgcmV0dXJuIHdpbmRvdy5uYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldERpc3BsYXlNZWRpYShjb25zdHJhaW50cyk7XG4gICAgfTtcbiAgfVxufTtcbiIsIi8qXG4gKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlXG4gKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlXG4gKiAgdHJlZS5cbiAqL1xuIC8qIGVzbGludC1lbnYgbm9kZSAqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKTtcbnZhciBsb2dnaW5nID0gdXRpbHMubG9nO1xuXG4vLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHdpbmRvdykge1xuICB2YXIgYnJvd3NlckRldGFpbHMgPSB1dGlscy5kZXRlY3RCcm93c2VyKHdpbmRvdyk7XG4gIHZhciBuYXZpZ2F0b3IgPSB3aW5kb3cgJiYgd2luZG93Lm5hdmlnYXRvcjtcblxuICB2YXIgY29uc3RyYWludHNUb0Nocm9tZV8gPSBmdW5jdGlvbihjKSB7XG4gICAgaWYgKHR5cGVvZiBjICE9PSAnb2JqZWN0JyB8fCBjLm1hbmRhdG9yeSB8fCBjLm9wdGlvbmFsKSB7XG4gICAgICByZXR1cm4gYztcbiAgICB9XG4gICAgdmFyIGNjID0ge307XG4gICAgT2JqZWN0LmtleXMoYykuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAgIGlmIChrZXkgPT09ICdyZXF1aXJlJyB8fCBrZXkgPT09ICdhZHZhbmNlZCcgfHwga2V5ID09PSAnbWVkaWFTb3VyY2UnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciByID0gKHR5cGVvZiBjW2tleV0gPT09ICdvYmplY3QnKSA/IGNba2V5XSA6IHtpZGVhbDogY1trZXldfTtcbiAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHIuZXhhY3QgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHIubWluID0gci5tYXggPSByLmV4YWN0O1xuICAgICAgfVxuICAgICAgdmFyIG9sZG5hbWVfID0gZnVuY3Rpb24ocHJlZml4LCBuYW1lKSB7XG4gICAgICAgIGlmIChwcmVmaXgpIHtcbiAgICAgICAgICByZXR1cm4gcHJlZml4ICsgbmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIG5hbWUuc2xpY2UoMSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChuYW1lID09PSAnZGV2aWNlSWQnKSA/ICdzb3VyY2VJZCcgOiBuYW1lO1xuICAgICAgfTtcbiAgICAgIGlmIChyLmlkZWFsICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY2Mub3B0aW9uYWwgPSBjYy5vcHRpb25hbCB8fCBbXTtcbiAgICAgICAgdmFyIG9jID0ge307XG4gICAgICAgIGlmICh0eXBlb2Ygci5pZGVhbCA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICBvY1tvbGRuYW1lXygnbWluJywga2V5KV0gPSByLmlkZWFsO1xuICAgICAgICAgIGNjLm9wdGlvbmFsLnB1c2gob2MpO1xuICAgICAgICAgIG9jID0ge307XG4gICAgICAgICAgb2Nbb2xkbmFtZV8oJ21heCcsIGtleSldID0gci5pZGVhbDtcbiAgICAgICAgICBjYy5vcHRpb25hbC5wdXNoKG9jKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvY1tvbGRuYW1lXygnJywga2V5KV0gPSByLmlkZWFsO1xuICAgICAgICAgIGNjLm9wdGlvbmFsLnB1c2gob2MpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoci5leGFjdCAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiByLmV4YWN0ICE9PSAnbnVtYmVyJykge1xuICAgICAgICBjYy5tYW5kYXRvcnkgPSBjYy5tYW5kYXRvcnkgfHwge307XG4gICAgICAgIGNjLm1hbmRhdG9yeVtvbGRuYW1lXygnJywga2V5KV0gPSByLmV4YWN0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgWydtaW4nLCAnbWF4J10uZm9yRWFjaChmdW5jdGlvbihtaXgpIHtcbiAgICAgICAgICBpZiAoclttaXhdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNjLm1hbmRhdG9yeSA9IGNjLm1hbmRhdG9yeSB8fCB7fTtcbiAgICAgICAgICAgIGNjLm1hbmRhdG9yeVtvbGRuYW1lXyhtaXgsIGtleSldID0gclttaXhdO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKGMuYWR2YW5jZWQpIHtcbiAgICAgIGNjLm9wdGlvbmFsID0gKGNjLm9wdGlvbmFsIHx8IFtdKS5jb25jYXQoYy5hZHZhbmNlZCk7XG4gICAgfVxuICAgIHJldHVybiBjYztcbiAgfTtcblxuICB2YXIgc2hpbUNvbnN0cmFpbnRzXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzLCBmdW5jKSB7XG4gICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPj0gNjEpIHtcbiAgICAgIHJldHVybiBmdW5jKGNvbnN0cmFpbnRzKTtcbiAgICB9XG4gICAgY29uc3RyYWludHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKSk7XG4gICAgaWYgKGNvbnN0cmFpbnRzICYmIHR5cGVvZiBjb25zdHJhaW50cy5hdWRpbyA9PT0gJ29iamVjdCcpIHtcbiAgICAgIHZhciByZW1hcCA9IGZ1bmN0aW9uKG9iaiwgYSwgYikge1xuICAgICAgICBpZiAoYSBpbiBvYmogJiYgIShiIGluIG9iaikpIHtcbiAgICAgICAgICBvYmpbYl0gPSBvYmpbYV07XG4gICAgICAgICAgZGVsZXRlIG9ialthXTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGNvbnN0cmFpbnRzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpO1xuICAgICAgcmVtYXAoY29uc3RyYWludHMuYXVkaW8sICdhdXRvR2FpbkNvbnRyb2wnLCAnZ29vZ0F1dG9HYWluQ29udHJvbCcpO1xuICAgICAgcmVtYXAoY29uc3RyYWludHMuYXVkaW8sICdub2lzZVN1cHByZXNzaW9uJywgJ2dvb2dOb2lzZVN1cHByZXNzaW9uJyk7XG4gICAgICBjb25zdHJhaW50cy5hdWRpbyA9IGNvbnN0cmFpbnRzVG9DaHJvbWVfKGNvbnN0cmFpbnRzLmF1ZGlvKTtcbiAgICB9XG4gICAgaWYgKGNvbnN0cmFpbnRzICYmIHR5cGVvZiBjb25zdHJhaW50cy52aWRlbyA9PT0gJ29iamVjdCcpIHtcbiAgICAgIC8vIFNoaW0gZmFjaW5nTW9kZSBmb3IgbW9iaWxlICYgc3VyZmFjZSBwcm8uXG4gICAgICB2YXIgZmFjZSA9IGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7XG4gICAgICBmYWNlID0gZmFjZSAmJiAoKHR5cGVvZiBmYWNlID09PSAnb2JqZWN0JykgPyBmYWNlIDoge2lkZWFsOiBmYWNlfSk7XG4gICAgICB2YXIgZ2V0U3VwcG9ydGVkRmFjaW5nTW9kZUxpZXMgPSBicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNjY7XG5cbiAgICAgIGlmICgoZmFjZSAmJiAoZmFjZS5leGFjdCA9PT0gJ3VzZXInIHx8IGZhY2UuZXhhY3QgPT09ICdlbnZpcm9ubWVudCcgfHxcbiAgICAgICAgICAgICAgICAgICAgZmFjZS5pZGVhbCA9PT0gJ3VzZXInIHx8IGZhY2UuaWRlYWwgPT09ICdlbnZpcm9ubWVudCcpKSAmJlxuICAgICAgICAgICEobmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRTdXBwb3J0ZWRDb25zdHJhaW50cyAmJlxuICAgICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRTdXBwb3J0ZWRDb25zdHJhaW50cygpLmZhY2luZ01vZGUgJiZcbiAgICAgICAgICAgICFnZXRTdXBwb3J0ZWRGYWNpbmdNb2RlTGllcykpIHtcbiAgICAgICAgZGVsZXRlIGNvbnN0cmFpbnRzLnZpZGVvLmZhY2luZ01vZGU7XG4gICAgICAgIHZhciBtYXRjaGVzO1xuICAgICAgICBpZiAoZmFjZS5leGFjdCA9PT0gJ2Vudmlyb25tZW50JyB8fCBmYWNlLmlkZWFsID09PSAnZW52aXJvbm1lbnQnKSB7XG4gICAgICAgICAgbWF0Y2hlcyA9IFsnYmFjaycsICdyZWFyJ107XG4gICAgICAgIH0gZWxzZSBpZiAoZmFjZS5leGFjdCA9PT0gJ3VzZXInIHx8IGZhY2UuaWRlYWwgPT09ICd1c2VyJykge1xuICAgICAgICAgIG1hdGNoZXMgPSBbJ2Zyb250J107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgICAvLyBMb29rIGZvciBtYXRjaGVzIGluIGxhYmVsLCBvciB1c2UgbGFzdCBjYW0gZm9yIGJhY2sgKHR5cGljYWwpLlxuICAgICAgICAgIHJldHVybiBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMoKVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRldmljZXMpIHtcbiAgICAgICAgICAgIGRldmljZXMgPSBkZXZpY2VzLmZpbHRlcihmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgIHJldHVybiBkLmtpbmQgPT09ICd2aWRlb2lucHV0JztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGRldiA9IGRldmljZXMuZmluZChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtYXRjaGVzLnNvbWUoZnVuY3Rpb24obWF0Y2gpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZC5sYWJlbC50b0xvd2VyQ2FzZSgpLmluZGV4T2YobWF0Y2gpICE9PSAtMTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICghZGV2ICYmIGRldmljZXMubGVuZ3RoICYmIG1hdGNoZXMuaW5kZXhPZignYmFjaycpICE9PSAtMSkge1xuICAgICAgICAgICAgICBkZXYgPSBkZXZpY2VzW2RldmljZXMubGVuZ3RoIC0gMV07IC8vIG1vcmUgbGlrZWx5IHRoZSBiYWNrIGNhbVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRldikge1xuICAgICAgICAgICAgICBjb25zdHJhaW50cy52aWRlby5kZXZpY2VJZCA9IGZhY2UuZXhhY3QgPyB7ZXhhY3Q6IGRldi5kZXZpY2VJZH0gOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aWRlYWw6IGRldi5kZXZpY2VJZH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdHJhaW50cy52aWRlbyA9IGNvbnN0cmFpbnRzVG9DaHJvbWVfKGNvbnN0cmFpbnRzLnZpZGVvKTtcbiAgICAgICAgICAgIGxvZ2dpbmcoJ2Nocm9tZTogJyArIEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuYyhjb25zdHJhaW50cyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0Nocm9tZV8oY29uc3RyYWludHMudmlkZW8pO1xuICAgIH1cbiAgICBsb2dnaW5nKCdjaHJvbWU6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpO1xuICAgIHJldHVybiBmdW5jKGNvbnN0cmFpbnRzKTtcbiAgfTtcblxuICB2YXIgc2hpbUVycm9yXyA9IGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA+PSA2NCkge1xuICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB7XG4gICAgICAgIFBlcm1pc3Npb25EZW5pZWRFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsXG4gICAgICAgIFBlcm1pc3Npb25EaXNtaXNzZWRFcnJvcjogJ05vdEFsbG93ZWRFcnJvcicsXG4gICAgICAgIEludmFsaWRTdGF0ZUVycm9yOiAnTm90QWxsb3dlZEVycm9yJyxcbiAgICAgICAgRGV2aWNlc05vdEZvdW5kRXJyb3I6ICdOb3RGb3VuZEVycm9yJyxcbiAgICAgICAgQ29uc3RyYWludE5vdFNhdGlzZmllZEVycm9yOiAnT3ZlcmNvbnN0cmFpbmVkRXJyb3InLFxuICAgICAgICBUcmFja1N0YXJ0RXJyb3I6ICdOb3RSZWFkYWJsZUVycm9yJyxcbiAgICAgICAgTWVkaWFEZXZpY2VGYWlsZWREdWVUb1NodXRkb3duOiAnTm90QWxsb3dlZEVycm9yJyxcbiAgICAgICAgTWVkaWFEZXZpY2VLaWxsU3dpdGNoT246ICdOb3RBbGxvd2VkRXJyb3InLFxuICAgICAgICBUYWJDYXB0dXJlRXJyb3I6ICdBYm9ydEVycm9yJyxcbiAgICAgICAgU2NyZWVuQ2FwdHVyZUVycm9yOiAnQWJvcnRFcnJvcicsXG4gICAgICAgIERldmljZUNhcHR1cmVFcnJvcjogJ0Fib3J0RXJyb3InXG4gICAgICB9W2UubmFtZV0gfHwgZS5uYW1lLFxuICAgICAgbWVzc2FnZTogZS5tZXNzYWdlLFxuICAgICAgY29uc3RyYWludDogZS5jb25zdHJhaW50IHx8IGUuY29uc3RyYWludE5hbWUsXG4gICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlO1xuICAgICAgfVxuICAgIH07XG4gIH07XG5cbiAgdmFyIGdldFVzZXJNZWRpYV8gPSBmdW5jdGlvbihjb25zdHJhaW50cywgb25TdWNjZXNzLCBvbkVycm9yKSB7XG4gICAgc2hpbUNvbnN0cmFpbnRzXyhjb25zdHJhaW50cywgZnVuY3Rpb24oYykge1xuICAgICAgbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYShjLCBvblN1Y2Nlc3MsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICBvbkVycm9yKHNoaW1FcnJvcl8oZSkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gZ2V0VXNlck1lZGlhXztcblxuICAvLyBSZXR1cm5zIHRoZSByZXN1bHQgb2YgZ2V0VXNlck1lZGlhIGFzIGEgUHJvbWlzZS5cbiAgdmFyIGdldFVzZXJNZWRpYVByb21pc2VfID0gZnVuY3Rpb24oY29uc3RyYWludHMpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzLCByZXNvbHZlLCByZWplY3QpO1xuICAgIH0pO1xuICB9O1xuXG4gIGlmICghbmF2aWdhdG9yLm1lZGlhRGV2aWNlcykge1xuICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMgPSB7XG4gICAgICBnZXRVc2VyTWVkaWE6IGdldFVzZXJNZWRpYVByb21pc2VfLFxuICAgICAgZW51bWVyYXRlRGV2aWNlczogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICAgICAgdmFyIGtpbmRzID0ge2F1ZGlvOiAnYXVkaW9pbnB1dCcsIHZpZGVvOiAndmlkZW9pbnB1dCd9O1xuICAgICAgICAgIHJldHVybiB3aW5kb3cuTWVkaWFTdHJlYW1UcmFjay5nZXRTb3VyY2VzKGZ1bmN0aW9uKGRldmljZXMpIHtcbiAgICAgICAgICAgIHJlc29sdmUoZGV2aWNlcy5tYXAoZnVuY3Rpb24oZGV2aWNlKSB7XG4gICAgICAgICAgICAgIHJldHVybiB7bGFiZWw6IGRldmljZS5sYWJlbCxcbiAgICAgICAgICAgICAgICBraW5kOiBraW5kc1tkZXZpY2Uua2luZF0sXG4gICAgICAgICAgICAgICAgZGV2aWNlSWQ6IGRldmljZS5pZCxcbiAgICAgICAgICAgICAgICBncm91cElkOiAnJ307XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGdldFN1cHBvcnRlZENvbnN0cmFpbnRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBkZXZpY2VJZDogdHJ1ZSwgZWNob0NhbmNlbGxhdGlvbjogdHJ1ZSwgZmFjaW5nTW9kZTogdHJ1ZSxcbiAgICAgICAgICBmcmFtZVJhdGU6IHRydWUsIGhlaWdodDogdHJ1ZSwgd2lkdGg6IHRydWVcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLy8gQSBzaGltIGZvciBnZXRVc2VyTWVkaWEgbWV0aG9kIG9uIHRoZSBtZWRpYURldmljZXMgb2JqZWN0LlxuICAvLyBUT0RPKEthcHRlbkphbnNzb24pIHJlbW92ZSBvbmNlIGltcGxlbWVudGVkIGluIENocm9tZSBzdGFibGUuXG4gIGlmICghbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEpIHtcbiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7XG4gICAgICByZXR1cm4gZ2V0VXNlck1lZGlhUHJvbWlzZV8oY29uc3RyYWludHMpO1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgLy8gRXZlbiB0aG91Z2ggQ2hyb21lIDQ1IGhhcyBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzIGFuZCBhIGdldFVzZXJNZWRpYVxuICAgIC8vIGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgYSBQcm9taXNlLCBpdCBkb2VzIG5vdCBhY2NlcHQgc3BlYy1zdHlsZVxuICAgIC8vIGNvbnN0cmFpbnRzLlxuICAgIHZhciBvcmlnR2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEuXG4gICAgICAgIGJpbmQobmF2aWdhdG9yLm1lZGlhRGV2aWNlcyk7XG4gICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjcykge1xuICAgICAgcmV0dXJuIHNoaW1Db25zdHJhaW50c18oY3MsIGZ1bmN0aW9uKGMpIHtcbiAgICAgICAgcmV0dXJuIG9yaWdHZXRVc2VyTWVkaWEoYykudGhlbihmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgICAgICBpZiAoYy5hdWRpbyAmJiAhc3RyZWFtLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoIHx8XG4gICAgICAgICAgICAgIGMudmlkZW8gJiYgIXN0cmVhbS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCkge1xuICAgICAgICAgICAgc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHtcbiAgICAgICAgICAgICAgdHJhY2suc3RvcCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRE9NRXhjZXB0aW9uKCcnLCAnTm90Rm91bmRFcnJvcicpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gc3RyZWFtO1xuICAgICAgICB9LCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHNoaW1FcnJvcl8oZSkpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH1cblxuICAvLyBEdW1teSBkZXZpY2VjaGFuZ2UgZXZlbnQgbWV0aG9kcy5cbiAgLy8gVE9ETyhLYXB0ZW5KYW5zc29uKSByZW1vdmUgb25jZSBpbXBsZW1lbnRlZCBpbiBDaHJvbWUgc3RhYmxlLlxuICBpZiAodHlwZW9mIG5hdmlnYXRvci5tZWRpYURldmljZXMuYWRkRXZlbnRMaXN0ZW5lciA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIGxvZ2dpbmcoJ0R1bW15IG1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyIGNhbGxlZC4nKTtcbiAgICB9O1xuICB9XG4gIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykge1xuICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uKCkge1xuICAgICAgbG9nZ2luZygnRHVtbXkgbWVkaWFEZXZpY2VzLnJlbW92ZUV2ZW50TGlzdGVuZXIgY2FsbGVkLicpO1xuICAgIH07XG4gIH1cbn07XG4iLCIvKlxuICogIENvcHlyaWdodCAoYykgMjAxNyBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZVxuICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZVxuICogIHRyZWUuXG4gKi9cbiAvKiBlc2xpbnQtZW52IG5vZGUgKi9cbid1c2Ugc3RyaWN0JztcblxudmFyIFNEUFV0aWxzID0gcmVxdWlyZSgnc2RwJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBzaGltUlRDSWNlQ2FuZGlkYXRlOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICAvLyBmb3VuZGF0aW9uIGlzIGFyYml0cmFyaWx5IGNob3NlbiBhcyBhbiBpbmRpY2F0b3IgZm9yIGZ1bGwgc3VwcG9ydCBmb3JcbiAgICAvLyBodHRwczovL3czYy5naXRodWIuaW8vd2VicnRjLXBjLyNydGNpY2VjYW5kaWRhdGUtaW50ZXJmYWNlXG4gICAgaWYgKCF3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlIHx8ICh3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlICYmICdmb3VuZGF0aW9uJyBpblxuICAgICAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlLnByb3RvdHlwZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgTmF0aXZlUlRDSWNlQ2FuZGlkYXRlID0gd2luZG93LlJUQ0ljZUNhbmRpZGF0ZTtcbiAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oYXJncykge1xuICAgICAgLy8gUmVtb3ZlIHRoZSBhPSB3aGljaCBzaG91bGRuJ3QgYmUgcGFydCBvZiB0aGUgY2FuZGlkYXRlIHN0cmluZy5cbiAgICAgIGlmICh0eXBlb2YgYXJncyA9PT0gJ29iamVjdCcgJiYgYXJncy5jYW5kaWRhdGUgJiZcbiAgICAgICAgICBhcmdzLmNhbmRpZGF0ZS5pbmRleE9mKCdhPScpID09PSAwKSB7XG4gICAgICAgIGFyZ3MgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFyZ3MpKTtcbiAgICAgICAgYXJncy5jYW5kaWRhdGUgPSBhcmdzLmNhbmRpZGF0ZS5zdWJzdHIoMik7XG4gICAgICB9XG5cbiAgICAgIGlmIChhcmdzLmNhbmRpZGF0ZSAmJiBhcmdzLmNhbmRpZGF0ZS5sZW5ndGgpIHtcbiAgICAgICAgLy8gQXVnbWVudCB0aGUgbmF0aXZlIGNhbmRpZGF0ZSB3aXRoIHRoZSBwYXJzZWQgZmllbGRzLlxuICAgICAgICB2YXIgbmF0aXZlQ2FuZGlkYXRlID0gbmV3IE5hdGl2ZVJUQ0ljZUNhbmRpZGF0ZShhcmdzKTtcbiAgICAgICAgdmFyIHBhcnNlZENhbmRpZGF0ZSA9IFNEUFV0aWxzLnBhcnNlQ2FuZGlkYXRlKGFyZ3MuY2FuZGlkYXRlKTtcbiAgICAgICAgdmFyIGF1Z21lbnRlZENhbmRpZGF0ZSA9IE9iamVjdC5hc3NpZ24obmF0aXZlQ2FuZGlkYXRlLFxuICAgICAgICAgICAgcGFyc2VkQ2FuZGlkYXRlKTtcblxuICAgICAgICAvLyBBZGQgYSBzZXJpYWxpemVyIHRoYXQgZG9lcyBub3Qgc2VyaWFsaXplIHRoZSBleHRyYSBhdHRyaWJ1dGVzLlxuICAgICAgICBhdWdtZW50ZWRDYW5kaWRhdGUudG9KU09OID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNhbmRpZGF0ZTogYXVnbWVudGVkQ2FuZGlkYXRlLmNhbmRpZGF0ZSxcbiAgICAgICAgICAgIHNkcE1pZDogYXVnbWVudGVkQ2FuZGlkYXRlLnNkcE1pZCxcbiAgICAgICAgICAgIHNkcE1MaW5lSW5kZXg6IGF1Z21lbnRlZENhbmRpZGF0ZS5zZHBNTGluZUluZGV4LFxuICAgICAgICAgICAgdXNlcm5hbWVGcmFnbWVudDogYXVnbWVudGVkQ2FuZGlkYXRlLnVzZXJuYW1lRnJhZ21lbnQsXG4gICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGF1Z21lbnRlZENhbmRpZGF0ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuZXcgTmF0aXZlUlRDSWNlQ2FuZGlkYXRlKGFyZ3MpO1xuICAgIH07XG4gICAgd2luZG93LlJUQ0ljZUNhbmRpZGF0ZS5wcm90b3R5cGUgPSBOYXRpdmVSVENJY2VDYW5kaWRhdGUucHJvdG90eXBlO1xuXG4gICAgLy8gSG9vayB1cCB0aGUgYXVnbWVudGVkIGNhbmRpZGF0ZSBpbiBvbmljZWNhbmRpZGF0ZSBhbmRcbiAgICAvLyBhZGRFdmVudExpc3RlbmVyKCdpY2VjYW5kaWRhdGUnLCAuLi4pXG4gICAgdXRpbHMud3JhcFBlZXJDb25uZWN0aW9uRXZlbnQod2luZG93LCAnaWNlY2FuZGlkYXRlJywgZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKGUuY2FuZGlkYXRlKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCAnY2FuZGlkYXRlJywge1xuICAgICAgICAgIHZhbHVlOiBuZXcgd2luZG93LlJUQ0ljZUNhbmRpZGF0ZShlLmNhbmRpZGF0ZSksXG4gICAgICAgICAgd3JpdGFibGU6ICdmYWxzZSdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZTtcbiAgICB9KTtcbiAgfSxcblxuICAvLyBzaGltQ3JlYXRlT2JqZWN0VVJMIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBzaGltU291cmNlT2JqZWN0IHRvIGF2b2lkIGxvb3AuXG5cbiAgc2hpbUNyZWF0ZU9iamVjdFVSTDogZnVuY3Rpb24od2luZG93KSB7XG4gICAgdmFyIFVSTCA9IHdpbmRvdyAmJiB3aW5kb3cuVVJMO1xuXG4gICAgaWYgKCEodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiZcbiAgICAgICAgICAnc3JjT2JqZWN0JyBpbiB3aW5kb3cuSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUgJiZcbiAgICAgICAgVVJMLmNyZWF0ZU9iamVjdFVSTCAmJiBVUkwucmV2b2tlT2JqZWN0VVJMKSkge1xuICAgICAgLy8gT25seSBzaGltIENyZWF0ZU9iamVjdFVSTCB1c2luZyBzcmNPYmplY3QgaWYgc3JjT2JqZWN0IGV4aXN0cy5cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgdmFyIG5hdGl2ZUNyZWF0ZU9iamVjdFVSTCA9IFVSTC5jcmVhdGVPYmplY3RVUkwuYmluZChVUkwpO1xuICAgIHZhciBuYXRpdmVSZXZva2VPYmplY3RVUkwgPSBVUkwucmV2b2tlT2JqZWN0VVJMLmJpbmQoVVJMKTtcbiAgICB2YXIgc3RyZWFtcyA9IG5ldyBNYXAoKSwgbmV3SWQgPSAwO1xuXG4gICAgVVJMLmNyZWF0ZU9iamVjdFVSTCA9IGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgaWYgKCdnZXRUcmFja3MnIGluIHN0cmVhbSkge1xuICAgICAgICB2YXIgdXJsID0gJ3BvbHlibG9iOicgKyAoKytuZXdJZCk7XG4gICAgICAgIHN0cmVhbXMuc2V0KHVybCwgc3RyZWFtKTtcbiAgICAgICAgdXRpbHMuZGVwcmVjYXRlZCgnVVJMLmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pJyxcbiAgICAgICAgICAgICdlbGVtLnNyY09iamVjdCA9IHN0cmVhbScpO1xuICAgICAgICByZXR1cm4gdXJsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5hdGl2ZUNyZWF0ZU9iamVjdFVSTChzdHJlYW0pO1xuICAgIH07XG4gICAgVVJMLnJldm9rZU9iamVjdFVSTCA9IGZ1bmN0aW9uKHVybCkge1xuICAgICAgbmF0aXZlUmV2b2tlT2JqZWN0VVJMKHVybCk7XG4gICAgICBzdHJlYW1zLmRlbGV0ZSh1cmwpO1xuICAgIH07XG5cbiAgICB2YXIgZHNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih3aW5kb3cuSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NyYycpO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUsICdzcmMnLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gZHNjLmdldC5hcHBseSh0aGlzKTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uKHVybCkge1xuICAgICAgICB0aGlzLnNyY09iamVjdCA9IHN0cmVhbXMuZ2V0KHVybCkgfHwgbnVsbDtcbiAgICAgICAgcmV0dXJuIGRzYy5zZXQuYXBwbHkodGhpcywgW3VybF0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdmFyIG5hdGl2ZVNldEF0dHJpYnV0ZSA9IHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZS5zZXRBdHRyaWJ1dGU7XG4gICAgd2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLnNldEF0dHJpYnV0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIgJiZcbiAgICAgICAgICAoJycgKyBhcmd1bWVudHNbMF0pLnRvTG93ZXJDYXNlKCkgPT09ICdzcmMnKSB7XG4gICAgICAgIHRoaXMuc3JjT2JqZWN0ID0gc3RyZWFtcy5nZXQoYXJndW1lbnRzWzFdKSB8fCBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5hdGl2ZVNldEF0dHJpYnV0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH07XG4gIH0sXG5cbiAgc2hpbU1heE1lc3NhZ2VTaXplOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICBpZiAod2luZG93LlJUQ1NjdHBUcmFuc3BvcnQgfHwgIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgYnJvd3NlckRldGFpbHMgPSB1dGlscy5kZXRlY3RCcm93c2VyKHdpbmRvdyk7XG5cbiAgICBpZiAoISgnc2N0cCcgaW4gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLCAnc2N0cCcsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdHlwZW9mIHRoaXMuX3NjdHAgPT09ICd1bmRlZmluZWQnID8gbnVsbCA6IHRoaXMuX3NjdHA7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHZhciBzY3RwSW5EZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKGRlc2NyaXB0aW9uKSB7XG4gICAgICB2YXIgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKGRlc2NyaXB0aW9uLnNkcCk7XG4gICAgICBzZWN0aW9ucy5zaGlmdCgpO1xuICAgICAgcmV0dXJuIHNlY3Rpb25zLnNvbWUoZnVuY3Rpb24obWVkaWFTZWN0aW9uKSB7XG4gICAgICAgIHZhciBtTGluZSA9IFNEUFV0aWxzLnBhcnNlTUxpbmUobWVkaWFTZWN0aW9uKTtcbiAgICAgICAgcmV0dXJuIG1MaW5lICYmIG1MaW5lLmtpbmQgPT09ICdhcHBsaWNhdGlvbidcbiAgICAgICAgICAgICYmIG1MaW5lLnByb3RvY29sLmluZGV4T2YoJ1NDVFAnKSAhPT0gLTE7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdmFyIGdldFJlbW90ZUZpcmVmb3hWZXJzaW9uID0gZnVuY3Rpb24oZGVzY3JpcHRpb24pIHtcbiAgICAgIC8vIFRPRE86IElzIHRoZXJlIGEgYmV0dGVyIHNvbHV0aW9uIGZvciBkZXRlY3RpbmcgRmlyZWZveD9cbiAgICAgIHZhciBtYXRjaCA9IGRlc2NyaXB0aW9uLnNkcC5tYXRjaCgvbW96aWxsYS4uLlRISVNfSVNfU0RQQVJUQS0oXFxkKykvKTtcbiAgICAgIGlmIChtYXRjaCA9PT0gbnVsbCB8fCBtYXRjaC5sZW5ndGggPCAyKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICAgIH1cbiAgICAgIHZhciB2ZXJzaW9uID0gcGFyc2VJbnQobWF0Y2hbMV0sIDEwKTtcbiAgICAgIC8vIFRlc3QgZm9yIE5hTiAoeWVzLCB0aGlzIGlzIHVnbHkpXG4gICAgICByZXR1cm4gdmVyc2lvbiAhPT0gdmVyc2lvbiA/IC0xIDogdmVyc2lvbjtcbiAgICB9O1xuXG4gICAgdmFyIGdldENhblNlbmRNYXhNZXNzYWdlU2l6ZSA9IGZ1bmN0aW9uKHJlbW90ZUlzRmlyZWZveCkge1xuICAgICAgLy8gRXZlcnkgaW1wbGVtZW50YXRpb24gd2Uga25vdyBjYW4gc2VuZCBhdCBsZWFzdCA2NCBLaUIuXG4gICAgICAvLyBOb3RlOiBBbHRob3VnaCBDaHJvbWUgaXMgdGVjaG5pY2FsbHkgYWJsZSB0byBzZW5kIHVwIHRvIDI1NiBLaUIsIHRoZVxuICAgICAgLy8gICAgICAgZGF0YSBkb2VzIG5vdCByZWFjaCB0aGUgb3RoZXIgcGVlciByZWxpYWJseS5cbiAgICAgIC8vICAgICAgIFNlZTogaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL3dlYnJ0Yy9pc3N1ZXMvZGV0YWlsP2lkPTg0MTlcbiAgICAgIHZhciBjYW5TZW5kTWF4TWVzc2FnZVNpemUgPSA2NTUzNjtcbiAgICAgIGlmIChicm93c2VyRGV0YWlscy5icm93c2VyID09PSAnZmlyZWZveCcpIHtcbiAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA1Nykge1xuICAgICAgICAgIGlmIChyZW1vdGVJc0ZpcmVmb3ggPT09IC0xKSB7XG4gICAgICAgICAgICAvLyBGRiA8IDU3IHdpbGwgc2VuZCBpbiAxNiBLaUIgY2h1bmtzIHVzaW5nIHRoZSBkZXByZWNhdGVkIFBQSURcbiAgICAgICAgICAgIC8vIGZyYWdtZW50YXRpb24uXG4gICAgICAgICAgICBjYW5TZW5kTWF4TWVzc2FnZVNpemUgPSAxNjM4NDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSG93ZXZlciwgb3RoZXIgRkYgKGFuZCBSQVdSVEMpIGNhbiByZWFzc2VtYmxlIFBQSUQtZnJhZ21lbnRlZFxuICAgICAgICAgICAgLy8gbWVzc2FnZXMuIFRodXMsIHN1cHBvcnRpbmcgfjIgR2lCIHdoZW4gc2VuZGluZy5cbiAgICAgICAgICAgIGNhblNlbmRNYXhNZXNzYWdlU2l6ZSA9IDIxNDc0ODM2Mzc7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA2MCkge1xuICAgICAgICAgIC8vIEN1cnJlbnRseSwgYWxsIEZGID49IDU3IHdpbGwgcmVzZXQgdGhlIHJlbW90ZSBtYXhpbXVtIG1lc3NhZ2Ugc2l6ZVxuICAgICAgICAgIC8vIHRvIHRoZSBkZWZhdWx0IHZhbHVlIHdoZW4gYSBkYXRhIGNoYW5uZWwgaXMgY3JlYXRlZCBhdCBhIGxhdGVyXG4gICAgICAgICAgLy8gc3RhZ2UuIDooXG4gICAgICAgICAgLy8gU2VlOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD0xNDI2ODMxXG4gICAgICAgICAgY2FuU2VuZE1heE1lc3NhZ2VTaXplID1cbiAgICAgICAgICAgIGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPT09IDU3ID8gNjU1MzUgOiA2NTUzNjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBGRiA+PSA2MCBzdXBwb3J0cyBzZW5kaW5nIH4yIEdpQlxuICAgICAgICAgIGNhblNlbmRNYXhNZXNzYWdlU2l6ZSA9IDIxNDc0ODM2Mzc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBjYW5TZW5kTWF4TWVzc2FnZVNpemU7XG4gICAgfTtcblxuICAgIHZhciBnZXRNYXhNZXNzYWdlU2l6ZSA9IGZ1bmN0aW9uKGRlc2NyaXB0aW9uLCByZW1vdGVJc0ZpcmVmb3gpIHtcbiAgICAgIC8vIE5vdGU6IDY1NTM2IGJ5dGVzIGlzIHRoZSBkZWZhdWx0IHZhbHVlIGZyb20gdGhlIFNEUCBzcGVjLiBBbHNvLFxuICAgICAgLy8gICAgICAgZXZlcnkgaW1wbGVtZW50YXRpb24gd2Uga25vdyBzdXBwb3J0cyByZWNlaXZpbmcgNjU1MzYgYnl0ZXMuXG4gICAgICB2YXIgbWF4TWVzc2FnZVNpemUgPSA2NTUzNjtcblxuICAgICAgLy8gRkYgNTcgaGFzIGEgc2xpZ2h0bHkgaW5jb3JyZWN0IGRlZmF1bHQgcmVtb3RlIG1heCBtZXNzYWdlIHNpemUsIHNvXG4gICAgICAvLyB3ZSBuZWVkIHRvIGFkanVzdCBpdCBoZXJlIHRvIGF2b2lkIGEgZmFpbHVyZSB3aGVuIHNlbmRpbmcuXG4gICAgICAvLyBTZWU6IGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTE0MjU2OTdcbiAgICAgIGlmIChicm93c2VyRGV0YWlscy5icm93c2VyID09PSAnZmlyZWZveCdcbiAgICAgICAgICAgJiYgYnJvd3NlckRldGFpbHMudmVyc2lvbiA9PT0gNTcpIHtcbiAgICAgICAgbWF4TWVzc2FnZVNpemUgPSA2NTUzNTtcbiAgICAgIH1cblxuICAgICAgdmFyIG1hdGNoID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgoZGVzY3JpcHRpb24uc2RwLCAnYT1tYXgtbWVzc2FnZS1zaXplOicpO1xuICAgICAgaWYgKG1hdGNoLmxlbmd0aCA+IDApIHtcbiAgICAgICAgbWF4TWVzc2FnZVNpemUgPSBwYXJzZUludChtYXRjaFswXS5zdWJzdHIoMTkpLCAxMCk7XG4gICAgICB9IGVsc2UgaWYgKGJyb3dzZXJEZXRhaWxzLmJyb3dzZXIgPT09ICdmaXJlZm94JyAmJlxuICAgICAgICAgICAgICAgICAgcmVtb3RlSXNGaXJlZm94ICE9PSAtMSkge1xuICAgICAgICAvLyBJZiB0aGUgbWF4aW11bSBtZXNzYWdlIHNpemUgaXMgbm90IHByZXNlbnQgaW4gdGhlIHJlbW90ZSBTRFAgYW5kXG4gICAgICAgIC8vIGJvdGggbG9jYWwgYW5kIHJlbW90ZSBhcmUgRmlyZWZveCwgdGhlIHJlbW90ZSBwZWVyIGNhbiByZWNlaXZlXG4gICAgICAgIC8vIH4yIEdpQi5cbiAgICAgICAgbWF4TWVzc2FnZVNpemUgPSAyMTQ3NDgzNjM3O1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1heE1lc3NhZ2VTaXplO1xuICAgIH07XG5cbiAgICB2YXIgb3JpZ1NldFJlbW90ZURlc2NyaXB0aW9uID1cbiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXRSZW1vdGVEZXNjcmlwdGlvbjtcbiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldFJlbW90ZURlc2NyaXB0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgcGMuX3NjdHAgPSBudWxsO1xuXG4gICAgICBpZiAoc2N0cEluRGVzY3JpcHRpb24oYXJndW1lbnRzWzBdKSkge1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgcmVtb3RlIGlzIEZGLlxuICAgICAgICB2YXIgaXNGaXJlZm94ID0gZ2V0UmVtb3RlRmlyZWZveFZlcnNpb24oYXJndW1lbnRzWzBdKTtcblxuICAgICAgICAvLyBHZXQgdGhlIG1heGltdW0gbWVzc2FnZSBzaXplIHRoZSBsb2NhbCBwZWVyIGlzIGNhcGFibGUgb2Ygc2VuZGluZ1xuICAgICAgICB2YXIgY2FuU2VuZE1NUyA9IGdldENhblNlbmRNYXhNZXNzYWdlU2l6ZShpc0ZpcmVmb3gpO1xuXG4gICAgICAgIC8vIEdldCB0aGUgbWF4aW11bSBtZXNzYWdlIHNpemUgb2YgdGhlIHJlbW90ZSBwZWVyLlxuICAgICAgICB2YXIgcmVtb3RlTU1TID0gZ2V0TWF4TWVzc2FnZVNpemUoYXJndW1lbnRzWzBdLCBpc0ZpcmVmb3gpO1xuXG4gICAgICAgIC8vIERldGVybWluZSBmaW5hbCBtYXhpbXVtIG1lc3NhZ2Ugc2l6ZVxuICAgICAgICB2YXIgbWF4TWVzc2FnZVNpemU7XG4gICAgICAgIGlmIChjYW5TZW5kTU1TID09PSAwICYmIHJlbW90ZU1NUyA9PT0gMCkge1xuICAgICAgICAgIG1heE1lc3NhZ2VTaXplID0gTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZO1xuICAgICAgICB9IGVsc2UgaWYgKGNhblNlbmRNTVMgPT09IDAgfHwgcmVtb3RlTU1TID09PSAwKSB7XG4gICAgICAgICAgbWF4TWVzc2FnZVNpemUgPSBNYXRoLm1heChjYW5TZW5kTU1TLCByZW1vdGVNTVMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1heE1lc3NhZ2VTaXplID0gTWF0aC5taW4oY2FuU2VuZE1NUywgcmVtb3RlTU1TKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENyZWF0ZSBhIGR1bW15IFJUQ1NjdHBUcmFuc3BvcnQgb2JqZWN0IGFuZCB0aGUgJ21heE1lc3NhZ2VTaXplJ1xuICAgICAgICAvLyBhdHRyaWJ1dGUuXG4gICAgICAgIHZhciBzY3RwID0ge307XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzY3RwLCAnbWF4TWVzc2FnZVNpemUnLCB7XG4gICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBtYXhNZXNzYWdlU2l6ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBwYy5fc2N0cCA9IHNjdHA7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBvcmlnU2V0UmVtb3RlRGVzY3JpcHRpb24uYXBwbHkocGMsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfSxcblxuICBzaGltU2VuZFRocm93VHlwZUVycm9yOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICBpZiAoISh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gJiZcbiAgICAgICAgJ2NyZWF0ZURhdGFDaGFubmVsJyBpbiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIE5vdGU6IEFsdGhvdWdoIEZpcmVmb3ggPj0gNTcgaGFzIGEgbmF0aXZlIGltcGxlbWVudGF0aW9uLCB0aGUgbWF4aW11bVxuICAgIC8vICAgICAgIG1lc3NhZ2Ugc2l6ZSBjYW4gYmUgcmVzZXQgZm9yIGFsbCBkYXRhIGNoYW5uZWxzIGF0IGEgbGF0ZXIgc3RhZ2UuXG4gICAgLy8gICAgICAgU2VlOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD0xNDI2ODMxXG5cbiAgICBmdW5jdGlvbiB3cmFwRGNTZW5kKGRjLCBwYykge1xuICAgICAgdmFyIG9yaWdEYXRhQ2hhbm5lbFNlbmQgPSBkYy5zZW5kO1xuICAgICAgZGMuc2VuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZGF0YSA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgdmFyIGxlbmd0aCA9IGRhdGEubGVuZ3RoIHx8IGRhdGEuc2l6ZSB8fCBkYXRhLmJ5dGVMZW5ndGg7XG4gICAgICAgIGlmIChkYy5yZWFkeVN0YXRlID09PSAnb3BlbicgJiZcbiAgICAgICAgICAgIHBjLnNjdHAgJiYgbGVuZ3RoID4gcGMuc2N0cC5tYXhNZXNzYWdlU2l6ZSkge1xuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ01lc3NhZ2UgdG9vIGxhcmdlIChjYW4gc2VuZCBhIG1heGltdW0gb2YgJyArXG4gICAgICAgICAgICBwYy5zY3RwLm1heE1lc3NhZ2VTaXplICsgJyBieXRlcyknKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3JpZ0RhdGFDaGFubmVsU2VuZC5hcHBseShkYywgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfVxuICAgIHZhciBvcmlnQ3JlYXRlRGF0YUNoYW5uZWwgPVxuICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVEYXRhQ2hhbm5lbDtcbiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmNyZWF0ZURhdGFDaGFubmVsID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgdmFyIGRhdGFDaGFubmVsID0gb3JpZ0NyZWF0ZURhdGFDaGFubmVsLmFwcGx5KHBjLCBhcmd1bWVudHMpO1xuICAgICAgd3JhcERjU2VuZChkYXRhQ2hhbm5lbCwgcGMpO1xuICAgICAgcmV0dXJuIGRhdGFDaGFubmVsO1xuICAgIH07XG4gICAgdXRpbHMud3JhcFBlZXJDb25uZWN0aW9uRXZlbnQod2luZG93LCAnZGF0YWNoYW5uZWwnLCBmdW5jdGlvbihlKSB7XG4gICAgICB3cmFwRGNTZW5kKGUuY2hhbm5lbCwgZS50YXJnZXQpO1xuICAgICAgcmV0dXJuIGU7XG4gICAgfSk7XG4gIH1cbn07XG4iLCIvKlxuICogIENvcHlyaWdodCAoYykgMjAxNiBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZVxuICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZVxuICogIHRyZWUuXG4gKi9cbiAvKiBlc2xpbnQtZW52IG5vZGUgKi9cbid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKTtcbnZhciBmaWx0ZXJJY2VTZXJ2ZXJzID0gcmVxdWlyZSgnLi9maWx0ZXJpY2VzZXJ2ZXJzJyk7XG52YXIgc2hpbVJUQ1BlZXJDb25uZWN0aW9uID0gcmVxdWlyZSgncnRjcGVlcmNvbm5lY3Rpb24tc2hpbScpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgc2hpbUdldFVzZXJNZWRpYTogcmVxdWlyZSgnLi9nZXR1c2VybWVkaWEnKSxcbiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICB2YXIgYnJvd3NlckRldGFpbHMgPSB1dGlscy5kZXRlY3RCcm93c2VyKHdpbmRvdyk7XG5cbiAgICBpZiAod2luZG93LlJUQ0ljZUdhdGhlcmVyKSB7XG4gICAgICBpZiAoIXdpbmRvdy5SVENJY2VDYW5kaWRhdGUpIHtcbiAgICAgICAgd2luZG93LlJUQ0ljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgICAgICByZXR1cm4gYXJncztcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGlmICghd2luZG93LlJUQ1Nlc3Npb25EZXNjcmlwdGlvbikge1xuICAgICAgICB3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uID0gZnVuY3Rpb24oYXJncykge1xuICAgICAgICAgIHJldHVybiBhcmdzO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgLy8gdGhpcyBhZGRzIGFuIGFkZGl0aW9uYWwgZXZlbnQgbGlzdGVuZXIgdG8gTWVkaWFTdHJhY2tUcmFjayB0aGF0IHNpZ25hbHNcbiAgICAgIC8vIHdoZW4gYSB0cmFja3MgZW5hYmxlZCBwcm9wZXJ0eSB3YXMgY2hhbmdlZC4gV29ya2Fyb3VuZCBmb3IgYSBidWcgaW5cbiAgICAgIC8vIGFkZFN0cmVhbSwgc2VlIGJlbG93LiBObyBsb25nZXIgcmVxdWlyZWQgaW4gMTUwMjUrXG4gICAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDE1MDI1KSB7XG4gICAgICAgIHZhciBvcmlnTVNURW5hYmxlZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoXG4gICAgICAgICAgICB3aW5kb3cuTWVkaWFTdHJlYW1UcmFjay5wcm90b3R5cGUsICdlbmFibGVkJyk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuTWVkaWFTdHJlYW1UcmFjay5wcm90b3R5cGUsICdlbmFibGVkJywge1xuICAgICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIG9yaWdNU1RFbmFibGVkLnNldC5jYWxsKHRoaXMsIHZhbHVlKTtcbiAgICAgICAgICAgIHZhciBldiA9IG5ldyBFdmVudCgnZW5hYmxlZCcpO1xuICAgICAgICAgICAgZXYuZW5hYmxlZCA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE9SVEMgZGVmaW5lcyB0aGUgRFRNRiBzZW5kZXIgYSBiaXQgZGlmZmVyZW50LlxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS93M2Mvb3J0Yy9pc3N1ZXMvNzE0XG4gICAgaWYgKHdpbmRvdy5SVENSdHBTZW5kZXIgJiYgISgnZHRtZicgaW4gd2luZG93LlJUQ1J0cFNlbmRlci5wcm90b3R5cGUpKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LlJUQ1J0cFNlbmRlci5wcm90b3R5cGUsICdkdG1mJywge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmICh0aGlzLl9kdG1mID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRyYWNrLmtpbmQgPT09ICdhdWRpbycpIHtcbiAgICAgICAgICAgICAgdGhpcy5fZHRtZiA9IG5ldyB3aW5kb3cuUlRDRHRtZlNlbmRlcih0aGlzKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy50cmFjay5raW5kID09PSAndmlkZW8nKSB7XG4gICAgICAgICAgICAgIHRoaXMuX2R0bWYgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGhpcy5fZHRtZjtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIC8vIEVkZ2UgY3VycmVudGx5IG9ubHkgaW1wbGVtZW50cyB0aGUgUlRDRHRtZlNlbmRlciwgbm90IHRoZVxuICAgIC8vIFJUQ0RUTUZTZW5kZXIgYWxpYXMuIFNlZSBodHRwOi8vZHJhZnQub3J0Yy5vcmcvI3J0Y2R0bWZzZW5kZXIyKlxuICAgIGlmICh3aW5kb3cuUlRDRHRtZlNlbmRlciAmJiAhd2luZG93LlJUQ0RUTUZTZW5kZXIpIHtcbiAgICAgIHdpbmRvdy5SVENEVE1GU2VuZGVyID0gd2luZG93LlJUQ0R0bWZTZW5kZXI7XG4gICAgfVxuXG4gICAgdmFyIFJUQ1BlZXJDb25uZWN0aW9uU2hpbSA9IHNoaW1SVENQZWVyQ29ubmVjdGlvbih3aW5kb3csXG4gICAgICAgIGJyb3dzZXJEZXRhaWxzLnZlcnNpb24pO1xuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiA9IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAgaWYgKGNvbmZpZyAmJiBjb25maWcuaWNlU2VydmVycykge1xuICAgICAgICBjb25maWcuaWNlU2VydmVycyA9IGZpbHRlckljZVNlcnZlcnMoY29uZmlnLmljZVNlcnZlcnMpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5ldyBSVENQZWVyQ29ubmVjdGlvblNoaW0oY29uZmlnKTtcbiAgICB9O1xuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPSBSVENQZWVyQ29ubmVjdGlvblNoaW0ucHJvdG90eXBlO1xuICB9LFxuICBzaGltUmVwbGFjZVRyYWNrOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICAvLyBPUlRDIGhhcyByZXBsYWNlVHJhY2sgLS0gaHR0cHM6Ly9naXRodWIuY29tL3czYy9vcnRjL2lzc3Vlcy82MTRcbiAgICBpZiAod2luZG93LlJUQ1J0cFNlbmRlciAmJlxuICAgICAgICAhKCdyZXBsYWNlVHJhY2snIGluIHdpbmRvdy5SVENSdHBTZW5kZXIucHJvdG90eXBlKSkge1xuICAgICAgd2luZG93LlJUQ1J0cFNlbmRlci5wcm90b3R5cGUucmVwbGFjZVRyYWNrID1cbiAgICAgICAgICB3aW5kb3cuUlRDUnRwU2VuZGVyLnByb3RvdHlwZS5zZXRUcmFjaztcbiAgICB9XG4gIH0sXG4gIHNoaW1HZXREaXNwbGF5TWVkaWE6IGZ1bmN0aW9uKHdpbmRvdywgcHJlZmVycmVkTWVkaWFTb3VyY2UpIHtcbiAgICBpZiAoISgnZ2V0RGlzcGxheU1lZGlhJyBpbiB3aW5kb3cubmF2aWdhdG9yKSB8fFxuICAgICAgICAhd2luZG93Lm5hdmlnYXRvci5tZWRpYURldmljZXMgfHxcbiAgICAgICAgJ2dldERpc3BsYXlNZWRpYScgaW4gd2luZG93Lm5hdmlnYXRvci5tZWRpYURldmljZXMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIG9yaWdHZXREaXNwbGF5TWVkaWEgPSB3aW5kb3cubmF2aWdhdG9yLmdldERpc3BsYXlNZWRpYTtcbiAgICB3aW5kb3cubmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXREaXNwbGF5TWVkaWEgPSBmdW5jdGlvbihjb25zdHJhaW50cykge1xuICAgICAgcmV0dXJuIG9yaWdHZXREaXNwbGF5TWVkaWEuY2FsbCh3aW5kb3cubmF2aWdhdG9yLCBjb25zdHJhaW50cyk7XG4gICAgfTtcbiAgICB3aW5kb3cubmF2aWdhdG9yLmdldERpc3BsYXlNZWRpYSA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7XG4gICAgICB1dGlscy5kZXByZWNhdGVkKCduYXZpZ2F0b3IuZ2V0RGlzcGxheU1lZGlhJyxcbiAgICAgICAgICAnbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXREaXNwbGF5TWVkaWEnKTtcbiAgICAgIHJldHVybiBvcmlnR2V0RGlzcGxheU1lZGlhLmNhbGwod2luZG93Lm5hdmlnYXRvciwgY29uc3RyYWludHMpO1xuICAgIH07XG4gIH1cbn07XG4iLCIvKlxuICogIENvcHlyaWdodCAoYykgMjAxOCBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZVxuICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZVxuICogIHRyZWUuXG4gKi9cbiAvKiBlc2xpbnQtZW52IG5vZGUgKi9cbid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKTtcbi8vIEVkZ2UgZG9lcyBub3QgbGlrZVxuLy8gMSkgc3R1bjogZmlsdGVyZWQgYWZ0ZXIgMTQzOTMgdW5sZXNzID90cmFuc3BvcnQ9dWRwIGlzIHByZXNlbnRcbi8vIDIpIHR1cm46IHRoYXQgZG9lcyBub3QgaGF2ZSBhbGwgb2YgdHVybjpob3N0OnBvcnQ/dHJhbnNwb3J0PXVkcFxuLy8gMykgdHVybjogd2l0aCBpcHY2IGFkZHJlc3Nlc1xuLy8gNCkgdHVybjogb2NjdXJyaW5nIG11bGlwbGUgdGltZXNcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaWNlU2VydmVycywgZWRnZVZlcnNpb24pIHtcbiAgdmFyIGhhc1R1cm4gPSBmYWxzZTtcbiAgaWNlU2VydmVycyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoaWNlU2VydmVycykpO1xuICByZXR1cm4gaWNlU2VydmVycy5maWx0ZXIoZnVuY3Rpb24oc2VydmVyKSB7XG4gICAgaWYgKHNlcnZlciAmJiAoc2VydmVyLnVybHMgfHwgc2VydmVyLnVybCkpIHtcbiAgICAgIHZhciB1cmxzID0gc2VydmVyLnVybHMgfHwgc2VydmVyLnVybDtcbiAgICAgIGlmIChzZXJ2ZXIudXJsICYmICFzZXJ2ZXIudXJscykge1xuICAgICAgICB1dGlscy5kZXByZWNhdGVkKCdSVENJY2VTZXJ2ZXIudXJsJywgJ1JUQ0ljZVNlcnZlci51cmxzJyk7XG4gICAgICB9XG4gICAgICB2YXIgaXNTdHJpbmcgPSB0eXBlb2YgdXJscyA9PT0gJ3N0cmluZyc7XG4gICAgICBpZiAoaXNTdHJpbmcpIHtcbiAgICAgICAgdXJscyA9IFt1cmxzXTtcbiAgICAgIH1cbiAgICAgIHVybHMgPSB1cmxzLmZpbHRlcihmdW5jdGlvbih1cmwpIHtcbiAgICAgICAgdmFyIHZhbGlkVHVybiA9IHVybC5pbmRleE9mKCd0dXJuOicpID09PSAwICYmXG4gICAgICAgICAgICB1cmwuaW5kZXhPZigndHJhbnNwb3J0PXVkcCcpICE9PSAtMSAmJlxuICAgICAgICAgICAgdXJsLmluZGV4T2YoJ3R1cm46WycpID09PSAtMSAmJlxuICAgICAgICAgICAgIWhhc1R1cm47XG5cbiAgICAgICAgaWYgKHZhbGlkVHVybikge1xuICAgICAgICAgIGhhc1R1cm4gPSB0cnVlO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1cmwuaW5kZXhPZignc3R1bjonKSA9PT0gMCAmJiBlZGdlVmVyc2lvbiA+PSAxNDM5MyAmJlxuICAgICAgICAgICAgdXJsLmluZGV4T2YoJz90cmFuc3BvcnQ9dWRwJykgPT09IC0xO1xuICAgICAgfSk7XG5cbiAgICAgIGRlbGV0ZSBzZXJ2ZXIudXJsO1xuICAgICAgc2VydmVyLnVybHMgPSBpc1N0cmluZyA/IHVybHNbMF0gOiB1cmxzO1xuICAgICAgcmV0dXJuICEhdXJscy5sZW5ndGg7XG4gICAgfVxuICB9KTtcbn07XG4iLCIvKlxuICogIENvcHlyaWdodCAoYykgMjAxNiBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZVxuICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZVxuICogIHRyZWUuXG4gKi9cbiAvKiBlc2xpbnQtZW52IG5vZGUgKi9cbid1c2Ugc3RyaWN0JztcblxuLy8gRXhwb3NlIHB1YmxpYyBtZXRob2RzLlxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih3aW5kb3cpIHtcbiAgdmFyIG5hdmlnYXRvciA9IHdpbmRvdyAmJiB3aW5kb3cubmF2aWdhdG9yO1xuXG4gIHZhciBzaGltRXJyb3JfID0gZnVuY3Rpb24oZSkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB7UGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJ31bZS5uYW1lXSB8fCBlLm5hbWUsXG4gICAgICBtZXNzYWdlOiBlLm1lc3NhZ2UsXG4gICAgICBjb25zdHJhaW50OiBlLmNvbnN0cmFpbnQsXG4gICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hbWU7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcblxuICAvLyBnZXRVc2VyTWVkaWEgZXJyb3Igc2hpbS5cbiAgdmFyIG9yaWdHZXRVc2VyTWVkaWEgPSBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYS5cbiAgICAgIGJpbmQobmF2aWdhdG9yLm1lZGlhRGV2aWNlcyk7XG4gIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oYykge1xuICAgIHJldHVybiBvcmlnR2V0VXNlck1lZGlhKGMpLmNhdGNoKGZ1bmN0aW9uKGUpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTtcbiAgICB9KTtcbiAgfTtcbn07XG4iLCIvKlxuICogIENvcHlyaWdodCAoYykgMjAxNiBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZVxuICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZVxuICogIHRyZWUuXG4gKi9cbiAvKiBlc2xpbnQtZW52IG5vZGUgKi9cbid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHNoaW1HZXRVc2VyTWVkaWE6IHJlcXVpcmUoJy4vZ2V0dXNlcm1lZGlhJyksXG4gIHNoaW1PblRyYWNrOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmICEoJ29udHJhY2snIGluXG4gICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSwgJ29udHJhY2snLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX29udHJhY2s7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24oZikge1xuICAgICAgICAgIGlmICh0aGlzLl9vbnRyYWNrKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RyYWNrJywgdGhpcy5fb250cmFjayk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCd0cmFjaycsIHRoaXMuX29udHJhY2sgPSBmKTtcbiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29udHJhY2twb2x5ID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgZS5zdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykge1xuICAgICAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ3RyYWNrJyk7XG4gICAgICAgICAgICAgIGV2ZW50LnRyYWNrID0gdHJhY2s7XG4gICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0ge3RyYWNrOiB0cmFja307XG4gICAgICAgICAgICAgIGV2ZW50LnRyYW5zY2VpdmVyID0ge3JlY2VpdmVyOiBldmVudC5yZWNlaXZlcn07XG4gICAgICAgICAgICAgIGV2ZW50LnN0cmVhbXMgPSBbZS5zdHJlYW1dO1xuICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1RyYWNrRXZlbnQgJiZcbiAgICAgICAgKCdyZWNlaXZlcicgaW4gd2luZG93LlJUQ1RyYWNrRXZlbnQucHJvdG90eXBlKSAmJlxuICAgICAgICAhKCd0cmFuc2NlaXZlcicgaW4gd2luZG93LlJUQ1RyYWNrRXZlbnQucHJvdG90eXBlKSkge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENUcmFja0V2ZW50LnByb3RvdHlwZSwgJ3RyYW5zY2VpdmVyJywge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB7cmVjZWl2ZXI6IHRoaXMucmVjZWl2ZXJ9O1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgc2hpbVNvdXJjZU9iamVjdDogZnVuY3Rpb24od2luZG93KSB7XG4gICAgLy8gRmlyZWZveCBoYXMgc3VwcG9ydGVkIG1velNyY09iamVjdCBzaW5jZSBGRjIyLCB1bnByZWZpeGVkIGluIDQyLlxuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0Jykge1xuICAgICAgaWYgKHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50ICYmXG4gICAgICAgICEoJ3NyY09iamVjdCcgaW4gd2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlKSkge1xuICAgICAgICAvLyBTaGltIHRoZSBzcmNPYmplY3QgcHJvcGVydHksIG9uY2UsIHdoZW4gSFRNTE1lZGlhRWxlbWVudCBpcyBmb3VuZC5cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyY09iamVjdCcsIHtcbiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubW96U3JjT2JqZWN0O1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc2V0OiBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgICAgICAgIHRoaXMubW96U3JjT2JqZWN0ID0gc3RyZWFtO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIHNoaW1QZWVyQ29ubmVjdGlvbjogZnVuY3Rpb24od2luZG93KSB7XG4gICAgdmFyIGJyb3dzZXJEZXRhaWxzID0gdXRpbHMuZGV0ZWN0QnJvd3Nlcih3aW5kb3cpO1xuXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICdvYmplY3QnIHx8ICEod2luZG93LlJUQ1BlZXJDb25uZWN0aW9uIHx8XG4gICAgICAgIHdpbmRvdy5tb3pSVENQZWVyQ29ubmVjdGlvbikpIHtcbiAgICAgIHJldHVybjsgLy8gcHJvYmFibHkgbWVkaWEucGVlcmNvbm5lY3Rpb24uZW5hYmxlZD1mYWxzZSBpbiBhYm91dDpjb25maWdcbiAgICB9XG4gICAgLy8gVGhlIFJUQ1BlZXJDb25uZWN0aW9uIG9iamVjdC5cbiAgICBpZiAoIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikge1xuICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uID0gZnVuY3Rpb24ocGNDb25maWcsIHBjQ29uc3RyYWludHMpIHtcbiAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkge1xuICAgICAgICAgIC8vIC51cmxzIGlzIG5vdCBzdXBwb3J0ZWQgaW4gRkYgPCAzOC5cbiAgICAgICAgICAvLyBjcmVhdGUgUlRDSWNlU2VydmVycyB3aXRoIGEgc2luZ2xlIHVybC5cbiAgICAgICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlU2VydmVycykge1xuICAgICAgICAgICAgdmFyIG5ld0ljZVNlcnZlcnMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGNDb25maWcuaWNlU2VydmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICB2YXIgc2VydmVyID0gcGNDb25maWcuaWNlU2VydmVyc1tpXTtcbiAgICAgICAgICAgICAgaWYgKHNlcnZlci5oYXNPd25Qcm9wZXJ0eSgndXJscycpKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZXJ2ZXIudXJscy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgdmFyIG5ld1NlcnZlciA9IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBzZXJ2ZXIudXJsc1tqXVxuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIGlmIChzZXJ2ZXIudXJsc1tqXS5pbmRleE9mKCd0dXJuJykgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3U2VydmVyLnVzZXJuYW1lID0gc2VydmVyLnVzZXJuYW1lO1xuICAgICAgICAgICAgICAgICAgICBuZXdTZXJ2ZXIuY3JlZGVudGlhbCA9IHNlcnZlci5jcmVkZW50aWFsO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgbmV3SWNlU2VydmVycy5wdXNoKG5ld1NlcnZlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ld0ljZVNlcnZlcnMucHVzaChwY0NvbmZpZy5pY2VTZXJ2ZXJzW2ldKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGNDb25maWcuaWNlU2VydmVycyA9IG5ld0ljZVNlcnZlcnM7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgd2luZG93Lm1velJUQ1BlZXJDb25uZWN0aW9uKHBjQ29uZmlnLCBwY0NvbnN0cmFpbnRzKTtcbiAgICAgIH07XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlID1cbiAgICAgICAgICB3aW5kb3cubW96UlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlO1xuXG4gICAgICAvLyB3cmFwIHN0YXRpYyBtZXRob2RzLiBDdXJyZW50bHkganVzdCBnZW5lcmF0ZUNlcnRpZmljYXRlLlxuICAgICAgaWYgKHdpbmRvdy5tb3pSVENQZWVyQ29ubmVjdGlvbi5nZW5lcmF0ZUNlcnRpZmljYXRlKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24sICdnZW5lcmF0ZUNlcnRpZmljYXRlJywge1xuICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93Lm1velJUQ1BlZXJDb25uZWN0aW9uLmdlbmVyYXRlQ2VydGlmaWNhdGU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgd2luZG93LlJUQ1Nlc3Npb25EZXNjcmlwdGlvbiA9IHdpbmRvdy5tb3pSVENTZXNzaW9uRGVzY3JpcHRpb247XG4gICAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlID0gd2luZG93Lm1velJUQ0ljZUNhbmRpZGF0ZTtcbiAgICB9XG5cbiAgICAvLyBzaGltIGF3YXkgbmVlZCBmb3Igb2Jzb2xldGUgUlRDSWNlQ2FuZGlkYXRlL1JUQ1Nlc3Npb25EZXNjcmlwdGlvbi5cbiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ11cbiAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTtcbiAgICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID9cbiAgICAgICAgICAgICAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlIDpcbiAgICAgICAgICAgICAgICB3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKShhcmd1bWVudHNbMF0pO1xuICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgLy8gc3VwcG9ydCBmb3IgYWRkSWNlQ2FuZGlkYXRlKG51bGwgb3IgdW5kZWZpbmVkKVxuICAgIHZhciBuYXRpdmVBZGRJY2VDYW5kaWRhdGUgPVxuICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZTtcbiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCFhcmd1bWVudHNbMF0pIHtcbiAgICAgICAgaWYgKGFyZ3VtZW50c1sxXSkge1xuICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmF0aXZlQWRkSWNlQ2FuZGlkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcblxuICAgIC8vIHNoaW0gZ2V0U3RhdHMgd2l0aCBtYXBsaWtlIHN1cHBvcnRcbiAgICB2YXIgbWFrZU1hcFN0YXRzID0gZnVuY3Rpb24oc3RhdHMpIHtcbiAgICAgIHZhciBtYXAgPSBuZXcgTWFwKCk7XG4gICAgICBPYmplY3Qua2V5cyhzdGF0cykuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgbWFwLnNldChrZXksIHN0YXRzW2tleV0pO1xuICAgICAgICBtYXBba2V5XSA9IHN0YXRzW2tleV07XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBtYXA7XG4gICAgfTtcblxuICAgIHZhciBtb2Rlcm5TdGF0c1R5cGVzID0ge1xuICAgICAgaW5ib3VuZHJ0cDogJ2luYm91bmQtcnRwJyxcbiAgICAgIG91dGJvdW5kcnRwOiAnb3V0Ym91bmQtcnRwJyxcbiAgICAgIGNhbmRpZGF0ZXBhaXI6ICdjYW5kaWRhdGUtcGFpcicsXG4gICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsXG4gICAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJ1xuICAgIH07XG5cbiAgICB2YXIgbmF0aXZlR2V0U3RhdHMgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFN0YXRzO1xuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHMgPSBmdW5jdGlvbihcbiAgICAgIHNlbGVjdG9yLFxuICAgICAgb25TdWNjLFxuICAgICAgb25FcnJcbiAgICApIHtcbiAgICAgIHJldHVybiBuYXRpdmVHZXRTdGF0cy5hcHBseSh0aGlzLCBbc2VsZWN0b3IgfHwgbnVsbF0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHN0YXRzKSB7XG4gICAgICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0OCkge1xuICAgICAgICAgICAgc3RhdHMgPSBtYWtlTWFwU3RhdHMoc3RhdHMpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDUzICYmICFvblN1Y2MpIHtcbiAgICAgICAgICAgIC8vIFNoaW0gb25seSBwcm9taXNlIGdldFN0YXRzIHdpdGggc3BlYy1oeXBoZW5zIGluIHR5cGUgbmFtZXNcbiAgICAgICAgICAgIC8vIExlYXZlIGNhbGxiYWNrIHZlcnNpb24gYWxvbmU7IG1pc2Mgb2xkIHVzZXMgb2YgZm9yRWFjaCBiZWZvcmUgTWFwXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBzdGF0cy5mb3JFYWNoKGZ1bmN0aW9uKHN0YXQpIHtcbiAgICAgICAgICAgICAgICBzdGF0LnR5cGUgPSBtb2Rlcm5TdGF0c1R5cGVzW3N0YXQudHlwZV0gfHwgc3RhdC50eXBlO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgaWYgKGUubmFtZSAhPT0gJ1R5cGVFcnJvcicpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8vIEF2b2lkIFR5cGVFcnJvcjogXCJ0eXBlXCIgaXMgcmVhZC1vbmx5LCBpbiBvbGQgdmVyc2lvbnMuIDM0LTQzaXNoXG4gICAgICAgICAgICAgIHN0YXRzLmZvckVhY2goZnVuY3Rpb24oc3RhdCwgaSkge1xuICAgICAgICAgICAgICAgIHN0YXRzLnNldChpLCBPYmplY3QuYXNzaWduKHt9LCBzdGF0LCB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBtb2Rlcm5TdGF0c1R5cGVzW3N0YXQudHlwZV0gfHwgc3RhdC50eXBlXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHN0YXRzO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihvblN1Y2MsIG9uRXJyKTtcbiAgICB9O1xuICB9LFxuXG4gIHNoaW1TZW5kZXJHZXRTdGF0czogZnVuY3Rpb24od2luZG93KSB7XG4gICAgaWYgKCEodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmXG4gICAgICAgIHdpbmRvdy5SVENSdHBTZW5kZXIpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh3aW5kb3cuUlRDUnRwU2VuZGVyICYmICdnZXRTdGF0cycgaW4gd2luZG93LlJUQ1J0cFNlbmRlci5wcm90b3R5cGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIG9yaWdHZXRTZW5kZXJzID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTZW5kZXJzO1xuICAgIGlmIChvcmlnR2V0U2VuZGVycykge1xuICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTZW5kZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgIHZhciBzZW5kZXJzID0gb3JpZ0dldFNlbmRlcnMuYXBwbHkocGMsIFtdKTtcbiAgICAgICAgc2VuZGVycy5mb3JFYWNoKGZ1bmN0aW9uKHNlbmRlcikge1xuICAgICAgICAgIHNlbmRlci5fcGMgPSBwYztcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzZW5kZXJzO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICB2YXIgb3JpZ0FkZFRyYWNrID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5hZGRUcmFjaztcbiAgICBpZiAob3JpZ0FkZFRyYWNrKSB7XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFRyYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZW5kZXIgPSBvcmlnQWRkVHJhY2suYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgc2VuZGVyLl9wYyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBzZW5kZXI7XG4gICAgICB9O1xuICAgIH1cbiAgICB3aW5kb3cuUlRDUnRwU2VuZGVyLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMudHJhY2sgPyB0aGlzLl9wYy5nZXRTdGF0cyh0aGlzLnRyYWNrKSA6XG4gICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKG5ldyBNYXAoKSk7XG4gICAgfTtcbiAgfSxcblxuICBzaGltUmVjZWl2ZXJHZXRTdGF0czogZnVuY3Rpb24od2luZG93KSB7XG4gICAgaWYgKCEodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmXG4gICAgICAgIHdpbmRvdy5SVENSdHBTZW5kZXIpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh3aW5kb3cuUlRDUnRwU2VuZGVyICYmICdnZXRTdGF0cycgaW4gd2luZG93LlJUQ1J0cFJlY2VpdmVyLnByb3RvdHlwZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgb3JpZ0dldFJlY2VpdmVycyA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0UmVjZWl2ZXJzO1xuICAgIGlmIChvcmlnR2V0UmVjZWl2ZXJzKSB7XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFJlY2VpdmVycyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgICB2YXIgcmVjZWl2ZXJzID0gb3JpZ0dldFJlY2VpdmVycy5hcHBseShwYywgW10pO1xuICAgICAgICByZWNlaXZlcnMuZm9yRWFjaChmdW5jdGlvbihyZWNlaXZlcikge1xuICAgICAgICAgIHJlY2VpdmVyLl9wYyA9IHBjO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlY2VpdmVycztcbiAgICAgIH07XG4gICAgfVxuICAgIHV0aWxzLndyYXBQZWVyQ29ubmVjdGlvbkV2ZW50KHdpbmRvdywgJ3RyYWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgZS5yZWNlaXZlci5fcGMgPSBlLnNyY0VsZW1lbnQ7XG4gICAgICByZXR1cm4gZTtcbiAgICB9KTtcbiAgICB3aW5kb3cuUlRDUnRwUmVjZWl2ZXIucHJvdG90eXBlLmdldFN0YXRzID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcGMuZ2V0U3RhdHModGhpcy50cmFjayk7XG4gICAgfTtcbiAgfSxcblxuICBzaGltUmVtb3ZlU3RyZWFtOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICBpZiAoIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiB8fFxuICAgICAgICAncmVtb3ZlU3RyZWFtJyBpbiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUucmVtb3ZlU3RyZWFtID0gZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgdXRpbHMuZGVwcmVjYXRlZCgncmVtb3ZlU3RyZWFtJywgJ3JlbW92ZVRyYWNrJyk7XG4gICAgICB0aGlzLmdldFNlbmRlcnMoKS5mb3JFYWNoKGZ1bmN0aW9uKHNlbmRlcikge1xuICAgICAgICBpZiAoc2VuZGVyLnRyYWNrICYmIHN0cmVhbS5nZXRUcmFja3MoKS5pbmRleE9mKHNlbmRlci50cmFjaykgIT09IC0xKSB7XG4gICAgICAgICAgcGMucmVtb3ZlVHJhY2soc2VuZGVyKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgfSxcblxuICBzaGltUlRDRGF0YUNoYW5uZWw6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIC8vIHJlbmFtZSBEYXRhQ2hhbm5lbCB0byBSVENEYXRhQ2hhbm5lbCAobmF0aXZlIGZpeCBpbiBGRjYwKTpcbiAgICAvLyBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD0xMTczODUxXG4gICAgaWYgKHdpbmRvdy5EYXRhQ2hhbm5lbCAmJiAhd2luZG93LlJUQ0RhdGFDaGFubmVsKSB7XG4gICAgICB3aW5kb3cuUlRDRGF0YUNoYW5uZWwgPSB3aW5kb3cuRGF0YUNoYW5uZWw7XG4gICAgfVxuICB9LFxuXG4gIHNoaW1HZXREaXNwbGF5TWVkaWE6IGZ1bmN0aW9uKHdpbmRvdywgcHJlZmVycmVkTWVkaWFTb3VyY2UpIHtcbiAgICBpZiAoIXdpbmRvdy5uYXZpZ2F0b3IgfHwgIXdpbmRvdy5uYXZpZ2F0b3IubWVkaWFEZXZpY2VzIHx8XG4gICAgICAgICdnZXREaXNwbGF5TWVkaWEnIGluIHdpbmRvdy5uYXZpZ2F0b3IubWVkaWFEZXZpY2VzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHdpbmRvdy5uYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldERpc3BsYXlNZWRpYSA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7XG4gICAgICBpZiAoIShjb25zdHJhaW50cyAmJiBjb25zdHJhaW50cy52aWRlbykpIHtcbiAgICAgICAgdmFyIGVyciA9IG5ldyBET01FeGNlcHRpb24oJ2dldERpc3BsYXlNZWRpYSB3aXRob3V0IHZpZGVvICcgK1xuICAgICAgICAgICAgJ2NvbnN0cmFpbnRzIGlzIHVuZGVmaW5lZCcpO1xuICAgICAgICBlcnIubmFtZSA9ICdOb3RGb3VuZEVycm9yJztcbiAgICAgICAgLy8gZnJvbSBodHRwczovL2hleWNhbS5naXRodWIuaW8vd2ViaWRsLyNpZGwtRE9NRXhjZXB0aW9uLWVycm9yLW5hbWVzXG4gICAgICAgIGVyci5jb2RlID0gODtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycik7XG4gICAgICB9XG4gICAgICBpZiAoY29uc3RyYWludHMudmlkZW8gPT09IHRydWUpIHtcbiAgICAgICAgY29uc3RyYWludHMudmlkZW8gPSB7bWVkaWFTb3VyY2U6IHByZWZlcnJlZE1lZGlhU291cmNlfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvLm1lZGlhU291cmNlID0gcHJlZmVycmVkTWVkaWFTb3VyY2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gd2luZG93Lm5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKTtcbiAgICB9O1xuICAgIHdpbmRvdy5uYXZpZ2F0b3IuZ2V0RGlzcGxheU1lZGlhID0gZnVuY3Rpb24oY29uc3RyYWludHMpIHtcbiAgICAgIHV0aWxzLmRlcHJlY2F0ZWQoJ25hdmlnYXRvci5nZXREaXNwbGF5TWVkaWEnLFxuICAgICAgICAgICduYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldERpc3BsYXlNZWRpYScpO1xuICAgICAgcmV0dXJuIHdpbmRvdy5uYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldERpc3BsYXlNZWRpYShjb25zdHJhaW50cyk7XG4gICAgfTtcbiAgfVxufTtcbiIsIi8qXG4gKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlXG4gKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlXG4gKiAgdHJlZS5cbiAqL1xuIC8qIGVzbGludC1lbnYgbm9kZSAqL1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLi91dGlscycpO1xudmFyIGxvZ2dpbmcgPSB1dGlscy5sb2c7XG5cbi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24od2luZG93KSB7XG4gIHZhciBicm93c2VyRGV0YWlscyA9IHV0aWxzLmRldGVjdEJyb3dzZXIod2luZG93KTtcbiAgdmFyIG5hdmlnYXRvciA9IHdpbmRvdyAmJiB3aW5kb3cubmF2aWdhdG9yO1xuICB2YXIgTWVkaWFTdHJlYW1UcmFjayA9IHdpbmRvdyAmJiB3aW5kb3cuTWVkaWFTdHJlYW1UcmFjaztcblxuICB2YXIgc2hpbUVycm9yXyA9IGZ1bmN0aW9uKGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZToge1xuICAgICAgICBJbnRlcm5hbEVycm9yOiAnTm90UmVhZGFibGVFcnJvcicsXG4gICAgICAgIE5vdFN1cHBvcnRlZEVycm9yOiAnVHlwZUVycm9yJyxcbiAgICAgICAgUGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJyxcbiAgICAgICAgU2VjdXJpdHlFcnJvcjogJ05vdEFsbG93ZWRFcnJvcidcbiAgICAgIH1bZS5uYW1lXSB8fCBlLm5hbWUsXG4gICAgICBtZXNzYWdlOiB7XG4gICAgICAgICdUaGUgb3BlcmF0aW9uIGlzIGluc2VjdXJlLic6ICdUaGUgcmVxdWVzdCBpcyBub3QgYWxsb3dlZCBieSB0aGUgJyArXG4gICAgICAgICd1c2VyIGFnZW50IG9yIHRoZSBwbGF0Zm9ybSBpbiB0aGUgY3VycmVudCBjb250ZXh0LidcbiAgICAgIH1bZS5tZXNzYWdlXSB8fCBlLm1lc3NhZ2UsXG4gICAgICBjb25zdHJhaW50OiBlLmNvbnN0cmFpbnQsXG4gICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodGhpcy5tZXNzYWdlICYmICc6ICcpICsgdGhpcy5tZXNzYWdlO1xuICAgICAgfVxuICAgIH07XG4gIH07XG5cbiAgLy8gZ2V0VXNlck1lZGlhIGNvbnN0cmFpbnRzIHNoaW0uXG4gIHZhciBnZXRVc2VyTWVkaWFfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikge1xuICAgIHZhciBjb25zdHJhaW50c1RvRkYzN18gPSBmdW5jdGlvbihjKSB7XG4gICAgICBpZiAodHlwZW9mIGMgIT09ICdvYmplY3QnIHx8IGMucmVxdWlyZSkge1xuICAgICAgICByZXR1cm4gYztcbiAgICAgIH1cbiAgICAgIHZhciByZXF1aXJlID0gW107XG4gICAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICBpZiAoa2V5ID09PSAncmVxdWlyZScgfHwga2V5ID09PSAnYWR2YW5jZWQnIHx8IGtleSA9PT0gJ21lZGlhU291cmNlJykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgciA9IGNba2V5XSA9ICh0eXBlb2YgY1trZXldID09PSAnb2JqZWN0JykgP1xuICAgICAgICAgICAgY1trZXldIDoge2lkZWFsOiBjW2tleV19O1xuICAgICAgICBpZiAoci5taW4gIT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgci5tYXggIT09IHVuZGVmaW5lZCB8fCByLmV4YWN0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICByZXF1aXJlLnB1c2goa2V5KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoci5leGFjdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiByLmV4YWN0ID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgci4gbWluID0gci5tYXggPSByLmV4YWN0O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjW2tleV0gPSByLmV4YWN0O1xuICAgICAgICAgIH1cbiAgICAgICAgICBkZWxldGUgci5leGFjdDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoci5pZGVhbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgYy5hZHZhbmNlZCA9IGMuYWR2YW5jZWQgfHwgW107XG4gICAgICAgICAgdmFyIG9jID0ge307XG4gICAgICAgICAgaWYgKHR5cGVvZiByLmlkZWFsID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgb2Nba2V5XSA9IHttaW46IHIuaWRlYWwsIG1heDogci5pZGVhbH07XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG9jW2tleV0gPSByLmlkZWFsO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjLmFkdmFuY2VkLnB1c2gob2MpO1xuICAgICAgICAgIGRlbGV0ZSByLmlkZWFsO1xuICAgICAgICAgIGlmICghT2JqZWN0LmtleXMocikubGVuZ3RoKSB7XG4gICAgICAgICAgICBkZWxldGUgY1trZXldO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAocmVxdWlyZS5sZW5ndGgpIHtcbiAgICAgICAgYy5yZXF1aXJlID0gcmVxdWlyZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjO1xuICAgIH07XG4gICAgY29uc3RyYWludHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKSk7XG4gICAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCAzOCkge1xuICAgICAgbG9nZ2luZygnc3BlYzogJyArIEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKSk7XG4gICAgICBpZiAoY29uc3RyYWludHMuYXVkaW8pIHtcbiAgICAgICAgY29uc3RyYWludHMuYXVkaW8gPSBjb25zdHJhaW50c1RvRkYzN18oY29uc3RyYWludHMuYXVkaW8pO1xuICAgICAgfVxuICAgICAgaWYgKGNvbnN0cmFpbnRzLnZpZGVvKSB7XG4gICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0ZGMzdfKGNvbnN0cmFpbnRzLnZpZGVvKTtcbiAgICAgIH1cbiAgICAgIGxvZ2dpbmcoJ2ZmMzc6ICcgKyBKU09OLnN0cmluZ2lmeShjb25zdHJhaW50cykpO1xuICAgIH1cbiAgICByZXR1cm4gbmF2aWdhdG9yLm1vekdldFVzZXJNZWRpYShjb25zdHJhaW50cywgb25TdWNjZXNzLCBmdW5jdGlvbihlKSB7XG4gICAgICBvbkVycm9yKHNoaW1FcnJvcl8oZSkpO1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLlxuICB2YXIgZ2V0VXNlck1lZGlhUHJvbWlzZV8gPSBmdW5jdGlvbihjb25zdHJhaW50cykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIGdldFVzZXJNZWRpYV8oY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gU2hpbSBmb3IgbWVkaWFEZXZpY2VzIG9uIG9sZGVyIHZlcnNpb25zLlxuICBpZiAoIW5hdmlnYXRvci5tZWRpYURldmljZXMpIHtcbiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzID0ge2dldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sXG4gICAgICBhZGRFdmVudExpc3RlbmVyOiBmdW5jdGlvbigpIHsgfSxcbiAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKCkgeyB9XG4gICAgfTtcbiAgfVxuICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMgPVxuICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzIHx8IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICAgIHZhciBpbmZvcyA9IFtcbiAgICAgICAgICAgIHtraW5kOiAnYXVkaW9pbnB1dCcsIGRldmljZUlkOiAnZGVmYXVsdCcsIGxhYmVsOiAnJywgZ3JvdXBJZDogJyd9LFxuICAgICAgICAgICAge2tpbmQ6ICd2aWRlb2lucHV0JywgZGV2aWNlSWQ6ICdkZWZhdWx0JywgbGFiZWw6ICcnLCBncm91cElkOiAnJ31cbiAgICAgICAgICBdO1xuICAgICAgICAgIHJlc29sdmUoaW5mb3MpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgaWYgKGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA0MSkge1xuICAgIC8vIFdvcmsgYXJvdW5kIGh0dHA6Ly9idWd6aWwubGEvMTE2OTY2NVxuICAgIHZhciBvcmdFbnVtZXJhdGVEZXZpY2VzID1cbiAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzLmJpbmQobmF2aWdhdG9yLm1lZGlhRGV2aWNlcyk7XG4gICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gb3JnRW51bWVyYXRlRGV2aWNlcygpLnRoZW4odW5kZWZpbmVkLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGlmIChlLm5hbWUgPT09ICdOb3RGb3VuZEVycm9yJykge1xuICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfVxuICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDQ5KSB7XG4gICAgdmFyIG9yaWdHZXRVc2VyTWVkaWEgPSBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYS5cbiAgICAgICAgYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTtcbiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSA9IGZ1bmN0aW9uKGMpIHtcbiAgICAgIHJldHVybiBvcmlnR2V0VXNlck1lZGlhKGMpLnRoZW4oZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICAgIC8vIFdvcmsgYXJvdW5kIGh0dHBzOi8vYnVnemlsLmxhLzgwMjMyNlxuICAgICAgICBpZiAoYy5hdWRpbyAmJiAhc3RyZWFtLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoIHx8XG4gICAgICAgICAgICBjLnZpZGVvICYmICFzdHJlYW0uZ2V0VmlkZW9UcmFja3MoKS5sZW5ndGgpIHtcbiAgICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykge1xuICAgICAgICAgICAgdHJhY2suc3RvcCgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oJ1RoZSBvYmplY3QgY2FuIG5vdCBiZSBmb3VuZCBoZXJlLicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTm90Rm91bmRFcnJvcicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHJlYW07XG4gICAgICB9LCBmdW5jdGlvbihlKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChzaGltRXJyb3JfKGUpKTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH1cbiAgaWYgKCEoYnJvd3NlckRldGFpbHMudmVyc2lvbiA+IDU1ICYmXG4gICAgICAnYXV0b0dhaW5Db250cm9sJyBpbiBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFN1cHBvcnRlZENvbnN0cmFpbnRzKCkpKSB7XG4gICAgdmFyIHJlbWFwID0gZnVuY3Rpb24ob2JqLCBhLCBiKSB7XG4gICAgICBpZiAoYSBpbiBvYmogJiYgIShiIGluIG9iaikpIHtcbiAgICAgICAgb2JqW2JdID0gb2JqW2FdO1xuICAgICAgICBkZWxldGUgb2JqW2FdO1xuICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgbmF0aXZlR2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEuXG4gICAgICAgIGJpbmQobmF2aWdhdG9yLm1lZGlhRGV2aWNlcyk7XG4gICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjKSB7XG4gICAgICBpZiAodHlwZW9mIGMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBjLmF1ZGlvID09PSAnb2JqZWN0Jykge1xuICAgICAgICBjID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjKSk7XG4gICAgICAgIHJlbWFwKGMuYXVkaW8sICdhdXRvR2FpbkNvbnRyb2wnLCAnbW96QXV0b0dhaW5Db250cm9sJyk7XG4gICAgICAgIHJlbWFwKGMuYXVkaW8sICdub2lzZVN1cHByZXNzaW9uJywgJ21vek5vaXNlU3VwcHJlc3Npb24nKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuYXRpdmVHZXRVc2VyTWVkaWEoYyk7XG4gICAgfTtcblxuICAgIGlmIChNZWRpYVN0cmVhbVRyYWNrICYmIE1lZGlhU3RyZWFtVHJhY2sucHJvdG90eXBlLmdldFNldHRpbmdzKSB7XG4gICAgICB2YXIgbmF0aXZlR2V0U2V0dGluZ3MgPSBNZWRpYVN0cmVhbVRyYWNrLnByb3RvdHlwZS5nZXRTZXR0aW5ncztcbiAgICAgIE1lZGlhU3RyZWFtVHJhY2sucHJvdG90eXBlLmdldFNldHRpbmdzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBvYmogPSBuYXRpdmVHZXRTZXR0aW5ncy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICByZW1hcChvYmosICdtb3pBdXRvR2FpbkNvbnRyb2wnLCAnYXV0b0dhaW5Db250cm9sJyk7XG4gICAgICAgIHJlbWFwKG9iaiwgJ21vek5vaXNlU3VwcHJlc3Npb24nLCAnbm9pc2VTdXBwcmVzc2lvbicpO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoTWVkaWFTdHJlYW1UcmFjayAmJiBNZWRpYVN0cmVhbVRyYWNrLnByb3RvdHlwZS5hcHBseUNvbnN0cmFpbnRzKSB7XG4gICAgICB2YXIgbmF0aXZlQXBwbHlDb25zdHJhaW50cyA9IE1lZGlhU3RyZWFtVHJhY2sucHJvdG90eXBlLmFwcGx5Q29uc3RyYWludHM7XG4gICAgICBNZWRpYVN0cmVhbVRyYWNrLnByb3RvdHlwZS5hcHBseUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oYykge1xuICAgICAgICBpZiAodGhpcy5raW5kID09PSAnYXVkaW8nICYmIHR5cGVvZiBjID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgIGMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGMpKTtcbiAgICAgICAgICByZW1hcChjLCAnYXV0b0dhaW5Db250cm9sJywgJ21vekF1dG9HYWluQ29udHJvbCcpO1xuICAgICAgICAgIHJlbWFwKGMsICdub2lzZVN1cHByZXNzaW9uJywgJ21vek5vaXNlU3VwcHJlc3Npb24nKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmF0aXZlQXBwbHlDb25zdHJhaW50cy5hcHBseSh0aGlzLCBbY10pO1xuICAgICAgfTtcbiAgICB9XG4gIH1cbiAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzLCBvblN1Y2Nlc3MsIG9uRXJyb3IpIHtcbiAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDQ0KSB7XG4gICAgICByZXR1cm4gZ2V0VXNlck1lZGlhXyhjb25zdHJhaW50cywgb25TdWNjZXNzLCBvbkVycm9yKTtcbiAgICB9XG4gICAgLy8gUmVwbGFjZSBGaXJlZm94IDQ0KydzIGRlcHJlY2F0aW9uIHdhcm5pbmcgd2l0aCB1bnByZWZpeGVkIHZlcnNpb24uXG4gICAgdXRpbHMuZGVwcmVjYXRlZCgnbmF2aWdhdG9yLmdldFVzZXJNZWRpYScsXG4gICAgICAgICduYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYScpO1xuICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKS50aGVuKG9uU3VjY2Vzcywgb25FcnJvcik7XG4gIH07XG59O1xuIiwiLypcbiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlIGxpY2Vuc2VcbiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2VcbiAqICB0cmVlLlxuICovXG4ndXNlIHN0cmljdCc7XG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLi91dGlscycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgc2hpbUxvY2FsU3RyZWFtc0FQSTogZnVuY3Rpb24od2luZG93KSB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICdvYmplY3QnIHx8ICF3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCEoJ2dldExvY2FsU3RyZWFtcycgaW4gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHtcbiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0TG9jYWxTdHJlYW1zID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghdGhpcy5fbG9jYWxTdHJlYW1zKSB7XG4gICAgICAgICAgdGhpcy5fbG9jYWxTdHJlYW1zID0gW107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvY2FsU3RyZWFtcztcbiAgICAgIH07XG4gICAgfVxuICAgIGlmICghKCdnZXRTdHJlYW1CeUlkJyBpbiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlKSkge1xuICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdHJlYW1CeUlkID0gZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLl9sb2NhbFN0cmVhbXMpIHtcbiAgICAgICAgICB0aGlzLl9sb2NhbFN0cmVhbXMuZm9yRWFjaChmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgICAgICAgIGlmIChzdHJlYW0uaWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgIHJlc3VsdCA9IHN0cmVhbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fcmVtb3RlU3RyZWFtcykge1xuICAgICAgICAgIHRoaXMuX3JlbW90ZVN0cmVhbXMuZm9yRWFjaChmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgICAgICAgIGlmIChzdHJlYW0uaWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgIHJlc3VsdCA9IHN0cmVhbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKCEoJ2FkZFN0cmVhbScgaW4gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHtcbiAgICAgIHZhciBfYWRkVHJhY2sgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFRyYWNrO1xuICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5hZGRTdHJlYW0gPSBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgICAgaWYgKCF0aGlzLl9sb2NhbFN0cmVhbXMpIHtcbiAgICAgICAgICB0aGlzLl9sb2NhbFN0cmVhbXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fbG9jYWxTdHJlYW1zLmluZGV4T2Yoc3RyZWFtKSA9PT0gLTEpIHtcbiAgICAgICAgICB0aGlzLl9sb2NhbFN0cmVhbXMucHVzaChzdHJlYW0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7XG4gICAgICAgICAgX2FkZFRyYWNrLmNhbGwocGMsIHRyYWNrLCBzdHJlYW0pO1xuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkVHJhY2sgPSBmdW5jdGlvbih0cmFjaywgc3RyZWFtKSB7XG4gICAgICAgIGlmIChzdHJlYW0pIHtcbiAgICAgICAgICBpZiAoIXRoaXMuX2xvY2FsU3RyZWFtcykge1xuICAgICAgICAgICAgdGhpcy5fbG9jYWxTdHJlYW1zID0gW3N0cmVhbV07XG4gICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9sb2NhbFN0cmVhbXMuaW5kZXhPZihzdHJlYW0pID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5fbG9jYWxTdHJlYW1zLnB1c2goc3RyZWFtKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9hZGRUcmFjay5jYWxsKHRoaXMsIHRyYWNrLCBzdHJlYW0pO1xuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKCEoJ3JlbW92ZVN0cmVhbScgaW4gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHtcbiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUucmVtb3ZlU3RyZWFtID0gZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICAgIGlmICghdGhpcy5fbG9jYWxTdHJlYW1zKSB7XG4gICAgICAgICAgdGhpcy5fbG9jYWxTdHJlYW1zID0gW107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5fbG9jYWxTdHJlYW1zLmluZGV4T2Yoc3RyZWFtKTtcbiAgICAgICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sb2NhbFN0cmVhbXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgICAgdmFyIHRyYWNrcyA9IHN0cmVhbS5nZXRUcmFja3MoKTtcbiAgICAgICAgdGhpcy5nZXRTZW5kZXJzKCkuZm9yRWFjaChmdW5jdGlvbihzZW5kZXIpIHtcbiAgICAgICAgICBpZiAodHJhY2tzLmluZGV4T2Yoc2VuZGVyLnRyYWNrKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHBjLnJlbW92ZVRyYWNrKHNlbmRlcik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfVxuICB9LFxuICBzaGltUmVtb3RlU3RyZWFtc0FQSTogZnVuY3Rpb24od2luZG93KSB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICdvYmplY3QnIHx8ICF3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCEoJ2dldFJlbW90ZVN0cmVhbXMnIGluIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpKSB7XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFJlbW90ZVN0cmVhbXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlbW90ZVN0cmVhbXMgPyB0aGlzLl9yZW1vdGVTdHJlYW1zIDogW107XG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAoISgnb25hZGRzdHJlYW0nIGluIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSwgJ29uYWRkc3RyZWFtJywge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9vbmFkZHN0cmVhbTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbihmKSB7XG4gICAgICAgICAgaWYgKHRoaXMuX29uYWRkc3RyZWFtKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29uYWRkc3RyZWFtKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdhZGRzdHJlYW0nLCB0aGlzLl9vbmFkZHN0cmVhbSA9IGYpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHZhciBvcmlnU2V0UmVtb3RlRGVzY3JpcHRpb24gPVxuICAgICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuc2V0UmVtb3RlRGVzY3JpcHRpb247XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldFJlbW90ZURlc2NyaXB0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgIGlmICghdGhpcy5fb25hZGRzdHJlYW1wb2x5KSB7XG4gICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCd0cmFjaycsIHRoaXMuX29uYWRkc3RyZWFtcG9seSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGUuc3RyZWFtcy5mb3JFYWNoKGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgICAgICAgICBpZiAoIXBjLl9yZW1vdGVTdHJlYW1zKSB7XG4gICAgICAgICAgICAgICAgcGMuX3JlbW90ZVN0cmVhbXMgPSBbXTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAocGMuX3JlbW90ZVN0cmVhbXMuaW5kZXhPZihzdHJlYW0pID49IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcGMuX3JlbW90ZVN0cmVhbXMucHVzaChzdHJlYW0pO1xuICAgICAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ2FkZHN0cmVhbScpO1xuICAgICAgICAgICAgICBldmVudC5zdHJlYW0gPSBzdHJlYW07XG4gICAgICAgICAgICAgIHBjLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9yaWdTZXRSZW1vdGVEZXNjcmlwdGlvbi5hcHBseShwYywgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfVxuICB9LFxuICBzaGltQ2FsbGJhY2tzQVBJOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ29iamVjdCcgfHwgIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgcHJvdG90eXBlID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZTtcbiAgICB2YXIgY3JlYXRlT2ZmZXIgPSBwcm90b3R5cGUuY3JlYXRlT2ZmZXI7XG4gICAgdmFyIGNyZWF0ZUFuc3dlciA9IHByb3RvdHlwZS5jcmVhdGVBbnN3ZXI7XG4gICAgdmFyIHNldExvY2FsRGVzY3JpcHRpb24gPSBwcm90b3R5cGUuc2V0TG9jYWxEZXNjcmlwdGlvbjtcbiAgICB2YXIgc2V0UmVtb3RlRGVzY3JpcHRpb24gPSBwcm90b3R5cGUuc2V0UmVtb3RlRGVzY3JpcHRpb247XG4gICAgdmFyIGFkZEljZUNhbmRpZGF0ZSA9IHByb3RvdHlwZS5hZGRJY2VDYW5kaWRhdGU7XG5cbiAgICBwcm90b3R5cGUuY3JlYXRlT2ZmZXIgPSBmdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssIGZhaWx1cmVDYWxsYmFjaykge1xuICAgICAgdmFyIG9wdGlvbnMgPSAoYXJndW1lbnRzLmxlbmd0aCA+PSAyKSA/IGFyZ3VtZW50c1syXSA6IGFyZ3VtZW50c1swXTtcbiAgICAgIHZhciBwcm9taXNlID0gY3JlYXRlT2ZmZXIuYXBwbHkodGhpcywgW29wdGlvbnNdKTtcbiAgICAgIGlmICghZmFpbHVyZUNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfVxuICAgICAgcHJvbWlzZS50aGVuKHN1Y2Nlc3NDYWxsYmFjaywgZmFpbHVyZUNhbGxiYWNrKTtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9O1xuXG4gICAgcHJvdG90eXBlLmNyZWF0ZUFuc3dlciA9IGZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjaywgZmFpbHVyZUNhbGxiYWNrKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IChhcmd1bWVudHMubGVuZ3RoID49IDIpID8gYXJndW1lbnRzWzJdIDogYXJndW1lbnRzWzBdO1xuICAgICAgdmFyIHByb21pc2UgPSBjcmVhdGVBbnN3ZXIuYXBwbHkodGhpcywgW29wdGlvbnNdKTtcbiAgICAgIGlmICghZmFpbHVyZUNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfVxuICAgICAgcHJvbWlzZS50aGVuKHN1Y2Nlc3NDYWxsYmFjaywgZmFpbHVyZUNhbGxiYWNrKTtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9O1xuXG4gICAgdmFyIHdpdGhDYWxsYmFjayA9IGZ1bmN0aW9uKGRlc2NyaXB0aW9uLCBzdWNjZXNzQ2FsbGJhY2ssIGZhaWx1cmVDYWxsYmFjaykge1xuICAgICAgdmFyIHByb21pc2UgPSBzZXRMb2NhbERlc2NyaXB0aW9uLmFwcGx5KHRoaXMsIFtkZXNjcmlwdGlvbl0pO1xuICAgICAgaWYgKCFmYWlsdXJlQ2FsbGJhY2spIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9XG4gICAgICBwcm9taXNlLnRoZW4oc3VjY2Vzc0NhbGxiYWNrLCBmYWlsdXJlQ2FsbGJhY2spO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH07XG4gICAgcHJvdG90eXBlLnNldExvY2FsRGVzY3JpcHRpb24gPSB3aXRoQ2FsbGJhY2s7XG5cbiAgICB3aXRoQ2FsbGJhY2sgPSBmdW5jdGlvbihkZXNjcmlwdGlvbiwgc3VjY2Vzc0NhbGxiYWNrLCBmYWlsdXJlQ2FsbGJhY2spIHtcbiAgICAgIHZhciBwcm9taXNlID0gc2V0UmVtb3RlRGVzY3JpcHRpb24uYXBwbHkodGhpcywgW2Rlc2NyaXB0aW9uXSk7XG4gICAgICBpZiAoIWZhaWx1cmVDYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH1cbiAgICAgIHByb21pc2UudGhlbihzdWNjZXNzQ2FsbGJhY2ssIGZhaWx1cmVDYWxsYmFjayk7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfTtcbiAgICBwcm90b3R5cGUuc2V0UmVtb3RlRGVzY3JpcHRpb24gPSB3aXRoQ2FsbGJhY2s7XG5cbiAgICB3aXRoQ2FsbGJhY2sgPSBmdW5jdGlvbihjYW5kaWRhdGUsIHN1Y2Nlc3NDYWxsYmFjaywgZmFpbHVyZUNhbGxiYWNrKSB7XG4gICAgICB2YXIgcHJvbWlzZSA9IGFkZEljZUNhbmRpZGF0ZS5hcHBseSh0aGlzLCBbY2FuZGlkYXRlXSk7XG4gICAgICBpZiAoIWZhaWx1cmVDYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH1cbiAgICAgIHByb21pc2UudGhlbihzdWNjZXNzQ2FsbGJhY2ssIGZhaWx1cmVDYWxsYmFjayk7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfTtcbiAgICBwcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlID0gd2l0aENhbGxiYWNrO1xuICB9LFxuICBzaGltR2V0VXNlck1lZGlhOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICB2YXIgbmF2aWdhdG9yID0gd2luZG93ICYmIHdpbmRvdy5uYXZpZ2F0b3I7XG5cbiAgICBpZiAoIW5hdmlnYXRvci5nZXRVc2VyTWVkaWEpIHtcbiAgICAgIGlmIChuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKSB7XG4gICAgICAgIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEgPSBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhLmJpbmQobmF2aWdhdG9yKTtcbiAgICAgIH0gZWxzZSBpZiAobmF2aWdhdG9yLm1lZGlhRGV2aWNlcyAmJlxuICAgICAgICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKSB7XG4gICAgICAgIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjb25zdHJhaW50cywgY2IsIGVycmNiKSB7XG4gICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpXG4gICAgICAgICAgLnRoZW4oY2IsIGVycmNiKTtcbiAgICAgICAgfS5iaW5kKG5hdmlnYXRvcik7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBzaGltUlRDSWNlU2VydmVyVXJsczogZnVuY3Rpb24od2luZG93KSB7XG4gICAgLy8gbWlncmF0ZSBmcm9tIG5vbi1zcGVjIFJUQ0ljZVNlcnZlci51cmwgdG8gUlRDSWNlU2VydmVyLnVybHNcbiAgICB2YXIgT3JpZ1BlZXJDb25uZWN0aW9uID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uO1xuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiA9IGZ1bmN0aW9uKHBjQ29uZmlnLCBwY0NvbnN0cmFpbnRzKSB7XG4gICAgICBpZiAocGNDb25maWcgJiYgcGNDb25maWcuaWNlU2VydmVycykge1xuICAgICAgICB2YXIgbmV3SWNlU2VydmVycyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBjQ29uZmlnLmljZVNlcnZlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YXIgc2VydmVyID0gcGNDb25maWcuaWNlU2VydmVyc1tpXTtcbiAgICAgICAgICBpZiAoIXNlcnZlci5oYXNPd25Qcm9wZXJ0eSgndXJscycpICYmXG4gICAgICAgICAgICAgIHNlcnZlci5oYXNPd25Qcm9wZXJ0eSgndXJsJykpIHtcbiAgICAgICAgICAgIHV0aWxzLmRlcHJlY2F0ZWQoJ1JUQ0ljZVNlcnZlci51cmwnLCAnUlRDSWNlU2VydmVyLnVybHMnKTtcbiAgICAgICAgICAgIHNlcnZlciA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2VydmVyKSk7XG4gICAgICAgICAgICBzZXJ2ZXIudXJscyA9IHNlcnZlci51cmw7XG4gICAgICAgICAgICBkZWxldGUgc2VydmVyLnVybDtcbiAgICAgICAgICAgIG5ld0ljZVNlcnZlcnMucHVzaChzZXJ2ZXIpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXdJY2VTZXJ2ZXJzLnB1c2gocGNDb25maWcuaWNlU2VydmVyc1tpXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHBjQ29uZmlnLmljZVNlcnZlcnMgPSBuZXdJY2VTZXJ2ZXJzO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5ldyBPcmlnUGVlckNvbm5lY3Rpb24ocGNDb25maWcsIHBjQ29uc3RyYWludHMpO1xuICAgIH07XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSA9IE9yaWdQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7XG4gICAgLy8gd3JhcCBzdGF0aWMgbWV0aG9kcy4gQ3VycmVudGx5IGp1c3QgZ2VuZXJhdGVDZXJ0aWZpY2F0ZS5cbiAgICBpZiAoJ2dlbmVyYXRlQ2VydGlmaWNhdGUnIGluIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiwgJ2dlbmVyYXRlQ2VydGlmaWNhdGUnLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIE9yaWdQZWVyQ29ubmVjdGlvbi5nZW5lcmF0ZUNlcnRpZmljYXRlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG4gIHNoaW1UcmFja0V2ZW50VHJhbnNjZWl2ZXI6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIC8vIEFkZCBldmVudC50cmFuc2NlaXZlciBtZW1iZXIgb3ZlciBkZXByZWNhdGVkIGV2ZW50LnJlY2VpdmVyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnICYmIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiAmJlxuICAgICAgICAoJ3JlY2VpdmVyJyBpbiB3aW5kb3cuUlRDVHJhY2tFdmVudC5wcm90b3R5cGUpICYmXG4gICAgICAgIC8vIGNhbid0IGNoZWNrICd0cmFuc2NlaXZlcicgaW4gd2luZG93LlJUQ1RyYWNrRXZlbnQucHJvdG90eXBlLCBhcyBpdCBpc1xuICAgICAgICAvLyBkZWZpbmVkIGZvciBzb21lIHJlYXNvbiBldmVuIHdoZW4gd2luZG93LlJUQ1RyYW5zY2VpdmVyIGlzIG5vdC5cbiAgICAgICAgIXdpbmRvdy5SVENUcmFuc2NlaXZlcikge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENUcmFja0V2ZW50LnByb3RvdHlwZSwgJ3RyYW5zY2VpdmVyJywge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB7cmVjZWl2ZXI6IHRoaXMucmVjZWl2ZXJ9O1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgc2hpbUNyZWF0ZU9mZmVyTGVnYWN5OiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICB2YXIgb3JpZ0NyZWF0ZU9mZmVyID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVPZmZlcjtcbiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmNyZWF0ZU9mZmVyID0gZnVuY3Rpb24ob2ZmZXJPcHRpb25zKSB7XG4gICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgaWYgKG9mZmVyT3B0aW9ucykge1xuICAgICAgICBpZiAodHlwZW9mIG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZUF1ZGlvICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgIC8vIHN1cHBvcnQgYml0IHZhbHVlc1xuICAgICAgICAgIG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZUF1ZGlvID0gISFvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVBdWRpbztcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXVkaW9UcmFuc2NlaXZlciA9IHBjLmdldFRyYW5zY2VpdmVycygpLmZpbmQoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHtcbiAgICAgICAgICByZXR1cm4gdHJhbnNjZWl2ZXIuc2VuZGVyLnRyYWNrICYmXG4gICAgICAgICAgICAgIHRyYW5zY2VpdmVyLnNlbmRlci50cmFjay5raW5kID09PSAnYXVkaW8nO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZUF1ZGlvID09PSBmYWxzZSAmJiBhdWRpb1RyYW5zY2VpdmVyKSB7XG4gICAgICAgICAgaWYgKGF1ZGlvVHJhbnNjZWl2ZXIuZGlyZWN0aW9uID09PSAnc2VuZHJlY3YnKSB7XG4gICAgICAgICAgICBpZiAoYXVkaW9UcmFuc2NlaXZlci5zZXREaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgYXVkaW9UcmFuc2NlaXZlci5zZXREaXJlY3Rpb24oJ3NlbmRvbmx5Jyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBhdWRpb1RyYW5zY2VpdmVyLmRpcmVjdGlvbiA9ICdzZW5kb25seSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmIChhdWRpb1RyYW5zY2VpdmVyLmRpcmVjdGlvbiA9PT0gJ3JlY3Zvbmx5Jykge1xuICAgICAgICAgICAgaWYgKGF1ZGlvVHJhbnNjZWl2ZXIuc2V0RGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgIGF1ZGlvVHJhbnNjZWl2ZXIuc2V0RGlyZWN0aW9uKCdpbmFjdGl2ZScpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgYXVkaW9UcmFuc2NlaXZlci5kaXJlY3Rpb24gPSAnaW5hY3RpdmUnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVBdWRpbyA9PT0gdHJ1ZSAmJlxuICAgICAgICAgICAgIWF1ZGlvVHJhbnNjZWl2ZXIpIHtcbiAgICAgICAgICBwYy5hZGRUcmFuc2NlaXZlcignYXVkaW8nKTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgaWYgKHR5cGVvZiBvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVWaWRlbyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAvLyBzdXBwb3J0IGJpdCB2YWx1ZXNcbiAgICAgICAgICBvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVWaWRlbyA9ICEhb2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlVmlkZW87XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZpZGVvVHJhbnNjZWl2ZXIgPSBwYy5nZXRUcmFuc2NlaXZlcnMoKS5maW5kKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7XG4gICAgICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLnNlbmRlci50cmFjayAmJlxuICAgICAgICAgICAgICB0cmFuc2NlaXZlci5zZW5kZXIudHJhY2sua2luZCA9PT0gJ3ZpZGVvJztcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVWaWRlbyA9PT0gZmFsc2UgJiYgdmlkZW9UcmFuc2NlaXZlcikge1xuICAgICAgICAgIGlmICh2aWRlb1RyYW5zY2VpdmVyLmRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2Jykge1xuICAgICAgICAgICAgdmlkZW9UcmFuc2NlaXZlci5zZXREaXJlY3Rpb24oJ3NlbmRvbmx5Jyk7XG4gICAgICAgICAgfSBlbHNlIGlmICh2aWRlb1RyYW5zY2VpdmVyLmRpcmVjdGlvbiA9PT0gJ3JlY3Zvbmx5Jykge1xuICAgICAgICAgICAgdmlkZW9UcmFuc2NlaXZlci5zZXREaXJlY3Rpb24oJ2luYWN0aXZlJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvID09PSB0cnVlICYmXG4gICAgICAgICAgICAhdmlkZW9UcmFuc2NlaXZlcikge1xuICAgICAgICAgIHBjLmFkZFRyYW5zY2VpdmVyKCd2aWRlbycpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gb3JpZ0NyZWF0ZU9mZmVyLmFwcGx5KHBjLCBhcmd1bWVudHMpO1xuICAgIH07XG4gIH1cbn07XG4iLCIvKlxuICogIENvcHlyaWdodCAoYykgMjAxNiBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZVxuICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZVxuICogIHRyZWUuXG4gKi9cbiAvKiBlc2xpbnQtZW52IG5vZGUgKi9cbid1c2Ugc3RyaWN0JztcblxudmFyIGxvZ0Rpc2FibGVkXyA9IHRydWU7XG52YXIgZGVwcmVjYXRpb25XYXJuaW5nc18gPSB0cnVlO1xuXG4vKipcbiAqIEV4dHJhY3QgYnJvd3NlciB2ZXJzaW9uIG91dCBvZiB0aGUgcHJvdmlkZWQgdXNlciBhZ2VudCBzdHJpbmcuXG4gKlxuICogQHBhcmFtIHshc3RyaW5nfSB1YXN0cmluZyB1c2VyQWdlbnQgc3RyaW5nLlxuICogQHBhcmFtIHshc3RyaW5nfSBleHByIFJlZ3VsYXIgZXhwcmVzc2lvbiB1c2VkIGFzIG1hdGNoIGNyaXRlcmlhLlxuICogQHBhcmFtIHshbnVtYmVyfSBwb3MgcG9zaXRpb24gaW4gdGhlIHZlcnNpb24gc3RyaW5nIHRvIGJlIHJldHVybmVkLlxuICogQHJldHVybiB7IW51bWJlcn0gYnJvd3NlciB2ZXJzaW9uLlxuICovXG5mdW5jdGlvbiBleHRyYWN0VmVyc2lvbih1YXN0cmluZywgZXhwciwgcG9zKSB7XG4gIHZhciBtYXRjaCA9IHVhc3RyaW5nLm1hdGNoKGV4cHIpO1xuICByZXR1cm4gbWF0Y2ggJiYgbWF0Y2gubGVuZ3RoID49IHBvcyAmJiBwYXJzZUludChtYXRjaFtwb3NdLCAxMCk7XG59XG5cbi8vIFdyYXBzIHRoZSBwZWVyY29ubmVjdGlvbiBldmVudCBldmVudE5hbWVUb1dyYXAgaW4gYSBmdW5jdGlvblxuLy8gd2hpY2ggcmV0dXJucyB0aGUgbW9kaWZpZWQgZXZlbnQgb2JqZWN0IChvciBmYWxzZSB0byBwcmV2ZW50XG4vLyB0aGUgZXZlbnQpLlxuZnVuY3Rpb24gd3JhcFBlZXJDb25uZWN0aW9uRXZlbnQod2luZG93LCBldmVudE5hbWVUb1dyYXAsIHdyYXBwZXIpIHtcbiAgaWYgKCF3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24pIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIHByb3RvID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZTtcbiAgdmFyIG5hdGl2ZUFkZEV2ZW50TGlzdGVuZXIgPSBwcm90by5hZGRFdmVudExpc3RlbmVyO1xuICBwcm90by5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24obmF0aXZlRXZlbnROYW1lLCBjYikge1xuICAgIGlmIChuYXRpdmVFdmVudE5hbWUgIT09IGV2ZW50TmFtZVRvV3JhcCkge1xuICAgICAgcmV0dXJuIG5hdGl2ZUFkZEV2ZW50TGlzdGVuZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG4gICAgdmFyIHdyYXBwZWRDYWxsYmFjayA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBtb2RpZmllZEV2ZW50ID0gd3JhcHBlcihlKTtcbiAgICAgIGlmIChtb2RpZmllZEV2ZW50KSB7XG4gICAgICAgIGNiKG1vZGlmaWVkRXZlbnQpO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5fZXZlbnRNYXAgPSB0aGlzLl9ldmVudE1hcCB8fCB7fTtcbiAgICB0aGlzLl9ldmVudE1hcFtjYl0gPSB3cmFwcGVkQ2FsbGJhY2s7XG4gICAgcmV0dXJuIG5hdGl2ZUFkZEV2ZW50TGlzdGVuZXIuYXBwbHkodGhpcywgW25hdGl2ZUV2ZW50TmFtZSxcbiAgICAgIHdyYXBwZWRDYWxsYmFja10pO1xuICB9O1xuXG4gIHZhciBuYXRpdmVSZW1vdmVFdmVudExpc3RlbmVyID0gcHJvdG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcjtcbiAgcHJvdG8ucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uKG5hdGl2ZUV2ZW50TmFtZSwgY2IpIHtcbiAgICBpZiAobmF0aXZlRXZlbnROYW1lICE9PSBldmVudE5hbWVUb1dyYXAgfHwgIXRoaXMuX2V2ZW50TWFwXG4gICAgICAgIHx8ICF0aGlzLl9ldmVudE1hcFtjYl0pIHtcbiAgICAgIHJldHVybiBuYXRpdmVSZW1vdmVFdmVudExpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuICAgIHZhciB1bndyYXBwZWRDYiA9IHRoaXMuX2V2ZW50TWFwW2NiXTtcbiAgICBkZWxldGUgdGhpcy5fZXZlbnRNYXBbY2JdO1xuICAgIHJldHVybiBuYXRpdmVSZW1vdmVFdmVudExpc3RlbmVyLmFwcGx5KHRoaXMsIFtuYXRpdmVFdmVudE5hbWUsXG4gICAgICB1bndyYXBwZWRDYl0pO1xuICB9O1xuXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwcm90bywgJ29uJyArIGV2ZW50TmFtZVRvV3JhcCwge1xuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpc1snX29uJyArIGV2ZW50TmFtZVRvV3JhcF07XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uKGNiKSB7XG4gICAgICBpZiAodGhpc1snX29uJyArIGV2ZW50TmFtZVRvV3JhcF0pIHtcbiAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZVRvV3JhcCxcbiAgICAgICAgICAgIHRoaXNbJ19vbicgKyBldmVudE5hbWVUb1dyYXBdKTtcbiAgICAgICAgZGVsZXRlIHRoaXNbJ19vbicgKyBldmVudE5hbWVUb1dyYXBdO1xuICAgICAgfVxuICAgICAgaWYgKGNiKSB7XG4gICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWVUb1dyYXAsXG4gICAgICAgICAgICB0aGlzWydfb24nICsgZXZlbnROYW1lVG9XcmFwXSA9IGNiKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlXG4gIH0pO1xufVxuXG4vLyBVdGlsaXR5IG1ldGhvZHMuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgZXh0cmFjdFZlcnNpb246IGV4dHJhY3RWZXJzaW9uLFxuICB3cmFwUGVlckNvbm5lY3Rpb25FdmVudDogd3JhcFBlZXJDb25uZWN0aW9uRXZlbnQsXG4gIGRpc2FibGVMb2c6IGZ1bmN0aW9uKGJvb2wpIHtcbiAgICBpZiAodHlwZW9mIGJvb2wgIT09ICdib29sZWFuJykge1xuICAgICAgcmV0dXJuIG5ldyBFcnJvcignQXJndW1lbnQgdHlwZTogJyArIHR5cGVvZiBib29sICtcbiAgICAgICAgICAnLiBQbGVhc2UgdXNlIGEgYm9vbGVhbi4nKTtcbiAgICB9XG4gICAgbG9nRGlzYWJsZWRfID0gYm9vbDtcbiAgICByZXR1cm4gKGJvb2wpID8gJ2FkYXB0ZXIuanMgbG9nZ2luZyBkaXNhYmxlZCcgOlxuICAgICAgICAnYWRhcHRlci5qcyBsb2dnaW5nIGVuYWJsZWQnO1xuICB9LFxuXG4gIC8qKlxuICAgKiBEaXNhYmxlIG9yIGVuYWJsZSBkZXByZWNhdGlvbiB3YXJuaW5nc1xuICAgKiBAcGFyYW0geyFib29sZWFufSBib29sIHNldCB0byB0cnVlIHRvIGRpc2FibGUgd2FybmluZ3MuXG4gICAqL1xuICBkaXNhYmxlV2FybmluZ3M6IGZ1bmN0aW9uKGJvb2wpIHtcbiAgICBpZiAodHlwZW9mIGJvb2wgIT09ICdib29sZWFuJykge1xuICAgICAgcmV0dXJuIG5ldyBFcnJvcignQXJndW1lbnQgdHlwZTogJyArIHR5cGVvZiBib29sICtcbiAgICAgICAgICAnLiBQbGVhc2UgdXNlIGEgYm9vbGVhbi4nKTtcbiAgICB9XG4gICAgZGVwcmVjYXRpb25XYXJuaW5nc18gPSAhYm9vbDtcbiAgICByZXR1cm4gJ2FkYXB0ZXIuanMgZGVwcmVjYXRpb24gd2FybmluZ3MgJyArIChib29sID8gJ2Rpc2FibGVkJyA6ICdlbmFibGVkJyk7XG4gIH0sXG5cbiAgbG9nOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGlmIChsb2dEaXNhYmxlZF8pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgY29uc29sZS5sb2cgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFNob3dzIGEgZGVwcmVjYXRpb24gd2FybmluZyBzdWdnZXN0aW5nIHRoZSBtb2Rlcm4gYW5kIHNwZWMtY29tcGF0aWJsZSBBUEkuXG4gICAqL1xuICBkZXByZWNhdGVkOiBmdW5jdGlvbihvbGRNZXRob2QsIG5ld01ldGhvZCkge1xuICAgIGlmICghZGVwcmVjYXRpb25XYXJuaW5nc18pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc29sZS53YXJuKG9sZE1ldGhvZCArICcgaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHVzZSAnICsgbmV3TWV0aG9kICtcbiAgICAgICAgJyBpbnN0ZWFkLicpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBCcm93c2VyIGRldGVjdG9yLlxuICAgKlxuICAgKiBAcmV0dXJuIHtvYmplY3R9IHJlc3VsdCBjb250YWluaW5nIGJyb3dzZXIgYW5kIHZlcnNpb25cbiAgICogICAgIHByb3BlcnRpZXMuXG4gICAqL1xuICBkZXRlY3RCcm93c2VyOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICB2YXIgbmF2aWdhdG9yID0gd2luZG93ICYmIHdpbmRvdy5uYXZpZ2F0b3I7XG5cbiAgICAvLyBSZXR1cm5lZCByZXN1bHQgb2JqZWN0LlxuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICByZXN1bHQuYnJvd3NlciA9IG51bGw7XG4gICAgcmVzdWx0LnZlcnNpb24gPSBudWxsO1xuXG4gICAgLy8gRmFpbCBlYXJseSBpZiBpdCdzIG5vdCBhIGJyb3dzZXJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcgfHwgIXdpbmRvdy5uYXZpZ2F0b3IpIHtcbiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIGJyb3dzZXIuJztcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgaWYgKG5hdmlnYXRvci5tb3pHZXRVc2VyTWVkaWEpIHsgLy8gRmlyZWZveC5cbiAgICAgIHJlc3VsdC5icm93c2VyID0gJ2ZpcmVmb3gnO1xuICAgICAgcmVzdWx0LnZlcnNpb24gPSBleHRyYWN0VmVyc2lvbihuYXZpZ2F0b3IudXNlckFnZW50LFxuICAgICAgICAgIC9GaXJlZm94XFwvKFxcZCspXFwuLywgMSk7XG4gICAgfSBlbHNlIGlmIChuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKSB7XG4gICAgICAvLyBDaHJvbWUsIENocm9taXVtLCBXZWJ2aWV3LCBPcGVyYS5cbiAgICAgIC8vIFZlcnNpb24gbWF0Y2hlcyBDaHJvbWUvV2ViUlRDIHZlcnNpb24uXG4gICAgICByZXN1bHQuYnJvd3NlciA9ICdjaHJvbWUnO1xuICAgICAgcmVzdWx0LnZlcnNpb24gPSBleHRyYWN0VmVyc2lvbihuYXZpZ2F0b3IudXNlckFnZW50LFxuICAgICAgICAgIC9DaHJvbShlfGl1bSlcXC8oXFxkKylcXC4vLCAyKTtcbiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci5tZWRpYURldmljZXMgJiZcbiAgICAgICAgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvRWRnZVxcLyhcXGQrKS4oXFxkKykkLykpIHsgLy8gRWRnZS5cbiAgICAgIHJlc3VsdC5icm93c2VyID0gJ2VkZ2UnO1xuICAgICAgcmVzdWx0LnZlcnNpb24gPSBleHRyYWN0VmVyc2lvbihuYXZpZ2F0b3IudXNlckFnZW50LFxuICAgICAgICAgIC9FZGdlXFwvKFxcZCspLihcXGQrKSQvLCAyKTtcbiAgICB9IGVsc2UgaWYgKHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiAmJlxuICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9BcHBsZVdlYktpdFxcLyhcXGQrKVxcLi8pKSB7IC8vIFNhZmFyaS5cbiAgICAgIHJlc3VsdC5icm93c2VyID0gJ3NhZmFyaSc7XG4gICAgICByZXN1bHQudmVyc2lvbiA9IGV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsXG4gICAgICAgICAgL0FwcGxlV2ViS2l0XFwvKFxcZCspXFwuLywgMSk7XG4gICAgfSBlbHNlIHsgLy8gRGVmYXVsdCBmYWxsdGhyb3VnaDogbm90IHN1cHBvcnRlZC5cbiAgICAgIHJlc3VsdC5icm93c2VyID0gJ05vdCBhIHN1cHBvcnRlZCBicm93c2VyLic7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbn07XG4iLCIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIExpY2Vuc2UgaW5mbyBmb3Igd2VicnRjLWFkYXB0ZXIgbW9kdWxlIGFzc2VtYmxlZCBpbnRvIGpzIGJ1bmRsZTpcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQsIFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dCBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlIG1ldDpcbiAqXG4gKiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4gKlxuICogUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZSBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLlxuICpcbiAqIE5laXRoZXIgdGhlIG5hbWUgb2YgR29vZ2xlIG5vciB0aGUgbmFtZXMgb2YgaXRzIGNvbnRyaWJ1dG9ycyBtYXkgYmUgdXNlZCB0byBlbmRvcnNlIG9yIHByb21vdGUgcHJvZHVjdHMgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91dCBzcGVjaWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uXG4gKlxuICogVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBCWSBUSEUgQ09QWVJJR0hUIEhPTERFUlMgQU5EIENPTlRSSUJVVE9SUyBcIkFTIElTXCIgQU5EIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRSBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBUkUgRElTQ0xBSU1FRC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIENPUFlSSUdIVCBIT0xERVIgT1IgQ09OVFJJQlVUT1JTIEJFIExJQUJMRSBGT1IgQU5ZIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUzsgTE9TUyBPRiBVU0UsIERBVEEsIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVTRUQgQU5EIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRSBPRiBUSElTIFNPRlRXQVJFLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBMaWNlbnNlIGluZm8gZm9yIHNkcCBtb2R1bGUgYXNzZW1ibGVkIGludG8ganMgYnVuZGxlOlxuICpcbiAqIFNlZSBodHRwczovL3d3dy5ucG1qcy5jb20vcGFja2FnZS9zZHBcbiAqL1xuaW1wb3J0ICd3ZWJydGMtYWRhcHRlcic7XG4vKipcbiAqIEBsaWNlbnNlXG4gKiBMaWNlbnNlIGluZm8gZm9yIHV1aWQgbW9kdWxlIGFzc2VtYmxlZCBpbnRvIGpzIGJ1bmRsZTpcbiAqXG4gKiBUaGUgTUlUIExpY2Vuc2UgKE1JVClcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTAtMjAxNiBSb2JlcnQgS2llZmZlciBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKlxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAqXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cbiAqL1xuaW1wb3J0IFJ0Y1Nlc3Npb24gZnJvbSAnLi9ydGNfc2Vzc2lvbic7XG5pbXBvcnQge1JUQ19FUlJPUlN9IGZyb20gJy4vcnRjX2NvbnN0JztcbmltcG9ydCBSdGNQZWVyQ29ubmVjdGlvbkZhY3RvcnkgZnJvbSAnLi9ydGNfcGVlcl9jb25uZWN0aW9uX2ZhY3RvcnknXG5pbXBvcnQgdXVpZCBmcm9tICd1dWlkL3Y0JztcbmltcG9ydCBTdGFuZGFyZFN0cmF0ZWd5IGZyb20gXCIuL3N0cmF0ZWdpZXMvU3RhbmRhcmRTdHJhdGVneVwiO1xuaW1wb3J0IENpdHJpeFZESVN0cmF0ZWd5IGZyb20gXCIuL3N0cmF0ZWdpZXMvQ2l0cml4VkRJU3RyYXRlZ3lcIjtcblxuZ2xvYmFsLmNvbm5lY3QgPSBnbG9iYWwuY29ubmVjdCB8fCB7fTtcbmdsb2JhbC5jb25uZWN0LlJUQ1Nlc3Npb24gPSBSdGNTZXNzaW9uO1xuZ2xvYmFsLmNvbm5lY3QuUlRDRXJyb3JzID0gUlRDX0VSUk9SUztcbmdsb2JhbC5jb25uZWN0LlJ0Y1BlZXJDb25uZWN0aW9uRmFjdG9yeSA9IFJ0Y1BlZXJDb25uZWN0aW9uRmFjdG9yeTtcbmdsb2JhbC5jb25uZWN0LnV1aWQgPSB1dWlkO1xuZ2xvYmFsLmNvbm5lY3QuU3RhbmRhcmRTdHJhdGVneSA9IFN0YW5kYXJkU3RyYXRlZ3k7XG5nbG9iYWwuY29ubmVjdC5DaXRyaXhWRElTdHJhdGVneSA9IENpdHJpeFZESVN0cmF0ZWd5O1xuXG5nbG9iYWwubGlseSA9IGdsb2JhbC5saWx5IHx8IHt9O1xuZ2xvYmFsLmxpbHkuUlRDU2Vzc2lvbiA9IFJ0Y1Nlc3Npb247XG5nbG9iYWwubGlseS5SVENFcnJvcnMgPSBSVENfRVJST1JTO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4gKi9cbmV4cG9ydCBjb25zdCBUaW1lb3V0RXhjZXB0aW9uTmFtZSA9ICdUaW1lb3V0JztcbmV4cG9ydCBjbGFzcyBUaW1lb3V0IGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1zZykge1xuICAgICAgICBzdXBlcihtc2cpO1xuICAgICAgICB0aGlzLm5hbWUgPSBUaW1lb3V0RXhjZXB0aW9uTmFtZTtcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBHdW1UaW1lb3V0RXhjZXB0aW9uTmFtZSA9ICdHdW1UaW1lb3V0JztcbmV4cG9ydCBjbGFzcyBHdW1UaW1lb3V0IGV4dGVuZHMgVGltZW91dCB7XG4gICAgY29uc3RydWN0b3IobXNnKSB7XG4gICAgICAgIHN1cGVyKG1zZyk7XG4gICAgICAgIHRoaXMubmFtZSA9IEd1bVRpbWVvdXRFeGNlcHRpb25OYW1lO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IElsbGVnYWxQYXJhbWV0ZXJzRXhjZXB0aW9uTmFtZSA9ICdJbGxlZ2FsUGFyYW1ldGVycyc7XG5leHBvcnQgY2xhc3MgSWxsZWdhbFBhcmFtZXRlcnMgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IobXNnKSB7XG4gICAgICAgIHN1cGVyKG1zZyk7XG4gICAgICAgIHRoaXMubmFtZSA9IElsbGVnYWxQYXJhbWV0ZXJzRXhjZXB0aW9uTmFtZTtcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBJbGxlZ2FsU3RhdGVFeGNlcHRpb25OYW1lID0gJ0lsbGVnYWxTdGF0ZSc7XG5leHBvcnQgY2xhc3MgSWxsZWdhbFN0YXRlIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1zZykge1xuICAgICAgICBzdXBlcihtc2cpO1xuICAgICAgICB0aGlzLm5hbWUgPSBJbGxlZ2FsU3RhdGVFeGNlcHRpb25OYW1lO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uTmFtZSA9ICdVbnN1cHBvcnRlZE9wZXJhdGlvbic7XG5leHBvcnQgY2xhc3MgVW5zdXBwb3J0ZWRPcGVyYXRpb24gZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IobXNnKSB7XG4gICAgICAgIHN1cGVyKG1zZyk7XG4gICAgICAgIHRoaXMubmFtZSA9IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uTmFtZTtcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBCdXN5RXhjZXB0aW9uTmFtZSA9ICdCdXN5RXhjZXB0aW9uJztcbmV4cG9ydCBjbGFzcyBCdXN5RXhjZXB0aW9uIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1zZykge1xuICAgICAgICBzdXBlcihtc2cpO1xuICAgICAgICB0aGlzLm5hbWUgPSBCdXN5RXhjZXB0aW9uTmFtZTtcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBDYWxsTm90Rm91bmRFeGNlcHRpb25OYW1lID0gJ0NhbGxOb3RGb3VuZEV4Y2VwdGlvbic7XG5leHBvcnQgY2xhc3MgQ2FsbE5vdEZvdW5kRXhjZXB0aW9uIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1zZykge1xuICAgICAgICBzdXBlcihtc2cpO1xuICAgICAgICB0aGlzLm5hbWUgPSBDYWxsTm90Rm91bmRFeGNlcHRpb25OYW1lO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IFVua25vd25TaWduYWxpbmdFcnJvck5hbWUgPSAnVW5rbm93blNpZ25hbGluZ0Vycm9yJztcbmV4cG9ydCBjbGFzcyBVbmtub3duU2lnbmFsaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMubmFtZSA9IFVua25vd25TaWduYWxpbmdFcnJvck5hbWU7XG4gICAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4gKi9cblxuLyoqXG4gKiBUaW1lb3V0IHdhaXRpbmcgZm9yIHNlcnZlciByZXNwb25zZSB0byBhY2NlcHQvaGFuZ3VwIHJlcXVlc3QuXG4gKi9cbmV4cG9ydCBjb25zdCBNQVhfQUNDRVBUX0JZRV9ERUxBWV9NUyA9IDIwMDA7XG4vKipcbiAqIFRpbWVvdXQgd2FpdGluZyBmb3Igc2VydmVyIHJlc3BvbnNlIHRvIGludml0ZS5cbiAqL1xuZXhwb3J0IGNvbnN0IE1BWF9JTlZJVEVfREVMQVlfTVMgPSA1MDAwO1xuLyoqXG4gKiAgRGVmYXVsdCB0aW1lb3V0IG9uIG9wZW5pbmcgV2ViU29ja2V0IGNvbm5lY3Rpb24uXG4gKi9cbmV4cG9ydCBjb25zdCBERUZBVUxUX0NPTk5FQ1RfVElNRU9VVF9NUyA9IDEwMDAwO1xuLyoqXG4gKiBEZWZhdWx0IGljZSBjb2xsZWN0aW9uIHRpbWVvdXQgaW4gbWlsbGlzZWNvbmRzLlxuICovXG5leHBvcnQgY29uc3QgREVGQVVMVF9JQ0VfVElNRU9VVF9NUyA9IDgwMDA7XG4vKipcbiAqIERlZmF1bHQgZ3VtIHRpbWVvdXQgaW4gbWlsbGlzZWNvbmRzIHRvIGJlIGVuZm9yY2VkIGR1cmluZyBzdGFydCBvZiBhIGNhbGwuXG4gKi9cbmV4cG9ydCBjb25zdCBERUZBVUxUX0dVTV9USU1FT1VUX01TID0gMTAwMDA7XG5cbmV4cG9ydCBjb25zdCBTT0ZUUEhPTkVfUk9VVEVfS0VZID0gXCJhd3Mvc29mdHBob25lXCI7XG5cbmV4cG9ydCBjb25zdCBJTlZJVEVfTUVUSE9EX05BTUUgPSBcImludml0ZVwiO1xuZXhwb3J0IGNvbnN0IEFDQ0VQVF9NRVRIT0RfTkFNRSA9IFwiYWNjZXB0XCI7XG5leHBvcnQgY29uc3QgQllFX01FVEhPRF9OQU1FID0gXCJieWVcIjtcblxuZXhwb3J0IGNvbnN0IFJUQ19QRUVSX0NPTk5FQ1RJT05fQ09ORklHID0ge1xuICAgIGljZVRyYW5zcG9ydFBvbGljeTogJ3JlbGF5JyxcbiAgICBydGNwTXV4UG9saWN5OiAncmVxdWlyZScsXG4gICAgYnVuZGxlUG9saWN5OiAnYmFsYW5jZWQnLFxuICAgIHNkcFNlbWFudGljczogJ3VuaWZpZWQtcGxhbicsXG4gICAgZW5hYmxlRHRsc1NydHA6IHRydWVcbn07XG5cbmV4cG9ydCBjb25zdCBSVENfUEVFUl9DT05ORUNUSU9OX09QVElPTkFMX0NPTkZJRyA9IHtcbiAgICBvcHRpb25hbDogW1xuICAgICAgICB7XG4gICAgICAgICAgICBnb29nRHNjcDogdHJ1ZVxuXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIER0bHNTcnRwS2V5QWdyZWVtZW50OiB0cnVlXG4gICAgICAgIH1cbiAgICBdXG59O1xuXG5leHBvcnQgY29uc3QgREVGQVVMVF9JQ0VfQ0FORElEQVRFX1BPT0xfU0laRSA9IDE7XG5cbmV4cG9ydCBjb25zdCBSVENfUEVFUl9DT05ORUNUSU9OX0lETEVfVElNRU9VVF9NUyA9IDEqNjAqMTAwMDtcblxuZXhwb3J0IGNvbnN0IE5FVFdPUktfQ09OTkVDVElWSVRZX0NIRUNLX0lOVEVSVkFMX01TID0gMjUwO1xuXG5leHBvcnQgY29uc3QgQ0hST01FX1NVUFBPUlRFRF9WRVJTSU9OID0gNTk7XG5cbi8qKlxuICogUlRDIGVycm9yIG5hbWVzLlxuICovXG5leHBvcnQgY29uc3QgUlRDX0VSUk9SUyA9IHtcbiAgICBJQ0VfQ09MTEVDVElPTl9USU1FT1VUIDogJ0ljZSBDb2xsZWN0aW9uIFRpbWVvdXQnLFxuICAgIFVTRVJfQlVTWSA6ICdVc2VyIEJ1c3knLFxuICAgIFNJR05BTExJTkdfQ09OTkVDVElPTl9GQUlMVVJFIDogJ1NpZ25hbGxpbmcgQ29ubmVjdGlvbiBGYWlsdXJlJyxcbiAgICBTSUdOQUxMSU5HX0hBTkRTSEFLRV9GQUlMVVJFIDogJ1NpZ25hbGxpbmcgSGFuZHNoYWtlIEZhaWx1cmUnLFxuICAgIFNFVF9SRU1PVEVfREVTQ1JJUFRJT05fRkFJTFVSRSA6ICdTZXQgUmVtb3RlIERlc2NyaXB0aW9uIEZhaWx1cmUnLFxuICAgIENSRUFURV9PRkZFUl9GQUlMVVJFIDogJ0NyZWF0ZSBPZmZlciBGYWlsdXJlJyxcbiAgICBTRVRfTE9DQUxfREVTQ1JJUFRJT05fRkFJTFVSRSA6ICdTZXQgTG9jYWwgRGVzY3JpcHRpb24gRmFpbHVyZScsXG4gICAgSU5WQUxJRF9SRU1PVEVfU0RQIDogJ0ludmFsaWQgUmVtb3RlIFNEUCcsXG4gICAgTk9fUkVNT1RFX0lDRV9DQU5ESURBVEUgOiAnTm8gUmVtb3RlIElDRSBDYW5kaWRhdGUnLFxuICAgIEdVTV9USU1FT1VUX0ZBSUxVUkUgOiAnR1VNIFRpbWVvdXQgRmFpbHVyZScsXG4gICAgR1VNX09USEVSX0ZBSUxVUkUgOiAnR1VNIE90aGVyIEZhaWx1cmUnLFxuICAgIENBTExfTk9UX0ZPVU5EOiAnQ2FsbCBOb3QgRm91bmQnXG59O1xuXG5leHBvcnQgY29uc3QgSUNFX0NPTk5FQ1RJT05fU1RBVEUgPSB7XG4gICAgTkVXIDogJ25ldycsXG4gICAgQ0hFQ0tJTkcgOiAnY2hlY2tpbmcnLFxuICAgIENPTk5FQ1RFRCA6ICdjb25uZWN0ZWQnLFxuICAgIENPTVBMRVRFRCA6ICdjb21wbGV0ZWQnLFxuICAgIEZBSUxFRCA6ICdmYWlsZWQnLFxuICAgIERJU0NPTk5FQ1RFRCA6ICdkaXNjb25uZWN0ZWQnLFxuICAgIENMT1NFRCA6ICdjbG9zZWQnXG59O1xuXG5leHBvcnQgY29uc3QgUEVFUl9DT05ORUNUSU9OX1NUQVRFID0ge1xuICAgIE5FVyA6ICduZXcnLFxuICAgIENPTk5FQ1RJTkcgOiAnY29ubmVjdGluZycsXG4gICAgQ09OTkVDVEVEIDogJ2Nvbm5lY3RlZCcsXG4gICAgRkFJTEVEIDogJ2ZhaWxlZCcsXG4gICAgRElTQ09OTkVDVEVEIDogJ2Rpc2Nvbm5lY3RlZCcsXG4gICAgQ0xPU0VEIDogJ2Nsb3NlZCdcbn07IiwiaW1wb3J0IHthc3NlcnRUcnVlLCBoaXRjaCwgaXNGdW5jdGlvbn0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQge1xuICAgIERFRkFVTFRfSUNFX0NBTkRJREFURV9QT09MX1NJWkUsXG4gICAgTkVUV09SS19DT05ORUNUSVZJVFlfQ0hFQ0tfSU5URVJWQUxfTVMsXG4gICAgUlRDX1BFRVJfQ09OTkVDVElPTl9DT05GSUcsXG4gICAgUlRDX1BFRVJfQ09OTkVDVElPTl9JRExFX1RJTUVPVVRfTVMsXG4gICAgUlRDX1BFRVJfQ09OTkVDVElPTl9PUFRJT05BTF9DT05GSUcsXG4gICAgU09GVFBIT05FX1JPVVRFX0tFWVxufSBmcm9tICcuL3J0Y19jb25zdCdcbmltcG9ydCBDQ1BJbml0aWF0aW9uU3RyYXRlZ3lJbnRlcmZhY2UgZnJvbSBcIi4vc3RyYXRlZ2llcy9DQ1BJbml0aWF0aW9uU3RyYXRlZ3lJbnRlcmZhY2VcIjtcbmltcG9ydCBTdGFuZGFyZFN0cmF0ZWd5IGZyb20gXCIuL3N0cmF0ZWdpZXMvU3RhbmRhcmRTdHJhdGVneVwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSdGNQZWVyQ29ubmVjdGlvbkZhY3Rvcnkge1xuXG4gICAgLy90cmFuc3BvcnRIYW5kbGUgbXVzdCBiZSBhIGNhbGxiYWNrIGZ1bmN0aW9uIHdoaWNoIHNob3VsZCByZXR1cm4gYSBwcm9taXNlIHdoaWNoIGlzIGdvaW5nIHRvIHJldHVybiB0aGUgaWNlU2VydmVycy4gUGxlYXNlIHJlZmVyIGh0dHBzOi8vd3d3LnczLm9yZy9UUi93ZWJydGMvI3J0Y2ljZXNlcnZlci1kaWN0aW9uYXJ5IGZvciBpY2VTZXJ2ZXIgZXhhbXBsZVxuICAgIC8vcHVibGlzaEVycm9yKGVycm9yVHlwZSwgZXJyb3JNZXNzYWdlKSBtdXN0IGJlIGEgY2FsbGJhY2sgZnVuY3Rpb24gd2hpY2ggd2lsbCBwdWJsaXNoIHRoZSBwYXNzZWQgZXJyb3IgbWVzc2FnZSB0byBjbGllbnQgYnJvd3NlclxuICAgIGNvbnN0cnVjdG9yKGxvZ2dlciwgd3NzTWFuYWdlciwgY2xpZW50SWQsIHRyYW5zcG9ydEhhbmRsZSwgcHVibGlzaEVycm9yLCBzdHJhdGVneSA9IG5ldyBTdGFuZGFyZFN0cmF0ZWd5KCkpIHtcbiAgICAgICAgaWYgKCEoc3RyYXRlZ3kgaW5zdGFuY2VvZiBDQ1BJbml0aWF0aW9uU3RyYXRlZ3lJbnRlcmZhY2UpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIGEgc3RyYXRlZ3kgb2YgdHlwZSBDQ1BJbml0aWF0aW9uU3RyYXRlZ3lJbnRlcmZhY2UnKTtcbiAgICAgICAgfVxuICAgICAgICBhc3NlcnRUcnVlKGlzRnVuY3Rpb24odHJhbnNwb3J0SGFuZGxlKSwgJ3RyYW5zcG9ydEhhbmRsZSBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICAgICAgYXNzZXJ0VHJ1ZShpc0Z1bmN0aW9uKHB1Ymxpc2hFcnJvciksICdwdWJsaXNoRXJyb3IgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgICAgIHRoaXMuX3N0cmF0ZWd5ID0gc3RyYXRlZ3k7XG4gICAgICAgIHRoaXMuX2xvZ2dlciA9IGxvZ2dlcjtcbiAgICAgICAgdGhpcy5fY2xpZW50SWQgPSBjbGllbnRJZDtcbiAgICAgICAgdGhpcy5fd3NzTWFuYWdlciA9IHdzc01hbmFnZXI7XG4gICAgICAgIHRoaXMuX3JlcXVlc3RJY2VBY2Nlc3MgPSB0cmFuc3BvcnRIYW5kbGU7XG4gICAgICAgIHRoaXMuX3B1Ymxpc2hFcnJvciA9IHB1Ymxpc2hFcnJvcjtcbiAgICAgICAgdGhpcy5fZWFybHlNZWRpYUNvbm5lY3Rpb25TdXBwb3J0ZWQgPSB0aGlzLl9pc0Vhcmx5TWVkaWFDb25uZWN0aW9uU3VwcG9ydGVkKCk7XG4gICAgICAgIHRoaXMuX2luaXRpYWxpemVXZWJTb2NrZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgICB0aGlzLl9yZXF1ZXN0UGVlckNvbm5lY3Rpb24oKTtcbiAgICAgICAgdGhpcy5fbmV0d29ya0Nvbm5lY3Rpdml0eUNoZWNrZXIoKTtcblxuICAgICAgICB0aGlzLl9sb2dnZXIubG9nKFwiUlRDLmpzIGlzIHVzaW5nIFwiICsgc3RyYXRlZ3kuZ2V0U3RyYXRlZ3lOYW1lKCkpO1xuICAgIH1cblxuICAgIF9pc0Vhcmx5TWVkaWFDb25uZWN0aW9uU3VwcG9ydGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3RyYXRlZ3kuX2lzRWFybHlNZWRpYUNvbm5lY3Rpb25TdXBwb3J0ZWQoKTtcbiAgICB9XG5cbiAgICAvL1RoaXMgd2lsbCBoYW5kbGUgdGhlIGlkbGVDb25uZWN0aW9uIGFuZCBxdW90YSBsaW1pdHMgbm90aWZpY2F0aW9uIGZyb20gdGhlIHNlcnZlclxuICAgIF93ZWJTb2NrZXRNYW5hZ2VyT25NZXNzYWdlKGV2ZW50KSB7XG4gICAgICAgIGxldCBjb250ZW50O1xuICAgICAgICBpZiAoZXZlbnQuY29udGVudCkge1xuICAgICAgICAgICAgY29udGVudCA9IEpTT04ucGFyc2UoZXZlbnQuY29udGVudCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbnRlbnQgJiYgdGhpcy5fY2xpZW50SWQgPT09IGNvbnRlbnQuY2xpZW50SWQpIHtcbiAgICAgICAgICAgIGlmIChjb250ZW50Lmpzb25ScGNNc2cubWV0aG9kID09PSBcImlkbGVDb25uZWN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jbGVhcklkbGVSdGNQZWVyQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb250ZW50Lmpzb25ScGNNc2cubWV0aG9kID09PSBcInF1b3RhQnJlYWNoZWRcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvZ2dlci5sb2coXCJOdW1iZXIgb2YgYWN0aXZlIHNlc3Npb25zIGFyZSBtb3JlIHRoZW4gYWxsb3dlZCBsaW1pdCBmb3IgdGhlIGNsaWVudCBcIiArIHRoaXMuX2NsaWVudElkKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9jbG9zZVJUQ1BlZXJDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcHVibGlzaEVycm9yKFwibXVsdGlwbGVfc29mdHBob25lX2FjdGl2ZV9zZXNzaW9uc1wiLCBcIk51bWJlciBvZiBhY3RpdmUgc2Vzc2lvbnMgYXJlIG1vcmUgdGhlbiBhbGxvd2VkIGxpbWl0LlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9pbml0aWFsaXplV2ViU29ja2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX3dzc01hbmFnZXIuc3Vic2NyaWJlVG9waWNzKFtTT0ZUUEhPTkVfUk9VVEVfS0VZXSk7XG4gICAgICAgIHRoaXMuX3VuU3Vic2NyaWJlID0gdGhpcy5fd3NzTWFuYWdlci5vbk1lc3NhZ2UoU09GVFBIT05FX1JPVVRFX0tFWSwgaGl0Y2godGhpcywgdGhpcy5fd2ViU29ja2V0TWFuYWdlck9uTWVzc2FnZSkpO1xuICAgIH1cblxuICAgIC8vIFRoaXMgbWV0aG9kIHdpbGwgY3JlYXRlIGFuZCByZXR1cm4gbmV3IHBlZXIgY29ubmVjdGlvbiBpZiBicm93c2VyIGlzIG5vdCBzdXBwb3J0aW5nIGVhcmx5IGljZSBjb2xsZWN0aW9uLlxuICAgIC8vIEZvciB0aGUgc3VwcG9ydGVkIGJyb3dzZXIsIHRoaXMgbWV0aG9kIHdpbGwgcmVxdWVzdCBmb3IgbmV3IHBlZXJDb25uZWN0aW9uIGFmdGVyIHJldHVybmluZyB0aGUgZXhpc3RpbmcgcGVlckNvbm5lY3Rpb25cbiAgICBnZXQoaWNlU2VydmVycykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBwYyA9IHNlbGYuX3BjO1xuICAgICAgICBzZWxmLl9wYyA9IG51bGw7XG4gICAgICAgIGlmIChwYyA9PSBudWxsKSB7XG4gICAgICAgICAgICBwYyA9IHNlbGYuX2NyZWF0ZVJ0Y1BlZXJDb25uZWN0aW9uKGljZVNlcnZlcnMpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuY2xlYXJJZGxlUnRjUGVlckNvbm5lY3Rpb25UaW1lcklkKCk7XG4gICAgICAgIHNlbGYuX3JlcXVlc3RQZWVyQ29ubmVjdGlvbigpO1xuICAgICAgICByZXR1cm4gcGM7XG4gICAgfVxuXG4gICAgY2xlYXJJZGxlUnRjUGVlckNvbm5lY3Rpb25UaW1lcklkKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGlmIChzZWxmLl9pZGxlUnRjUGVlckNvbm5lY3Rpb25UaW1lcklkKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoc2VsZi5faWRsZVJ0Y1BlZXJDb25uZWN0aW9uVGltZXJJZCk7XG4gICAgICAgICAgICBzZWxmLl9pZGxlUnRjUGVlckNvbm5lY3Rpb25UaW1lcklkID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9yZXF1ZXN0UGVlckNvbm5lY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgaWYgKCFzZWxmLl9wZWVyQ29ubmVjdGlvblJlcXVlc3RJbkZsaWdodCAmJiBzZWxmLl9lYXJseU1lZGlhQ29ubmVjdGlvblN1cHBvcnRlZCkge1xuICAgICAgICAgICAgc2VsZi5fcGVlckNvbm5lY3Rpb25SZXF1ZXN0SW5GbGlnaHQgPSB0cnVlO1xuICAgICAgICAgICAgc2VsZi5fcmVxdWVzdEljZUFjY2VzcygpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3BjID0gc2VsZi5fY3JlYXRlUnRjUGVlckNvbm5lY3Rpb24ocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9wZWVyQ29ubmVjdGlvblJlcXVlc3RJbkZsaWdodCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9pZGxlUnRjUGVlckNvbm5lY3Rpb25UaW1lcklkID0gc2V0VGltZW91dChoaXRjaChzZWxmLCBzZWxmLl9yZWZyZXNoUnRjUGVlckNvbm5lY3Rpb24pLCBSVENfUEVFUl9DT05ORUNUSU9OX0lETEVfVElNRU9VVF9NUyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3BlZXJDb25uZWN0aW9uUmVxdWVzdEluRmxpZ2h0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfbmV0d29ya0Nvbm5lY3Rpdml0eUNoZWNrZXIoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCFuYXZpZ2F0b3Iub25MaW5lICYmIHNlbGYuX3BjKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5fbG9nZ2VyLmxvZyhcIk5ldHdvcmsgb2ZmbGluZS4gQ2xlYW5pbmcgdXAgZWFybHkgY29ubmVjdGlvblwiKTtcbiAgICAgICAgICAgICAgICBzZWxmLl9wYy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIHNlbGYuX3BjID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgTkVUV09SS19DT05ORUNUSVZJVFlfQ0hFQ0tfSU5URVJWQUxfTVMpO1xuICAgIH1cblxuICAgIF9jcmVhdGVSdGNQZWVyQ29ubmVjdGlvbihpY2VTZXJ2ZXJzKSB7XG4gICAgICAgIHZhciBydGNQZWVyQ29ubmVjdGlvbkNvbmZpZyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoUlRDX1BFRVJfQ09OTkVDVElPTl9DT05GSUcpKTtcbiAgICAgICAgcnRjUGVlckNvbm5lY3Rpb25Db25maWcuaWNlU2VydmVycyA9IGljZVNlcnZlcnM7XG4gICAgICAgIHJ0Y1BlZXJDb25uZWN0aW9uQ29uZmlnLmljZUNhbmRpZGF0ZVBvb2xTaXplID0gREVGQVVMVF9JQ0VfQ0FORElEQVRFX1BPT0xfU0laRTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0cmF0ZWd5Ll9jcmVhdGVSdGNQZWVyQ29ubmVjdGlvbihydGNQZWVyQ29ubmVjdGlvbkNvbmZpZywgUlRDX1BFRVJfQ09OTkVDVElPTl9PUFRJT05BTF9DT05GSUcpO1xuICAgIH1cblxuICAgIF9jbGVhcklkbGVSdGNQZWVyQ29ubmVjdGlvbigpIHtcbiAgICAgICAgdGhpcy5fbG9nZ2VyLmxvZyhcInNlc3Npb24gaXMgaWRsZSBmcm9tIGxvbmcgdGltZS4gY2xvc2luZyB0aGUgcGVlciBjb25uZWN0aW9uIGZvciBjbGllbnQgXCIgKyB0aGlzLl9jbGllbnRJZCk7XG4gICAgICAgIHRoaXMuX2Nsb3NlUlRDUGVlckNvbm5lY3Rpb24oKTtcbiAgICB9XG5cbiAgICBfcmVmcmVzaFJ0Y1BlZXJDb25uZWN0aW9uKCkge1xuICAgICAgICB0aGlzLl9pZGxlUnRjUGVlckNvbm5lY3Rpb25UaW1lcklkID0gbnVsbDtcbiAgICAgICAgdGhpcy5fY2xlYXJJZGxlUnRjUGVlckNvbm5lY3Rpb24oKTtcbiAgICAgICAgdGhpcy5fbG9nZ2VyLmxvZyhcInJlZnJlc2hpbmcgcGVlciBjb25uZWN0aW9uIGZvciBjbGllbnQgXCIgKyB0aGlzLl9jbGllbnRJZCk7XG4gICAgICAgIHRoaXMuX3JlcXVlc3RQZWVyQ29ubmVjdGlvbigpO1xuICAgIH1cblxuICAgIF9jbG9zZVJUQ1BlZXJDb25uZWN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5fcGMpIHtcbiAgICAgICAgICAgIHRoaXMuX3BjLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLl9wYyA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59IiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4gKi9cbmltcG9ydCB7Y2xvc2VTdHJlYW0sIGhpdGNoLCBpc0xlZ2FjeVN0YXRzUmVwb3J0U3VwcG9ydGVkLCBTZHBPcHRpb25zLCB0cmFuc2Zvcm1TZHAsIHdyYXBMb2dnZXJ9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHtTZXNzaW9uUmVwb3J0fSBmcm9tICcuL3Nlc3Npb25fcmVwb3J0JztcbmltcG9ydCB7XG4gICAgREVGQVVMVF9HVU1fVElNRU9VVF9NUyxcbiAgICBERUZBVUxUX0lDRV9USU1FT1VUX01TLFxuICAgIFJUQ19FUlJPUlMsXG4gICAgUlRDX1BFRVJfQ09OTkVDVElPTl9DT05GSUcsXG4gICAgUlRDX1BFRVJfQ09OTkVDVElPTl9PUFRJT05BTF9DT05GSUcsXG4gICAgSUNFX0NPTk5FQ1RJT05fU1RBVEUsXG4gICAgUEVFUl9DT05ORUNUSU9OX1NUQVRFXG59IGZyb20gJy4vcnRjX2NvbnN0JztcbmltcG9ydCB7XG4gICAgQnVzeUV4Y2VwdGlvbk5hbWUsXG4gICAgQ2FsbE5vdEZvdW5kRXhjZXB0aW9uTmFtZSxcbiAgICBHdW1UaW1lb3V0LFxuICAgIElsbGVnYWxQYXJhbWV0ZXJzLFxuICAgIElsbGVnYWxTdGF0ZSxcbiAgICBVbnN1cHBvcnRlZE9wZXJhdGlvblxufSBmcm9tICcuL2V4Y2VwdGlvbnMnO1xuaW1wb3J0IFJ0Y1NpZ25hbGluZyBmcm9tICcuL3NpZ25hbGluZyc7XG5pbXBvcnQgdXVpZCBmcm9tICd1dWlkL3Y0JztcbmltcG9ydCB7ZXh0cmFjdE1lZGlhU3RhdHNGcm9tU3RhdHN9IGZyb20gJy4vcnRwLXN0YXRzJztcbmltcG9ydCB7cGFyc2VDYW5kaWRhdGV9IGZyb20gJ3NkcCc7XG5pbXBvcnQgQ0NQSW5pdGlhdGlvblN0cmF0ZWd5SW50ZXJmYWNlIGZyb20gXCIuL3N0cmF0ZWdpZXMvQ0NQSW5pdGlhdGlvblN0cmF0ZWd5SW50ZXJmYWNlXCI7XG5pbXBvcnQgU3RhbmRhcmRTdHJhdGVneSBmcm9tIFwiLi9zdHJhdGVnaWVzL1N0YW5kYXJkU3RyYXRlZ3lcIjtcblxuZXhwb3J0IGNsYXNzIFJUQ1Nlc3Npb25TdGF0ZSB7XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1J0Y1Nlc3Npb259IHJ0Y1Nlc3Npb25cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihydGNTZXNzaW9uKSB7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24gPSBydGNTZXNzaW9uO1xuICAgIH1cbiAgICBvbkVudGVyKCkge1xuICAgIH1cbiAgICBvbkV4aXQoKSB7XG4gICAgfVxuICAgIF9pc0N1cnJlbnRTdGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3J0Y1Nlc3Npb24uX3N0YXRlID09PSB0aGlzO1xuICAgIH1cbiAgICB0cmFuc2l0KG5leHRTdGF0ZSkge1xuICAgICAgICBpZiAodGhpcy5faXNDdXJyZW50U3RhdGUoKSkge1xuICAgICAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi50cmFuc2l0KG5leHRTdGF0ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGxvZ2dlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3J0Y1Nlc3Npb24uX2xvZ2dlcjtcbiAgICB9XG4gICAgaGFuZ3VwKCkge1xuICAgICAgICB0aGlzLnRyYW5zaXQobmV3IEZhaWxlZFN0YXRlKHRoaXMuX3J0Y1Nlc3Npb24pKTtcbiAgICB9XG4gICAgb25JY2VDYW5kaWRhdGUoZXZ0KSB7Ly8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuICAgICAgICAvL2lnbm9yZSBjYW5kaWRhdGUgYnkgZGVmYXVsdCwgQ29ubmVjdFNpZ25hbGluZ0FuZEljZUNvbGxlY3Rpb25TdGF0ZSB3aWxsIG92ZXJyaWRlIHRvIGNvbGxlY3QgY2FuZGlkYXRlcywgYnV0IGNvbGxlY3RpbmcgcHJvY2VzcyBjb3VsZCBsYXN0IG11Y2ggbG9uZ2VyIHRoYW4gQ29ubmVjdFNpZ25hbGluZ0FuZEljZUNvbGxlY3Rpb25TdGF0ZVxuICAgICAgICAvL3dlIGRvbid0IHdhbnQgdG8gc3BhbSB0aGUgY29uc29sZSBsb2dcbiAgICB9XG4gICAgb25SZW1vdGVIdW5ndXAoKSB7XG4gICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbignb25SZW1vdGVIdW5ndXAgbm90IGltcGxlbWVudGVkIGJ5ICcgKyB0aGlzLm5hbWUpO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiUlRDU2Vzc2lvblN0YXRlXCI7XG4gICAgfVxuICAgIG9uU2lnbmFsaW5nQ29ubmVjdGVkKCkge1xuICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb24oJ29uU2lnbmFsaW5nQ29ubmVjdGVkIG5vdCBpbXBsZW1lbnRlZCBieSAnICsgdGhpcy5uYW1lKTtcbiAgICB9XG4gICAgb25TaWduYWxpbmdIYW5kc2hha2VkKCkge1xuICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb24oJ29uU2lnbmFsaW5nSGFuZHNoYWtlZCBub3QgaW1wbGVtZW50ZWQgYnkgJyArIHRoaXMubmFtZSk7XG4gICAgfVxuICAgIG9uU2lnbmFsaW5nRmFpbGVkKGUpIHsvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXG4gICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbignb25TaWduYWxpbmdGYWlsZWQgbm90IGltcGxlbWVudGVkIGJ5ICcgKyB0aGlzLm5hbWUpO1xuICAgIH1cbiAgICBvbkljZVN0YXRlQ2hhbmdlKGV2dCkgey8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgR3JhYkxvY2FsTWVkaWFTdGF0ZSBleHRlbmRzIFJUQ1Nlc3Npb25TdGF0ZSB7XG4gICAgb25FbnRlcigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgaWYgKHNlbGYuX3J0Y1Nlc3Npb24uX2lzVXNlclByb3ZpZGVkU3RyZWFtKSB7XG4gICAgICAgICAgICBzZWxmLnRyYW5zaXQobmV3IENyZWF0ZU9mZmVyU3RhdGUoc2VsZi5fcnRjU2Vzc2lvbikpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGd1bVRpbWVvdXRQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEd1bVRpbWVvdXQoJ0xvY2FsIG1lZGlhIGhhcyBub3QgYmVlbiBpbml0aWFsaXplZCB5ZXQuJykpO1xuICAgICAgICAgICAgICAgIH0sIHNlbGYuX3J0Y1Nlc3Npb24uX2d1bVRpbWVvdXRNaWxsaXMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgc2Vzc2lvbkd1bVByb21pc2UgPSBzZWxmLl9nVU0oc2VsZi5fcnRjU2Vzc2lvbi5fYnVpbGRNZWRpYUNvbnN0cmFpbnRzKCkpO1xuXG4gICAgICAgICAgICBQcm9taXNlLnJhY2UoW3Nlc3Npb25HdW1Qcm9taXNlLCBndW1UaW1lb3V0UHJvbWlzZV0pXG4gICAgICAgICAgICAgICAgLnRoZW4oc3RyZWFtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5ndW1UaW1lTWlsbGlzID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fcnRjU2Vzc2lvbi5fb25HdW1TdWNjZXNzKHNlbGYuX3J0Y1Nlc3Npb24pO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9sb2NhbFN0cmVhbSA9IHN0cmVhbTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5ndW1PdGhlckZhaWx1cmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5ndW1UaW1lb3V0RmFpbHVyZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnRyYW5zaXQobmV3IENyZWF0ZU9mZmVyU3RhdGUoc2VsZi5fcnRjU2Vzc2lvbikpO1xuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0Lmd1bVRpbWVNaWxsaXMgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3JSZWFzb247XG4gICAgICAgICAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgR3VtVGltZW91dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JSZWFzb24gPSBSVENfRVJST1JTLkdVTV9USU1FT1VUX0ZBSUxVUkU7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0Lmd1bVRpbWVvdXRGYWlsdXJlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuZ3VtT3RoZXJGYWlsdXJlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvclJlYXNvbiA9IFJUQ19FUlJPUlMuR1VNX09USEVSX0ZBSUxVUkU7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0Lmd1bU90aGVyRmFpbHVyZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0Lmd1bVRpbWVvdXRGYWlsdXJlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2dnZXIuZXJyb3IoJ0xvY2FsIG1lZGlhIGluaXRpYWxpemF0aW9uIGZhaWxlZCcsIGUpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9vbkd1bUVycm9yKHNlbGYuX3J0Y1Nlc3Npb24pO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnRyYW5zaXQobmV3IEZhaWxlZFN0YXRlKHNlbGYuX3J0Y1Nlc3Npb24sIGVycm9yUmVhc29uKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIkdyYWJMb2NhbE1lZGlhU3RhdGVcIjtcbiAgICB9XG4gICAgX2dVTShjb25zdHJhaW50cykge1xuICAgICAgICByZXR1cm4gdGhpcy5fcnRjU2Vzc2lvbi5fc3RyYXRlZ3kuX2dVTShjb25zdHJhaW50cyk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIENyZWF0ZU9mZmVyU3RhdGUgZXh0ZW5kcyBSVENTZXNzaW9uU3RhdGUge1xuICAgIG9uRW50ZXIoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIHN0cmVhbSA9IHNlbGYuX3J0Y1Nlc3Npb24uX2xvY2FsU3RyZWFtO1xuICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zdHJhdGVneS5hZGRTdHJlYW0oc2VsZi5fcnRjU2Vzc2lvbi5fcGMsIHN0cmVhbSk7XG4gICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX29uTG9jYWxTdHJlYW1BZGRlZChzZWxmLl9ydGNTZXNzaW9uLCBzdHJlYW0pO1xuICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9wYy5jcmVhdGVPZmZlcigpLnRoZW4ocnRjU2Vzc2lvbkRlc2NyaXB0aW9uID0+IHtcbiAgICAgICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX2xvY2FsU2Vzc2lvbkRlc2NyaXB0aW9uID0gcnRjU2Vzc2lvbkRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgc2VsZi5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5jcmVhdGVPZmZlckZhaWx1cmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHNlbGYudHJhbnNpdChuZXcgU2V0TG9jYWxTZXNzaW9uRGVzY3JpcHRpb25TdGF0ZShzZWxmLl9ydGNTZXNzaW9uKSk7XG4gICAgICAgIH0pLmNhdGNoKGUgPT4ge1xuICAgICAgICAgICAgc2VsZi5sb2dnZXIuZXJyb3IoJ0NyZWF0ZU9mZmVyIGZhaWxlZCcsIGUpO1xuICAgICAgICAgICAgc2VsZi5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5jcmVhdGVPZmZlckZhaWx1cmUgPSB0cnVlO1xuICAgICAgICAgICAgc2VsZi50cmFuc2l0KG5ldyBGYWlsZWRTdGF0ZShzZWxmLl9ydGNTZXNzaW9uLCBSVENfRVJST1JTLkNSRUFURV9PRkZFUl9GQUlMVVJFKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiQ3JlYXRlT2ZmZXJTdGF0ZVwiO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBTZXRMb2NhbFNlc3Npb25EZXNjcmlwdGlvblN0YXRlIGV4dGVuZHMgUlRDU2Vzc2lvblN0YXRlIHtcbiAgICBvbkVudGVyKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgLy8gZml4L21vZGlmeSBTRFAgYXMgbmVlZGVkIGhlcmUsIGJlZm9yZSBzZXRMb2NhbERlc2NyaXB0aW9uXG4gICAgICAgIHZhciBsb2NhbERlc2NyaXB0aW9uID0gc2VsZi5fcnRjU2Vzc2lvbi5fbG9jYWxTZXNzaW9uRGVzY3JpcHRpb247XG4gICAgICAgIHZhciBzZHBPcHRpb25zID0gbmV3IFNkcE9wdGlvbnMoKTtcbiAgICAgICAgLy8gU2V0IGF1ZGlvIGNvZGVjLlxuICAgICAgICBpZiAoc2VsZi5fcnRjU2Vzc2lvbi5fZm9yY2VBdWRpb0NvZGVjKSB7XG4gICAgICAgICAgICBzZHBPcHRpb25zLmZvcmNlQ29kZWNbJ2F1ZGlvJ10gPSBzZWxmLl9ydGNTZXNzaW9uLl9mb3JjZUF1ZGlvQ29kZWM7XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2V0IHZpZGVvIGNvZGVjLlxuICAgICAgICBpZiAoc2VsZi5fcnRjU2Vzc2lvbi5fZm9yY2VWaWRlb0NvZGVjKSB7XG4gICAgICAgICAgICBzZHBPcHRpb25zLmZvcmNlQ29kZWNbJ3ZpZGVvJ10gPSBzZWxmLl9ydGNTZXNzaW9uLl9mb3JjZVZpZGVvQ29kZWM7XG4gICAgICAgIH1cbiAgICAgICAgc2RwT3B0aW9ucy5lbmFibGVPcHVzRHR4ID0gc2VsZi5fcnRjU2Vzc2lvbi5fZW5hYmxlT3B1c0R0eDtcblxuICAgICAgICB2YXIgdHJhbnNmb3JtZWRTZHAgPSB0cmFuc2Zvcm1TZHAobG9jYWxEZXNjcmlwdGlvbi5zZHAsIHNkcE9wdGlvbnMpO1xuICAgICAgICBsb2NhbERlc2NyaXB0aW9uLnNkcCA9IHRyYW5zZm9ybWVkU2RwLnNkcDtcbiAgICAgICAgbG9jYWxEZXNjcmlwdGlvbi5zZHAgKz0gJ2E9cHRpbWU6MjBcXHJcXG4nO1xuICAgICAgICBsb2NhbERlc2NyaXB0aW9uLnNkcCArPSAnYT1tYXhwdGltZToyMFxcclxcbic7XG4gICAgICAgIGxvY2FsRGVzY3JpcHRpb24uc2RwID0gbG9jYWxEZXNjcmlwdGlvbi5zZHAucmVwbGFjZShcIm1pbnB0aW1lPTEwXCIsIFwibWlucHRpbWU9MjBcIik7XG5cbiAgICAgICAgc2VsZi5sb2dnZXIuaW5mbygnTG9jYWxTRCcsIHNlbGYuX3J0Y1Nlc3Npb24uX2xvY2FsU2Vzc2lvbkRlc2NyaXB0aW9uKTtcbiAgICAgICAgc2VsZi5fcnRjU2Vzc2lvbi5fcGMuc2V0TG9jYWxEZXNjcmlwdGlvbihzZWxmLl9ydGNTZXNzaW9uLl9sb2NhbFNlc3Npb25EZXNjcmlwdGlvbikudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB2YXIgaW5pdGlhbGl6YXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIHNlbGYuX3J0Y1Nlc3Npb24uX2Nvbm5lY3RUaW1lU3RhbXA7XG4gICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LmluaXRpYWxpemF0aW9uVGltZU1pbGxpcyA9IGluaXRpYWxpemF0aW9uVGltZTtcbiAgICAgICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX29uU2Vzc2lvbkluaXRpYWxpemVkKHNlbGYuX3J0Y1Nlc3Npb24sIGluaXRpYWxpemF0aW9uVGltZSk7XG4gICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LnNldExvY2FsRGVzY3JpcHRpb25GYWlsdXJlID0gZmFsc2U7XG4gICAgICAgICAgICBzZWxmLnRyYW5zaXQobmV3IENvbm5lY3RTaWduYWxpbmdBbmRJY2VDb2xsZWN0aW9uU3RhdGUoc2VsZi5fcnRjU2Vzc2lvbiwgdHJhbnNmb3JtZWRTZHAubUxpbmVzKSk7XG4gICAgICAgIH0pLmNhdGNoKGUgPT4ge1xuICAgICAgICAgICAgc2VsZi5sb2dnZXIuZXJyb3IoJ1NldExvY2FsRGVzY3JpcHRpb24gZmFpbGVkJywgZSk7XG4gICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LnNldExvY2FsRGVzY3JpcHRpb25GYWlsdXJlID0gdHJ1ZTtcbiAgICAgICAgICAgIHNlbGYudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUoc2VsZi5fcnRjU2Vzc2lvbiwgUlRDX0VSUk9SUy5TRVRfTE9DQUxfREVTQ1JJUFRJT05fRkFJTFVSRSkpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIlNldExvY2FsU2Vzc2lvbkRlc2NyaXB0aW9uU3RhdGVcIjtcbiAgICB9XG59XG5cbi8qKlxuICogS2ljayBvZmYgc2lnbmFsaW5nIGNvbm5lY3Rpb24uIFdhaXQgdW50aWwgc2lnbmFsaW5nIGNvbm5lY3RzIGFuZCBJQ0UgY29sbGVjdGlvbiAod2hpY2ggYWxyZWFkeSBzdGFydGVkIGluIHByZXZpb3VzIHN0YXRlKSBjb21wbGV0ZXMuXG4gKiBJQ0UgY29sbGVjdGlvbiB0aW1lcyBvdXQgYWZ0ZXIgdXNlciBzcGVjaWZpZWQgYW1vdW50IG9mIHRpbWUgKGRlZmF1bHQgdG8gREVGQVVMVF9JQ0VfVElNRU9VVF9NUykgaW4gY2FzZSB1c2VyIGhhcyBjb21wbGV4IG5ldHdvcmsgZW52aXJvbm1lbnQgdGhhdCBibGFja2hvbGVzIFNUVU4vVFVSTiByZXF1ZXN0cy4gSW4gdGhpcyBjYXNlIGF0IGxlYXN0IG9uZSBjYW5kaWRhdGUgaXMgcmVxdWlyZWQgdG8gbW92ZSBmb3J3YXJkLlxuICogSUNFIGNvbGxlY3Rpb24gY291bGQgYWxzbyB3cmFwIHVwIGJlZm9yZSB0aW1lb3V0IGlmIGl0J3MgZGV0ZXJtaW5lZCB0aGF0IFJUUCBjYW5kaWRhdGVzIGZyb20gc2FtZSBUVVJOIHNlcnZlciBoYXZlIGJlZW4gY29sbGVjdGVkIGZvciBhbGwgbSBsaW5lcy5cbiAqL1xuZXhwb3J0IGNsYXNzIENvbm5lY3RTaWduYWxpbmdBbmRJY2VDb2xsZWN0aW9uU3RhdGUgZXh0ZW5kcyBSVENTZXNzaW9uU3RhdGUge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZSBDb25uZWN0U2lnbmFsaW5nQW5kSWNlQ29sbGVjdGlvblN0YXRlIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge1J0Y1Nlc3Npb259IHJ0Y1Nlc3Npb25cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbUxpbmVzIE51bWJlciBvZiBtIGxpbmVzIGluIFNEUFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJ0Y1Nlc3Npb24sIG1MaW5lcykge1xuICAgICAgICBzdXBlcihydGNTZXNzaW9uKTtcbiAgICAgICAgdGhpcy5faWNlQ2FuZGlkYXRlcyA9IFtdO1xuICAgICAgICB0aGlzLl9pY2VDYW5kaWRhdGVGb3VuZGF0aW9uc01hcCA9IHt9O1xuICAgICAgICB0aGlzLl9tTGluZXMgPSBtTGluZXM7XG4gICAgfVxuICAgIG9uRW50ZXIoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgc2VsZi5fc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoc2VsZi5faXNDdXJyZW50U3RhdGUoKSAmJiAhc2VsZi5faWNlQ29tcGxldGVkKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5sb2dnZXIud2FybignSUNFIGNvbGxlY3Rpb24gdGltZWQgb3V0Jyk7XG4gICAgICAgICAgICAgICAgc2VsZi5fcmVwb3J0SWNlQ29tcGxldGVkKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBzZWxmLl9ydGNTZXNzaW9uLl9pY2VUaW1lb3V0TWlsbGlzKTtcbiAgICAgICAgc2VsZi5fcnRjU2Vzc2lvbi5fY3JlYXRlU2lnbmFsaW5nQ2hhbm5lbCgpLmNvbm5lY3QoKTtcbiAgICB9XG4gICAgb25TaWduYWxpbmdDb25uZWN0ZWQoKSB7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3NpZ25hbGxpbmdDb25uZWN0VGltZXN0YW1wID0gRGF0ZS5ub3coKTtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5zaWduYWxsaW5nQ29ubmVjdFRpbWVNaWxsaXMgPSB0aGlzLl9ydGNTZXNzaW9uLl9zaWduYWxsaW5nQ29ubmVjdFRpbWVzdGFtcCAtIHRoaXMuX3N0YXJ0VGltZTtcbiAgICAgICAgdGhpcy5fc2lnbmFsaW5nQ29ubmVjdGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fb25TaWduYWxpbmdDb25uZWN0ZWQodGhpcy5fcnRjU2Vzc2lvbik7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuc2lnbmFsbGluZ0Nvbm5lY3Rpb25GYWlsdXJlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2NoZWNrQW5kVHJhbnNpdCgpO1xuICAgIH1cbiAgICBvblNpZ25hbGluZ0ZhaWxlZChlKSB7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuc2lnbmFsbGluZ0Nvbm5lY3RUaW1lTWlsbGlzID0gRGF0ZS5ub3coKSAtIHRoaXMuX3N0YXJ0VGltZTtcbiAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoJ0ZhaWxlZCBjb25uZWN0aW5nIHRvIHNpZ25hbGluZyBzZXJ2ZXInLCBlKTtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5zaWduYWxsaW5nQ29ubmVjdGlvbkZhaWx1cmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnRyYW5zaXQobmV3IEZhaWxlZFN0YXRlKHRoaXMuX3J0Y1Nlc3Npb24sIFJUQ19FUlJPUlMuU0lHTkFMTElOR19DT05ORUNUSU9OX0ZBSUxVUkUpKTtcbiAgICB9XG4gICAgX2NyZWF0ZUxvY2FsQ2FuZGlkYXRlKGluaXREaWN0KSB7XG4gICAgICAgIHJldHVybiBuZXcgUlRDSWNlQ2FuZGlkYXRlKGluaXREaWN0KTtcbiAgICB9XG4gICAgb25JY2VDYW5kaWRhdGUoZXZ0KSB7XG4gICAgICAgIHZhciBjYW5kaWRhdGUgPSBldnQuY2FuZGlkYXRlO1xuICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ29uaWNlY2FuZGlkYXRlICcgKyBKU09OLnN0cmluZ2lmeShjYW5kaWRhdGUpKTtcbiAgICAgICAgaWYgKGNhbmRpZGF0ZSkge1xuICAgICAgICAgICAgaWYgKGNhbmRpZGF0ZS5jYW5kaWRhdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pY2VDYW5kaWRhdGVzLnB1c2godGhpcy5fY3JlYXRlTG9jYWxDYW5kaWRhdGUoY2FuZGlkYXRlKSk7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pY2VDb21wbGV0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tDYW5kaWRhdGVzU3VmZmljaWVudChjYW5kaWRhdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fcmVwb3J0SWNlQ29tcGxldGVkKGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfY2hlY2tDYW5kaWRhdGVzU3VmZmljaWVudChjYW5kaWRhdGUpIHtcbiAgICAgICAgLy9jaGVjayBpZiB3ZSBjb2xsZWN0ZWQgc3VmZmljaWVudCBjYW5kaWRhdGVzIGZyb20gc2luZ2xlIG1lZGlhIHNlcnZlciB0byBzdGFydCB0aGUgY2FsbFxuICAgICAgICB2YXIgY2FuZGlkYXRlT2JqID0gcGFyc2VDYW5kaWRhdGUoY2FuZGlkYXRlLmNhbmRpZGF0ZSk7XG4gICAgICAgIGlmIChjYW5kaWRhdGVPYmouY29tcG9uZW50ICE9IDEpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2FuZGlkYXRlRm91bmRhdGlvbiA9IGNhbmRpZGF0ZU9iai5mb3VuZGF0aW9uO1xuICAgICAgICB2YXIgY2FuZGlkYXRlTUxpbmVJbmRleCA9IGNhbmRpZGF0ZS5zZHBNTGluZUluZGV4O1xuICAgICAgICBpZiAoY2FuZGlkYXRlRm91bmRhdGlvbiAmJiBjYW5kaWRhdGVNTGluZUluZGV4ID49IDAgJiYgY2FuZGlkYXRlTUxpbmVJbmRleCA8IHRoaXMuX21MaW5lcykge1xuICAgICAgICAgICAgdmFyIG1JbmRleExpc3QgPSB0aGlzLl9pY2VDYW5kaWRhdGVGb3VuZGF0aW9uc01hcFtjYW5kaWRhdGVGb3VuZGF0aW9uXSB8fCBbXTtcbiAgICAgICAgICAgIGlmICghbUluZGV4TGlzdC5pbmNsdWRlcyhjYW5kaWRhdGVNTGluZUluZGV4KSkge1xuICAgICAgICAgICAgICAgIG1JbmRleExpc3QucHVzaChjYW5kaWRhdGVNTGluZUluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2ljZUNhbmRpZGF0ZUZvdW5kYXRpb25zTWFwW2NhbmRpZGF0ZUZvdW5kYXRpb25dID0gbUluZGV4TGlzdDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX21MaW5lcyA9PSBtSW5kZXhMaXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlcG9ydEljZUNvbXBsZXRlZChmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgX3JlcG9ydEljZUNvbXBsZXRlZChpc1RpbWVvdXQpIHtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5pY2VDb2xsZWN0aW9uVGltZU1pbGxpcyA9IERhdGUubm93KCkgLSB0aGlzLl9zdGFydFRpbWU7XG4gICAgICAgIHRoaXMuX2ljZUNvbXBsZXRlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX29uSWNlQ29sbGVjdGlvbkNvbXBsZXRlKHRoaXMuX3J0Y1Nlc3Npb24sIGlzVGltZW91dCwgdGhpcy5faWNlQ2FuZGlkYXRlcy5sZW5ndGgpO1xuICAgICAgICBpZiAodGhpcy5faWNlQ2FuZGlkYXRlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LmljZUNvbGxlY3Rpb25GYWlsdXJlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9jaGVja0FuZFRyYW5zaXQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKCdObyBJQ0UgY2FuZGlkYXRlJyk7XG4gICAgICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LmljZUNvbGxlY3Rpb25GYWlsdXJlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUodGhpcy5fcnRjU2Vzc2lvbiwgUlRDX0VSUk9SUy5JQ0VfQ09MTEVDVElPTl9USU1FT1VUKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2NoZWNrQW5kVHJhbnNpdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2ljZUNvbXBsZXRlZCAmJiB0aGlzLl9zaWduYWxpbmdDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMudHJhbnNpdChuZXcgSW52aXRlQW5zd2VyU3RhdGUodGhpcy5fcnRjU2Vzc2lvbiwgdGhpcy5faWNlQ2FuZGlkYXRlcykpO1xuICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLl9pY2VDb21wbGV0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmxvZygnUGVuZGluZyBJQ0UgY29sbGVjdGlvbicpO1xuICAgICAgICB9IGVsc2Ugey8vaW1wbGllcyBfc2lnbmFsaW5nQ29ubmVjdGVkID09IGZhbHNlXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ1BlbmRpbmcgc2lnbmFsaW5nIGNvbm5lY3Rpb24nKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiQ29ubmVjdFNpZ25hbGluZ0FuZEljZUNvbGxlY3Rpb25TdGF0ZVwiO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEludml0ZUFuc3dlclN0YXRlIGV4dGVuZHMgUlRDU2Vzc2lvblN0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcihydGNTZXNzaW9uLCBpY2VDYW5kaWRhdGVzKSB7XG4gICAgICAgIHN1cGVyKHJ0Y1Nlc3Npb24pO1xuICAgICAgICB0aGlzLl9pY2VDYW5kaWRhdGVzID0gaWNlQ2FuZGlkYXRlcztcbiAgICB9XG4gICAgb25FbnRlcigpIHtcbiAgICAgICAgdmFyIHJ0Y1Nlc3Npb24gPSB0aGlzLl9ydGNTZXNzaW9uO1xuICAgICAgICBydGNTZXNzaW9uLl9vblNpZ25hbGluZ1N0YXJ0ZWQocnRjU2Vzc2lvbik7XG4gICAgICAgIHJ0Y1Nlc3Npb24uX3NpZ25hbGluZ0NoYW5uZWwuaW52aXRlKHJ0Y1Nlc3Npb24uX2xvY2FsU2Vzc2lvbkRlc2NyaXB0aW9uLnNkcCxcbiAgICAgICAgICAgIHRoaXMuX2ljZUNhbmRpZGF0ZXMpO1xuICAgIH1cbiAgICBvblNpZ25hbGluZ0Fuc3dlcmVkKHNkcCwgY2FuZGlkYXRlcykge1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LnVzZXJCdXN5RmFpbHVyZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LmhhbmRzaGFraW5nRmFpbHVyZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnRyYW5zaXQobmV3IEFjY2VwdFN0YXRlKHRoaXMuX3J0Y1Nlc3Npb24sIHNkcCwgY2FuZGlkYXRlcykpO1xuICAgIH1cbiAgICBvblNpZ25hbGluZ0ZhaWxlZChlKSB7XG4gICAgICAgIHZhciByZWFzb247XG4gICAgICAgIGlmIChlLm5hbWUgPT0gQnVzeUV4Y2VwdGlvbk5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKCdVc2VyIEJ1c3ksIHBvc3NpYmx5IG11bHRpcGxlIENDUCB3aW5kb3dzIG9wZW4nLCBlKTtcbiAgICAgICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQudXNlckJ1c3lGYWlsdXJlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuaGFuZHNoYWtpbmdGYWlsdXJlID0gdHJ1ZTtcbiAgICAgICAgICAgIHJlYXNvbiA9IFJUQ19FUlJPUlMuVVNFUl9CVVNZO1xuICAgICAgICB9IGVsc2UgaWYgKGUubmFtZSA9PSBDYWxsTm90Rm91bmRFeGNlcHRpb25OYW1lKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcignQ2FsbCBub3QgZm91bmQuIE9uZSBvZiB0aGUgcGFydGljaXBhbnQgcHJvYmFibHkgaHVuZ3VwLicsIGUpO1xuICAgICAgICAgICAgcmVhc29uID0gUlRDX0VSUk9SUy5DQUxMX05PVF9GT1VORDtcbiAgICAgICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuaGFuZHNoYWtpbmdGYWlsdXJlID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKCdGYWlsZWQgaGFuZHNoYWtpbmcgd2l0aCBzaWduYWxpbmcgc2VydmVyJywgZSk7XG4gICAgICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LnVzZXJCdXN5RmFpbHVyZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5oYW5kc2hha2luZ0ZhaWx1cmUgPSB0cnVlO1xuICAgICAgICAgICAgcmVhc29uID0gUlRDX0VSUk9SUy5TSUdOQUxMSU5HX0hBTkRTSEFLRV9GQUlMVVJFO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUodGhpcy5fcnRjU2Vzc2lvbiwgcmVhc29uKSk7XG4gICAgfVxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJJbnZpdGVBbnN3ZXJTdGF0ZVwiO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBBY2NlcHRTdGF0ZSBleHRlbmRzIFJUQ1Nlc3Npb25TdGF0ZSB7XG4gICAgY29uc3RydWN0b3IocnRjU2Vzc2lvbiwgc2RwLCBjYW5kaWRhdGVzKSB7XG4gICAgICAgIHN1cGVyKHJ0Y1Nlc3Npb24pO1xuICAgICAgICB0aGlzLl9zZHAgPSBzZHA7XG4gICAgICAgIHRoaXMuX2NhbmRpZGF0ZXMgPSBjYW5kaWRhdGVzO1xuICAgIH1cbiAgICBfY3JlYXRlU2Vzc2lvbkRlc2NyaXB0aW9uKGluaXREaWN0KSB7XG4gICAgICAgIHJldHVybiBuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKGluaXREaWN0KTtcbiAgICB9XG4gICAgX2NyZWF0ZVJlbW90ZUNhbmRpZGF0ZShpbml0RGljdCkge1xuICAgICAgICByZXR1cm4gbmV3IFJUQ0ljZUNhbmRpZGF0ZShpbml0RGljdCk7XG4gICAgfVxuICAgIG9uRW50ZXIoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIHJ0Y1Nlc3Npb24gPSBzZWxmLl9ydGNTZXNzaW9uO1xuXG4gICAgICAgIGlmICghc2VsZi5fc2RwKSB7XG4gICAgICAgICAgICBzZWxmLmxvZ2dlci5lcnJvcignSW52YWxpZCByZW1vdGUgU0RQJyk7XG4gICAgICAgICAgICBydGNTZXNzaW9uLl9zdG9wU2Vzc2lvbigpO1xuICAgICAgICAgICAgcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5pbnZhbGlkUmVtb3RlU0RQRmFpbHVyZSA9IHRydWU7XG4gICAgICAgICAgICBzZWxmLnRyYW5zaXQobmV3IEZhaWxlZFN0YXRlKHJ0Y1Nlc3Npb24sIFJUQ19FUlJPUlMuSU5WQUxJRF9SRU1PVEVfU0RQKSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSBpZiAoIXNlbGYuX2NhbmRpZGF0ZXMgfHwgc2VsZi5fY2FuZGlkYXRlcy5sZW5ndGggPCAxKSB7XG4gICAgICAgICAgICBzZWxmLmxvZ2dlci5lcnJvcignTm8gcmVtb3RlIElDRSBjYW5kaWRhdGUnKTtcbiAgICAgICAgICAgIHJ0Y1Nlc3Npb24uX3N0b3BTZXNzaW9uKCk7XG4gICAgICAgICAgICBydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0Lm5vUmVtb3RlSWNlQ2FuZGlkYXRlRmFpbHVyZSA9IHRydWU7XG4gICAgICAgICAgICBzZWxmLnRyYW5zaXQobmV3IEZhaWxlZFN0YXRlKHJ0Y1Nlc3Npb24sIFJUQ19FUlJPUlMuTk9fUkVNT1RFX0lDRV9DQU5ESURBVEUpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJ0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuaW52YWxpZFJlbW90ZVNEUEZhaWx1cmUgPSBmYWxzZTtcbiAgICAgICAgcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5ub1JlbW90ZUljZUNhbmRpZGF0ZUZhaWx1cmUgPSBmYWxzZTtcbiAgICAgICAgc2VsZi5fcnRjU2Vzc2lvbi5fc3RyYXRlZ3kuc2V0UmVtb3RlRGVzY3JpcHRpb24oc2VsZiwgcnRjU2Vzc2lvbik7XG4gICAgfVxuICAgIG9uU2lnbmFsaW5nSGFuZHNoYWtlZCgpIHtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5oYW5kc2hha2luZ1RpbWVNaWxsaXMgPSBEYXRlLm5vdygpIC0gdGhpcy5fcnRjU2Vzc2lvbi5fc2lnbmFsbGluZ0Nvbm5lY3RUaW1lc3RhbXA7XG4gICAgICAgIHRoaXMuX3NpZ25hbGluZ0hhbmRzaGFrZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLl9jaGVja0FuZFRyYW5zaXQoKTtcbiAgICB9XG4gICAgX2NoZWNrQW5kVHJhbnNpdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3NpZ25hbGluZ0hhbmRzaGFrZWQgJiYgdGhpcy5fcmVtb3RlRGVzY3JpcHRpb25TZXQpIHtcbiAgICAgICAgICAgIHRoaXMudHJhbnNpdChuZXcgVGFsa2luZ1N0YXRlKHRoaXMuX3J0Y1Nlc3Npb24pKTtcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5fc2lnbmFsaW5nSGFuZHNoYWtlZCkge1xuICAgICAgICAgICAgdGhpcy5sb2dnZXIubG9nKCdQZW5kaW5nIGhhbmRzaGFraW5nJyk7XG4gICAgICAgIH0gZWxzZSB7Ly9pbXBsaWVzIF9yZW1vdGVEZXNjcmlwdGlvblNldCA9PSBmYWxzZVxuICAgICAgICAgICAgdGhpcy5sb2dnZXIubG9nKCdQZW5kaW5nIHNldHRpbmcgcmVtb3RlIGRlc2NyaXB0aW9uJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIkFjY2VwdFN0YXRlXCI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFRhbGtpbmdTdGF0ZSBleHRlbmRzIFJUQ1Nlc3Npb25TdGF0ZSB7XG5cbiAgICBvbkVudGVyKCkge1xuICAgICAgICB0aGlzLl9zdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LnByZVRhbGtpbmdUaW1lTWlsbGlzID0gdGhpcy5fc3RhcnRUaW1lIC0gdGhpcy5fcnRjU2Vzc2lvbi5fY29ubmVjdFRpbWVTdGFtcDtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fb25TZXNzaW9uQ29ubmVjdGVkKHRoaXMuX3J0Y1Nlc3Npb24pO1xuICAgIH1cbiAgICBvblNpZ25hbGluZ1JlY29ubmVjdGVkKCkge1xuICAgIH1cbiAgICBvblJlbW90ZUh1bmd1cCgpIHtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2lnbmFsaW5nQ2hhbm5lbC5oYW5ndXAoKTtcbiAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBEaXNjb25uZWN0ZWRTdGF0ZSh0aGlzLl9ydGNTZXNzaW9uKSk7XG4gICAgfVxuICAgIGhhbmd1cCgpIHtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2lnbmFsaW5nQ2hhbm5lbC5oYW5ndXAoKTtcbiAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBEaXNjb25uZWN0ZWRTdGF0ZSh0aGlzLl9ydGNTZXNzaW9uKSk7XG4gICAgfVxuICAgIG9uSWNlU3RhdGVDaGFuZ2UoZXZ0KSB7XG4gICAgICAgIHZhciBpY2VTdGF0ZSA9IHRoaXMuX3J0Y1Nlc3Npb24uX3N0cmF0ZWd5Lm9uSWNlU3RhdGVDaGFuZ2UoZXZ0LCB0aGlzLl9ydGNTZXNzaW9uLl9wYyk7XG4gICAgICAgIHRoaXMubG9nZ2VyLmluZm8oJ0lDRSBDb25uZWN0aW9uIFN0YXRlOiAnLCBpY2VTdGF0ZSk7XG5cbiAgICAgICAgaWYgKGljZVN0YXRlID09IElDRV9DT05ORUNUSU9OX1NUQVRFLkRJU0NPTk5FQ1RFRCkge1xuICAgICAgICAgICAgdGhpcy5sb2dnZXIuaW5mbygnTG9zdCBJQ0UgY29ubmVjdGlvbicpO1xuICAgICAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5pY2VDb25uZWN0aW9uc0xvc3QgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaWNlU3RhdGUgPT0gSUNFX0NPTk5FQ1RJT05fU1RBVEUuRkFJTEVEKSB7XG4gICAgICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LmljZUNvbm5lY3Rpb25zRmFpbGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uUGVlckNvbm5lY3Rpb25TdGF0ZUNoYW5nZSgpIHtcbiAgICAgICAgdmFyIHBlZXJDb25uZWN0aW9uU3RhdGUgPSB0aGlzLl9ydGNTZXNzaW9uLl9zdHJhdGVneS5vblBlZXJDb25uZWN0aW9uU3RhdGVDaGFuZ2UodGhpcy5fcnRjU2Vzc2lvbi5fcGMpO1xuICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKCdQZWVyIENvbm5lY3Rpb24gU3RhdGU6ICcsIHBlZXJDb25uZWN0aW9uU3RhdGUpO1xuXG4gICAgICAgIGlmIChwZWVyQ29ubmVjdGlvblN0YXRlID09IFBFRVJfQ09OTkVDVElPTl9TVEFURS5GQUlMRUQpIHtcbiAgICAgICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQucGVlckNvbm5lY3Rpb25GYWlsZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25FeGl0KCkge1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LnRhbGtpbmdUaW1lTWlsbGlzID0gRGF0ZS5ub3coKSAtIHRoaXMuX3N0YXJ0VGltZTtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fZGV0YWNoTWVkaWEoKTtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5zZXNzaW9uRW5kVGltZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX29uU2Vzc2lvbkNvbXBsZXRlZCh0aGlzLl9ydGNTZXNzaW9uKTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIlRhbGtpbmdTdGF0ZVwiO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBDbGVhblVwU3RhdGUgZXh0ZW5kcyBSVENTZXNzaW9uU3RhdGUge1xuICAgIG9uRW50ZXIoKSB7XG4gICAgICAgIHRoaXMuX3N0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3N0b3BTZXNzaW9uKCk7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuY2xlYW51cFRpbWVNaWxsaXMgPSBEYXRlLm5vdygpIC0gdGhpcy5fc3RhcnRUaW1lO1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9vblNlc3Npb25EZXN0cm95ZWQodGhpcy5fcnRjU2Vzc2lvbiwgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydCk7XG4gICAgfVxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJDbGVhblVwU3RhdGVcIjtcbiAgICB9XG4gICAgaGFuZ3VwKCkge1xuICAgICAgICAvL2RvIG5vdGhpbmcsIGFscmVhZHkgYXQgdGhlIGVuZCBvZiBsaWZlY3ljbGVcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgRGlzY29ubmVjdGVkU3RhdGUgZXh0ZW5kcyBDbGVhblVwU3RhdGUge1xuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJEaXNjb25uZWN0ZWRTdGF0ZVwiO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBGYWlsZWRTdGF0ZSBleHRlbmRzIENsZWFuVXBTdGF0ZSB7XG4gICAgY29uc3RydWN0b3IocnRjU2Vzc2lvbiwgZmFpbHVyZVJlYXNvbikge1xuICAgICAgICBzdXBlcihydGNTZXNzaW9uKTtcbiAgICAgICAgdGhpcy5fZmFpbHVyZVJlYXNvbiA9IGZhaWx1cmVSZWFzb247XG4gICAgfVxuICAgIG9uRW50ZXIoKSB7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuc2Vzc2lvbkVuZFRpbWUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9vblNlc3Npb25GYWlsZWQodGhpcy5fcnRjU2Vzc2lvbiwgdGhpcy5fZmFpbHVyZVJlYXNvbik7XG4gICAgICAgIHN1cGVyLm9uRW50ZXIoKTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIkZhaWxlZFN0YXRlXCI7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSdGNTZXNzaW9uIHtcbiAgICAvKipcbiAgICAgKiBCdWlsZCBhbiBBbWF6b25Db25uZWN0IFJUQyBzZXNzaW9uLlxuICAgICAqIEBwYXJhbSB7Kn0gc2lnbmFsaW5nVXJpXG4gICAgICogQHBhcmFtIHsqfSBpY2VTZXJ2ZXJzIEFycmF5IG9mIGljZSBzZXJ2ZXJzXG4gICAgICogQHBhcmFtIHsqfSBjb250YWN0VG9rZW4gQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBjb250YWN0IHRva2VuIChvcHRpb25hbClcbiAgICAgKiBAcGFyYW0geyp9IGxvZ2dlciBBbiBvYmplY3QgcHJvdmlkZXMgbG9nZ2luZyBmdW5jdGlvbnMsIHN1Y2ggYXMgY29uc29sZVxuICAgICAqIEBwYXJhbSB7Kn0gY29udGFjdElkIE11c3QgYmUgVVVJRCwgdW5pcXVlbHkgaWRlbnRpZmllcyB0aGUgc2Vzc2lvbi5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzaWduYWxpbmdVcmksIGljZVNlcnZlcnMsIGNvbnRhY3RUb2tlbiwgbG9nZ2VyLCBjb250YWN0SWQsIGNvbm5lY3Rpb25JZCwgd3NzTWFuYWdlciwgc3RyYXRlZ3kgPSBuZXcgU3RhbmRhcmRTdHJhdGVneSgpKSB7XG4gICAgICAgIGlmICghKHN0cmF0ZWd5IGluc3RhbmNlb2YgQ0NQSW5pdGlhdGlvblN0cmF0ZWd5SW50ZXJmYWNlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3RlZCBhIHN0cmF0ZWd5IG9mIHR5cGUgQ0NQSW5pdGlhdGlvblN0cmF0ZWd5SW50ZXJmYWNlJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBzaWduYWxpbmdVcmkgIT09ICdzdHJpbmcnIHx8IHNpZ25hbGluZ1VyaS50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFBhcmFtZXRlcnMoJ3NpZ25hbGluZ1VyaSByZXF1aXJlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaWNlU2VydmVycykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxQYXJhbWV0ZXJzKCdpY2VTZXJ2ZXJzIHJlcXVpcmVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBsb2dnZXIgIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFBhcmFtZXRlcnMoJ2xvZ2dlciByZXF1aXJlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY29udGFjdElkKSB7XG4gICAgICAgICAgICB0aGlzLl9jYWxsSWQgPSB1dWlkKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9jYWxsSWQgPSBjb250YWN0SWQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc3RyYXRlZ3kgPSBzdHJhdGVneTtcbiAgICAgICAgdGhpcy5fY29ubmVjdGlvbklkID0gY29ubmVjdGlvbklkO1xuICAgICAgICB0aGlzLl93c3NNYW5hZ2VyID0gd3NzTWFuYWdlcjtcbiAgICAgICAgdGhpcy5fc2Vzc2lvblJlcG9ydCA9IG5ldyBTZXNzaW9uUmVwb3J0KCk7XG4gICAgICAgIHRoaXMuX3NpZ25hbGluZ1VyaSA9IHNpZ25hbGluZ1VyaTtcbiAgICAgICAgdGhpcy5faWNlU2VydmVycyA9IGljZVNlcnZlcnM7XG4gICAgICAgIHRoaXMuX2NvbnRhY3RUb2tlbiA9IGNvbnRhY3RUb2tlbjtcbiAgICAgICAgdGhpcy5fb3JpZ2luYWxMb2dnZXIgPSBsb2dnZXI7XG4gICAgICAgIHRoaXMuX2xvZ2dlciA9IHdyYXBMb2dnZXIodGhpcy5fb3JpZ2luYWxMb2dnZXIsIHRoaXMuX2NhbGxJZCwgJ1NFU1NJT04nKTtcbiAgICAgICAgdGhpcy5faWNlVGltZW91dE1pbGxpcyA9IERFRkFVTFRfSUNFX1RJTUVPVVRfTVM7XG4gICAgICAgIHRoaXMuX2d1bVRpbWVvdXRNaWxsaXMgPSBERUZBVUxUX0dVTV9USU1FT1VUX01TO1xuXG4gICAgICAgIHRoaXMuX2VuYWJsZUF1ZGlvID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fZW5hYmxlVmlkZW8gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fZmFjaW5nTW9kZSA9ICd1c2VyJztcbiAgICAgICAgdGhpcy5fbGVnYWN5U3RhdHNSZXBvcnRTdXBwb3J0ID0gZmFsc2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiB1c2VyIG1heSBwcm92aWRlIHRoZSBzdHJlYW0gdG8gdGhlIFJ0Y1Nlc3Npb24gZGlyZWN0bHkgdG8gY29ubmVjdCB0byB0aGUgb3RoZXIgZW5kLlxuICAgICAgICAgKiB1c2VyIG1heSBhbHNvIGFjcXVpcmUgdGhlIHN0cmVhbSBmcm9tIHRoZSBsb2NhbCBkZXZpY2UuXG4gICAgICAgICAqIFRoaXMgZmxhZyBpcyB1c2VkIHRvIHRyYWNrIHdoZXJlIHRoZSBzdHJlYW0gaXMgYWNxdWlyZWQuXG4gICAgICAgICAqIElmIGl0J3MgYWNxdWlyZWQgZnJvbSBsb2NhbCBkZXZpY2VzLCB0aGVuIHdlIG11c3QgY2xvc2UgdGhlIHN0cmVhbSB3aGVuIHRoZSBzZXNzaW9uIGVuZHMuXG4gICAgICAgICAqIElmIGl0J3MgcHJvdmlkZWQgYnkgdXNlciAocmF0aGVyIHRoYW4gbG9jYWwgY2FtZXJhL21pY3JvcGhvbmUpLCB0aGVuIHdlIHNob3VsZCBsZWF2ZSBpdCBvcGVuIHdoZW4gdGhlXG4gICAgICAgICAqIHNlc3Npb24gZW5kcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2lzVXNlclByb3ZpZGVkU3RyZWFtID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5fb25HdW1FcnJvciA9XG4gICAgICAgIHRoaXMuX29uR3VtU3VjY2VzcyA9XG4gICAgICAgIHRoaXMuX29uTG9jYWxTdHJlYW1BZGRlZCA9XG4gICAgICAgIHRoaXMuX29uU2Vzc2lvbkZhaWxlZCA9XG4gICAgICAgIHRoaXMuX29uU2Vzc2lvbkluaXRpYWxpemVkID1cbiAgICAgICAgdGhpcy5fb25TaWduYWxpbmdDb25uZWN0ZWQgPVxuICAgICAgICB0aGlzLl9vbkljZUNvbGxlY3Rpb25Db21wbGV0ZSA9XG4gICAgICAgIHRoaXMuX29uU2lnbmFsaW5nU3RhcnRlZCA9XG4gICAgICAgIHRoaXMuX29uU2Vzc2lvbkNvbm5lY3RlZCA9XG4gICAgICAgIHRoaXMuX29uUmVtb3RlU3RyZWFtQWRkZWQgPVxuICAgICAgICB0aGlzLl9vblNlc3Npb25Db21wbGV0ZWQgPVxuICAgICAgICB0aGlzLl9vblNlc3Npb25EZXN0cm95ZWQgPSAoKSA9PiB7XG4gICAgICAgIH07XG4gICAgfVxuICAgIGdldCBzZXNzaW9uUmVwb3J0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2Vzc2lvblJlcG9ydDtcbiAgICB9XG4gICAgZ2V0IGNhbGxJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhbGxJZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogZ2V0TWVkaWFTdHJlYW0gcmV0dXJucyB0aGUgbG9jYWwgc3RyZWFtLCB3aGljaCBtYXkgYmUgYWNxdWlyZWQgZnJvbSBsb2NhbCBkZXZpY2Ugb3IgZnJvbSB1c2VyIHByb3ZpZGVkIHN0cmVhbS5cbiAgICAgKiBSYXRoZXIgdGhhbiBnZXR0aW5nIGEgc3RyZWFtIGJ5IGNhbGxpbmcgZ2V0VXNlck1lZGlhICh3aGljaCBnZXRzIGEgc3RyZWFtIGZyb20gbG9jYWwgZGV2aWNlIHN1Y2ggYXMgY2FtZXJhKSxcbiAgICAgKiB1c2VyIGNvdWxkIGFsc28gcHJvdmlkZSB0aGUgc3RyZWFtIHRvIHRoZSBSdGNTZXNzaW9uIGRpcmVjdGx5IHRvIGNvbm5lY3QgdG8gdGhlIG90aGVyIGVuZC5cbiAgICAgKi9cbiAgICBnZXQgbWVkaWFTdHJlYW0oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sb2NhbFN0cmVhbTtcbiAgICB9XG4gICAgZ2V0IHJlbW90ZVZpZGVvU3RyZWFtKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVtb3RlVmlkZW9TdHJlYW07XG4gICAgfVxuICAgIHBhdXNlTG9jYWxWaWRlbygpIHtcbiAgICAgICAgaWYodGhpcy5fbG9jYWxTdHJlYW0pIHtcbiAgICAgICAgICAgIHZhciB2aWRlb1RyYWNrID0gdGhpcy5fbG9jYWxTdHJlYW0uZ2V0VmlkZW9UcmFja3MoKVswXTtcbiAgICAgICAgICAgIGlmKHZpZGVvVHJhY2spIHtcbiAgICAgICAgICAgICAgICB2aWRlb1RyYWNrLmVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXN1bWVMb2NhbFZpZGVvKCkge1xuICAgICAgICBpZih0aGlzLl9sb2NhbFN0cmVhbSkge1xuICAgICAgICAgICAgdmFyIHZpZGVvVHJhY2sgPSB0aGlzLl9sb2NhbFN0cmVhbS5nZXRWaWRlb1RyYWNrcygpWzBdO1xuICAgICAgICAgICAgaWYodmlkZW9UcmFjaykge1xuICAgICAgICAgICAgICAgIHZpZGVvVHJhY2suZW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcGF1c2VSZW1vdGVWaWRlbygpIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlbW90ZVZpZGVvU3RyZWFtKSB7XG4gICAgICAgICAgICB2YXIgdmlkZW9UcmFjayA9IHRoaXMuX3JlbW90ZVZpZGVvU3RyZWFtLmdldFRyYWNrcygpWzFdO1xuICAgICAgICAgICAgaWYodmlkZW9UcmFjaykge1xuICAgICAgICAgICAgICAgIHZpZGVvVHJhY2suZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJlc3VtZVJlbW90ZVZpZGVvKCkge1xuICAgICAgICBpZiAodGhpcy5fcmVtb3RlVmlkZW9TdHJlYW0pIHtcbiAgICAgICAgICAgIHZhciB2aWRlb1RyYWNrID0gdGhpcy5fcmVtb3RlVmlkZW9TdHJlYW0uZ2V0VHJhY2tzKClbMV07XG4gICAgICAgICAgICBpZih2aWRlb1RyYWNrKSB7XG4gICAgICAgICAgICAgICAgdmlkZW9UcmFjay5lbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwYXVzZUxvY2FsQXVkaW8oKSB7XG4gICAgICAgIGlmICh0aGlzLl9sb2NhbFN0cmVhbSkge1xuICAgICAgICAgICAgdmFyIGF1ZGlvVHJhY2sgPSB0aGlzLl9sb2NhbFN0cmVhbS5nZXRBdWRpb1RyYWNrcygpWzBdO1xuICAgICAgICAgICAgaWYoYXVkaW9UcmFjaykge1xuICAgICAgICAgICAgICAgIGF1ZGlvVHJhY2suZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJlc3VtZUxvY2FsQXVkaW8oKSB7XG4gICAgICAgIGlmICh0aGlzLl9sb2NhbFN0cmVhbSkge1xuICAgICAgICAgICAgdmFyIGF1ZGlvVHJhY2sgPSB0aGlzLl9sb2NhbFN0cmVhbS5nZXRBdWRpb1RyYWNrcygpWzBdO1xuICAgICAgICAgICAgaWYoYXVkaW9UcmFjaykge1xuICAgICAgICAgICAgICAgIGF1ZGlvVHJhY2suZW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcGF1c2VSZW1vdGVBdWRpbygpIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlbW90ZUF1ZGlvU3RyZWFtKSB7XG4gICAgICAgICAgICB2YXIgYXVkaW9UcmFjayA9IHRoaXMuX3JlbW90ZUF1ZGlvU3RyZWFtLmdldFRyYWNrcygpWzBdO1xuICAgICAgICAgICAgaWYoYXVkaW9UcmFjaykge1xuICAgICAgICAgICAgICAgIGF1ZGlvVHJhY2suZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJlc3VtZVJlbW90ZUF1ZGlvKCkge1xuICAgICAgICBpZiAodGhpcy5fcmVtb3RlQXVkaW9TdHJlYW0pIHtcbiAgICAgICAgICAgIHZhciBhdWRpb1RyYWNrID0gdGhpcy5fcmVtb3RlQXVkaW9TdHJlYW0uZ2V0VHJhY2tzKClbMF07XG4gICAgICAgICAgICBpZihhdWRpb1RyYWNrKSB7XG4gICAgICAgICAgICAgICAgYXVkaW9UcmFjay5lbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsYmFjayB3aGVuIGdVTSBzdWNjZWVkcy5cbiAgICAgKiBGaXJzdCBwYXJhbSBpcyBSdGNTZXNzaW9uIG9iamVjdC5cbiAgICAgKi9cbiAgICBzZXQgb25HdW1TdWNjZXNzKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fb25HdW1TdWNjZXNzID0gaGFuZGxlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGJhY2sgd2hlbiBnVU0gZmFpbHMuXG4gICAgICogRmlyc3QgcGFyYW0gaXMgUnRjU2Vzc2lvbiBvYmplY3QuXG4gICAgICogU2Vjb25kIHBhcmFtIGlzIHRoZSBlcnJvci5cbiAgICAgKi9cbiAgICBzZXQgb25HdW1FcnJvcihoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX29uR3VtRXJyb3IgPSBoYW5kbGVyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsYmFjayBpZiBmYWlsZWQgaW5pdGlhbGl6aW5nIGxvY2FsIHJlc291cmNlc1xuICAgICAqIEZpcnN0IHBhcmFtIGlzIFJ0Y1Nlc3Npb24gb2JqZWN0LlxuICAgICAqL1xuICAgIHNldCBvblNlc3Npb25GYWlsZWQoaGFuZGxlcikge1xuICAgICAgICB0aGlzLl9vblNlc3Npb25GYWlsZWQgPSBoYW5kbGVyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsYmFjayBhZnRlciBsb2NhbCB1c2VyIG1lZGlhIHN0cmVhbSBpcyBhZGRlZCB0byB0aGUgc2Vzc2lvbi5cbiAgICAgKiBGaXJzdCBwYXJhbSBpcyBSdGNTZXNzaW9uIG9iamVjdC5cbiAgICAgKiBTZWNvbmQgcGFyYW0gaXMgbWVkaWEgc3RyZWFtXG4gICAgICovXG4gICAgc2V0IG9uTG9jYWxTdHJlYW1BZGRlZChoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX29uTG9jYWxTdHJlYW1BZGRlZCA9IGhhbmRsZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIHdoZW4gYWxsIGxvY2FsIHJlc291cmNlcyBhcmUgcmVhZHkuIEVzdGFibGlzaGluZyBzaWduYWxpbmcgY2hhbmVsIGFuZCBJQ0UgY29sbGVjdGlvbiBoYXBwZW5zIGF0IHRoZSBzYW1lIHRpbWUgYWZ0ZXIgdGhpcy5cbiAgICAgKiBGaXJzdCBwYXJhbSBpcyBSdGNTZXNzaW9uIG9iamVjdC5cbiAgICAgKi9cbiAgICBzZXQgb25TZXNzaW9uSW5pdGlhbGl6ZWQoaGFuZGxlcikge1xuICAgICAgICB0aGlzLl9vblNlc3Npb25Jbml0aWFsaXplZCA9IGhhbmRsZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIHdoZW4gc2lnbmFsaW5nIGNoYW5uZWwgaXMgZXN0YWJsaXNoZWQuXG4gICAgICogUlRDIHNlc3Npb24gd2lsbCBtb3ZlIGZvcndhcmQgb25seSBpZiBvblNpZ25hbGluZ0Nvbm5lY3RlZCBhbmQgb25JY2VDb2xsZWN0aW9uQ29tcGxldGUgYXJlIGJvdGggY2FsbGVkLlxuICAgICAqXG4gICAgICogRmlyc3QgcGFyYW0gaXMgUnRjU2Vzc2lvbiBvYmplY3QuXG4gICAgICovXG4gICAgc2V0IG9uU2lnbmFsaW5nQ29ubmVjdGVkKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fb25TaWduYWxpbmdDb25uZWN0ZWQgPSBoYW5kbGVyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsYmFjayB3aGVuIElDRSBjb2xsZWN0aW9uIGNvbXBsZXRlcyBlaXRoZXIgYmVjYXVzZSB0aGVyZSBpcyBubyBtb3JlIGNhbmRpZGF0ZSBvciBjb2xsZWN0aW9uIHRpbWVkIG91dC5cbiAgICAgKiBSVEMgc2Vzc2lvbiB3aWxsIG1vdmUgZm9yd2FyZCBvbmx5IGlmIG9uU2lnbmFsaW5nQ29ubmVjdGVkIGFuZCBvbkljZUNvbGxlY3Rpb25Db21wbGV0ZSBhcmUgYm90aCBjYWxsZWQuXG4gICAgICpcbiAgICAgKiBGaXJzdCBwYXJhbSBpcyBSdGNTZXNzaW9uIG9iamVjdC5cbiAgICAgKiBTZWNvbmQgcGFyYW0gaXMgYm9vbGVhbiwgVFJVRSAtIElDRSBjb2xsZWN0aW9uIHRpbWVkIG91dC5cbiAgICAgKiBUaGlyZCBwYXJhbSBpcyBudW1iZXIgb2YgY2FuZGlkYXRlcyBjb2xsZWN0ZWQuXG4gICAgICovXG4gICAgc2V0IG9uSWNlQ29sbGVjdGlvbkNvbXBsZXRlKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fb25JY2VDb2xsZWN0aW9uQ29tcGxldGUgPSBoYW5kbGVyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsYmFjayB3aGVuIHNpZ25hbGluZyBjaGFubmVsIGlzIGVzdGFibGlzaGVkIGFuZCBJQ0UgY29sbGVjdGlvbiBjb21wbGV0ZWQgd2l0aCBhdCBsZWFzdCBvbmUgY2FuZGlkYXRlLlxuICAgICAqIEZpcnN0IHBhcmFtIGlzIFJ0Y1Nlc3Npb24gb2JqZWN0LlxuICAgICAqL1xuICAgIHNldCBvblNpZ25hbGluZ1N0YXJ0ZWQoaGFuZGxlcikge1xuICAgICAgICB0aGlzLl9vblNpZ25hbGluZ1N0YXJ0ZWQgPSBoYW5kbGVyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsYmFjayB3aGVuIHRoZSBjYWxsIGlzIGVzdGFibGlzaGVkIChoYW5kc2hha2VkIGFuZCBtZWRpYSBzdHJlYW0gc2hvdWxkIGJlIGZsb3dpbmcpXG4gICAgICogRmlyc3QgcGFyYW0gaXMgUnRjU2Vzc2lvbiBvYmplY3QuXG4gICAgICovXG4gICAgc2V0IG9uU2Vzc2lvbkNvbm5lY3RlZChoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX29uU2Vzc2lvbkNvbm5lY3RlZCA9IGhhbmRsZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIGFmdGVyIHJlbW90ZSBtZWRpYSBzdHJlYW0gaXMgYWRkZWQgdG8gdGhlIHNlc3Npb24uXG4gICAgICogVGhpcyBjb3VsZCBiZSBjYWxsZWQgbXVsdGlwbGUgdGltZXMgd2l0aCB0aGUgc2FtZSBzdHJlYW0gaWYgbXVsdGlwbGUgdHJhY2tzIGFyZSBpbmNsdWRlZCBpbiB0aGUgc2FtZSBzdHJlYW0uXG4gICAgICpcbiAgICAgKiBGaXJzdCBwYXJhbSBpcyBSdGNTZXNzaW9uIG9iamVjdC5cbiAgICAgKiBTZWNvbmQgcGFyYW0gaXMgbWVkaWEgc3RyZWFtIHRyYWNrLlxuICAgICAqL1xuICAgIHNldCBvblJlbW90ZVN0cmVhbUFkZGVkKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fb25SZW1vdGVTdHJlYW1BZGRlZCA9IGhhbmRsZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIHdoZW4gdGhlIGhhbmd1cCBpcyBpbml0aWF0ZWQgKGltcGxpZXMgdGhlIGNhbGwgd2FzIHN1Y2Nlc3NmdWxseSBlc3RhYmxpc2hlZCkuXG4gICAgICogRmlyc3QgcGFyYW0gaXMgUnRjU2Vzc2lvbiBvYmplY3QuXG4gICAgICovXG4gICAgc2V0IG9uU2Vzc2lvbkNvbXBsZXRlZChoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX29uU2Vzc2lvbkNvbXBsZXRlZCA9IGhhbmRsZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIGFmdGVyIHNlc3Npb24gaXMgY2xlYW5lZCB1cCwgbm8gbWF0dGVyIGlmIHRoZSBjYWxsIHdhcyBzdWNjZXNzZnVsbHkgZXN0YWJsaXNoZWQgb3Igbm90LlxuICAgICAqIEZpcnN0IHBhcmFtIGlzIFJ0Y1Nlc3Npb24gb2JqZWN0LlxuICAgICAqIFNlY29uZCBwYXJhbSBpcyBTZXNzaW9uUmVwb3J0IG9iamVjdC5cbiAgICAgKi9cbiAgICBzZXQgb25TZXNzaW9uRGVzdHJveWVkKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fb25TZXNzaW9uRGVzdHJveWVkID0gaGFuZGxlcjtcbiAgICB9XG4gICAgc2V0IGVuYWJsZUF1ZGlvKGZsYWcpIHtcbiAgICAgICAgdGhpcy5fZW5hYmxlQXVkaW8gPSBmbGFnO1xuICAgIH1cbiAgICBzZXQgZWNob0NhbmNlbGxhdGlvbihmbGFnKSB7XG4gICAgICAgIHRoaXMuX2VjaG9DYW5jZWxsYXRpb24gPSBmbGFnO1xuICAgIH1cbiAgICBzZXQgZW5hYmxlVmlkZW8oZmxhZykge1xuICAgICAgICB0aGlzLl9lbmFibGVWaWRlbyA9IGZsYWc7XG4gICAgfVxuICAgIHNldCBtYXhWaWRlb0ZyYW1lUmF0ZShmcmFtZVJhdGUpIHtcbiAgICAgICAgdGhpcy5fbWF4VmlkZW9GcmFtZVJhdGUgPSBmcmFtZVJhdGU7XG4gICAgfVxuICAgIHNldCBtaW5WaWRlb0ZyYW1lUmF0ZShmcmFtZVJhdGUpIHtcbiAgICAgICAgdGhpcy5fbWluVmlkZW9GcmFtZVJhdGUgPSBmcmFtZVJhdGU7XG4gICAgfVxuICAgIHNldCB2aWRlb0ZyYW1lUmF0ZShmcmFtZVJhdGUpIHtcbiAgICAgICAgdGhpcy5fdmlkZW9GcmFtZVJhdGUgPSBmcmFtZVJhdGU7XG4gICAgfVxuICAgIHNldCBtYXhWaWRlb1dpZHRoKHdpZHRoKSB7XG4gICAgICAgIHRoaXMuX21heFZpZGVvV2lkdGggPSB3aWR0aDtcbiAgICB9XG4gICAgc2V0IG1pblZpZGVvV2lkdGgod2lkdGgpIHtcbiAgICAgICAgdGhpcy5fbWluVmlkZW9XaWR0aCA9IHdpZHRoO1xuICAgIH1cbiAgICBzZXQgaWRlYWxWaWRlb1dpZHRoKHdpZHRoKSB7XG4gICAgICAgIHRoaXMuX2lkZWFsVmlkZW9XaWR0aCA9IHdpZHRoO1xuICAgIH1cbiAgICBzZXQgbWF4VmlkZW9IZWlnaHQoaGVpZ2h0KSB7XG4gICAgICAgIHRoaXMuX21heFZpZGVvSGVpZ2h0ID0gaGVpZ2h0O1xuICAgIH1cbiAgICBzZXQgbWluVmlkZW9IZWlnaHQoaGVpZ2h0KSB7XG4gICAgICAgIHRoaXMuX21pblZpZGVvSGVpZ2h0ID0gaGVpZ2h0O1xuICAgIH1cbiAgICBzZXQgaWRlYWxWaWRlb0hlaWdodChoZWlnaHQpIHtcbiAgICAgICAgdGhpcy5faWRlYWxWaWRlb0hlaWdodCA9IGhlaWdodDtcbiAgICB9XG4gICAgc2V0IGZhY2luZ01vZGUobW9kZSkge1xuICAgICAgICB0aGlzLl9mYWNpbmdNb2RlID0gbW9kZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogT3B0aW9uYWwuIFJ0Y1Nlc3Npb24gd2lsbCBncmFiIGlucHV0IGRldmljZSBpZiB0aGlzIGlzIG5vdCBzcGVjaWZpZWQuXG4gICAgICogUGxlYXNlIG5vdGU6IHRoaXMgUnRjU2Vzc2lvbiBjbGFzcyBvbmx5IHN1cHBvcnQgc2luZ2xlIGF1ZGlvIHRyYWNrIGFuZC9vciBzaW5nbGUgdmlkZW8gdHJhY2suXG4gICAgICovXG4gICAgc2V0IG1lZGlhU3RyZWFtKGlucHV0KSB7XG4gICAgICAgIHRoaXMuX2xvY2FsU3RyZWFtID0gaW5wdXQ7XG4gICAgICAgIHRoaXMuX2lzVXNlclByb3ZpZGVkU3RyZWFtID0gdHJ1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTmVlZGVkLCBleHBlY3QgYW4gYXVkaW8gZWxlbWVudCB0aGF0IGNhbiBiZSB1c2VkIHRvIHBsYXkgcmVtb3RlIGF1ZGlvIHN0cmVhbS5cbiAgICAgKi9cbiAgICBzZXQgcmVtb3RlQXVkaW9FbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5fcmVtb3RlQXVkaW9FbGVtZW50ID0gZWxlbWVudDtcbiAgICB9XG4gICAgc2V0IHJlbW90ZVZpZGVvRWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX3JlbW90ZVZpZGVvRWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE92ZXJyaWRlIHRoZSBkZWZhdWx0IHNpZ25hbGluZyBjb25uZWN0IHRpbWUgb3V0LlxuICAgICAqL1xuICAgIHNldCBzaWduYWxpbmdDb25uZWN0VGltZW91dChtcykge1xuICAgICAgICB0aGlzLl9zaWduYWxpbmdDb25uZWN0VGltZW91dCA9IG1zO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPdmVycmlkZSB0aGUgZGVmYXVsdCBJQ0UgY29sbGVjdGlvbiB0aW1lIGxpbWl0LlxuICAgICAqL1xuICAgIHNldCBpY2VUaW1lb3V0TWlsbGlzKHRpbWVvdXRNaWxsaXMpIHtcbiAgICAgICAgdGhpcy5faWNlVGltZW91dE1pbGxpcyA9IHRpbWVvdXRNaWxsaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE92ZXJyaWRlIHRoZSBkZWZhdWx0IEdVTSB0aW1lb3V0IHRpbWUgbGltaXQuXG4gICAgICovXG4gICAgc2V0IGd1bVRpbWVvdXRNaWxsaXModGltZW91dE1pbGxpcykge1xuICAgICAgICB0aGlzLl9ndW1UaW1lb3V0TWlsbGlzID0gdGltZW91dE1pbGxpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogY29ubmVjdC1ydGMtanMgaW5pdGlhdGUgdGhlIGhhbmRzaGFraW5nIHdpdGggYWxsIGJyb3dzZXIgc3VwcG9ydGVkIGNvZGVjIGJ5IGRlZmF1bHQsIEFtYXpvbiBDb25uZWN0IHNlcnZpY2Ugd2lsbCBjaG9vc2UgdGhlIGNvZGVjIGFjY29yZGluZyB0byBpdHMgcHJlZmVyZW5jZSBzZXR0aW5nLlxuICAgICAqIFNldHRpbmcgdGhpcyBhdHRyaWJ1dGUgd2lsbCBmb3JjZSBjb25uZWN0LXJ0Yy1qcyB0byBvbmx5IHVzZSBzcGVjaWZpZWQgY29kZWMuXG4gICAgICogV0FSTklORzogU2V0dGluZyB0aGlzIHRvIHVuc3VwcG9ydGVkIGNvZGVjIHdpbGwgY2F1c2UgdGhlIGZhaWx1cmUgb2YgaGFuZHNoYWtpbmcuXG4gICAgICogU3VwcG9ydGVkIGF1ZGlvIGNvZGVjczogb3B1cy5cbiAgICAgKi9cbiAgICBzZXQgZm9yY2VBdWRpb0NvZGVjKGF1ZGlvQ29kZWMpIHtcbiAgICAgICAgdGhpcy5fZm9yY2VBdWRpb0NvZGVjID0gYXVkaW9Db2RlYztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjb25uZWN0LXJ0Yy1qcyBpbml0aWF0ZSB0aGUgaGFuZHNoYWtpbmcgd2l0aCBhbGwgYnJvd3NlciBzdXBwb3J0ZWQgY29kZWMgYnkgZGVmYXVsdCwgQW1hem9uIENvbm5lY3Qgc2VydmljZSB3aWxsIGNob29zZSB0aGUgY29kZWMgYWNjb3JkaW5nIHRvIGl0cyBwcmVmZXJlbmNlIHNldHRpbmcuXG4gICAgICogU2V0dGluZyB0aGlzIGF0dHJpYnV0ZSB3aWxsIGZvcmNlIGNvbm5lY3QtcnRjLWpzIHRvIG9ubHkgdXNlIHNwZWNpZmllZCBjb2RlYy5cbiAgICAgKiBXQVJOSU5HOiBTZXR0aW5nIHRoaXMgdG8gdW5zdXBwb3J0ZWQgY29kZWMgd2lsbCBjYXVzZSB0aGUgZmFpbHVyZSBvZiBoYW5kc2hha2luZy5cbiAgICAgKiBTdXBwb3J0ZWQgdmlkZW8gY29kZWNzOiBWUDgsIFZQOSwgSDI2NC5cbiAgICAgKi9cbiAgICBzZXQgZm9yY2VWaWRlb0NvZGVjKHZpZGVvQ29kZWMpIHtcbiAgICAgICAgdGhpcy5fZm9yY2VWaWRlb0NvZGVjID0gdmlkZW9Db2RlYztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjb25uZWN0LXJ0Yy1qcyBkaXNhYmxlcyBPUFVTIERUWCBieSBkZWZhdWx0IGJlY2F1c2UgaXQgaGFybXMgYXVkaW8gcXVhbGl0eS5cbiAgICAgKiBAcGFyYW0gZmxhZyBib29sZWFuXG4gICAgICovXG4gICAgc2V0IGVuYWJsZU9wdXNEdHgoZmxhZykge1xuICAgICAgICB0aGlzLl9lbmFibGVPcHVzRHR4ID0gZmxhZztcbiAgICB9XG5cbiAgICB0cmFuc2l0KG5leHRTdGF0ZSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5fbG9nZ2VyLmluZm8oKHRoaXMuX3N0YXRlID8gdGhpcy5fc3RhdGUubmFtZSA6ICdudWxsJykgKyAnID0+ICcgKyBuZXh0U3RhdGUubmFtZSk7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdGUgJiYgdGhpcy5fc3RhdGUub25FeGl0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUub25FeGl0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IG5leHRTdGF0ZTtcbiAgICAgICAgICAgIGlmIChuZXh0U3RhdGUub25FbnRlcikge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIG5leHRTdGF0ZS5vbkVudGVyKCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sb2dnZXIud2FybihuZXh0U3RhdGUubmFtZSArICcjb25FbnRlciBmYWlsZWQnLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnNhZmUtZmluYWxseVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9jcmVhdGVTaWduYWxpbmdDaGFubmVsKCkge1xuICAgICAgICB2YXIgc2lnbmFsaW5nQ2hhbm5lbCA9IG5ldyBSdGNTaWduYWxpbmcodGhpcy5fY2FsbElkLCB0aGlzLl9zaWduYWxpbmdVcmksIHRoaXMuX2NvbnRhY3RUb2tlbiwgdGhpcy5fb3JpZ2luYWxMb2dnZXIsIHRoaXMuX3NpZ25hbGluZ0Nvbm5lY3RUaW1lb3V0LCB0aGlzLl9jb25uZWN0aW9uSWQsIHRoaXMuX3dzc01hbmFnZXIpO1xuICAgICAgICBzaWduYWxpbmdDaGFubmVsLm9uQ29ubmVjdGVkID0gaGl0Y2godGhpcywgdGhpcy5fc2lnbmFsaW5nQ29ubmVjdGVkKTtcbiAgICAgICAgc2lnbmFsaW5nQ2hhbm5lbC5vbkFuc3dlcmVkID0gaGl0Y2godGhpcywgdGhpcy5fc2lnbmFsaW5nQW5zd2VyZWQpO1xuICAgICAgICBzaWduYWxpbmdDaGFubmVsLm9uSGFuZHNoYWtlZCA9IGhpdGNoKHRoaXMsIHRoaXMuX3NpZ25hbGluZ0hhbmRzaGFrZWQpO1xuICAgICAgICBzaWduYWxpbmdDaGFubmVsLm9uUmVtb3RlSHVuZ3VwID0gaGl0Y2godGhpcywgdGhpcy5fc2lnbmFsaW5nUmVtb3RlSHVuZ3VwKTtcbiAgICAgICAgc2lnbmFsaW5nQ2hhbm5lbC5vbkZhaWxlZCA9IGhpdGNoKHRoaXMsIHRoaXMuX3NpZ25hbGluZ0ZhaWxlZCk7XG4gICAgICAgIHNpZ25hbGluZ0NoYW5uZWwub25EaXNjb25uZWN0ZWQgPSBoaXRjaCh0aGlzLCB0aGlzLl9zaWduYWxpbmdEaXNjb25uZWN0ZWQpO1xuXG4gICAgICAgIHRoaXMuX3NpZ25hbGluZ0NoYW5uZWwgPSBzaWduYWxpbmdDaGFubmVsO1xuXG4gICAgICAgIHJldHVybiBzaWduYWxpbmdDaGFubmVsO1xuICAgIH1cblxuICAgIF9zaWduYWxpbmdDb25uZWN0ZWQoKSB7XG4gICAgICAgIHRoaXMuX3N0YXRlLm9uU2lnbmFsaW5nQ29ubmVjdGVkKCk7XG4gICAgfVxuICAgIF9zaWduYWxpbmdBbnN3ZXJlZChzZHAsIGNhbmRpZGF0ZXMpIHtcbiAgICAgICAgdGhpcy5fc3RhdGUub25TaWduYWxpbmdBbnN3ZXJlZChzZHAsIGNhbmRpZGF0ZXMpO1xuICAgIH1cbiAgICBfc2lnbmFsaW5nSGFuZHNoYWtlZCgpIHtcbiAgICAgICAgdGhpcy5fc3RhdGUub25TaWduYWxpbmdIYW5kc2hha2VkKCk7XG4gICAgfVxuICAgIF9zaWduYWxpbmdSZW1vdGVIdW5ndXAoKSB7XG4gICAgICAgIHRoaXMuX3N0YXRlLm9uUmVtb3RlSHVuZ3VwKCk7XG4gICAgfVxuICAgIF9zaWduYWxpbmdGYWlsZWQoZSkge1xuICAgICAgICB0aGlzLl9zdGF0ZS5vblNpZ25hbGluZ0ZhaWxlZChlKTtcbiAgICB9XG4gICAgX3NpZ25hbGluZ0Rpc2Nvbm5lY3RlZCgpIHtcbiAgICB9XG4gICAgX2NyZWF0ZVBlZXJDb25uZWN0aW9uKGNvbmZpZ3VyYXRpb24sIG9wdGlvbmFsQ29uZmlndXJhdGlvbikge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3RyYXRlZ3kuX2NyZWF0ZVBlZXJDb25uZWN0aW9uKGNvbmZpZ3VyYXRpb24sIG9wdGlvbmFsQ29uZmlndXJhdGlvbik7XG4gICAgfVxuICAgIGNvbm5lY3QocGMpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgbm93ID0gbmV3IERhdGUoKTtcbiAgICAgICAgc2VsZi5fc2Vzc2lvblJlcG9ydC5zZXNzaW9uU3RhcnRUaW1lID0gbm93O1xuICAgICAgICBzZWxmLl9jb25uZWN0VGltZVN0YW1wID0gbm93LmdldFRpbWUoKTtcbiAgICAgICAgaWYgKHBjICYmIHBjLnNpZ25hbGluZ1N0YXRlICE9ICdjbG9zZWQnKSB7XG4gICAgICAgICAgICBzZWxmLl9wYyA9IHBjO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHBjKSB7XG4gICAgICAgICAgICAgICAgcGMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICBwYyA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBSVENfUEVFUl9DT05ORUNUSU9OX0NPTkZJRy5pY2VTZXJ2ZXJzID0gc2VsZi5faWNlU2VydmVycztcbiAgICAgICAgICAgIHNlbGYuX3BjID0gc2VsZi5fY3JlYXRlUGVlckNvbm5lY3Rpb24oUlRDX1BFRVJfQ09OTkVDVElPTl9DT05GSUcsIFJUQ19QRUVSX0NPTk5FQ1RJT05fT1BUSU9OQUxfQ09ORklHKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLl9zdHJhdGVneS5jb25uZWN0KHNlbGYpO1xuICAgICAgICBzZWxmLl9wYy5vbmljZWNhbmRpZGF0ZSA9IGhpdGNoKHNlbGYsIHNlbGYuX29uSWNlQ2FuZGlkYXRlKTtcbiAgICAgICAgc2VsZi5fcGMub25jb25uZWN0aW9uc3RhdGVjaGFuZ2UgPSBoaXRjaChzZWxmLCBzZWxmLl9vblBlZXJDb25uZWN0aW9uU3RhdGVDaGFuZ2UpO1xuICAgICAgICBzZWxmLl9wYy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZSA9IGhpdGNoKHNlbGYsIHNlbGYuX29uSWNlU3RhdGVDaGFuZ2UpO1xuXG4gICAgICAgIGlzTGVnYWN5U3RhdHNSZXBvcnRTdXBwb3J0ZWQoc2VsZi5fcGMpLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgICAgICAgIHNlbGYuX2xlZ2FjeVN0YXRzUmVwb3J0U3VwcG9ydCA9IHJlc3VsdDtcbiAgICAgICAgICAgIHNlbGYudHJhbnNpdChuZXcgR3JhYkxvY2FsTWVkaWFTdGF0ZShzZWxmKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhY2NlcHQoKSB7XG4gICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbignYWNjZXB0IGRvZXMgbm90IGdvIHRocm91Z2ggc2lnbmFsaW5nIGNoYW5uZWwgYXQgdGhpcyBtb21lbnQnKTtcbiAgICB9XG4gICAgaGFuZ3VwKCkge1xuICAgICAgICB0aGlzLl9zdGF0ZS5oYW5ndXAoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgYSBwcm9taXNlIGNvbnRhaW5pbmcgYW4gb2JqZWN0IHdpdGggdHdvIG5hbWVkIGxpc3RzIG9mIGF1ZGlvIHN0YXRzLCBvbmUgZm9yIGVhY2ggY2hhbm5lbCBvbiBlYWNoXG4gICAgICogbWVkaWEgdHlwZSBvZiAndmlkZW8nIGFuZCAnYXVkaW8nLlxuICAgICAqIEByZXR1cm4gUmVqZWN0ZWQgcHJvbWlzZSBpZiBmYWlsZWQgdG8gZ2V0IE1lZGlhUnRwU3RhdHMuIFRoZSBwcm9taXNlIGlzIG5ldmVyIHJlc29sdmVkIHdpdGggbnVsbCB2YWx1ZS5cbiAgICAgKi9cbiAgICBhc3luYyBnZXRTdGF0cygpIHtcbiAgICAgICAgdmFyIHRpbWVzdGFtcCA9IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgdmFyIGltcGwgPSBhc3luYyAoc3RyZWFtLCBzdHJlYW1UeXBlKSA9PiB7XG4gICAgICAgICAgICB2YXIgdHJhY2tzID0gW107XG5cbiAgICAgICAgICAgIGlmICghc3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzd2l0Y2ggKHN0cmVhbVR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdhdWRpb19pbnB1dCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnYXVkaW9fb3V0cHV0JzpcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tzID0gc3RyZWFtLmdldEF1ZGlvVHJhY2tzKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3ZpZGVvX2lucHV0JzpcbiAgICAgICAgICAgICAgICBjYXNlICd2aWRlb19vdXRwdXQnOlxuICAgICAgICAgICAgICAgICAgICB0cmFja3MgPSBzdHJlYW0uZ2V0VmlkZW9UcmFja3MoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbnN1cHBvcnRlZCBzdHJlYW0gdHlwZSB3aGlsZSB0cnlpbmcgdG8gZ2V0IHN0YXRzOiAnICsgc3RyZWFtVHlwZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLmFsbCh0cmFja3MubWFwKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBnZXQgc3RhbmRhcmRpemVkIHJlcG9ydFxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wYy5nZXRTdGF0cygpLnRoZW4oZnVuY3Rpb24gKHJhd1N0YXRzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkaWdlc3RlZFN0YXRzID0gZXh0cmFjdE1lZGlhU3RhdHNGcm9tU3RhdHModGltZXN0YW1wLCByYXdTdGF0cywgc3RyZWFtVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZGlnZXN0ZWRTdGF0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZXh0cmFjdCBNZWRpYVJ0cFN0YXRzIGZyb20gUlRDU3RhdHNSZXBvcnQgZm9yIHN0cmVhbSB0eXBlICcgKyBzdHJlYW1UeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGlnZXN0ZWRTdGF0cztcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0aGlzLl9wYyAmJiB0aGlzLl9wYy5zaWduYWxpbmdTdGF0ZSA9PT0gJ3N0YWJsZScpIHtcbiAgICAgICAgICAgIHZhciBzdGF0c1Jlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICBhdWRpbzoge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dDogYXdhaXQgaW1wbCh0aGlzLl9yZW1vdGVBdWRpb1N0cmVhbSwgJ2F1ZGlvX2lucHV0JyksXG4gICAgICAgICAgICAgICAgICAgIG91dHB1dDogYXdhaXQgaW1wbCh0aGlzLl9sb2NhbFN0cmVhbSwgJ2F1ZGlvX291dHB1dCcpXG4gICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgIHZpZGVvOiB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0OiBhd2FpdCBpbXBsKHRoaXMuX3JlbW90ZVZpZGVvU3RyZWFtLCAndmlkZW9faW5wdXQnKSxcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0OiBhd2FpdCBpbXBsKHRoaXMuX2xvY2FsU3RyZWFtLCAndmlkZW9fb3V0cHV0JylcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBGb3IgY29uc2lzdGVuY3kncyBzYWtlLCBjb2FsZXNjZSBydHRNaWxsaXNlY29uZHMgaW50byB0aGUgb3V0cHV0IGZvciBhdWRpbyBhbmQgdmlkZW8uXG4gICAgICAgICAgICB2YXIgcnR0UmVkdWNlciA9IChhY2MsIHN0YXRzKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRzLnJ0dE1pbGxpc2Vjb25kcyAhPT0gbnVsbCAmJiAoYWNjID09PSBudWxsIHx8IHN0YXRzLnJ0dE1pbGxpc2Vjb25kcyA+IGFjYykpIHtcbiAgICAgICAgICAgICAgICAgICAgYWNjID0gc3RhdHMucnR0TWlsbGlzZWNvbmRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGF0cy5fcnR0TWlsbGlzZWNvbmRzID0gbnVsbDtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGF1ZGlvSW5wdXRSdHRNaWxsaXNlY29uZHMgPSBzdGF0c1Jlc3VsdC5hdWRpby5pbnB1dC5yZWR1Y2UocnR0UmVkdWNlciwgbnVsbCk7XG4gICAgICAgICAgICB2YXIgdmlkZW9JbnB1dFJ0dE1pbGxpc2Vjb25kcyA9IHN0YXRzUmVzdWx0LnZpZGVvLmlucHV0LnJlZHVjZShydHRSZWR1Y2VyLCBudWxsKTtcblxuICAgICAgICAgICAgaWYgKGF1ZGlvSW5wdXRSdHRNaWxsaXNlY29uZHMgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBzdGF0c1Jlc3VsdC5hdWRpby5vdXRwdXQuZm9yRWFjaCgoc3RhdHMpID0+IHsgc3RhdHMuX3J0dE1pbGxpc2Vjb25kcyA9IGF1ZGlvSW5wdXRSdHRNaWxsaXNlY29uZHM7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodmlkZW9JbnB1dFJ0dE1pbGxpc2Vjb25kcyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHN0YXRzUmVzdWx0LnZpZGVvLm91dHB1dC5mb3JFYWNoKChzdGF0cykgPT4geyBzdGF0cy5fcnR0TWlsbGlzZWNvbmRzID0gdmlkZW9JbnB1dFJ0dE1pbGxpc2Vjb25kczsgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBzdGF0c1Jlc3VsdDtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBJbGxlZ2FsU3RhdGUoKSk7XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhIHByb21pc2Ugb2YgTWVkaWFSdHBTdGF0cyBvYmplY3QgZm9yIHJlbW90ZSBhdWRpbyAoZnJvbSBBbWF6b24gQ29ubmVjdCB0byBjbGllbnQpLlxuICAgICAqIEByZXR1cm4gUmVqZWN0ZWQgcHJvbWlzZSBpZiBmYWlsZWQgdG8gZ2V0IE1lZGlhUnRwU3RhdHMuIFRoZSBwcm9taXNlIGlzIG5ldmVyIHJlc29sdmVkIHdpdGggbnVsbCB2YWx1ZS5cbiAgICAgKiBAZGVwcmVjYXRlZCBpbiBmYXZvciBvZiBnZXRTdGF0cygpXG4gICAgICovXG4gICAgZ2V0UmVtb3RlQXVkaW9TdGF0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3RhdHMoKS50aGVuKGZ1bmN0aW9uKHN0YXRzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHMuYXVkaW8ub3V0cHV0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdHMuYXVkaW8ub3V0cHV0WzBdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IElsbGVnYWxTdGF0ZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGEgcHJvbWlzZSBvZiBNZWRpYVJ0cFN0YXRzIG9iamVjdCBmb3IgdXNlciBhdWRpbyAoZnJvbSBjbGllbnQgdG8gQW1hem9uIENvbm5lY3QpLlxuICAgICAqIEByZXR1cm4gUmVqZWN0ZWQgcHJvbWlzZSBpZiBmYWlsZWQgdG8gZ2V0IE1lZGlhUnRwU3RhdHMuIFRoZSBwcm9taXNlIGlzIG5ldmVyIHJlc29sdmVkIHdpdGggbnVsbCB2YWx1ZS5cbiAgICAgKiBAZGVwcmVjYXRlZCBpbiBmYXZvciBvZiBnZXRTdGF0cygpXG4gICAgICovXG4gICAgZ2V0VXNlckF1ZGlvU3RhdHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFN0YXRzKCkudGhlbihmdW5jdGlvbihzdGF0cykge1xuICAgICAgICAgICAgaWYgKHN0YXRzLmF1ZGlvLmlucHV0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdHMuYXVkaW8uaW5wdXRbMF07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgSWxsZWdhbFN0YXRlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgYSBwcm9taXNlIG9mIE1lZGlhUnRwU3RhdHMgb2JqZWN0IGZvciB1c2VyIHZpZGVvIChmcm9tIGNsaWVudCB0byBBbWF6b24gQ29ubmVjdCkuXG4gICAgICogQHJldHVybiBSZWplY3RlZCBwcm9taXNlIGlmIGZhaWxlZCB0byBnZXQgTWVkaWFSdHBTdGF0cy4gVGhlIHByb21pc2UgaXMgbmV2ZXIgcmVzb2x2ZWQgd2l0aCBudWxsIHZhbHVlLlxuICAgICAqIEBkZXByZWNhdGVkIGluIGZhdm9yIG9mIGdldFN0YXRzKClcbiAgICAgKi9cbiAgICBnZXRSZW1vdGVWaWRlb1N0YXRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTdGF0cygpLnRoZW4oZnVuY3Rpb24oc3RhdHMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0cy52aWRlby5vdXRwdXQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdGF0cy52aWRlby5vdXRwdXRbMF07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgSWxsZWdhbFN0YXRlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgYSBwcm9taXNlIG9mIE1lZGlhUnRwU3RhdHMgb2JqZWN0IGZvciB1c2VyIHZpZGVvIChmcm9tIGNsaWVudCB0byBBbWF6b24gQ29ubmVjdCkuXG4gICAgICogQHJldHVybiBSZWplY3RlZCBwcm9taXNlIGlmIGZhaWxlZCB0byBnZXQgTWVkaWFSdHBTdGF0cy4gVGhlIHByb21pc2UgaXMgbmV2ZXIgcmVzb2x2ZWQgd2l0aCBudWxsIHZhbHVlLlxuICAgICAqIEBkZXByZWNhdGVkIGluIGZhdm9yIG9mIGdldFN0YXRzKClcbiAgICAgKi9cbiAgICBnZXRVc2VyVmlkZW9TdGF0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3RhdHMoKS50aGVuKGZ1bmN0aW9uKHN0YXRzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHMudmlkZW8uaW5wdXQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdGF0cy52aWRlby5pbnB1dFswXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBJbGxlZ2FsU3RhdGUoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIF9vbkljZUNhbmRpZGF0ZShldnQpIHtcbiAgICAgICAgdGhpcy5fc3RhdGUub25JY2VDYW5kaWRhdGUoZXZ0KTtcbiAgICB9XG5cbiAgICBfb25QZWVyQ29ubmVjdGlvblN0YXRlQ2hhbmdlKCkge1xuICAgICAgICB0aGlzLl9zdGF0ZS5vblBlZXJDb25uZWN0aW9uU3RhdGVDaGFuZ2UoKTtcbiAgICB9XG5cbiAgICBfb25JY2VTdGF0ZUNoYW5nZShldnQpIHtcbiAgICAgICAgdGhpcy5fc3RhdGUub25JY2VTdGF0ZUNoYW5nZShldnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEF0dGFjaCByZW1vdGUgbWVkaWEgc3RyZWFtIHRvIHdlYiBlbGVtZW50LlxuICAgICAqL1xuICAgIF9vbnRyYWNrKGV2dCkge1xuICAgICAgICB0aGlzLl9zdHJhdGVneS5fb250cmFjayh0aGlzLCBldnQpO1xuICAgICAgICB0aGlzLl9vblJlbW90ZVN0cmVhbUFkZGVkKHRoaXMsIGV2dC5zdHJlYW1zWzBdKTtcbiAgICB9XG4gICAgX2RldGFjaE1lZGlhKCkge1xuICAgICAgICBpZiAodGhpcy5fcmVtb3RlVmlkZW9FbGVtZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9yZW1vdGVWaWRlb0VsZW1lbnQuc3JjT2JqZWN0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fcmVtb3RlQXVkaW9FbGVtZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9yZW1vdGVBdWRpb0VsZW1lbnQuc3JjT2JqZWN0ID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3JlbW90ZUF1ZGlvU3RyZWFtID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfc3RvcFNlc3Npb24oKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbG9jYWxTdHJlYW0gJiYgIXRoaXMuX2lzVXNlclByb3ZpZGVkU3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgY2xvc2VTdHJlYW0odGhpcy5fbG9jYWxTdHJlYW0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvY2FsU3RyZWFtID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl9pc1VzZXJQcm92aWRlZFN0cmVhbSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcGMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gZWF0IGV4Y2VwdGlvblxuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wYyA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfYnVpbGRNZWRpYUNvbnN0cmFpbnRzKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBtZWRpYUNvbnN0cmFpbnRzID0ge307XG5cbiAgICAgICAgc2VsZi5fc3RyYXRlZ3kuX2J1aWxkTWVkaWFDb25zdHJhaW50cyhzZWxmLCBtZWRpYUNvbnN0cmFpbnRzKTtcblxuICAgICAgICBpZiAoc2VsZi5fZW5hYmxlVmlkZW8pIHtcbiAgICAgICAgICAgIHZhciB2aWRlb0NvbnN0cmFpbnRzID0ge307XG4gICAgICAgICAgICB2YXIgd2lkdGhDb25zdHJhaW50cyA9IHt9O1xuICAgICAgICAgICAgdmFyIGhlaWdodENvbnN0cmFpbnRzID0ge307XG4gICAgICAgICAgICB2YXIgZnJhbWVSYXRlQ29uc3RyYWludHMgPSB7fTtcblxuICAgICAgICAgICAgLy9idWlsZCB2aWRlbyB3aWR0aCBjb25zdHJhaW50c1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLl9pZGVhbFZpZGVvV2lkdGggIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgd2lkdGhDb25zdHJhaW50cy5pZGVhbCA9IHNlbGYuX2lkZWFsVmlkZW9XaWR0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc2VsZi5fbWF4VmlkZW9XaWR0aCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB3aWR0aENvbnN0cmFpbnRzLm1heCA9IHNlbGYuX21heFZpZGVvV2lkdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYuX21pblZpZGVvV2lkdGggIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgd2lkdGhDb25zdHJhaW50cy5taW4gPSBzZWxmLl9taW5WaWRlb1dpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gYnVpbGQgdmlkZW8gaGVpZ2h0IGNvbnN0cmFpbnRzXG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYuX2lkZWFsVmlkZW9IZWlnaHQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgaGVpZ2h0Q29uc3RyYWludHMuaWRlYWwgPSBzZWxmLl9pZGVhbFZpZGVvSGVpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLl9tYXhWaWRlb0hlaWdodCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICBoZWlnaHRDb25zdHJhaW50cy5tYXggPSBzZWxmLl9tYXhWaWRlb0hlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc2VsZi5fbWluVmlkZW9IZWlnaHQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgaGVpZ2h0Q29uc3RyYWludHMubWluID0gc2VsZi5fbWluVmlkZW9IZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihPYmplY3Qua2V5cyh3aWR0aENvbnN0cmFpbnRzKS5sZW5ndGggPiAwICYmIE9iamVjdC5rZXlzKGhlaWdodENvbnN0cmFpbnRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdmlkZW9Db25zdHJhaW50cy53aWR0aCA9IHdpZHRoQ29uc3RyYWludHM7XG4gICAgICAgICAgICAgICAgdmlkZW9Db25zdHJhaW50cy5oZWlnaHQgPSBoZWlnaHRDb25zdHJhaW50cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGJ1aWxkIGZyYW1lIHJhdGUgY29uc3RyYWludHNcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc2VsZi5fdmlkZW9GcmFtZVJhdGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgZnJhbWVSYXRlQ29uc3RyYWludHMuaWRlYWwgPSBzZWxmLl92aWRlb0ZyYW1lUmF0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc2VsZi5fbWluVmlkZW9GcmFtZVJhdGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgZnJhbWVSYXRlQ29uc3RyYWludHMubWluID0gc2VsZi5fbWluVmlkZW9GcmFtZVJhdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYuX21heFZpZGVvRnJhbWVSYXRlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGZyYW1lUmF0ZUNvbnN0cmFpbnRzLm1heCA9IHNlbGYuX21heFZpZGVvRnJhbWVSYXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoT2JqZWN0LmtleXMoZnJhbWVSYXRlQ29uc3RyYWludHMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB2aWRlb0NvbnN0cmFpbnRzLmZyYW1lUmF0ZSA9IGZyYW1lUmF0ZUNvbnN0cmFpbnRzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBidWlsZCBmYWNpbmcgbW9kZSBjb25zdHJhaW50c1xuICAgICAgICAgICAgaWYoc2VsZi5fZmFjaW5nTW9kZSAhPT0gJ3VzZXInICYmIHNlbGYuX2ZhY2luZ01vZGUgIT09IFwiZW52aXJvbm1lbnRcIikge1xuICAgICAgICAgICAgICAgIHNlbGYuX2ZhY2luZ01vZGUgPSAndXNlcic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2aWRlb0NvbnN0cmFpbnRzLmZhY2luZ01vZGUgPSBzZWxmLl9mYWNpbmdNb2RlO1xuXG4gICAgICAgICAgICAvLyBzZXQgdmlkZW8gY29uc3RyYWludHNcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyh2aWRlb0NvbnN0cmFpbnRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgbWVkaWFDb25zdHJhaW50cy52aWRlbyA9IHZpZGVvQ29uc3RyYWludHM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1lZGlhQ29uc3RyYWludHMudmlkZW8gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG1lZGlhQ29uc3RyYWludHM7XG4gICAgfVxufVxuIiwiLyoqXG4gKiBFeHRyYWN0IHJ0cCBzdGF0cyBvZiBzcGVjaWZpZWQgc3RyZWFtIGZyb20gUlRDU3RhdHNSZXBvcnRcbiAqIENocm9tZSByZXBvcnRzIGFsbCBzdHJlYW0gc3RhdHMgaW4gc3RhdHNSZXBvcnRzIHdoZXJlYXMgZmlyZWZveCByZXBvcnRzIG9ubHkgc2luZ2xlIHN0cmVhbSBzdGF0cyBpbiByZXBvcnRcbiAqIFN0cmVhbVR5cGUgaXMgcGFzc2VkIG9ubHkgdG8gcHVsbCByaWdodCBzdHJlYW0gc3RhdHMgYXVkaW9faW5wdXQgb3IgYXVkaW9fb3V0cHV0LlxuICovXG5cbmltcG9ydCB7IGlzX2RlZmluZWQsIHdoZW5fZGVmaW5lZCB9IGZyb20gJy4vdXRpbHMnO1xuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RNZWRpYVN0YXRzRnJvbVN0YXRzKHRpbWVzdGFtcCwgc3RhdHMsIHN0cmVhbVR5cGUpIHtcbiAgICB2YXIgZXh0cmFjdGVkU3RhdHMgPSBudWxsO1xuICAgIHZhciByZXBvcnRUeXBlID0gbnVsbDtcblxuICAgIHN0YXRzLmZvckVhY2goc3RhdHNSZXBvcnQgPT4ge1xuICAgICAgICBpZiAoc3RhdHNSZXBvcnQpIHtcbiAgICAgICAgICAgIGlmIChzdGF0c1JlcG9ydC50eXBlID09PSAnaW5ib3VuZC1ydHAnICYmIHN0cmVhbVR5cGUgPT09ICdhdWRpb19pbnB1dCcpIHtcbiAgICAgICAgICAgICAgICAvLyBpbmJvdW5kLXJ0cDogU3RhdHMgZm9yIHN0cmVhbSBmcm9tIFNlcnZlciB0byBDQ1AsIGFzIHNlZW4gb24gdGhlIGJyb3dzZXJcbiAgICAgICAgICAgICAgICByZXBvcnRUeXBlID0gc3RhdHNSZXBvcnQudHlwZTtcbiAgICAgICAgICAgICAgICBleHRyYWN0ZWRTdGF0cyA9IHtcbiAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wOiB0aW1lc3RhbXAsXG4gICAgICAgICAgICAgICAgICAgIHBhY2tldHNMb3N0OiBzdGF0c1JlcG9ydC5wYWNrZXRzTG9zdCxcbiAgICAgICAgICAgICAgICAgICAgLy8gcGFja2V0c0NvdW50OiBudW1iZXIgb2YgcGFja2V0IHJlY2VpdmVkIGJ5IENDUCwgYXMgc2VlbiBvbiB0aGUgYnJvd3NlclxuICAgICAgICAgICAgICAgICAgICBwYWNrZXRzQ291bnQ6IHN0YXRzUmVwb3J0LnBhY2tldHNSZWNlaXZlZCxcbiAgICAgICAgICAgICAgICAgICAgamJNaWxsaXNlY29uZHM6IE1hdGguZmxvb3Iod2hlbl9kZWZpbmVkKHN0YXRzUmVwb3J0LmppdHRlciwgMCkgKiAxMDAwKSxcbiAgICAgICAgICAgICAgICAgICAgLy8gTXVsdGlwbHlpbmcgYXVkaW9MZXZlbCBieSAzMjc2OCBhbGlnbnMgaXRzIHZhbHVlIHdpdGggdGhlIGxlZ2FjeSBnZXRTdGF0cyBBUEkuXG4gICAgICAgICAgICAgICAgICAgIGF1ZGlvTGV2ZWw6IGlzX2RlZmluZWQoc3RhdHNSZXBvcnQuYXVkaW9MZXZlbCkgPyBNYXRoLmZsb29yKHN0YXRzUmVwb3J0LmF1ZGlvTGV2ZWwgKiAzMjc2OCkgOiBudWxsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdHNSZXBvcnQudHlwZSA9PT0gJ291dGJvdW5kLXJ0cCcgJiYgc3RyZWFtVHlwZSA9PT0gJ2F1ZGlvX291dHB1dCcpIHtcbiAgICAgICAgICAgICAgICAvLyBvdXRib3VuZC1ydHA6IFN0YXRzIGZvciBzdHJlYW0gZnJvbSBDQ1AgdG8gU2VydmVyLCBhcyBzZWVuIG9uIHRoZSBicm93c2VyXG4gICAgICAgICAgICAgICAgZXh0cmFjdGVkU3RhdHMgPSBleHRyYWN0ZWRTdGF0cyB8fCB7fTtcbiAgICAgICAgICAgICAgICAvLyBwYWNrZXRzQ291bnQ6IG51bWJlciBvZiBwYWNrZXQgc2VudCBieSBDQ1AsIGFzIHNlZW4gb24gdGhlIGJyb3dzZXJcbiAgICAgICAgICAgICAgICBleHRyYWN0ZWRTdGF0cy5wYWNrZXRzQ291bnQgPSBzdGF0c1JlcG9ydC5wYWNrZXRzU2VudDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdHNSZXBvcnQudHlwZSA9PT0gJ21lZGlhLXNvdXJjZScgJiYgc3RyZWFtVHlwZSA9PT0gJ2F1ZGlvX291dHB1dCcpIHtcbiAgICAgICAgICAgICAgICBleHRyYWN0ZWRTdGF0cyA9IGV4dHJhY3RlZFN0YXRzIHx8IHt9O1xuICAgICAgICAgICAgICAgIC8vIE11bHRpcGx5aW5nIGF1ZGlvTGV2ZWwgYnkgMzI3NjggYWxpZ25zIGl0cyB2YWx1ZSB3aXRoIHRoZSBsZWdhY3kgZ2V0U3RhdHMgQVBJLlxuICAgICAgICAgICAgICAgIGV4dHJhY3RlZFN0YXRzLmF1ZGlvTGV2ZWwgPSBpc19kZWZpbmVkKHN0YXRzUmVwb3J0LmF1ZGlvTGV2ZWwpID8gTWF0aC5mbG9vcihzdGF0c1JlcG9ydC5hdWRpb0xldmVsICogMzI3NjgpIDogbnVsbDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdHNSZXBvcnQudHlwZSA9PT0gJ3JlbW90ZS1pbmJvdW5kLXJ0cCcgJiYgc3RyZWFtVHlwZSA9PT0gJ2F1ZGlvX291dHB1dCcpIHtcbiAgICAgICAgICAgICAgICAvLyByZW1vdGUtaW5ib3VuZC1ydHA6IFN0YXRzIGZvciBzdHJlYW0gZnJvbSBDQ1AgdG8gU2VydmVyLCBhcyBzZWVuIG9uIFNlcnZlciBzaWRlXG4gICAgICAgICAgICAgICAgcmVwb3J0VHlwZSA9IHN0YXRzUmVwb3J0LnR5cGU7XG4gICAgICAgICAgICAgICAgZXh0cmFjdGVkU3RhdHMgPSBleHRyYWN0ZWRTdGF0cyB8fCB7fTtcbiAgICAgICAgICAgICAgICBleHRyYWN0ZWRTdGF0cy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7XG4gICAgICAgICAgICAgICAgZXh0cmFjdGVkU3RhdHMucGFja2V0c0xvc3QgPSBzdGF0c1JlcG9ydC5wYWNrZXRzTG9zdDtcbiAgICAgICAgICAgICAgICBleHRyYWN0ZWRTdGF0cy5ydHRNaWxsaXNlY29uZHMgPSBpc19kZWZpbmVkKHN0YXRzUmVwb3J0LnJvdW5kVHJpcFRpbWUpID8gTWF0aC5mbG9vcihzdGF0c1JlcG9ydC5yb3VuZFRyaXBUaW1lICogMTAwMCkgOiBudWxsO1xuICAgICAgICAgICAgICAgIGV4dHJhY3RlZFN0YXRzLmpiTWlsbGlzZWNvbmRzID0gTWF0aC5mbG9vcih3aGVuX2RlZmluZWQoc3RhdHNSZXBvcnQuaml0dGVyLCAwKSAqIDEwMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZXh0cmFjdGVkU3RhdHMgPyBuZXcgTWVkaWFSdHBTdGF0cyhleHRyYWN0ZWRTdGF0cywgcmVwb3J0VHlwZSwgc3RyZWFtVHlwZSkgOiBudWxsO1xufVxuXG4vKipcbiAqIEJhc2ljIFJUUCBzdGF0aXN0aWNzIG9iamVjdCwgcmVwcmVzZW50cyBzdGF0aXN0aWNzIG9mIGFuIGF1ZGlvIG9yIHZpZGVvIHN0cmVhbS5cbiAqL1xuY2xhc3MgTWVkaWFSdHBTdGF0cyB7XG4gICAgY29uc3RydWN0b3IocGFyYW1zSW4sIHN0YXRzUmVwb3J0VHlwZSwgc3RyZWFtVHlwZSkge1xuICAgICAgICB2YXIgcGFyYW1zID0gcGFyYW1zSW4gfHwge307XG5cbiAgICAgICAgdGhpcy5fdGltZXN0YW1wICAgICAgICAgPSBwYXJhbXMudGltZXN0YW1wIHx8IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICB0aGlzLl9wYWNrZXRzTG9zdCAgICAgICA9IHdoZW5fZGVmaW5lZChwYXJhbXMucGFja2V0c0xvc3QpO1xuICAgICAgICB0aGlzLl9wYWNrZXRzQ291bnQgICAgICA9IHdoZW5fZGVmaW5lZChwYXJhbXMucGFja2V0c0NvdW50KTtcbiAgICAgICAgdGhpcy5fYXVkaW9MZXZlbCAgICAgICAgPSB3aGVuX2RlZmluZWQocGFyYW1zLmF1ZGlvTGV2ZWwpO1xuICAgICAgICB0aGlzLl9wcm9jTWlsbGlzZWNvbmRzICA9IHdoZW5fZGVmaW5lZChwYXJhbXMucHJvY01pbGxpc2Vjb25kcyk7XG4gICAgICAgIHRoaXMuX3J0dE1pbGxpc2Vjb25kcyAgID0gd2hlbl9kZWZpbmVkKHBhcmFtcy5ydHRNaWxsaXNlY29uZHMpO1xuICAgICAgICB0aGlzLl9qYk1pbGxpc2Vjb25kcyAgICA9IHdoZW5fZGVmaW5lZChwYXJhbXMuamJNaWxsaXNlY29uZHMpO1xuICAgICAgICB0aGlzLl9ieXRlc1NlbnQgICAgICAgICA9IHdoZW5fZGVmaW5lZChwYXJhbXMuYnl0ZXNTZW50KTtcbiAgICAgICAgdGhpcy5fYnl0ZXNSZWNlaXZlZCAgICAgPSB3aGVuX2RlZmluZWQocGFyYW1zLmJ5dGVzUmVjZWl2ZWQpO1xuICAgICAgICB0aGlzLl9mcmFtZXNFbmNvZGVkICAgICA9IHdoZW5fZGVmaW5lZChwYXJhbXMuZnJhbWVzRW5jb2RlZCk7XG4gICAgICAgIHRoaXMuX2ZyYW1lc0RlY29kZWQgICAgID0gd2hlbl9kZWZpbmVkKHBhcmFtcy5mcmFtZXNEZWNvZGVkKTtcbiAgICAgICAgdGhpcy5fZnJhbWVSYXRlU2VudCAgICAgPSB3aGVuX2RlZmluZWQocGFyYW1zLmZyYW1lUmF0ZVNlbnQpO1xuICAgICAgICB0aGlzLl9mcmFtZVJhdGVSZWNlaXZlZCA9IHdoZW5fZGVmaW5lZChwYXJhbXMuZnJhbWVSYXRlUmVjZWl2ZWQpO1xuICAgICAgICB0aGlzLl9zdGF0c1JlcG9ydFR5cGUgICA9IHN0YXRzUmVwb3J0VHlwZSB8fCBwYXJhbXMuX3N0YXRzUmVwb3J0VHlwZSB8fCBcInVua25vd25cIjtcbiAgICAgICAgdGhpcy5fc3RyZWFtVHlwZSAgICAgICAgPSBzdHJlYW1UeXBlIHx8IHBhcmFtcy5zdHJlYW1UeXBlIHx8IFwidW5rbm93blwiO1xuICAgIH1cblxuICAgIC8qKiB7bnVtYmVyfSBudW1iZXIgb2YgcGFja2V0cyBzZW50IHRvIHRoZSBjaGFubmVsICovXG4gICAgZ2V0IHBhY2tldHNDb3VudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhY2tldHNDb3VudDtcbiAgICB9XG4gICAgLyoqIHtudW1iZXJ9IG51bWJlciBvZiBwYWNrZXRzIGxvc3QgYWZ0ZXIgdHJhdmVsbGluZyB0aHJvdWdoIHRoZSBjaGFubmVsICovXG4gICAgZ2V0IHBhY2tldHNMb3N0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGFja2V0c0xvc3Q7XG4gICAgfVxuICAgIC8qKiB7bnVtYmVyfSBudW1iZXIgb2YgcGFja2V0cyBsb3N0IGFmdGVyIHRyYXZlbGxpbmcgdGhyb3VnaCB0aGUgY2hhbm5lbCAqL1xuICAgIGdldCBwYWNrZXRMb3NzUGVyY2VudGFnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhY2tldHNDb3VudCA+IDAgPyB0aGlzLl9wYWNrZXRzTG9zdCAvIHRoaXMuX3BhY2tldHNDb3VudCA6IDA7XG4gICAgfVxuICAgIC8qKiBBdWRpbyB2b2x1bWUgbGV2ZWxcbiAgICAgKiBDdXJyZW50bHkgZmlyZWZveCBkb2Vzbid0IHByb3ZpZGUgYXVkaW8gbGV2ZWwgaW4gcnRwIHN0YXRzLlxuICAgICAqL1xuICAgIGdldCBhdWRpb0xldmVsKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXVkaW9MZXZlbDtcbiAgICB9XG4gICAgLyoqIFRpbWVzdGFtcCB3aGVuIHN0YXRzIGFyZSBjb2xsZWN0ZWQuICovXG4gICAgZ2V0IHRpbWVzdGFtcCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RpbWVzdGFtcDtcbiAgICB9XG4gICAgLyoqIHtudW1iZXJ9IFByb2Nlc3NpbmcgZGVsYXkgY2FsY3VsYXRlZCBieSB0aW1lIHRvIHByb2Nlc3MgcGFja2V0IGhlYWRlciAqL1xuICAgIGdldCBwcm9jTWlsbGlzZWNvbmRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcHJvY01pbGxpc2Vjb25kc1xuICAgIH1cbiAgICAvKioge251bWJlcn0gUm91bmQgdHJpcCB0aW1lIGNhbGN1bGF0ZWQgd2l0aCBSVENQIHJlcG9ydHMgKi9cbiAgICBnZXQgcnR0TWlsbGlzZWNvbmRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcnR0TWlsbGlzZWNvbmRzO1xuICAgIH1cbiAgICAvKioge251bWJlcn0gU3RhdGlzdGljYWwgdmFyaWFuY2Ugb2YgUlRQIGRhdGEgcGFja2V0IGludGVyLWFycml2YWwgdGltZSAqL1xuICAgIGdldCBqYk1pbGxpc2Vjb25kcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2piTWlsbGlzZWNvbmRzO1xuICAgIH1cbiAgICAvKioge251bWJlcn0gbnVtYmVyIG9mIGJ5dGVzIHNlbnQgdG8gdGhlIGNoYW5uZWwqL1xuICAgIGdldCBieXRlc1NlbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ieXRlc1NlbnQ7XG4gICAgfVxuICAgIC8qKiB7bnVtYmVyfSBudW1iZXIgb2YgYnl0ZXMgcmVjZWl2ZWQgZnJvbSB0aGUgY2hhbm5lbCovXG4gICAgZ2V0IGJ5dGVzUmVjZWl2ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ieXRlc1JlY2VpdmVkO1xuICAgIH1cbiAgICAvKioge251bWJlcn0gbnVtYmVyIG9mIHZpZGVvIGZyYW1lcyBlbmNvZGVkKi9cbiAgICBnZXQgZnJhbWVzRW5jb2RlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZyYW1lc0VuY29kZWQ7XG4gICAgfVxuICAgIC8qKiB7bnVtYmVyfSBudW1iZXIgb2YgdmlkZW8gZnJhbWVzIGRlY29kZWQqL1xuICAgIGdldCBmcmFtZXNEZWNvZGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZnJhbWVzRGVjb2RlZDtcbiAgICB9XG4gICAgLyoqIHtudW1iZXJ9IGZyYW1lcyBwZXIgc2Vjb25kIHNlbnQgdG8gdGhlIGNoYW5uZWwqL1xuICAgIGdldCBmcmFtZVJhdGVTZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZnJhbWVSYXRlU2VudDtcbiAgICB9XG4gICAgLyoqIHtudW1iZXJ9IGZyYW1lcyBwZXIgc2Vjb25kIHJlY2VpdmVkIGZyb20gdGhlIGNoYW5uZWwqL1xuICAgIGdldCBmcmFtZVJhdGVSZWNlaXZlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZyYW1lUmF0ZVJlY2VpdmVkO1xuICAgIH1cbiAgICAvKioge3N0cmluZ30gdGhlIHR5cGUgb2YgdGhlIHN0YXRzIHJlcG9ydCAqL1xuICAgIGdldCBzdGF0c1JlcG9ydFR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdGF0c1JlcG9ydFR5cGU7XG4gICAgfVxuICAgIC8qKiB7c3RyaW5nfSB0aGUgdHlwZSBvZiB0aGUgc3RyZWFtICovXG4gICAgZ2V0IHN0cmVhbVR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdHJlYW1UeXBlO1xuICAgIH1cbn1cbiIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgQW1hem9uLmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQXBhY2hlLTIuMFxuICovXG5cbmV4cG9ydCBjbGFzcyBTZXNzaW9uUmVwb3J0IHtcbiAgICAvKipcbiAgICAgKiBAY2xhc3MgUHJvdG90eXBlIGZvciB0cmFja2luZyB2YXJpb3VzIFJUQyBzZXNzaW9uIHJlcG9ydFxuICAgICAqIEBjb25zdHJ1Y3RzXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuX3Nlc3Npb25TdGFydFRpbWUgPSBudWxsO1xuICAgICAgICB0aGlzLl9zZXNzaW9uRW5kVGltZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2d1bVRpbWVNaWxsaXMgPSBudWxsO1xuICAgICAgICB0aGlzLl9pbml0aWFsaXphdGlvblRpbWVNaWxsaXMgPSBudWxsO1xuICAgICAgICB0aGlzLl9pY2VDb2xsZWN0aW9uVGltZU1pbGxpcyA9IG51bGw7XG4gICAgICAgIHRoaXMuX3NpZ25hbGxpbmdDb25uZWN0VGltZU1pbGxpcyA9IG51bGw7XG4gICAgICAgIHRoaXMuX2hhbmRzaGFraW5nVGltZU1pbGxpcyA9IG51bGw7XG4gICAgICAgIHRoaXMuX3ByZVRhbGtpbmdUaW1lTWlsbGlzID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdGFsa2luZ1RpbWVNaWxsaXMgPSBudWxsO1xuICAgICAgICB0aGlzLl9pY2VDb25uZWN0aW9uc0xvc3QgPSAwO1xuICAgICAgICB0aGlzLl9pY2VDb25uZWN0aW9uc0ZhaWxlZCA9IG51bGw7XG4gICAgICAgIHRoaXMuX3BlZXJDb25uZWN0aW9uRmFpbGVkID0gbnVsbDtcbiAgICAgICAgdGhpcy5fY2xlYW51cFRpbWVNaWxsaXMgPSBudWxsO1xuICAgICAgICB0aGlzLl9pY2VDb2xsZWN0aW9uRmFpbHVyZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3NpZ25hbGxpbmdDb25uZWN0aW9uRmFpbHVyZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2hhbmRzaGFraW5nRmFpbHVyZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2d1bU90aGVyRmFpbHVyZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2d1bVRpbWVvdXRGYWlsdXJlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fY3JlYXRlT2ZmZXJGYWlsdXJlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fc2V0TG9jYWxEZXNjcmlwdGlvbkZhaWx1cmUgPSBudWxsO1xuICAgICAgICB0aGlzLl91c2VyQnVzeUZhaWx1cmUgPSBudWxsO1xuICAgICAgICB0aGlzLl9pbnZhbGlkUmVtb3RlU0RQRmFpbHVyZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX25vUmVtb3RlSWNlQ2FuZGlkYXRlRmFpbHVyZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3NldFJlbW90ZURlc2NyaXB0aW9uRmFpbHVyZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3N0cmVhbVN0YXRzID0gW107XG4gICAgICAgIHRoaXMuX3J0Y0pzVmVyc2lvbiA9IFwiQEBSVENfSlNfVkVSU0lPTlwiXG4gICAgfVxuICAgIC8qKlxuICAgICAqVGltZXN0YW1wIHdoZW4gUlRDU2Vzc2lvbiBzdGFydGVkLlxuICAgICAqL1xuICAgIGdldCBzZXNzaW9uU3RhcnRUaW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2Vzc2lvblN0YXJ0VGltZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGltZXN0YW1wIHdoZW4gUlRDU2Vzc2lvbiBlbmRlZC5cbiAgICAgKi9cbiAgICBnZXQgc2Vzc2lvbkVuZFRpbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXNzaW9uRW5kVGltZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGltZSB0YWtlbiBmb3IgZ3JhYmJpbmcgdXNlciBtaWNyb3Bob25lIGF0IHRoZSB0aW1lIG9mIGNvbm5lY3RpbmcgUlRDU2Vzc2lvbi5cbiAgICAgKi9cbiAgICBnZXQgZ3VtVGltZU1pbGxpcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2d1bVRpbWVNaWxsaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRpbWUgdGFrZW4gZm9yIHNlc3Npb24gaW5pdGlhbGl6YXRpb24gaW4gbWlsbGlzLiBJbmNsdWRlcyB0aW1lIHNwZW50IGluIEdyYWJMb2NhbE1lZGlhLCBTZXRMb2NhbFNEUCBzdGF0ZXMuXG4gICAgICovXG4gICAgZ2V0IGluaXRpYWxpemF0aW9uVGltZU1pbGxpcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2luaXRpYWxpemF0aW9uVGltZU1pbGxpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGltZSBzcGVudCBvbiBJQ0VDb2xsZWN0aW9uIGluIG1pbGxpcy5cbiAgICAgKi9cbiAgICBnZXQgaWNlQ29sbGVjdGlvblRpbWVNaWxsaXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pY2VDb2xsZWN0aW9uVGltZU1pbGxpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGltZSB0YWtlbiBmb3IgY29ubmVjdGluZyB0aGUgc2lnbmFsbGluZyBpbiBtaWxsaXMuXG4gICAgICovXG4gICAgZ2V0IHNpZ25hbGxpbmdDb25uZWN0VGltZU1pbGxpcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NpZ25hbGxpbmdDb25uZWN0VGltZU1pbGxpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGltZXMgc3BlbnQgZnJvbSBSVENTZXNzaW9uIGNvbm5lY3Rpb24gdW50aWwgZW50ZXJpbmcgVGFsa2luZyBzdGF0ZSBpbiBtaWxsaXMuXG4gICAgICovXG4gICAgZ2V0IHByZVRhbGtpbmdUaW1lTWlsbGlzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcHJlVGFsa2luZ1RpbWVNaWxsaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqICBUaW1lcyBzcGVudCBpbiBjb21wbGV0aW5nIGhhbmRzaGFraW5nIHByb2Nlc3Mgb2YgdGhlIFJUQ1Nlc3Npb24gaW4gbWlsbGlzLlxuICAgICAqL1xuICAgIGdldCBoYW5kc2hha2luZ1RpbWVNaWxsaXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9oYW5kc2hha2luZ1RpbWVNaWxsaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqICBUaW1lcyBzcGVudCBpbiBUYWxraW5nIHN0YXRlIGluIG1pbGxpcy5cbiAgICAgKi9cbiAgICBnZXQgdGFsa2luZ1RpbWVNaWxsaXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90YWxraW5nVGltZU1pbGxpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogSG93IG1hbnkgdGltZXMgdGhlIFJUQ1Nlc3Npb24gaGFzIGxvc3QgSUNFIGNvbm5lY3Rpb24gaW4gdGFsa2luZyBzdGF0ZS5cbiAgICAgKi9cbiAgICBnZXQgaWNlQ29ubmVjdGlvbnNMb3N0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faWNlQ29ubmVjdGlvbnNMb3N0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUZWxscyBpZiB0aGUgUlRDU2Vzc2lvbiBoYXMgZmFpbGVkIFJUQ1BlZXJDb25uZWN0aW9uLmljZUNvbm5lY3Rpb25TdGF0ZVxuICAgICAqL1xuICAgIGdldCBpY2VDb25uZWN0aW9uc0ZhaWxlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ljZUNvbm5lY3Rpb25zRmFpbGVkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUZWxscyBpZiB0aGUgUlRDU2Vzc2lvbiBoYXMgZmFpbGVkIFJUQ1BlZXJDb25uZWN0aW9uLmNvbm5lY3Rpb25TdGF0ZVxuICAgICAqL1xuICAgIGdldCBwZWVyQ29ubmVjdGlvbkZhaWxlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BlZXJDb25uZWN0aW9uRmFpbGVkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaW1lcyBzcGVudCBpbiBDbGVhbnVwIHN0YXRlIGluIG1pbGxpc1xuICAgICAqL1xuICAgIGdldCBjbGVhbnVwVGltZU1pbGxpcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NsZWFudXBUaW1lTWlsbGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUZWxscyBpZiB0aGUgUlRDU2Vzc2lvbiBmYWlscyBpbiBJQ0VDb2xsZWN0aW9uLlxuICAgICAqL1xuICAgIGdldCBpY2VDb2xsZWN0aW9uRmFpbHVyZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ljZUNvbGxlY3Rpb25GYWlsdXJlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUZWxscyBpZiB0aGUgUlRDU2Vzc2lvbiBmYWlsZWQgaW4gc2lnbmFsbGluZyBjb25uZWN0IHN0YWdlLlxuICAgICAqL1xuICAgIGdldCBzaWduYWxsaW5nQ29ubmVjdGlvbkZhaWx1cmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zaWduYWxsaW5nQ29ubmVjdGlvbkZhaWx1cmU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEhhbmRzaGFraW5nIGZhaWx1cmUgb2YgdGhlIFJUQ1Nlc3Npb25cbiAgICAgKi9cbiAgICBnZXQgaGFuZHNoYWtpbmdGYWlsdXJlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faGFuZHNoYWtpbmdGYWlsdXJlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHdW0gZmFpbGVkIGR1ZSB0byB0aW1lb3V0IGF0IHRoZSB0aW1lIG9mIG5ldyBSVENTZXNzaW9uIGNvbm5lY3Rpb25cbiAgICAgKi9cbiAgICBnZXQgZ3VtVGltZW91dEZhaWx1cmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ndW1UaW1lb3V0RmFpbHVyZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR3VtIGZhaWxlZCBkdWUgdG8gb3RoZXIgcmVhc29ucyAob3RoZXIgdGhhbiBUaW1lb3V0KVxuICAgICAqL1xuICAgIGdldCBndW1PdGhlckZhaWx1cmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ndW1PdGhlckZhaWx1cmU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJUQyBTZXNzaW9uIGZhaWxlZCBpbiBjcmVhdGUgT2ZmZXIgc3RhdGUuXG4gICAgICovXG4gICAgZ2V0IGNyZWF0ZU9mZmVyRmFpbHVyZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZU9mZmVyRmFpbHVyZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGVsbHMgaWYgc2V0TG9jYWxEZXNjcmlwdGlvbiBmYWlsZWQgZm9yIHRoZSBSVEMgU2Vzc2lvbi5cbiAgICAgKi9cbiAgICBnZXQgc2V0TG9jYWxEZXNjcmlwdGlvbkZhaWx1cmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXRMb2NhbERlc2NyaXB0aW9uRmFpbHVyZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGVsbHMgaWYgaGFuZHNoYWtpbmcgZmFpbGVkIGR1ZSB0byB1c2VyIGJ1c3kgY2FzZSxcbiAgICAgKiBoYXBwZW5zIHdoZW4gbXVsdGlwbGUgc29mdHBob25lIGNhbGxzIGFyZSBpbml0aWF0ZWQgYXQgc2FtZSB0aW1lLlxuICAgICAqL1xuICAgIGdldCB1c2VyQnVzeUZhaWx1cmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl91c2VyQnVzeUZhaWx1cmU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRlbGxzIGl0IHJlbW90ZSBTRFAgaXMgaW52YWxpZC5cbiAgICAgKi9cbiAgICBnZXQgaW52YWxpZFJlbW90ZVNEUEZhaWx1cmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnZhbGlkUmVtb3RlU0RQRmFpbHVyZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGVsbHMgaWYgdGhlIHNldFJlbW90ZURlc2NyaXB0aW9uIGZhaWxlZCBmb3IgdGhlIFJUQyBTZXNzaW9uLlxuICAgICAqL1xuICAgIGdldCBzZXRSZW1vdGVEZXNjcmlwdGlvbkZhaWx1cmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXRSZW1vdGVEZXNjcmlwdGlvbkZhaWx1cmU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEEgZmFpbHVyZSBjYXNlIHdoZW4gdGhlcmUgaXMgbm8gUmVtb3RlSWNlQ2FuZGlkYXRlLlxuICAgICAqL1xuICAgIGdldCBub1JlbW90ZUljZUNhbmRpZGF0ZUZhaWx1cmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ub1JlbW90ZUljZUNhbmRpZGF0ZUZhaWx1cmU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXRpc3RpY3MgZm9yIGVhY2ggc3RyZWFtKGF1ZGlvLWluLCBhdWRpby1vdXQsIHZpZGVvLWluLCB2aWRlby1vdXQpIG9mIHRoZSBSVENTZXNzaW9uLlxuICAgICAqL1xuICAgIGdldCBzdHJlYW1TdGF0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0cmVhbVN0YXRzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBnZXQgY3VycmVudCBjb25uZWN0LXJ0Yy1qcyB2ZXJzaW9uXG4gICAgICovXG4gICAgZ2V0IHJ0Y0pzVmVyc2lvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3J0Y0pzVmVyc2lvbjtcbiAgICB9XG5cbiAgICBzZXQgc2Vzc2lvblN0YXJ0VGltZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zZXNzaW9uU3RhcnRUaW1lID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBzZXNzaW9uRW5kVGltZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zZXNzaW9uRW5kVGltZSA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgZ3VtVGltZU1pbGxpcyh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9ndW1UaW1lTWlsbGlzID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBpbml0aWFsaXphdGlvblRpbWVNaWxsaXModmFsdWUpIHtcbiAgICAgICAgdGhpcy5faW5pdGlhbGl6YXRpb25UaW1lTWlsbGlzID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBpY2VDb2xsZWN0aW9uVGltZU1pbGxpcyh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9pY2VDb2xsZWN0aW9uVGltZU1pbGxpcyA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgc2lnbmFsbGluZ0Nvbm5lY3RUaW1lTWlsbGlzKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3NpZ25hbGxpbmdDb25uZWN0VGltZU1pbGxpcyA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgcHJlVGFsa2luZ1RpbWVNaWxsaXModmFsdWUpIHtcbiAgICAgICAgdGhpcy5fcHJlVGFsa2luZ1RpbWVNaWxsaXMgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IGhhbmRzaGFraW5nVGltZU1pbGxpcyh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9oYW5kc2hha2luZ1RpbWVNaWxsaXMgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IHRhbGtpbmdUaW1lTWlsbGlzKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3RhbGtpbmdUaW1lTWlsbGlzID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBpY2VDb25uZWN0aW9uc0xvc3QodmFsdWUpIHtcbiAgICAgICAgdGhpcy5faWNlQ29ubmVjdGlvbnNMb3N0ID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBpY2VDb25uZWN0aW9uc0ZhaWxlZCh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9pY2VDb25uZWN0aW9uc0ZhaWxlZCA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgcGVlckNvbm5lY3Rpb25GYWlsZWQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fcGVlckNvbm5lY3Rpb25GYWlsZWQgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IGNsZWFudXBUaW1lTWlsbGlzKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2NsZWFudXBUaW1lTWlsbGlzID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBpY2VDb2xsZWN0aW9uRmFpbHVyZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9pY2VDb2xsZWN0aW9uRmFpbHVyZSA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgc2lnbmFsbGluZ0Nvbm5lY3Rpb25GYWlsdXJlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3NpZ25hbGxpbmdDb25uZWN0aW9uRmFpbHVyZSA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgaGFuZHNoYWtpbmdGYWlsdXJlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2hhbmRzaGFraW5nRmFpbHVyZSA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgZ3VtVGltZW91dEZhaWx1cmUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fZ3VtVGltZW91dEZhaWx1cmUgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IGd1bU90aGVyRmFpbHVyZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9ndW1PdGhlckZhaWx1cmUgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IGNyZWF0ZU9mZmVyRmFpbHVyZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9jcmVhdGVPZmZlckZhaWx1cmUgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IHNldExvY2FsRGVzY3JpcHRpb25GYWlsdXJlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3NldExvY2FsRGVzY3JpcHRpb25GYWlsdXJlID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCB1c2VyQnVzeUZhaWx1cmUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdXNlckJ1c3lGYWlsdXJlID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBpbnZhbGlkUmVtb3RlU0RQRmFpbHVyZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9pbnZhbGlkUmVtb3RlU0RQRmFpbHVyZSA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgbm9SZW1vdGVJY2VDYW5kaWRhdGVGYWlsdXJlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX25vUmVtb3RlSWNlQ2FuZGlkYXRlRmFpbHVyZSA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgc2V0UmVtb3RlRGVzY3JpcHRpb25GYWlsdXJlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3NldFJlbW90ZURlc2NyaXB0aW9uRmFpbHVyZSA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgc3RyZWFtU3RhdHModmFsdWUpIHtcbiAgICAgICAgdGhpcy5fc3RyZWFtU3RhdHMgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IHJ0Y0pzVmVyc2lvbih2YWx1ZSkge1xuICAgICAgICB0aGlzLl9ydGNKc1ZlcnNpb24gPSB2YWx1ZTtcbiAgICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiAqL1xuXG5pbXBvcnQgeyBnZXRSZWRhY3RlZFNkcCwgaGl0Y2gsIHdyYXBMb2dnZXJ9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgTUFYX0lOVklURV9ERUxBWV9NUywgTUFYX0FDQ0VQVF9CWUVfREVMQVlfTVMsIERFRkFVTFRfQ09OTkVDVF9USU1FT1VUX01TLCBJTlZJVEVfTUVUSE9EX05BTUUsIEFDQ0VQVF9NRVRIT0RfTkFNRSwgQllFX01FVEhPRF9OQU1FIH0gZnJvbSAnLi9ydGNfY29uc3QnO1xuaW1wb3J0IHsgVW5zdXBwb3J0ZWRPcGVyYXRpb24sIFRpbWVvdXQsIEJ1c3lFeGNlcHRpb24sIENhbGxOb3RGb3VuZEV4Y2VwdGlvbiwgVW5rbm93blNpZ25hbGluZ0Vycm9yIH0gZnJvbSAnLi9leGNlcHRpb25zJztcbmltcG9ydCB1dWlkIGZyb20gJ3V1aWQvdjQnO1xuaW1wb3J0IFZpcnR1YWxXc3NDb25uZWN0aW9uTWFuYWdlciBmcm9tIFwiLi92aXJ0dWFsX3dzc19jb25uZWN0aW9uX21hbmFnZXJcIjtcblxudmFyIENPTk5FQ1RfTUFYX1JFVFJJRVMgPSAzO1xuXG4vKipcbiAqIEFic3RyYWN0IHNpZ25hbGluZyBzdGF0ZSBjbGFzcy5cbiAqL1xuZXhwb3J0IGNsYXNzIFNpZ25hbGluZ1N0YXRlIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0Ftem5SdGNTaWduYWxpbmd9IHNpZ25hbGluZyBTaWduYWxpbmcgb2JqZWN0LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNpZ25hbGluZykge1xuICAgICAgICB0aGlzLl9zaWduYWxpbmcgPSBzaWduYWxpbmc7XG4gICAgICAgIHRoaXMuX2NyZWF0ZVRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICB9XG4gICAgc2V0U3RhdGVUaW1lb3V0KHRpbWVvdXRNcykge1xuICAgICAgICBzZXRUaW1lb3V0KGhpdGNoKHRoaXMsIHRoaXMuX29uVGltZW91dENoZWNrZWQpLCB0aW1lb3V0TXMpO1xuICAgIH1cbiAgICBnZXQgaXNDdXJyZW50U3RhdGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzID09PSB0aGlzLl9zaWduYWxpbmcuc3RhdGU7XG4gICAgfVxuICAgIG9uRW50ZXIoKSB7fVxuICAgIF9vblRpbWVvdXRDaGVja2VkKCkge1xuICAgICAgICBpZiAodGhpcy5pc0N1cnJlbnRTdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5vblRpbWVvdXQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvblRpbWVvdXQoKSB7XG4gICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbigpO1xuICAgIH1cbiAgICB0cmFuc2l0KG5ld1N0YXRlKSB7XG4gICAgICAgIHRoaXMuX3NpZ25hbGluZy50cmFuc2l0KG5ld1N0YXRlKTtcbiAgICB9XG4gICAgb25FeGl0KCkge31cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbignb25PcGVuIG5vdCBzdXBwb3J0ZWQgYnkgJyArIHRoaXMubmFtZSk7XG4gICAgfVxuICAgIG9uRXJyb3IoKSB7XG4gICAgICAgIHRoaXMuY2hhbm5lbERvd24oKTtcbiAgICB9XG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgdGhpcy5jaGFubmVsRG93bigpO1xuICAgIH1cbiAgICBjaGFubmVsRG93bigpIHtcbiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uKCdjaGFubmVsRG93biBub3Qgc3VwcG9ydGVkIGJ5ICcgKyB0aGlzLm5hbWUpO1xuICAgIH1cbiAgICBvblJwY01zZyhycGNNc2cpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb24oJ29uUnBjTXNnIG5vdCBzdXBwb3J0ZWQgYnkgJyArIHRoaXMubmFtZSk7XG4gICAgfVxuICAgIGludml0ZShzZHAsIGljZUNhbmRpZGF0ZXMpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb24oJ2ludml0ZSBub3Qgc3VwcG9ydGVkIGJ5ICcgKyB0aGlzLm5hbWUpO1xuICAgIH1cbiAgICBhY2NlcHQoKSB7XG4gICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbignYWNjZXB0IG5vdCBzdXBwb3J0ZWQgYnkgJyArIHRoaXMubmFtZSk7XG4gICAgfVxuICAgIGhhbmd1cCgpIHtcbiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uKCdoYW5ndXAgbm90IHN1cHBvcnRlZCBieSAnICsgdGhpcy5uYW1lKTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIlNpZ25hbGluZ1N0YXRlXCI7XG4gICAgfVxuICAgIGdldCBsb2dnZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zaWduYWxpbmcuX2xvZ2dlcjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgRmFpbE9uVGltZW91dFN0YXRlIGV4dGVuZHMgU2lnbmFsaW5nU3RhdGUge1xuICAgIGNvbnN0cnVjdG9yKHNpZ25hbGluZywgdGltZW91dE1zKSB7XG4gICAgICAgIHN1cGVyKHNpZ25hbGluZyk7XG4gICAgICAgIHRoaXMuX3RpbWVvdXRNcyA9IHRpbWVvdXRNcztcbiAgICB9XG4gICAgb25FbnRlcigpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZVRpbWVvdXQodGhpcy5fdGltZW91dE1zKTtcbiAgICB9XG4gICAgb25UaW1lb3V0KCkge1xuICAgICAgICB0aGlzLnRyYW5zaXQobmV3IEZhaWxlZFN0YXRlKHRoaXMuX3NpZ25hbGluZywgbmV3IFRpbWVvdXQoKSkpO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiRmFpbE9uVGltZW91dFN0YXRlXCI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFBlbmRpbmdDb25uZWN0U3RhdGUgZXh0ZW5kcyBGYWlsT25UaW1lb3V0U3RhdGUge1xuICAgIGNvbnN0cnVjdG9yKHNpZ25hbGluZywgdGltZW91dE1zLCBpbml0aWFsU3RhcnRUaW1lSW4sIHJldHJpZXNJbikge1xuICAgICAgICBzdXBlcihzaWduYWxpbmcsIHRpbWVvdXRNcyk7XG4gICAgICAgIHRoaXMuX2luaXRpYWxTdGFydFRpbWUgPSBpbml0aWFsU3RhcnRUaW1lSW4gfHwgbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgIHRoaXMuX3JldHJpZXMgPSByZXRyaWVzSW4gfHwgMDtcbiAgICB9XG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aGlzLnRyYW5zaXQobmV3IFBlbmRpbmdJbnZpdGVTdGF0ZSh0aGlzLl9zaWduYWxpbmcpKTtcbiAgICB9XG4gICAgY2hhbm5lbERvd24oKSB7XG4gICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICAgdmFyIHVudGlsVGltZW91dE1zID0gKHRoaXMuX2luaXRpYWxTdGFydFRpbWUgKyB0aGlzLl90aW1lb3V0TXMpIC0gbm93O1xuICAgICAgICBpZiAodW50aWxUaW1lb3V0TXMgPiAwICYmICsrdGhpcy5fcmV0cmllcyA8IENPTk5FQ1RfTUFYX1JFVFJJRVMpIHtcbiAgICAgICAgICAgIHRoaXMuX3NpZ25hbGluZy5fY29ubmVjdCgpO1xuICAgICAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBQZW5kaW5nQ29ubmVjdFN0YXRlKHRoaXMuX3NpZ25hbGluZywgdW50aWxUaW1lb3V0TXMsIHRoaXMuX2luaXRpYWxTdGFydFRpbWUsIHRoaXMuX3JldHJpZXMpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUodGhpcy5fc2lnbmFsaW5nLCBuZXcgRXJyb3IoJ2NoYW5uZWxEb3duJykpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiUGVuZGluZ0Nvbm5lY3RTdGF0ZVwiO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBQZW5kaW5nSW52aXRlU3RhdGUgZXh0ZW5kcyBTaWduYWxpbmdTdGF0ZSB7XG4gICAgb25FbnRlcigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiBub3RpZnlDb25uZWN0ZWQocmVzb2x2ZSkge1xuICAgICAgICAgICAgc2VsZi5fc2lnbmFsaW5nLl9jb25uZWN0ZWRIYW5kbGVyKCk7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpbnZpdGUoc2RwLCBpY2VDYW5kaWRhdGVzKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGludml0ZUlkID0gdXVpZCgpO1xuXG4gICAgICAgIHZhciBpbnZpdGVQYXJhbXMgPSB7XG4gICAgICAgICAgICBzZHA6IHNkcCxcbiAgICAgICAgICAgIGNhbmRpZGF0ZXM6IGljZUNhbmRpZGF0ZXMsXG4gICAgICAgICAgICBjYWxsQ29udGV4dFRva2VuIDogc2VsZi5fc2lnbmFsaW5nLl9jb250YWN0VG9rZW5cbiAgICAgICAgfTtcbiAgICAgICAgc2VsZi5sb2dnZXIubG9nKCdTZW5kaW5nIFNEUCcsIGdldFJlZGFjdGVkU2RwKHNkcCkpO1xuICAgICAgICBzZWxmLl9zaWduYWxpbmcuX3dzcy5zZW5kKEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICAgICAgbWV0aG9kOiBJTlZJVEVfTUVUSE9EX05BTUUsXG4gICAgICAgICAgICBwYXJhbXM6IGludml0ZVBhcmFtcyxcbiAgICAgICAgICAgIGlkOiBpbnZpdGVJZFxuICAgICAgICB9KSk7XG4gICAgICAgIHNlbGYudHJhbnNpdChuZXcgUGVuZGluZ0Fuc3dlclN0YXRlKHNlbGYuX3NpZ25hbGluZywgaW52aXRlSWQpKTtcbiAgICB9XG4gICAgY2hhbm5lbERvd24oKSB7XG4gICAgICAgIHRoaXMudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUodGhpcy5fc2lnbmFsaW5nKSk7XG4gICAgfVxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJQZW5kaW5nSW52aXRlU3RhdGVcIjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgUGVuZGluZ0Fuc3dlclN0YXRlIGV4dGVuZHMgRmFpbE9uVGltZW91dFN0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcihzaWduYWxpbmcsIGludml0ZUlkKSB7XG4gICAgICAgIHN1cGVyKHNpZ25hbGluZywgTUFYX0lOVklURV9ERUxBWV9NUyk7XG4gICAgICAgIHRoaXMuX2ludml0ZUlkID0gaW52aXRlSWQ7XG4gICAgfVxuICAgIG9uUnBjTXNnKG1zZykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGlmIChtc2cuaWQgPT09IHRoaXMuX2ludml0ZUlkKSB7XG4gICAgICAgICAgICBpZiAobXNnLmVycm9yIHx8ICFtc2cucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBGYWlsZWRTdGF0ZSh0aGlzLl9zaWduYWxpbmcsIHNlbGYudHJhbnNsYXRlSW52aXRlRXJyb3IobXNnKSkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiBub3RpZnlBbnN3ZXJlZChyZXNvbHZlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubG9nZ2VyLmxvZygnUmVjZWl2ZWQgU0RQJywgZ2V0UmVkYWN0ZWRTZHAobXNnLnJlc3VsdC5zZHApKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2lnbmFsaW5nLl9hbnN3ZXJlZEhhbmRsZXIobXNnLnJlc3VsdC5zZHAsIG1zZy5yZXN1bHQuY2FuZGlkYXRlcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zaXQobmV3IFBlbmRpbmdBY2NlcHRTdGF0ZSh0aGlzLl9zaWduYWxpbmcsIHRoaXMuX3NpZ25hbGluZy5fYXV0b0Fuc3dlcikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHRyYW5zbGF0ZUludml0ZUVycm9yKG1zZykge1xuICAgICAgICBpZiAobXNnLmVycm9yICYmIG1zZy5lcnJvci5jb2RlID09IDQ4Nikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBCdXN5RXhjZXB0aW9uKG1zZy5lcnJvci5tZXNzYWdlKTtcbiAgICAgICAgfSBlbHNlIGlmIChtc2cuZXJyb3IgJiYgbXNnLmVycm9yLmNvZGUgPT0gNDA0KSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IENhbGxOb3RGb3VuZEV4Y2VwdGlvbihtc2cuZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFVua25vd25TaWduYWxpbmdFcnJvcigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIlBlbmRpbmdBbnN3ZXJTdGF0ZVwiO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBQZW5kaW5nQWNjZXB0U3RhdGUgZXh0ZW5kcyBTaWduYWxpbmdTdGF0ZSB7XG4gICAgY29uc3RydWN0b3Ioc2lnbmFsaW5nLCBhdXRvQW5zd2VyKSB7XG4gICAgICAgIHN1cGVyKHNpZ25hbGluZyk7XG4gICAgICAgIHRoaXMuX2F1dG9BbnN3ZXIgPSBhdXRvQW5zd2VyO1xuICAgIH1cbiAgICBvbkVudGVyKCkge1xuICAgICAgICBpZiAodGhpcy5fYXV0b0Fuc3dlcikge1xuICAgICAgICAgICAgdGhpcy5hY2NlcHQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhY2NlcHQoKSB7XG4gICAgICAgIHRoaXMuc2VuZEFjY2VwdFJlcXVlc3QoKTtcbiAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBUYWxraW5nU3RhdGUodGhpcy5fc2lnbmFsaW5nKSk7XG4gICAgfVxuICAgIGNoYW5uZWxEb3duKCkge1xuICAgICAgICB0aGlzLnRyYW5zaXQobmV3IEZhaWxlZFN0YXRlKHRoaXMuX3NpZ25hbGluZykpO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiUGVuZGluZ0FjY2VwdFN0YXRlXCI7XG4gICAgfVxuICAgIGFzeW5jIHNlbmRBY2NlcHRSZXF1ZXN0KCkge1xuICAgICAgICB2YXIgYWNjZXB0SWQgPSB1dWlkKCk7XG4gICAgICAgIHRoaXMuX3NpZ25hbGluZy5fd3NzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgICAgICBtZXRob2Q6IEFDQ0VQVF9NRVRIT0RfTkFNRSxcbiAgICAgICAgICAgIHBhcmFtczoge30sXG4gICAgICAgICAgICBpZDogYWNjZXB0SWRcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBQZW5kaW5nQWNjZXB0QWNrU3RhdGUgZXh0ZW5kcyBGYWlsT25UaW1lb3V0U3RhdGUge1xuICAgIGNvbnN0cnVjdG9yKHNpZ25hbGluZywgYWNjZXB0SWQpIHtcbiAgICAgICAgc3VwZXIoc2lnbmFsaW5nLCBNQVhfQUNDRVBUX0JZRV9ERUxBWV9NUyk7XG4gICAgICAgIHRoaXMuX2FjY2VwdElkID0gYWNjZXB0SWQ7XG4gICAgfVxuICAgIG9uUnBjTXNnKG1zZykge1xuICAgICAgICBpZiAobXNnLmlkID09PSB0aGlzLl9hY2NlcHRJZCkge1xuICAgICAgICAgICAgaWYgKG1zZy5lcnJvcikge1xuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUodGhpcy5fc2lnbmFsaW5nKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3NpZ25hbGluZy5fY2xpZW50VG9rZW4gPSBtc2cucmVzdWx0LmNsaWVudFRva2VuO1xuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNpdChuZXcgVGFsa2luZ1N0YXRlKHRoaXMuX3NpZ25hbGluZykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJQZW5kaW5nQWNjZXB0QWNrU3RhdGVcIjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgVGFsa2luZ1N0YXRlIGV4dGVuZHMgU2lnbmFsaW5nU3RhdGUge1xuICAgIG9uRW50ZXIoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gbm90aWZ5SGFuZHNoYWtlZChyZXNvbHZlKSB7XG4gICAgICAgICAgICBzZWxmLl9zaWduYWxpbmcuX2hhbmRzaGFrZWRIYW5kbGVyKCk7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBoYW5ndXAoKSB7XG4gICAgICAgIHZhciBieWVJZCA9IHV1aWQoKTtcbiAgICAgICAgdGhpcy5fc2lnbmFsaW5nLl93c3Muc2VuZChKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBqc29ucnBjOiAnMi4wJyxcbiAgICAgICAgICAgIG1ldGhvZDogQllFX01FVEhPRF9OQU1FLFxuICAgICAgICAgICAgcGFyYW1zOiB7Y2FsbENvbnRleHRUb2tlbjogdGhpcy5fc2lnbmFsaW5nLl9jb250YWN0VG9rZW59LFxuICAgICAgICAgICAgaWQ6IGJ5ZUlkXG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBQZW5kaW5nUmVtb3RlSGFuZ3VwU3RhdGUodGhpcy5fc2lnbmFsaW5nLCBieWVJZCkpO1xuICAgIH1cbiAgICBvblJwY01zZyhtc2cpIHtcbiAgICAgICAgaWYgKG1zZy5tZXRob2QgPT09IEJZRV9NRVRIT0RfTkFNRSkge1xuICAgICAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBQZW5kaW5nTG9jYWxIYW5ndXBTdGF0ZSh0aGlzLl9zaWduYWxpbmcsIG1zZy5pZCkpO1xuICAgICAgICB9IGVsc2UgaWYgKG1zZy5tZXRob2QgPT09ICdyZW5ld0NsaWVudFRva2VuJykge1xuICAgICAgICAgICAgdGhpcy5fc2lnbmFsaW5nLl9jbGllbnRUb2tlbiA9IG1zZy5wYXJhbXMuY2xpZW50VG9rZW47XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2hhbm5lbERvd24oKSB7XG4gICAgICAgIHRoaXMuX3NpZ25hbGluZy5fcmVjb25uZWN0KCk7XG4gICAgICAgIHRoaXMuX3NpZ25hbGluZy50cmFuc2l0KG5ldyBQZW5kaW5nUmVjb25uZWN0U3RhdGUodGhpcy5fc2lnbmFsaW5nKSk7XG4gICAgfVxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJUYWxraW5nU3RhdGVcIjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgUGVuZGluZ1JlY29ubmVjdFN0YXRlIGV4dGVuZHMgRmFpbE9uVGltZW91dFN0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcihzaWduYWxpbmcpIHtcbiAgICAgICAgc3VwZXIoc2lnbmFsaW5nLCBERUZBVUxUX0NPTk5FQ1RfVElNRU9VVF9NUyk7XG4gICAgfVxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBUYWxraW5nU3RhdGUodGhpcy5fc2lnbmFsaW5nKSk7XG4gICAgfVxuICAgIGNoYW5uZWxEb3duKCkge1xuICAgICAgICB0aGlzLnRyYW5zaXQobmV3IEZhaWxlZFN0YXRlKHRoaXMuX3NpZ25hbGluZykpO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiUGVuZGluZ1JlY29ubmVjdFN0YXRlXCI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFBlbmRpbmdSZW1vdGVIYW5ndXBTdGF0ZSBleHRlbmRzIEZhaWxPblRpbWVvdXRTdGF0ZSB7XG4gICAgY29uc3RydWN0b3Ioc2lnbmFsaW5nLCBieWVJZCkge1xuICAgICAgICBzdXBlcihzaWduYWxpbmcsIE1BWF9BQ0NFUFRfQllFX0RFTEFZX01TKTtcbiAgICAgICAgdGhpcy5fYnllSWQgPSBieWVJZDtcbiAgICB9XG4gICAgb25ScGNNc2cobXNnKSB7XG4gICAgICAgIGlmIChtc2cuaWQgPT09IHRoaXMuX2J5ZUlkIHx8IG1zZy5tZXRob2QgPT09IEJZRV9NRVRIT0RfTkFNRSkge1xuICAgICAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBEaXNjb25uZWN0ZWRTdGF0ZSh0aGlzLl9zaWduYWxpbmcpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiUGVuZGluZ1JlbW90ZUhhbmd1cFN0YXRlXCI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFBlbmRpbmdMb2NhbEhhbmd1cFN0YXRlIGV4dGVuZHMgU2lnbmFsaW5nU3RhdGUge1xuICAgIGNvbnN0cnVjdG9yKHNpZ25hbGluZywgYnllSWQpIHtcbiAgICAgICAgc3VwZXIoc2lnbmFsaW5nKTtcbiAgICAgICAgdGhpcy5fYnllSWQgPSBieWVJZDtcbiAgICB9XG4gICAgb25FbnRlcigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiBub3RpZnlSZW1vdGVIdW5ndXAocmVzb2x2ZSkge1xuICAgICAgICAgICAgc2VsZi5fc2lnbmFsaW5nLl9yZW1vdGVIdW5ndXBIYW5kbGVyKCk7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBoYW5ndXAoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgc2VsZi5fc2lnbmFsaW5nLl93c3Muc2VuZChKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBqc29ucnBjOiAnMi4wJyxcbiAgICAgICAgICAgIHJlc3VsdDoge30sXG4gICAgICAgICAgICBpZDogc2VsZi5fYnllSWRcbiAgICAgICAgfSkpO1xuICAgICAgICBzZWxmLnRyYW5zaXQobmV3IERpc2Nvbm5lY3RlZFN0YXRlKHNlbGYuX3NpZ25hbGluZykpO1xuICAgIH1cbiAgICBvblJwY01zZygpIHtcbiAgICAgICAgLy9EbyBub3RoaW5nXG4gICAgfVxuICAgIGNoYW5uZWxEb3duKCkge1xuICAgICAgICB0aGlzLnRyYW5zaXQobmV3IERpc2Nvbm5lY3RlZFN0YXRlKHRoaXMuX3NpZ25hbGluZykpO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiUGVuZGluZ0xvY2FsSGFuZ3VwU3RhdGVcIjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgRGlzY29ubmVjdGVkU3RhdGUgZXh0ZW5kcyBTaWduYWxpbmdTdGF0ZSB7XG4gICAgb25FbnRlcigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiBub3RpZnlEaXNjb25uZWN0ZWQocmVzb2x2ZSkge1xuICAgICAgICAgICAgc2VsZi5fc2lnbmFsaW5nLl9kaXNjb25uZWN0ZWRIYW5kbGVyKCk7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9zaWduYWxpbmcuX3dzcy5jbG9zZSgpO1xuICAgIH1cbiAgICBjaGFubmVsRG93bigpIHtcbiAgICAgICAgLy9EbyBub3RoaW5nXG4gICAgfVxuICAgIG9uUnBjTXNnKCkge1xuICAgICAgICAvL0RvIG5vdGhpbmdcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIkRpc2Nvbm5lY3RlZFN0YXRlXCI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEZhaWxlZFN0YXRlIGV4dGVuZHMgU2lnbmFsaW5nU3RhdGUge1xuICAgIGNvbnN0cnVjdG9yKHNpZ25hbGluZywgZXhjZXB0aW9uKSB7XG4gICAgICAgIHN1cGVyKHNpZ25hbGluZyk7XG4gICAgICAgIHRoaXMuX2V4Y2VwdGlvbiA9IGV4Y2VwdGlvbjtcbiAgICB9XG4gICAgb25FbnRlcigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiBub3RpZnlGYWlsZWQocmVzb2x2ZSkge1xuICAgICAgICAgICAgc2VsZi5fc2lnbmFsaW5nLl9mYWlsZWRIYW5kbGVyKHNlbGYuX2V4Y2VwdGlvbik7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9zaWduYWxpbmcuX3dzcy5jbG9zZSgpO1xuICAgIH1cbiAgICBjaGFubmVsRG93bigpIHtcbiAgICAgICAgLy9EbyBub3RoaW5nXG4gICAgfVxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJGYWlsZWRTdGF0ZVwiO1xuICAgIH1cbiAgICBnZXQgZXhjZXB0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZXhjZXB0aW9uO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQW16blJ0Y1NpZ25hbGluZyB7XG4gICAgY29uc3RydWN0b3IoY2FsbElkLCBzaWduYWxpbmdVcmksIGNvbnRhY3RUb2tlbiwgbG9nZ2VyLCBjb25uZWN0VGltZW91dE1zLCBjb25uZWN0aW9uSWQsIHdzc01hbmFnZXIpIHtcbiAgICAgICAgdGhpcy5fY2FsbElkID0gY2FsbElkO1xuICAgICAgICB0aGlzLl9jb25uZWN0VGltZW91dE1zID0gY29ubmVjdFRpbWVvdXRNcyB8fCBERUZBVUxUX0NPTk5FQ1RfVElNRU9VVF9NUztcbiAgICAgICAgdGhpcy5fYXV0b0Fuc3dlciA9IHRydWU7XG4gICAgICAgIHRoaXMuX3NpZ25hbGluZ1VyaSA9IHNpZ25hbGluZ1VyaTtcbiAgICAgICAgdGhpcy5fY29udGFjdFRva2VuID0gY29udGFjdFRva2VuO1xuICAgICAgICB0aGlzLl9sb2dnZXIgPSB3cmFwTG9nZ2VyKGxvZ2dlciwgY2FsbElkLCAnU0lHTkFMSU5HJyk7XG4gICAgICAgIHRoaXMuX2Nvbm5lY3Rpb25JZCA9IGNvbm5lY3Rpb25JZDtcbiAgICAgICAgdGhpcy5fd3NzTWFuYWdlciA9IHdzc01hbmFnZXI7XG5cbiAgICAgICAgLy9lbXB0eSBldmVudCBoYW5kbGVyc1xuICAgICAgICB0aGlzLl9jb25uZWN0ZWRIYW5kbGVyID1cbiAgICAgICAgdGhpcy5fYW5zd2VyZWRIYW5kbGVyID1cbiAgICAgICAgdGhpcy5faGFuZHNoYWtlZEhhbmRsZXIgPVxuICAgICAgICB0aGlzLl9yZWNvbm5lY3RlZEhhbmRsZXIgPVxuICAgICAgICB0aGlzLl9yZW1vdGVIdW5ndXBIYW5kbGVyID1cbiAgICAgICAgdGhpcy5fZGlzY29ubmVjdGVkSGFuZGxlciA9XG4gICAgICAgIHRoaXMuX2ZhaWxlZEhhbmRsZXIgPSBmdW5jdGlvbiBub09wKCkge307XG4gICAgfVxuICAgIGdldCBjYWxsSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYWxsSWQ7XG4gICAgfVxuICAgIHNldCBvbkNvbm5lY3RlZChjb25uZWN0ZWRIYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX2Nvbm5lY3RlZEhhbmRsZXIgPSBjb25uZWN0ZWRIYW5kbGVyO1xuICAgIH1cbiAgICBzZXQgb25BbnN3ZXJlZChhbnN3ZXJlZEhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fYW5zd2VyZWRIYW5kbGVyID0gYW5zd2VyZWRIYW5kbGVyO1xuICAgIH1cbiAgICBzZXQgb25IYW5kc2hha2VkKGhhbmRzaGFrZWRIYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX2hhbmRzaGFrZWRIYW5kbGVyID0gaGFuZHNoYWtlZEhhbmRsZXI7XG4gICAgfVxuICAgIHNldCBvblJlY29ubmVjdGVkKHJlY29ubmVjdGVkSGFuZGxlcikge1xuICAgICAgICB0aGlzLl9yZWNvbm5lY3RlZEhhbmRsZXIgPSByZWNvbm5lY3RlZEhhbmRsZXI7XG4gICAgfVxuICAgIHNldCBvblJlbW90ZUh1bmd1cChyZW1vdGVIdW5ndXBIYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX3JlbW90ZUh1bmd1cEhhbmRsZXIgPSByZW1vdGVIdW5ndXBIYW5kbGVyO1xuICAgIH1cbiAgICBzZXQgb25EaXNjb25uZWN0ZWQoZGlzY29ubmVjdGVkSGFuZGxlcikge1xuICAgICAgICB0aGlzLl9kaXNjb25uZWN0ZWRIYW5kbGVyID0gZGlzY29ubmVjdGVkSGFuZGxlcjtcbiAgICB9XG4gICAgc2V0IG9uRmFpbGVkKGZhaWxlZEhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fZmFpbGVkSGFuZGxlciA9IGZhaWxlZEhhbmRsZXI7XG4gICAgfVxuICAgIGdldCBzdGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXRlO1xuICAgIH1cblxuICAgIGNvbm5lY3QoKSB7XG4gICAgICAgIHRoaXMuX2Nvbm5lY3QoKTtcbiAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBQZW5kaW5nQ29ubmVjdFN0YXRlKHRoaXMsIHRoaXMuX2Nvbm5lY3RUaW1lb3V0TXMpKTtcbiAgICB9XG5cbiAgICBfY29ubmVjdCgpIHtcbiAgICAgICAgdGhpcy5fd3NzID0gdGhpcy5fY29ubmVjdFdlYlNvY2tldCh0aGlzLl9idWlsZEludml0ZVVyaSgpKTtcbiAgICB9XG4gICAgdHJhbnNpdChuZXh0U3RhdGUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuX2xvZ2dlci5pbmZvKCh0aGlzLl9zdGF0ZSA/IHRoaXMuX3N0YXRlLm5hbWUgOiAnbnVsbCcpICsgJyA9PiAnICsgbmV4dFN0YXRlLm5hbWUpO1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUgJiYgdGhpcy5zdGF0ZS5vbkV4aXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLm9uRXhpdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBuZXh0U3RhdGU7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdGUub25FbnRlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlLm9uRW50ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBfY29ubmVjdFdlYlNvY2tldCh1cmkpIHtcbiAgICAgICAgbGV0IHdzQ29ubmVjdGlvbjtcbiAgICAgICAgaWYgKHRoaXMuX3dzc01hbmFnZXIpIHtcbiAgICAgICAgICAgIHdzQ29ubmVjdGlvbiA9IG5ldyBWaXJ0dWFsV3NzQ29ubmVjdGlvbk1hbmFnZXIodGhpcy5fbG9nZ2VyLCB0aGlzLl9jb25uZWN0aW9uSWQsIHRoaXMuX3dzc01hbmFnZXIpO1xuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICB3c0Nvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHVyaSk7XG4gICAgICAgIH1cbiAgICAgICAgd3NDb25uZWN0aW9uLm9ub3BlbiA9IGhpdGNoKHRoaXMsIHRoaXMuX29uT3Blbik7XG4gICAgICAgIHdzQ29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBoaXRjaCh0aGlzLCB0aGlzLl9vbk1lc3NhZ2UpO1xuICAgICAgICB3c0Nvbm5lY3Rpb24ub25lcnJvciA9IGhpdGNoKHRoaXMsIHRoaXMuX29uRXJyb3IpO1xuICAgICAgICB3c0Nvbm5lY3Rpb24ub25jbG9zZSA9IGhpdGNoKHRoaXMsIHRoaXMuX29uQ2xvc2UpO1xuICAgICAgICByZXR1cm4gd3NDb25uZWN0aW9uO1xuICAgIH1cbiAgICBfYnVpbGRJbnZpdGVVcmkoKSB7XG4gICAgICAgIGlmICh0aGlzLl9jb250YWN0VG9rZW4pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9idWlsZFVyaUJhc2UoKSArICcmY29udGFjdEN0eD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuX2NvbnRhY3RUb2tlbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYnVpbGRVcmlCYXNlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2J1aWxkUmVjb25uZWN0VXJpKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnVpbGRVcmlCYXNlKCkgKyAnJmNsaWVudFRva2VuPScgKyBlbmNvZGVVUklDb21wb25lbnQodGhpcy5fY2xpZW50VG9rZW4pO1xuICAgIH1cbiAgICBfYnVpbGRVcmlCYXNlKCkge1xuICAgICAgICB2YXIgc2VwYXJhdG9yID0gJz8nO1xuICAgICAgICBpZiAodGhpcy5fc2lnbmFsaW5nVXJpLmluZGV4T2Yoc2VwYXJhdG9yKSA+IC0xKSB7XG4gICAgICAgICAgICBzZXBhcmF0b3IgPSAnJic7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3NpZ25hbGluZ1VyaSArIHNlcGFyYXRvciArICdjYWxsSWQ9JyArIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLl9jYWxsSWQpO1xuICAgIH1cbiAgICBfb25NZXNzYWdlKGV2dCkge1xuICAgICAgICB0aGlzLnN0YXRlLm9uUnBjTXNnKEpTT04ucGFyc2UoZXZ0LmRhdGEpKTtcbiAgICB9XG4gICAgX29uT3BlbihldnQpIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5vbk9wZW4oZXZ0KTtcbiAgICB9XG4gICAgX29uRXJyb3IoZXZ0KSB7XG4gICAgICAgIHRoaXMuc3RhdGUub25FcnJvcihldnQpO1xuICAgIH1cbiAgICBfb25DbG9zZShldnQpIHtcbiAgICAgICAgdGhpcy5fbG9nZ2VyLmxvZygnV2ViU29ja2V0IG9uY2xvc2UgY29kZT0nICsgZXZ0LmNvZGUgKyAnLCByZWFzb249JyArIGV2dC5yZWFzb24pO1xuICAgICAgICB0aGlzLnN0YXRlLm9uQ2xvc2UoZXZ0KTtcbiAgICB9XG4gICAgX3JlY29ubmVjdCgpIHtcbiAgICAgICAgdGhpcy5fd3NzID0gdGhpcy5fY29ubmVjdFdlYlNvY2tldCh0aGlzLl9idWlsZFJlY29ubmVjdFVyaSgpKTtcbiAgICB9XG4gICAgaW52aXRlKHNkcCwgaWNlQ2FuZGlkYXRlcykge1xuICAgICAgICB0aGlzLnN0YXRlLmludml0ZShzZHAsIGljZUNhbmRpZGF0ZXMpO1xuICAgIH1cbiAgICBhY2NlcHQoKSB7XG4gICAgICAgIHRoaXMuc3RhdGUuYWNjZXB0KCk7XG4gICAgfVxuICAgIGhhbmd1cCgpIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5oYW5ndXAoKTtcbiAgICB9XG59IiwiXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDQ1BJbml0aWF0aW9uU3RyYXRlZ3lJbnRlcmZhY2Uge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkNDUEluaXRpYXRpb25TdHJhdGVneUludGVyZmFjZSBpbml0aWFsaXplZFwiKTtcbiAgICB9XG5cbiAgICBnZXRTdHJhdGVneU5hbWUoKXtcbiAgICAgICAgY29uc29sZS5lcnJvcihcImdldFN0cmF0ZWd5TmFtZSBuZWVkcyB0byBiZSBvdmVycmlkZGVuXCIpO1xuICAgIH1cblxuICAgIC8vIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb25zIGFyZSBydGNfcGVlcl9jb25uZWN0aW9uX2ZhY3RvcnkgcmVsYXRlZCBmdW5jdGlvbnNcbiAgICAvLyBjaGVjayBpZiB0aGUgYnJvd3NlciBzdXBwb3J0cyBlYXJseSBtZWRpYSBjb25uZWN0aW9uXG4gICAgX2lzRWFybHlNZWRpYUNvbm5lY3Rpb25TdXBwb3J0ZWQoKXtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIl9pc0Vhcmx5TWVkaWFDb25uZWN0aW9uU3VwcG9ydGVkIG5lZWRzIHRvIGJlIG92ZXJyaWRkZW5cIik7XG4gICAgfVxuXG4gICAgX2NyZWF0ZVJ0Y1BlZXJDb25uZWN0aW9uKCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiX2NyZWF0ZVJ0Y1BlZXJDb25uZWN0aW9uIG5lZWRzIHRvIGJlIG92ZXJyaWRkZW5cIik7XG4gICAgfVxuXG4gICAgLy8gdGhlIGZvbGxvd2luZyBmdW5jdGlvbnMgYXJlIHJ0Y19zZXNzaW9uIHJlbGF0ZWQgZnVuY3Rpb25zXG4gICAgX2d1TSgpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIl9ndU0gbmVlZHMgdG8gYmUgb3ZlcnJpZGRlblwiKTtcbiAgICB9XG5cbiAgICBhZGRTdHJlYW0oKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJhZGRTdHJlYW0gbmVlZHMgdG8gYmUgb3ZlcnJpZGRlblwiKTtcbiAgICB9XG5cbiAgICBzZXRSZW1vdGVEZXNjcmlwdGlvbigpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcInNldFJlbW90ZURlc2NyaXB0aW9uIG5lZWRzIHRvIGJlIG92ZXJyaWRkZW5cIik7XG4gICAgfVxuXG4gICAgb25JY2VTdGF0ZUNoYW5nZSgpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIm9uSWNlU3RhdGVDaGFuZ2UgbmVlZHMgdG8gYmUgb3ZlcnJpZGRlblwiKTtcbiAgICB9XG5cbiAgICBvblBlZXJDb25uZWN0aW9uU3RhdGVDaGFuZ2UoKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJvblBlZXJDb25uZWN0aW9uU3RhdGVDaGFuZ2UgbmVlZHMgdG8gYmUgb3ZlcnJpZGRlblwiKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlUGVlckNvbm5lY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJfY3JlYXRlUGVlckNvbm5lY3Rpb24gbmVlZHMgdG8gYmUgb3ZlcnJpZGRlblwiKTtcbiAgICB9XG5cbiAgICBjb25uZWN0KCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiY29ubmVjdCBuZWVkcyB0byBiZSBvdmVycmlkZGVuXCIpO1xuICAgIH1cblxuICAgIF9vbnRyYWNrKCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiX29udHJhY2sgbmVlZHMgdG8gYmUgb3ZlcnJpZGRlblwiKTtcbiAgICB9XG5cbiAgICBfYnVpbGRNZWRpYUNvbnN0cmFpbnRzKCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiX2J1aWxkTWVkaWFDb25zdHJhaW50cyBuZWVkcyB0byBiZSBvdmVycmlkZGVuXCIpO1xuICAgIH1cbn1cbiIsIi8qKlxuICogQnkgdXNpbmcgdGhlIENpdHJpeCB1Y3NkayAoaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvQGNpdHJpeC91Y3NkayksIHlvdSBhcmUgYWNjZXB0aW5nIHRoZSBDaXRyaXggRGV2ZWxvcGVyIFRlcm1zIG9mIFVzZSAgbG9jYXRlZCBoZXJlOiBodHRwczovL3d3dy5jbG91ZC5jb20vdGVybXMtb2YtdXNlLlxuICovXG5cbmltcG9ydCBDQ1BJbml0aWF0aW9uU3RyYXRlZ3lJbnRlcmZhY2UgZnJvbSBcIi4vQ0NQSW5pdGlhdGlvblN0cmF0ZWd5SW50ZXJmYWNlXCI7XG5pbXBvcnQge2hpdGNofSBmcm9tIFwiLi4vdXRpbHNcIjtcbmltcG9ydCB7RmFpbGVkU3RhdGV9IGZyb20gXCIuLi9ydGNfc2Vzc2lvblwiO1xuaW1wb3J0IHtSVENfRVJST1JTfSBmcm9tIFwiLi4vcnRjX2NvbnN0XCI7XG5pbXBvcnQgXCJAY2l0cml4L3Vjc2RrL0NpdHJpeFdlYlJUQ1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDaXRyaXhWRElTdHJhdGVneSBleHRlbmRzIENDUEluaXRpYXRpb25TdHJhdGVneUludGVyZmFjZSB7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKCF3aW5kb3cuQ2l0cml4V2ViUlRDLmlzRmVhdHVyZU9uKFwid2VicnRjMS4wXCIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NpdHJpeCBXZWJSVEMgcmVkaXJlY3Rpb24gZmVhdHVyZSBpcyBOT1Qgc3VwcG9ydGVkIScpO1xuICAgICAgICB9XG4gICAgICAgIHdpbmRvdy5nZXRDaXRyaXhXZWJydGNSZWRpciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2lzdHJ5VmFsdWUgPSBQcm9taXNlLnJlc29sdmUoMSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIC8vcmV0cmlldmUgcmVnaXN0cnkgdmFsdWUgaW50ZXJuYWxseVxuICAgICAgICAgICAgICAgIHJlZ2lzdHJ5VmFsdWUudGhlbigodikgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHYpO1xuICAgICAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgd2luZG93LkNpdHJpeFdlYlJUQy5pbml0TG9nKGdsb2JhbC5jb25uZWN0LmdldExvZygpKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJDaXRyaXhWRElTdHJhdGVneSBpbml0aWFsaXplZFwiKTtcbiAgICB9XG5cbiAgICAvLyB0aGUgZm9sbG93aW5nIGZ1bmN0aW9ucyBhcmUgcnRjX3BlZXJfY29ubmVjdGlvbl9mYWN0b3J5IHJlbGF0ZWQgZnVuY3Rpb25zXG4gICAgLy8gY2hlY2sgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgZWFybHkgbWVkaWEgY29ubmVjdGlvblxuICAgIF9pc0Vhcmx5TWVkaWFDb25uZWN0aW9uU3VwcG9ydGVkKCkge1xuICAgICAgICAvLyBDaXRyaXggV2ViUlRDIFNESyBkb2Vzbid0IHN1cHBvcnQgZWFybHkgbWVkaWEgY29ubmVjdGlvblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgX2NyZWF0ZVJ0Y1BlZXJDb25uZWN0aW9uKHJ0Y1BlZXJDb25uZWN0aW9uQ29uZmlnLCBydGNQZWVyQ29ubmVjdGlvbk9wdGlvbmFsQ29uZmlnKSB7XG4gICAgICAgIHJldHVybiBuZXcgd2luZG93LkNpdHJpeFdlYlJUQy5DaXRyaXhQZWVyQ29ubmVjdGlvbihydGNQZWVyQ29ubmVjdGlvbkNvbmZpZywgcnRjUGVlckNvbm5lY3Rpb25PcHRpb25hbENvbmZpZyk7XG4gICAgfVxuXG4gICAgLy8gdGhlIGZvbGxvd2luZyBmdW5jdGlvbnMgYXJlIHJ0Y19zZXNzaW9uIHJlbGF0ZWQgZnVuY3Rpb25zXG4gICAgX2dVTShjb25zdHJhaW50cykge1xuICAgICAgICByZXR1cm4gd2luZG93LkNpdHJpeFdlYlJUQy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpO1xuICAgIH1cblxuICAgIGFkZFN0cmVhbShfcGMsIHN0cmVhbSkge1xuICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaCh0cmFjayA9PiB7XG4gICAgICAgICAgICBfcGMuYWRkVHJhbnNjZWl2ZXIodHJhY2ssIHt9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2V0UmVtb3RlRGVzY3JpcHRpb24oc2VsZiwgcnRjU2Vzc2lvbikge1xuICAgICAgICBjb25zdCBhbnN3ZXJTZXNzaW9uRGVzY3JpcHRpb24gPSBzZWxmLl9jcmVhdGVTZXNzaW9uRGVzY3JpcHRpb24oe3R5cGU6ICdhbnN3ZXInLCBzZHA6IHNlbGYuX3NkcH0pO1xuXG4gICAgICAgIHJ0Y1Nlc3Npb24uX3BjLnNldFJlbW90ZURlc2NyaXB0aW9uKGFuc3dlclNlc3Npb25EZXNjcmlwdGlvbiwgKCkgPT4ge1xuICAgICAgICAgICAgdmFyIHJlbW90ZUNhbmRpZGF0ZVByb21pc2VzID0gUHJvbWlzZS5hbGwoc2VsZi5fY2FuZGlkYXRlcy5tYXAoZnVuY3Rpb24gKGNhbmRpZGF0ZSkge1xuICAgICAgICAgICAgICAgIHZhciByZW1vdGVDYW5kaWRhdGUgPSBzZWxmLl9jcmVhdGVSZW1vdGVDYW5kaWRhdGUoY2FuZGlkYXRlKTtcbiAgICAgICAgICAgICAgICBzZWxmLmxvZ2dlci5pbmZvKCdBZGRpbmcgcmVtb3RlIGNhbmRpZGF0ZScsIHJlbW90ZUNhbmRpZGF0ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJ0Y1Nlc3Npb24uX3BjLmFkZEljZUNhbmRpZGF0ZShyZW1vdGVDYW5kaWRhdGUpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmVtb3RlQ2FuZGlkYXRlUHJvbWlzZXMuY2F0Y2gocmVhc29uID0+IHtcbiAgICAgICAgICAgICAgICBzZWxmLmxvZ2dlci53YXJuKCdFcnJvciBhZGRpbmcgcmVtb3RlIGNhbmRpZGF0ZScsIHJlYXNvbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJ0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuc2V0UmVtb3RlRGVzY3JpcHRpb25GYWlsdXJlID0gZmFsc2U7XG4gICAgICAgICAgICBzZWxmLl9yZW1vdGVEZXNjcmlwdGlvblNldCA9IHRydWU7XG4gICAgICAgICAgICBzZWxmLl9jaGVja0FuZFRyYW5zaXQoKTtcbiAgICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAgICAgcnRjU2Vzc2lvbi5fc3RvcFNlc3Npb24oKTtcbiAgICAgICAgICAgIHJ0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuc2V0UmVtb3RlRGVzY3JpcHRpb25GYWlsdXJlID0gdHJ1ZTtcbiAgICAgICAgICAgIHNlbGYudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUocnRjU2Vzc2lvbiwgUlRDX0VSUk9SUy5TRVRfUkVNT1RFX0RFU0NSSVBUSU9OX0ZBSUxVUkUpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25JY2VTdGF0ZUNoYW5nZShldnQsIF9wYykge1xuICAgICAgICByZXR1cm4gX3BjLmljZUNvbm5lY3Rpb25TdGF0ZTtcbiAgICB9XG5cbiAgICBvblBlZXJDb25uZWN0aW9uU3RhdGVDaGFuZ2UoX3BjKSB7XG4gICAgICAgIHJldHVybiBfcGMuY29ubmVjdGlvblN0YXRlXztcbiAgICB9XG5cbiAgICBfY3JlYXRlUGVlckNvbm5lY3Rpb24oY29uZmlndXJhdGlvbiwgb3B0aW9uYWxDb25maWd1cmF0aW9uKSB7XG4gICAgICAgIHJldHVybiBuZXcgd2luZG93LkNpdHJpeFdlYlJUQy5DaXRyaXhQZWVyQ29ubmVjdGlvbihjb25maWd1cmF0aW9uLCBvcHRpb25hbENvbmZpZ3VyYXRpb24pO1xuICAgIH1cblxuICAgIGNvbm5lY3Qoc2VsZikge1xuICAgICAgICBzZWxmLl9wYy5vbmFkZHN0cmVhbSA9IGhpdGNoKHNlbGYsIHNlbGYuX29udHJhY2spO1xuICAgIH1cblxuICAgIF9vbnRyYWNrKHNlbGYsIGV2dCkge1xuICAgICAgICBjb25zdCByZW1vdGVTdHJlYW0gPSBldnQuc3RyZWFtLmNsb25lKCk7XG5cbiAgICAgICAgY29uc3QgYXVkaW9UcmFja3MgPSBldnQuc3RyZWFtLmdldEF1ZGlvVHJhY2tzKCk7XG4gICAgICAgIGlmIChhdWRpb1RyYWNrcyAhPT0gdW5kZWZpbmVkICYmIGF1ZGlvVHJhY2tzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHNlbGYuX3JlbW90ZUF1ZGlvU3RyZWFtID0gcmVtb3RlU3RyZWFtO1xuICAgICAgICAgICAgc2VsZi5fcmVtb3RlQXVkaW9FbGVtZW50LnNyY09iamVjdCA9IHJlbW90ZVN0cmVhbTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9idWlsZE1lZGlhQ29uc3RyYWludHMoc2VsZiwgbWVkaWFDb25zdHJhaW50cykge1xuICAgICAgICBpZiAoc2VsZi5fZW5hYmxlQXVkaW8pIHtcbiAgICAgICAgICAgIHZhciBhdWRpb0NvbnN0cmFpbnRzID0ge307XG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYuX2VjaG9DYW5jZWxsYXRpb24gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgYXVkaW9Db25zdHJhaW50cy5lY2hvQ2FuY2VsbGF0aW9uID0gISFzZWxmLl9lY2hvQ2FuY2VsbGF0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHdpbmRvdy5hdWRpb19pbnB1dCkge1xuICAgICAgICAgICAgICAgIGF1ZGlvQ29uc3RyYWludHMuZGV2aWNlSWQgPSB3aW5kb3cuYXVkaW9faW5wdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoYXVkaW9Db25zdHJhaW50cykubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIG1lZGlhQ29uc3RyYWludHMuYXVkaW8gPSBhdWRpb0NvbnN0cmFpbnRzO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtZWRpYUNvbnN0cmFpbnRzLmF1ZGlvID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1lZGlhQ29uc3RyYWludHMuYXVkaW8gPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldFN0cmF0ZWd5TmFtZSgpIHtcbiAgICAgICAgcmV0dXJuICdDaXRyaXhWRElTdHJhdGVneSc7XG4gICAgfVxufSIsImltcG9ydCBDQ1BJbml0aWF0aW9uU3RyYXRlZ3lJbnRlcmZhY2UgZnJvbSBcIi4vQ0NQSW5pdGlhdGlvblN0cmF0ZWd5SW50ZXJmYWNlXCI7XG5pbXBvcnQge0NIUk9NRV9TVVBQT1JURURfVkVSU0lPTiwgUlRDX0VSUk9SU30gZnJvbSBcIi4uL3J0Y19jb25zdFwiO1xuaW1wb3J0IHtnZXRDaHJvbWVCcm93c2VyVmVyc2lvbiwgaGl0Y2gsIGlzQ2hyb21lQnJvd3Nlcn0gZnJvbSBcIi4uL3V0aWxzXCI7XG5pbXBvcnQge0ZhaWxlZFN0YXRlfSBmcm9tIFwiLi4vcnRjX3Nlc3Npb25cIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3RhbmRhcmRTdHJhdGVneSBleHRlbmRzIENDUEluaXRpYXRpb25TdHJhdGVneUludGVyZmFjZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiU3RhbmRhcmRTdHJhdGVneSBpbml0aWFsaXplZFwiKTtcbiAgICB9XG5cbiAgICAvLyB0aGUgZm9sbG93aW5nIGZ1bmN0aW9ucyBhcmUgcnRjX3BlZXJfY29ubmVjdGlvbl9mYWN0b3J5IHJlbGF0ZWQgZnVuY3Rpb25zXG4gICAgLy8gY2hlY2sgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgZWFybHkgbWVkaWEgY29ubmVjdGlvblxuICAgIF9pc0Vhcmx5TWVkaWFDb25uZWN0aW9uU3VwcG9ydGVkKCl7XG4gICAgICAgIHJldHVybiBpc0Nocm9tZUJyb3dzZXIoKSAmJiBnZXRDaHJvbWVCcm93c2VyVmVyc2lvbigpID49IENIUk9NRV9TVVBQT1JURURfVkVSU0lPTjtcbiAgICB9XG5cbiAgICBfY3JlYXRlUnRjUGVlckNvbm5lY3Rpb24ocnRjUGVlckNvbm5lY3Rpb25Db25maWcsIHJ0Y1BlZXJDb25uZWN0aW9uT3B0aW9uYWxDb25maWcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSVENQZWVyQ29ubmVjdGlvbihydGNQZWVyQ29ubmVjdGlvbkNvbmZpZywgcnRjUGVlckNvbm5lY3Rpb25PcHRpb25hbENvbmZpZyk7XG4gICAgfVxuXG4gICAgLy8gdGhlIGZvbGxvd2luZyBmdW5jdGlvbnMgYXJlIHJ0Y19zZXNzaW9uIHJlbGF0ZWQgZnVuY3Rpb25zXG4gICAgX2dVTShjb25zdHJhaW50cykge1xuICAgICAgICByZXR1cm4gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpO1xuICAgIH1cblxuICAgIGFkZFN0cmVhbShfcGMsIHN0cmVhbSkge1xuICAgICAgICBfcGMuYWRkU3RyZWFtKHN0cmVhbSk7XG4gICAgfVxuXG4gICAgc2V0UmVtb3RlRGVzY3JpcHRpb24oc2VsZiwgcnRjU2Vzc2lvbikge1xuICAgICAgICB2YXIgc2V0UmVtb3RlRGVzY3JpcHRpb25Qcm9taXNlID0gcnRjU2Vzc2lvbi5fcGMuc2V0UmVtb3RlRGVzY3JpcHRpb24oc2VsZi5fY3JlYXRlU2Vzc2lvbkRlc2NyaXB0aW9uKHtcbiAgICAgICAgICAgIHR5cGU6ICdhbnN3ZXInLFxuICAgICAgICAgICAgc2RwOiBzZWxmLl9zZHBcbiAgICAgICAgfSkpO1xuICAgICAgICBzZXRSZW1vdGVEZXNjcmlwdGlvblByb21pc2UuY2F0Y2goZSA9PiB7XG4gICAgICAgICAgICBzZWxmLmxvZ2dlci5lcnJvcignU2V0UmVtb3RlRGVzY3JpcHRpb24gZmFpbGVkJywgZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBzZXRSZW1vdGVEZXNjcmlwdGlvblByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB2YXIgcmVtb3RlQ2FuZGlkYXRlUHJvbWlzZXMgPSBQcm9taXNlLmFsbChzZWxmLl9jYW5kaWRhdGVzLm1hcChmdW5jdGlvbiAoY2FuZGlkYXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZUNhbmRpZGF0ZSA9IHNlbGYuX2NyZWF0ZVJlbW90ZUNhbmRpZGF0ZShjYW5kaWRhdGUpO1xuICAgICAgICAgICAgICAgIHNlbGYubG9nZ2VyLmluZm8oJ0FkZGluZyByZW1vdGUgY2FuZGlkYXRlJywgcmVtb3RlQ2FuZGlkYXRlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcnRjU2Vzc2lvbi5fcGMuYWRkSWNlQ2FuZGlkYXRlKHJlbW90ZUNhbmRpZGF0ZSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZW1vdGVDYW5kaWRhdGVQcm9taXNlcy5jYXRjaChyZWFzb24gPT4ge1xuICAgICAgICAgICAgICAgIHNlbGYubG9nZ2VyLndhcm4oJ0Vycm9yIGFkZGluZyByZW1vdGUgY2FuZGlkYXRlJywgcmVhc29uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZUNhbmRpZGF0ZVByb21pc2VzO1xuICAgICAgICB9KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHJ0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuc2V0UmVtb3RlRGVzY3JpcHRpb25GYWlsdXJlID0gZmFsc2U7XG4gICAgICAgICAgICBzZWxmLl9yZW1vdGVEZXNjcmlwdGlvblNldCA9IHRydWU7XG4gICAgICAgICAgICBzZWxmLl9jaGVja0FuZFRyYW5zaXQoKTtcbiAgICAgICAgfSkuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgcnRjU2Vzc2lvbi5fc3RvcFNlc3Npb24oKTtcbiAgICAgICAgICAgIHJ0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuc2V0UmVtb3RlRGVzY3JpcHRpb25GYWlsdXJlID0gdHJ1ZTtcbiAgICAgICAgICAgIHNlbGYudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUocnRjU2Vzc2lvbiwgUlRDX0VSUk9SUy5TRVRfUkVNT1RFX0RFU0NSSVBUSU9OX0ZBSUxVUkUpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25JY2VTdGF0ZUNoYW5nZShldnQsIF9wYykgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXG4gICAgICAgIHJldHVybiBldnQuY3VycmVudFRhcmdldC5pY2VDb25uZWN0aW9uU3RhdGU7XG4gICAgfVxuXG4gICAgb25QZWVyQ29ubmVjdGlvblN0YXRlQ2hhbmdlKF9wYykge1xuICAgICAgICByZXR1cm4gX3BjLmNvbm5lY3Rpb25TdGF0ZTtcbiAgICB9XG5cbiAgICBfY3JlYXRlUGVlckNvbm5lY3Rpb24oY29uZmlndXJhdGlvbiwgb3B0aW9uYWxDb25maWd1cmF0aW9uKSB7XG4gICAgICAgIHJldHVybiBuZXcgUlRDUGVlckNvbm5lY3Rpb24oY29uZmlndXJhdGlvbiwgb3B0aW9uYWxDb25maWd1cmF0aW9uKTtcbiAgICB9XG5cbiAgICBjb25uZWN0KHNlbGYpIHtcbiAgICAgICAgc2VsZi5fcGMub250cmFjayA9IGhpdGNoKHNlbGYsIHNlbGYuX29udHJhY2spO1xuICAgIH1cblxuICAgIF9vbnRyYWNrKHNlbGYsIGV2dCkge1xuICAgICAgICBpZiAoZXZ0LnN0cmVhbXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgc2VsZi5fbG9nZ2VyLndhcm4oJ0ZvdW5kIG1vcmUgdGhhbiAxIHN0cmVhbXMgZm9yICcgKyBldnQudHJhY2sua2luZCArICcgdHJhY2sgJyArIGV2dC50cmFjay5pZCArICcgOiAnICtcbiAgICAgICAgICAgICAgICBldnQuc3RyZWFtcy5tYXAoc3RyZWFtID0+IHN0cmVhbS5pZCkuam9pbignLCcpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXZ0LnRyYWNrLmtpbmQgPT09ICd2aWRlbycgJiYgc2VsZi5fcmVtb3RlVmlkZW9FbGVtZW50KSB7XG4gICAgICAgICAgICBzZWxmLl9yZW1vdGVWaWRlb0VsZW1lbnQuc3JjT2JqZWN0ID0gZXZ0LnN0cmVhbXNbMF07XG4gICAgICAgICAgICBzZWxmLl9yZW1vdGVWaWRlb1N0cmVhbSA9IGV2dC5zdHJlYW1zWzBdO1xuICAgICAgICB9IGVsc2UgaWYgKGV2dC50cmFjay5raW5kID09PSAnYXVkaW8nICYmIHNlbGYuX3JlbW90ZUF1ZGlvRWxlbWVudCkge1xuICAgICAgICAgICAgc2VsZi5fcmVtb3RlQXVkaW9FbGVtZW50LnNyY09iamVjdCA9IGV2dC5zdHJlYW1zWzBdO1xuICAgICAgICAgICAgc2VsZi5fcmVtb3RlQXVkaW9TdHJlYW0gPSBldnQuc3RyZWFtc1swXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9idWlsZE1lZGlhQ29uc3RyYWludHMoc2VsZiwgbWVkaWFDb25zdHJhaW50cykge1xuICAgICAgICBpZiAoc2VsZi5fZW5hYmxlQXVkaW8pIHtcbiAgICAgICAgICAgIHZhciBhdWRpb0NvbnN0cmFpbnRzID0ge307XG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYuX2VjaG9DYW5jZWxsYXRpb24gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgYXVkaW9Db25zdHJhaW50cy5lY2hvQ2FuY2VsbGF0aW9uID0gISFzZWxmLl9lY2hvQ2FuY2VsbGF0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKGF1ZGlvQ29uc3RyYWludHMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBtZWRpYUNvbnN0cmFpbnRzLmF1ZGlvID0gYXVkaW9Db25zdHJhaW50cztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWVkaWFDb25zdHJhaW50cy5hdWRpbyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtZWRpYUNvbnN0cmFpbnRzLmF1ZGlvID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRTdHJhdGVneU5hbWUoKSB7XG4gICAgICAgIHJldHVybiAnU3RhbmRhcmRTdHJhdGVneSc7XG4gICAgfVxufSIsIi8qKlxuICogQ29weXJpZ2h0IDIwMTcgQW1hem9uLmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQXBhY2hlLTIuMFxuICovXG5cbmltcG9ydCB7SWxsZWdhbFBhcmFtZXRlcnN9IGZyb20gJy4vZXhjZXB0aW9ucyc7XG5pbXBvcnQge2dldEtpbmQsIHBhcnNlUnRwTWFwLCBwYXJzZVJ0cFBhcmFtZXRlcnMsIHNwbGl0TGluZXMsIHNwbGl0U2VjdGlvbnMsIHdyaXRlRm10cH0gZnJvbSAnc2RwJztcblxuLyoqXG4gKiBBbGwgbG9nZ2luZyBtZXRob2RzIHVzZWQgYnkgY29ubmVjdC1ydGMuXG4gKi9cbnZhciBsb2dNZXRob2RzID0gWydsb2cnLCAnaW5mbycsICd3YXJuJywgJ2Vycm9yJ107XG5cbi8qKlxuICogQmluZHMgdGhlIGdpdmVuIGluc3RhbmNlIG9iamVjdCBhcyB0aGUgY29udGV4dCBmb3JcbiAqIHRoZSBtZXRob2QgcHJvdmlkZWQuXG4gKlxuICogQHBhcmFtIHNjb3BlIFRoZSBpbnN0YW5jZSBvYmplY3QgdG8gYmUgc2V0IGFzIHRoZSBzY29wZVxuICogICAgb2YgdGhlIGZ1bmN0aW9uLlxuICogQHBhcmFtIG1ldGhvZCBUaGUgbWV0aG9kIHRvIGJlIGVuY2Fwc3VsYXRlZC5cbiAqXG4gKiBBbGwgb3RoZXIgYXJndW1lbnRzLCBpZiBhbnksIGFyZSBib3VuZCB0byB0aGUgbWV0aG9kXG4gKiBpbnZvY2F0aW9uIGluc2lkZSB0aGUgY2xvc3VyZS5cbiAqXG4gKiBAcmV0dXJuIEEgY2xvc3VyZSBlbmNhcHN1bGF0aW5nIHRoZSBpbnZvY2F0aW9uIG9mIHRoZVxuICogICAgbWV0aG9kIHByb3ZpZGVkIGluIGNvbnRleHQgb2YgdGhlIGdpdmVuIGluc3RhbmNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaGl0Y2goKSB7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xuICAgIHZhciBzY29wZSA9IGFyZ3Muc2hpZnQoKTtcbiAgICB2YXIgbWV0aG9kID0gYXJncy5zaGlmdCgpO1xuXG4gICAgaWYgKCFzY29wZSkge1xuICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFBhcmFtZXRlcnMoJ3V0aWxzLmhpdGNoKCk6IHNjb3BlIGlzIHJlcXVpcmVkIScpO1xuICAgIH1cblxuICAgIGlmICghbWV0aG9kKSB7XG4gICAgICAgIHRocm93IG5ldyBJbGxlZ2FsUGFyYW1ldGVycygndXRpbHMuaGl0Y2goKTogbWV0aG9kIGlzIHJlcXVpcmVkIScpO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgbWV0aG9kICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBJbGxlZ2FsUGFyYW1ldGVycygndXRpbHMuaGl0Y2goKTogbWV0aG9kIGlzIG5vdCBhIGZ1bmN0aW9uIScpO1xuICAgIH1cblxuICAgIHJldHVybiBmdW5jdGlvbiBfaGl0Y2hlZEZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY2xvc3VyZUFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xuICAgICAgICByZXR1cm4gbWV0aG9kLmFwcGx5KHNjb3BlLCBhcmdzLmNvbmNhdChjbG9zdXJlQXJncykpO1xuICAgIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB3cmFwTG9nZ2VyKGxvZ2dlciwgY2FsbElkLCBsb2dDYXRlZ29yeSkge1xuICAgIHZhciBfbG9nZ2VyID0ge307XG4gICAgbG9nTWV0aG9kcy5mb3JFYWNoKGZ1bmN0aW9uIChsb2dNZXRob2QpIHtcbiAgICAgICAgaWYgKCFsb2dnZXJbbG9nTWV0aG9kXSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdMb2dnaW5nIG1ldGhvZCAnICsgbG9nTWV0aG9kICsgJyByZXF1aXJlZCcpO1xuICAgICAgICB9XG4gICAgICAgIF9sb2dnZXJbbG9nTWV0aG9kXSA9IGhpdGNoKGxvZ2dlciwgbG9nZ2VyW2xvZ01ldGhvZF0sIGNhbGxJZCwgbG9nQ2F0ZWdvcnkpO1xuICAgIH0pO1xuICAgIHJldHVybiBfbG9nZ2VyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VTdHJlYW0oc3RyZWFtKSB7XG4gICAgaWYgKHN0cmVhbSkge1xuICAgICAgICB2YXIgdHJhY2tzID0gc3RyZWFtLmdldFRyYWNrcygpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRyYWNrcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHRyYWNrID0gdHJhY2tzW2ldO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0cmFjay5zdG9wKCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gZWF0IGV4Y2VwdGlvblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG4vKipcbiAqIEEgcGFyYW1ldGVyIG9mIHRyYW5zZm9ybVNkcC5cbiAqIFRoaXMgZGVmaW5lcyBhbGwgdGhlIFNEUCBvcHRpb25zIGNvbm5lY3QtcnRjLWpzIHN1cHBvcnRzLlxuICovXG5leHBvcnQgY2xhc3MgU2RwT3B0aW9ucyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuX2ZvcmNlQ29kZWMgPSB7fTtcbiAgICB9XG5cbiAgICBnZXQgZW5hYmxlT3B1c0R0eCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VuYWJsZU9wdXNEdHg7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnkgZGVmYXVsdCB0cmFuc2Zvcm1TZHAgZGlzYWJsZXMgZHR4IGZvciBPUFVTIGNvZGVjLlxuICAgICAqIFNldHRpbmcgdGhpcyB0byB0cnVlIHdvdWxkIGZvcmNlIGl0IHRvIHR1cm4gb24gRFRYLlxuICAgICAqL1xuICAgIHNldCBlbmFibGVPcHVzRHR4KGZsYWcpIHtcbiAgICAgICAgdGhpcy5fZW5hYmxlT3B1c0R0eCA9IGZsYWc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBtYXAgZnJvbSBtZWRpYSB0eXBlIChhdWRpby92aWRlbykgdG8gY29kZWMgKGNhc2UgaW5zZW5zaXRpdmUpLlxuICAgICAqIEFkZCBlbnRyeSBmb3IgZm9yY2UgY29ubmVjdC1ydGMtanMgdG8gdXNlIHNwZWNpZmllZCBjb2RlYyBmb3IgY2VydGFpbiBtZWRpYSB0eXBlLlxuICAgICAqIEZvciBleGFtcGxlOiBzZHBPcHRpb25zLmZvcmNlQ29kZWNbJ2F1ZGlvJ10gPSAnb3B1cyc7XG4gICAgICovXG4gICAgZ2V0IGZvcmNlQ29kZWMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mb3JjZUNvZGVjO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRlc3QgaWYgZ2l2ZW4gY29kZWMgc2hvdWxkIGJlIHJlbW92ZWQgZnJvbSBTRFAuXG4gICAgICogQHBhcmFtIG1lZGlhVHlwZSBhdWRpb3x2aWRlb1xuICAgICAqIEBwYXJhbSBjb2RlY05hbWUgY2FzZSBpbnNlbnNpdGl2ZVxuICAgICAqIEByZXR1cm4gVFJVRSAtIHNob3VsZCByZW1vdmVcbiAgICAgKi9cbiAgICBfc2hvdWxkRGVsZXRlQ29kZWMobWVkaWFUeXBlLCBjb2RlY05hbWUpIHtcbiAgICAgICAgdmFyIHVwcGVyQ2FzZUNvZGVjTmFtZSA9IGNvZGVjTmFtZS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICByZXR1cm4gdGhpcy5fZm9yY2VDb2RlY1ttZWRpYVR5cGVdICYmIHVwcGVyQ2FzZUNvZGVjTmFtZSAhPT0gdGhpcy5fZm9yY2VDb2RlY1ttZWRpYVR5cGVdLnRvVXBwZXJDYXNlKCkgJiYgdXBwZXJDYXNlQ29kZWNOYW1lICE9PSAnVEVMRVBIT05FLUVWRU5UJztcbiAgICB9XG59XG5cbi8qKlxuICogTW9kaWZpZXMgaW5wdXQgU0RQIGFjY29yZGluZyB0byBzZHBPcHRpb25zLlxuICogU2VlIFNkcE9wdGlvbnMgZm9yIGF2YWlsYWJsZSBvcHRpb25zLlxuICogQHBhcmFtIHNkcCBvcmlnaW5hbCBTRFBcbiAqIEBwYXJhbSBzZHBPcHRpb25zIGRlZmluZXMgY2hhbmdlcyB0byBiZSBhcHBsaWVkIHRvIFNEUFxuICogQHJldHVybnMgYSBtYXAgd2l0aCAnc2RwJyBjb250YWluaW5nIHRoZSB0cmFuc2Zvcm1lZCBTRFAgYW5kICdtTGluZXMnIGNvbnRhaW5pbmcgdGhlIG51bWJlciBvZiBtIGxpbmVzIGluIFNEUFxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJhbnNmb3JtU2RwKHNkcCwgc2RwT3B0aW9ucykge1xuICAgIHZhciBzZWN0aW9ucyA9IHNwbGl0U2VjdGlvbnMoc2RwKTtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IHNlY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBtZWRpYVR5cGUgPSBnZXRLaW5kKHNlY3Rpb25zW2ldKTtcbiAgICAgICAgdmFyIHJ0cFBhcmFtcyA9IHBhcnNlUnRwUGFyYW1ldGVycyhzZWN0aW9uc1tpXSk7XG4gICAgICAgIC8vIGEgbWFwIGZyb20gcGF5bG9hZCB0eXBlIChzdHJpbmcpIHRvIGNvZGVjIG9iamVjdFxuICAgICAgICB2YXIgY29kZWNNYXAgPSBydHBQYXJhbXMuY29kZWNzLnJlZHVjZSgobWFwLCBjb2RlYykgPT4ge1xuICAgICAgICAgICAgbWFwWycnICsgY29kZWMucGF5bG9hZFR5cGVdID0gY29kZWM7XG4gICAgICAgICAgICByZXR1cm4gbWFwO1xuICAgICAgICB9LCB7fSk7XG4gICAgICAgIHNlY3Rpb25zW2ldID0gc3BsaXRMaW5lcyhzZWN0aW9uc1tpXSkubWFwKGxpbmUgPT4ge1xuICAgICAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgnbT0nKSkge1xuICAgICAgICAgICAgICAgIC8vIG1vZGlmeSBtPSBsaW5lIGlmIFNkcE9wdGlvbnMjZm9yY2VDb2RlYyBzcGVjaWZpZXMgY29kZWMgZm9yIGN1cnJlbnQgbWVkaWEgdHlwZVxuICAgICAgICAgICAgICAgIGlmIChzZHBPcHRpb25zLmZvcmNlQ29kZWNbbWVkaWFUeXBlXSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0Q29kZWNQdHMgPSBPYmplY3Qua2V5cyhjb2RlY01hcCkuZmlsdGVyKHB0ID0+ICFzZHBPcHRpb25zLl9zaG91bGREZWxldGVDb2RlYyhtZWRpYVR5cGUsIGNvZGVjTWFwW3B0XS5uYW1lKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAvLipSVFBcXC9TP0FWUEY/IC8uZXhlYyhsaW5lKSArIHRhcmdldENvZGVjUHRzLmpvaW4oJyAnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmUuc3RhcnRzV2l0aCgnYT1ydHBtYXA6JykpIHtcbiAgICAgICAgICAgICAgICB2YXIgcnRwTWFwID0gcGFyc2VSdHBNYXAobGluZSk7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRDb2RlYyA9IGNvZGVjTWFwW3J0cE1hcC5wYXlsb2FkVHlwZV07XG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgdGhpcyBjb2RlYyBpZiBTZHBPcHRpb25zI2ZvcmNlQ29kZWMgc3BlY2lmaWVzIGEgZGlmZmVyZW50IGNvZGVjIGZvciBjdXJyZW50IG1lZGlhIHR5cGVcbiAgICAgICAgICAgICAgICBpZiAoaXNfZGVmaW5lZChjdXJyZW50Q29kZWMpICYmIHNkcE9wdGlvbnMuX3Nob3VsZERlbGV0ZUNvZGVjKG1lZGlhVHlwZSwgY3VycmVudENvZGVjLm5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGFwcGVuZCBhPWZtdHAgbGluZSBpbW1lZGlhdGVseSBpZiBjdXJyZW50IGNvZGVjIGlzIE9QVVMgKHRvIGV4cGxpY2l0bHkgc3BlY2lmeSBPUFVTIHBhcmFtZXRlcnMpXG4gICAgICAgICAgICAgICAgaWYgKGlzX2RlZmluZWQoY3VycmVudENvZGVjKSAmJiBjdXJyZW50Q29kZWMubmFtZS50b1VwcGVyQ2FzZSgpID09PSAnT1BVUycpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudENvZGVjLnBhcmFtZXRlcnMudXNlZHR4ID0gc2RwT3B0aW9ucy5lbmFibGVPcHVzRHR4ID8gXCIxXCIgOiBcIjBcIjtcbiAgICAgICAgICAgICAgICAgICAgLy8gZ2VuZXJhdGUgZm10cCBsaW5lIGltbWVkaWF0ZWx5IGFmdGVyIHJ0cG1hcCBsaW5lLCBhbmQgcmVtb3ZlIG9yaWdpbmFsIGZtdHAgbGluZSBvbmNlIHdlIHNlZSBpdFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGxpbmUgKyBcIlxcclxcblwiICsgd3JpdGVGbXRwKGN1cnJlbnRDb2RlYykpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmUuc3RhcnRzV2l0aCgnYT1mbXRwOicpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHB0ID0gbGluZS5zdWJzdHJpbmcoJ2E9Zm10cDonLmxlbmd0aCwgbGluZS5pbmRleE9mKCcgJykpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50Q29kZWMgPSBjb2RlY01hcFtwdF07Ly8gZXNsaW50LWRpc2FibGUtbGluZSBuby1yZWRlY2xhcmVcblxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSB0aGlzIGNvZGVjIGlmIFNkcE9wdGlvbnMjZm9yY2VDb2RlYyBzcGVjaWZpZXMgYSBkaWZmZXJlbnQgY29kZWMgZm9yIGN1cnJlbnQgbWVkaWEgdHlwZVxuICAgICAgICAgICAgICAgIGlmIChpc19kZWZpbmVkKGN1cnJlbnRDb2RlYykgJiYgc2RwT3B0aW9ucy5fc2hvdWxkRGVsZXRlQ29kZWMobWVkaWFUeXBlLCBjdXJyZW50Q29kZWMubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlzX2RlZmluZWQoY3VycmVudENvZGVjKSAmJiBjdXJyZW50Q29kZWMubmFtZS50b1VwcGVyQ2FzZSgpID09PSAnT1BVUycpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBpcyBhIGxpbmUgZm9yIE9QVVMsIHJlbW92ZSBpdCBiZWNhdXNlIEZNVFAgbGluZSBpcyBhbHJlYWR5IGdlbmVyYXRlZCB3aGVuIHJ0cG1hcCBsaW5lIGlzIHByb2Nlc3NlZFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmUuc3RhcnRzV2l0aCgnYT1ydGNwLWZiOicpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHB0ID0gbGluZS5zdWJzdHJpbmcobGluZS5pbmRleE9mKCc6JykgKyAxLCBsaW5lLmluZGV4T2YoJyAnKSk7Ly8gZXNsaW50LWRpc2FibGUtbGluZSBuby1yZWRlY2xhcmVcbiAgICAgICAgICAgICAgICBpZiAocHQgPT09ICcqJykgeyAvL2Fsd2F5cyBhbGxvdyB3aWxkY2FyZCBpbiBydGMtZmJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRDb2RlYyA9IGNvZGVjTWFwW3B0XTsvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXJlZGVjbGFyZVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSB0aGlzIGNvZGVjIGlmIFNkcE9wdGlvbnMjZm9yY2VDb2RlYyBzcGVjaWZpZXMgYSBkaWZmZXJlbnQgY29kZWMgZm9yIGN1cnJlbnQgbWVkaWEgdHlwZVxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNfZGVmaW5lZChjdXJyZW50Q29kZWMpICYmIHNkcE9wdGlvbnMuX3Nob3VsZERlbGV0ZUNvZGVjKG1lZGlhVHlwZSwgY3VycmVudENvZGVjLm5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsaW5lO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGluZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkuZmlsdGVyKGxpbmUgPT4gbGluZSAhPT0gbnVsbCkuam9pbignXFxyXFxuJyk7XG5cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2RwOiBzZWN0aW9ucy5tYXAoc2VjdGlvbiA9PiBzZWN0aW9uLnRyaW0oKSkuam9pbignXFxyXFxuJykgKyAnXFxyXFxuJyxcbiAgICAgICAgbUxpbmVzOiBzZWN0aW9ucy5sZW5ndGggLSAxIC8vIGZpcnN0IHNlY3Rpb24gaXMgc2Vzc2lvbiBkZXNjcmlwdGlvbiwgdGhlIHJlc3QgYXJlIG1lZGlhIGRlc2NyaXB0aW9uc1xuICAgIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc19kZWZpbmVkKHYpIHtcbiAgICByZXR1cm4gdHlwZW9mIHYgIT09ICd1bmRlZmluZWQnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gd2hlbl9kZWZpbmVkKHYsIGFsdGVybmF0aXZlSW4pIHtcbiAgICB2YXIgYWx0ZXJuYXRpdmUgPSBpc19kZWZpbmVkKGFsdGVybmF0aXZlSW4pID8gYWx0ZXJuYXRpdmVJbiA6IG51bGw7XG4gICAgcmV0dXJuIGlzX2RlZmluZWQodikgPyB2IDogYWx0ZXJuYXRpdmU7XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgdGhlIGdldFN0YXRzIEFQSSBmb3IgcmV0cmlldmluZyBsZWdhY3kgc3RhdHMgcmVwb3J0IGlzIHN1cHBvcnRlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNMZWdhY3lTdGF0c1JlcG9ydFN1cHBvcnRlZChwYykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICAgIHBjLmdldFN0YXRzKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyBFeGNlcHRpb24gdGhyb3duIGlmIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBsZWdhY3kgc3RhdHMgcmVwb3J0XG4gICAgICAgICAgICByZXNvbHZlKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIHRoZSBnaXZlbiB2YWx1ZSBpcyBhIGNhbGxhYmxlIGZ1bmN0aW9uIHR5cGUuXG4gKiBCb3Jyb3dlZCBmcm9tIFVuZGVyc2NvcmUuanMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Z1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiAhIShvYmogJiYgb2JqLmNvbnN0cnVjdG9yICYmIG9iai5jYWxsICYmIG9iai5hcHBseSk7XG59XG5cbi8qKlxuICogQXNzZXJ0cyB0aGF0IGEgcHJlbWlzZSBpcyB0cnVlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0VHJ1ZShwcmVtaXNlLCBtZXNzYWdlKSB7XG4gICAgaWYgKCFwcmVtaXNlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlKTtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0Nocm9tZUJyb3dzZXIoKXtcbiAgICByZXR1cm4gbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiQ2hyb21lXCIpICE9PSAtMTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENocm9tZUJyb3dzZXJWZXJzaW9uKCl7XG4gICAgdmFyIHVzZXJBZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQ7XG4gICAgdmFyIGNocm9tZVZlcnNpb24gPSB1c2VyQWdlbnQuc3Vic3RyaW5nKHVzZXJBZ2VudC5pbmRleE9mKFwiQ2hyb21lXCIpKzcpO1xuICAgIGlmIChjaHJvbWVWZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGNocm9tZVZlcnNpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWRhY3RlZFNkcChzZHApIHtcbiAgICAvLyBwYXR0ZXJuIHRvIGZpbmQgYW5kIHJlZGFjdCB0aGUgdmFsdWUgYWZ0ZXIgJ2E9aWNlLXB3ZDonXG4gICAgdmFyIHBhdHRlcm4gPSAvYT1pY2UtcHdkOlteXFxyXFxuXSovO1xuXG4gICAgLy8gVXNlIHRoZSByZXBsYWNlIG1ldGhvZCB0byByZWRhY3QgdGhlIHZhbHVlIHdpdGggJ1tyZWRhY3RlZF0nXG4gICAgcmV0dXJuIHNkcC5yZXBsYWNlKHBhdHRlcm4sICdhPWljZS1wd2Q6W3JlZGFjdGVkXScpO1xufVxuIiwiaW1wb3J0IHtoaXRjaH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQge1NPRlRQSE9ORV9ST1VURV9LRVl9IGZyb20gJy4vcnRjX2NvbnN0J1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWaXJ0dWFsV3NzQ29ubmVjdGlvbk1hbmFnZXIge1xuICAgIGNvbnN0cnVjdG9yKGxvZ2dlciwgY29ubmVjdGlvbklkLCB3c3NNYW5hZ2VyKSB7XG4gICAgICAgIHRoaXMuX2xvZ2dlciA9IGxvZ2dlcjtcbiAgICAgICAgdGhpcy5fY29ubmVjdGlvbklkID0gY29ubmVjdGlvbklkO1xuICAgICAgICB0aGlzLl93c3NNYW5hZ2VyID0gd3NzTWFuYWdlclxuICAgICAgICB0aGlzLl9pbml0aWFsaXplV2ViU29ja2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICBfaW5pdGlhbGl6ZVdlYlNvY2tldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLl93c3NNYW5hZ2VyLnN1YnNjcmliZVRvcGljcyhbU09GVFBIT05FX1JPVVRFX0tFWV0pO1xuICAgICAgICB0aGlzLl91blN1YnNjcmliZSA9IHRoaXMuX3dzc01hbmFnZXIub25NZXNzYWdlKFNPRlRQSE9ORV9ST1VURV9LRVksIGhpdGNoKHRoaXMsIHRoaXMuX3dlYlNvY2tldE1hbmFnZXJPbk1lc3NhZ2UpKTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9vbk9wZW4oKTtcbiAgICAgICAgfSwgMCk7XG4gICAgfVxuXG4gICAgX3dlYlNvY2tldE1hbmFnZXJPbk1lc3NhZ2UoZXZlbnQpIHtcbiAgICAgICAgbGV0IGNvbnRlbnQ7XG4gICAgICAgIGlmIChldmVudC5jb250ZW50KSB7XG4gICAgICAgICAgICBjb250ZW50ID0gSlNPTi5wYXJzZShldmVudC5jb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fb25NZXNzYWdlICYmIGNvbnRlbnQgJiYgdGhpcy5fY29ubmVjdGlvbklkID09PSBjb250ZW50LmNvbm5lY3Rpb25JZCkge1xuICAgICAgICAgICAgdGhpcy5fb25NZXNzYWdlKHtkYXRhOiBKU09OLnN0cmluZ2lmeShjb250ZW50Lmpzb25ScGNNc2cpfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXQgb25tZXNzYWdlKGNhbGxCYWNrKSB7XG4gICAgICAgIHRoaXMuX29uTWVzc2FnZSA9IGNhbGxCYWNrO1xuICAgIH1cblxuICAgIHNldCBvbm9wZW4oY2FsbEJhY2spIHtcbiAgICAgICAgdGhpcy5fb25PcGVuID0gY2FsbEJhY2s7XG4gICAgfVxuXG4gICAgc2VuZCh3ZWJTb2NrZXRQYXlsb2FkKSB7XG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSB7fTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHBheWxvYWQudG9waWMgPSBTT0ZUUEhPTkVfUk9VVEVfS0VZO1xuICAgICAgICAgICAgcGF5bG9hZC5jb25uZWN0aW9uSWQgPSB0aGlzLl9jb25uZWN0aW9uSWQ7XG4gICAgICAgICAgICBwYXlsb2FkLmpzb25ScGNNc2cgPSBKU09OLnBhcnNlKHdlYlNvY2tldFBheWxvYWQpO1xuICAgICAgICAgICAgdGhpcy5fd3NzTWFuYWdlci5zZW5kTWVzc2FnZShwYXlsb2FkKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuX2xvZ2dlci5lcnJvcihcIkVycm9yIGluIHNlbmRNZXNzYWdlIFwiLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5fbG9nZ2VyLmluZm8oXCJjbG9zaW5nIHZpcnR1YWwgY29ubmVjdGlvblwiKTtcbiAgICAgICAgdGhpcy5fdW5TdWJzY3JpYmUoKTtcbiAgICB9XG59Il19
