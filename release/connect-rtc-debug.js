(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
(function (global){(function (){
//===============================================
// By using these Developer Materials, you accept and agree to comply with
// the terms of the Cloud Software Group Developer Terms of Use found here
// (https://www.cloud.com/legal)
//===============================================



var $jscomp={scope:{},getGlobal:function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global?global:e}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.initSymbol=function(){$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol);$jscomp.initSymbol=function(){}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(e){return"jscomp_symbol_"+e+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};$jscomp.makeIterator=function(e){$jscomp.initSymbolIterator();if(e[$jscomp.global.Symbol.iterator])return e[$jscomp.global.Symbol.iterator]();var l=0;return{next:function(){return l==e.length?{done:!0}:{done:!1,value:e[l++]}}}};
$jscomp.arrayFromIterator=function(e){for(var l,p=[];!(l=e.next()).done;)p.push(l.value);return p};$jscomp.arrayFromIterable=function(e){return e instanceof Array?e:$jscomp.arrayFromIterator($jscomp.makeIterator(e))};
$jscomp.inherits=function(e,l){function p(){}p.prototype=l.prototype;e.prototype=new p;e.prototype.constructor=e;for(var b in l)if($jscomp.global.Object.defineProperties){var a=$jscomp.global.Object.getOwnPropertyDescriptor(l,b);a&&$jscomp.global.Object.defineProperty(e,b,a)}else e[b]=l[b]};$jscomp.array=$jscomp.array||{};$jscomp.array.done_=function(){return{done:!0,value:void 0}};
$jscomp.array.arrayIterator_=function(e,l){e instanceof String&&(e=String(e));var p=0;$jscomp.initSymbol();$jscomp.initSymbolIterator();var b={},a=(b.next=function(){if(p<e.length){var b=p++;return{value:l(b,e[b]),done:!1}}a.next=$jscomp.array.done_;return $jscomp.array.done_()},b[Symbol.iterator]=function(){return a},b);return a};
$jscomp.array.findInternal_=function(e,l,p){e instanceof String&&(e=String(e));for(var b=e.length,a=0;a<b;a++){var c=e[a];if(l.call(p,c,a,e))return{i:a,v:c}}return{i:-1,v:void 0}};
$jscomp.array.from=function(e,l,p){l=void 0===l?function(a){return a}:l;var b=[];$jscomp.initSymbol();$jscomp.initSymbolIterator();if(e[Symbol.iterator]){$jscomp.initSymbol();$jscomp.initSymbolIterator();e=e[Symbol.iterator]();for(var a;!(a=e.next()).done;)b.push(l.call(p,a.value))}else{a=e.length;for(var c=0;c<a;c++)b.push(l.call(p,e[c]))}return b};$jscomp.array.of=function(e){for(var l=[],p=0;p<arguments.length;++p)l[p-0]=arguments[p];return $jscomp.array.from(l)};
$jscomp.array.entries=function(){return $jscomp.array.arrayIterator_(this,function(e,l){return[e,l]})};$jscomp.array.entries$install=function(){Array.prototype.entries||(Array.prototype.entries=$jscomp.array.entries)};$jscomp.array.keys=function(){return $jscomp.array.arrayIterator_(this,function(e){return e})};$jscomp.array.keys$install=function(){Array.prototype.keys||(Array.prototype.keys=$jscomp.array.keys)};$jscomp.array.values=function(){return $jscomp.array.arrayIterator_(this,function(e,l){return l})};
$jscomp.array.values$install=function(){Array.prototype.values||(Array.prototype.values=$jscomp.array.values)};$jscomp.array.copyWithin=function(e,l,p){var b=this.length;e=Number(e);l=Number(l);p=Number(null!=p?p:b);if(e<l)for(p=Math.min(p,b);l<p;)l in this?this[e++]=this[l++]:(delete this[e++],l++);else for(p=Math.min(p,b+l-e),e+=p-l;p>l;)--p in this?this[--e]=this[p]:delete this[e];return this};$jscomp.array.copyWithin$install=function(){Array.prototype.copyWithin||(Array.prototype.copyWithin=$jscomp.array.copyWithin)};
$jscomp.array.fill=function(e,l,p){null!=p&&e.length||(p=this.length||0);p=Number(p);for(l=Number((void 0===l?0:l)||0);l<p;l++)this[l]=e;return this};$jscomp.array.fill$install=function(){Array.prototype.fill||(Array.prototype.fill=$jscomp.array.fill)};$jscomp.array.find=function(e,l){return $jscomp.array.findInternal_(this,e,l).v};$jscomp.array.find$install=function(){Array.prototype.find||(Array.prototype.find=$jscomp.array.find)};
$jscomp.array.findIndex=function(e,l){return $jscomp.array.findInternal_(this,e,l).i};$jscomp.array.findIndex$install=function(){Array.prototype.findIndex||(Array.prototype.findIndex=$jscomp.array.findIndex)};$jscomp.Map=function(e){e=void 0===e?[]:e;this.data_={};this.head_=$jscomp.Map.createHead_();this.size=0;if(e){e=$jscomp.makeIterator(e);for(var l=e.next();!l.done;l=e.next())l=l.value,this.set(l[0],l[1])}};
$jscomp.Map.checkBrowserConformance_=function(){var e=$jscomp.global.Map;if(!e||!e.prototype.entries||!Object.seal)return!1;try{var l=Object.seal({x:4}),p=new e($jscomp.makeIterator([[l,"s"]]));if("s"!=p.get(l)||1!=p.size||p.get({x:4})||p.set({x:4},"t")!=p||2!=p.size)return!1;var b=p.entries(),a=b.next();if(a.done||a.value[0]!=l||"s"!=a.value[1])return!1;a=b.next();return a.done||4!=a.value[0].x||"t"!=a.value[1]||!b.next().done?!1:!0}catch(c){return!1}};
$jscomp.Map.createHead_=function(){var e={};return e.previous=e.next=e.head=e};$jscomp.Map.getId_=function(e){if(!(e instanceof Object))return String(e);$jscomp.Map.key_ in e||e instanceof Object&&Object.isExtensible&&Object.isExtensible(e)&&$jscomp.Map.defineProperty_(e,$jscomp.Map.key_,++$jscomp.Map.index_);return $jscomp.Map.key_ in e?e[$jscomp.Map.key_]:" "+e};
$jscomp.Map.prototype.set=function(e,l){var p=this.maybeGetEntry_(e),b=p.id,a=p.list,p=p.entry;a||(a=this.data_[b]=[]);p?p.value=l:(p={next:this.head_,previous:this.head_.previous,head:this.head_,key:e,value:l},a.push(p),this.head_.previous.next=p,this.head_.previous=p,this.size++);return this};
$jscomp.Map.prototype["delete"]=function(e){var l=this.maybeGetEntry_(e);e=l.id;var p=l.list,b=l.index;return(l=l.entry)&&p?(p.splice(b,1),p.length||delete this.data_[e],l.previous.next=l.next,l.next.previous=l.previous,l.head=null,this.size--,!0):!1};$jscomp.Map.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=$jscomp.Map.createHead_();this.size=0};$jscomp.Map.prototype.has=function(e){return!!this.maybeGetEntry_(e).entry};
$jscomp.Map.prototype.get=function(e){return(e=this.maybeGetEntry_(e).entry)&&e.value};$jscomp.Map.prototype.maybeGetEntry_=function(e){var l=$jscomp.Map.getId_(e),p=this.data_[l];if(p)for(var b=0;b<p.length;b++){var a=p[b];if(e!==e&&a.key!==a.key||e===a.key)return{id:l,list:p,index:b,entry:a}}return{id:l,list:p,index:-1,entry:void 0}};$jscomp.Map.prototype.entries=function(){return this.iter_(function(e){return[e.key,e.value]})};$jscomp.Map.prototype.keys=function(){return this.iter_(function(e){return e.key})};
$jscomp.Map.prototype.values=function(){return this.iter_(function(e){return e.value})};$jscomp.Map.prototype.forEach=function(e,l){for(var p=$jscomp.makeIterator(this.entries()),b=p.next();!b.done;b=p.next())b=b.value,e.call(l,b[1],b[0],this)};
$jscomp.Map.prototype.iter_=function(e){var l=this,p=this.head_;$jscomp.initSymbol();$jscomp.initSymbolIterator();var b={};return b.next=function(){if(p){for(;p.head!=l.head_;)p=p.previous;for(;p.next!=p.head;)return p=p.next,{done:!1,value:e(p)};p=null}return{done:!0,value:void 0}},b[Symbol.iterator]=function(){return this},b};$jscomp.Map.index_=0;$jscomp.Map.defineProperty_=Object.defineProperty?function(e,l,p){Object.defineProperty(e,l,{value:String(p)})}:function(e,l,p){e[l]=String(p)};
$jscomp.Map.Entry_=function(){};$jscomp.Map.ASSUME_NO_NATIVE=!1;$jscomp.Map$install=function(){$jscomp.initSymbol();$jscomp.initSymbolIterator();!$jscomp.Map.ASSUME_NO_NATIVE&&$jscomp.Map.checkBrowserConformance_()?$jscomp.Map=$jscomp.global.Map:($jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Map.prototype[Symbol.iterator]=$jscomp.Map.prototype.entries,$jscomp.initSymbol(),$jscomp.Map.key_=Symbol("map-id-key"));$jscomp.Map$install=function(){}};$jscomp.math=$jscomp.math||{};
$jscomp.math.clz32=function(e){e=Number(e)>>>0;if(0===e)return 32;var l=0;0===(e&4294901760)&&(e<<=16,l+=16);0===(e&4278190080)&&(e<<=8,l+=8);0===(e&4026531840)&&(e<<=4,l+=4);0===(e&3221225472)&&(e<<=2,l+=2);0===(e&2147483648)&&l++;return l};$jscomp.math.imul=function(e,l){e=Number(e);l=Number(l);var p=e&65535,b=l&65535;return p*b+((e>>>16&65535)*b+p*(l>>>16&65535)<<16>>>0)|0};$jscomp.math.sign=function(e){e=Number(e);return 0===e||isNaN(e)?e:0<e?1:-1};
$jscomp.math.log10=function(e){return Math.log(e)/Math.LN10};$jscomp.math.log2=function(e){return Math.log(e)/Math.LN2};$jscomp.math.log1p=function(e){e=Number(e);if(.25>e&&-.25<e){for(var l=e,p=1,b=e,a=0,c=1;a!=b;)l*=e,c*=-1,b=(a=b)+c*l/++p;return b}return Math.log(1+e)};$jscomp.math.expm1=function(e){e=Number(e);if(.25>e&&-.25<e){for(var l=e,p=1,b=e,a=0;a!=b;)l*=e/++p,b=(a=b)+l;return b}return Math.exp(e)-1};$jscomp.math.cosh=function(e){e=Number(e);return(Math.exp(e)+Math.exp(-e))/2};
$jscomp.math.sinh=function(e){e=Number(e);return 0===e?e:(Math.exp(e)-Math.exp(-e))/2};$jscomp.math.tanh=function(e){e=Number(e);if(0===e)return e;var l=Math.exp(2*-Math.abs(e)),l=(1-l)/(1+l);return 0>e?-l:l};$jscomp.math.acosh=function(e){e=Number(e);return Math.log(e+Math.sqrt(e*e-1))};$jscomp.math.asinh=function(e){e=Number(e);if(0===e)return e;var l=Math.log(Math.abs(e)+Math.sqrt(e*e+1));return 0>e?-l:l};
$jscomp.math.atanh=function(e){e=Number(e);return($jscomp.math.log1p(e)-$jscomp.math.log1p(-e))/2};
$jscomp.math.hypot=function(e,l,p){for(var b=[],a=2;a<arguments.length;++a)b[a-2]=arguments[a];e=Number(e);l=Number(l);for(var c=Math.max(Math.abs(e),Math.abs(l)),Q=$jscomp.makeIterator(b),a=Q.next();!a.done;a=Q.next())c=Math.max(c,Math.abs(a.value));if(1E100<c||1E-100>c){e/=c;l/=c;Q=e*e+l*l;b=$jscomp.makeIterator(b);for(a=b.next();!a.done;a=b.next())a=a.value,a=Number(a)/c,Q+=a*a;return Math.sqrt(Q)*c}c=e*e+l*l;b=$jscomp.makeIterator(b);for(a=b.next();!a.done;a=b.next())a=a.value,a=Number(a),c+=
a*a;return Math.sqrt(c)};$jscomp.math.trunc=function(e){e=Number(e);if(isNaN(e)||Infinity===e||-Infinity===e||0===e)return e;var l=Math.floor(Math.abs(e));return 0>e?-l:l};$jscomp.math.cbrt=function(e){if(0===e)return e;e=Number(e);var l=Math.pow(Math.abs(e),1/3);return 0>e?-l:l};$jscomp.number=$jscomp.number||{};$jscomp.number.isFinite=function(e){return"number"!==typeof e?!1:!isNaN(e)&&Infinity!==e&&-Infinity!==e};
$jscomp.number.isInteger=function(e){return $jscomp.number.isFinite(e)?e===Math.floor(e):!1};$jscomp.number.isNaN=function(e){return"number"===typeof e&&isNaN(e)};$jscomp.number.isSafeInteger=function(e){return $jscomp.number.isInteger(e)&&Math.abs(e)<=$jscomp.number.MAX_SAFE_INTEGER};$jscomp.number.EPSILON=Math.pow(2,-52);$jscomp.number.MAX_SAFE_INTEGER=9007199254740991;$jscomp.number.MIN_SAFE_INTEGER=-9007199254740991;$jscomp.object=$jscomp.object||{};
$jscomp.object.assign=function(e,l){for(var p=[],b=1;b<arguments.length;++b)p[b-1]=arguments[b];p=$jscomp.makeIterator(p);for(b=p.next();!b.done;b=p.next())if(b=b.value)for(var a in b)Object.prototype.hasOwnProperty.call(b,a)&&(e[a]=b[a]);return e};$jscomp.object.is=function(e,l){return e===l?0!==e||1/e===1/l:e!==e&&l!==l};$jscomp.Set=function(e){e=void 0===e?[]:e;this.map_=new $jscomp.Map;if(e){e=$jscomp.makeIterator(e);for(var l=e.next();!l.done;l=e.next())this.add(l.value)}this.size=this.map_.size};
$jscomp.Set.checkBrowserConformance_=function(){var e=$jscomp.global.Set;if(!e||!e.prototype.entries||!Object.seal)return!1;var l=Object.seal({x:4}),e=new e($jscomp.makeIterator([l]));if(e.has(l)||1!=e.size||e.add(l)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var e=e.entries(),p=e.next();if(p.done||p.value[0]!=l||p.value[1]!=l)return!1;p=e.next();return p.done||p.value[0]==l||4!=p.value[0].x||p.value[1]!=p.value[0]?!1:e.next().done};
$jscomp.Set.prototype.add=function(e){this.map_.set(e,e);this.size=this.map_.size;return this};$jscomp.Set.prototype["delete"]=function(e){e=this.map_["delete"](e);this.size=this.map_.size;return e};$jscomp.Set.prototype.clear=function(){this.map_.clear();this.size=0};$jscomp.Set.prototype.has=function(e){return this.map_.has(e)};$jscomp.Set.prototype.entries=function(){return this.map_.entries()};$jscomp.Set.prototype.values=function(){return this.map_.values()};
$jscomp.Set.prototype.forEach=function(e,l){var p=this;this.map_.forEach(function(b){return e.call(l,b,b,p)})};$jscomp.Set.ASSUME_NO_NATIVE=!1;$jscomp.Set$install=function(){!$jscomp.Set.ASSUME_NO_NATIVE&&$jscomp.Set.checkBrowserConformance_()?$jscomp.Set=$jscomp.global.Set:($jscomp.Map$install(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Set.prototype[Symbol.iterator]=$jscomp.Set.prototype.values);$jscomp.Set$install=function(){}};$jscomp.string=$jscomp.string||{};
$jscomp.string.noRegExp_=function(e,l){if(e instanceof RegExp)throw new TypeError("First argument to String.prototype."+l+" must not be a regular expression");};
$jscomp.string.fromCodePoint=function(e){for(var l=[],p=0;p<arguments.length;++p)l[p-0]=arguments[p];for(var p="",l=$jscomp.makeIterator(l),b=l.next();!b.done;b=l.next()){b=b.value;b=+b;if(0>b||1114111<b||b!==Math.floor(b))throw new RangeError("invalid_code_point "+b);65535>=b?p+=String.fromCharCode(b):(b-=65536,p+=String.fromCharCode(b>>>10&1023|55296),p+=String.fromCharCode(b&1023|56320))}return p};
$jscomp.string.repeat=function(e){var l=this.toString();if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var p="";e;)if(e&1&&(p+=l),e>>>=1)l+=l;return p};$jscomp.string.repeat$install=function(){String.prototype.repeat||(String.prototype.repeat=$jscomp.string.repeat)};
$jscomp.string.codePointAt=function(e){var l=this.toString(),p=l.length;e=Number(e)||0;if(0<=e&&e<p){e|=0;var b=l.charCodeAt(e);if(55296>b||56319<b||e+1===p)return b;e=l.charCodeAt(e+1);return 56320>e||57343<e?b:1024*(b-55296)+e+9216}};$jscomp.string.codePointAt$install=function(){String.prototype.codePointAt||(String.prototype.codePointAt=$jscomp.string.codePointAt)};
$jscomp.string.includes=function(e,l){l=void 0===l?0:l;$jscomp.string.noRegExp_(e,"includes");return-1!==this.toString().indexOf(e,l)};$jscomp.string.includes$install=function(){String.prototype.includes||(String.prototype.includes=$jscomp.string.includes)};
$jscomp.string.startsWith=function(e,l){l=void 0===l?0:l;$jscomp.string.noRegExp_(e,"startsWith");var p=this.toString();e+="";for(var b=p.length,a=e.length,c=Math.max(0,Math.min(l|0,p.length)),Q=0;Q<a&&c<b;)if(p[c++]!=e[Q++])return!1;return Q>=a};$jscomp.string.startsWith$install=function(){String.prototype.startsWith||(String.prototype.startsWith=$jscomp.string.startsWith)};
$jscomp.string.endsWith=function(e,l){$jscomp.string.noRegExp_(e,"endsWith");var p=this.toString();e+="";void 0===l&&(l=p.length);for(var b=Math.max(0,Math.min(l|0,p.length)),a=e.length;0<a&&0<b;)if(p[--b]!=e[--a])return!1;return 0>=a};$jscomp.string.endsWith$install=function(){String.prototype.endsWith||(String.prototype.endsWith=$jscomp.string.endsWith)};
(function(e,l){"object"===typeof exports&&"object"===typeof module?module.exports=l():"function"===typeof define&&define.amd?define([],l):"object"===typeof exports?exports.CitrixWebRTC=l():e.CitrixWebRTC=l()})(self,function(){return function(){function e(b){var a=p[b];if(void 0!==a)return a.exports;a=p[b]={exports:{}};l[b].call(a.exports,a,a.exports,e);return a.exports}var l={945:function(b,a,c){var e=this&&this.__extends||function(){var a=function(k,v){a=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(a,g){a.__proto__=g}||function(a,g){for(var k in g)g.hasOwnProperty(k)&&(a[k]=g[k])};return a(k,v)};return function(k,v){function b(){this.constructor=k}a(k,v);k.prototype=null===v?Object.create(v):(b.prototype=v.prototype,new b)}}();Object.defineProperty(a,"__esModule",{value:!0});a.AudioElement=void 0;var u=c(658),h=c(550),d=c(851),w=c(946),q;(function(a){a.Init="Init";a.PlayStarted="PlayStarted";a.PauseCalled="PauseCalled"})(q||(q={}));b=function(a){function k(){var k=a.call(this,
null,h.class_id_t.AudioElement,0,u.ProxyMode.Local)||this;k.sinkId_="";k.srcObject_=null;k.loop_=!1;k.notiState=q.Init;return k}e(k,a);k.prototype.setSinkId=function(a){var k=this;d.logger.log(this.user_friendly_id()+".setSinkId: set sinkId to "+a);return new Promise(function(g,b){k.waitUntilConnected("AudioElement.sinkId").then(function(){var b=k.remoteInvoke(!0,h.method_id_AudioElement_t.sinkId,a);w.getRedirector().getFeatureValue(h.FEATURE_ms_teams_pstn)||(k.sinkId_=a,g());return b}).then(function(){d.logger.log(k.user_friendly_id()+
".setSinkId: success! resolving...");k.sinkId_=a;g()})["catch"](function(a){a=k.logRemoteInvokeError(a,".sinkId setter: failed to connect!");b(a)})})};Object.defineProperty(k.prototype,"sinkId",{get:function(){return this.sinkId_},set:function(a){this.setSinkId(a)},enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"srcObject",{get:function(){return this.srcObject_},set:function(a){var k=this;d.logger.log(this.user_friendly_id()+".srcObject: set srcObject to "+JSON.stringify(a));a!==
this.srcObject_&&(this.srcObject_=a,this.waitUntilConnected("AudioElement.srcObject").then(function(){return a.syncBarrier()}).then(function(a){d.logger.log(k.user_friendly_id()+".srcObject: set srcObject to s "+JSON.stringify(a));return k.remoteInvoke(!0,h.method_id_AudioElement_t.srcObject,null!==a&&void 0!==a?a.id:"null")}).then(function(){d.logger.log(k.user_friendly_id()+".srcObject setter: remote success!")})["catch"](function(a){k.logRemoteInvokeError(a,".srcObject setter: failed to connect!")}))},
enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"src",{get:function(){return this.src_},set:function(a){var k=this;d.logger.log(this.user_friendly_id()+".src: set src to "+a);this.src_=a;this.waitUntilConnected("AudioElement.src").then(function(){k.remoteInvoke(!0,h.method_id_AudioElement_t.src,a)})["catch"](function(a){k.logRemoteInvokeError(a,".src setter: failed to connect!")})},enumerable:!1,configurable:!0});k.prototype.play=function(){var a=this;d.logger.log(this.user_friendly_id()+
".play() called.");this.toggleAudio(!0);return new Promise(function(k,g){a.waitUntilConnected("AudioElement.play").then(function(){return a.remoteInvoke(!1,h.method_id_AudioElement_t.play)}).then(function(){k()})["catch"](function(k){a.logRemoteInvokeError(k,".play: failed to connect!");g(k)})})};k.prototype.playEx=function(a,k,g){var b=this;d.logger.log(this.user_friendly_id()+".playEx() src:"+a+" sinkId:"+k+" loop:"+g);this.notiState=q.PlayStarted;this.waitUntilConnected("AudioElement.playEx").then(function(){var a=
[];k&&a.push(b.setSinkId(k));void 0!==g&&null!==g&&(b.loop_=g,a.push(b.remoteInvoke(!0,h.method_id_AudioElement_t.loop,g)));return Promise.all(a)}).then(function(){b.src_=a;return b.remoteInvoke(!0,h.method_id_AudioElement_t.src,a)}).then(function(){return b.play()}).then(function(){if(b.notiState==q.PauseCalled)return d.logger.log(b.user_friendly_id()+".playEx() run deferred pause"),b.doPauseAndDispose()}).then(function(){b.notiState=q.Init;d.logger.log(b.user_friendly_id()+".playEx() done")})["catch"](function(a){b.notiState=
q.Init;b.logRemoteInvokeError(a,".playEx() failed!")})};k.prototype.pause=function(){var a=this;d.logger.log(this.user_friendly_id()+".pause() called.");this.toggleAudio(!1);return new Promise(function(k,g){a.waitUntilConnected("AudioElement.pause").then(function(){return a.remoteInvoke(!1,h.method_id_AudioElement_t.pause)}).then(function(){k()})["catch"](function(k){a.logRemoteInvokeError(k,".pause: failed!");g()})})};k.prototype.doPauseAndDispose=function(){var a=this;d.logger.log(this.user_friendly_id()+
".doPauseAndDispose() called.");this.toggleAudio(!1);return new Promise(function(k,g){a.waitUntilConnected("AudioElement.doPauseAndDispose").then(function(){return a.remoteInvoke(!1,h.method_id_AudioElement_t.pause,[])}).then(function(){d.logger.log(a.user_friendly_id()+".doPauseAndDispose() resolving...");k();a.dispose()})["catch"](function(g){a.logRemoteInvokeError(g,".doPauseAndDispose: failed to connect!")})})};k.prototype.pauseAndDispose=function(){this.notiState==q.PlayStarted?(d.logger.log(this.user_friendly_id()+
".pauseAndDispose() deferred"),this.notiState=q.PauseCalled):this.doPauseAndDispose()};k.prototype.toggleAudio=function(a){this.srcObject_&&(d.logger.log(this.user_friendly_id()+".toggleAudio() toggle audio tracks:"+a),this.srcObject_.toggleAudio(a))};Object.defineProperty(k.prototype,"loop",{get:function(){return this.loop_},set:function(a){var k=this;d.logger.log(this.user_friendly_id()+".loop: set loop to "+a);this.loop_=a;this.waitUntilConnected("AudioElement.loop").then(function(){k.remoteInvoke(!0,
h.method_id_AudioElement_t.loop,a)})["catch"](function(a){k.logRemoteInvokeError(a,".loop setter: failed to connect!")})},enumerable:!1,configurable:!0});k.prototype.dispose=function(){d.logger.log(this.user_friendly_id()+".dispose()");this.src_=this.sinkId_="";this.srcObject_=null;this.loop_=!1;this.release()};return k}(u.ProxyObject);a.AudioElement=b},239:function(b,a,c){a.E=void 0;var e=c(945),u=c(851),h=function(){function a(){this.sinkId=void 0;this.src="";this.loop=void 0;this.element=null}
a.prototype.getSrc=function(){return this.src};a.prototype.setSinkId=function(a){this.sinkId=a};a.prototype.getLoop=function(){return!0===this.loop};a.prototype.setLoop=function(a){this.loop=a};a.prototype.play=function(a){this.element=new e.AudioElement;this.src=a;this.element.playEx(this.src,this.sinkId,this.loop)};a.prototype.pause=function(){this.element&&(this.element.pauseAndDispose(),this.element=null)};a.prototype.release=function(){this.element&&(this.element.dispose(),this.element=null)};
return a}();b=function(){function a(){this.audioIdMap=null;this.audioIdMap=new Map}a.prototype.getNotificationInfo=function(a){if(this.audioIdMap.has(a))return this.audioIdMap.get(a);var b=new h;this.audioIdMap.set(a,b);return b};a.prototype.playNotifyAudio=function(a,b){b&&(u.logger.log("AudioNotification.playNotifyAudio, Remote to Thin Client audioId:"+a+" src:"+b),this.getNotificationInfo(a).play(b))};a.prototype.pauseNotifyAudio=function(a,b){if(this.audioIdMap.has(a)){var d=this.audioIdMap.get(a);
b&&b!=d.getSrc()&&u.logger.log("AudioNotification.pauseNotifyAudio warning: for audioId:"+a+", different param src:"+b+" from org src:"+d.getSrc());d.pause()}else u.logger.log("AudioNotification.pauseNotifyAudio no audioId:"+a+" src:"+b)};a.prototype.setSinkId=function(a,b){if(null!=b&&b.startsWith("speaker:")){u.logger.log("AudioNotification.setSinkId before parsing audioId:"+a+" sinkId:"+b);var d=b.slice(8);u.logger.log("AudioNotification.setSinkId after parsing audioId:"+a+" speakersinkId:"+d);
b=d}this.getNotificationInfo(a).setSinkId(b)};a.prototype.getLoop=function(a){return this.getNotificationInfo(a).getLoop()};a.prototype.setLoop=function(a,b){this.getNotificationInfo(a).setLoop(b)};a.prototype.release=function(){this.audioIdMap.forEach(function(a,b,d){a.release()});this.audioIdMap.clear()};return a}();a.E=b},613:function(b,a,c){var e=this&&this.__extends||function(){var a=function(b,d){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,
b){for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d])};return a(b,d)};return function(b,d){function k(){this.constructor=b}a(b,d);b.prototype=null===d?Object.create(d):(k.prototype=d.prototype,new k)}}();Object.defineProperty(a,"__esModule",{value:!0});a.E911Service=void 0;var u=c(550),h=c(658),d=c(851);b=function(a){function b(){var d=a.call(this,null,u.class_id_t.E911Service,0,h.ProxyMode.Local)||this;d.preE911Info_=null;return d}e(b,a);b.prototype.isSameInfo=function(a){if(null==this.preE911Info_&&
null!=a||null!=this.preE911Info_&&null==a||this.preE911Info_.e911.length!=a.e911.length||this.preE911Info_.bssid!=a.bssid||this.preE911Info_.ipv4!=a.ipv4||this.preE911Info_.subnetLengthIpv4!=a.subnetLengthIpv4||this.preE911Info_.ipv6!=a.ipv6||this.preE911Info_.subnetLengthIpv6!=a.subnetLengthIpv6||this.preE911Info_.mac!=a.mac||1E-4<=Math.abs(this.preE911Info_.latitude-a.latitude)||1E-4<=Math.abs(this.preE911Info_.longitude-a.longitude))return!1;for(var k=0;k<a.e911.length;k++)if(this.preE911Info_.e911[k].chassisId!=
a.e911[k].chassisId||this.preE911Info_.e911[k].portId!=a.e911[k].portId)return!1;return!0};Object.defineProperty(b.prototype,"onupdate",{get:function(){return this.onupdate_},set:function(a){var k=this;this.onupdate_=a;this.waitUntilConnected(this.user_friendly_id()+".onupdate").then(function(){var a=k.registerCallbacks(!1,k.isNullCallback(k.onupdate_),u.method_id_E911Service_t.onupdate);a.then(function(a){a=a.params;var g=a[0];a.slice(1);null!==k.preE911Info_&&k.isSameInfo(g)||(d.logger.log(k.user_friendly_id()+
".onupdate",JSON.stringify(g)),k.onupdate_&&k.onupdate_(g),k.preE911Info_=g)});return k.remoteInvoke(!0,u.method_id_E911Service_t.onupdate,a.success)})["catch"](function(){return d.logger.log(k.user_friendly_id()+".onupdate, could not set listener")})},enumerable:!1,configurable:!0});b.prototype.getE911Info=function(){var a=this;return new Promise(function(k,b){a.waitUntilConnected(a.user_friendly_id()+".getE911Info").then(function(){return a.remoteInvoke(!1,u.method_id_E911Service_t.getE911Info)}).then(function(b){d.logger.log(a.user_friendly_id()+
".getE911Info",JSON.stringify(a.param0(b)));k(a.param0(b))})["catch"](function(){d.logger.log(a.user_friendly_id()+".getE911Info promise rejected");b()})})};b.prototype.updateE911Info=function(){var a=this;this.getE911Info().then(function(b){return a.onupdate&&a.onupdate(b)})["catch"](function(){return d.logger.log("Fail to get e911 information!")})};return b}(h.ProxyObject);a.E911Service=b},9:function(b,a,c){var e=this&&this.__extends||function(){var a=function(b,k){a=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(a,b){a.__proto__=b}||function(a,b){for(var g in b)b.hasOwnProperty(g)&&(a[g]=b[g])};return a(b,k)};return function(b,k){function d(){this.constructor=b}a(b,k);b.prototype=null===k?Object.create(k):(d.prototype=k.prototype,new d)}}();Object.defineProperty(a,"__esModule",{value:!0});a.EngineControl=a.VersionType=void 0;var u=c(550),h=c(946),d=c(658),w=c(851);(function(a){a[a.Webrpc=0]="Webrpc";a[a.WebrtcCodecs=1]="WebrtcCodecs";a[a.Receiver=2]="Receiver";a[a.Vda=3]="Vda";a[a.Endpoint=
4]="Endpoint";a[a.TypeScript=5]="TypeScript";a[a.HdxRtcEngine=6]="HdxRtcEngine";a[a.Max=7]="Max"})(a.VersionType||(a.VersionType={}));b=function(a){function b(k){var c=a.call(this,null,u.class_id_t.EngineControl,0,d.ProxyMode.Local)||this;c.clientInfo_="";c.clientInfo_=k;return c}e(b,a);b.prototype.bind=function(){w.logger.log(this.user_friendly_id()+".bind() called.");this.reconstructor(null,u.class_id_t.EngineControl,0)};b.prototype.syncBarrier=function(){var a=this;w.logger.log(this.user_friendly_id()+
".syncBarrier() called.");return new Promise(function(b,d){a.syncBarrierDeep(b,d)&&a.waitUntilConnected("EngineControl.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,u.method_id_EngineControl_t.version,{major:0,minor:0,revision:0,build:0}),a.remoteInvoke(!1,u.method_id_EngineControl_t.feature_flags,[])])}).then(function(b){w.logger.log(a.user_friendly_id()+"received webrpc version and supported feature list.");b=b.map(function(b){return a.param0(b)});a.version_=b[0];a.features_=
b[1];h.getRedirector().setFeatures(a.features_);a.remoteInvoke(!1,u.method_id_EngineControl_t.set_client_info,(a.clientInfo_||"Unknown")+"; vdiShim/"+u.HDXMS_VERSION,h.getRedirector().sessionClientId)["catch"](function(){return w.logger.log(a.user_friendly_id()+" could not set client info")});b=[];for(var d=0,t=a.features_;d<t.length;d++){var m=t[d];"ms_teams_desktop_sharing"===m.name&&m.value?b.push(a.remoteInvoke(!1,u.method_id_EngineControl_t.version_info,[])):"ms_teams_osinfo"===m.name&&m.value?
b.push(a.remoteInvoke(!1,u.method_id_EngineControl_t.osinfo,{family:"",version:"",architecture:"",distro:"",edition:""})):"ms_teams_endpoint_id"===m.name&&m.value?b.push(a.remoteInvoke(!1,u.method_id_EngineControl_t.endpoint_id,{machine_id:"",user_id:""})):"ms_teams_hardware_info"===m.name&&m.value&&b.push(a.remoteInvoke(!1,u.method_id_EngineControl_t.hardware_info))}if(0<b.length)return Promise.all(b)}).then(function(b){if(void 0===b)w.logger.log(a.user_friendly_id()+"release-1905 client.");else{w.logger.log(a.user_friendly_id()+
"release-1906 or later client: received detailed client version list.");for(var d=0;d<b.length;d++){var t=b[d];t.hdr.proc.iid==u.class_id_t.EngineControl&&t.hdr.proc.methodid==u.method_id_EngineControl_t.version_info?a.versions_=a.param0(t):t.hdr.proc.iid==u.class_id_t.EngineControl&&t.hdr.proc.methodid==u.method_id_EngineControl_t.osinfo?a.osinfo_=a.param0(t):t.hdr.proc.iid==u.class_id_t.EngineControl&&t.hdr.proc.methodid==u.method_id_EngineControl_t.endpoint_id?a.endpointid_=a.param0(t):t.hdr.proc.iid==
u.class_id_t.EngineControl&&t.hdr.proc.methodid==u.method_id_EngineControl_t.hardware_info&&(a.hardwareinfo_=a.param0(t))}}a.syncBarrierResolve(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,"failure to retrieve version/feature related client info.");a.syncBarrierReject(b)})})};return b}(d.ProxyObject);a.EngineControl=b},368:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.Frames=a.FrameTracker=void 0;var e=c(851),u=c(946),h=c(679),d=function(){return function(a,b){this.resolve=
a;this.reject=b}}(),w=function(){function a(){this.name="overlay";this.reqs_=[];u.getRedirector().addProtocolHandler(this)}a.prototype.init=function(a){};a.prototype.reset=function(){this.reqs_.forEach(function(a,b){a.reject()});this.reqs_=[]};a.prototype.on_message=function(a){var b=this;e.logger.log("HDXMS: Overlay <<< "+JSON.stringify(a));if("capabilities"==a.command)new Promise(function(a,k){b.reqs_.push(new d(a,k));u.getRedirector().WSSendObject({v:"overlay",command:"configure",caps:[]})});else{var c=
this.reqs_.shift();void 0!=c?1==a.status&&("track_window"==a.command?c.resolve(a.windowId):"untrack_window"==a.command?c.resolve(a.windowHandle):"configure"==a.command?c.resolve({}):c.reject({})):e.logger.log("spurious response for message: "+a.command)}};a.prototype.registerWindowWithService=function(a){var b=this;return new Promise(function(c,g){var B=u.getRedirector();if(void 0==a){e.logger.log("FrameTrackerProtocol.registerWindowWithService: legacy case");var t=window.getWindowHandleAsHex.bind(window);
if(void 0===t||null===t)e.logger.log("FrameTrackerProtocol.registerWindowWithService: getWindowHandle method is undefined or null"),g({});Promise.all([t(),B.startRedirection(!1,"registerWindowWithService")]).then(function(a){e.logger.log("FrameTracker.registerWindowWithService: set window handle: "+a[0]);B.WSSendObject({v:"overlay",command:"window",windowHandle:a[0]});c(void 0)})}else e.logger.log("FrameTrackerProtocol.registerWindowWithService: new MW case"),B.startRedirection(!1,"registerWindowWithService").then(function(){b.reqs_.push(new d(c,
g));B.WSSendObject({v:"overlay",command:"track_window",windowHandle:a})})})};a.prototype.unregisterWindowWithService=function(a){var b=this;e.logger.log("FrameTrackerProtocol.unregisterWindowWithService(handle: "+a+")");return new Promise(function(c,g){void 0==a?g({}):(b.reqs_.push(new d(c,g)),u.getRedirector().WSSendObject({v:"overlay",command:"untrack_window",windowHandle:a}))})};return a}(),q=function(){function a(b){var d=this;this.running_=!1;this.elements_=[];this.clipRects=new Set;this.videos_=
[];this.connected_=!1;this.yClientAreaOffset_=this.xClientAreaOffset_=0;this.wheelEventHandler=function(a){setTimeout(function(){d.updateAll()},10)};this.scrollEventHandler=function(a){d.updateAll()};this.keyupEventHandler=function(a){"Tab"!=a.code&&"ArrowUp"!=a.code&&"ArrowDown"!=a.code&&"ArrowLeft"!=a.code&&"ArrowRight"!=a.code&&"PageUp"!=a.code&&"PageDown"!=a.code&&"Home"!=a.code&&"End"!=a.code||d.updateAll()};this.resizeEventHandler=function(a){e.logger.log("onWindowResize... update video elements position");
d.updateAll()};e.logger.log("FrameTracker.constructor: (handle: "+b+")");this.handle_=b;this.connectToService();this.observer_=new MutationObserver(function(a){d.updateAll()})}a.prototype.connectToService=function(){var b=this;a.Protocol.registerWindowWithService(this.handle_).then(function(a){e.logger.log("FrameTracker: connected to service. (windowId="+a+")");b.connected_=!0;b.windowId_=a;b.videos_.forEach(function(a){a.sinkId=JSON.stringify(b.windowId_)});b.videos_=[]})};Object.defineProperty(a.prototype,
"handle",{get:function(){return this.handle_},enumerable:!1,configurable:!0});a.prototype.getWindowFromElement=function(a){return a.ownerDocument.defaultView};a.prototype.rectanglesIntersect=function(a,b){return a.x<b.x+b.width&&a.x+a.width>b.x&&a.y<b.y+b.height&&a.y+a.height>b.y?!0:!1};a.prototype.intersectingRect=function(a,b){var d=Math.max(a.left,b.left),g=Math.max(a.top,b.top);return new DOMRect(d,g,Math.min(a.right,b.right)-d,Math.min(a.bottom,b.bottom)-g)};a.prototype.pedigreeCount=function(a,
b){for(var d=0,g=a.parentElement;null!=g&&g!=b;)d++,g=g.parentElement;return{isAncestor:null!=g,pedigree:d}};a.prototype.selectTopmost=function(a,b){var d=this.getBoundingClientRect(a),g=this.getBoundingClientRect(b),d=this.intersectingRect(d,g),g=a.ownerDocument.elementFromPoint(d.left+d.width/2,d.top+d.height/2);if(g==a)return a;if(g==b)return b;d=this.pedigreeCount(a,g);g=this.pedigreeCount(b,g);if(d.isAncestor&&g.isAncestor){if(d.pedigree<g.pedigree)return a;if(g.pedigree<d.pedigree)return b}else{if(d.isAncestor)return a;
if(g.isAncestor)return b}};a.prototype.checkOverlappingVideos=function(a){var b=this,d=this.getBoundingClientRect(a.target);a.overlaps.forEach(function(b){a.target.remoteVideoElement.removeClipRect(b.rect)});a.overlaps=[];this.elements_.forEach(function(g){if(g!=a){var c=g.overlaps.map(function(a){return a.element}).indexOf(a.target);-1!=c&&(c=g.overlaps.splice(c,1)[0],g.target.remoteVideoElement.removeClipRect(c.rect));c=b.getBoundingClientRect(g.target);if(b.rectanglesIntersect(d,c)){var t=b.selectTopmost(a.target,
g.target);t==a.target?(g.overlaps.push({element:a.target,rect:d}),g.target.remoteVideoElement.addClipRect(d)):t==g.target&&(a.overlaps.push({element:g.target,rect:c}),a.target.remoteVideoElement.addClipRect(c))}}})};a.prototype.updateAll=function(){var a=this;this.elements_.forEach(function(b){var d=a.getBoundingClientRect(b.target);if(void 0!==d){var g=b.clientRect;if(void 0===g||g.x!==d.x||g.y!==d.y||g.width!==d.width||g.height!==d.height)b.clientRect=d,b.callback(d),a.checkOverlappingVideos(b)}})};
a.prototype.track=function(a,b){var d=this,g=this.getBoundingClientRect(a);e.logger.log("Track (handle: "+this.handle_+") element frame",a,JSON.stringify(g));console.log(a);this.elements_.push({target:a,clientRect:void 0,callback:b,overlaps:[]});try{e.logger.log("[HdxWebRTC.js] Initializing occlusion for new videoElement"),this.clipRects.forEach(function(b){d.applyOcclusion(a,JSON.parse(b))})}catch(c){e.logger.log("[HdxWebRTC.js] addOcclusionInit failed! "+c)}this.running_||(e.logger.log("Start FrameTracker observer..."),
this.observer_.observe(a.ownerDocument.body,{attributes:!0,childList:!0,subtree:!0}),g=this.getWindowFromElement(a),g.addEventListener("wheel",this.wheelEventHandler),g.addEventListener("scroll",this.scrollEventHandler),g.addEventListener("keyup",this.keyupEventHandler),g.addEventListener("resize",this.resizeEventHandler),this.running_=!0);this.updateAll()};a.prototype.untrack=function(a){e.logger.log("Untrack (handle: "+this.handle_+") element frame",a);var b=-1;this.elements_.forEach(function(g,
d){g.target===a&&(b=d)});if(0<=b&&(this.elements_.splice(b,1),0===this.elements_.length)){e.logger.log("Stop FrameTracker observer...");this.observer_.disconnect();var d=this.getWindowFromElement(a);d.removeEventListener("wheel",this.wheelEventHandler);d.removeEventListener("scroll",this.scrollEventHandler);d.removeEventListener("keyup",this.keyupEventHandler);d.removeEventListener("resize",this.resizeEventHandler);this.running_=!1}};a.prototype.applyOcclusion=function(a,b){var d=this.getBoundingClientRect(a);
this.rectanglesIntersect(b,d)&&void 0!==a.remoteVideoElement&&a.remoteVideoElement.addClipRect(b)};a.prototype.addOcclusion=function(a){var b=this;e.logger.log("[HdxWebRTC.js] Adding occlusion "+JSON.stringify(a));e.logger.log("[HdxWebRTC.js] Tracking '"+this.elements_.length+"' elements.");this.clipRects.add(JSON.stringify(a));this.elements_.forEach(function(d){b.applyOcclusion(d.target,a)})};a.prototype.removeOcclusion=function(a){e.logger.log("[HdxWebRTC.js] Removing occlusion "+JSON.stringify(a));
e.logger.log("[HdxWebRTC.js] Tracking '"+this.elements_.length+"' elements.");this.clipRects["delete"](JSON.stringify(a));this.elements_.forEach(function(b){void 0!==b.target.remoteVideoElement&&b.target.remoteVideoElement.removeClipRect(a)})};a.prototype.setClientAreaOffset=function(a,b){this.xClientAreaOffset_=a;this.yClientAreaOffset_=b};a.prototype.getBoundingClientRect=function(a){a=a.getBoundingClientRect();a.x+=this.xClientAreaOffset_;a.y+=this.yClientAreaOffset_;return a};a.prototype.newVideoElement=
function(b){var d=this;e.logger.log("FrameTracker.newVideoElement: (id: "+b.id+")");if(void 0!==b.remoteVideoElement)e.logger.log("Video element is already configured!!!");else{b.id||(b.id="ctx-vid-"+a.videoElementIDs++);var c=new h.VideoElement(b.id,this.getWindowFromElement(b));this.connected_?(e.logger.log("FrameTracker.newVideoElement: initializing video element with sink id "+this.windowId_),c.sinkId=JSON.stringify(this.windowId_)):(e.logger.log("FrameTracker.newVideoElement: video element awaiting stable window state"),
this.videos_.push(c));c.onloadedmetadata=function(){b.dispatchEvent(new Event("loadedmetadata"))};c.ontimeupdate=function(){b.dispatchEvent(new Event("timeupdate"))};c.onconnectionstatechange=function(){"connected"==c.connectionState?d.track(b,function(a){c.setFrame(a)}):d.untrack(b)};delete b.remoteVideoElement;Object.defineProperty(b,"remoteVideoElement",{writable:!0,configurable:!0,value:null});b.remoteVideoElement=c;delete b.srcObject;Object.defineProperty(b,"srcObject",{configurable:!0,get:function(){return c.srcObject},
set:function(a){e.logger.log("VDI Shim set video element srcObject "+a);c.srcObject=a}});delete b.videoWidth;Object.defineProperty(b,"videoWidth",{configurable:!0,get:function(){return c.videoWidth}});delete b.videoHeight;Object.defineProperty(b,"videoHeight",{configurable:!0,get:function(){return c.videoHeight}})}};a.prototype.disposeVideoElement=function(a){e.logger.log("FrameTracker.disposeVideoElement: (id: "+a.id+")");var b=a.remoteVideoElement;if(void 0!=b){var d=this.videos_.findIndex(function(a){return a.Id==
b.Id});-1<d&&this.videos_.splice(d,1);b.dispose();a.remoteVideoElement=void 0}};a.videoElementIDs=0;a.Protocol=new w;return a}();a.FrameTracker=q;b=function(){function a(b){this.frames_=[];b&&this.frames_.push(new q(void 0))}a.prototype.newFrame=function(a){e.logger.log("Frames.newFrame: (handle: "+a+")");var b=this.findFrame(a);void 0==b&&(b=new q(a),this.frames_.push(b));return b};a.prototype.disposeFrame=function(a){e.logger.log("Frames.disposeFrame: (handle: "+a+")");var b=this.frames_.findIndex(function(b){return b.handle==
a});-1<b&&(q.Protocol.unregisterWindowWithService(a).then(function(a){e.logger.log("Untrack window (handle: "+a+") successful")}),this.frames_.splice(b,1))};a.prototype.findFrame=function(a){e.logger.log("Frames.findFrame: (handle: "+a+")");return void 0!=a?this.frames_.find(function(b){return b.handle==a}):this.frames_[0]};a.prototype.reconnect=function(){e.logger.log("Frames.reconnect()");this.frames_.forEach(function(a){a.connectToService()})};return a}();a.Frames=b},247:function(b,a){Object.defineProperty(a,
"__esModule",{value:!0});a.getGC=a.GC=void 0;var c=function(){function a(b){this.parent_=this.object_=null;this.children_=[];this.object_=b}a.prototype.addChild=function(a){a.parent_!=this&&(a.parent_=this,this.children_.push(a))};a.prototype.removeChild=function(a){var b=this.children_.indexOf(a);this.children_.splice(b,1);a.parent_=null};return a}(),e=function(){function a(){this.root_=new c(null)}a.prototype.trackObject=function(a,b){void 0===b&&(b=null);if(null===this.findNode(a,this.root_)){var e=
this.findNode(b,this.root_),h=new c(a);e?e.addChild(h):this.root_.addChild(h)}};a.prototype.releaseObject=function(a){a=this.findNode(a,this.root_);if(null===a||a===this.root_)return!1;this.destroyNodeObjectRecurse(a);a.parent_.removeChild(a);return!0};a.prototype.destroyNodeObjectRecurse=function(a){for(var b=0,c=a.children_;b<c.length;b++)this.destroyNodeObjectRecurse(c[b]);a.object_.destroy()};a.prototype.setParent=function(a,b){var c=this.findNode(a,this.root_);if(null===c)return!1;var e=this.findNode(b,
this.root_);if(null===e)return!1;if(c.parent_===e)return!0;c.parent_.removeChild(c);e.addChild(c);return!0};a.prototype.reset=function(){this.root_.children_=[]};a.prototype.findNode=function(a,b){if(b.object_===a)return b;for(var c=null,e=0,k=b.children_;e<k.length&&(c=this.findNode(a,k[e]),null===c);e++);return c};return a}();a.GC=e;var u=new e;a.getGC=function(){return u}},946:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.getRedirector=a.HdxMediaStream=a.RedirectionStatus=
a.WebrpcStatusCode=void 0;var e=c(658),u=c(851),h=c(550),d=c(545),w=c(394),q=c(691),n=function(){return function(a,b,d,m,c,k,x,r){void 0===r&&(r=void 0);this.resolve=a;this.reject=b;this.iid=d;this.oid=m;this.cbid=c;this.oneShot=k;this.mid=x;this.completion_cb=r}}(),k;(function(a){a[a.rpc_status_success=0]="rpc_status_success";a[a.rpc_status_unspecified_error=1]="rpc_status_unspecified_error";a[a.rpc_status_unexpected=2]="rpc_status_unexpected";a[a.rpc_status_index_out_of_bounds=3]="rpc_status_index_out_of_bounds";
a[a.rpc_status_missing_parameter=4]="rpc_status_missing_parameter";a[a.rpc_status_missing_return_value=5]="rpc_status_missing_return_value";a[a.rpc_status_invalid_object=6]="rpc_status_invalid_object";a[a.rpc_status_user_exception=7]="rpc_status_user_exception";a[a.rpc_status_system_error=8]="rpc_status_system_error"})(k=a.WebrpcStatusCode||(a.WebrpcStatusCode={}));var v;(function(a){a[a.NotRedirected=0]="NotRedirected";a[a.Connecting=1]="Connecting";a[a.Binding=2]="Binding";a[a.Redirected=3]="Redirected"})(v=
a.RedirectionStatus||(a.RedirectionStatus={}));b=function(){function a(){this.sessionId_="";this.handlers_=[];this.pingactive=!1;this.status=v.NotRedirected;this.reqs=[];this.cbs=[];this.deferredActions=[];this.telemetry_=new w.Telemetry;this.screenshare_=new q.ScreenShareUtil;this.stateChangeNotifcations=[];this.vdafeatures_=[]}Object.defineProperty(a.prototype,"telemetry",{get:function(){return this.telemetry_},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"screenshare",{get:function(){return this.screenshare_},
enumerable:!1,configurable:!0});a.prototype.setRemoteSessionInfoCb=function(a){this.remoteSessionInfoCb=a};a.prototype.setFeatures=function(a){this.features=a;this.screenshare.onInitComplete();this.handlers_.forEach(function(b,d){b.init(a)})};a.prototype.getFeatureValue=function(a){if(this.features){var b=this.features.find(function(b){return b.name===a});return void 0!==b?b.value:!1}return!1};a.prototype.getVDAFeatureValue=function(a){return void 0!==this.vdafeatures_.find(function(b){return b===
a})?!0:!1};a.prototype.onRedirectionComplete=function(){for(;this.deferredActions&&0<this.deferredActions.length;)this.deferredActions.shift().post(this.status==v.Redirected)};a.prototype.connectToService=function(){u.logger.log("Redirection status: Connecting...");this.status=v.Connecting;return new Promise(function(a,b){var d=new WebSocket("wss://127.0.0.1:9002");d.onopen=function(){a(d)};d.onerror=function(a){u.logger.log("websocket connection error: "+a.type);b(a)}})};a.prototype.waitUntilRedirected=
function(a){var b=this;return new Promise(function(d,c){b.status==v.Redirected?d():0>=a?c():setTimeout(function(){u.logger.log("waitUntilRedirected() timeout. count="+a);b.status!=v.Redirected?b.waitUntilRedirected(--a).then(function(){d()})["catch"](function(){c()}):d()},2E3)})};a.prototype.handleRemoteSessionInfo=function(){var a=this;u.logger.log("handleRemoteSessionInfo called.");var b=this;b.remoteSessionInfoCb?b.remoteSessionInfoCb().then(function(d){u.logger.log("remoteSessionInfo success! info:"+
JSON.stringify(d));u.logger.log("Redirection status: Redirected");b.status=v.Redirected;b.pingConnectionEnd();(d=window.onVdiClientConnected)&&d();a.telemetry.SendTelemetryInit();b.onRedirectionComplete()})["catch"](function(){u.logger.log("remoteSessionInfo failure!");b.suspendRedirection(!0);b.onRedirectionComplete()}):(u.logger.log("remoteSessionInfoCb is invalid!"),b.suspendRedirection(!0),b.onRedirectionComplete())};a.prototype.startRedirection=function(a,b){var d=this,c=window.onVdiClientDisconnected;
return new Promise(function(g,k){d.status!=v.Redirected?(u.logger.log("Attempting to start redirection: "+b),!1===a?d.deferredActions.push(new e.deferred_action(g,k,b)):d.connectToService().then(function(a){u.logger.log("Redirection status: Binding...");d.status=v.Binding;d.websocket=a;d.websocket.onmessage=function(a){d.onWSMessage(a)};d.websocket.onclose=function(a){d.onWSClose(a)};g();d.handleRemoteSessionInfo()})["catch"](function(a){u.logger.log("Unable to connect to websocket service! "+a);
k();d.suspendRedirection(!0);d.onRedirectionComplete();c&&c(!0)})):(u.logger.log("Redirection already started."),g())})};a.prototype.terminateOptimization=function(){this.websocket.close(1E3,"normal disconnecting!")};a.prototype.suspendRedirection=function(a){var b=this;u.logger.log("Suspending redirection.");this.handlers_.forEach(function(a,b){a.reset()});var d=window.onVdiClientDisconnected;try{d&&d(!1)}catch(c){u.logger.log("suspendRedirection(): exception during vdiClientDisconnect: "+c.message)}u.logger.log("Redirection status: NotRedirected");
var g=this.status;this.status=v.NotRedirected;var k=!1,d=window.getCitrixMSTeamsRedir,x=window.getCitrixWebrtcRedir,r;d?r=d:x&&(r=x);r&&r().then(function(d){u.logger.log("sucesss on disconnect"+d);"1"==d&&(k=!0,u.logger.log("Reg key exists while disconnecting"));a&&g===v.Redirected&&1==k&&(u.logger.log("Calling ping not normal disconnect"),b.pingConnectionBegin(!1))})["catch"](function(){u.logger.log("Failure to Read MS Teams redir Reg Key, not retrying...")});this.dispatchStateChangeNotifications()};
a.prototype.onWSOpen=function(){};a.prototype.onWSClose=function(a){u.logger.log("disconnected from websocket service. "+JSON.stringify(a));try{a&&1E3==a.code?this.suspendRedirection(!1):this.suspendRedirection(!0)}catch(b){u.logger.log("suspendRedirection(): exception closing WebSocket: "+b.message)}};a.prototype.onWSError=function(){try{this.suspendRedirection(!0)}catch(a){u.logger.log("suspendRedirection(): exception on WebSocket error: "+a.message)}};a.prototype.WSSendObjectWrapper=function(a,
b,d,c){var g=!0;b!=h.class_id_t.EngineControl||d!=h.method_id_EngineControl_t.ctor&&d!=h.method_id_EngineControl_t.version&&d!=h.method_id_EngineControl_t.feature_flags||(g=!1);var k=!0;if(g&&(k=!1,void 0!=this.features))for(var g=0,r=this.features;g<r.length;g++){var A=r[g];if(!0===A.value&&A.name==a){k=!0;break}}return 1==k?this.WSSendObject(c):Promise.reject("Cannot invoke method that is not supported by webrpc: iid("+b+") mid("+d+")")};a.prototype.WSSendObject=function(a){var b=this;return new Promise(function(d,
c){if("webrtc"==a.v){var g=a.hdr.proc.iid,k=a.hdr.proc.methodid,r=a.objref.oid;a.hdr.destroy||(g=new n(d,c,g,r,0,!0,k),b.reqs.push(g));g=JSON.stringify(a);u.logger.trace("WSSendObject: >>> "+h.WebrpcClassLibInfoUtil.composeClassInfoData(a)+" "+g);try{b.websocket.readyState==WebSocket.OPEN?b.websocket.send(g):(u.logger.log("WSSendObject(): warinig: web socket is not open, dropping the message!"),d({}))}catch(A){u.logger.log("WSSendObject(): exception: "+A.message),c(A.message)}}else if("overlay"==
a.v){g=JSON.stringify(a);u.logger.log("HDXMS: SendOverlayData: >>> "+g+"'");try{b.websocket.readyState==WebSocket.OPEN?b.websocket.send(g):(u.logger.log("WSSendObject(): warinig: web socket is not open, dropping the message!"),d({}))}catch(A){u.logger.log("WSSendObject(): exception: "+A.message),c(A.message)}}else if("telemetry"==a.v){g=JSON.stringify(a);u.logger.log("HDXMS: SendTelemetryData: >>> "+g+"'");try{b.websocket.readyState==WebSocket.OPEN?b.websocket.send(g):(u.logger.log("WSSendObject(): warinig: web socket is not open, dropping the message!"),
d({}))}catch(A){u.logger.log("WSSendObject(): exception: "+A.message),c(A.message)}}else if("appsharing"==a.v){g=JSON.stringify(a);u.logger.log("HDXMS: SendScreenSharingData: >>> "+g+"'");try{b.websocket.readyState==WebSocket.OPEN?b.websocket.send(g):(u.logger.log("WSSendObject(): warinig: web socket is not open, dropping the message!"),d({}))}catch(A){u.logger.log("WSSendObject(): exception: "+A.message),c(A.message)}}else u.logger.log("HDXMS: WSSendObject: Unknown protocol: '"+JSON.stringify(a)+
"'")})};a.prototype.webrpcStatusCodeToName=function(a){switch(a){case k.rpc_status_success:a="rpc_status_success";break;case k.rpc_status_unspecified_error:a="rpc_status_unspecified_error";break;case k.rpc_status_unexpected:a="rpc_status_unexpected";break;case k.rpc_status_index_out_of_bounds:a="rpc_status_index_out_of_bounds";break;case k.rpc_status_missing_parameter:a="rpc_status_missing_parameter";break;case k.rpc_status_missing_return_value:a="rpc_status_missing_return_value";break;case k.rpc_status_invalid_object:a=
"rpc_status_invalid_object";break;case k.rpc_status_user_exception:a="rpc_status_user_exception";break;case k.rpc_status_system_error:a="rpc_status_system_error";break;default:a="unknown"}return a};a.prototype.parceWebrpcError=function(a,b){void 0===a&&(a=b&&0<b.length?b[0].category||b[0].code||b[0].message?k.rpc_status_system_error:k.rpc_status_user_exception:k.rpc_status_unspecified_error);var d;switch(a){case k.rpc_status_unspecified_error:case k.rpc_status_unexpected:case k.rpc_status_index_out_of_bounds:case k.rpc_status_missing_parameter:case k.rpc_status_missing_return_value:case k.rpc_status_invalid_object:d=
new DOMException(this.webrpcStatusCodeToName(a),this.webrpcStatusCodeToName(a));break;case k.rpc_status_user_exception:d=b&&0<b.length?new DOMException(b[0],this.webrpcStatusCodeToName(a)):new DOMException(this.webrpcStatusCodeToName(a),this.webrpcStatusCodeToName(a));break;case k.rpc_status_system_error:if(b&&0<b.length){d=Object.create(DOMException);var g={value:null,writable:!0,enumerable:!1,Configurable:!0};g.value=b[0].category;Object.defineProperty(d,"name",g);g.value=b[0].code;Object.defineProperty(d,
"code",g);g.value=b[0].message;Object.defineProperty(d,"message",g)}else d=new DOMException(this.webrpcStatusCodeToName(a),this.webrpcStatusCodeToName(a))}return d};a.prototype.onWSMessage=function(a){a=a.data;var b;try{b=JSON.parse(a)}catch(g){u.logger.log("invalid JSON!!!");u.logger.log(g);u.logger.log(a);return}if("webrtc"==b.v){u.logger.trace("onWSMessage: <<< "+h.WebrpcClassLibInfoUtil.composeClassInfoData(b)+" "+a);var c=b.hdr.proc.iid,k=b.hdr.proc.methodid,e=b.objref.oid,x=b.status;if(b.hdr.msg_type==
d.WsJsonUtil.getMsgType(d.ws_msg_type_t.reply))a=this.reqs.findIndex(function(a){return a.iid==c&&a.oid==e&&a.mid==k}),0<=a?0==x?this.reqs.splice(a,1).shift().resolve(b):(x=this.parceWebrpcError(x,b.params),this.reqs.splice(a,1).shift().reject(x)):(u.logger.log("HDXMS didnt find this one. (reqs)"),u.logger.log(this.reqs));else if(b.hdr.msg_type==d.WsJsonUtil.getMsgType(d.ws_msg_type_t.event_req)){var r=b.func.id;a=this.cbs.findIndex(function(a){return a.iid==c&&a.oid==e&&a.cbid==r>>16});0<=a?(0==
(r&65535)?this.cbs[a].resolve(b):(x=this.parceWebrpcError(x,b.params),this.cbs[a].reject(x)),1==this.cbs[a].oneShot&&(this.cbs[a].completion_cb?this.cbs[a].completion_cb(this.cbs[a].cbid,this.cbs[a].mid):u.logger.log("HDXMS didnt find completion_cb for oneShot callback, something went wrong!!!! cbid="+this.cbs[a].cbid+" (iid, mid)=("+this.cbs[a].iid,","+this.cbs[a].mid+")"))):(u.logger.log("HDXMS didnt find this one. (cbs)"),u.logger.log(JSON.stringify(this.cbs)))}else u.logger.log("HDXMS Received bogus message: "+
a+"'")}else if("telemetry"==b.v)0==b.status&&(x=b.hdr.command,2==(x&2147483647)&&(a=b.hdr.id,this.telemetry.onInitialized(a),u.logger.log("Telemetry init response received")));else if("features"==b.v){a=b.features;if("feature-support"==b.command)for(u.logger.log("features capabilities received, features:"+a),this.vdafeatures_=a,x=0;x<a.length;x++)if(a[x]===h.FEATURE_vda_app_sharing)this.screenshare.onInitialized(!0);this.clientViewportMode_=b.client_viewport_mode;u.logger.log("features client_viewport_mode value: "+
this.clientViewportMode_);this.sessionId_=b.client_session_id}else if("appsharing"==b.v)a=b.status,0==a?(x=b.hdr.command,a=b.hdr.id,(x&2147483647)==q.sshare_cmd.GetSources?(u.logger.log("appsharing GetSources response received"),x=b.data,this.screenshare.onGetSources(a,x)):(x&2147483647)==q.sshare_cmd.SetActive?(u.logger.log("appsharing SetActive response received"),x=b.data,this.screenshare.onSetActive(a,x)):(x&2147483647)==q.sshare_cmd.TopologyChanged?(u.logger.log("appsharing Window topology changed cmd received"),
this.screenshare.onToplogyChanged()):(u.logger.log("invalid command reply:"+x),this.screenshare.onError(a))):(u.logger.log("invalid status reply:"+a),a=b.hdr.id,this.screenshare.onError(a));else if(x=this.handlers_.find(function(a){return a.name==b.v}),void 0!=x)x.on_message(b);else u.logger.log("HDXMS: onWSMessage: Unknown protocol: "+a+"'")};a.prototype.clearReqs=function(){u.logger.log("clearReqs()");this.reqs.forEach(function(a,b){a.reject()});this.reqs=[]};a.prototype.registerHandler=function(a,
b,d,g){a=new n(g.resolve.bind(g),g.reject.bind(g),a,b,g.id,g.oneShot,d,g.completion_cb);this.cbs.push(a)};a.prototype.unregisterHandler=function(a,b,d){var g=this.cbs.findIndex(function(g){return g.iid==a&&g.oid==b&&g.cbid==d});0<=g?this.cbs.splice(g,1):(u.logger.log("HDXMS Didnt find this callback in the list!"),u.logger.log(JSON.stringify(this.cbs)))};a.prototype.isRedirected=function(){return this.status===v.Redirected||this.status===v.Binding||this.status===v.Connecting};a.prototype.isConnected=
function(){return this.status==v.Redirected};a.prototype.isPingActive=function(){return this.pingactive};a.prototype.pingConnectionBegin=function(a){u.logger.log("Started timer");this.pingactive=!0;var b=window.onVdiClientDisconnectedTimer;1==a?(u.logger.log("checking if we are connected..."),b()):this.conntimer=setTimeout(function(){u.logger.log("checking if we are connected...");b&&b()},15E3)};a.prototype.pingConnectionEnd=function(){this.pingactive=!1;clearTimeout(this.conntimer)};a.prototype.SendTelemetryData_Speaker=
function(a){this.telemetry.SendTelemetryData(w.tel_cmd.Data,w.tel_key_SpeakerDeviceUsed,a,0)};a.prototype.registerStateChangeNotification=function(a){this.stateChangeNotifcations.push(a)};a.prototype.unregisterStateChangeNotification=function(a){this.stateChangeNotifcations=this.stateChangeNotifcations.filter(function(b){return b!=a})};a.prototype.dispatchStateChangeNotifications=function(){this.stateChangeNotifcations.forEach(function(a){a()})};a.prototype.vdabufferNoLimit=function(){for(var a=!1,
b=0,d=this.vdafeatures_;b<d.length;b++)if(d[b]===h.FEATURE_vda_service_no_buffer_limit){a=!0;break}return a};Object.defineProperty(a.prototype,"clientViewportMode",{get:function(){return this.clientViewportMode_||"unknown"},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"sessionClientId",{get:function(){return this.sessionId_||""},enumerable:!1,configurable:!0});a.prototype.addProtocolHandler=function(a){void 0==this.handlers_.find(function(b){return b.name==a.name})&&this.handlers_.push(a)};
return a}();a.HdxMediaStream=b;var z=new b;a.getRedirector=function(){return z}},985:function(b,a,c){var e=this&&this.__extends||function(){var a=function(b,d){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d])};return a(b,d)};return function(b,d){function c(){this.constructor=b}a(b,d);b.prototype=null===d?Object.create(d):(c.prototype=d.prototype,new c)}}(),u=this&&this.__spreadArrays||function(){for(var a=
0,b=0,d=arguments.length;b<d;b++)a+=arguments[b].length;for(var a=Array(a),c=0,b=0;b<d;b++)for(var e=arguments[b],g=0,h=e.length;g<h;g++,c++)a[c]=e[g];return a};Object.defineProperty(a,"__esModule",{value:!0});a.IceCandidatePair=a.IceCandidate=void 0;var h=c(658),d=c(550),w=c(851);b=function(a){function b(c,e,z){for(var g=[],h=3;h<arguments.length;h++)g[h-3]=arguments[h];return a.apply(this,u([c,d.class_id_t.RTCIceCandidate,e,z,null,[]],g))||this}e(b,a);Object.defineProperty(b.prototype,"candidate",
{get:function(){return this.candidate_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"sdpMid",{get:function(){return this.sdpMid_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"sdpMLineIndex",{get:function(){return this.sdpMLineIndex_},enumerable:!1,configurable:!0});b.prototype.syncBarrier=function(){var a=this;w.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.syncBarrierDeep(b,c)&&a.waitUntilConnected("IceCandidate.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,
d.method_id_RTCIceCandidate_t.candidate,""),a.remoteInvoke(!1,d.method_id_RTCIceCandidate_t.sdpMid,""),a.remoteInvoke(!1,d.method_id_RTCIceCandidate_t.sdpMLineIndex,0)])}).then(function(b){b=b.map(function(b){return a.param0(b)});a.candidate_=b[0];a.sdpMid_=b[1];a.sdpMLineIndex_=b[2];a.syncBarrierResolve(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier failed!");a.syncBarrierReject(b)})})};return b}(h.ProxyObject);a.IceCandidate=b;b=function(a){function b(c,e){return a.call(this,
c,d.class_id_t.RTCIceCandidatePair,e,h.ProxyMode.Remote)||this}e(b,a);Object.defineProperty(b.prototype,"local",{get:function(){return this.local_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"remote",{get:function(){return this.remote_},enumerable:!1,configurable:!0});b.prototype.syncBarrier=function(){var a=this;w.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.syncBarrierDeep(b,c)&&a.waitUntilConnected("IceCandidatePair.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,
d.method_id_RTCIceCandidatePair_t.local,{}),a.remoteInvoke(!1,d.method_id_RTCIceCandidatePair_t.remote,{})])}).then(function(b){b=b.map(function(b){return a.param0(b)});a.local_=b[0];a.remote_=b[1];a.syncBarrierResolve(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier failed!");a.syncBarrierReject(b)})})};return b}(h.ProxyObject);a.IceCandidatePair=b},851:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.logger=a.Logger=void 0;var e=c(550);b=function(){function a(b){this.tracing=
!1;this.mslogger_=void 0;this.enable_timestamp_=!1;this.tag=b;this.enabled=!0;e.BUILD_TYPE_SDK&&(this.enable_timestamp_=!0)}a.prototype.setMSLogger=function(a,b){this.mslogger_=a;void 0!=b&&(this.enable_timestamp_=b)};a.prototype.log=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.enabled&&(a=this.tag+" "+a,this.enable_timestamp_&&(b=new Date,a="["+b.getTime()+"] "+b.toISOString()+" "+a),void 0!=this.mslogger_?this.mslogger_.info(a):console.log(a))};a.prototype.logx=function(a){for(var b=
[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];a||this.log(b)};a.prototype.trace=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.tracing&&this.log.apply(this,a)};return a}();a.Logger=b;a.logger=new b("[HdxWebRTC.js]");a.logger.enabled=!0},360:function(b,a,c){var e=this&&this.__extends||function(){var a=function(b,d){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d])};return a(b,
d)};return function(b,d){function f(){this.constructor=b}a(b,d);b.prototype=null===d?Object.create(d):(f.prototype=d.prototype,new f)}}(),u=this&&this.__awaiter||function(a,b,d,f){function c(a){return a instanceof d?a:new d(function(f){f(a)})}return new (d||(d=Promise))(function(d,K){function g(a){try{m(f.next(a))}catch(b){K(b)}}function r(a){try{m(f["throw"](a))}catch(b){K(b)}}function m(a){a.done?d(a.value):c(a.value).then(g,r)}m((f=f.apply(a,b||[])).next())})},h=this&&this.__generator||function(a,
b){function d(a){return function(b){return f([a,b])}}function f(f){if(g)throw new TypeError("Generator is already executing.");for(;c;)try{if(g=1,r&&(m=f[0]&2?r["return"]:f[0]?r["throw"]||((m=r["return"])&&m.call(r),0):r.next)&&!(m=m.call(r,f[1])).done)return m;if(r=0,m)f=[f[0]&2,m.value];switch(f[0]){case 0:case 1:m=f;break;case 4:return c.label++,{value:f[1],done:!1};case 5:c.label++;r=f[1];f=[0];continue;case 7:f=c.ops.pop();c.trys.pop();continue;default:if(!(m=c.trys,m=0<m.length&&m[m.length-
1])&&(6===f[0]||2===f[0])){c=0;continue}if(3===f[0]&&(!m||f[1]>m[0]&&f[1]<m[3]))c.label=f[1];else if(6===f[0]&&c.label<m[1])c.label=m[1],m=f;else if(m&&c.label<m[2])c.label=m[2],c.ops.push(f);else{m[2]&&c.ops.pop();c.trys.pop();continue}}f=b.call(a,c)}catch(d){f=[6,d],r=0}finally{g=m=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}var c={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},g,r,m,e;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();
return e={next:d(0),"throw":d(1),"return":d(2)},"function"===typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e},d=this&&this.__spreadArrays||function(){for(var a=0,b=0,d=arguments.length;b<d;b++)a+=arguments[b].length;for(var a=Array(a),f=0,b=0;b<d;b++)for(var c=arguments[b],g=0,r=c.length;g<r;g++,f++)a[f]=c[g];return a};Object.defineProperty(a,"__esModule",{value:!0});a.PeerConnection=a.SessionDescription=a.SessionDescriptionInit=a.RtcConfiguration=a.RtcIceServer=a.IceCandidateEvent=
void 0;var w=c(946),q=c(144),n=c(589),k=c(658),v=c(985),z=c(377),g=c(650),B=c(24),t=c(550),m=c(851),D=c(517),y=c(394),x=function(a){function b(d,f,c){d=a.call(this,d,t.class_id_t.RTCIceCandidateEvent,f,k.ProxyMode.Remote)||this;d.target=c;d.type="icecandidate";return d}e(b,a);Object.defineProperty(b.prototype,"candidate",{get:function(){return this.candidate_},enumerable:!1,configurable:!0});b.prototype.syncBarrier=function(){var a=this;m.logger.log(this.user_friendly_id()+".syncBarrier() called.");
return new Promise(function(f,b){a.syncBarrierDeep(f,b)&&a.waitUntilConnected(a.user_friendly_id()+".syncBarrier").then(function(){return a.remoteInvoke(!1,t.method_id_RTCIceCandidateEvent_t.candidate,{oid:0})}).then(function(f){f=a.param0(f);return!1===f.is_null?(new v.IceCandidate(a,f.oid,k.ProxyMode.Remote)).syncBarrier():Promise.resolve(null)}).then(function(f){m.logger.log(a.user_friendly_id()+".onicecandidate: icecandidate available!");a.candidate_=f;a.syncBarrierResolve(a)})["catch"](function(f){f=
a.logRemoteInvokeError(f,".onicecandidate() failed!");a.syncBarrierReject(f)})})};return b}(k.ProxyObject);a.IceCandidateEvent=x;var r=function(){function a(b,d){this.state_="new";this.candidates_=[];this.gatheringstateupdatecb_=void 0;this.pc_=b;this.gatheringstateupdatecb_=d}a.prototype.pushState=function(a){m.logger.log(this.pc_.user_friendly_id()+".onicegatheringstatechange: new state is "+a);this.state_=a;"gathering"==this.state_?(this.candidates_=[],this.postUpdate()):this.processRemaining()};
a.prototype.addIceCandidate=function(a){var b=this;this.candidates_.push(a);var f=[];f.push(a.syncBarrier());f.push(this.pc_.updateSdpDescription(!0));Promise.all(f).then(function(a){m.logger.log(b.pc_.user_friendly_id()+".onicecandidate: icecandidate available!");b.postIceCandidate(a[0])})};a.prototype.postIceCandidate=function(a){m.logger.log(this.pc_.user_friendly_id()+".onicecandidate: posting ice candidate now!");if(null!=this.pc_.onicecandidate)this.pc_.onicecandidate(a);else m.logger.log(this.pc_.user_friendly_id()+
"onicecandidate is NULL!!!");this.candidates_.shift();this.processRemaining()};a.prototype.postUpdate=function(){m.logger.log(this.pc_.user_friendly_id()+".onicegatheringstatechange: posting event now!");var a=new p("onicegatheringstatechange",this.pc_);this.gatheringstateupdatecb_&&this.gatheringstateupdatecb_(this.state_);this.pc_.onicegatheringstatechange(a)};a.prototype.processRemaining=function(){0==this.candidates_.length&&"complete"==this.state_?(this.pc_.onicecandidate({candidate:null,target:this}),
this.postUpdate()):m.logger.log(this.pc_.user_friendly_id()+".onicecandidate: candidates remaining=["+this.candidates_.map(function(a){return a.object_id()})+"], state="+this.state_)};return a}(),A=function(){function a(){}a.toRtcIceServer=function(a,b){var f={urls:[],credential:"",username:""};a&&(a.urls?Array.isArray(a.urls)?f.urls=a.urls:f.urls.push(a.urls):m.logger.log("RtcIceServer.toRtcIceServer().urls property is missing! this is required property!"),a.credential&&(a.credential.hasOwnProperty("accessToken")?
f.credential=a.credential.accessToken:f.credential=a.credential),a.username&&(f.username=a.username));if(1==b)for(var d in a)"urls"!=d&&"credential"!=d&&"username"!=d&&m.logger.log("RtcIceServer.toRtcIceServer() warning: unsupported property:"+d);return f};return a}();a.RtcIceServer=A;var M=function(){function a(){}a.toRtcConfiguration=function(a,b){1==b&&m.logger.log("RtcConfiguration.toRtcConfiguration() in RTCConfiguration config:"+JSON.stringify(a));var f={};if(a){if(a.iceServers){f.iceServers=
[];for(var d=0,c=a.iceServers;d<c.length;d++)f.iceServers.push(A.toRtcIceServer(c[d],b))}a.iceTransportPolicy&&(f.iceTransportPolicy=a.iceTransportPolicy);a.bundlePolicy&&(f.bundlePolicy=a.bundlePolicy);a.rtcpMuxPolicy&&(f.rtcpMuxPolicy=a.rtcpMuxPolicy);a.iceTransports&&(f.iceTransports=a.iceTransports);a.sdpSemantics&&(f.sdpSemantics=a.sdpSemantics);a.enableDtlsSrtp&&(f.enableDtlsSrtp=a.enableDtlsSrtp);a.enableDscp&&(f.enableDscp=a.enableDscp)}if(1==b){for(var g in a)"iceServers"!=g&&"iceTransportPolicy"!=
g&&"bundlePolicy"!=g&&"rtcpMuxPolicy"!=g&&"iceTransports"!=g&&"sdpSemantics"!=g&&"enableDtlsSrtp"!=g&&"enableDscp"!=g&&m.logger.log("RtcConfiguration.toRtcConfiguration() warning: unsupported property:"+g);m.logger.log("RtcConfiguration.toRtcConfiguration() converted RtcConfiguration config:"+JSON.stringify(f))}return f};return a}();a.RtcConfiguration=M;var F=function(){return function(a,b){this.sdp=b;this.type=a}}();a.SessionDescriptionInit=F;var l=function(a){function b(c,f,g){for(var r=[],m=3;m<
arguments.length;m++)r[m-3]=arguments[m];return a.apply(this,d([c,t.class_id_t.RTCSessionDescription,f,g,null,[]],r))||this}e(b,a);b.prototype.toJSON=function(){return{type:this.type_,sdp:this.sdp_}};Object.defineProperty(b.prototype,"sdp",{get:function(){return this.sdp_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"type",{get:function(){return this.type_},enumerable:!1,configurable:!0});b.prototype.syncBarrier=function(){var a=this;m.logger.log(this.user_friendly_id()+".syncBarrier() called.");
return new Promise(function(f,b){a.syncBarrierDeep(f,b)&&a.waitUntilConnected(a.user_friendly_id()+".syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,t.method_id_RTCSessionDescription_t.type,0),a.remoteInvoke(!1,t.method_id_RTCSessionDescription_t.sdp,"")])}).then(function(f){a.type_=a.convertType(a.param0(f[0]));a.sdp_=a.param0(f[1]);a.syncBarrierResolve(a)})["catch"](function(f){f=a.logRemoteInvokeError(f,".syncBarrier() failed!");a.syncBarrierReject(f)})})};b.prototype.convertType=
function(a){return 0==a?"offer":1==a?"pranswer":2==a?"answer":"rollback"};b.convertC2H=function(a){return"offer"==a?0:"pranswer"==a?1:"answer"==a?2:3};return b}(k.ProxyObject);a.SessionDescription=l;var p=function(){return function(a,b){this.type=a;this.target=b}}(),L=function(){return function(){}}(),P=function(){function a(b,d){this.local=b;this.remote=d}Object.defineProperty(a.prototype,"active",{get:function(){var a=!1;if(1==this.local||1==this.remote)a=!0;return a},enumerable:!1,configurable:!0});
return a}();b=function(a){function b(d){var f=a.call(this,null,t.class_id_t.RTCPeerConnection,0,k.ProxyMode.Local,null,[],b.ensure_config_defined(d,!1),{})||this;f.timeerstarted_=!1;f.firsttimeremoteoffer_=!1;f.firststable_=!1;f.firsttimelocaloffer_=!1;f.audiocall_=new P(!1,!1);f.videocall_=new P(!1,!1);f.screensharingcall_=new P(!1,!1);f.conferencecall_=!1;f.incomingcall_=!1;f.outgoingcall_=!1;f.usingasynconly_=!1;f.rtcconfig_=b.ensure_config_defined(d,!0);m.logger.log(f.user_friendly_id()+".constructor sdpSemantics="+
f.rtcconfig_.sdpSemantics);if(!t.BUILD_TYPE_SDK&&f.isUnified()&&!w.getRedirector().getFeatureValue(t.FEATURE_ms_teams_webrtc_1dot0))throw new DOMException("CWA client does not support unified sdpSemantic","createPeerConnection");f.pendingtransceiver_=0;f.pendingtrack_=0;f.deferredOfferAnswers=[];f.localStreams=[];f.remoteStreams=[];f.onaddstream_=null;f.signalingState_="stable";f.iceConnectionState_="new";f.iceGatheringState_="new";f.iceQ_=new r(f,function(a){f.onicegatheringstateupdate(a)});f.receivers_=
[];f.senders_=[];f.transceivers_=[];f.registerStateChangeNotification(f.onStateChange);f.localdatachannel_=null;f.remotedatachannel_=null;return f}e(b,a);b.ensure_config_defined=function(a,f){return M.toRtcConfiguration(a,f)};b.prototype.dumpSdp=function(a){m.logger.log(this.user_friendly_id()+".dumpSdp");a&&(m.logger.log(this.user_friendly_id()+"  -- type: "+a.type),m.logger.log(this.user_friendly_id()+"  -- sdp: "+a.sdp))};Object.defineProperty(b.prototype,"localDescription",{get:function(){m.logger.log(this.user_friendly_id()+
".get_localDescription() called.");return this.localDescription_},set:function(a){m.logger.log(this.user_friendly_id()+".set_localDescription() called.");this.localDescription_=a},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"remoteDescription",{get:function(){m.logger.log(this.user_friendly_id()+".get_remoteDescription() called.");return this.remoteDescription_},set:function(a){m.logger.log(this.user_friendly_id()+".get_remoteDescription() called.");this.remoteDescription_=a},
enumerable:!1,configurable:!0});b.prototype.isUnified=function(){return"unified"==this.rtcconfig_.sdpSemantics||"unified-plan"==this.rtcconfig_.sdpSemantics};b.prototype.onStateChange=function(){var a=new p("iceconnectionstatechange",this);if(this.oniceconnectionstatechange_)this.oniceconnectionstatechange_(a)};b.prototype.addIceCandidate=function(a){var f=this;m.logger.log(this.user_friendly_id()+".addIceCandidate() called.");this.waitUntilConnected(this.user_friendly_id()+".addIceCandidate").then(function(){var b=
{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex};if(void 0==b.candidate||null==b.candidate)b.candidate="";void 0==b.sdpMid&&(b.sdpMid=null);void 0==b.sdpMLineIndex&&(b.sdpMLineIndex=null);return(new v.IceCandidate(f,0,k.ProxyMode.Local,b)).syncBarrier()}).then(function(a){return f.remoteInvokeEx(!1,t.method_id_RTCPeerConnection_t.addIceCandidate,[a],{})}).then(function(){m.logger.log(f.user_friendly_id()+".addIceCandidate() success.");return f.updateSdpDescription(!1)}).then(function(){m.logger.log(f.user_friendly_id()+
".addIceCandidate() - sync remote sdp success.")})["catch"](function(a){f.logRemoteInvokeError(a,".addIceCandidate() failed!")})};Object.defineProperty(b.prototype,"onicecandidate",{get:function(){return this.onicecandidate_},set:function(a){var f=this;m.logger.log(this.user_friendly_id()+".set_onicecandidate() called.");this.onicecandidate_=a;this.waitUntilConnected(this.user_friendly_id()+".onicecandidate").then(function(){var b=f.registerCallbacks(!1,f.isNullCallback(a),t.method_id_RTCPeerConnection_t.onicecandidate);
b.then(function(a){m.logger.log(f.user_friendly_id()+".onicecandidate callback received!!!");a=new x(f,f.param0(a).oid,f);null!=f.iceQ_&&f.iceQ_.addIceCandidate(a)});return f.remoteInvoke(!0,t.method_id_RTCPeerConnection_t.onicecandidate,b.success)})["catch"](function(a){f.logRemoteInvokeError(a,".set_onicecandidate() failed!")})},enumerable:!1,configurable:!0});b.prototype.convertIceConnectionState=function(a){return 0==a?"new":1==a?"checking":2==a?"connected":3==a?"completed":4==a?"failed":5==a?
"disconnected":"closed"};b.prototype.convertConnectionState=function(a){if(0!=a){if(1==a)return"connecting";if(2==a)return"connected";if(3==a)return"disconnected";if(4==a)return"failed";if(5==a)return"closed"}return"new"};Object.defineProperty(b.prototype,"onconnectionstatechange",{get:function(){return this.onconnectionstatechange_},set:function(a){var f=this;m.logger.log(this.user_friendly_id()+".set_onconnectionstatechange() called.");this.onconnectionstatechange_=a;this.waitUntilConnected(this.user_friendly_id()+
".onconnectionstatechange").then(function(){var b=f.registerCallbacks(!1,f.isNullCallback(a),t.method_id_RTCPeerConnection_t.onconnectionstatechange);b.then(function(a){m.logger.log(f.user_friendly_id()+".onconnectionstatechange(): success callback received!!!");f.connectionState_=f.convertConnectionState(f.param0(a));m.logger.log(f.user_friendly_id()+" connectionState=:"+f.connectionState_);a=new p("connectionstatechange",f);if(f.onconnectionstatechange_)f.onconnectionstatechange_(a)});return f.remoteInvoke(!0,
t.method_id_RTCPeerConnection_t.onconnectionstatechange,b.success)})["catch"](function(a){f.logRemoteInvokeError(a,".set_onconnectionstatechange() failed!")})},enumerable:!1,configurable:!0});b.prototype.get_connectionState=function(){m.logger.log(this.user_friendly_id()+".get_connectionState() called, value = "+this.connectionState_);return this.isRedirected()?this.connectionState_:"failed"};Object.defineProperty(b.prototype,"oniceconnectionstatechange",{get:function(){return this.oniceconnectionstatechange_},
set:function(a){var f=this;m.logger.log(this.user_friendly_id()+".set_oniceconnectionstatechange() called.");this.oniceconnectionstatechange_=a;this.waitUntilConnected(this.user_friendly_id()+".oniceconnectionstatechange").then(function(){var b=f.registerCallbacks(!1,f.isNullCallback(a),t.method_id_RTCPeerConnection_t.oniceconnectionstatechange);b.then(function(a){m.logger.log(f.user_friendly_id()+".oniceconnectionstatechange(): success callback received!!!");f.iceConnectionState_=f.convertIceConnectionState(f.param0(a));
a=new p("iceconnectionstatechange",f);if(f.oniceconnectionstatechange_)f.oniceconnectionstatechange_(a)});return f.remoteInvoke(!0,t.method_id_RTCPeerConnection_t.oniceconnectionstatechange,b.success)})["catch"](function(a){f.logRemoteInvokeError(a,".set_oniceconnectionstatechange() failed!")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"iceConnectionState",{get:function(){m.logger.log(this.user_friendly_id()+".get_iceConnectionState() called, value = "+this.iceConnectionState_);
return this.isRedirected()?this.iceConnectionState_:"failed"},enumerable:!1,configurable:!0});b.prototype.convertIceGatheringState=function(a){return 0==a?"new":1==a?"gathering":"complete"};b.prototype.onicegatheringstateupdate=function(a){m.logger.log(this.user_friendly_id()+".onicegatheringstateupdate() current:"+this.iceGatheringState_+" updating to:"+a);this.iceGatheringState_=a;m.logger.log(this.user_friendly_id()+".onicegatheringstateupdate() after update: iceGatheringState_:"+this.iceGatheringState_)};
Object.defineProperty(b.prototype,"onicegatheringstatechange",{get:function(){return this.onicegatheringstatechange_},set:function(a){var f=this;m.logger.log(this.user_friendly_id()+".set_onicegatheringstatechange() called.");this.onicegatheringstatechange_=a;this.waitUntilConnected(this.user_friendly_id()+".onicegatheringstatechange").then(function(){var b=f.registerCallbacks(!1,f.isNullCallback(a),t.method_id_RTCPeerConnection_t.onicegatheringstatechange);b.then(function(a){m.logger.log(f.user_friendly_id()+
".onicegatheringstatechange(): callback received!!!");a=f.convertIceGatheringState(f.param0(a));null!=f.iceQ_&&f.iceQ_.pushState(a)});return f.remoteInvoke(!0,t.method_id_RTCPeerConnection_t.onicegatheringstatechange,b.success)})["catch"](function(a){f.logRemoteInvokeError(a,".set_onicegatheringstatechange() failed!")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"iceGatheringState",{get:function(){m.logger.log(this.user_friendly_id()+".get_iceGatheringState() called, value = "+
this.iceGatheringState_);return this.iceGatheringState_},enumerable:!1,configurable:!0});b.prototype.convertSignalState=function(a){return 0==a?"stable":1==a?"have-local-offer":2==a?"have-local-pranswer":3==a?"have-remote-offer":4==a?"have-remote-pranswer":"closed"};b.prototype.TelemtryReadings_=function(){var a=this;"have-local-offer"==this.signalingState_&&0==this.firsttimelocaloffer_&&0==this.firsttimeremoteoffer_&&(this.outgoingcallstart_=(new Date).getTime(),0==this.outgoingcall_&&(this.SendTelemetryData(y.tel_key_PerfCallState,
y.tel_CallState.active,1),this.SendTelemetryData(y.tel_key_PerfCallDirection,y.tel_CallDirection.outgoing,1),this.outgoingcall_=!0),this.firsttimelocaloffer_=!0);"have-remote-offer"==this.signalingState_&&0==this.firsttimeremoteoffer_&&0==this.firsttimelocaloffer_&&(this.incomingcallstart_=(new Date).getTime(),0==this.incomingcall_&&(this.SendTelemetryData(y.tel_key_PerfCallState,y.tel_CallState.active,1),this.SendTelemetryData(y.tel_key_PerfCallDirection,y.tel_CallDirection.incoming,1),this.incomingcall_=
!0),this.firsttimeremoteoffer_=!0);"stable"==this.signalingState_&&0==this.firststable_&&(this.callstartTime_=(new Date).getTime(),this.firststable_=this.timeerstarted_=!0);if("stable"==this.signalingState_){for(var f=0,b=this.localStreams;f<b.length;f++){var d=b[f];1<=d.getAudioTracks().length&&0==this.audiocall_.local&&(this.SendTelemetryData(y.tel_key_PerfCallType,y.tel_CallType.audio,1),this.audiocall_.local=!0);d=d.getVideoTracks();if(1<=d.length)for(var c=0,g=d;c<g.length;c++)d=g[c],1==d.getSettings().deviceId.includes("display")?
0==this.screensharingcall_.local&&(this.SendTelemetryData(y.tel_key_PerfCallType,y.tel_CallType.dshare,1),this.screensharingcall_.local=!0):0==this.videocall_.local&&(this.SendTelemetryData(y.tel_key_PerfCallType,y.tel_CallType.video,1),this.videocall_.local=!0)}f=0;for(b=this.remoteStreams;f<b.length;f++)if(d=b[f],1<=d.getAudioTracks().length&&0==this.audiocall_.remote&&(this.SendTelemetryData(y.tel_key_PerfCallType,y.tel_CallType.audio,1),this.audiocall_.remote=!0),c=d.getVideoTracks(),1<=c.length)for(d=
0;d<c.length;d++)1==c[d].id.includes("applicationsharingVideo")?0==this.screensharingcall_.remote&&(this.SendTelemetryData(y.tel_key_PerfCallType,y.tel_CallType.dshare,1),this.screensharingcall_.remote=!0):0==this.videocall_.remote&&(this.SendTelemetryData(y.tel_key_PerfCallType,y.tel_CallType.video,1),this.videocall_.remote=!0);this.getReceiversAsync().then(function(f){2<f.length&&0==a.conferencecall_&&(a.SendTelemetryData(y.tel_key_PerfCallType,y.tel_CallType.multi,1),a.conferencecall_=!0)})}};
Object.defineProperty(b.prototype,"onsignalingstatechange",{set:function(a){var f=this;m.logger.log(this.user_friendly_id()+".set_onsignalingstatechange() called.");this.onsignalingstatechange_=a;this.waitUntilConnected(this.user_friendly_id()+".onsignalingstatechanged").then(function(){var b=f.registerCallbacks(!1,f.isNullCallback(a),t.method_id_RTCPeerConnection_t.onsignalingstatechange);b.then(function(a){m.logger.log(f.user_friendly_id()+".onsignalingstatechange(): callback received!!!");f.signalingState_=
f.convertSignalState(f.param0(a));a=new p("onsignalingstatechange",f);if(f.onsignalingstatechange_)f.onsignalingstatechange_(a);f.TelemtryReadings_()});return f.remoteInvoke(!0,t.method_id_RTCPeerConnection_t.onsignalingstatechange,b.success)})["catch"](function(a){f.logRemoteInvokeError(a,".set_onsignalingstatechange() failed!")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onsignalingstatechanged",{get:function(){return this.onsignalingstatechange_},enumerable:!1,configurable:!0});
Object.defineProperty(b.prototype,"ontrack",{get:function(){return this.ontrack_},set:function(a){var f=this;m.logger.log(this.user_friendly_id()+".set_ontrack() called.");this.ontrack_=a;this.waitUntilConnected(this.user_friendly_id()+".ontrack").then(function(){var b=f.registerCallbacks(!1,f.isNullCallback(a),t.method_id_RTCPeerConnection_t.ontrack);b.then(function(a){return u(f,void 0,void 0,function(){var f,b,d,c,r,K,C,e,x,A,t,v=this;return h(this,function(h){m.logger.log(this.user_friendly_id()+
".ontrack(): callback received!!!");f=new L;b=[];d=this.param0(a);void 0!=d.track&&!1===d.track.is_null&&(m.logger.log(this.user_friendly_id()+" adding a RemoteMediaTrack with oid:"+d.track.oid),c=new q.RemoteMediaTrack(this,d.track.oid),b.push(c.syncBarrier()));f.track=c;void 0!=d.receiver&&!1===d.receiver.is_null&&(r=this.receivers_.find(function(a){return a.object_id()===d.receiver.oid}),void 0===r&&(m.logger.log(this.user_friendly_id()+" adding a RtpReceiver with oid:"+d.receiver.oid),r=new n.RtpReceiver(this,
d.receiver.oid,k.ProxyMode.Remote,this.isUnified(),c)),b.push(r.syncBarrier()));f.receiver=r;g.RemoteSession.isFeatureWebrtc1dot0Supported()&&void 0!=d.transceiver&&!1===d.transceiver.is_null&&(K=this.transceivers_.find(function(a){return a.object_id()===d.transceiver.oid}),void 0===K&&(m.logger.log(this.user_friendly_id()+" adding a RtpTransceiver with oid:"+d.transceiver.oid),K=new z.RtpTransceiver(this,d.transceiver.oid,k.ProxyMode.Remote,this.isUnified(),z.RtcRtpTransceiverDirection.inactive,
r),this.transceivers_.push(K)),b.push(K.syncBarrier()));f.transceiver=K;f.streams=[];if(void 0!=d.streams)for(C=function(a){var d=e.remoteStreams.find(function(f){return!1===a.is_null&&f.object_id()===a.oid});void 0===d&&(m.logger.log(e.user_friendly_id()+" adding a RemoteStream with oid:"+a.oid),d=new q.RemoteStream(e,a.oid,k.ProxyMode.Remote),e.remoteStreams.push(d));b.push(d.syncBarrier());f.streams.push(d)},e=this,x=0,A=d.streams;x<A.length;x++)t=A[x],C(t);m.logger.log(this.user_friendly_id()+
".ontrack(): .prop.syncBarrier start");Promise.all(b).then(function(){m.logger.log(v.user_friendly_id()+".ontrack(): notified!!! with evt: "+f);for(var a=0,b=f.streams;a<b.length;a++)b[a].toggleAudio(!1);if(v.ontrack_)v.ontrack_(f)})["catch"](function(a){v.logRemoteInvokeError(a,".ontrack(): .prop.syncBarrier failed.")});return[2]})})});return f.remoteInvoke(!0,t.method_id_RTCPeerConnection_t.ontrack,b.success)})["catch"](function(a){f.logRemoteInvokeError(a,".set_ontrack(): failed.")})},enumerable:!1,
configurable:!0});Object.defineProperty(b.prototype,"signalingState",{get:function(){m.logger.log(this.user_friendly_id()+".get_signalingState() called, value = "+this.signalingState_);return this.signalingState_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onnegotiationneeded",{get:function(){return this.onnegotiationneeded_},set:function(a){var f=this;m.logger.log(this.user_friendly_id()+".set_onnegotiationneeded() called.");this.onnegotiationneeded_=a;this.waitUntilConnected(this.user_friendly_id()+
".onnegotiationneeded").then(function(){var b=f.registerCallbacks(!1,f.isNullCallback(a),t.method_id_RTCPeerConnection_t.onnegotiationneeded);b.then(function(){m.logger.log(f.user_friendly_id()+".onnegotiationneeded(): callback received!!!");var a=new p("negotiationneeded",f);if(f.onnegotiationneeded_)f.onnegotiationneeded_(a)});return f.remoteInvoke(!0,t.method_id_RTCPeerConnection_t.onnegotiationneeded,b.success)})["catch"](function(a){f.logRemoteInvokeError(a,".set_onnegotiationneeded(): failed.")})},
enumerable:!1,configurable:!0});b.prototype.dumpConstraints=function(a){m.logger.log(this.user_friendly_id()+"constraints: "+a);void 0!==a&&0!==Object.keys(a).length||m.logger.log(this.user_friendly_id()+"constraints either undefined or empty!");a&&(m.logger.log(this.user_friendly_id()+"  -- video: "+a.offerToReceiveVideo),m.logger.log(this.user_friendly_id()+"  -- audio: "+a.offerToReceiveAudio),m.logger.log(this.user_friendly_id()+"  -- iceRestart: "+a.iceRestart),m.logger.log(this.user_friendly_id()+
"  -- voiceActivityDetection: "+a.voiceActivityDetection))};b.prototype.fix_constraints=function(a){this.dumpConstraints(a);var f={};this.isUnified()||(f={audio:!0,video:!0});if(a){if(void 0!==a.video||void 0!==a.offerToReceiveVideo)f.video=a.offerToReceiveVideo;if(void 0!==a.audio||void 0!==a.offerToReceiveAudio)f.audio=a.offerToReceiveAudio;void 0!==a.iceRestart&&(f.iceRestart=a.iceRestart);void 0!==a.voiceActivityDetection&&(f.voiceActivityDetection=a.voiceActivityDetection)}return f};b.prototype.createOffer=
function(a,f,b){m.logger.log(this.user_friendly_id()+".createOffer() called.",JSON.stringify(a));return this.isUnified()?void 0==a?this.createOffer_v2():a?this.createOffer_v2(a):this.createOffer_v1(a,f,b):this.createOffer_v1(a,f,b)};b.prototype.createOffer_v2=function(a){var f=this;m.logger.log(this.user_friendly_id()+".createOffer_v2() called.",JSON.stringify(a));return new Promise(function(b,d){f.createOffer_v1(function(a){m.logger.log(f.user_friendly_id()+".createOffer_v2(): got sdp!!!",JSON.stringify(a));
a=new F(a.type,a.sdp);b(a)},function(a){void 0!=a&&(a=f.logRemoteInvokeError(a,".createOffer_v2() failed."),d(a))},a)})};b.prototype.createOffer_v1=function(a,f,b){var d=this;m.logger.log(this.user_friendly_id()+".createOffer_v1().",JSON.stringify(b));var c=[this.waitUntilConnected(this.user_friendly_id()+".createOffer_v1"),this.waitTransceiverAndTrackReady(this.user_friendly_id()+".createOffer_v1")];Promise.all(c).then(function(){var a=d.registerCallbacks(!0,!1,t.method_id_RTCPeerConnection_t.createOffer);
d.remoteInvoke(!1,t.method_id_RTCPeerConnection_t.createOffer,a.success,a.fail,d.fix_constraints(b));return a.prom()}).then(function(a){m.logger.log(d.user_friendly_id()+".createOffer_v1(): success callback received!!!");return(new l(d,d.param0(a).oid,k.ProxyMode.Remote)).syncBarrier()}).then(function(f){a&&a(f)})["catch"](function(a){void 0!=a&&(a=d.logRemoteInvokeError(a,".createOffer_v1() failed."),f&&f(a))})};b.prototype.createAnswer=function(a,f,b){m.logger.log(this.user_friendly_id()+".createAnswer() called.",
JSON.stringify(a));return this.isUnified()?void 0==a?this.createAnswer_v2():a?this.createAnswer_v2(a):this.createAnswer_v1(a,f,b):this.createAnswer_v1(a,f,b)};b.prototype.createAnswer_v2=function(a){var f=this;m.logger.log(this.user_friendly_id()+".createAnswer_v2() called.",JSON.stringify(a));return new Promise(function(b,d){f.createAnswer_v1(function(a){m.logger.log(f.user_friendly_id()+".createAnswer_v2(): got sdp!!!",JSON.stringify(a));a=new F(a.type,a.sdp);b(a)},function(a){void 0!=a&&(a=f.logRemoteInvokeError(a,
".createAnswer_v2() failed."),d(a))},a)})};b.prototype.createAnswer_v1=function(a,f,b){var d=this;m.logger.log(this.user_friendly_id()+".createAnswer_v1() called.",JSON.stringify(b));var c=[this.waitUntilConnected(this.user_friendly_id()+".createAnswer_v1"),this.waitTransceiverAndTrackReady(this.user_friendly_id()+".createAnswer_v1")];Promise.all(c).then(function(){var a=d.registerCallbacks(!0,!1,t.method_id_RTCPeerConnection_t.createAnswer);d.remoteInvoke(!1,t.method_id_RTCPeerConnection_t.createAnswer,
a.success,a.fail,d.fix_constraints(b),{});return a.prom()}).then(function(a){m.logger.log(d.user_friendly_id()+".createAnswer_v1(): success callback received!!!");return(new l(d,d.param0(a).oid,k.ProxyMode.Remote)).syncBarrier()}).then(function(f){a&&a(f)})["catch"](function(a){a=d.logRemoteInvokeError(a,".createAnswer_v1() failed.");f&&f(a.message)})};b.prototype.updateSdpDescription=function(a){m.logger.log(this.user_friendly_id()+".updateSdpDescription() called.");var f=this;return new Promise(function(b,
d){var c=[];1==a?c.push(f.remoteInvoke(!1,t.method_id_RTCPeerConnection_t.localDescription,{oid:0})):c.push(f.remoteInvoke(!1,t.method_id_RTCPeerConnection_t.remoteDescription,{oid:0}));Promise.all(c).then(function(a){m.logger.log(f.user_friendly_id()+".updateSdpDescription() resolved.");return(new l(f,f.param0(a[0]).oid,k.ProxyMode.Remote)).syncBarrier()}).then(function(d){1==a?f.localDescription_=d:f.remoteDescription_=d;m.logger.log(f.user_friendly_id()+".updateSdpDescription() updated sdp");b()})["catch"](function(a){f.logRemoteInvokeError(a,
"sdp.syncBarrier() failed!");d()})})};b.prototype.sdpToString=function(a){var f="",b=0;for(a=a?a.split(/\r?\n/):[];b<a.length;b++){var d=a[b];-1!=d.indexOf("m=",0)?f+=d+"\\r\\n":-1!=d.indexOf("o=-",0)?f+=d+"\\r\\n":-1!=d.indexOf("a=ssrc",0)&&(f+=d+"\\r\\n")}return f};b.prototype.setLocalDescription=function(a,f,b){m.logger.log(this.user_friendly_id()+".setLocalDescription() called.",this.sdpToString(a.sdp));if(a instanceof F)return this.setLocalDescription_v2(a);if(a instanceof RTCSessionDescription&&
f)return this.setLocalDescription_v1(a,f,b);f=void 0;a?f=new F(a.type,a.sdp):(m.logger.log(this.user_friendly_id()+".setLocalDescription() empty param1, setting sdp type to rollback"),a=void 0,a="have-remote-offer"==this.signalingState_?"answer":"have-local-pranswer"==this.signalingState_||"have-remote-pranswer"==this.signalingState_?"pranswer":"offer",f=new F(a,""));return this.setLocalDescription_v2(f)};b.prototype.setLocalDescription_v2=function(a){var f=this;m.logger.log(this.user_friendly_id()+
".setLocalDescription_v2() called.");return new Promise(function(b,d){f.waitUntilConnected(f.user_friendly_id()+".setLocalDescription_v2").then(function(){return(new l(f,0,k.ProxyMode.Local,{type:l.convertC2H(a.type),sdp:a.sdp})).syncBarrier()}).then(function(c){var g=f.registerCallbacks(!0,!1,t.method_id_RTCPeerConnection_t.setLocalDescription_v2),r={type:l.convertC2H(a.type),sdp:a.sdp};f.remoteInvoke(!1,t.method_id_RTCPeerConnection_t.setLocalDescription_v2,r,g.success,g.fail);g.prom().then(function(){m.logger.log(f.user_friendly_id()+
".setLocalDescription_v2(): success callback received!!!");f.localDescription_=c;m.logger.log(f.user_friendly_id()+".setLocalDescription_v2(): updated localDescription_");Promise.all([]).then(function(){m.logger.log(f.user_friendly_id()+".setLocalDescription_v2() success.");b()})["catch"](function(a){a=f.logRemoteInvokeError(a,".prop.setLocalDescription_v2() failed!");d(a)})})["catch"](function(a){a=f.logRemoteInvokeError(a,"setLocalDescription_v2() error callback received!");d(a)})})["catch"](function(a){a=
f.logRemoteInvokeError(a,".setLocalDescription_v2() failed.");d(a)})})};b.prototype.setLocalDescription_v1=function(a,f,b){var d=this;m.logger.log(this.user_friendly_id()+".setLocalDescription_v1() called.");this.waitUntilConnected(this.user_friendly_id()+".setLocalDescription_v1").then(function(){return(new l(d,0,k.ProxyMode.Local,{type:l.convertC2H(a.type),sdp:a.sdp})).syncBarrier()}).then(function(a){var c=d.registerCallbacks(!0,!1,t.method_id_RTCPeerConnection_t.setLocalDescription);d.remoteInvokeEx(!1,
t.method_id_RTCPeerConnection_t.setLocalDescription,[a],c.success,c.fail);c.prom().then(function(){m.logger.log(d.user_friendly_id()+".setLocalDescription_v1(): success callback received!!!");d.localDescription_=a;m.logger.log(d.user_friendly_id()+".setLocalDescription_v1(): updated localDescription_");Promise.all([]).then(function(){m.logger.log(d.user_friendly_id()+".setLocalDescription_v1() success.");f&&f()})["catch"](function(a){a=d.logRemoteInvokeError(a,".prop.setLocalDescription_v1() failed.");
b&&b(a.message)})})["catch"](function(a){a=d.logRemoteInvokeError(a,".setLocalDescription_v1() error callback received.");b&&b(a.message)})})["catch"](function(a){a=d.logRemoteInvokeError(a,".setLocalDescription_v1() failed.");b&&b(a.message)})};b.prototype.setRemoteDescription=function(a,f,b){m.logger.log(this.user_friendly_id()+".setRemoteDescription() called.",this.sdpToString(a.sdp));if(a instanceof F)return this.setRemoteDescription_v2(a);if(a instanceof RTCSessionDescription&&f)return this.setRemoteDescription_v1(a,
f,b);f=void 0;a?f=new F(a.type,a.sdp):(m.logger.log(this.user_friendly_id()+".setRemoteDescription() empty param1, setting sdp type to rollback"),a=void 0,a="have-remote-offer"==this.signalingState_?"answer":"have-local-pranswer"==this.signalingState_||"have-remote-pranswer"==this.signalingState_?"pranswer":"offer",f=new F(a,""));return this.setRemoteDescription_v2(f)};b.prototype.setRemoteDescription_v2=function(a){var f=this;m.logger.log(this.user_friendly_id()+".setRemoteDescription_v2() called.");
return new Promise(function(b,d){f.waitUntilConnected(f.user_friendly_id()+".setRemoteDescription_v2").then(function(){var c=new l(f,0,k.ProxyMode.Local,{type:l.convertC2H(a.type),sdp:a.sdp}),g=[];g.push(c.syncBarrier());var c=f.registerCallbacks(!0,!1,t.method_id_RTCPeerConnection_t.setRemoteDescription_v2),r={type:l.convertC2H(a.type),sdp:a.sdp};f.remoteInvoke(!1,t.method_id_RTCPeerConnection_t.setRemoteDescription_v2,r,c.success,c.fail);g.push(c.prom());Promise.all(g).then(function(a){m.logger.log(f.user_friendly_id()+
".setRemoteDescription_v2(): remote success.");f.remoteDescription_=a[0];g=[];f.usingasynconly_||(f.isUnified()?g.push(f.getTransceiversAsync()):g.push(f.getSendersAsync()));Promise.all(g).then(function(a){m.logger.log(f.user_friendly_id()+".setRemoteDescription_v2(): final success.");b()})["catch"](function(a){a=f.logRemoteInvokeError(a,".prop.setRemoteDescription_v2() final failed.");d(a)})})["catch"](function(a){a=f.logRemoteInvokeError(a,".prop.setRemoteDescription_v2() remote failed.");d(a)})})["catch"](function(a){a=
f.logRemoteInvokeError(a,".setRemoteDescription_v2() failed.");d(a)})})};b.prototype.setRemoteDescription_v1=function(a,f,b){var d=this;m.logger.log(this.user_friendly_id()+".setRemoteDescription_v1() called.");this.waitUntilConnected(this.user_friendly_id()+".setRemoteDescription_v1").then(function(){return(new l(d,0,k.ProxyMode.Local,{type:l.convertC2H(a.type),sdp:a.sdp})).syncBarrier()}).then(function(a){var c=d.registerCallbacks(!0,!1,t.method_id_RTCPeerConnection_t.setRemoteDescription);d.remoteInvokeEx(!1,
t.method_id_RTCPeerConnection_t.setRemoteDescription,[a],c.success,c.fail);c.prom().then(function(){m.logger.log(d.user_friendly_id()+".setRemoteDescription_v1(): success callback received!!!");d.remoteDescription_=a;m.logger.log(d.user_friendly_id()+".setRemoteDescription_v1(): updated remoteDescription_");var c=[];d.usingasynconly_||(d.isUnified()?c.push(d.getTransceiversAsync()):c.push(d.getSendersAsync()));Promise.all(c).then(function(){m.logger.log(d.user_friendly_id()+".setRemoteDescription_v1(): success.");
f&&f()})["catch"](function(a){a=d.logRemoteInvokeError(a,".prop.setRemoteDescription_v1() failed.");b&&b(a.message)})})})["catch"](function(a){a=d.logRemoteInvokeError(a,".setRemoteDescription_v1() failed.");b&&b(a.message)})};b.prototype.getLocalStreams=function(){m.logger.log("PeerConnection.getLocalStreams() called. [oid="+this.object_id()+"]");for(var a=0,f=this.localStreams;a<f.length;a++)m.logger.log(JSON.stringify(f[a]));return this.localStreams};b.prototype.getRemoteStreams=function(){m.logger.log(this.user_friendly_id()+
".getRemoteStreams() called.");for(var a=0,f=this.remoteStreams;a<f.length;a++)m.logger.log(JSON.stringify(f[a]));return this.remoteStreams};b.prototype.addTrack=function(a,f){return this.addTrackInternal(a,f,!1)};b.prototype.addTrackAsync=function(a,f){return this.addTrackInternal(a,f,!0)};b.prototype.addTrackInternal=function(a,f,b){var d=this;m.logger.log(this.user_friendly_id()+".addTrackInternal() called. track.id = "+a.id+", streams = "+JSON.stringify(f)+", isAsync = "+b);this.incrementPendingTrackCount();
var c=[];if(f)if(f instanceof q.RemoteStream)c.push(f.id),this.localStreams.push(f);else for(var g=0;g<f.length;g++)c.push(f[g].id),this.localStreams.push(f[g]);else m.logger.log(this.user_friendly_id()+".addTrackInternal() empty streams passed in, continue with empty array");var r=new n.RtpSender(this,0,k.ProxyMode.Pseudo,this.isUnified());this.senders_.push(r);f=new Promise(function(f,b){d.waitUntilConnected(d.user_friendly_id()+".addTrackInternal").then(function(){return d.remoteInvokeEx(!1,t.method_id_RTCPeerConnection_t.addTrack,
[a],c)}).then(function(a){m.logger.log(d.user_friendly_id()+".addTrackInternal() success with oid: "+d.param0(a).oid);r.bind(d,d.param0(a).oid);r.syncBarrier().then(function(){m.logger.log(d.user_friendly_id()+"sender.syncBarrier(): success");!d.usingasynconly_&&d.isUnified()?d.getTransceiversAsync().then(function(){d.decrementPendingTrackCount();f(r)})["catch"](function(a){d.logRemoteInvokeError(a,".addTrackInternal() getTransceiversAsync() failed!");d.decrementPendingTrackCount();b()}):(d.decrementPendingTrackCount(),
f(r))})["catch"](function(a){d.logRemoteInvokeError(a,"sender.syncBarrier() failed!");d.decrementPendingTrackCount();b()})})["catch"](function(a){d.logRemoteInvokeError(a,"addTrack() failed!");d.decrementPendingTrackCount();b()})});if(b)return f;m.logger.log(this.user_friendly_id()+".addTrack() returning: "+r);return r};b.prototype.removeTrack=function(a){m.logger.log(this.user_friendly_id()+".removeTrack() called.");this.removeTrackAsync(a)};b.prototype.removeTrackAsync=function(a){var f=this;m.logger.log(this.user_friendly_id()+
".removeTrackAsync() called.");this.incrementPendingTrackCount();for(var b=0;b<this.senders_.length;b++)this.senders_[b]==a&&this.senders_.splice(b,1);return new Promise(function(b,d){f.waitUntilConnected(f.user_friendly_id()+".removeTrackAsync").then(function(){return f.remoteInvokeEx(!1,t.method_id_RTCPeerConnection_t.removeTrack,[a])}).then(function(){m.logger.log(f.user_friendly_id()+".removeTrackAsync() success.");!f.usingasynconly_&&f.isUnified()?f.getTransceiversAsync().then(function(){f.decrementPendingTrackCount();
b()})["catch"](function(a){f.logRemoteInvokeError(a,"removeTrackAsync() getTransceiversAsync() failed!");f.decrementPendingTrackCount();d(a)}):(f.decrementPendingTrackCount(),b())})["catch"](function(a){f.logRemoteInvokeError(a,"removeTrackAsync() failed!");f.decrementPendingTrackCount();d(a)})})};b.prototype.addStream=function(a){var b=this;m.logger.log(this.user_friendly_id()+".addStream() called: "+JSON.stringify(a));this.localStreams.push(a);this.waitUntilConnected(this.user_friendly_id()+".addStream").then(function(){return b.remoteInvokeEx(!1,
t.method_id_RTCPeerConnection_t.addStream,[a],{})}).then(function(){m.logger.log(b.user_friendly_id()+".addStream() success.")})["catch"](function(a){b.logRemoteInvokeError(a,"addStream() failed.")})};b.prototype.removeStream=function(a){var b=this;m.logger.log(this.user_friendly_id()+".removeStream() called: "+JSON.stringify(a));for(var d=0;d<this.localStreams.length;d++)this.localStreams[d]==a&&this.localStreams.splice(d,1);this.waitUntilConnected(this.user_friendly_id()+".removeStream").then(function(){return b.remoteInvokeEx(!1,
t.method_id_RTCPeerConnection_t.removeStream,[a])}).then(function(){m.logger.log(b.user_friendly_id()+".removeStream() success.")})["catch"](function(a){b.logRemoteInvokeError(a,"removeStream() failed.")})};Object.defineProperty(b.prototype,"onaddstream",{get:function(){return this.onaddstream_},set:function(a){var b=this;m.logger.log(this.user_friendly_id()+".set_onaddstream() called.");this.onaddstream_=a;this.waitUntilConnected(this.user_friendly_id()+".onaddstream").then(function(){var d=b.registerCallbacks(!1,
b.isNullCallback(a),t.method_id_RTCPeerConnection_t.onaddstream);d.then(function(a){(new q.RemoteStreamEvent(b,b.param0(a).oid)).syncBarrier().then(function(a){m.logger.log(b.user_friendly_id()+".onaddstream callback received!");void 0===b.remoteStreams.find(function(b){return void 0!=a.stream&&b.object_id()===a.stream.object_id()})&&b.remoteStreams.push(a.stream);b.onaddstream_&&(m.logger.log(b.user_friendly_id()+".onaddstream notified!!! "+a.stream.id),b.onaddstream_(a))})});return b.remoteInvoke(!0,
t.method_id_RTCPeerConnection_t.onaddstream,d.success)})["catch"](function(a){b.logRemoteInvokeError(a,"set_onaddstream() failed!")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onremovestream",{get:function(){return this.onremovestream_},set:function(a){var b=this;m.logger.log(this.user_friendly_id()+".set_onremovestream() called.");this.onremovestream_=a;this.waitUntilConnected(this.user_friendly_id()+".onremovestream").then(function(){var d=b.registerCallbacks(!1,b.isNullCallback(a),
t.method_id_RTCPeerConnection_t.onremovestream);d.then(function(a){(new q.RemoteStreamEvent(b,b.param0(a).oid)).syncBarrier().then(function(a){m.logger.log(b.user_friendly_id()+".onremovestream callback received! "+a.stream.id);var d=b.remoteStreams.findIndex(function(b){return b.id==a.stream.id});0<=d&&b.remoteStreams.splice(d,1);if(b.onremovestream_)b.onremovestream_(a)})});return b.remoteInvoke(!0,t.method_id_RTCPeerConnection_t.onremovestream,d.success)})["catch"](function(a){b.logRemoteInvokeError(a,
"set_onremovestream() failed!")})},enumerable:!1,configurable:!0});b.prototype.getStats=function(a){var b=this;return new Promise(function(d,c){b.isRedirected()?b.waitUntilConnected(b.user_friendly_id()+".getStats").then(function(){var c=b.registerCallbacks(!0,!1,t.method_id_RTCPeerConnection_t.getStats);c.then(function(b){void 0===b.params||0===b.params.length||0===b.params[0].length?d():a?(a(D.StatsReport.fromJSON(JSON.parse(b.params[0]))),d()):d(D.StatsReport.toRTCStatsReport(JSON.parse(b.params[0])))});
return a?b.remoteInvoke(!1,t.method_id_RTCPeerConnection_t.getStats,c.success):b.remoteInvoke(!1,t.method_id_RTCPeerConnection_t.getStats_v2,c.success)})["catch"](function(a){b&&(a=b.logRemoteInvokeError(a,".getStats() failed!"),c(a))}):(a({}),d())})};b.prototype.SendTelemetryData=function(a,b,d){w.getRedirector().telemetry.SendTelemetryData(y.tel_cmd.Data,a,b,d)};b.prototype.MillisecondstoDisplayformat_=function(a){var b,d;d=Math.floor(a/1E3);b=Math.floor(d/60);a=Math.floor(b/60);m.logger.log(Math.floor(a/
24)+":"+a%24+":"+b%60+":"+d%60)};b.prototype.CalculateCallDurationandType_=function(){if(1==this.timeerstarted_){this.timeerstarted_=!1;this.callendTime_=(new Date).getTime();var a=this.callendTime_-this.callstartTime_;this.MillisecondstoDisplayformat_(a);a=Math.round(a/1E3);m.logger.log("Call Duration "+a);1==this.conferencecall_?this.SendTelemetryData(y.tel_key_ConferenceCallDuration,a,1):(1==this.audiocall_.active&&this.SendTelemetryData(y.tel_key_AudioCallDuration,a,1),1==this.videocall_.active&&
this.SendTelemetryData(y.tel_key_VideoCallDuration,a,1),1==this.screensharingcall_.active&&this.SendTelemetryData(y.tel_key_ScreensharingCallDuration,a,1));var b;1==this.firsttimelocaloffer_&&(b=this.callstartTime_-this.outgoingcallstart_);1==this.firsttimeremoteoffer_&&(b=this.callstartTime_-this.incomingcallstart_);this.MillisecondstoDisplayformat_(b);b=Math.round(b/1E3);m.logger.log("Call Establish Time "+b);1==this.incomingcall_?this.SendTelemetryData(y.tel_key_CallEstIncoming,b,1):1==this.outgoingcall_&&
this.SendTelemetryData(y.tel_key_CallEstOutgoing,b,1);this.SendTelemetryData(y.tel_key_PerfCallState,y.tel_CallState.idle,1)}};b.prototype.close=function(){var a=this;m.logger.log(this.user_friendly_id()+".close() called.");this.CalculateCallDurationandType_();this.unregisterStateChangeNotification(this.onStateChange);this.onnegotiationneeded=this.onsignalingstatechange=this.onicegatheringstatechange=this.oniceconnectionstatechange=this.onicecandidate=this.onaddstream=null;this.waitUntilConnected(this.user_friendly_id()+
".close").then(function(){return a.remoteInvoke(!1,t.method_id_RTCPeerConnection_t.close)}).then(function(){a.iceQ_=null;a.release();m.logger.log(a.user_friendly_id()+".close() success.")})["catch"](function(b){a.logRemoteInvokeError(b,".close() failed.");a.iceQ_=null;a.release()})};b.prototype.createDTMFSender=function(a){m.logger.log(this.user_friendly_id()+".createDTMFSender() called.");var b,d=this.senders_;if(void 0===d||0===d.length)d=this.getSenders();void 0!=d&&(d=d.find(function(b){return b.track.id===
a.id}),void 0!=d&&(m.logger.log(this.user_friendly_id()+" returning RtpSender with oid:"+d.object_id()),b=d.dtmf));return b};Object.defineProperty(b.prototype,"usingAsyncOnly",{get:function(){return this.usingasynconly_},set:function(a){m.logger.log(this.user_friendly_id()+".usingAsyncOnly() called with async:"+a);void 0!=a&&null!=a&&(this.usingasynconly_=a)},enumerable:!1,configurable:!0});b.prototype.getSendersAsync=function(){m.logger.log(this.user_friendly_id()+".getSendersAsync() called.");return this.getSendersAsyncInternal()};
b.prototype.getSenders=function(){m.logger.log(this.user_friendly_id()+".getSenders() called. ");if(this.usingasynconly_)throw m.logger.log(this.user_friendly_id()+".getSenders(): throwing exception: not allowed when usingAsyncOnly is true!!!"),new DOMException(".getSenders() not allowed when usingAsyncOnly is true!!!");this.getSendersAsyncInternal();m.logger.log(this.user_friendly_id()+".getSenders() returning:"+this.senders_.length+" items");return this.senders_};b.prototype.getSendersAsyncInternal=
function(){var a=this;m.logger.log(this.user_friendly_id()+".getSendersAsyncInternal() called. "+this.senders_);return new Promise(function(b,d){a.waitUntilConnected(a.user_friendly_id()+".getSendersAsyncInternal").then(function(){m.logger.log(a.user_friendly_id()+".getSendersAsyncInternal invoking remote");return a.remoteInvoke(!1,t.method_id_RTCPeerConnection_t.getSenders)}).then(function(d){m.logger.log(a.user_friendly_id()+".getSendersAsyncInternal remote success");var c=[],g=[];d.params[0].forEach(function(b){var f=
a.senders_.find(function(a){return a.object_id()===b.oid});void 0===f&&(m.logger.log(a.user_friendly_id()+" adding a RtpSender with oid:"+b.oid),f=new n.RtpSender(a,b.oid,k.ProxyMode.Remote,a.isUnified()));g.push(f.syncBarrier());c.push(f)});Promise.all(g).then(function(){a.senders_=c;m.logger.log(a.user_friendly_id()+".getSendersAsyncInternal: returning senders with ids ["+a.senders_.map(function(a){return a.object_id()})+"]");b(a.senders_)})["catch"](function(d){a.logRemoteInvokeError(d,".prop.getSendersAsyncInternal() failed.");
a.senders_=[];b(a.senders_)})})["catch"](function(d){a.logRemoteInvokeError(d,".getSendersAsyncInternal() failed.");a.senders_=[];b(a.senders_)})})};b.prototype.getReceiversAsync=function(){m.logger.log(this.user_friendly_id()+".getReceiversAsync() called.");return this.getReceiversAsyncInternal()};b.prototype.getReceivers=function(){m.logger.log(this.user_friendly_id()+".getReceivers() called. ");if(this.usingasynconly_)throw m.logger.log(this.user_friendly_id()+".getReceivers(): throwing exception: not allowed when usingAsyncOnly is true!!!"),
new DOMException(".getReceivers() not allowed when usingAsyncOnly is true!!!");this.getReceiversAsyncInternal();m.logger.log(this.user_friendly_id()+".getReceivers() returning:"+this.receivers_.length+" items");return this.receivers_};b.prototype.getReceiversAsyncInternal=function(){var a=this;m.logger.log(this.user_friendly_id()+".getReceiversAsyncInternal() called. "+this.receivers_);return new Promise(function(b,d){a.waitUntilConnected(a.user_friendly_id()+".getReceiversAsyncInternal").then(function(){return a.remoteInvoke(!1,
t.method_id_RTCPeerConnection_t.getReceivers)}).then(function(d){m.logger.log(a.user_friendly_id()+".getReceiversAsyncInternal: remote success.");var c=[],g=[];d.params[0].forEach(function(b){var f=a.receivers_.find(function(a){return a.object_id()===b.oid});void 0===f&&(m.logger.log(a.user_friendly_id()+" adding a RtpReceiver with oid:"+b.oid),f=new n.RtpReceiver(a,b.oid,k.ProxyMode.Remote,a.isUnified()));g.push(f.syncBarrier());c.push(f)});Promise.all(g).then(function(){a.receivers_=c;m.logger.log(a.user_friendly_id()+
".getReceiversAsyncInternal: returning receiver with ids ["+a.receivers_.map(function(a){return a.object_id()})+"]");b(a.receivers_)})["catch"](function(d){a.logRemoteInvokeError(d,".prop.getReceiversAsyncInternal() failed!");a.receivers_=[];b(a.receivers_)})})["catch"](function(d){a.logRemoteInvokeError(d,".getReceiversAsyncInternal() failed!");a.receivers_=[];b(a.receivers_)})})};b.prototype.addTransceiver=function(a,b){m.logger.log(this.user_friendly_id()+".addTransceiver() called: "+JSON.stringify(a)+
" init="+JSON.stringify(b));return this.addTransceiverInternal(a,b,!1)};b.prototype.addTransceiverAsync=function(a,b){m.logger.log(this.user_friendly_id()+".addTransceiverAsync() called: "+JSON.stringify(a)+" init="+JSON.stringify(b));return this.addTransceiverInternal(a,b,!0)};b.prototype.addTransceiverInternal=function(a,b,d){var c=this;m.logger.log(this.user_friendly_id()+".addTransceiverInternal() called: "+JSON.stringify(a)+" init="+JSON.stringify(b));this.incrementPendingTransceiverCount();
var r=z.RtcRtpTransceiverDirection.sendrecv,e=void 0;b&&(e=z.RtcRtpTransceiverInit.toRtcRtpTransceiverInit(b),e.direction&&(r=e.direction));var C=b;g.RemoteSession.isFeatureCallConstraintsSupported()&&(C=e);var x=new z.RtpTransceiver(this,0,k.ProxyMode.Pseudo,this.isUnified(),r);this.transceivers_.push(x);b=new Promise(function(b,f){c.waitUntilConnected(c.user_friendly_id()+".addTransceiverInternal").then(function(){return"string"===typeof a?c.remoteInvoke(!1,t.method_id_RTCPeerConnection_t.addTransceiverWithKind,
a,C):c.remoteInvokeEx(!1,t.method_id_RTCPeerConnection_t.addTransceiverWithTrack,[a],C)}).then(function(a){m.logger.log(c.user_friendly_id()+".addTransceiverInternal() success with oid: "+c.param0(a).oid);x.bind(c,c.param0(a).oid);x.syncBarrier().then(function(){m.logger.log(c.user_friendly_id()+".addTransceiverInternal(): success");c.decrementPendingTransceiverCount();b(x)})["catch"](function(a){c.logRemoteInvokeError(a,".prop.addTransceiverInternal() failed!");c.decrementPendingTransceiverCount();
f()})})["catch"](function(a){c.logRemoteInvokeError(a,"addTransceiverInternal() failed!");c.decrementPendingTransceiverCount();f()})});m.logger.log(this.user_friendly_id()+".addTransceiverInternal() returning:");return d?b:x};b.prototype.incrementPendingTransceiverCount=function(){++this.pendingtransceiver_};b.prototype.decrementPendingTransceiverCount=function(){0<this.pendingtransceiver_&&--this.pendingtransceiver_};b.prototype.incrementPendingTrackCount=function(){++this.pendingtrack_};b.prototype.decrementPendingTrackCount=
function(){0<this.pendingtrack_&&--this.pendingtrack_};b.prototype.waitTransceiverAndTrackReady=function(a){var b=this;return new Promise(function(d,c){m.logger.trace(b.user_friendly_id()+".waitTransceiverAndTrackReady(): pendingtransceiver_="+b.pendingtransceiver_+", pendingtrack_="+b.pendingtrack_);if(0==b.pendingtransceiver_&&0==b.pendingtrack_){for(;b.deferredOfferAnswers&&0<b.deferredOfferAnswers.length;)b.deferredOfferAnswers.shift().post(!0);d()}else b.deferredOfferAnswers.push(new k.deferred_action(d,
c,a)),b.checkTransceiverAndTrack(600,25)})};b.prototype.checkTransceiverAndTrack=function(a,b){var d=this;if(0>=a)for(m.logger.log(".checkTransceiverAndTrack() timeout waiting for transceiver ready!");this.deferredOfferAnswers&&0<this.deferredOfferAnswers.length;)this.deferredOfferAnswers.shift().post(!1);else setTimeout(function(a){if(0==d.pendingtransceiver_&&0==d.pendingtrack_)for(;d.deferredOfferAnswers&&0<d.deferredOfferAnswers.length;)d.deferredOfferAnswers.shift().post(!0);else m.logger.log('.checkTransceiverAndTrack(): count= "'+
a),d.checkTransceiverAndTrack(--a,b)},b,a)};b.prototype.getTransceivers=function(){m.logger.log(this.user_friendly_id()+".getTransceivers() called. ");if(this.usingasynconly_)throw m.logger.log(this.user_friendly_id()+".getTransceivers(): throwing exception: not allowed when usingAsyncOnly is true!!!"),new DOMException(".getTransceivers() not allowed when usingAsyncOnly is true!!!");this.getTransceiversAsync();m.logger.log(this.user_friendly_id()+".getTransceivers() returning:"+this.transceivers_.length+
" items");return this.transceivers_};b.prototype.getTransceiversAsync=function(){var a=this;m.logger.log(this.user_friendly_id()+".getTransceiversAsync() called. ");return new Promise(function(b,d){if(!a.isUnified())return m.logger.log(a.user_friendly_id()+".getTransceiversAsync() called in non-Unified. "),Promise.resolve(a.transceivers_);a.waitUntilConnected(a.user_friendly_id()+".getTransceiversAsync").then(function(){return a.remoteInvoke(!1,t.method_id_RTCPeerConnection_t.getTransceivers)}).then(function(d){m.logger.log(a.user_friendly_id()+
".getTransceiversAsync() remote success.");var c=[],g=[];d.params[0].forEach(function(b){var f=a.transceivers_.find(function(a){return a.object_id()===b.oid});void 0===f&&(m.logger.log(a.user_friendly_id()+" adding a RtpTransceiver with oid:"+b.oid),f=new z.RtpTransceiver(a,b.oid,k.ProxyMode.Remote,a.isUnified()));g.push(f.syncBarrier());c.push(f)});Promise.all(g).then(function(){a.transceivers_=c;m.logger.log(a.user_friendly_id()+".prop.getTransceiversAsync: returning transceiver with ids ["+a.transceivers_.map(function(a){return a.object_id()})+
"]");b(a.transceivers_)})["catch"](function(d){a.logRemoteInvokeError(d,".prop.getTransceiversAsync() failed!");a.transceivers_=[];b(a.transceivers_)})})["catch"](function(d){a.logRemoteInvokeError(d,".getTransceiversAsync() failed!");a.transceivers_=[];b(a.transceivers_)})})};Object.defineProperty(b.prototype,"sctp",{get:function(){return this.sctp_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"ondatachannel",{get:function(){return this.ondatachannel_},set:function(a){var b=
this;m.logger.log(this.user_friendly_id()+".set_ondatachannel() called.");this.ondatachannel_=a;this.waitUntilConnected(this.user_friendly_id()+".ondatachannel").then(function(){var d=b.registerCallbacks(!1,b.isNullCallback(a),t.method_id_RTCPeerConnection_t.ondatachannel);d.then(function(a){m.logger.log(b.user_friendly_id()+".ondatachannel callback received!!!");if(null===b.remotedatachannel_||b.remotedatachannel_.object_id()!=b.param0(a).oid)b.remotedatachannel_=new B.RtcDataChannel(b,b.param0(a).oid,
k.ProxyMode.Remote),b.remotedatachannel_.syncBarrier().then(function(){m.logger.log(b.user_friendly_id()+"remotedatachannel_.syncBarrier(): success");var a=new Event("ondatachannel");a.channel=b.remotedatachannel_;if(b.localdatachannel_&&!b.localdatachannel_.isdestroyed())b.localdatachannel_.syncBarrier().then(function(){m.logger.log(b.user_friendly_id()+"ondatachannel(): notifying...");if(b.ondatachannel_)b.ondatachannel_(a)})["catch"](function(){m.logger.log(b.user_friendly_id()+"localdatachannel_.syncBarrier(): failed!")});
else if(m.logger.log(b.user_friendly_id()+"ondatachannel(): notifying..."),b.ondatachannel_)b.ondatachannel_(a)})["catch"](function(){m.logger.log(b.user_friendly_id()+"remotedatachannel_.syncBarrier(): failed!")})});return b.remoteInvoke(!0,t.method_id_RTCPeerConnection_t.ondatachannel,d.success)})["catch"](function(){m.logger.log(b.user_friendly_id()+".ondatachannel() failed.")})},enumerable:!1,configurable:!0});b.prototype.fixDataChannelConfig=function(a){m.logger.log(this.user_friendly_id()+".fixDataChannelConfig() called: "+
a);void 0==a&&(a={});void 0==a.negotiated&&void 0==a.id&&(a.negotiated=!1,a.id=-1);return a};b.prototype.createDataChannel=function(a,b){var d=this;m.logger.log(this.user_friendly_id()+".createDataChannel() called. label:"+a);this.localdatachannel_=new B.RtcDataChannel(this,0,k.ProxyMode.Pseudo);this.waitUntilConnected(this.user_friendly_id()+".createDataChannel").then(function(){return d.remoteInvoke(!1,t.method_id_RTCPeerConnection_t.createDataChannel,a,d.fixDataChannelConfig(b))}).then(function(a){m.logger.log(d.user_friendly_id()+
".createDataChannel() success with oid: "+d.param0(a).oid);d.localdatachannel_.bind(d,d.param0(a).oid);d.localdatachannel_.syncBarrier().then(function(){m.logger.log(d.user_friendly_id()+"channel.syncBarrier(): success")})["catch"](function(){m.logger.log(d.user_friendly_id()+"channel.syncBarrier(): failed!")})})["catch"](function(a){a=d.param0(a);m.logger.log(d.user_friendly_id()+".createDataChannel() failed with error: "+a)});m.logger.log(this.user_friendly_id()+".createDataChannel() returning: "+
this.localdatachannel_);return this.localdatachannel_};return b}(k.ProxyObject);a.PeerConnection=b},658:function(b,a,c){var e=this&&this.__spreadArrays||function(){for(var a=0,b=0,d=arguments.length;b<d;b++)a+=arguments[b].length;for(var a=Array(a),c=0,b=0;b<d;b++)for(var g=arguments[b],r=0,e=g.length;r<e;r++,c++)a[c]=g[r];return a};Object.defineProperty(a,"__esModule",{value:!0});a.ProxyObject=a.ProxyMode=a.ProxyReadyState=a.number_allocator=a.callback=a.rpc_callback=a.deferred_action=void 0;var u=
c(946),h=c(851),d=c(545),w=c(247),q=c(550),n=function(){function a(b,d,c){this.resolve=b;this.reject=d;this.name_=c}Object.defineProperty(a.prototype,"name",{get:function(){return this.name_},enumerable:!1,configurable:!0});a.prototype.post=function(a){1==a?(h.logger.log('deferred_action.post(): resolving "'+this.name_+'"'),this.resolve()):(h.logger.log('deferred_action.post(): rejecting "'+this.name_+'"'),this.reject())};a.prototype.postWithResult=function(a,b){1==a?(h.logger.log('deferred_action.post(): resolving "'+
this.name_+'"'),this.resolve(b)):(h.logger.log('deferred_action.post(): rejecting "'+this.name_+'"'),this.reject())};a.prototype.postResolve=function(a){this.resolve(a)};a.prototype.postReject=function(a){void 0==a?this.reject():this.reject(a)};return a}();a.deferred_action=n;var k=function(){return function(a,b){this.id=a;this.is_null=b}}();a.rpc_callback=k;var v=function(){function a(b,d,c){this.success=new k(b<<16,d);this.fail=new k(b<<16|1,d);this.id=b;this.oneShot=c}a.prototype.resolve=function(a){h.logger.trace("callback.resolve() called. [id="+
this.id+"]");null!=this.handler&&this.handler(a)};a.prototype.reject=function(a){null!=this.err_handler&&this.err_handler(a)};a.prototype.then=function(a){this.handler=a};a.prototype.prom=function(){var a=this;return new Promise(function(b,d){a.handler=b;a.err_handler=d})};return a}();a.callback=v;var z=function(){function a(b,d,c){this.min_=b<a.BOUND_LOW||b>a.BOUND_HIGH?a.DEF_MIN:b;this.max_=d<a.BOUND_LOW||d>a.BOUND_HIGH?a.DEF_MAX:d;this.interval_=c<a.BOUND_LOW||c>a.BOUND_HIGH?a.DEF_INTERVAL:c;this.numbers_=
new Map;this.numbers_.set(this.min_,this.max_)}Object.defineProperty(a.prototype,"max",{get:function(){return this.max_},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"min",{get:function(){return this.min_},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"interval",{get:function(){return this.interval_},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"numbers",{get:function(){return this.numbers_},enumerable:!1,configurable:!0});a.prototype.allocate=
function(){var a=-1;if(0<this.numbers_.size){var b=Array.from(this.numbers_.keys()).sort(function(a,b){return a-b})[0],d=this.numbers_.get(b),a=this.min_+(b-this.min_)*this.interval_;this.numbers_["delete"](b);b+=1;b<d&&this.numbers_.set(b,d)}return a};a.prototype.deallocate=function(a){var b=Array.from(this.numbers_.keys()).sort(function(a,b){return a-b});a=(a-this.min_)/this.interval_;for(var d=!1,c=0;c<b.length&&(b[c]==a+1?(this.numbers_.set(a,this.numbers_.get(b[c])),this.numbers_["delete"](b[c]),
d=!0):this.numbers_.get(b[c])==a&&(this.numbers_.set(b[c],a+1),c+1<b.length&&b[c+1]==a+1&&(this.numbers_.set(b[c],this.numbers_.get(b[c+1])),this.numbers_["delete"](b[c+1])),d=!0),!d);c++);d||this.numbers_.set(a,a+1)};a.BOUND_LOW=0;a.BOUND_HIGH=4294967295;a.DEF_MIN=0;a.DEF_MAX=1024;a.DEF_INTERVAL=1;return a}();a.number_allocator=z;var g;(function(a){a[a.NotConfigured=0]="NotConfigured";a[a.Configured=1]="Configured";a[a.Error=2]="Error";a[a.Destroyed=3]="Destroyed"})(g=a.ProxyReadyState||(a.ProxyReadyState=
{}));var B;(function(a){a[a.Local=0]="Local";a[a.Remote=1]="Remote";a[a.Pseudo=2]="Pseudo"})(B=a.ProxyMode||(a.ProxyMode={}));b=function(){function a(b,c,k,x,r,A){var z=this;void 0===r&&(r=null);void 0===A&&(A=[]);for(var v=[],n=6;n<arguments.length;n++)v[n-6]=arguments[n];this.hdxms=u.getRedirector();this.iid=c;this.oid=k;this.mode=x;this.proxystate=g.NotConfigured;this.deferredActions=[];this.pendingSyncBarriers=[];this.cbs=new Map;if(x===B.Local){n=!1;this.iid===q.class_id_t.EngineControl&&(n=
!0);var l=this;this.hdxms.startRedirection(n,this.user_friendly_id()).then(function(){z.oid=a.nextId++;h.logger.log(z.user_friendly_id()+" assigned local oid:"+z.oid);return new Promise(function(a,b){l.waitUntilConnectedEx(l.user_friendly_id()+".ctor()",A).then(function(){h.logger.log(l.user_friendly_id()+".ctor() all parameter rpc objects are ready.");var a=l.oidsFromProxyOjbects(A).concat(v),b=q.WebrpcClassLibInfoUtil.getMethodFeatureByid(c,0);return l.hdxms.WSSendObjectWrapper(b,c,0,d.WsJsonUtil.createMessageByid.apply(d.WsJsonUtil,
e([!1,!1,d.ws_msg_type_t.req,c,0,l.oid],a)))}).then(function(b){h.logger.log(l.user_friendly_id()+".ctor() success.");a(b)})["catch"](function(){h.logger.log(l.user_friendly_id()+".ctor() failed.");b()})})}).then(function(a){h.logger.trace("ProxyObject: setting state to configured. (iid: "+z.iid+" oid: "+z.oid+")");var d=z.oid;l.proxystate=g.Configured;l.oid=z.param0(a);h.logger.log(z.user_friendly_id()+" assigned remote oid for local oid:"+d);l.onConnected();r&&r();w.getGC().trackObject(z,b)})["catch"](function(){l.proxystate=
g.Error;l.onConnected()})}else x===B.Remote&&(this.proxystate=g.Configured,w.getGC().trackObject(this,b))}a.prototype.syncBarrierDeep=function(a,b){var d=!0;0<this.pendingSyncBarriers.length&&(d=!1);this.pendingSyncBarriers.push(new n(a,b,this.user_friendly_id()+".syncBarrier"));h.logger.log(this.user_friendly_id()+".syncBarrierDeep() queing request for:"+this.oid+", rv:"+d+", items:"+this.pendingSyncBarriers.length);return d};a.prototype.syncBarrierResolve=function(a){for(h.logger.log(this.user_friendly_id()+
".syncBarrierResolve() items:"+this.pendingSyncBarriers.length);this.pendingSyncBarriers&&0<this.pendingSyncBarriers.length;)h.logger.log(this.user_friendly_id()+".syncBarrierResolve() items:"+this.pendingSyncBarriers.length+" resolving request for:"+this.oid),this.pendingSyncBarriers.shift().postResolve(a)};a.prototype.syncBarrierReject=function(a){for(h.logger.log(this.user_friendly_id()+".syncBarrierReject() items:"+this.pendingSyncBarriers.length);this.pendingSyncBarriers&&0<this.pendingSyncBarriers.length;)h.logger.log(this.user_friendly_id()+
".syncBarrierReject() rejecting request for:"+this.oid),this.pendingSyncBarriers.shift().postReject(a)};Object.defineProperty(a.prototype,"proxyreadystate",{get:function(){return this.proxystate},set:function(a){this.proxystate=a},enumerable:!1,configurable:!0});a.prototype.bind=function(a,b){h.logger.trace("ProxyObject: binding object. (iid: "+this.iid+" oid: "+b+" mode: "+this.mode+")");if(this.mode===B.Pseudo){this.proxystate=g.Configured;var d=this.oid;this.oid=b;h.logger.log(this.user_friendly_id()+
" assigned remote oid for local oid:"+d);this.onConnected();w.getGC().trackObject(this,a);this.mode=B.Remote}else this.mode===B.Remote?h.logger.log("ProxyObject: binding already complete."):h.logger.log("ProxyObject: binding failure. incorrect mode!")};a.prototype.reconstructor=function(a,b,c){for(var x=this,r=[],A=3;A<arguments.length;A++)r[A-3]=arguments[A];this.proxystate=g.NotConfigured;this.deferredActions=[];A=q.WebrpcClassLibInfoUtil.getMethodFeatureByid(b,0);this.hdxms.WSSendObjectWrapper(A,
b,0,d.WsJsonUtil.createMessageByid.apply(d.WsJsonUtil,e([!1,!1,d.ws_msg_type_t.req,b,0,this.oid],r))).then(function(b){h.logger.trace("ProxyObject: setting state to configured. (iid: "+x.iid+" oid: "+x.oid+")");var d=x.oid;x.proxystate=g.Configured;x.oid=x.param0(b);h.logger.log(x.user_friendly_id()+" assigned remote oid for local oid:"+d);x.onConnected();w.getGC().trackObject(x,a)})["catch"](function(){x.proxystate=g.Error;x.onConnected()})};a.prototype.setParent=function(a){w.getGC().setParent(this,
a)};a.prototype.release=function(){h.logger.log(this.user_friendly_id()+".release() called.");w.getGC().releaseObject(this)};a.prototype.destroy=function(){h.logger.log(this.user_friendly_id()+".destroy() called.");this.proxystate=g.Destroyed;var a=q.WebrpcClassLibInfoUtil.getMethodFeatureByid(this.iid,0);this.hdxms.WSSendObjectWrapper(a,this.iid,0,d.WsJsonUtil.createMessageByid(!1,!0,d.ws_msg_type_t.req,this.iid,0,this.oid));this.clearCallbacks()};a.prototype.isdestroyed=function(){return this.proxystate==
g.Destroyed};a.prototype.onConnected=function(){for(;this.deferredActions&&0<this.deferredActions.length;)this.deferredActions.shift().post(this.proxystate==g.Configured)};a.prototype.isPseudo=function(){return this.mode==B.Pseudo};a.prototype.checkState=function(a,b,d){var c=this;0>=a?(h.logger.log("ProxyObject.checkState() timeout waiting for connection response! failed. (iid: "+c.iid+" oid: "+c.oid+"name: "+d+")"),c.onConnected()):setTimeout(function(a,d){if(c.proxystate==g.Configured)c.onConnected();
else if(c.proxystate==g.Error)c.onConnected();else if(c.proxystate==g.Destroyed)c.onConnected();else c.checkState(--a,b,d)},b,a,d)};a.prototype.waitUntilConnected=function(a){var b=this;return new Promise(function(d,c){b?(h.logger.trace("ProxyObject.waitUntilConnected(): readyState="+b.proxystate+". (iid: "+b.iid+" oid: "+b.oid+")"),b.proxystate==g.Destroyed?(b.onConnected(),h.logger.trace("rejecting already destroyed Object:"+b.user_friendly_id()),c("Object already destroyed :"+b.user_friendly_id())):
b.proxystate==g.Configured?(b.onConnected(),d()):b.proxystate==g.Error?(h.logger.trace("ProxyObject.waitUntilConnected(): readyState="+b.proxystate+". (iid: "+b.iid+" oid: "+b.oid+")"),b.onConnected(),c()):(h.logger.log('ProxyObject.waitUntilConnected(): deferring action "'+a+'". (iid: '+b.iid+" oid: "+b.oid+")"),b.deferredActions.push(new n(d,c,a)),b.checkState(600,25,a))):c("Invalid Object")})};a.prototype.remoteInvoke=function(a,b){for(var c=[],k=2;k<arguments.length;k++)c[k-2]=arguments[k];if(this.proxystate==
g.Destroyed)return h.logger.trace("rejecting already destroyed Object:"+this.user_friendly_id()),Promise.reject("Cannot invoke destroyed object :"+this.user_friendly_id());if(this.proxystate==g.Error)return h.logger.trace("rejecting already error state Object:"+this.user_friendly_id()),Promise.reject("Cannot invoke object in Error state:"+this.user_friendly_id());k=q.WebrpcClassLibInfoUtil.getMethodFeatureByid(this.iid,b);return this.hdxms.WSSendObjectWrapper(k,this.iid,b,d.WsJsonUtil.createMessageByid.apply(d.WsJsonUtil,
e([a,!1,d.ws_msg_type_t.req,this.iid,b,this.oid],c)))};a.prototype.waitUntilConnectedEx=function(a,b){var d=this;return new Promise(function(c,g){if(d){for(var e=[],k=0;k<b.length;k++){var z=b[k];if(z instanceof Array)for(var v=0;v<z.length;v++){var t=z[v];e.push(t.waitUntilConnected(a+"."+t.user_friendly_id()))}else e.push(z.waitUntilConnected(a+"."+z.user_friendly_id()))}Promise.all(e).then(function(){h.logger.log(d.user_friendly_id()+".waitUntilConnectedEx() success.");c()})["catch"](function(a){d.logRemoteInvokeError(a,
".waitUntilConnectedEx(): failed.");g()})}else g("Invalid Object")})};a.prototype.oidsFromProxyOjbects=function(a){for(var b=[],d=0;d<a.length;d++){var c=a[d];if(c instanceof Array){for(var g=[],e=0;e<c.length;e++)g.push({oid:c[e].object_id()});b.push(g)}else b.push({oid:c.object_id()})}return b};a.prototype.remoteInvokeEx=function(a,b,c){for(var k=[],r=3;r<arguments.length;r++)k[r-3]=arguments[r];if(this.proxystate==g.Destroyed)return h.logger.trace("rejecting already destroyed Object:"+this.user_friendly_id()),
Promise.reject("Cannot invoke destroyed object :"+this.user_friendly_id());if(this.proxystate==g.Error)return h.logger.trace("rejecting already error state Object:"+this.user_friendly_id()),Promise.reject("Cannot invoke object in Error state:"+this.user_friendly_id());var A=this;return new Promise(function(g,r){A.waitUntilConnectedEx(A.user_friendly_id()+".remoteInvokeEx",c).then(function(){h.logger.log(A.user_friendly_id()+".remoteInvokeEx() all parameter rpc objects are ready.");var g=A.oidsFromProxyOjbects(c).concat(k),
r=q.WebrpcClassLibInfoUtil.getMethodFeatureByid(A.iid,b);return A.hdxms.WSSendObjectWrapper(r,A.iid,b,d.WsJsonUtil.createMessageByid.apply(d.WsJsonUtil,e([a,!1,d.ws_msg_type_t.req,A.iid,b,A.oid],g)))}).then(function(a){h.logger.log(A.user_friendly_id()+".remoteInvokeEx() success.");g(a)})["catch"](function(){h.logger.log(A.user_friendly_id()+".remoteInvokeEx() failed.");r()})})};a.prototype.logRemoteInvokeError=function(a,b){var d="",c=a;c?d=b+" with error: "+JSON.stringify(c.message):(d=this.param0(a),
c=0!==Object.keys(d).length?new DOMException(b+" with error: "+JSON.stringify(d),this.user_friendly_id()):new DOMException(b,this.user_friendly_id()),d=c.message);h.logger.logx(this.isdestroyed(),this.user_friendly_id()+d);return c};a.prototype.allocate_cbid=function(){return a.cbid_allocator_.allocate()};a.prototype.deallocate_cbid=function(b){a.cbid_allocator_.deallocate(b)};a.prototype.registerCallbacks=function(a,b,d){var c=this,g=this.allocate_cbid();a=new v(g,b,a);0>g&&h.logger.log(this.user_friendly_id()+
".registerCallbacks(). !!!! ran out of cbid !!!!");b||(this.cbs.set(g,d),a.completion_cb=function(a,b){c.unregisterCallbacks(a)},this.hdxms.registerHandler(this.iid,this.oid,d,a));return a};a.prototype.unregisterCallbacks=function(a){this.cbs.has(a)?(this.hdxms.unregisterHandler(this.iid,this.oid,a),this.deallocate_cbid(a),this.cbs["delete"](a)):h.logger.log(this.user_friendly_id()+".unregisterCallbacks(). mid="+this.cbs.get(a)+" cbid="+a+" Cant find callback handler registration!!!!")};a.prototype.clearCallbacks=
function(){h.logger.log(this.user_friendly_id()+".clearCallbacks().");for(var a=0,b=Array.from(this.cbs.keys());a<b.length;a++){var d=b[a];this.hdxms.unregisterHandler(this.iid,this.oid,d);this.deallocate_cbid(d)}this.cbs.clear()};a.prototype.object_id=function(){return this.oid};a.prototype.param0=function(a){var b={};a&&a.params&&(b=a.params[0]);return b};a.prototype.isNullCallback=function(a){return void 0==a||null==a};a.prototype.user_friendly_id=function(){var a=this.constructor.name;0<=this.iid&&
(a=q.class_id_t[this.iid]);return a+"["+this.oid+"]"};a.prototype.isRedirected=function(){return this.hdxms.isRedirected()};a.prototype.isValid=function(){return!(this.proxystate===g.Error||this.proxystate===g.Destroyed)};a.prototype.registerStateChangeNotification=function(a){this.hdxms.registerStateChangeNotification(a)};a.prototype.unregisterStateChangeNotification=function(a){this.hdxms.unregisterStateChangeNotification(a)};a.nextId=0;a.CBID_MAX=65536;a.cbid_allocator_=new z(0,a.CBID_MAX,1);return a}();
a.ProxyObject=b},144:function(b,a,c){var e=this&&this.__extends||function(){var a=function(b,d){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var f in b)b.hasOwnProperty(f)&&(a[f]=b[f])};return a(b,d)};return function(b,d){function c(){this.constructor=b}a(b,d);b.prototype=null===d?Object.create(d):(c.prototype=d.prototype,new c)}}(),u=this&&this.__awaiter||function(a,b,d,c){function g(a){return a instanceof d?a:new d(function(b){b(a)})}return new (d||
(d=Promise))(function(f,d){function r(a){try{C(c.next(a))}catch(b){d(b)}}function e(a){try{C(c["throw"](a))}catch(b){d(b)}}function C(a){a.done?f(a.value):g(a.value).then(r,e)}C((c=c.apply(a,b||[])).next())})},h=this&&this.__generator||function(a,b){function d(a){return function(b){return c([a,b])}}function c(d){if(f)throw new TypeError("Generator is already executing.");for(;g;)try{if(f=1,r&&(e=d[0]&2?r["return"]:d[0]?r["throw"]||((e=r["return"])&&e.call(r),0):r.next)&&!(e=e.call(r,d[1])).done)return e;
if(r=0,e)d=[d[0]&2,e.value];switch(d[0]){case 0:case 1:e=d;break;case 4:return g.label++,{value:d[1],done:!1};case 5:g.label++;r=d[1];d=[0];continue;case 7:d=g.ops.pop();g.trys.pop();continue;default:if(!(e=g.trys,e=0<e.length&&e[e.length-1])&&(6===d[0]||2===d[0])){g=0;continue}if(3===d[0]&&(!e||d[1]>e[0]&&d[1]<e[3]))g.label=d[1];else if(6===d[0]&&g.label<e[1])g.label=e[1],e=d;else if(e&&g.label<e[2])g.label=e[2],g.ops.push(d);else{e[2]&&g.ops.pop();g.trys.pop();continue}}d=b.call(a,g)}catch(C){d=
[6,C],r=0}finally{f=e=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}var g={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},f,r,e,k;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return k={next:d(0),"throw":d(1),"return":d(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(a,"__esModule",{value:!0});a.NavigatorUserMedia=a.RemoteMediaStreamConstraints=a.RemoteMediaTrackConstraints=a.RemoteMediaTrackConstraintSet=
a.RemoteDevices=a.RemoteDeviceInfo=a.DeviceInfo=a.RemoteStreamEvent=a.RemoteStream=a.RemoteMediaTrack=a.enumeratedDevices=void 0;var d=c(550),w=c(658),q=c(851),n=c(946),k=c(394),v=c(259),z=c(650),g=c(973),l;a.enumeratedDevices=l;var t=function(){return function(a,b){this.type=a;this.target=b}}(),m=function(){function a(){this.is_local_clone=!1;this.clone_id=this.clone_count=0}a.prototype.clone=function(){this.clone_count++;var b=new a;b.is_local_clone=!0;b.clone_id=this.clone_count;return b};a.prototype.synchronize=
function(a){return u(this,void 0,void 0,function(){return h(this,function(b){return this.is_local_clone?[2,a.asyncClone()]:[2,Promise.resolve(a)]})})};return a}(),p=function(a){function b(c,g,r){void 0===r&&(r=w.ProxyMode.Remote);c=a.call(this,c,d.class_id_t.MediaStreamTrack,g,r)||this;c.refCount_=0;c.refCount_++;c.clone_state=new m;return c}e(b,a);b.prototype.dumpInfo=function(){q.logger.log(this.user_friendly_id()+".dumpInfo() [id="+this.id+"] kind="+this.kind+" label="+this.label+" refcount="+
this.refcount+" enabled="+this.enabled+" readyState="+this.readyState)};Object.defineProperty(b.prototype,"refcount",{get:function(){return this.refCount_},enumerable:!1,configurable:!0});b.prototype.addRef=function(){this.refCount_++;q.logger.log(this.user_friendly_id()+".addRef() called. [id="+this.id+"] refcount="+this.refCount_)};Object.defineProperty(b.prototype,"onended",{get:function(){q.logger.log(this.user_friendly_id()+".get_onended() called. [id="+this.id+"]");return this.onended_},set:function(a){var b=
this;q.logger.log(this.user_friendly_id()+".set_onended() called. [id="+this.id+"]");this.onended_=a;this.waitUntilConnected("MediaStreamTrack.onended").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),d.method_id_MediaStreamTrack_t.onended);c.then(function(a){q.logger.log(b.user_friendly_id()+"onended event received!!!");a=new t("ended",b);b.readyState_="ended";b.onended_(a)});return b.remoteInvoke(!0,d.method_id_MediaStreamTrack_t.onended,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,
".onended failed!")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onmute",{get:function(){q.logger.log(this.user_friendly_id()+".get_onmute() called. [id="+this.id+"]");return this.onmute_},set:function(a){var b=this;q.logger.log(this.user_friendly_id()+".set_onmute() called. [id="+this.id+"]");this.onmute_=a;this.waitUntilConnected("MediaStreamTrack.onmute").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),d.method_id_MediaStreamTrack_t.onmute);c.then(function(a){q.logger.log(b.user_friendly_id()+
"onmute event received!!!");a=new t("mute",b);b.muted=!0;b.onmute_(a)});return b.remoteInvoke(!0,d.method_id_MediaStreamTrack_t.onmute,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".onmute failed!")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onunmute",{get:function(){q.logger.log(this.user_friendly_id()+".get_onunmute() called. [id="+this.id+"]");return this.onunmute_},set:function(a){var b=this;q.logger.log(this.user_friendly_id()+".set_onunmute() called. [id="+
this.id+"]");this.onunmute_=a;this.waitUntilConnected("MediaStreamTrack.onunmute").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),d.method_id_MediaStreamTrack_t.onunmute);c.then(function(a){q.logger.log("onunmute event received!!!");a=new t("unmute",b);b.muted=!1;b.onunmute_(a)});return b.remoteInvoke(!0,d.method_id_MediaStreamTrack_t.onunmute,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".onunmute failed!")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,
"onstop",{set:function(a){this.onstop_=a},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"enabled",{get:function(){q.logger.log(this.user_friendly_id()+".get_enabled() called. [id="+this.id+", value="+this.enabled_+"]");return this.enabled_},set:function(a){q.logger.log(this.user_friendly_id()+".set_enabled() called. [id="+this.id+", value="+a+"]");this.enabled_=a;this.remoteInvoke(!0,d.method_id_MediaStreamTrack_t.enabled,a)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,
"readyState",{get:function(){q.logger.log(this.user_friendly_id()+".get_readyState() called. [id="+this.id+"]");return this.readyState_},enumerable:!1,configurable:!0});b.prototype.asyncClone=function(){return u(this,void 0,void 0,function(){var a,c,g;return h(this,function(f){switch(f.label){case 0:return[4,this.waitUntilConnected("RemoteMediaTrack.asyncClone")];case 1:return f.sent(),[4,this.remoteInvoke(!1,d.method_id_MediaStreamTrack_t.clone)];case 2:return a=f.sent(),c=this.param0(a),g=new b(this,
c.oid),[2,g.syncBarrier()]}})})};b.prototype.deepClone=function(a){var c=this;q.logger.log(this.user_friendly_id()+".deepClone() called. [id="+this.id+"]");if(z.RemoteSession.isFeatureTrackCloneWithIdSupported()){var g=new b(null,0,w.ProxyMode.Pseudo),f=new m;g.id=a?a:this.id+"."+f.clone_id.toString();g.label=this.label;g.kind=this.kind;g.enabled_=this.enabled_;g.muted=this.muted;g.readyState_=this.readyState_;g.trackSettings_=this.trackSettings_;g.clone_state=f;g.constraints_=this.constraints_;g.capabilities_=
this.capabilities_;g.onended=this.onended;g.onmute=this.onmute;g.onunmute=this.onunmute;g.onstop=this.onstop;this.waitUntilConnected("RemoteMediaTrack.deepClone").then(function(){return c.remoteInvoke(!1,d.method_id_MediaStreamTrack_t.clone,g.id)}).then(function(a){q.logger.log(c.user_friendly_id()+".deepClone() success with oid: "+c.param0(a).oid);g.bind(null,c.param0(a).oid);g.syncBarrier().then(function(){q.logger.log(c.user_friendly_id()+"track.syncBarrier(): success")})["catch"](function(a){c.logRemoteInvokeError(a,
"track.syncBarrier() failed!")})})["catch"](function(a){c.logRemoteInvokeError(a,".deepClone() failed!")});return g}q.logger.log(this.user_friendly_id()+".deepClone() is not supported!")};b.prototype.localClone=function(){q.logger.log(this.user_friendly_id()+".localClone() called. [id="+this.id+"]");var a=this.clone_state.clone(),d=new b(this,this.object_id());d.id=this.id+"."+a.clone_id.toString();d.label=this.label;d.kind=this.kind;d.enabled_=this.enabled_;d.muted=this.muted;d.readyState_=this.readyState_;
d.trackSettings_=this.trackSettings_;d.clone_state=a;d.constraints_=this.constraints_;d.capabilities_=this.capabilities_;return d};b.prototype.clone=function(){q.logger.log(this.user_friendly_id()+".clone() called. [id="+this.id+"]");return z.RemoteSession.isFeatureTrackCloneWithIdSupported()?this.deepClone():this.localClone()};b.prototype.stop=function(){var a=this;q.logger.log(this.user_friendly_id()+".stop() called. [id="+this.id+"] refcount="+this.refCount_);this.readyState_="ended";if(0<this.refCount_&&
(this.refCount_--,0===this.refCount_&&(q.logger.log(this.user_friendly_id()+".stop() called. [id="+this.id+"] remote invoking..."),this.remoteInvoke(!1,d.method_id_MediaStreamTrack_t.stop)["catch"](function(b){a.logRemoteInvokeError(b,".stop failed!")}),"video"==this.kind&&"remoteapp-track"==this.label&&g.ScreenSharing.screenSharingInstance().stopAppshare(),null!==this.onstop_&&void 0!=this.onstop_)))this.onstop_()};b.prototype.getCapabilities=function(){return this.capabilities_};b.prototype.getConstraints=
function(){return this.constraints_};b.prototype.getSettings=function(){return"audio"==this.kind?function(a){return{deviceId:a.deviceId,echoCancellation:a.echoCancellation}}(this.trackSettings_):function(a){return{aspectRatio:a.aspectRatio,deviceId:a.deviceId,frameRate:a.frameRate,height:a.height,width:a.width}}(this.trackSettings_)};b.prototype.getChannelCount=function(){return 2};b.prototype.applyConstraints=function(a){var b=this;q.logger.log(this.user_friendly_id()+".applyConstraints() called.");
return new Promise(function(c,f){b.waitUntilConnected("MediaStreamTrack.applyConstraints").then(function(){return Promise.all([b.remoteInvoke(!1,d.method_id_MediaStreamTrack_t.applyConstraints,a),b.syncBarrier()])})["catch"](function(a){b.logRemoteInvokeError(a,"applyConstraints failed!");f({name:"OverconstrainedError",message:"Failed to apply constraints."})}).then(function(){b.constraints_=a;return b.remoteInvoke(!1,d.method_id_MediaStreamTrack_t.getConstraints)}).then(function(a){b.constraints_=
b.param0(a)})["catch"](function(a){b.logRemoteInvokeError(a,".syncBarrier() remote client does not support getConstraints method. Ignore it")}).then(function(){return c()})})};b.convertReadyState=function(a){return 0==a?"live":"ended"};b.prototype.syncBarrier=function(){var a=this;q.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(c,g){a.syncBarrierDeep(c,g)&&a.waitUntilConnected("MediaStreamTrack.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,
d.method_id_MediaStreamTrack_t.kind,""),a.remoteInvoke(!1,d.method_id_MediaStreamTrack_t.id,""),a.remoteInvoke(!1,d.method_id_MediaStreamTrack_t.label,""),a.remoteInvoke(!1,d.method_id_MediaStreamTrack_t.enabled,!1),a.remoteInvoke(!1,d.method_id_MediaStreamTrack_t.muted,!1),a.remoteInvoke(!1,d.method_id_MediaStreamTrack_t.readyState,0),a.remoteInvoke(!1,d.method_id_MediaStreamTrack_t.getSettings),a.remoteInvoke(!1,d.method_id_MediaStreamTrack_t.getCapabilities)])}).then(function(f){var d=0;f=f.map(function(b){return a.param0(b)});
a.kind=f[0];a.id=f[1];a.label=f[2];a.enabled_=f[3];a.muted=f[4];d=f[5];a.trackSettings_=f[6];a.capabilities_=f[7];a.readyState_=b.convertReadyState(d);a.syncBarrierResolve(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier() failed!");a.syncBarrierReject(b)})})};b.prototype.dispose=function(){q.logger.log(this.user_friendly_id()+".dispose() called. [id="+this.id+"]");this.stop();0===this.refCount_&&this.release()};return b}(w.ProxyObject);a.RemoteMediaTrack=p;var y=function(){return function(){}}(),
x=function(a){function b(c,g,r,f,e){void 0===r&&(r=w.ProxyMode.Local);void 0===f&&(f=[]);var k=this;q.logger.log("RemoteStream.ctor() streamid="+e+" num tracks="+f.length);r==w.ProxyMode.Remote||e||(e=b.uuidv4());k=e&&z.RemoteSession.isFeatureTrackCloneWithIdSupported()?a.call(this,c,d.class_id_t.MediaStream,g,r,null,[f],e)||this:a.call(this,c,d.class_id_t.MediaStream,g,r,null,[f])||this;k.id=e;k.tracks_=f;k.clone_state=new m;k.active_=!0;k.tracks_.forEach(function(a){a.setParent(k)});return k}e(b,
a);b.uuidv4=function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(a){return(a^crypto.getRandomValues(new Uint8Array(1))[0]&15>>a/4).toString(16)})};b.prototype.dumpInfo=function(){q.logger.log(this.user_friendly_id()+".dumpInfo() [id="+this.id+"] active="+this.active_+" num tracks="+this.tracks_.length);for(var a=0,b=this.tracks_;a<b.length;a++){var d=b[a];d&&d.dumpInfo()}};b.prototype.toggleAudio=function(a){q.logger.log(this.user_friendly_id()+".toggleAudio() called: "+
a);for(var b=0,d=this.getAudioTracks();b<d.length;b++)d[b].enabled=a};b.prototype.toJSON=function(){var a=new y;a.id=this.id;a.active=this.active_;a.oid=this.object_id();return"RemoteStream:"+JSON.stringify(a)};Object.defineProperty(b.prototype,"active",{get:function(){var a=this;q.logger.log(this.user_friendly_id()+".get active() called. [id="+this.id+"] active="+this.active_);n.getRedirector().getFeatureValue(d.FEATURE_ms_teams_stream_active_status)?this.waitUntilConnected("MediaStream.active").then(function(){q.logger.log(a.user_friendly_id()+
".get active() remote invoking");return a.remoteInvoke(!1,d.method_id_MediaStream_t.active,!1)}).then(function(b){a.active_=a.param0(b);q.logger.log(a.user_friendly_id()+".get active() success, active="+a.active_)})["catch"](function(b){a.active_=!0;a.logRemoteInvokeError(b,".get active() failed! active="+a.active_)}):this.active_=!0;return this.active_},enumerable:!1,configurable:!0});b.prototype.getAudioTracks=function(){q.logger.log(this.user_friendly_id()+".getAudioTracks() called. [id="+this.id+
"]");for(var a=[],b=0,d=this.tracks_;b<d.length;b++){var f=d[b];"audio"==f.kind&&a.push(f)}return a};b.prototype.getVideoTracks=function(){q.logger.log(this.user_friendly_id()+".getVideoTracks() called. [id="+this.id+"]");for(var a=[],b=0,d=this.tracks_;b<d.length;b++){var f=d[b];"video"==f.kind&&a.push(f)}return a};b.prototype.getTracks=function(){q.logger.log(this.user_friendly_id()+".getTracks() called. [id="+this.id+"]");return this.tracks_};b.prototype.getTrackById=function(a){q.logger.log(this.user_friendly_id()+
".getTrackById() called. [id="+this.id+"]");for(var b=0,d=this.tracks_;b<d.length;b++){var f=d[b];if(f.id==a)return f}};b.prototype.addTrack=function(a){var b=this;q.logger.log(this.user_friendly_id()+".addTrack() called. [id="+this.id+"]");this.tracks_.push(a);a&&a.dumpInfo();var c=this;this.waitUntilConnected("MediaStream.addTrack").then(function(){q.logger.log(c.user_friendly_id()+".addTrack remote invoking");return c.remoteInvokeEx(!1,d.method_id_MediaStream_t.addTrack,[a])}).then(function(){q.logger.log(c.user_friendly_id()+
".addTrack success")})["catch"](function(a){b.logRemoteInvokeError(a,".addTrack failed!")})};b.prototype.removeTrack=function(a){var b=this;q.logger.log(this.user_friendly_id()+".removeTrack() called. [id="+this.id+"]");var c=this.tracks_.indexOf(a);this.tracks_.splice(c,1);var f=this;this.waitUntilConnected("MediaStream.removeTrack").then(function(){q.logger.log(f.user_friendly_id()+".removeTrack remote invoking");return f.remoteInvokeEx(!1,d.method_id_MediaStream_t.removeTrack,[a])}).then(function(){q.logger.log(f.user_friendly_id()+
".removeTrack success")})["catch"](function(a){b.logRemoteInvokeError(a,".removeTrack failed!")})};b.prototype.asyncClone=function(){return u(this,void 0,void 0,function(){var a,c,g;return h(this,function(f){switch(f.label){case 0:return q.logger.log(this.user_friendly_id()+".asyncClone() called. [id="+this.id+"]"),[4,this.waitUntilConnected("asyncClone")];case 1:return f.sent(),[4,this.remoteInvoke(!1,d.method_id_MediaStream_t.clone)];case 2:return a=f.sent(),q.logger.log(a),c=this.param0(a),g=new b(this,
c.oid,w.ProxyMode.Remote),[2,g.syncBarrier()]}})})};b.prototype.deepClone=function(a){var d=this;q.logger.log(this.user_friendly_id()+".deepClone() called. [id="+this.id+"]");if(z.RemoteSession.isFeatureTrackCloneWithIdSupported()){var c=[];this.tracks_.forEach(function(a){c.push(a.deepClone())});var f=new m;a=a?a:this.id+"."+f.clone_id.toString();var g=new b(null,0,w.ProxyMode.Local,c,a);g.id=a;g.active_=this.active_;g.clone_state=f;g.tracks_=c;g.waitUntilConnected("RemoteStream.deepClone").then(function(){g.syncBarrier().then(function(){q.logger.log(d.user_friendly_id()+
"stream.syncBarrier(): success")})["catch"](function(a){d.logRemoteInvokeError(a,"stream.syncBarrier() failed!")})})["catch"](function(a){d.logRemoteInvokeError(a,".deepClone() failed!")});return g}q.logger.log(this.user_friendly_id()+".deepClone() is not supported!")};b.prototype.localClone=function(){q.logger.log(this.user_friendly_id()+".localClone() called. [id="+this.id+"]");var a=this.clone_state.clone(),d=new b(this,this.object_id(),w.ProxyMode.Remote);d.id=this.id+"."+a.clone_id.toString();
d.active_=this.active_;this.tracks_.forEach(function(a){a.addRef()});d.tracks_=this.tracks_;d.clone_state=a;return d};b.prototype.clone=function(){q.logger.log(this.user_friendly_id()+".clone() called. [id="+this.id+"]");return z.RemoteSession.isFeatureTrackCloneWithIdSupported()?this.deepClone():this.localClone()};b.prototype.syncBarrier=function(){var a=this;q.logger.log(this.user_friendly_id()+".syncBarrier() called. [id="+this.id+"]");return new Promise(function(b,c){a.syncBarrierDeep(b,c)&&a.waitUntilConnected("MediaStream.syncBarrier").then(function(){var b=
[];b.push(a.remoteInvoke(!1,d.method_id_MediaStream_t.id,""));n.getRedirector().getFeatureValue(d.FEATURE_ms_teams_stream_active_status)&&b.push(a.remoteInvoke(!1,d.method_id_MediaStream_t.active,!0));b.push(a.remoteInvoke(!1,d.method_id_MediaStream_t.getTracks));return Promise.all(b)}).then(function(b){q.logger.log(a.user_friendly_id()+".syncBarrier() remote success");var c;n.getRedirector().getFeatureValue(d.FEATURE_ms_teams_stream_active_status)?(b=b.map(function(b){return a.param0(b)}),a.id=b[0],
a.active_=b[1],c=b[2]):(b=b.map(function(b){return a.param0(b)}),a.id=b[0],c=b[1],a.active_=!0);var g=[];b=function(b){var f=a.tracks_.find(function(a){return a.object_id()===b.oid});void 0===f&&(q.logger.log(a.user_friendly_id()+" adding a RemoteMediaTrack with oid:"+b.oid),f=new p(a,b.oid));g.push(f.syncBarrier())};for(var r=0;r<c.length;r++)b(c[r]);return Promise.all(g)}).then(function(b){a.tracks_=[];b.forEach(function(b){d.BUILD_TYPE_SDK||(b.onstop=function(){var b=!0;a.tracks_.forEach(function(a){"ended"!=
a.readyState&&(b=!1)});b&&a.release()});a.tracks_.push(b)});a.syncBarrierResolve(a)})["catch"](function(b){a.logRemoteInvokeError(b,".syncBarrier failed!");a.syncBarrierReject()})})};b.prototype.dispose=function(){q.logger.log(this.user_friendly_id()+".dispose() called. [id="+this.id+"]");this.tracks_.forEach(function(a){a.dispose()});this.release()};return b}(w.ProxyObject);a.RemoteStream=x;b=function(a){function b(c,g){return a.call(this,c,d.class_id_t.MediaStreamEvent,g,w.ProxyMode.Remote)||this}
e(b,a);b.prototype.syncBarrier=function(){var a=this;q.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.syncBarrierDeep(b,c)&&a.waitUntilConnected("MediaStreamEvent.syncBarrier").then(function(){return a.remoteInvoke(!1,d.method_id_MediaStreamEvent_t.stream,{oid:0})}).then(function(b){return(new x(a,b.params[0].oid,w.ProxyMode.Remote)).syncBarrier()}).then(function(b){a.stream=b;a.syncBarrierResolve(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,
".syncBarrier() failed!");a.syncBarrierReject(b)})})};return b}(w.ProxyObject);a.RemoteStreamEvent=b;var r=function(){return function(a,b,d,c){this.deviceId=a;this.groupId=b;this.kind=d;this.label=c}}();a.DeviceInfo=r;var A=function(a){function b(c){return a.call(this,null,d.class_id_t.MediaDeviceInfo,c,w.ProxyMode.Remote)||this}e(b,a);b.convertKind=function(a){return 0==a?"audioinput":1==a?"audiooutput":"videoinput"};b.prototype.syncBarrier=function(){var a=this;q.logger.log(this.user_friendly_id()+
".syncBarrier() called.");return new Promise(function(c,g){a.syncBarrierDeep(c,g)&&a.waitUntilConnected("RemoteDeviceInfo.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,d.method_id_MediaDeviceInfo_t.deviceId,""),a.remoteInvoke(!1,d.method_id_MediaDeviceInfo_t.kind,0),a.remoteInvoke(!1,d.method_id_MediaDeviceInfo_t.label,""),a.remoteInvoke(!1,d.method_id_MediaDeviceInfo_t.groupId,"")])}).then(function(f){a.kind=b.convertKind(a.param0(f.splice(1,1)[0]));f=f.map(function(b){return a.param0(b)});
a.deviceId=f[0];a.label=f[1];a.groupId=f[2];a.syncBarrierResolve(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier() failed!");a.syncBarrierReject(b)})})};return b}(w.ProxyObject);a.RemoteDeviceInfo=A;b=function(b){function c(){var a=b.call(this,null,d.class_id_t.MediaDevices,0,w.ProxyMode.Local,function(){a.setDeviceChangeCallback()})||this;a.devices_=[];a.enumerateMarker="enumerateDevicesPrivate";a.enumerateRemoteMarker="enumeratedDevicesPrivate-Remote";a.shareSystemAudio_=!1;a.pendingEnumerateDevice_=
[];a.panelid_=-1;return a}e(c,b);Object.defineProperty(c.prototype,"panelid",{set:function(a){this.panelid_=a},enumerable:!1,configurable:!0});c.prototype.clearPanelId=function(){this.panelid_=-1};c.prototype.enumerateDevices=function(){var a=this;return 0<this.devices_.length&&0==this.pendingEnumerateDevice_.length?new Promise(function(b,d){q.logger.log(a.user_friendly_id()+".enumerateDevices: returning cached devices");b(a.devices_)}):this.enumerateDevicesPrivate(!1)};c.prototype.enumerateDevicesPrivate=
function(a){return n.getRedirector().getFeatureValue(d.FEATURE_ms_teams_enumerate_devices_v2)?this.enumerateDevicesPrivateV2(a):this.enumerateDevicesPrivateV1(a)};c.prototype.postEnumerateDevicesResult=function(){for(var a=!0,b=0,d=0,f=this.pendingEnumerateDevice_;d<f.length;d++){var c=f[d];if(0==a&&c.name==this.enumerateRemoteMarker)break;c.postWithResult(!0,this.devices_);b++;a=!1}0<b&&this.pendingEnumerateDevice_.splice(0,b)};c.prototype.enumerateDevicesPrivateV2=function(b){var c=this;q.logger.log(this.user_friendly_id()+
".enumerateDevicesPrivateV2() called. refresh:"+b+" pending:"+this.pendingEnumerateDevice_.length);return new Promise(function(g,f){1==b||0==c.pendingEnumerateDevice_.length?(c.pendingEnumerateDevice_.push(new w.deferred_action(g,f,c.enumerateRemoteMarker)),c.waitUntilConnected("RemoteDevices.enumerateDevicesPrivateV2").then(function(){q.logger.log(c.user_friendly_id()+".enumerateDevicesPrivateV2() remote invoking...");return c.remoteInvoke(!1,d.method_id_MediaDevices_t.enumerateDevicesV2)}).then(function(b){var f=
[];b.params[0].forEach(function(a){a=new r(a.deviceId,a.groupId,A.convertKind(a.kind),a.label);f.push(a)});c.devices_=f;a.enumeratedDevices=l=f;q.logger.log(c.user_friendly_id()+".enumerateDevicesPrivateV2: resolving enumerated devices: "+JSON.stringify(c.devices_));c.postEnumerateDevicesResult()})["catch"](function(b){c.devices_=[];a.enumeratedDevices=l=[];c.logRemoteInvokeError(b,".enumerateDevicesPrivateV2() failed, resolving with empty list.");c.postEnumerateDevicesResult()})):(c.pendingEnumerateDevice_.push(new w.deferred_action(g,
f,c.enumerateMarker)),q.logger.log(c.user_friendly_id()+".enumerateDevicesPrivateV2() not remoting this call..."))})};c.prototype.enumerateDevicesPrivateV1=function(b){var c=this;q.logger.log(this.user_friendly_id()+".enumerateDevicesPrivateV1() called. refresh:"+b+" pending:"+this.pendingEnumerateDevice_.length);return new Promise(function(g,f){1==b||0==c.pendingEnumerateDevice_.length?(c.pendingEnumerateDevice_.push(new w.deferred_action(g,f,c.enumerateRemoteMarker)),c.waitUntilConnected("RemoteDevices.enumerateDevicesPrivateV1").then(function(){q.logger.log(c.user_friendly_id()+
".enumerateDevicesPrivateV1() remote invoking...");return c.remoteInvoke(!1,d.method_id_MediaDevices_t.enumerateDevices)}).then(function(a){var b=[];a.params[0].forEach(function(a){a=new A(a.oid);b.push(a.syncBarrier())});return Promise.all(b)}).then(function(b){var f=[];b.forEach(function(a){var b=new r(a.deviceId,a.groupId,a.kind,a.label);f.push(b);a.release()});c.devices_=f;a.enumeratedDevices=l=f;q.logger.log(c.user_friendly_id()+".enumerateDevicesPrivateV1: resolving enumerated devices: "+JSON.stringify(c.devices_));
c.postEnumerateDevicesResult()})["catch"](function(b){a.enumeratedDevices=l=[];c.devices_=[];c.logRemoteInvokeError(b,".enumerateDevicesPrivateV1() failed, resolving with empty list.");c.postEnumerateDevicesResult()})):(c.pendingEnumerateDevice_.push(new w.deferred_action(g,f,c.enumerateMarker)),q.logger.log(c.user_friendly_id()+".enumerateDevicesPrivateV1() not remoting this call..."))})};c.prototype.getDisplayMedia=function(a){var b=this;return new Promise(function(c,f){b.waitUntilConnected("RemoteDevices.getDisplayMedia").then(function(){return g.ScreenSharing.screenSharingInstance().setActiveSource(b.panelid_,
z.RemoteSession.isFeaturAppshareSupported())}).then(function(f){void 0!==a.video&&null!==a.video&&void 0!==f&&(a.video.deviceId=f);n.getRedirector().getFeatureValue(d.FEATURE_ms_teams_share_system_audio)&&(void 0!==a.audio&&"boolean"!==typeof a.audio?q.logger.log("Non-boolean audio constraints"):a.audio=a.audio||b.shareSystemAudio_);f=b.prepareDisplayConstraints(a);f=J.toRemoteMediaStreamConstraints(f,!0);return b.remoteInvoke(!1,d.method_id_MediaDevices_t.getDisplayMedia,f)}).then(function(a){return(new x(null,
a.params[0].oid,w.ProxyMode.Remote)).syncBarrier()}).then(function(a){c(a)})["catch"](function(a){g.ScreenSharing.screenSharingInstance().isAppshareActive()&&g.ScreenSharing.screenSharingInstance().stopAppshare();a=b.logRemoteInvokeError(a,".getDisplayMedia() failed!");f(a)})})};c.prototype.setDeviceChangeCallback=function(){var a=this;q.logger.log(this.user_friendly_id()+".set_DeviceChangeCallback() called.");this.waitUntilConnected("MediaDevices.ondevicechange").then(function(){var b=a.registerCallbacks(!1,
!1,d.method_id_MediaDevices_t.ondevicechange);b.then(function(){q.logger.log(a.user_friendly_id()+".ondevicechange(): callback received!!!");a.enumerateDevicesPrivate(!0).then(function(){navigator.mediaDevices.dispatchEvent(new CustomEvent("devicechange"))})["catch"](function(){navigator.mediaDevices.dispatchEvent(new CustomEvent("devicechange"))})});return a.remoteInvoke(!0,d.method_id_MediaDevices_t.ondevicechange,b.success)})["catch"](function(b){a.logRemoteInvokeError(b,".set_ondevicechange() failed!")})};
c.prototype.prepareDisplayConstraints=function(a){if(n.getRedirector().getFeatureValue(d.FEATURE_ms_teams_common_media_constraints))return a;var b={frameRate:15,width:{max:1920},height:{max:1080}};if(void 0!==a.video&&null!==a.video){var c=a.video;void 0!==c.frameRate&&void 0!==c.width&&void 0!==c.height&&(b.frameRate=c.frameRate,b.width.max=c.width.max||c.width,b.height.max=c.height.max||c.height)}return a.audio?{video:b,audio:a.audio}:{video:b}};return c}(w.ProxyObject);a.RemoteDevices=b;var M=
function(){function a(){}a.toRemoteMediaTrackConstraintSet=function(a){var b=void 0;v.Util.hasValue(a)&&(b={},v.Util.hasValue(a.width)&&(b.width=a.width),v.Util.hasValue(a.height)&&(b.height=a.height),v.Util.hasValue(a.aspectRatio)&&(b.aspectRatio=a.aspectRatio),v.Util.hasValue(a.frameRate)&&(b.frameRate=a.frameRate),v.Util.hasValue(a.facingMode)&&(b.facingMode=a.facingMode),v.Util.hasValue(a.sampleRate)&&(b.sampleRate=a.sampleRate),v.Util.hasValue(a.sampleSize)&&(b.sampleSize=a.sampleSize),v.Util.hasValue(a.volume)&&
(b.volume=a.volume),v.Util.hasValue(a.echoCancellation)&&(b.echoCancellation=a.echoCancellation),v.Util.hasValue(a.autoGainControl)&&(b.autoGainControl=a.autoGainControl),v.Util.hasValue(a.noiseSuppression)&&(b.noiseSuppression=a.noiseSuppression),v.Util.hasValue(a.latency)&&(b.latency=a.latency),v.Util.hasValue(a.channelCount)&&(b.channelCount=a.channelCount),v.Util.hasValue(a.deviceId)&&(b.deviceId=a.deviceId),v.Util.hasValue(a.groupId)&&(b.groupId=a.groupId),v.Util.hasValue(a.maxFrameRate)&&(b.maxFrameRate=
a.maxFrameRate),v.Util.hasValue(a.maxHeight)&&(b.maxHeight=a.maxHeight),v.Util.hasValue(a.maxWidth)&&(b.maxWidth=a.maxWidth),v.Util.hasValue(a.minHeight)&&(b.minHeight=a.minHeight),v.Util.hasValue(a.minWidth)&&(b.minWidth=a.minWidth),v.Util.hasValue(a.sourceId)&&(b.sourceId=a.sourceId));return b};return a}();a.RemoteMediaTrackConstraintSet=M;var F=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e(b,a);b.defMandatory=function(a){var b=a;v.Util.hasValue(a)?(v.Util.hasValue(a.maxFrameRate)||
(b.maxFrameRate=30),v.Util.hasValue(a.minWidth)||(b.minWidth=360),v.Util.hasValue(a.maxWidth)||(b.maxWidth=1920),v.Util.hasValue(a.minHeight)||(b.minHeight=180),v.Util.hasValue(a.maxHeight)||(b.maxHeight=1080)):b={maxFrameRate:30,minWidth:360,maxWidth:1920,minHeight:180,maxHeight:1080};return b};b.toRemoteMediaTrackConstraints=function(a){var b=void 0;v.Util.hasValue(a)&&(b=M.toRemoteMediaTrackConstraintSet(a),b.advanced=[],v.Util.hasValue(a.advanced)&&a.advanced.forEach(function(a){a=M.toRemoteMediaTrackConstraintSet(a);
b.advanced.push(a)}),v.Util.hasValue(a.mandatory)&&(b.mandatory="boolean"!=typeof a.mandatory?M.toRemoteMediaTrackConstraintSet(a.mandatory):a.mandatory));return b};return b}(M);a.RemoteMediaTrackConstraints=F;var J=function(){function a(){}a.getDefaultAudioDeviceId=function(){if(void 0!==l){var a=l.find(function(a){return"audioinput"===a.kind&&"default"===a.deviceId});if(void 0!==a)return a.deviceId}return""};a.getDefaultVideoDeviceId=function(){if(void 0!==l){var a=l.find(function(a){return"videoinput"===
a.kind});if(void 0!==a)return a.deviceId}return""};a.toRemoteMediaStreamConstraints=function(b,c){void 0===c&&(c=!1);q.logger.log("RemoteMediaStreamConstraints.toRemoteMediaStreamConstraints() in constraints:"+JSON.stringify(b));var g={};v.Util.hasValue(b)&&(v.Util.hasValue(b.audio)&&("boolean"!=typeof b.audio?(g.audio=F.toRemoteMediaTrackConstraints(b.audio),0!=Object.keys(g.audio).length&&v.Util.hasValue(g.audio)||(g.audio={dummy:1}),d.BUILD_TYPE_SDK&&0==c&&a.isConstraintsAudioDeviceIdEmpty(b)&&
(g.audio.deviceId=a.getDefaultAudioDeviceId(),q.logger.log("RemoteMediaStreamConstraints.toRemoteMediaStreamConstraints() set default audio deviceId:'"+g.audio.deviceId+"'"))):g.audio=b.audio),v.Util.hasValue(b.peerIdentity)&&(g.peerIdentity=b.peerIdentity),v.Util.hasValue(b.video)&&("boolean"!=typeof b.video?(g.video=F.toRemoteMediaTrackConstraints(b.video),0==c&&"boolean"!=typeof g.video.mandatory&&(g.video.mandatory=F.defMandatory(g.video.mandatory),d.BUILD_TYPE_SDK&&a.isConstraintsVideoSourceIdEmpty(b)&&
(g.video.mandatory.sourceId=a.getDefaultVideoDeviceId(),q.logger.log("RemoteMediaStreamConstraints.toRemoteMediaStreamConstraints() set default video sourceId:'"+g.video.mandatory.sourceId+"'")))):(g.video=b.video,1==b.video&&0==c&&d.BUILD_TYPE_SDK&&a.isConstraintsVideoSourceIdEmpty(b)&&(g.video={},g.video.mandatory=F.defMandatory(void 0),g.video.mandatory.sourceId=a.getDefaultVideoDeviceId(),q.logger.log("RemoteMediaStreamConstraints.toRemoteMediaStreamConstraints() set default video sourceId:'"+
g.video.mandatory.sourceId+"'")))));q.logger.log("RemoteMediaStreamConstraints.toRemoteMediaStreamConstraints() out constraints:"+JSON.stringify(g));return g};a.isConstraintsAudioDeviceIdEmpty=function(a){var b=!1;v.Util.hasValue(a)&&v.Util.hasValue(a.audio)&&("boolean"==typeof a.audio?1==a.audio&&(b=!0):(a=a.audio,!a||!1!==v.Util.hasValue(a.deviceId)&&""!==a.deviceId||(b=!0)));return b};a.isConstraintsVideoSourceIdEmpty=function(a){var b=!1;if(v.Util.hasValue(a)&&v.Util.hasValue(a.video))if("boolean"==
typeof a.video)1==a.video&&(b=!0);else if(a=a.video)(a=a.mandatory)&&!1!==v.Util.hasValue(a.sourceId)&&""!==a.sourceId||(b=!0);return b};return a}();a.RemoteMediaStreamConstraints=J;var G=function(){function a(){this.video=this.audio=a.EmptyCapabilities}a.EmptyCapabilities={codecs:[],headerExtensions:[]};return a}();b=function(a){function b(){return a.call(this,null,d.class_id_t.NavigatorUserMedia,0,w.ProxyMode.Local)||this}e(b,a);b.getCapabilities=function(a){q.logger.log("NavigatorUserMedia.getCapabilities for type="+
a+" capabilities="+JSON.stringify(b.capabilities[a]));return b.capabilities[a]};b.resetCapabilities=function(){b.capabilities=new G};b.prototype.getCapabilities=function(){var a=this;q.logger.log(this.user_friendly_id()+".getCapabilities...");return new Promise(function(c,g){a.waitUntilConnected("NavigatorUserMedia.getCapabilities").then(function(){return Promise.all([a.remoteInvoke(!1,d.method_id_NavigatorUserMedia_t.getCapabilities,"audio"),a.remoteInvoke(!1,d.method_id_NavigatorUserMedia_t.getCapabilities,
"video")])}).then(function(f){b.capabilities.audio=a.param0(f[0]);b.capabilities.video=a.param0(f[1]);q.logger.log(a.user_friendly_id()+".getCapabilities capabilities="+JSON.stringify(b.capabilities));c(b.capabilities)})["catch"](function(b){g(a.logRemoteInvokeError(b,".getCapabilities failed!"))})})};b.prototype.setCodecCapabilities=function(a){var b=this;q.logger.log(this.user_friendly_id()+".setCodecCapabilities : set codecCapabilities to "+JSON.stringify(a));return new Promise(function(c,f){b.waitUntilConnected("NavigatorUserMedia.setCodecCapabilities").then(function(){return b.remoteInvoke(!1,
d.method_id_NavigatorUserMedia_t.setCodecCapabilities,a)}).then(function(){q.logger.log(b.user_friendly_id()+".setCodecCapabilities() success.");c(!0);b.getCapabilities()})["catch"](function(a){a=b.logRemoteInvokeError(a,".setCodecCapabilities() failed!");f(a)})})};b.prototype.webkitGetUserMedia=function(a,b,d){return this.getUserMedia(a,b,d)};b.prototype.LogTelemetryDevice_=function(a){try{if("undefined"!==typeof a.audio){var b=a.audio.deviceId,d;l.forEach(function(a){b==a.deviceId&&(d=a.label)});
q.logger.log(d);this.SendTelemetryData(k.tel_key_AudioDeviceUsed,d,0)}if("undefined"!==typeof a.video){var f=a.video.mandatory,c;f&&l.forEach(function(a){f.sourceId==a.deviceId&&(c=a.label)});q.logger.log(c);this.SendTelemetryData(k.tel_key_VideoDeviceUsed,c,0)}}catch(g){q.logger.log(g)}};b.prototype.getUserMedia=function(a,b,d){q.logger.log(this.user_friendly_id()+".getUserMedia() called: "+JSON.stringify(a));return b&&d?this.getUserMedia_v1(a,b,d):this.getUserMedia_v2(a)};b.prototype.getUserMedia_v2=
function(a){var b=this;q.logger.log(this.user_friendly_id()+".getUserMedia_v2() called: "+JSON.stringify(a));return new Promise(function(d,f){b.getUserMediaPrivate(a,function(a){q.logger.log(b.user_friendly_id()+"getUserMedia_v2: resolving stream");d(a)},function(a){q.logger.log(b.user_friendly_id()+"getUserMedia_v2: rejecting stream");f(a)})})};b.prototype.getUserMedia_v1=function(a,b,d){q.logger.log(this.user_friendly_id()+".getUserMedia_v1() called: "+JSON.stringify(a));return this.getUserMediaPrivate(a,
b,d)};b.prototype.getUserMediaPrivate=function(a,b,c){var f=this;this.waitUntilConnected("NavigatorUserMedia.getUserMediaPrivate").then(function(){var b=f.registerCallbacks(!0,!1,d.method_id_NavigatorUserMedia_t.getUserMedia),c=J.toRemoteMediaStreamConstraints(a);f.remoteInvoke(!1,d.method_id_NavigatorUserMedia_t.getUserMedia,c,b.success,b.fail);return b.prom()}).then(function(a){q.logger.log(f.user_friendly_id()+".getUserMediaPrivate: received success callback!");return(new x(null,f.param0(a).oid,
w.ProxyMode.Remote)).syncBarrier()}).then(function(d){q.logger.log(f.user_friendly_id()+".getUserMediaPrivate: MediaStream ready to deliver",JSON.stringify(d));0==d.getTracks().length?(q.logger.log(f.user_friendly_id()+".getUserMediaPrivate: reporting no tracks as error."),c({constraintName:"",name:"OverconstrainedError",message:""})):(f.LogTelemetryDevice_(a),b(d))})["catch"](function(a){f.logRemoteInvokeError(a,".getUserMediaPrivate() failed!");n.getRedirector().getFeatureValue(d.FEATURE_ms_teams_1912)?
f.param0&&a?c(f.param0(a)):c({constraintName:"",name:"OverconstrainedError",message:""}):c({constraintName:"",name:"OverconstrainedError",message:""})})};b.prototype.SendTelemetryData=function(a,b,d){n.getRedirector().telemetry.SendTelemetryData(k.tel_cmd.Data,a,b,d)};b.capabilities=new G;return b}(w.ProxyObject);a.NavigatorUserMedia=b},650:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.RemoteSession=a.SessionInfo=a.RemoteType=void 0;var e=c(946),l=c(550),h=c(9),d=c(851),w=c(550),
q=c(394),n;(function(a){a[a.Unknown=0]="Unknown";a[a.Windows=1]="Windows";a[a.Linux=2]="Linux"})(n=a.RemoteType||(a.RemoteType={}));var k=function(){return function(){}}();a.SessionInfo=k;b=function(){function a(b,d){var c=this;this.isremote_=!1;this.isremote_=!0;this.type_=n.Windows;this.address_="0.0.0.0";this.sessioninfo_=null;e.getRedirector().setRemoteSessionInfoCb(function(){return c.remoteSessionInfo()});this.enginecontrol_=new h.EngineControl(b+"::"+d)}a.prototype.release=function(){e.getRedirector().setRemoteSessionInfoCb(null)};
a.prototype.user_friendly_id=function(){return"[RemoteSession]"};a.prototype.getFeatureFlags=function(){var a={};null!==this.enginecontrol_&&null!==this.enginecontrol_.features_&&void 0!==this.enginecontrol_.features_&&this.enginecontrol_.features_.forEach(function(b){a[b.name]=b.value});return a};a.prototype.isFeatureSupported=function(a){if("video"===a)return!0;if("givecontrol"===a&&this.sessioninfo_.clientPlatform.includes("Linux")||!(a in w.featureNameMap))return!1;for(var b=w.featureNameMap[a],
d=this.getFeatureFlags(),c=0;c<b.length;c++)if(!(b[c]in d)||!0!==d[b[c]])return!1;return a in w.vdaFeatureNameMap?w.vdaFeatureNameMap[a].map(function(a){return e.getRedirector().getVDAFeatureValue(a)}).reduce(function(a,b){return a&&b},!0):!0};a.isFeaturePstnSupported=function(){return a.pstn_};a.isFeatureDtmfSupported=function(){return a.dtmfswitch_};a.isFeaturAppshareSupported=function(){return a.appshare_};a.isFeatureWebrtc1dot0Supported=function(){return a.webrtc1dot0_};a.isFeatureDataChannelSupported=
function(){return a.datachannel_};a.isFeatureVdNoBufferLimitSupported=function(){return a.vdnobuflimit_};a.isFeatureCallConstraintsSupported=function(){return a.callconstraints_};a.isFeatureTrackCloneWithIdSupported=function(){return a.trackclonewithid_};a.isFeatureSenderStatsFixSupported=function(){return a.senderstatsfix_};a.prototype.getSessionInfo=function(){d.logger.log(this.user_friendly_id()+".getSessionInfo() called.");return null!=this.sessioninfo_?Promise.resolve(this.sessioninfo_):Promise.reject()};
a.prototype.remoteSessionInfo=function(){var b=this,c=this;d.logger.log(c.user_friendly_id()+".remoteSessionInfo() called.");return new Promise(function(n,t){c.enginecontrol_.syncBarrier().then(function(e){d.logger.log(c.user_friendly_id()+"enginecontrol info received!");c.sessioninfo_=new k;c.sessioninfo_.type_script=l.HDXMS_VERSION;c.sessioninfo_.webrpc=e.version_.major.toString()+"."+e.version_.minor.toString()+"."+e.version_.revision.toString()+"."+e.version_.build.toString();if(void 0!=e.versions_&&
null!=e.versions_){c.SendTelemetryData(q.tel_key_VerTypeScript,l.HDXMS_VERSION,0);for(var t=0,y=0,x=e.versions_;y<x.length;y++){var r=x[y],r=r.major.toString()+"."+r.minor.toString()+"."+r.revision.toString()+"."+r.build.toString();switch(t){case h.VersionType.Webrpc:c.sessioninfo_.webrpc=r;c.SendTelemetryData(q.tel_key_VerWebrpc,r,0);break;case h.VersionType.WebrtcCodecs:c.sessioninfo_.webrtc_codecs=r;c.SendTelemetryData(q.tel_key_VerWebrtcCodecs,r,0);break;case h.VersionType.Receiver:c.sessioninfo_.receiver=
r;c.SendTelemetryData(q.tel_key_VerReceiver,r,0);break;case h.VersionType.Vda:c.sessioninfo_.vda=r;c.SendTelemetryData(q.tel_key_VerVda,r,0);break;case h.VersionType.Endpoint:c.sessioninfo_.endpoint=r;c.SendTelemetryData(q.tel_key_VerEndpoint,r,0);break;case h.VersionType.HdxRtcEngine:c.sessioninfo_.hdxrtcengine=r;c.SendTelemetryData(q.tel_key_VerHdxRtcEngine,r,0);break;default:d.logger.log(c.user_friendly_id()+"Unknown version type!")}t++}}void 0!=e.osinfo_&&null!=e.osinfo_&&(c.sessioninfo_.osinfo=
e.osinfo_,e.osinfo_.family.includes("Darwin")&&["Mac OS X","macOS","OS X"].some(function(a){return e.osinfo_.edition.startsWith(a)})?c.sessioninfo_.clientPlatform="Mac":c.sessioninfo_.clientPlatform=e.osinfo_.family,c.SendTelemetryData(q.tel_key_OSFamily,e.osinfo_.family,0),c.SendTelemetryData(q.tel_key_OSVersion,e.osinfo_.version,0),c.SendTelemetryData(q.tel_key_OSArchitecture,e.osinfo_.architecture,0),c.SendTelemetryData(q.tel_key_OSDistro,e.osinfo_.distro,0),c.SendTelemetryData(q.tel_key_OSEdition,
e.osinfo_.edition,0));void 0!=e.endpointid_&&null!=e.endpointid_&&(c.sessioninfo_.endpointId=e.endpointid_.machine_id);void 0!=e.hardwareinfo_&&null!=e.hardwareinfo_&&(c.sessioninfo_.hardware_info=e.hardwareinfo_,c.SendTelemetryData(q.tel_key_CPUModel,e.hardwareinfo_.cpu_info.cpumodel,0),c.SendTelemetryData(q.tel_key_CPUProcessors,e.hardwareinfo_.cpu_info.numberofprocessors,0),c.SendTelemetryData(q.tel_key_CPUGpuinfo,JSON.stringify(e.hardwareinfo_.gpu_info.gpus),0),c.SendTelemetryData(q.tel_key_CPUTotalmemory,
e.hardwareinfo_.memory_info.totalmemory,0));a.pstn_=b.isFeatureSupported(l.Features.FEATURE_public_pstn);a.dtmfswitch_=b.isFeatureSupported(l.Features.FEATURE_public_dtmf);a.appshare_=b.isFeatureSupported(l.Features.FEATURE_public_app_sharing);a.webrtc1dot0_=b.isFeatureSupported(l.Features.FEATURE_public_webrtc1dot0);a.datachannel_=b.isFeatureSupported(l.Features.FEATURE_public_data_channel);a.vdnobuflimit_=b.isFeatureSupported(l.Features.FEATURE_public_vdnobuflimit);a.callconstraints_=b.isFeatureSupported(l.Features.FEATURE_public_stream_resolution);
a.trackclonewithid_=b.isFeatureSupported(l.Features.FEATURE_public_track_clone_with_id);a.senderstatsfix_=b.isFeatureSupported(l.Features.FEATURE_public_sender_stats_fix);n(c.sessioninfo_);c.enginecontrol_.release()})["catch"](function(){e.getRedirector().isPingActive()?c.retrySessionInfo():(t(),c.enginecontrol_.release(),c.enginecontrol_=null)})})};a.prototype.retrySessionInfo=function(){var a=this;setTimeout(function(){d.logger.log("checking if we are connected...");a.enginecontrol_.bind();e.getRedirector().handleRemoteSessionInfo()},
15E3)};a.prototype.SendTelemetryData=function(a,b,d){e.getRedirector().telemetry.SendTelemetryData(q.tel_cmd.Data,a,b,d)};a.pstn_=!1;a.dtmfswitch_=!1;a.appshare_=!1;a.webrtc1dot0_=!1;a.datachannel_=!1;a.vdnobuflimit_=!1;a.callconstraints_=!1;a.trackclonewithid_=!1;a.senderstatsfix_=!1;return a}();a.RemoteSession=b},24:function(b,a,c){var e=this&&this.__extends||function(){var a=function(b,d){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)b.hasOwnProperty(d)&&
(a[d]=b[d])};return a(b,d)};return function(b,d){function c(){this.constructor=b}a(b,d);b.prototype=null===d?Object.create(d):(c.prototype=d.prototype,new c)}}();Object.defineProperty(a,"__esModule",{value:!0});a.RtcDataChannel=a.RTCSctpTransport=void 0;var l=c(658),h=c(550),d=c(851),w=c(589),q;(function(a){a[a["new"]=0]="new";a[a.connecting=1]="connecting";a[a.connected=2]="connected";a[a.closed=3]="closed";a[a.max=4]="max"})(q||(q={}));b=function(a){function b(c,g){var e=a.call(this,c,h.class_id_t.RTCSctpTransport,
g,l.ProxyMode.Remote)||this;d.logger.log(e.user_friendly_id()+".constructor");return e}e(b,a);b.prototype.syncBarrier=function(){var a=this;d.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.syncBarrierDeep(b,c)&&a.waitUntilConnected("RTCSctpTransport.syncBarrier").then(function(){d.logger.log(a.user_friendly_id()+".syncBarrierBase success.");return Promise.all([a.remoteInvoke(!1,h.method_id_RTCSctpTransport_t.transport,{oid:0}),a.remoteInvoke(!1,h.method_id_RTCSctpTransport_t.state,
0),a.remoteInvoke(!1,h.method_id_RTCSctpTransport_t.maxMessageSize,0),a.remoteInvoke(!1,h.method_id_RTCSctpTransport_t.maxChannels,0)])}).then(function(b){var c;c=b.map(function(b){return a.param0(b)});b=c[0];a.sctpstate_=c[1];a.maxMessageSize_=c[2];a.maxChannels_=c[3];c=a.transport_;void 0==b||!1!==b.is_null||null!==a.transport_&&a.transport_.object_id()==b.oid||(c=new w.DtlsTransport(a,b.oid));c.syncBarrier().then(function(b){d.logger.log(a.user_friendly_id()+"transport.syncBarrier(): success");
a.transport_=b;a.syncBarrierResolve(a)})["catch"](function(){d.logger.log(a.user_friendly_id()+"transport.syncBarrier(): failed!");a.transport_=null;a.syncBarrierResolve(a)})})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier() failed!");a.syncBarrierReject(b)})})};Object.defineProperty(b.prototype,"transport",{get:function(){d.logger.log(this.user_friendly_id()+".get_transport() called: "+this.transport_);return this.transport_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,
"state",{get:function(){d.logger.log(this.user_friendly_id()+".get_state() called: "+this.sctpstate_);return this.sctpstate_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"maxMessageSize",{get:function(){d.logger.log(this.user_friendly_id()+".get_maxMessageSize() called: "+this.maxMessageSize_);return this.maxMessageSize_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"maxChannels",{get:function(){d.logger.log(this.user_friendly_id()+".get_maxChannels() called: "+
this.maxChannels_);return this.maxChannels_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onstatechange",{get:function(){d.logger.log(this.user_friendly_id()+".get_onstatechange() called: "+this.onstatechange_);return this.onstatechange_},set:function(a){var c=this;d.logger.log(this.user_friendly_id()+".set_onstatechange() called.");this.onstatechange_=a;this.waitUntilConnected(this.user_friendly_id()+".onstatechange").then(function(){var e=c.registerCallbacks(!1,c.isNullCallback(a),
h.method_id_RTCSctpTransport_t.onstatechange);e.then(function(a){d.logger.log(c.user_friendly_id()+".onstatechange callback received!!!");c.sctpstate_=b.convertState(c.param0(a));d.logger.log(c.user_friendly_id()+"sctpstate_: "+c.sctpstate_);a=new Event("onstatechange");c.onstatechange_(a)});return c.remoteInvoke(!0,h.method_id_RTCSctpTransport_t.onstatechange,e.success)})["catch"](function(){d.logger.log(c.user_friendly_id()+".onstatechange() failed.")})},enumerable:!1,configurable:!0});b.convertState=
function(a){return a==q["new"]?"closed":a==q.connecting?"connecting":a==q.connected?"connected":"closed"};return b}(l.ProxyObject);a.RTCSctpTransport=b;var n;(function(a){a[a.connecting=0]="connecting";a[a.open=1]="open";a[a.closing=2]="closing";a[a.closed=3]="closed"})(n||(n={}));b=function(a){function b(c,g,e){c=a.call(this,c,h.class_id_t.RTCDataChannel,g,e)||this;c.binaryType_="blob";d.logger.log(c.user_friendly_id()+".constructor");return c}e(b,a);b.prototype.syncBarrier=function(){var a=this;
d.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.syncBarrierDeep(b,c)&&a.waitUntilConnected("RtcDataChannel.syncBarrier").then(function(){d.logger.log(a.user_friendly_id()+".syncBarrier remote invoking.");return Promise.all([a.remoteInvoke(!1,h.method_id_RTCDataChannel_t.label,""),a.remoteInvoke(!1,h.method_id_RTCDataChannel_t.ordered,!0),a.remoteInvoke(!1,h.method_id_RTCDataChannel_t.maxPacketLifeTime,0),a.remoteInvoke(!1,h.method_id_RTCDataChannel_t.maxRetransmits,
0),a.remoteInvoke(!1,h.method_id_RTCDataChannel_t.protocol,""),a.remoteInvoke(!1,h.method_id_RTCDataChannel_t.negotiated,!1),a.remoteInvoke(!1,h.method_id_RTCDataChannel_t.id,0),a.remoteInvoke(!1,h.method_id_RTCDataChannel_t.readyState,0),a.remoteInvoke(!1,h.method_id_RTCDataChannel_t.bufferedAmount,0),a.remoteInvoke(!1,h.method_id_RTCDataChannel_t.bufferedAmountLowThreshold,0)])}).then(function(b){d.logger.log(a.user_friendly_id()+".syncBarrier success.");var c;b=b.map(function(b){return a.param0(b)});
a.label_=b[0];a.ordered_=b[1];a.maxPacketLifeTime_=b[2];a.maxRetransmits_=b[3];a.protocol_=b[4];a.negotiated_=b[5];a.id_=b[6];c=b[7];a.bufferedAmount_=b[8];a.bufferedAmountLowThreshold_=b[9];a.readyState_=a.toRTCDataChannelState(c);a.syncBarrierResolve(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier() failed!");a.syncBarrierReject(b)})})};Object.defineProperty(b.prototype,"label",{get:function(){d.logger.log(this.user_friendly_id()+".get_label() called: "+this.label_);return this.label_},
enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"ordered",{get:function(){d.logger.log(this.user_friendly_id()+".get_ordered() called: "+this.ordered_);return this.ordered_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"maxPacketLifeTime",{get:function(){d.logger.log(this.user_friendly_id()+".get_maxPacketLifeTime() called: "+this.maxPacketLifeTime_);return this.maxPacketLifeTime_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"maxRetransmits",
{get:function(){d.logger.log(this.user_friendly_id()+".get_maxRetransmits() called: "+this.maxRetransmits_);return this.maxRetransmits_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"protocol",{get:function(){d.logger.log(this.user_friendly_id()+".get_protocol() called: "+this.protocol_);return this.protocol_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"negotiated",{get:function(){d.logger.log(this.user_friendly_id()+".get_negotiated() called: "+this.negotiated_);
return this.negotiated_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"id",{get:function(){d.logger.log(this.user_friendly_id()+".get_id() called: "+this.id_);return this.id_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"readyState",{get:function(){d.logger.log(this.user_friendly_id()+".get_readyState() called: "+this.readyState_);return this.readyState_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"bufferedAmount",{get:function(){d.logger.log(this.user_friendly_id()+
".get_bufferedAmount() called: "+this.bufferedAmount_);return this.bufferedAmount_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"bufferedAmountLowThreshold",{get:function(){d.logger.log(this.user_friendly_id()+".get_bufferedAmountLowThreshold() called: "+this.bufferedAmountLowThreshold_);return this.bufferedAmountLowThreshold_},set:function(a){d.logger.log(this.user_friendly_id()+".get_bufferedAmountLowThreshold() called: "+a);this.bufferedAmountLowThreshold_=a},enumerable:!1,
configurable:!0});Object.defineProperty(b.prototype,"binaryType",{get:function(){d.logger.log(this.user_friendly_id()+".get_binaryType() called: "+this.binaryType_);return this.binaryType_},set:function(a){d.logger.log(this.user_friendly_id()+".set_binaryType() called: "+a);this.binaryType_="blob"==a||"arraybuffer"==a?a:"blob"},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onopen",{get:function(){d.logger.log(this.user_friendly_id()+".get_onopen() called.");return this.onopen_},
set:function(a){var b=this;d.logger.log(this.user_friendly_id()+".set_onopen() called.");this.onopen_=a;this.waitUntilConnected(this.user_friendly_id()+".onopen").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),h.method_id_RTCDataChannel_t.onopen);c.then(function(a){d.logger.log(b.user_friendly_id()+".onopen callback received!!!");b.syncBarrier().then(function(){d.logger.log(b.user_friendly_id()+".onopen notifying...");var a=new Event("open",{});Object.defineProperty(a,"target",{writable:!1,
value:b});b.onopen_(a)})["catch"](function(){d.logger.log(b.user_friendly_id()+".syncBarrier(): failed!")})});return b.remoteInvoke(!0,h.method_id_RTCDataChannel_t.onopen,c.success)})["catch"](function(){d.logger.log(b.user_friendly_id()+".onopen() failed.")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onbufferedamountlow",{get:function(){d.logger.log(this.user_friendly_id()+".get_onbufferedamountlow() called.");return this.onbufferedamountlow_},set:function(a){var b=this;
d.logger.log(this.user_friendly_id()+".set_onbufferedamountlow() called.");this.onbufferedamountlow_=a;this.waitUntilConnected(this.user_friendly_id()+".onbufferedamountlow").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),h.method_id_RTCDataChannel_t.onbufferedamountlow);c.then(function(a){d.logger.log(b.user_friendly_id()+".onbufferedamountlow callback received!!!");a=new Event("onbufferedamountlow");Object.defineProperty(a,"target",{writable:!1,value:b});b.onbufferedamountlow_(a)});
return b.remoteInvoke(!0,h.method_id_RTCDataChannel_t.onbufferedamountlow,c.success)})["catch"](function(){d.logger.log(b.user_friendly_id()+".onbufferedamountlows() failed.")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onerror",{get:function(){d.logger.log(this.user_friendly_id()+".get_onerror() called.");return this.onerror_},set:function(a){var b=this;d.logger.log(this.user_friendly_id()+".set_onerror() called.");this.onerror_=a;this.waitUntilConnected(this.user_friendly_id()+
".onerror").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),h.method_id_RTCDataChannel_t.onerror);c.then(function(a){d.logger.log(b.user_friendly_id()+".onerror callback received!");a=b.param0(a);d.logger.log(b.user_friendly_id()+"error: "+a);a=new Event("onerror");Object.defineProperty(a,"target",{writable:!1,value:b});b.onerror_(a)});return b.remoteInvoke(!0,h.method_id_RTCDataChannel_t.onerror,c.success)})["catch"](function(){d.logger.log(b.user_friendly_id()+".onerror() failed.")})},
enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onclosing",{get:function(){d.logger.log(this.user_friendly_id()+".get_onclosing() called.");return this.onclosing_},set:function(a){var b=this;d.logger.log(this.user_friendly_id()+".set_onclosing() called.");this.onclosing_=a;this.waitUntilConnected(this.user_friendly_id()+".onclosing").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),h.method_id_RTCDataChannel_t.onclosing);c.then(function(a){d.logger.log(b.user_friendly_id()+
".onclosing callback received!!!");a=new Event("onclosing");Object.defineProperty(a,"target",{writable:!1,value:b});b.onclosing_(a)});return b.remoteInvoke(!0,h.method_id_RTCDataChannel_t.onclosing,c.success)})["catch"](function(){d.logger.log(b.user_friendly_id()+".onclosing() failed.")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onclose",{get:function(){d.logger.log(this.user_friendly_id()+".get_onclose() called.");return this.onclose_},set:function(a){var b=this;d.logger.log(this.user_friendly_id()+
".set_onclose() called.");this.onclose_=a;this.waitUntilConnected(this.user_friendly_id()+".onclose").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),h.method_id_RTCDataChannel_t.onclose);c.then(function(a){d.logger.log(b.user_friendly_id()+".onclose callback received!!!");a=new Event("onclose");Object.defineProperty(a,"target",{writable:!1,value:b});b.onclose_(a)});return b.remoteInvoke(!0,h.method_id_RTCDataChannel_t.onclose,c.success)})["catch"](function(){d.logger.log(b.user_friendly_id()+
".onclose() failed.")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onmessage",{get:function(){d.logger.log(this.user_friendly_id()+".get_onmessage() called.");return this.onmessage_},set:function(a){var b=this;d.logger.log(this.user_friendly_id()+".set_onmessage() called.");this.onmessage_=a;this.waitUntilConnected(this.user_friendly_id()+".onmessage").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),h.method_id_RTCDataChannel_t.onmessage);c.then(function(a){d.logger.log(b.user_friendly_id()+
".onmessage callback received!!!");var c=b.param0(a);a=new Event("onmessage");c.binary?a.data=c.data_ab:(c=atob(c.data_sz),a.data=c);b.onmessage_(a)});return b.remoteInvoke(!0,h.method_id_RTCDataChannel_t.onmessage,c.success)})["catch"](function(){d.logger.log(b.user_friendly_id()+".onmessage() failed.")})},enumerable:!1,configurable:!0});b.prototype.close=function(){var a=this;d.logger.log(this.user_friendly_id()+".close() called.");this.waitUntilConnected("RTCDataChannel.close").then(function(){return a.remoteInvoke(!1,
h.method_id_RTCDataChannel_t.close)}).then(function(){d.logger.log(a.user_friendly_id()+".close: success.")})["catch"](function(){d.logger.log(a.user_friendly_id()+".close: failed.")})};b.prototype.toByteArray=function(a){var b=[];a=new Uint8Array(a instanceof ArrayBuffer?a:a.buffer);for(var d in a)b.push(a[d]);return b};b.prototype.send=function(a){var b=this;d.logger.log(this.user_friendly_id()+".send() called.");this.waitUntilConnected("RTCDataChannel.send").then(function(){if("string"===typeof a)return d.logger.log(b.user_friendly_id()+
"data(string): "+a),b.remoteInvoke(!1,h.method_id_RTCDataChannel_t.send_text,a);if(a instanceof Blob)a.arrayBuffer().then(function(a){a=b.toByteArray(a);return b.remoteInvoke(!1,h.method_id_RTCDataChannel_t.send_binary,a)})["catch"](function(){d.logger.log(b.user_friendly_id()+".arrayBuffer(): failed.")});else{var c=b.toByteArray(a);return b.remoteInvoke(!1,h.method_id_RTCDataChannel_t.send_binary,c)}}).then(function(){d.logger.log(b.user_friendly_id()+".send: success.")})["catch"](function(){d.logger.log(b.user_friendly_id()+
".send: failed.")})};b.prototype.toRTCDataChannelState=function(a){var b="closed";a==n.connecting?b="connecting":a==n.open?b="open":a==n.closing?b="closing":a==n.closed&&(b="closed");return b};return b}(l.ProxyObject);a.RtcDataChannel=b},484:function(b,a,c){var e=this&&this.__extends||function(){var a=function(b,d){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d])};return a(b,d)};return function(b,d){function c(){this.constructor=
b}a(b,d);b.prototype=null===d?Object.create(d):(c.prototype=d.prototype,new c)}}();Object.defineProperty(a,"__esModule",{value:!0});a.RtcRtpReceiveParameters=a.RtcRtpSendParameters=a.RtcRtpEncodingParameters=a.RtcRtpParameters=a.RtcRtcpParameters=a.RtcRtpHeaderExtensionParameters=a.RtcRtpCodecParameters=void 0;var l=c(851),h=function(){function a(){}a.defRtcRtpCodecParameters=function(){return{mimeType:"",payloadType:0,sdpFmtpLine:""}};a.defRTCRtpCodecParameters=function(){return{clockRate:0,mimeType:"",
payloadType:0}};a.toRtcRtpCodecParameters=function(b){var d=a.defRtcRtpCodecParameters();b&&(b.channels&&(d.channels=b.channels),b.clockRate&&(d.clockRate=b.clockRate),b.mimeType&&(d.mimeType=b.mimeType),b.payloadType&&(d.payloadType=b.payloadType),b.sdpFmtpLine&&(d.sdpFmtpLine=b.sdpFmtpLine));return d};a.toRTCRtpCodecParameters=function(b){var d=a.defRTCRtpCodecParameters();b&&(b.channels&&(d.channels=b.channels),b.clockRate&&(d.clockRate=b.clockRate),b.mimeType&&(d.mimeType=b.mimeType),b.payloadType&&
(d.payloadType=b.payloadType),b.sdpFmtpLine&&(d.sdpFmtpLine=b.sdpFmtpLine));return d};return a}();a.RtcRtpCodecParameters=h;var d=function(){function a(){}a.defRtcRtpHeaderExtensionParameters=function(){return{encrypted:!1,id:0,uri:""}};a.defRTCRtpHeaderExtensionParameters=function(){return{id:0,uri:""}};a.toRtcRtpHeaderExtensionParameters=function(b){var d=a.defRtcRtpHeaderExtensionParameters();if(b){var c=b.encrypted;void 0!=c&&null!=c&&(d.encrypted=c);b.id&&(d.id=b.id);b.uri&&(d.uri=b.uri)}return d};
a.toRTCRtpHeaderExtensionParameters=function(b){var d=a.defRTCRtpHeaderExtensionParameters();if(b){var c=b.encrypted;void 0!=c&&null!=c&&(d.encrypted=c);b.id&&(d.id=b.id);b.uri&&(d.uri=b.uri)}return d};return a}();a.RtcRtpHeaderExtensionParameters=d;var w=function(){function a(){}a.defRtcRtcpParameters=function(){return{cname:"",reducedSize:!1}};a.defRTCRtcpParameters=function(){return{}};a.toRtcRtcpParameters=function(b){var d=a.defRtcRtcpParameters();b&&(b.cname&&(d.cname=b.cname),b=b.reducedSize,
void 0!=b&&null!=b&&(d.reducedSize=b));return d};a.toRTCRtcpParameters=function(b){var d=a.defRTCRtcpParameters();b&&(b.cname&&(d.cname=b.cname),b=b.reducedSize,void 0!=b&&null!=b&&(d.reducedSize=b));return d};return a}();a.RtcRtcpParameters=w;var q=function(){function a(){}a.defRtcRtpParameters=function(){return{codecs:[],headerExtensions:[],rtcp:w.defRtcRtcpParameters()}};a.defRTCRtpParameters=function(){return{codecs:[],headerExtensions:[],rtcp:w.defRTCRtcpParameters()}};a.toRtcRtpParameters=function(b){var c=
a.defRtcRtpParameters();if(b){if(b.codecs)for(var g=0,e=b.codecs;g<e.length;g++)c.codecs.push(h.toRtcRtpCodecParameters(e[g]));if(b.headerExtensions)for(g=0,e=b.headerExtensions;g<e.length;g++)c.headerExtensions.push(d.toRtcRtpHeaderExtensionParameters(e[g]));b.rtcp&&(c.rtcp=w.toRtcRtcpParameters(b.rtcp))}return c};a.toRTCRtpParameters=function(b){var c=a.defRTCRtpParameters();if(b){if(b.codecs)for(var e=0,n=b.codecs;e<n.length;e++)c.codecs.push(h.toRTCRtpCodecParameters(n[e]));if(b.headerExtensions)for(e=
0,n=b.headerExtensions;e<n.length;e++)c.headerExtensions.push(d.toRTCRtpHeaderExtensionParameters(n[e]));b.rtcp&&(c.rtcp=w.toRtcRtcpParameters(b.rtcp))}return c};return a}();a.RtcRtpParameters=q;var n=function(){function a(){}a.defRtcRtpEncodingParameters=function(){return{active:!0,rid:""}};a.defRTCRtpEncodingParameters=function(){return{}};a.toRtcRtpEncodingParameters=function(b){var d=a.defRtcRtpEncodingParameters();if(b){var c=b.active;void 0!=c&&null!=c&&(d.active=c);b.maxBitrate&&(d.maxBitrate=
b.maxBitrate);b.maxFramerate&&(d.maxFramerate=b.maxFramerate);b.scaleResolutionDownBy&&(d.scaleResolutionDownBy=b.scaleResolutionDownBy);b.rid&&(d.rid=b.rid);b.networkPriority&&(d.networkPriority=b.networkPriority)}return d};a.toRTCRtpEncodingParameters=function(b){var d=a.defRTCRtpEncodingParameters();if(b){var c=b.active;void 0!=c&&null!=c&&(d.active=c);b.maxBitrate&&(d.maxBitrate=b.maxBitrate);b.maxFramerate&&(d.maxFramerate=b.maxFramerate);b.scaleResolutionDownBy&&(d.scaleResolutionDownBy=b.scaleResolutionDownBy);
b.rid&&(d.rid=b.rid);b.networkPriority&&(d.networkPriority=b.networkPriority)}return d};return a}();a.RtcRtpEncodingParameters=n;b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e(b,a);b.defRtcRtpSendParameters=function(){var a=q.defRtcRtpParameters();a.encodings=[];a.transaction_id="";return a};b.defRTCRtpSendParameters=function(){var a=q.defRTCRtpParameters();a.encodings=[];a.transactionId="";return a};b.toRtcRtpSendParameters=function(a){l.logger.log("RtcRtpSendParameters.toRtcRtpSendParameters() in param:"+
JSON.stringify(a));var d=b.defRtcRtpSendParameters(),c=q.toRtcRtpParameters(a);c.codecs.forEach(function(a){return d.codecs.push(a)});c.headerExtensions.forEach(function(a){return d.headerExtensions.push(a)});d.rtcp=c.rtcp;if(a){if(a.encodings)for(var c=0,e=a.encodings;c<e.length;c++)d.encodings.push(n.toRtcRtpEncodingParameters(e[c]));a.transactionId&&(d.transaction_id=a.transactionId)}l.logger.log("RtcRtpSendParameters.toRtcRtpSendParameters() out param:"+JSON.stringify(d));return d};b.toRTCRtpSendParameters=
function(a){l.logger.log("RtcRtpSendParameters.toRTCRtpSendParameters() in param:"+JSON.stringify(a));var d=b.defRTCRtpSendParameters(),c=q.toRTCRtpParameters(a);c.codecs.forEach(function(a){return d.codecs.push(a)});c.headerExtensions.forEach(function(a){return d.headerExtensions.push(a)});d.rtcp=c.rtcp;if(a){if(a.encodings)for(var c=0,e=a.encodings;c<e.length;c++)d.encodings.push(n.toRTCRtpEncodingParameters(e[c]));a.transaction_id&&(d.transactionId=a.transaction_id)}l.logger.log("RtcRtpSendParameters.toRTCRtpSendParameters() out param:"+
JSON.stringify(d));return d};return b}(q);a.RtcRtpSendParameters=b;b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e(b,a);b.defRtcRtpReceiveParameters=function(){return q.defRtcRtpParameters()};b.defRTCRtpReceiveParameters=function(){return q.defRTCRtpParameters()};b.toRtcRtpReceiveParameters=function(a){l.logger.log("RtcRtpReceiveParameters.toRtcRtpReceiveParameters() in param:"+JSON.stringify(a));a=q.toRtcRtpParameters(a);l.logger.log("RtcRtpReceiveParameters.toRtcRtpReceiveParameters() out param:"+
JSON.stringify(a));return a};b.toRTCRtpReceiveParameters=function(a){l.logger.log("RtcRtpReceiveParameters.toRTCRtpReceiveParameters() in param:"+JSON.stringify(a));a=q.toRTCRtpParameters(a);l.logger.log("RtcRtpReceiveParameters.toRTCRtpReceiveParameters() out param:"+JSON.stringify(a));return a};return b}(q);a.RtcRtpReceiveParameters=b},589:function(b,a,c){var e=this&&this.__extends||function(){var a=function(b,d){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=
b}||function(a,b){for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d])};return a(b,d)};return function(b,d){function c(){this.constructor=b}a(b,d);b.prototype=null===d?Object.create(d):(c.prototype=d.prototype,new c)}}();Object.defineProperty(a,"__esModule",{value:!0});a.RtpReceiver=a.RtpSender=a.RtpSenderReceiver=a.DtlsTransport=a.IceTransport=a.DtmfSender=a.DTMFToneChangeEvent=void 0;var l=c(658),h=c(550),d=c(851),w=c(144),q=c(517),n=c(650),k=c(484),v=function(a){function b(c,e){var g=a.call(this,c,
h.class_id_t.RTCDTMFToneChangeEvent,e,l.ProxyMode.Remote)||this;d.logger.log(g.user_friendly_id()+".constructor");return g}e(b,a);b.prototype.syncBarrier=function(){var a=this;d.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.syncBarrierDeep(b,c)&&a.waitUntilConnected(a.user_friendly_id()+".syncBarrier").then(function(){Promise.all([a.remoteInvoke(!1,h.method_id_RTCDTMFToneChangeEvent_t.tone,""),a.remoteInvoke(!1,h.method_id_RTCDTMFToneChangeEvent_t.tone_buffer,
"")]).then(function(b){d.logger.log(a.user_friendly_id()+".syncBarrier(): success.");b=b.map(function(b){return a.param0(b)});a.tone=b[0];a.tone_buffer_=b[1];a.syncBarrierResolve(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".prop.syncBarrier() failed.");a.syncBarrierReject(b)})})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier() failed.");a.syncBarrierReject(b)})})};Object.defineProperty(b.prototype,"tone_buffer",{get:function(){return this.tone_buffer_},enumerable:!1,configurable:!0});
return b}(l.ProxyObject);a.DTMFToneChangeEvent=v;var p=function(a){function b(c,e){var g=a.call(this,c,h.class_id_t.RTCDTMFSender,e,l.ProxyMode.Remote)||this;d.logger.log(g.user_friendly_id()+".constructor");g.canInsertDTMF=!0;g.toneBuffer_="";return g}e(b,a);b.prototype.insertDTMF=function(a,b,c){var e=this;void 0===b&&(b=100);void 0===c&&(c=70);d.logger.log(this.user_friendly_id()+".insertDTMF() called, tones: "+a);this.waitUntilConnected("DtmfSender.insertDTMF").then(function(){return e.remoteInvoke(!1,
h.method_id_RTCDTMFSender_t.insertDTMF,a,b,c)}).then(function(){d.logger.log(e.user_friendly_id()+".insertDTMF() success, tones: "+a)})["catch"](function(a){e.logRemoteInvokeError(a,".insertDTMF() failed!")})};Object.defineProperty(b.prototype,"ontonechange",{get:function(){return this.ontonechange_},set:function(a){var b=this;d.logger.log(this.user_friendly_id()+".set_ontonechange() called.");this.ontonechange_=a;this.waitUntilConnected("DtmfSender.ontonechange").then(function(){var c=b.registerCallbacks(!1,
b.isNullCallback(a),h.method_id_RTCDTMFSender_t.ontonechange);c.then(function(a){d.logger.log(b.user_friendly_id()+".ontonechange callback received!");(new v(b,b.param0(a).oid)).syncBarrier().then(function(a){d.logger.log(b.user_friendly_id()+"tone: "+a.tone+" tone_buffer: "+a.tone_buffer);b.toneBuffer_=a.tone_buffer;b.ontonechange_(a)})["catch"](function(a){b.logRemoteInvokeError(a,".toneEvt.syncBarrier() failed!")})});return b.remoteInvoke(!0,h.method_id_RTCDTMFSender_t.ontonechange,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,
".set_ontonechange() failed!")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"toneBuffer",{get:function(){d.logger.log(this.user_friendly_id()+".toneBuffer() called.");return this.toneBuffer_},enumerable:!1,configurable:!0});return b}(l.ProxyObject);a.DtmfSender=p;var g=function(a){function b(c,e){var g=a.call(this,c,h.class_id_t.RTCIceTransport,e,l.ProxyMode.Remote)||this;d.logger.log(g.user_friendly_id()+".constructor");g.selectedPair=null;g.localCandidates_=[];g.remoteCandidates_=
[];return g}e(b,a);b.prototype.syncBarrier=function(){var a=this;d.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(c,e){a.syncBarrierDeep(c,e)&&a.waitUntilConnected("IceTransport.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,h.method_id_RTCIceTransport_t.role,0),a.remoteInvoke(!1,h.method_id_RTCIceTransport_t.component,0),a.remoteInvoke(!1,h.method_id_RTCIceTransport_t.state,0),a.remoteInvoke(!1,h.method_id_RTCIceTransport_t.gatheringState,
0)])}).then(function(c){d.logger.log(a.user_friendly_id()+".syncBarrier success.");var e=0,g=0;c=c.map(function(b){return a.param0(b)});a.role_=c[0];a.component_=c[1];e=c[2];g=c[3];a.state_=b.convertState(e);a.gatheringState_=b.convertGatheringState(g);a.syncBarrierResolve(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier() failed!");a.syncBarrierReject(b)})})};b.prototype.syncCandidates=function(){var a=this;d.logger.log(this.user_friendly_id()+".syncCandidates() called.");return new Promise(function(b,
c){a.waitUntilConnected("IceTransport.syncCandidates").then(function(){return Promise.all([a.remoteInvoke(!1,h.method_id_RTCIceTransport_t.localcandidates,[]),a.remoteInvoke(!1,h.method_id_RTCIceTransport_t.remotecandidates,[])])}).then(function(c){d.logger.log(a.user_friendly_id()+".syncCandidates success.");c=c.map(function(b){return a.param0(b)});a.localCandidates_=c[0];a.remoteCandidates_=c[1];b(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncCandidates() failed!");c(b)})})};Object.defineProperty(b.prototype,
"role",{get:function(){return this.role_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"component",{get:function(){return this.component_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"State",{get:function(){return this.state_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"gatheringState",{get:function(){return this.gatheringState_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onstatechange",{get:function(){return this.onstatechange_},
set:function(a){var c=this;d.logger.log(this.user_friendly_id()+".set_onstatechange() called.");this.onstatechange_=a;this.waitUntilConnected("IceTransport.onstatechange").then(function(){var e=c.registerCallbacks(!1,c.isNullCallback(a),h.method_id_RTCIceTransport_t.onstatechange);e.then(function(a){d.logger.log(c.user_friendly_id()+".onstatechange callback received!");c.syncCandidates().then(function(a){d.logger.log(c.user_friendly_id()+"received updated ice candidates!")});c.state_=b.convertState(c.param0(a));
d.logger.log(c.user_friendly_id()+"state: "+c.state_);c.onstatechange_()});return c.remoteInvoke(!0,h.method_id_RTCIceTransport_t.onstatechange,e.success)})["catch"](function(a){c.logRemoteInvokeError(a,".set_onstatechange failed!")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"ongatheringstatechange",{get:function(){return this.ongatheringstatechange_},set:function(a){var c=this;d.logger.log(this.user_friendly_id()+".set_ongatheringstatechange() called.");this.ongatheringstatechange_=
a;this.waitUntilConnected("IceTransport.ongatheringstatechange").then(function(){var e=c.registerCallbacks(!1,c.isNullCallback(a),h.method_id_RTCIceTransport_t.ongatheringstatechange);e.then(function(a){d.logger.log(c.user_friendly_id()+".ongatheringstatechange callback received!");c.syncCandidates().then(function(a){d.logger.log(c.user_friendly_id()+"received updated ice candidates!")});c.gatheringState_=b.convertGatheringState(c.param0(a));d.logger.log(c.user_friendly_id()+"gatheringState: "+c.gatheringState_);
c.ongatheringstatechange_()});return c.remoteInvoke(!0,h.method_id_RTCIceTransport_t.ongatheringstatechange,e.success)})["catch"](function(a){c.logRemoteInvokeError(a,".set_ongatheringstatechange failed!")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onselectedcandidatepairchange",{get:function(){return this.onselectedcandidatepairchange_},set:function(a){var b=this;d.logger.log(this.user_friendly_id()+".set_onselectedcandidatepairchange() called.");this.onselectedcandidatepairchange_=
a;this.waitUntilConnected("IceTransport.onselectedcandidatepairchange").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),h.method_id_RTCIceTransport_t.onselectedcandidatepairchange);c.then(function(a){d.logger.log(b.user_friendly_id()+".onselectedcandidatepairchange callback received!");b.syncCandidates().then(function(a){d.logger.log(b.user_friendly_id()+"received updated ice candidates!")});b.selectedPair=b.param0(a);d.logger.log(b.user_friendly_id()+"selectedPair: "+b.selectedPair);
b.onselectedcandidatepairchange_()});return b.remoteInvoke(!0,h.method_id_RTCIceTransport_t.onselectedcandidatepairchange,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".set_onselectedcandidatepairchange failed!")})},enumerable:!1,configurable:!0});b.prototype.getLocalCandidates=function(){return this.localCandidates_};b.prototype.getRemoteCandidates=function(){return this.remoteCandidates_};b.prototype.getLocalParameters=function(){return null};b.prototype.getRemoteParameters=function(){return null};
b.prototype.getSelectedCandidatePair=function(){return this.selectedPair};b.convertState=function(a){return 0==a?"new":1==a?"checking":2==a?"connected":3==a?"completed":4==a?"failed":5==a?"disconnected":"closed"};b.convertGatheringState=function(a){return 0==a?"new":1==a?"gathering":"complete"};return b}(l.ProxyObject);a.IceTransport=g;var B;(function(a){a[a["new"]=0]="new";a[a.connecting=1]="connecting";a[a.connected=2]="connected";a[a.closed=3]="closed";a[a.failed=4]="failed";a[a.max=5]="max"})(B||
(B={}));var t=function(a){function b(c,e){var g=a.call(this,c,h.class_id_t.RTCDtlsTransport,e,l.ProxyMode.Remote)||this;d.logger.log(g.user_friendly_id()+".constructor");g.state_="new";g.transport_=null;g.remoteCertificates_=[];return g}e(b,a);b.prototype.dumpInfo=function(){d.logger.log("DtlsTransport["+this.object_id()+"].dumpInfo():");d.logger.log("    - state:"+this.state_);d.logger.log("    - transport:"+this.transport_)};b.prototype.syncBarrier=function(){var a=this;d.logger.log(this.user_friendly_id()+
".syncBarrier() called.");return new Promise(function(c,e){a.syncBarrierDeep(c,e)&&a.waitUntilConnected("DtlsTransport.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,h.method_id_RTCDtlsTransport_t.transport,{}),a.remoteInvoke(!1,h.method_id_RTCDtlsTransport_t.state,0),a.remoteInvoke(!1,h.method_id_RTCDtlsTransport_t.getRemoteCertificates)])}).then(function(c){var e;d.logger.log(a.user_friendly_id()+".syncBarrier remote success.");var h;e=c.map(function(b){return a.param0(b)});
c=e[0];h=e[1];a.remoteCertificates_=e[2];a.state_=b.convertState(h);e=[];if(void 0!=c&&0==c.is_null){h=a.transport_;if(null===a.transport_||a.transport_.object_id()!=c.oid)h=new g(a,c.oid);e.push(h.syncBarrier())}else e.push(Promise.resolve(null));Promise.all(e).then(function(b){d.logger.log(a.user_friendly_id()+".syncBarrier success");a.transport_=b[0];a.syncBarrierResolve(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".prop.syncBarrier failed!");a.syncBarrierReject(b)})})["catch"](function(b){b=
a.logRemoteInvokeError(b,".syncBarrier failed!");a.syncBarrierReject(b)})})};Object.defineProperty(b.prototype,"transport",{get:function(){return this.transport_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"state",{get:function(){d.logger.log(this.user_friendly_id()+".get_state() called: "+this.state_);return this.state_},enumerable:!1,configurable:!0});b.prototype.getRemoteCertificates=function(){return this.remoteCertificates_};Object.defineProperty(b.prototype,"onstatechange",
{get:function(){return this.onstatechange_},set:function(a){var c=this;d.logger.log(this.user_friendly_id()+".set_onstatechange() called.");this.onstatechange_=a;this.waitUntilConnected("DtlsTransport.onstatechange").then(function(){var e=c.registerCallbacks(!1,c.isNullCallback(a),h.method_id_RTCDtlsTransport_t.onstatechange);e.then(function(a){d.logger.log(c.user_friendly_id()+".onstatechange callback received!");c.state_=b.convertState(c.param0(a));d.logger.log(c.user_friendly_id()+"state_: "+c.state_);
c.onstatechange_()});return c.remoteInvoke(!0,h.method_id_RTCDtlsTransport_t.onstatechange,e.success)})["catch"](function(a){c.logRemoteInvokeError(a,".set_onstatechange failed!")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onerror",{get:function(){return this.onerror_},set:function(a){var b=this;d.logger.log(this.user_friendly_id()+".set_onerror() called.");this.onerror_=a;this.waitUntilConnected("DtlsTransport.onerror").then(function(){var c=b.registerCallbacks(!1,b.isNullCallback(a),
h.method_id_RTCDtlsTransport_t.onerror);c.then(function(a){d.logger.log(b.user_friendly_id()+".onerror callback received!");a=b.param0(a);d.logger.log(b.user_friendly_id()+"error: "+a);b.onerror_(a)});return b.remoteInvoke(!0,h.method_id_RTCDtlsTransport_t.onerror,c.success)})["catch"](function(a){b.logRemoteInvokeError(a,".set_onerror failed!")})},enumerable:!1,configurable:!0});b.convertState=function(a){return a==B["new"]?"new":a==B.connecting?"connecting":a==B.connected?"connected":a==B.closed?
"closed":"failed"};return b}(l.ProxyObject);a.DtlsTransport=t;b=function(a){function b(c,e,g,h){c=a.call(this,c,e,g,h)||this;d.logger.log(c.user_friendly_id()+".constructor base");c.track_=null;c.transport_=null;return c}e(b,a);b.prototype.syncBarrierBase=function(){d.logger.log(this.user_friendly_id()+".syncBarrierBase() called.");var a=[],b,c;this instanceof m?(b=h.method_id_RTCRtpSender_t.track,c=h.method_id_RTCRtpSender_t.transport):this instanceof D&&(b=h.method_id_RTCRtpReceiver_t.track,c=h.method_id_RTCRtpReceiver_t.transport);
n.RemoteSession.isFeaturePstnSupported()&&n.RemoteSession.isFeatureDtmfSupported()?(a.push(this.remoteInvoke(!1,b,{oid:0})),a.push(this.remoteInvoke(!1,c,{oid:0}))):a.push(this.remoteInvoke(!1,b,{oid:0}));return a};b.prototype.syncBarrierBaseResults=function(a){var b,c=this;b=0;d.logger.log(this.user_friendly_id()+".syncBarrierBaseResults");var e;n.RemoteSession.isFeaturePstnSupported()&&n.RemoteSession.isFeatureDtmfSupported()?(b=a.map(function(a){return c.param0(a)}),a=b[0],e=b[1],b=2):(a=a.map(function(a){return c.param0(a)})[0],
b=1);var g=[];if(void 0!=a&&!1===a.is_null){var h=this.track_;null===this.track_||this.track_.object_id()!=a.oid?h=new w.RemoteMediaTrack(this,a.oid):this.track_.bind(this,a.oid);g.push(h.syncBarrier())}else g.push(Promise.resolve(null));if(void 0!=e&&!1===e.is_null){a=this.transport_;if(null===this.transport_||this.transport_.object_id()!=e.oid)a=new t(this,e.oid);g.push(a.syncBarrier())}else g.push(Promise.resolve(null));return[b,g]};b.prototype.syncBarrierBaseResultsWithAllPromisesFulFilled=function(a){this.track_=
a[0];this.transport_=a[1]};Object.defineProperty(b.prototype,"transport",{get:function(){d.logger.log(this.user_friendly_id()+".get transport() called.");return this.transport_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"rtcpTransport",{get:function(){d.logger.log(this.user_friendly_id()+".get rtcpTransport() called.");return this.transport_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"track",{get:function(){return this.track_},enumerable:!1,configurable:!0});
b.prototype.reinitTrack=function(a){this.track_=a};b.prototype.getStats=function(){d.logger.log(this.user_friendly_id()+".getStats() called.");var a=this;return new Promise(function(b,c){a.isRedirected()?a.waitUntilConnected("RtpReceiver.getStats").then(function(){if(n.RemoteSession.isFeatureSenderStatsFixSupported()){var d;a instanceof m?d=h.method_id_RTCRtpSender_t.getStats:a instanceof D&&(d=h.method_id_RTCRtpReceiver_t.getStats);var c=a.registerCallbacks(!0,!1,d);c.then(function(a){void 0===a.params||
0===a.params.length||0===a.params[0].length?b():b(q.StatsReport.fromJSON(JSON.parse(a.params[0])))});return a.remoteInvoke(!1,d,c.success)}b()})["catch"](function(b){b=a.logRemoteInvokeError(b,".getStats() failed!");c(b)}):(d.logger.log(a.user_friendly_id()+".getStats(): not in active redirection!"),b())})};return b}(l.ProxyObject);a.RtpSenderReceiver=b;var m=function(a){function b(c,e,g,m){c=a.call(this,c,h.class_id_t.RTCRtpSender,e,g)||this;d.logger.log(c.user_friendly_id()+".constructor");c.dtmf_=
null;c.params_=k.RtcRtpSendParameters.defRtcRtpSendParameters();c.unified_=m;return c}e(b,a);b.prototype.dumpInfo=function(){d.logger.log("RtpSender["+this.object_id()+"].dumpInfo():");this.track&&this.track.dumpInfo()};b.prototype.syncBarrier=function(){var b=this;d.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(c,e){b.syncBarrierDeep(c,e)&&b.waitUntilConnected("RtpSender.syncBarrier").then(function(){var c=a.prototype.syncBarrierBase.call(b);n.RemoteSession.isFeaturePstnSupported()&&
n.RemoteSession.isFeatureDtmfSupported()&&(c.push(b.remoteInvoke(!1,h.method_id_RTCRtpSender_t.dtmf,{oid:0})),c.push(b.remoteInvoke(!1,h.method_id_RTCRtpSender_t.getParameters)));return Promise.all(c)}).then(function(a){var c,e;c=b.syncBarrierBaseResults(a);e=c[0];c=c[1];a=a.slice(e).map(function(a){return b.param0(a)});e=a[0];b.params_=a[1];void 0==e||!1!==e.is_null||null!==b.dtmf_&&b.dtmf_.object_id()==e.oid||(b.dtmf_=new p(b,e.oid));Promise.all(c).then(function(a){b.syncBarrierBaseResultsWithAllPromisesFulFilled(a);
d.logger.log(b.user_friendly_id()+".syncBarrierBase success.");b.syncBarrierResolve(b)})["catch"](function(a){a=b.logRemoteInvokeError(a,".syncBarrier() promises_base failed!");b.syncBarrierReject(a)})})["catch"](function(a){a=b.logRemoteInvokeError(a,".syncBarrier failed!");b.syncBarrierReject(a)})})};b.getCapabilities=function(a){d.logger.log(this.constructor.name+".getCapabilities() called.");return w.NavigatorUserMedia.getCapabilities(a)};Object.defineProperty(b.prototype,"dtmf",{get:function(){d.logger.log(this.user_friendly_id()+
".get dtmf() called.");return this.dtmf_},enumerable:!1,configurable:!0});b.prototype.setParameters=function(a){return this.setParametersAsync(a)};b.prototype.setParametersAsync=function(a){var b=this;d.logger.log(this.user_friendly_id()+".setParametersAsync() called.");return new Promise(function(c,e){b.waitUntilConnected("RtpSender.setParametersAsync").then(function(){return Promise.all([b.remoteInvoke(!1,h.method_id_RTCRtpSender_t.setParameters,k.RtcRtpSendParameters.toRtcRtpSendParameters(a))])}).then(function(e){d.logger.log(b.user_friendly_id()+
".setParametersAsync(): success.");c();b.params_=k.RtcRtpSendParameters.toRtcRtpSendParameters(a)})["catch"](function(a){a=b.logRemoteInvokeError(a,".setParametersAsync() failed!");e(a)})})};b.prototype.getParameters=function(){d.logger.log(this.user_friendly_id()+".getParameters() called.");return this.getParametersInternal(!1)};b.prototype.getParametersAsync=function(){d.logger.log(this.user_friendly_id()+".getParametersAsync() called.");return this.getParametersInternal(!0)};b.prototype.getParametersInternal=
function(a){var b=this,c=new Promise(function(a,c){b.waitUntilConnected(b.user_friendly_id()+".getParametersInternal").then(function(){d.logger.log(b.user_friendly_id()+".getParametersInternal() remote invoking");return b.remoteInvoke(!1,h.method_id_RTCRtpSender_t.getParameters)}).then(function(c){b.params_=b.param0(c);d.logger.log(b.user_friendly_id()+".getParametersInternal() success returning: "+b.params_);a(k.RtcRtpSendParameters.toRTCRtpSendParameters(b.params_))})["catch"](function(a){a=b.logRemoteInvokeError(a,
".getParametersInternal() failed!");c(a)})});if(a)return c;d.logger.log(this.user_friendly_id()+".getParametersInternal() returning: "+this.params_);return k.RtcRtpSendParameters.toRTCRtpSendParameters(this.params_)};b.prototype.replaceTrack=function(a){var b=this;d.logger.log(this.user_friendly_id()+".replaceTrack() called. current track:"+(this.track_?this.track_.object_id():"null")+" with track="+(a?a.object_id():"null"));return new Promise(function(c,e){b.waitUntilConnected("RtpSender.replaceTrack").then(function(){return a||
n.RemoteSession.isFeatureWebrtc1dot0Supported()?a?b.remoteInvokeEx(!1,h.method_id_RTCRtpSender_t.replaceTrack,[a]):b.remoteInvoke(!1,h.method_id_RTCRtpSender_t.replaceTrack,{oid:-1}):Promise.reject(new DOMException("Does not support replace track with null in non-Unified SDP semantic!"))}).then(function(e){d.logger.log(b.user_friendly_id()+".replaceTrack(): success.");c();b.reinitTrack(a)})["catch"](function(a){a=b.logRemoteInvokeError(a,".replaceTrack() failed!");e(a)})})};return b}(b);a.RtpSender=
m;var D=function(a){function b(c,e,g,m,x){c=a.call(this,c,h.class_id_t.RTCRtpReceiver,e,g)||this;d.logger.log(c.user_friendly_id()+".constructor");c.contribsources_=[];c.syncsources_=[];c.params_=k.RtcRtpParameters.defRtcRtpParameters();c.unified_=m;x&&(c.track_=x);return c}e(b,a);b.prototype.dumpInfo=function(){d.logger.log("RtpReceiver["+this.object_id()+"].dumpInfo():");this.track&&this.track.dumpInfo();this.transport&&this.transport.dumpInfo()};b.prototype.syncBarrier=function(){var b=this;d.logger.log(this.user_friendly_id()+
".syncBarrier() called.");return new Promise(function(c,e){b.syncBarrierDeep(c,e)&&b.waitUntilConnected("RtpReceiver.syncBarrier").then(function(){var c=a.prototype.syncBarrierBase.call(b);n.RemoteSession.isFeaturePstnSupported()&&n.RemoteSession.isFeatureDtmfSupported()?(c.push(b.remoteInvoke(!1,h.method_id_RTCRtpReceiver_t.getContributingSources)),c.push(b.remoteInvoke(!1,h.method_id_RTCRtpReceiver_t.getSynchronizationSources)),c.push(b.remoteInvoke(!1,h.method_id_RTCRtpReceiver_t.getParameters))):
c.push(b.remoteInvoke(!1,h.method_id_RTCRtpReceiver_t.getContributingSources));return Promise.all(c)}).then(function(a){var c,e;c=b.syncBarrierBaseResults(a);e=c[0];c=c[1];a=a.slice(e).map(function(a){return b.param0(a)});b.contribsources_=a[0];b.syncsources_=a[1];b.params_=a[2];Promise.all(c).then(function(a){b.syncBarrierBaseResultsWithAllPromisesFulFilled(a);d.logger.log(b.user_friendly_id()+".syncBarrier success.");b.syncBarrierResolve(b)})["catch"](function(a){a=b.logRemoteInvokeError(a,".syncBarrier() promises_base failed!");
b.syncBarrierReject(a)})})["catch"](function(a){a=b.logRemoteInvokeError(a,".syncBarrier() failed!");b.syncBarrierReject(a)})})};b.getCapabilities=function(a){d.logger.log(this.constructor.name+".getCapabilities() called.");return w.NavigatorUserMedia.getCapabilities(a)};b.prototype.getContributingSources=function(){var a=this;d.logger.log(this.user_friendly_id()+".getContributingSources() called. "+JSON.stringify(this.contribsources_));this.waitUntilConnected("RtpReceiver.getContributingSources").then(function(){return Promise.all([a.remoteInvoke(!1,
h.method_id_RTCRtpReceiver_t.getContributingSources)])}).then(function(b){a.contribsources_=b.map(function(b){return a.param0(b)})[0];d.logger.log(a.user_friendly_id(),".getContributingSources() success: "+JSON.stringify(a.contribsources_))})["catch"](function(b){a.logRemoteInvokeError(b,".getContributingSources() failed!");a.contribsources_=[]});return this.contribsources_};b.prototype.getParameters=function(){var a=this;d.logger.log(this.user_friendly_id()+".getParameters() called.");this.waitUntilConnected(this.user_friendly_id()+
".getParameters").then(function(){d.logger.log(a.user_friendly_id()+".getParameters() remote invoking");return a.remoteInvoke(!1,h.method_id_RTCRtpReceiver_t.getParameters)}).then(function(b){d.logger.log(a.user_friendly_id()+".getParameters() success");a.params_=a.param0(b)})["catch"](function(b){a.logRemoteInvokeError(b,".getParameters() failed!")});d.logger.log(this.user_friendly_id()+".getParameters() returning: "+this.params_);return k.RtcRtpReceiveParameters.toRTCRtpReceiveParameters(this.params_)};
b.prototype.getSynchronizationSources=function(){d.logger.log(this.user_friendly_id()+".getSynchronizationSources() called.");return this.syncsources_};return b}(b);a.RtpReceiver=D},377:function(b,a,c){var e=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===
c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(a,"__esModule",{value:!0});a.RtpTransceiver=a.RtcRtpTransceiverInit=a.RtcRtpTransceiverDirection=void 0;var l=c(658),h=c(550),d=c(851),w=c(589),q=c(484),n;(function(a){a[a.sendrecv=0]="sendrecv";a[a.sendonly=1]="sendonly";a[a.recvonly=2]="recvonly";a[a.inactive=3]="inactive";a[a.stopped=4]="stopped"})(n=a.RtcRtpTransceiverDirection||(a.RtcRtpTransceiverDirection={}));var k=function(){function a(){}a.toRtcRtpTransceiverDirection=
function(a){switch(a){case "inactive":a=n.inactive;break;case "recvonly":a=n.recvonly;break;case "sendonly":a=n.sendonly;break;case "sendrecv":a=n.sendrecv;break;case "stopped":a=n.stopped;break;default:a=n.sendrecv}return a};a.toRTCRtpTransceiverDirection=function(a){switch(a){case n.inactive:a="inactive";break;case n.recvonly:a="recvonly";break;case n.sendonly:a="sendonly";break;case n.sendrecv:a="sendrecv";break;case n.stopped:a="stopped";break;default:a="sendrecv"}return a};a.toRtcRtpTransceiverInit=
function(b){d.logger.log("RtcRtpTransceiverInit.toRtcRtpTransceiverInit() in init:"+JSON.stringify(b));var c={};b&&(b.direction&&(c.direction=a.toRtcRtpTransceiverDirection(b.direction)),b.sendEncodings&&(c.sendEncodings=[],b.sendEncodings.forEach(function(a){return c.sendEncodings.push(q.RtcRtpEncodingParameters.toRtcRtpEncodingParameters(a))})),b.streams&&(c.streams=b.streams));d.logger.log("RtcRtpTransceiverInit.toRtcRtpTransceiverInit() out init:"+JSON.stringify(c));return c};return a}();a.RtcRtpTransceiverInit=
k;b=function(a){function b(c,e,k,m,q,y){c=a.call(this,c,h.class_id_t.RTCRtpTransceiver,e,k)||this;d.logger.log(c.user_friendly_id()+".constructor");c.unified_=m;c.sender_=new w.RtpSender(c,0,l.ProxyMode.Pseudo,m);c.receiver_=y?y:new w.RtpReceiver(c,0,l.ProxyMode.Pseudo,m);q?(c.direction_=q,c.currentDirection_=q):(c.direction_=n.sendrecv,c.currentDirection_=n.sendrecv);return c}e(b,a);b.prototype.dumpInfo=function(){d.logger.log(this.user_friendly_id()+".dumpInfo() [id="+this.mid+"] direction="+k.toRTCRtpTransceiverDirection(this.direction_)+
" currentDirection="+k.toRTCRtpTransceiverDirection(this.currentDirection_));this.sender&&this.sender.dumpInfo();this.receiver&&this.receiver.dumpInfo()};b.prototype.syncBarrier=function(){var a=this;d.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.syncBarrierDeep(b,c)&&a.waitUntilConnected("RtpTransceiver.syncBarrier").then(function(){return Promise.all([a.remoteInvoke(!1,h.method_id_RTCRtpTransceiver_t.mid,""),a.remoteInvoke(!1,h.method_id_RTCRtpTransceiver_t.direction,
0),a.remoteInvoke(!1,h.method_id_RTCRtpTransceiver_t.currentDirection,0),a.remoteInvoke(!1,h.method_id_RTCRtpTransceiver_t.sender,{oid:0}),a.remoteInvoke(!1,h.method_id_RTCRtpTransceiver_t.receiver,{oid:0})])}).then(function(b){var c;d.logger.log(a.user_friendly_id()+".syncBarrier remote success.");c=b.map(function(b){return a.param0(b)});a.mid_=c[0];a.direction_=c[1];a.currentDirection_=c[2];b=c[3];c=c[4];var e=[];void 0!=b&&!1===b.is_null&&(a.sender_.bind(a,b.oid),e.push(a.sender_.syncBarrier()));
void 0!=c&&!1===c.is_null&&(a.receiver_.bind(a,c.oid),e.push(a.receiver_.syncBarrier()));if(0==e.length)d.logger.log(a.user_friendly_id()+".syncBarrier success"),a.syncBarrierResolve(a);else return d.logger.log(a.user_friendly_id()+".prop.syncBarrier start"),Promise.all(e)}).then(function(){d.logger.log(a.user_friendly_id()+".syncBarrier success");a.syncBarrierResolve(a)})["catch"](function(b){b=a.logRemoteInvokeError(b,".syncBarrier() failed!");a.syncBarrierReject(b)})})};Object.defineProperty(b.prototype,
"mid",{get:function(){d.logger.log(this.user_friendly_id()+".get_mid() called: "+this.mid_);return this.mid_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"sender",{get:function(){return this.sender_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"receiver",{get:function(){return this.receiver_},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"direction",{get:function(){d.logger.log(this.user_friendly_id()+".get_direction() called. "+k.toRTCRtpTransceiverDirection(this.direction_));
return k.toRTCRtpTransceiverDirection(this.direction_)},set:function(a){var b=this;d.logger.log(this.user_friendly_id()+".set_direction() called. "+a);this.direction_=k.toRtcRtpTransceiverDirection(a);this.waitUntilConnected("RtpTransceiver.set_direction").then(function(){return b.remoteInvoke(!0,h.method_id_RTCRtpTransceiver_t.direction,k.toRtcRtpTransceiverDirection(a))}).then(function(){d.logger.log(b.user_friendly_id()+".set_direction: success.")})["catch"](function(a){b.logRemoteInvokeError(a,
".set_direction() failed!")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"currentDirection",{get:function(){d.logger.log(this.user_friendly_id()+".get_currentDirection() called. "+k.toRTCRtpTransceiverDirection(this.currentDirection_));return k.toRTCRtpTransceiverDirection(this.currentDirection_)},enumerable:!1,configurable:!0});b.prototype.stop=function(){var a=this;d.logger.log(this.user_friendly_id()+".stop() called.");this.waitUntilConnected("RtpTransceiver.stop").then(function(){return a.remoteInvoke(!0,
h.method_id_RTCRtpTransceiver_t.stop)}).then(function(){d.logger.log(a.user_friendly_id()+".stop: success.")})["catch"](function(b){a.logRemoteInvokeError(b,".stop() failed!")})};b.prototype.setCodecPreferences=function(a){var b=this;d.logger.log(this.user_friendly_id()+".setCodecPreferences() called.");this.waitUntilConnected("RtpTransceiver.setCodecPreferences").then(function(){return b.remoteInvoke(!0,h.method_id_RTCRtpTransceiver_t.setCodecPreferences,a)}).then(function(){d.logger.log(b.user_friendly_id()+
".setCodecPreferences: success.")})["catch"](function(a){b.logRemoteInvokeError(a,".setCodecPreferences() failed!")})};return b}(l.ProxyObject);a.RtpTransceiver=b},973:function(b,a,c){function e(a,b){return void 0!==a.find(function(a){return a===b})}function l(a,b,c){b/=a.width;c/=a.height;var d=document.createElement("canvas"),e=d.getContext("2d");d.width=a.width*b;d.height=a.height*c;e.putImageData(a,0,0);if(1!=b||1!=c)e.scale(b,c),e.drawImage(d,0,0);return d}function h(a,b,c){a=l(a,b,c);b=document.createElement("img");
b.src=a.toDataURL();return b}function d(a,b,c,d){c="undefined"!==typeof c?c:D.Width;d="undefined"!==typeof d?d:D.Height;if(!0===b)return h(a,c,d);b=null;c==a.width&&d===a.height?b=a:(a=l(a,c,d),b=a.getContext("2d").getImageData(0,0,a.width,a.height));return b}var w=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,
c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(a,"__esModule",{value:!0});a.ScreenSource=a.ScreenSourceVda=a.ScreenSharingVda=a.ScreenSharingRemote=a.ScreenSharing=a.ImageDataRemote=void 0;var q=c(658),n=c(550),k=c(851),p=c(946),z=c(691),g=c(650),B;(function(a){a[a.Legacy=0]="Legacy";a[a.MonitorsAndApps=10]="MonitorsAndApps"})(B||(B={}));b=function(){return function(a,b,c){this.data=a;this.height=b;this.width=
c}}();a.ImageDataRemote=b;b=function(){function a(){this.local_=this.remote_=null}a.screenSharingInstance=function(b){a.instance||(a.instance=new a,b&&(a.instance.onscreentopologychanged=b));return a.instance};a.destroyInstance=function(){a.instance&&a.instance.remote_&&a.instance.remote_.release();a.instance=null};a.prototype.user_friendly_id=function(){return this.constructor.name+"[]"};Object.defineProperty(a.prototype,"onscreentopologychanged",{set:function(a){this.remote_||(this.remote_=new t);
this.remote_.onscreentopologychanged=a;this.local_||(this.local_=new m);this.local_.onscreentopologychanged=a},enumerable:!1,configurable:!0});a.prototype.getWindowsAsync=function(){var a=this;k.logger.log(this.user_friendly_id()+".getWindowsAsync() called.");null==this.local_&&(this.local_=new m);return new Promise(function(b,c){var d=[];a.local_.getWindowsAsync().then(function(c){c&&(d=c);k.logger.log(a.user_friendly_id()+".getWindowsAsync() returning sources");b(d)})["catch"](function(){k.logger.log("ScreenSharing.getWindowsAsync(): rejected");
b(d)})})};a.prototype.getScreensAsync=function(){var a=this;k.logger.log(this.user_friendly_id()+".getScreensAsync() called.");null==this.remote_&&(this.remote_=new t);return new Promise(function(b,c){var d=[];a.remote_.getScreensAsync().then(function(c){c&&(d=c);k.logger.log(a.user_friendly_id()+".getScreensAsync() returning sources");b(d)})["catch"](function(){k.logger.log("ScreenSharing.getScreensAsync(): rejected");b(d)})})};a.prototype.setActiveSource=function(a,b){var c=this;k.logger.log(this.user_friendly_id()+
".setActiveSource() called. id="+a+" appshare="+b);return new Promise(function(d,e){c.remote_.contains(a)?c.remote_.setActive(a).then(function(a){d(a)})["catch"](function(){k.logger.log("ScreenSharing.setActiveSource(): rejected");e()}):b?c.local_.contains(a)?c.local_.setActive(!0,a).then(function(a){d(a)})["catch"](function(){k.logger.log("ScreenSharing.setActiveSource(): rejected");e()}):(k.logger.log("ScreenSharing.setActiveSource(): legacy screen sharing"),d("")):(k.logger.log("ScreenSharing.setActiveSource(): legacy screen sharing"),
d(""))})};a.prototype.isAppshareActive=function(){return this.local_&&-1!==this.local_.lastActive};a.prototype.stopAppshare=function(){k.logger.log(this.user_friendly_id()+".stopAppshare() called.");this.local_&&this.local_.setActive(!1).then(function(a){k.logger.log("ScreenSharing.stopAppshare(): success, deviceid=",a)})["catch"](function(){k.logger.log("ScreenSharing.stopAppshare(): failure or timeout due to nonresponsive WS Agent")})};a.instance=null;return a}();a.ScreenSharing=b;var t=function(a){function b(){var c=
a.call(this,null,n.class_id_t.ScreenSharingRemote,0,q.ProxyMode.Local)||this;k.logger.log(c.user_friendly_id()+".constructor");c.sources_=[];return c}w(b,a);b.prototype.getSourceById=function(a){return this.sources_.find(function(b){return b.getId()==a})};b.prototype.contains=function(a){return void 0!==this.getSourceById(a)};Object.defineProperty(b.prototype,"onscreentopologychanged",{get:function(){return this.onscreentopologychanged_},set:function(a){var b=this;this.onscreentopologychanged_=a;
this.waitUntilConnected(this.user_friendly_id()+".onscreentopologychanged").then(function(){var a=b.registerCallbacks(!1,b.isNullCallback(b.onscreentopologychanged_),n.method_id_VDISharingRemote_t.onscreentopologychanged);a.then(function(){k.logger.log(b.user_friendly_id()+"onscreentopologychanged event received!!!");b.onscreentopologychanged_&&b.onscreentopologychanged_()});return b.remoteInvoke(!0,n.method_id_VDISharingRemote_t.onscreentopologychanged,a.success)})["catch"](function(a){b.logRemoteInvokeError(a,
".set_onscreentopologychanged() failed!")})},enumerable:!1,configurable:!0});b.prototype.getScreensAsync=function(){var a=this;k.logger.log(this.user_friendly_id()+".getScreensAsync() called.");var b=this.sources_;this.sources_=[];var c=p.getRedirector().vdabufferNoLimit()&&g.RemoteSession.isFeatureVdNoBufferLimitSupported();return new Promise(function(d,g){a.waitUntilConnected(a.user_friendly_id()+".getScreensAsync").then(function(){return a.remoteInvoke(!1,n.method_id_VDISharingRemote_t.getScreensAsync,
c)}).then(function(c){var h=[];c.params[0].forEach(function(c){var d=b.find(function(a){return a.object_id()===c.oid});void 0===d&&(k.logger.log(a.user_friendly_id()+" create a ScreenSource with oid:"+c.oid),d=new y(a,c.oid,q.ProxyMode.Remote));h.push(d.syncBarrier())});Promise.all(h.map(function(a){return a.then(function(a){return{value:a,status:"fulfilled"}},function(a){return{value:a,status:"rejected"}})})).then(function(c){var g=c.filter(function(a){return"fulfilled"===a.status}).map(function(a){return a.value});
a.sources_=g;b.filter(function(a){return!e(g,a)}).forEach(function(a){return a.release()});d(g)})["catch"](function(c){c=a.logRemoteInvokeError(c,".getScreensAsync() failed!");b.forEach(function(a){a.release()});g(c)})})["catch"](function(c){c=a.logRemoteInvokeError(c,".getScreensAsync() failed!");b.forEach(function(a){a.release()});g(c)})})};b.prototype.setActive=function(a){var b=this;k.logger.log(this.user_friendly_id()+".setActive() called. uniqueid="+a);return new Promise(function(c,d){-1!=a?
c(b.getSourceById(a).getDeviceId()):d()})};return b}(q.ProxyObject);a.ScreenSharingRemote=t;var m=function(){function a(){k.logger.log(this.user_friendly_id()+".constructor");this.sources_=[];this.lastactive_=-1}a.prototype.user_friendly_id=function(){return this.constructor.name+"[]"};Object.defineProperty(a.prototype,"onscreentopologychanged",{set:function(a){p.getRedirector().screenshare.setTopologyChangeCB(a)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"lastActive",{get:function(){return this.lastactive_},
enumerable:!1,configurable:!0});a.prototype.getSourceById=function(a){return this.sources_.find(function(b){return b.getId()==a})};a.prototype.contains=function(a){return void 0!==this.getSourceById(a)};a.prototype.getWindowsAsync=function(){var a=this;k.logger.log(this.user_friendly_id()+".getWindowsAsync() called.");var b=this.sources_;this.sources_=[];return new Promise(function(c,d){p.getRedirector().screenshare.getSources(new z.getSourcesReqData(2)).then(function(d){d=d.map(function(c){var d=
b.find(function(a){return a.equivalent(c)});return void 0!==d?(d.setDescription(c.getDescription()),c.getIcon().then(function(a){d.setIcon(a)})["catch"](function(){k.logger.log(a.user_friendly_id()+".getWindowsAsync() failed to retrieve new icon.")}),c.getPreviewAsync().then(function(a){d.setPreview(a)})["catch"](function(){k.logger.log(a.user_friendly_id()+".getWindowsAsync() failed to retrieve new preview.")}),d):c});if(-1!=a.lastactive_){var e=b.find(function(b){return b.getId()==a.lastactive_}),
g=d.find(function(b){return b.getId()==a.lastactive_});void 0!==e&&void 0===g&&d.push(e)}a.sources_=d;c(a.sources_)})["catch"](function(){k.logger.log(a.user_friendly_id()+".getWindowsAsync(): rejected");d()})})};a.prototype.activateSource=function(a,b){var c=this;return new Promise(function(d,e){var g=b?"activate":"deactivate";k.logger.log(c.user_friendly_id()+".activateSource() called. action="+g);var h=new z.setActiveReqData(a.srcid,a.hwnd,a.origin,a.pid,!0,!0,b);p.getRedirector().screenshare.setActive(h).then(function(b){k.logger.log(c.user_friendly_id()+
": "+g+" success: srcid="+b.srcid+" deviceid="+b.bufferid);a.deviceid=b.bufferid;d(b.bufferid)})["catch"](function(){k.logger.log(c.user_friendly_id()+"failed to "+g+": srcid="+a.srcid+", maybe WS Agent is too slow to respond");e()})})};a.prototype.setActive=function(a,b){var c=this;k.logger.log(this.user_friendly_id()+".setActive() called. uniqueid="+b);return new Promise(function(d,e){a||(b=c.lastactive_);-1!=b?(a?(b!=c.lastactive_&&-1!=c.lastactive_&&c.activateSource(c.getSourceById(c.lastactive_),
!1),c.lastactive_=b):c.lastactive_=-1,c.activateSource(c.getSourceById(b),a).then(function(b){d(a?"RemoteApplication-"+b:b)})["catch"](function(){e()})):e()})};return a}();a.ScreenSharingVda=m;var D=function(){function a(){}a.Width=140;a.Height=90;return a}();b=function(){function a(b,c,d,e,g,h,k,m,n,l){this.uniqueid_=y.nextId_++;this.srcid_=b;this.deviceid_=c;this.type_=d;this.imagedata_=e;this.icon_=g;this.name_=h;this.hwnd_=k;this.origin_=m;this.caption_=n;this.pid_=l}a.prototype.user_friendly_id=
function(){return this.constructor.name+"["+this.uniqueid_+"]"};Object.defineProperty(a.prototype,"srcid",{get:function(){return this.srcid_},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"hwnd",{get:function(){return this.hwnd_},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"origin",{get:function(){return this.origin_},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"pid",{get:function(){return this.pid_},enumerable:!1,configurable:!0});a.prototype.getId=
function(){return this.uniqueid_};a.prototype.getDeviceId=function(){return this.deviceid_};Object.defineProperty(a.prototype,"deviceid",{set:function(a){this.deviceid_=a},enumerable:!1,configurable:!0});a.prototype.getType=function(){return 2};a.prototype.getPreview=function(a,b,c){k.logger.log(this.user_friendly_id()+".getPreview() called, width:"+a+" height:"+b+" asImage:"+c);return Promise.reject(null)};a.prototype.setPreview=function(a){this.imagedata_=a};a.prototype.getPreviewAsync=function(a,
b,c){k.logger.log(this.user_friendly_id()+".getPreviewAsync() called, width:"+a+" height:"+b);return!0===c?(a=h(this.imagedata_,D.Width,D.Height),Promise.resolve({data:a.src.replace(/^data:image\/(png|jpg);base64,/,"")})):Promise.resolve(this.imagedata_)};a.prototype.getPreviewImage=function(a,b,c){k.logger.log(this.user_friendly_id()+".getPreviewImage() called, width:"+b+" height:"+c);return Promise.resolve(d(this.imagedata_,a,b,c))};a.prototype.getDescription=function(){return this.name_};a.prototype.setDescription=
function(a){this.name_=a};a.prototype.getIcon=function(a,b,c){return!0===c?(a=h(this.icon_,D.Width,D.Height),Promise.resolve({data:a.src.replace(/^data:image\/(png|jpg);base64,/,"")})):Promise.resolve(this.icon_)};a.prototype.getIconImage=function(a,b,c){k.logger.log(this.user_friendly_id()+".getIconImage() called, width:"+b+" height:"+c);return Promise.resolve(d(this.icon_,a,"undefined"!==typeof b?b:this.icon_.width,"undefined"!==typeof c?c:this.icon_.height))};a.prototype.setIcon=function(a){this.icon_=
a};a.prototype.getBounds=function(){return{x:0,y:0,width:0,height:0}};a.prototype.equivalent=function(a){return this.pid_===a.pid_&&this.hwnd_===a.hwnd_};return a}();a.ScreenSourceVda=b;var y=function(a){function b(c,d,e){c=a.call(this,c,n.class_id_t.ScreenSource,d,e)||this;c.screenshare_=new z.ScreenShareUtil;c.uniqueid_=b.nextId_++;k.logger.log(c.user_friendly_id()+".constructor");return c}w(b,a);b.prototype.user_friendly_id=function(){return this.constructor.name+"["+this.uniqueid_+"]"};b.prototype.toJSImageData=
function(a){var b=atob(a.data.toString()),b=this.screenshare_.str2ab(b),b=new Uint8ClampedArray(b,0,b.byteLength);this.imagedata_=new ImageData(b,a.width,a.height)};b.prototype.syncBarrier=function(){var a=this;k.logger.log(this.user_friendly_id()+".syncBarrier() called.");return new Promise(function(b,c){a.syncBarrierDeep(b,c)&&a.waitUntilConnected(a.user_friendly_id()+".syncBarrier").then(function(){Promise.all([a.remoteInvoke(!1,n.method_id_ScreenSource_t.srcid,0),a.remoteInvoke(!1,n.method_id_ScreenSource_t.deviceid,
""),a.remoteInvoke(!1,n.method_id_ScreenSource_t.type,0),a.remoteInvoke(!1,n.method_id_ScreenSource_t.name,""),a.remoteInvoke(!1,n.method_id_ScreenSource_t.imagedata),a.remoteInvoke(!1,n.method_id_ScreenSource_t.hwnd,""),a.remoteInvoke(!1,n.method_id_ScreenSource_t.origin,0),a.remoteInvoke(!1,n.method_id_ScreenSource_t.caption,""),a.remoteInvoke(!1,n.method_id_ScreenSource_t.pid,0)]).then(function(b){k.logger.log(a.user_friendly_id()+".syncBarrier(): success.");var c;b=b.map(function(b){return a.param0(b)});
a.srcid_=b[0];a.deviceid_=b[1];a.type_=b[2];a.name_=b[3];c=b[4];a.hwnd_=b[5];a.origin_=b[6];a.caption_=b[7];a.pid_=b[8];a.toJSImageData(c);a.remoteInvoke(!1,n.method_id_ScreenSource_t.bounds,0).then(function(b){a.bounds_=a.param0(b);a.syncBarrierResolve(a)})["catch"](function(b){a.bounds_=void 0;b=a.logRemoteInvokeError(b,".prop.syncBarrier() getBounds failed.");a.syncBarrierReject(b)})})["catch"](function(b){b=a.logRemoteInvokeError(b,".prop.syncBarrier() failed.");a.syncBarrierReject(b)})})["catch"](function(b){b=
a.logRemoteInvokeError(b,".syncBarrier() failed.");a.syncBarrierReject(b)})})};b.prototype.getId=function(){return this.uniqueid_};b.prototype.getDeviceId=function(){return this.deviceid_};b.prototype.getType=function(){return 1};b.prototype.getPreview=function(a,b,c){k.logger.log(this.user_friendly_id()+".getPreview() called, width:"+a+" height:"+b+" asImage:"+c);return Promise.reject(null)};b.prototype.getPreviewAsync=function(a,b,c){k.logger.log(this.user_friendly_id()+".getPreviewAsync() called, width:"+
a+" height:"+b);return!0===c?(a=h(this.imagedata_,D.Width,D.Height),Promise.resolve({data:a.src.replace(/^data:image\/(png|jpg);base64,/,"")})):Promise.resolve(this.imagedata_)};b.prototype.getPreviewImage=function(a,b,c){k.logger.log(this.user_friendly_id()+".getPreviewImage() called, width:"+b+" height:"+c);return Promise.resolve(d(this.imagedata_,a,b,c))};b.prototype.getDescription=function(){return this.name_};b.prototype.getIcon=function(a,b){return Promise.resolve(this.imagedata_)};b.prototype.getBounds=
function(){return this.bounds_||{x:0,y:0,width:0,height:0}};b.nextId_=B.MonitorsAndApps;return b}(q.ProxyObject);a.ScreenSource=y},691:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.ScreenShareUtil=a.Bitmap=a.BitmapInfoHeader=a.BitmapFileHeader=a.setActiveRespData=a.setActiveReqData=a.getSourcesReqData=a.sshare_state=a.sshare_cmd=void 0;var e=c(946),l=c(973),h=c(851),d;(function(a){a[a.Unknown=0]="Unknown";a[a.Cap=1]="Cap";a[a.GetSources=2]="GetSources";a[a.SetActive=3]="SetActive";
a[a.TopologyChanged=4]="TopologyChanged"})(d=a.sshare_cmd||(a.sshare_cmd={}));var w;(function(a){a[a.Unknown=0]="Unknown";a[a.Initialized=1]="Initialized";a[a.Error=2]="Error"})(w=a.sshare_state||(a.sshare_state={}));b=function(){return function(a){this.origin=a}}();a.getSourcesReqData=b;b=function(){return function(a,b,c,d,e,h,k){this.srcid=a;this.hwnd=b;this.origin=c;this.pid=d;this.border=e;this.cursor=h;this.activate=k}}();a.setActiveReqData=b;var q=function(){return function(a,b,c){this.srcid=
a;this.origin=b;this.bufferid=c}}();a.setActiveRespData=q;var n=function(){function a(b,c,d,e,g){this.id_=b;this.resolve_=c;this.reject_=d;this.cmd_=e;this.data_=g;this.sent_=!1;this.timeoutId=void 0}a.prototype.user_friendly_id=function(){return this.constructor.name+"["+this.id_+"]"};a.prototype.cmdString=function(){return this.cmd_==d.Cap?"Cap":this.cmd_==d.GetSources?"GetSources":this.cmd_==d.SetActive?"SetActive":"Unknown"};return a}(),k=function(){return function(){}}();a.BitmapFileHeader=k;
var p=function(){return function(){}}();a.BitmapInfoHeader=p;var z=function(){return function(){}}();a.Bitmap=z;b=function(){function a(){this.cmdque_=[]}a.prototype.reqid=function(){return a.nextId++};a.prototype.user_friendly_id=function(){return this.constructor.name+"[]"};a.prototype.stateString=function(){return a.state_==w.Initialized?"Initialized":a.state_==w.Error?"Error":"Unknown"};a.prototype.reset=function(){a.state_=w.Unknown;this.cmdque_=[]};a.prototype.dispatchCmds=function(){var b=
this;a.state_==w.Initialized?this.cmdque_.forEach(function(a){0==a.sent_&&(a.cmd_==d.GetSources?(b.WSSendGetSources(a.id_,a.data_),a.sent_=!0,a.timeoutId=setTimeout(b.abortCmd.bind(b,a.id_),5E3)):a.cmd_==d.SetActive?(b.WSSendSetActive(a.id_,a.data_),a.sent_=!0,a.timeoutId=setTimeout(b.abortCmd.bind(b,a.id_),5E3)):h.logger.log(a.user_friendly_id()+".dispatchCmds(): invalid cmd: "+a.cmdString()))}):a.state_==w.Error?(this.cmdque_.forEach(function(a){h.logger.log(a.user_friendly_id()+".dispatchCmds(): purging cmd: "+
a.cmdString());a.reject_()}),this.cmdque_=[]):h.logger.log(this.user_friendly_id()+".dispatchCmds(): invalid state: "+this.stateString())};a.prototype.abortCmd=function(a){var b=this.cmdque_.findIndex(function(b){return b.id_===a});-1!==b?(b=this.cmdque_.splice(b,1)[0],h.logger.log(b.user_friendly_id()+NaN+b.cmdString()+"]: aborted due to nonresponsive WS Agent!"),b.cmd_===d.SetActive&&b.data_.activate&&l.ScreenSharing.screenSharingInstance().stopAppshare(),b.reject_()):h.logger.log(this.user_friendly_id()+
".abortCmd(): Cmd not found!")};a.prototype.finalizeCmd=function(a,b,c){for(var d=0;d<this.cmdque_.length;d++){var e=this.cmdque_[d];if(void 0!=b&&b==e.id_&&1==e.sent_||void 0==b&&1==e.sent_){clearTimeout(e.timeoutId);h.logger.log(e.user_friendly_id()+".finalizeCmd(): purging cmd: "+e.cmdString());a?void 0!=c?e.resolve_(c):e.resolve_():e.reject_();this.cmdque_.splice(d,1);break}}};a.prototype.onInitialized=function(b){h.logger.log(this.user_friendly_id()+".onInitialized(): init: "+b+" state:"+this.stateString());
a.state_!=w.Initialized&&(a.state_=b?w.Initialized:w.Error);this.dispatchCmds()};a.prototype.onInitComplete=function(){h.logger.log(this.user_friendly_id()+".onInitComplete(): state:"+this.stateString());a.state_==w.Unknown&&(a.state_=w.Error,h.logger.log(this.user_friendly_id()+".onInitComplete(): items in queue:"+this.cmdque_.length),this.dispatchCmds())};a.prototype.onError=function(b){h.logger.log(this.user_friendly_id()+".onError(): state: "+this.stateString());a.state_==w.Unknown?(a.state_=
w.Error,this.dispatchCmds()):a.state_==w.Initialized&&this.finalizeCmd(!1,b)};a.prototype.ab2str=function(a){return String.fromCharCode.apply(null,new Uint8Array(a))};a.prototype.str2ab=function(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0,e=a.length;d<e;d++)c[d]=a.charCodeAt(d);return b};a.prototype.getBMP=function(a){var b=new DataView(a),c=new z;c.fileheader=new k;c.fileheader.bfType=b.getUint16(0,!0);c.fileheader.bfSize=b.getUint32(2,!0);c.fileheader.bfReserved1=b.getUint16(6,
!0);c.fileheader.bfReserved2=b.getUint16(8,!0);c.fileheader.bfOffBits=b.getUint32(10,!0);c.infoheader=new p;c.infoheader.biSize=b.getUint32(14,!0);c.infoheader.biWidth=b.getUint32(18,!0);c.infoheader.biHeight=b.getUint32(22,!0);c.infoheader.biPlanes=b.getUint16(26,!0);c.infoheader.biBitCount=b.getUint16(28,!0);c.infoheader.biCompression=b.getUint32(30,!0);c.infoheader.biSizeImage=b.getUint32(34,!0);c.infoheader.biXPelsPerMeter=b.getUint32(38,!0);c.infoheader.biYPelsPerMeter=b.getUint32(42,!0);c.infoheader.biClrUsed=
b.getUint32(46,!0);c.infoheader.biClrImportant=b.getUint32(50,!0);b=c.fileheader.bfOffBits;c.stride=4*Math.floor((c.infoheader.biBitCount*c.infoheader.biWidth+31)/32);c.pixels=new Uint8Array(a,b);return c};a.prototype.convertToImageData=function(a){var b=document.createElement("canvas").getContext("2d"),c=a.infoheader.biWidth,d=a.infoheader.biHeight,b=b.createImageData(c,d),e=b.data,g=a.pixels;a=a.stride;for(var h=0;h<d;++h)for(var k=0;k<c;++k){var l=4*(k+c*(d-h)),n=4*k+a*h;e[l]=g[n+2];e[l+1]=g[n+
1];e[l+2]=g[n];e[l+3]=255}return b};a.prototype.onGetSources=function(a,b){this.sources_=[];var c=this;b.sources.forEach(function(a){var b=a.image,d=atob(b.data),d=c.str2ab(d),d=new Uint8ClampedArray(d,0,d.byteLength),b=new ImageData(d,b.width,b.height),d=a.icon,e=atob(d.data),e=c.str2ab(e),e=new Uint8ClampedArray(e,0,e.byteLength),d=new ImageData(e,d.width,d.height);a=new l.ScreenSourceVda(a.srcid,a.devicdid,a.type,b,d,a.name,a.hwnd,a.origin,a.caption,a.pid);c.sources_.push(a)});this.finalizeCmd(!0,
a,this.sources_)};a.prototype.getSources=function(b){var c=this;return new Promise(function(e,h){if(a.state_!=w.Error){var k=new n(c.reqid(),e,h,d.GetSources,b);c.cmdque_.push(k)}else h();a.state_==w.Initialized&&c.dispatchCmds()})};a.prototype.onSetActive=function(a,b){var c=new q(b.srcid,b.origin,b.bufferid);this.finalizeCmd(!0,a,c)};a.prototype.setActive=function(b){var c=this;return new Promise(function(e,h){if(a.state_!=w.Error){var k=new n(c.reqid(),e,h,d.SetActive,b);c.cmdque_.push(k)}else h();
a.state_==w.Initialized&&c.dispatchCmds()})};a.prototype.setTopologyChangeCB=function(a){this.onwindowtopologychanged_=a};a.prototype.onToplogyChanged=function(){if(this.onwindowtopologychanged_)this.onwindowtopologychanged_()};a.prototype.WSSendGetSources=function(a,b){try{e.getRedirector().WSSendObject({v:"appsharing",hdr:{command:d.GetSources,id:a},data:{origin:b.origin}})}catch(c){h.logger.log(c)}};a.prototype.WSSendSetActive=function(a,b){try{e.getRedirector().WSSendObject({v:"appsharing",hdr:{command:d.SetActive,
id:a},data:{srcid:b.srcid,hwnd:b.hwnd,origin:b.origin,pid:b.pid,border:b.border,cursor:b.cursor,activate:b.activate}})}catch(c){h.logger.log(c)}};a.state_=w.Unknown;a.nextId=0;return a}();a.ScreenShareUtil=b},517:function(b,a){Object.defineProperty(a,"__esModule",{value:!0});a.Stats=a.StatsReport=void 0;var c=function(){function a(){this.items=[]}a.fromJSON=function(b){for(var c=new a,l=0;l<b.length;l++){var q=e.fromJSON(b[l]);c.items.push(q)}return c};a.toRTCStatsReport=function(a){return a};a.prototype.toJSON=
function(){return JSON.stringify(this.items)};a.prototype.result=function(){return this.items};return a}();a.StatsReport=c;var e=function(){function a(){this.names_=[];this.stat_=new Map;this.id="";this.timestamp=0;this.type=""}a.fromJSON=function(b){var c=new a;c.id=b.id||"";c.timestamp=b.timestamp||"";c.type=b.type||"";Object.keys(b).forEach(function(a){"id"!==a&&"timestamp"!==a&&"type"!==a&&(c.names_.push(a),c.stat_.set(a,b[a]))});return c};a.prototype.toJSON=function(){return JSON.stringify({id:this.id,
timestamp:this.timestamp,type:this.type,stat:this.stat_})};a.prototype.names=function(){return this.names_};a.prototype.stat=function(a){return this.stat_.get(a)};return a}();a.Stats=e},704:function(b,a,c){var e=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=
null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(a,"__esModule",{value:!0});a.StreamResolution=a.RemoteCallConstraints=void 0;var l=c(550),h=c(658),d=c(851);b=function(){return function(){}}();a.RemoteCallConstraints=b;b=function(a){function b(){var c=a.call(this,null,l.class_id_t.StreamResolution,0,h.ProxyMode.Local)||this;c.lastSentConstraints_=null;return c}e(b,a);Object.defineProperty(b.prototype,"onupdate",{get:function(){return this.onupdate_},set:function(a){var c=
this;this.onupdate_=a;this.waitUntilConnected(this.user_friendly_id()+".onupdate").then(function(){var a=c.registerCallbacks(!1,c.isNullCallback(c.onupdate_),l.method_id_StreamResolution_t.onupdate);a.then(function(a){a=a.params;var e=a[0];a.slice(1);d.logger.log(c.user_friendly_id()+".onupdate",JSON.stringify(e));c.lastSentConstraints_&&JSON.stringify(c.lastSentConstraints_)==JSON.stringify(e)?d.logger.log(c.user_friendly_id()+".onupdate constraints unchanged, ignoring"):c.onupdate_&&(b.isValidRemoteConstraints(e)?
(c.lastSentConstraints_=e,c.onupdate_(c.toICallConstraints(c.lastSentConstraints_))):d.logger.log(c.user_friendly_id()+".onupdate invalid RemoteCallConstraints"))});return c.remoteInvoke(!0,l.method_id_StreamResolution_t.onupdate,a.success)})["catch"](function(){return d.logger.log(c.user_friendly_id()+".onupdate, could not set listener")})},enumerable:!1,configurable:!0});b.prototype.toICallConstraints=function(a){var b={maxParticipantResolutions:null};if(a.max_participant_resolutions_dynamic){b.maxParticipantResolutions=
{};for(var c=0,e=a.max_participant_resolutions_dynamic;c<e.length;c++){var g=e[c];b.maxParticipantResolutions[g.count]=g.resolution}}else a.max_participant_resolutions_static&&(b.maxParticipantResolutions=a.max_participant_resolutions_static);b.maxIncomingStreams=a.max_incoming_streams;b.maxOutgoingResolution=a.max_outgoing_resolution;b.maxSimulcastLayers=a.max_simulcast_layers;d.logger.log(this.user_friendly_id()+".toICallConstraints: "+JSON.stringify(b));return b};b.isValidRemoteConstraints=function(a){return null!=
a&&(null!=a.max_participant_resolutions_dynamic||null!=a.max_participant_resolutions_static)&&null!=a.max_incoming_streams&&null!=a.max_outgoing_resolution&&null!=a.max_simulcast_layers};b.prototype.getCallConstraints=function(){var a=this;return new Promise(function(c,e){a.waitUntilConnected(a.user_friendly_id()+".getCallConstraints").then(function(){return a.remoteInvoke(!1,l.method_id_StreamResolution_t.getCallConstraints)}).then(function(h){h=a.param0(h);d.logger.log(a.user_friendly_id()+".getCallConstraints",
JSON.stringify(h));b.isValidRemoteConstraints(h)?(a.onupdate_&&(a.lastSentConstraints_=h),c(a.toICallConstraints(h))):(d.logger.log(a.user_friendly_id()+".getCallConstraints invalid RemoteCallConstraints"),e())})["catch"](function(){d.logger.log(a.user_friendly_id()+".getCallConstraints promise rejected");e()})})};b.getDefaultConstraints=function(){var a={maxParticipantResolutions:{1:720,2:720,3:360,more:360},maxIncomingStreams:4,maxOutgoingResolution:720,maxSimulcastLayers:0};d.logger.log("StreamResolution.getDefaultConstraints: "+
JSON.stringify(a));return a};b.prototype.updateStreamResolution=function(){var a=this;this.getCallConstraints().then(function(b){return a.onupdate&&a.onupdate(b)})["catch"](function(){return d.logger.log("Failed to get stream resolution information!")})};return b}(h.ProxyObject);a.StreamResolution=b},394:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.Telemetry=a.tel_key_CPUTotalmemory=a.tel_key_CPUGpuinfo=a.tel_key_CPUMachineid=a.tel_key_CPUProcessors=a.tel_key_CPUCores=a.tel_key_CPUModel=
a.tel_key_CPUSpeed=a.tel_key_OSEdition=a.tel_key_OSDistro=a.tel_key_OSArchitecture=a.tel_key_OSVersion=a.tel_key_OSFamily=a.tel_key_VerHdxRtcEngine=a.tel_key_VerTypeScript=a.tel_key_VerEndpoint=a.tel_key_VerVda=a.tel_key_VerReceiver=a.tel_key_VerWebrtcCodecs=a.tel_key_VerWebrpc=a.tel_key_PerfCallType=a.tel_key_PerfCallState=a.tel_key_PerfCallDirection=a.tel_key_SpeakerDeviceUsed=a.tel_key_VideoDeviceUsed=a.tel_key_AudioDeviceUsed=a.tel_key_CallEstOutgoing=a.tel_key_CallEstIncoming=a.tel_key_ScreensharingCallDuration=
a.tel_key_VideoCallDuration=a.tel_key_AudioCallDuration=a.tel_key_ConferenceCallDuration=a.tel_cmd=a.tel_CallType=a.tel_CallDirection=a.tel_CallState=void 0;var e=c(946),l=c(851);(function(a){a[a.unknown=0]="unknown";a[a.active=1]="active";a[a.idle=2]="idle"})(a.tel_CallState||(a.tel_CallState={}));(function(a){a[a.unknown=0]="unknown";a[a.incoming=1]="incoming";a[a.outgoing=2]="outgoing"})(a.tel_CallDirection||(a.tel_CallDirection={}));(function(a){a[a.unknown=0]="unknown";a[a.audio=1]="audio";a[a.video=
2]="video";a[a.multi=3]="multi";a[a.dshare=4]="dshare"})(a.tel_CallType||(a.tel_CallType={}));var h;(function(a){a[a.Unknown=0]="Unknown";a[a.Cap=1]="Cap";a[a.Init=2]="Init";a[a.Data=3]="Data"})(h=a.tel_cmd||(a.tel_cmd={}));a.tel_key_ConferenceCallDuration="ConferenceCallDuration";a.tel_key_AudioCallDuration="AudioCallDuration";a.tel_key_VideoCallDuration="VideoCallDuration";a.tel_key_ScreensharingCallDuration="ScreensharingCallDuration";a.tel_key_CallEstIncoming="CallEstIncoming";a.tel_key_CallEstOutgoing=
"CallEstOutgoing";a.tel_key_AudioDeviceUsed="AudioDeviceUsed";a.tel_key_VideoDeviceUsed="VideoDeviceUsed";a.tel_key_SpeakerDeviceUsed="SpeakerDeviceUsed";a.tel_key_PerfCallDirection="PerfCallDirection";a.tel_key_PerfCallState="PerfCallState";a.tel_key_PerfCallType="PerfCallType";a.tel_key_VerWebrpc="VerWebrpc";a.tel_key_VerWebrtcCodecs="VerWebrtcCodecs";a.tel_key_VerReceiver="VerReceiver";a.tel_key_VerVda="VerVda";a.tel_key_VerEndpoint="VerEndpoint";a.tel_key_VerTypeScript="VerTypeScript";a.tel_key_VerHdxRtcEngine=
"VerHdxRtcEngine";a.tel_key_OSFamily="OSFamily";a.tel_key_OSVersion="OSVersion";a.tel_key_OSArchitecture="OSArchitecture";a.tel_key_OSDistro="OSDistro";a.tel_key_OSEdition="OSEdition";a.tel_key_CPUSpeed="CPUSpeed";a.tel_key_CPUModel="CPUModel";a.tel_key_CPUCores="CPUCores";a.tel_key_CPUProcessors="CPUProcessors";a.tel_key_CPUMachineid="CPUMachineid";a.tel_key_CPUGpuinfo="CPUGpuinfo";a.tel_key_CPUTotalmemory="CPUTotalmemory";var d=function(){function a(b,c,d,e){this.cmd=b;this.key=c;this.value=d;this.flags=
e}a.prototype.SendTelemetryData=function(a){a.SendTelemetryData(this.cmd,this.key,this.value,this.flags)};return a}();b=function(){function a(){this.id=0;this.deferredData=[]}a.prototype.reset=function(){this.id=0;this.deferredData=[]};a.prototype.onInitialized=function(a){for(this.id=a;this.deferredData&&0<this.deferredData.length;)this.deferredData.shift().SendTelemetryData(this)};a.prototype.SendTelemetryInit=function(){0<this.id&&this.reset();try{e.getRedirector().WSSendObject({v:"telemetry",
hdr:{command:h.Init,id:0},init:{domain:"HDXMM Teams",subdomain:"Teams",feature:"msteams",version:"1.1.1.1"}})}catch(a){l.logger.log(a)}};a.prototype.SendTelemetryData=function(a,b,c,w){if(a!=h.Data)l.logger.log("invalid telemetry command!");else if(0==this.id)this.deferredData.push(new d(a,b,c,w));else try{e.getRedirector().WSSendObject({v:"telemetry",hdr:{command:a,id:this.id},data:{key:b,value:c,flags:w}})}catch(p){l.logger.log(p)}};return a}();a.Telemetry=b},259:function(b,a,c){Object.defineProperty(a,
"__esModule",{value:!0});a.Util=void 0;var e=c(851);b=function(){function a(){}a.stringifyArray=function(a){for(var b="[",c=0;c<a.length;++c)0!=c&&(b+=","),b+=this.stringify(a[c]);return b+"]"};a.stringifyObject=function(a){var b="{",c=!0,e;for(e in a)c?c=!1:b+=",",b=b+'"'+e+'":',b=a[e]instanceof Array?b+this.stringifyArray(a[e]):"object"==typeof a[e]?b+this.stringifyObject(a[e]):b+JSON.stringify(a[e]);return b+"}"};a.stringify=function(a){return"object"==typeof a?"[object Array]"==Object.prototype.toString.call(a)?
this.stringifyArray(a):this.stringifyObject(a):JSON.stringify(a)};a.GetObjectPropertyDescriptor=function(a,b){for(var c=void 0;a!=Object.prototype;){c=Object.getOwnPropertyDescriptor(a,b);if(void 0!==c)break;a=a.__proto__}return c};a.sendEvent=function(a,b){try{var c=document.createEvent("Event");c.initEvent(b,!0,!0);a.dispatchEvent(c)}catch(l){e.logger.log('sendEvent(): exception dispatching "'+b+'" event: '+l.message)}};a.hasValue=function(a){var b=!1;null!==a&&void 0!==a&&(b=!0);return b};return a}();
a.Util=b},307:function(b,a,c){var e=this&&this.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,g){function h(a){try{l(d.next(a))}catch(b){g(b)}}function k(a){try{l(d["throw"](a))}catch(b){g(b)}}function l(a){a.done?c(a.value):e(a.value).then(h,k)}l((d=d.apply(a,b||[])).next())})},l=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(g)throw new TypeError("Generator is already executing.");
for(;e;)try{if(g=1,h&&(k=c[0]&2?h["return"]:c[0]?h["throw"]||((k=h["return"])&&k.call(h),0):h.next)&&!(k=k.call(h,c[1])).done)return k;if(h=0,k)c=[c[0]&2,k.value];switch(c[0]){case 0:case 1:k=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(k=e.trys,k=0<k.length&&k[k.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!k||c[1]>k[0]&&c[1]<k[3]))e.label=c[1];else if(6===c[0]&&e.label<k[1])e.label=
k[1],k=c;else if(k&&e.label<k[2])e.label=k[2],e.ops.push(c);else{k[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,e)}catch(l){c=[6,l],h=0}finally{g=k=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(k[0]&1)throw k[1];return k[1]},trys:[],ops:[]},g,h,k,l;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();return l={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l},h=
c(360),d=c(144);c(679);var p=c(945),q=c(368),n=c(851).logger,k=c(650),v=c(973),z=c(247).getGC,g=c(946),B=c(613).E911Service;b=c(550);var t=b.Features,m=b.FEATURE_vda_delete_viewport,D=c(704).StreamResolution,y=c(239).E;(function(a,b){a.CitrixWebRTC=b()})("undefined"!==typeof self?self:this,function(){function a(b,c){n.log("VDI Shim createMediaStreamInternal");G();var f=new d.RemoteStream(null,0,0,b),e=new Promise(function(a,b){f.syncBarrier().then(function(b){n.log("stream.syncBarrier(): success.");
a(b)})["catch"](function(a){n.log("stream.syncBarrier(): failed with error: "+JSON.stringify(a));f.release();b()})});return c?e:f}function b(a){null==Y&&(Y=new q.Frames(!O.isFeatureSupported(t.FEATURE_public_multi_window)));a(Y)}function c(a,d){b(function(b){var c=b.findFrame(a);void 0==c&&(c=b.newFrame(a));d(c)})}function M(a,c){b(function(b){b=b.findFrame(a);null!=b&&c(b)})}function F(a){g.getRedirector().SendTelemetryData_Speaker(a)}function J(a,b){if(S)try{"vdiE911InfoChanged"===a?a="vdiE911DataChanged":
"vdiCallConstraintsChanged"===a&&(a="vdiStreamConstraintsChanged");var c=Object.assign({event:a},b);n.log("Dispatching VM event:"+JSON.stringify(c));S(c)}catch(d){n.log("Exception onVMEvent(), eventName:"+a+" message:"+d.message)}}function G(){var a=window.getCitrixWebrtcRedir;void 0!==a?a().then(function(a){n.log("sucesss on connect, getCitrixWebrtcRedir reg value:"+a);"1"!==a||O||(n.log("supported client"),P(W))})["catch"](function(){n.log("Failure to Read Webrtc redir Reg Key");f()}):(n.log("window.getCitrixWebrtcRedir() method is not available yet"),
f())}function L(a){n.log("VDI Event: vdiClientDisconnected");ba();if(!0===a&&!1===aa){n.log("VDI Event: vdiClientDisconnected with failure reported");aa=!0;try{S({event:"vdiClientDisconnected",reason:"failure",msg:"Websocket Connection Failure"})}catch(b){n.log("onVMEvent(): exception: "+b.message)}}else{aa=!1;try{S({event:"vdiClientDisconnected",reason:"endpointDisconnected"})}catch(b){n.log("onVMEvent(): exception: "+b.message)}}}function P(a){n.log("initRemoteSession with vendor:"+a);O||(O=new k.RemoteSession("CitrixWebRTCSDK",
a))}function C(){n.log("VDI Event: onVdiClientDisconnectedTimer");P(W)}function R(){var a=this;n.log("VDI Shim onVdiClientConnected...");O?O.getSessionInfo().then(function(c){return e(a,void 0,void 0,function(){return l(this,function(a){switch(a.label){case 0:return n.log("VDI Shim onVdiClientConnected, client endpoint info:"+JSON.stringify(c)),H&&H.isValid()||(H=new d.RemoteDevices),I&&I.isValid()||(I=new d.NavigatorUserMedia),b(function(a){a.reconnect()}),J("vdiClientConnected",{version:c,endpointId:c.endpointId}),
[4,I.getCapabilities().then(function(a){n.log("VDI Shim onVdiClientConnected, caps = "+a)})["catch"](function(){n.log("VDI Shim onVdiClientConnected, could not get capabilities")})];case 1:return a.sent(),T||(T=new B,T.onupdate=function(a){J("vdiE911InfoChanged",a)},T.updateE911Info()),U||(J("vdiCallConstraintsChanged",D.getDefaultConstraints()),null!==O&&k.RemoteSession.isFeatureCallConstraintsSupported()&&(U=new D,U.onupdate=function(a){J("vdiCallConstraintsChanged",a)},U.updateStreamResolution())),
navigator.mediaDevices.dispatchEvent(new CustomEvent("devicechange")),[2]}})})})["catch"](function(){n.log("VDI Shim onVdiClientConnected, getSessionInfo failure! Session is not fully connected yet...")}):n.log("VDI Shim onVdiClientConnected, remoteSession does not exist")}function K(a){if("1"===a)n.log("Supported client"),g.getRedirector().pingConnectionBegin(!0);else if("0"===a){n.log("VDI Event: Unsupported client reported");try{S({event:"vdiClientDisconnected",reason:"endpointUnsupported",msg:"Unsupported endpoint connected"})}catch(b){n.log("onVMEvent(): exception: "+
b.message)}}else n.log("Citrix Webrtc Redir Reg Key value is incorrect")}function f(){!1===Z&&(n.log("starting MS Reg retry..."),Z=!0,X(10))}function X(a){if(0>=a){Z=!1;n.log("VDI Event: Reg Key not Updated after timer reported, Fallback");try{S({event:"vdiClientDisconnected",reason:"failure",msg:"Citrix Webrtc Redir Reg Key not Present"})}catch(b){n.log("onVMEvent(): exception: "+b.message)}}else{var c=window.getCitrixWebrtcRedir;void 0!==c?c().then(function(b){n.log("CitrixMSTeamsRedir reg value:"+
b);"0"===b||"1"===b?(K(b),Z=!1):(n.log("MS Teams Redir Reg key not updated - Start timer"),setTimeout(function(){n.log("Timer waiting for registry to be updated count :"+a);X(--a)},1E3))})["catch"](function(){n.log("Failure to Read MS Teams redir Reg Key - Start timer");setTimeout(function(){n.log("Timer waiting for registry to be updated count :"+a);X(--a)},1E3)}):(n.log("window.getCitrixWebrtcRedir() method is not available yet"),setTimeout(function(){n.log("Timer waiting for registry to be updated count :"+
a);X(--a)},1E3))}}function ba(){n.log("VDI : cleanup");g.getRedirector().clearReqs();d.NavigatorUserMedia.resetCapabilities();Y=H=I=null;N&&N.release();O&&O.release();O=null;v.ScreenSharing.destroyInstance();T&&(T.release(),T=null);U&&(U.release(),U=null);z().reset();n.log("VDI : cleanup done")}function ca(){return v.ScreenSharing.screenSharingInstance(function(){if(S)try{S({event:"vdiScreenTopologyChanged"})}catch(a){n.log("onVMEvent('vdiScreenTopologyChanged'): exception: "+a.message)}})}function E(a){if(!V)throw n.log("VDI Shim "+
a+": throwing exception: not initialized!!"),new DOMException("UCSDK is not initialized!!!");}var I=null,da=d.NavigatorUserMedia.getCapabilities,H=null,Y=null,N=null,S=null,T=null,U=null,aa=!1,O=void 0,Z=!1,V=!1,W=void 0;return{Features:t,CitrixPeerConnection:h.PeerConnection,getUserMedia:function(a,b,c){E("getUserMedia");G();n.log("VDI Shim getUserMedia");null!==I&&I.isValid()||(I=new d.NavigatorUserMedia);var f=d.RemoteMediaStreamConstraints.isConstraintsAudioDeviceIdEmpty(a),e=d.RemoteMediaStreamConstraints.isConstraintsVideoSourceIdEmpty(a);
return f||e?new Promise(function(d,f){H.enumerateDevices().then(function(d){return I.webkitGetUserMedia(a,b,c)}).then(function(a){n.log("webkitGetUserMedia for default was resolved");d(a)})["catch"](function(a){n.log("getUserMedia() for default failed with error:"+JSON.stringify(a));f()})}):I.webkitGetUserMedia(a,b,c)},getDisplayMedia:function(a){E("getDisplayMedia");G();n.log("VDI Shim getDisplayMedia");null!==H&&H.isValid()||(H=new d.RemoteDevices);return H.getDisplayMedia(a)},enumerateDevices:function(){E("enumerateDevices");
G();n.log("VDI Shim enumerateDevices");null!==H&&H.isValid()||(H=new d.RemoteDevices);return H.enumerateDevices()},onWindowClose:function(a,c,d){E("onWindowClose");n.log("VDI Shim onWindowClose: (handle: "+a+")");g.getRedirector().getVDAFeatureValue(m)&&b(function(b){b.disposeFrame(a)})},setClientAreaOffset:function(a,b,d){E("setClientAreaOffset");n.log("VDI setClientAreaOffset with xOffset = "+a+", yOffset = "+b+", windowHandle = "+d);G();c(d,function(c){c.setClientAreaOffset(a,b)})},mapVideoElement:function(a,
b){E("mapVideoElement");n.log("VDI New Video Element Created, Creating Mapping to Thin Client DOM");G();c(b,function(b){b.newVideoElement(a)})},mapAudioElement:function(a){E("mapAudioElement");n.log("VDI New Audio Element Created, Creating Mapping to VDA");if(void 0!==a.remoteAudioElement)n.log("Audio element is already configured!");else{G();delete a.remoteAudioElement;Object.defineProperty(a,"remoteAudioElement",{writable:!0,configurable:!0,value:null});a.remoteAudioElement=new p.AudioElement;delete a.sinkId;
Object.defineProperty(a,"sinkId",{configurable:!0,get:function(){return a.remoteAudioElement?a.remoteAudioElement.sinkId:void 0},set:function(b){n.log("VDI Shim set audio element SinkId value = "+b);a.setSinkId(b).then(function(){n.log("VDI Shim set audio element SinkId success")})["catch"](function(){n.log("VDI Shim set audio element SinkId failure")})}});var b=a.remoteAudioElement.play;a.play=function(){n.log("VDI Shim remote audio play");return b.apply(a.remoteAudioElement,arguments)};var c=a.remoteAudioElement.pause;
a.pause=function(){n.log("VDI Shim remote audio pause");return c.apply(a.remoteAudioElement,arguments)};a.setSinkId=function(b){n.log("VDI Shim set audio element SinkId value = "+b);var c=a.remoteAudioElement.setSinkId(b),f;d.enumeratedDevices.forEach(function(a){b===a.deviceId&&(f=a.label)});F(f);return c};delete a.srcObject;Object.defineProperty(a,"srcObject",{configurable:!0,get:function(){return a.remoteAudioElement?a.remoteAudioElement.srcObject:void 0},set:function(b){n.log("VDI Shim set audio element srcObject "+
JSON.stringify(b));a.remoteAudioElement.srcObject=b}})}},disposeVideoElement:function(a,b){E("disposeVideoElement");n.log("VDI Shim disposeVideoElement: ");M(b,function(b){b.disposeVideoElement(a)})},disposeAudioElement:function(a,b,c){E("disposeAudioElement");n.log("VDI Shim disposeAudioElement: ");a&&(b=a.remoteAudioElement)&&(b.dispose(),a.remoteAudioElement=void 0)},setVMEventCallback:function(a){var b=this;S=a;g.getRedirector().isConnected()&&O.getSessionInfo().then(function(a){return e(b,void 0,
void 0,function(){return l(this,function(b){n.log("VDI Shim onVdiClientConnected, client endpoint info:"+JSON.stringify(a));J("vdiClientConnected",{version:a,endpointId:a.endpointId});return[2]})})});n.log("VDI Event Callback Set")},playNotifyAudio:function(a,b){E("playNotifyAudio");n.log("VDI Shim Audio playNotifyAudio audioId:"+a+" src:"+b);N&&N.playNotifyAudio(a,b)},stopNotifyAudio:function(a,b){E("stopNotifyAudio");n.log("VDI Shim Audio pauseNotifyAudio audioId:"+a+" src:"+b);N&&N.pauseNotifyAudio(a,
b)},setSinkId:function(a,b){E("setSinkId");n.log("VDI Shim Audio setSinkId audioId:"+a+" sinkId:"+b);N&&N.setSinkId(a,b)},getLoop:function(a){E("getLoop");var b;N&&(b=N.getLoop(a));n.log("VDI Shim Audio getLoop audioId:"+a+" loop: "+b);return b},setLoop:function(a,b){E("setLoop");n.log("VDI Shim Audio setLoop audioId:"+a+" bool:"+b);N&&N.setLoop(a,b)},addClipRect:function(a,b){E("addClipRect");n.log("VDI Adding Occlusion "+JSON.stringify(a));c(b,function(b){b.addOcclusion(a)})},removeClipRect:function(a,
b){E("removeClipRect");n.log("VDI Removing Occlusion "+JSON.stringify(a));c(b,function(b){b.removeOcclusion(a)})},initLog:function(a,b){n.setMSLogger(a,b);n.log("VDI init logger")},isFeatureOn:function(a){E("isFeatureOn");return O?O.isFeatureSupported(a):!1},onConnectionChange:function(a){E("onConnectionChange");n.log("VDI : onConnectionChange to "+a);!1===a?n.log("Disconnecting from the VDA"):(n.log("Connecting to the VDA"),a=window.getCitrixWebrtcRedir,void 0!==a?a().then(function(a){n.log("Sucesss on connect, CitrixRedir reg value:"+
a);"0"===a||"1"===a?K(a):(n.log("MS Teams Redir Reg key not updated yet"),f())})["catch"](function(){n.log("Failure to Read MS Teams redir Reg Key");f()}):(n.log("window.getCitrixWebrtcRedir() method is not available yet"),f()))},getScreensAsync:function(){E("getScreensAsync");n.log("VDI Shim getScreensAsync");G();var a=ca();return a.getScreensAsync.apply(a,arguments)},getWindowsAsync:function(){E("getWindowsAsync");n.log("VDI Shim getWindowsAsync");G();var a=ca();return a.getWindowsAsync.apply(a,
arguments)},setScreenSharePanelId:function(a){E("setScreenSharePanelId");n.log("VDI: setScreenSharePanelId set to "+JSON.stringify(a));G();null!==H&&H.isValid()||(H=new d.RemoteDevices);H.panelid=a},setCodecCapabilities:function(a){E("setCodecCapabilities");G();n.log("VDI Shim setCodecCapabilities");null!==I&&I.isValid()||(I=new d.NavigatorUserMedia);return I.setCodecCapabilities(a)},getE911Data:function(){E("getE911Data");return T?T.getE911Info():null},createMediaStream:function(b){E("createMediaStream");
n.log("VDI Shim createMediaStream");return a(b,!1)},createMediaStreamAsync:function(b){E("createMediaStreamAsync");n.log("VDI Shim createMediaStreamAsync");return a(b,!0)},disposeMediaStream:function(a){E("disposeMediaStream");n.log("VDI Shim disposeMediaStream: ");for(var b=0;b<a.length;b++){var c=a[b];c&&c.dispose()}},getCapabilities:function(a){E("getCapabilities");G();n.log("VDI Shim getCapabilities");null!==I&&I.isValid()||(I=new d.NavigatorUserMedia,da=d.NavigatorUserMedia.getCapabilities);
return da.apply(I,arguments)},initUCSDK:function(a){n.log("VDI Shim initUCSDK vendor:"+a);var b=!0;void 0==a||null==a||"string"!==typeof a||0==a.length?b=!1:0==a.split(" ").join("").length&&(b=!1);if(!b)throw n.log("VDI Shim initUCSDK: throwing exception: vendor info cannot be empty!!!"),new DOMException("vendor info cannot be empty, please pass vendor info string!!!");V||(W=a,I=new d.NavigatorUserMedia,H=new d.RemoteDevices,N=new y,H=new d.RemoteDevices,P(W),window.onVdiClientDisconnected=L,window.onVdiClientDisconnectedTimer=
C,window.onVdiClientConnected=R,V=!0)},deinitUCSDK:function(){n.log("VDI Shim deinitUCSDK");V&&(g.getRedirector().terminateOptimization(),ba(),window.onVdiClientDisconnected=void 0,window.onVdiClientDisconnectedTimer=void 0,W=window.onVdiClientConnected=void 0,V=!1)}}})},679:function(b,a,c){var e=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};
return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(a,"__esModule",{value:!0});a.VideoElement=a.VideoRect=void 0;var l=c(658),h=c(550),d=c(851),p=c(946),q=c(550),n=function(){return function(a,b){this.x=Math.round(a.x)*b.devicePixelRatio;this.y=Math.round(a.y)*b.devicePixelRatio;this.width=Math.round(a.width)*b.devicePixelRatio;this.height=Math.round(a.height)*b.devicePixelRatio}}();
a.VideoRect=n;var k;(function(a){a[a.pixels=0]="pixels";a[a.percent=1]="percent"})(k||(k={}));var v=function(){function a(b){this.value=parseInt(b);this.units=this.detectUnits(b)}a.prototype.detectUnits=function(a){return-1===a.toLowerCase().indexOf("px")?k.pixels:k.percent};return a}(),z;(function(a){a[a.fill=0]="fill";a[a.contain=1]="contain";a[a.cover=2]="cover"})(z||(z={}));var g=function(){return function(a,b){this.x=a;this.y=b}}(),B=function(){function a(b,c,d){this.fit=this.convertFit(b);this.position=
new g(c,d)}a.prototype.convertFit=function(a){return"fill"==a?z.fill:"contain"==a?z.contain:"cover"==a?z.cover:z.fill};return a}(),t;(function(a){a[a.NotReady=0]="NotReady";a[a.Ready=1]="Ready"})(t||(t={}));b=function(a){function b(c,e){var g=a.call(this,null,h.class_id_t.VideoElement,0,l.ProxyMode.Local)||this;g.srcObject_=null;g.sinkId_="";g.videoWidth=0;g.videoHeight=0;g.isLoaded=!1;g.connectionState="disconnected";g.styleObserver=null;g.readyState_=t.NotReady;g.deferredVideoActions=[];g.pendingRelease_=
!1;g.activeConnectionEvent_=null;g.connectionEventQueue_=[];g.window_=e;g.elementId=c;d.logger.log("VideoElement.constructor (elementid: "+c+")");return g}e(b,a);b.prototype.dispose=function(){var a=this;d.logger.log("VideoElement.dispose (elementId: "+this.elementId+" oid: "+this.object_id()+")");this.pendingRelease_=!0;this.srcObject=this.ontimeupdate=this.onloadedmetadata=null;this.waitUntilReady("VideoElement.dispose").then(function(){})["catch"](function(){a.pendingRelease_=!1;a.setState("disconnected");
a.onconnectionstatechange=null;a.release()});this.onReady()};b.prototype.setState=function(a){this.connectionState=a;if(this.onconnectionstatechange_)this.onconnectionstatechange_()};Object.defineProperty(b.prototype,"Id",{get:function(){return this.elementId},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"sinkId",{get:function(){return this.sinkId_},set:function(a){var b=this;d.logger.log("VideoElement.sinkId: (id="+a+")");this.waitUntilConnected("VideoElement.sinkId").then(function(){return void 0!=
a?b.remoteInvoke(!0,h.method_id_VideoElement_t.sinkId,a):new Promise(function(a){return a(void 0)})}).then(function(){d.logger.log("videoElement: setting state to ready. (oid: "+b.object_id()+")");b.sinkId_=a;b.readyState_=t.Ready;b.onReady()})["catch"](function(a){b.logRemoteInvokeError(a,".set_sinkId() failed!")})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"srcObject",{get:function(){return this.srcObject_},set:function(a){d.logger.log(this.user_friendly_id()+".srcObject: set srcObject... this.srcObject:"+
this.srcObject+" obj:"+a);if(this.srcObject_!==a){var b=p.getRedirector().getFeatureValue(q.FEATURE_ms_teams_1911);null!==this.srcObject_&&(null===a&&b&&this.disconnect(),b||this.disconnect(),this.isLoaded=!1);this.srcObject_=a;null!==this.srcObject_&&this.connectTo(this.srcObject_)}},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onconnectionstatechange",{get:function(){return this.onconnectionstatechange_},set:function(a){d.logger.log(this.user_friendly_id()+".set_onconnectionstatechange() called.");
this.onconnectionstatechange_=a},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"onloadedmetadata",{set:function(a){d.logger.log(this.user_friendly_id()+".set_onloadedmetadata() called.");this.onloadedmetadata_=a},enumerable:!1,configurable:!0});b.prototype.setupOnVideoFrameChanged=function(){var a=this,b=this.registerCallbacks(!1,!1,h.method_id_VideoElement_t.onvideoframechanged);b.then(function(b){d.logger.log(a.user_friendly_id()+".onvideoframechanged",b.params);a.videoWidth=
b.params[0]||0;a.videoHeight=b.params[1]||0;a.isLoaded||(a.isLoaded=!0,a.onloadedmetadata_&&a.onloadedmetadata_())});this.remoteInvoke(!0,h.method_id_VideoElement_t.onvideoframechanged,b.success)};b.prototype.processConnectionEvent=function(){var a=this;if(0!==this.connectionEventQueue_.length&&!this.activeConnectionEvent_){var b=this.connectionEventQueue_.pop();"connectTo"==b.operation?this.activeConnectionEvent_=this.connectToAsync(b.param):"disconnect"==b.operation&&(this.activeConnectionEvent_=
this.disconnectAsync());this.activeConnectionEvent_.then(function(){a.activeConnectionEvent_=void 0;a.processConnectionEvent()})["catch"](function(){d.logger.log(a.user_friendly_id()+" : Failed to handle connection event! ");a.activeConnectionEvent_=void 0;a.processConnectionEvent()})}};b.prototype.connectTo=function(a){this.connectionEventQueue_.push({operation:"connectTo",param:a});this.processConnectionEvent()};b.prototype.disconnect=function(){this.connectionEventQueue_.push({operation:"disconnect",
param:null});this.processConnectionEvent()};b.prototype.connectToAsync=function(a){var b=this;return new Promise(function(c,e){d.logger.log(b.user_friendly_id()+".connectTo: connect media stream with id = "+a.id+", clone_id = "+a.clone_state.clone_id);b.streamId_=a.id;b.waitUntilReady("VideoElement.connectTo").then(function(){return a.waitUntilConnected("MediaStream.connectTo")}).then(function(){b.setupOnVideoFrameChanged();return a.clone_state.synchronize(a)}).then(function(a){d.logger.log(b.user_friendly_id()+
".connectTo: remote invoking");var c=b.registerCallbacks(!0,!1,h.method_id_VideoElement_t.connectTo);return Promise.all([b.remoteInvokeEx(!1,h.method_id_VideoElement_t.connectTo,[a],c.success,c.fail),c.prom()])}).then(function(a){d.logger.log(b.user_friendly_id()+".connectTo: remote media stream is connected!");b.setState("connected");b.watch();b.updateTimer=setInterval(function(){b.ontimeupdate&&b.ontimeupdate()},250);(a=b.window_.document.getElementById(b.elementId))&&b.updateStyle(a);c()})["catch"](function(a){b.logRemoteInvokeError(a,
".connectTo: failed to connect!");e()})})};b.prototype.disconnectAsync=function(){var a=this;return new Promise(function(b,c){d.logger.log(a.user_friendly_id()+".disconnect: disconnecting stream : "+a.streamId_);a.unwatch();a.waitUntilReady("VideoElement.disconnect").then(function(){a.updateTimer&&clearInterval(a.updateTimer);var b=a.registerCallbacks(!1,!0,h.method_id_VideoElement_t.onvideoframechanged);a.remoteInvoke(!0,h.method_id_VideoElement_t.onvideoframechanged,b.success);return a.remoteInvoke(!1,
h.method_id_VideoElement_t.disconnect)}).then(function(){d.logger.log(a.user_friendly_id()+".disconnect: remote media stream is disconnected!");a.setState("disconnected");1==a.pendingRelease_&&(a.pendingRelease_=!1,a.onconnectionstatechange=null,a.release());b()})["catch"](function(b){a.logRemoteInvokeError(b,".disconnect: failed to connect!");c()})})};b.prototype.setFrame=function(a){var b=this;d.logger.log(this.user_friendly_id()+".setFrame: set video frame to",a.x,a.y,a.width,a.height);this.waitUntilReady("VideoElement.setFrame").then(function(){var c=
new n(a,b.window_);return b.remoteInvoke(!1,h.method_id_VideoElement_t.setFrame,c)}).then(function(){d.logger.log(b.user_friendly_id()+".setFrame: success!")})["catch"](function(a){b.logRemoteInvokeError(a,".setFrame: failed to connect!")})};b.prototype.addClipRect=function(a){var b=this;d.logger.log(this.user_friendly_id()+".addClipRect: ",JSON.stringify(a));this.waitUntilReady("VideoElement.addClipRect").then(function(){var c=new n(a,b.window_);return b.remoteInvoke(!1,h.method_id_VideoElement_t.addClipRect,
c)})["catch"](function(a){b.logRemoteInvokeError(a,".addClipRect failed!")})};b.prototype.removeClipRect=function(a){var b=this;d.logger.log(this.user_friendly_id()+".removeClipRect: ",JSON.stringify(a));this.waitUntilReady("VideoElement.removeClipRect").then(function(){var c=new n(a,b.window_);return b.remoteInvoke(!1,h.method_id_VideoElement_t.removeClipRect,c)})["catch"](function(a){b.logRemoteInvokeError(a,".removeClipRect failed!")})};b.prototype.watch=function(){var a=this;if(p.getRedirector().getFeatureValue(q.FEATURE_ms_teams_video_placement)){var b=
this.window_.document.getElementById(this.elementId);b&&(this.unwatch(),this.styleObserver=new MutationObserver(function(b){b.forEach(function(b){"style"==b.attributeName?a.updateStyle(b.target):a.elementId=b.target.id})}),this.styleObserver.observe(b,{attributes:!0,attributeOldValue:!0,attributeFilter:["style","id"]}))}};b.prototype.unwatch=function(){this.styleObserver&&(this.styleObserver.disconnect(),this.styleObserver=null)};b.prototype.updateStyle=function(a){if("connected"==this.connectionState){var b=
this.window_.getComputedStyle(a).getPropertyValue("object-fit"),c=this.window_.getComputedStyle(a).getPropertyValue("object-position").split(" ");a=new v(c[0]);c=new v(c[1]);this.placement=new B(b,a,c)}else d.logger.log(this.user_friendly_id()+".updateStyle: video element is not connected")};Object.defineProperty(b.prototype,"placement",{get:function(){return this.placement_},set:function(a){var b=this;p.getRedirector().getFeatureValue(q.FEATURE_ms_teams_video_placement)?this.waitUntilReady("VideoElement.placement").then(function(){return b.remoteInvoke(!0,
h.method_id_VideoElement_t.placement,a)}).then(function(){b.placement_=a})["catch"](function(a){b.logRemoteInvokeError(a,".placement setter: failed to connect!")}):d.logger.log(this.user_friendly_id()+".placement: video placement feature is not supported on a client")},enumerable:!1,configurable:!0});b.prototype.waitUntilReady=function(a){var b=this;return new Promise(function(c,e){d.logger.log("VideoElement.waitUntilReady(): readyState="+b.readyState_+". (oid: "+b.object_id()+")");b.readyState_==
t.Ready?c():(d.logger.log('videoElement.waitUntilReady(): deferring action "'+a+'". (oid: '+b.object_id()+")"),b.deferredVideoActions.push(new l.deferred_action(c,e,a)))})};b.prototype.onReady=function(){for(;this.deferredVideoActions&&0<this.deferredVideoActions.length;)this.deferredVideoActions.shift().post(this.readyState_==t.Ready)};return b}(l.ProxyObject);a.VideoElement=b},269:function(b,a){Object.defineProperty(a,"__esModule",{value:!0});a.HardwareInfo=a.MemoryInfo=a.GPUInfo=a.GPU=a.CPUInfo=
a.WebrpcClassLibInfo=a.WebrpcClassInfo=a.WebrpcMethodInfo=a.EndpointId=a.OSInfo=a.WebrpcFeatureInfo=a.FeatureData=a.VersionData=a.FEATURE_unsupported=a.FEATURE_ms_teams_redirection=void 0;a.FEATURE_ms_teams_redirection="ms_teams_redirection";a.FEATURE_unsupported="unsupported";var c=function(){return function(a,b,c,d){this.major=a;this.minor=b;this.revision=c;this.build=d}}();a.VersionData=c;c=function(){return function(){}}();a.FeatureData=c;c=function(){return function(a,b){this.fature=a;this.version=
b}}();a.WebrpcFeatureInfo=c;c=function(){return function(a,b,c,d,e){this.family=a;this.version=b;this.architecture=c;this.distro=d;this.edition=e}}();a.OSInfo=c;c=function(){return function(a,b){this.machine_id=a;this.user_id=b}}();a.EndpointId=c;c=function(){return function(b,c,e,d,l){void 0===l&&(l=a.FEATURE_ms_teams_redirection);this.iid=b;this.mid=c;this.name=e;this.isprop=d;this.feature=l}}();a.WebrpcMethodInfo=c;c=function(){return function(a,b,c){this.id=a;this.name=b;this.methods=c}}();a.WebrpcClassInfo=
c;c=function(){return function(a,b){this.name=a;this.classes=b}}();a.WebrpcClassLibInfo=c;c=function(){return function(a,b){this.cpumodel=a;this.numberofprocessors=b}}();a.CPUInfo=c;c=function(){return function(a,b){this.name=a;this.driver=b}}();a.GPU=c;c=function(){return function(a){this.gpus=a}}();a.GPUInfo=c;c=function(){return function(a){this.totalmemory=a}}();a.MemoryInfo=c;c=function(){return function(a,b,c){this.cpu_info=a;this.gpu_info=b;this.memory_info=c}}();a.HardwareInfo=c},550:function(b,
a,c){var e=this&&this.__createBinding||(Object.create?function(a,b,c,e){void 0===e&&(e=c);Object.defineProperty(a,e,{enumerable:!0,get:function(){return b[c]}})}:function(a,b,c,e){void 0===e&&(e=c);a[e]=b[c]});b=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||b.hasOwnProperty(c)||e(b,a,c)};Object.defineProperty(a,"__esModule",{value:!0});a.WebrpcClassLibInfoUtil=void 0;var l=c(187);b(c(187),a);c=function(){function a(){}a.getInterfaceByid=function(a){for(var b=0,c=l.class_lib_info.classes;b<
c.length;b++){var e=c[b];if(e.id==a)return e}return null};a.getMethodByid=function(a,b){var c=this.getInterfaceByid(a);if(null!=c)for(var e=0,c=c.methods;e<c.length;e++){var k=c[e];if(k.mid==b)return k}return null};a.getMethodFeatureByid=function(a,b){var c=this.getInterfaceByid(a);if(null!=c)for(var e=0,c=c.methods;e<c.length;e++){var k=c[e];if(k.mid==b)return k.feature}return null};a.composeClassInfoData=function(a){a=a.hdr;if(void 0==a)return"*** Invalid packet: Couldn't find hdr object ***";var b=
a.proc;if(void 0==b)return"";a=b.iid;for(var b=b.methodid,c=0,e=l.class_lib_info.classes;c<e.length;c++){var k=e[c];if(k.id==a)for(var h=0,p=k.methods;h<p.length;h++){var g=p[h];if(g.mid==b)return k.name+"::"+g.name}}return""};return a}();a.WebrpcClassLibInfoUtil=c},187:function(b,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.class_lib_info=a.method_id_StreamResolution_t=a.method_id_RTCSctpTransport_t=a.method_id_RTCDataChannel_t=a.method_id_E911Service_t=a.method_id_ScreenSource_t=a.method_id_VDISharingRemote_t=
a.method_id_RTCRtpTransceiver_t=a.method_id_RTCIceCandidatePair_t=a.method_id_RTCDTMFToneChangeEvent_t=a.method_id_RTCDTMFSender_t=a.method_id_RTCIceTransport_t=a.method_id_RTCDtlsTransport_t=a.method_id_RTCRtpSender_t=a.method_id_RTCRtpReceiver_t=a.method_id_AudioElement_t=a.method_id_VideoElement_t=a.method_id_MediaStreamEvent_t=a.method_id_RTCIceCandidateEvent_t=a.method_id_RTCIceCandidate_t=a.method_id_NavigatorUserMedia_t=a.method_id_MediaStream_t=a.method_id_MediaStreamTrack_t=a.method_id_RTCSessionDescription_t=
a.method_id_MediaDeviceInfo_t=a.method_id_MediaDevices_t=a.method_id_RTCPeerConnection_t=a.method_id_EngineControl_t=a.class_id_t=a.vdaFeatureNameMap=a.featureNameMap=a.Features=a.FEATURE_ms_teams_sender_stats_fix=a.FEATURE_ms_teams_enumerate_devices_v2=a.FEATURE_ms_teams_track_clone_with_id=a.FEATURE_ms_teams_audio_notifications_loop=a.FEATURE_ms_teams_share_system_audio=a.FEATURE_ms_teams_stream_active_status=a.FEATURE_ms_teams_hardware_info=a.FEATURE_ms_teams_secondary_audio_notifications=a.FEATURE_ms_teams_stream_resolution=
a.FEATURE_ms_teams_client_info=a.FEATURE_ms_teams_no_vd_buffer_limit=a.FEATURE_ms_teams_data_channel=a.FEATURE_ms_teams_webrtc_1dot0=a.FEATURE_ms_teams_multi_window=a.FEATURE_ms_teams_gtc=a.FEATURE_ms_teams_e911=a.FEATURE_ms_teams_codec_capability=a.FEATURE_ms_teams_app_sharing=a.FEATURE_ms_teams_monitor_sharing=a.FEATURE_ms_teams_video_placement=a.FEATURE_ms_teams_dtmf=a.FEATURE_ms_teams_device_group_id=a.FEATURE_ms_teams_remote_audio_notifications=a.FEATURE_ms_teams_endpoint_id=a.FEATURE_ms_teams_osinfo=
a.FEATURE_ms_teams_mstrack_constraints=a.FEATURE_ms_teams_1912=a.FEATURE_ms_teams_pstn=a.FEATURE_ms_teams_1911=a.FEATURE_ms_teams_common_media_constraints=a.FEATURE_ms_teams_speaking_indicator=a.FEATURE_ms_teams_desktop_sharing=a.FEATURE_vda_delete_viewport=a.FEATURE_vda_multi_window=a.FEATURE_vda_app_sharing=a.FEATURE_vda_service_no_buffer_limit=a.HDXMS_VERSION=a.BUILD_TYPE_SDK=void 0;b=c(269);var e=c(269);Object.defineProperty(a,"VersionData",{enumerable:!0,get:function(){return e.VersionData}});
Object.defineProperty(a,"FeatureData",{enumerable:!0,get:function(){return e.FeatureData}});Object.defineProperty(a,"OSInfo",{enumerable:!0,get:function(){return e.OSInfo}});Object.defineProperty(a,"EndpointId",{enumerable:!0,get:function(){return e.EndpointId}});Object.defineProperty(a,"HardwareInfo",{enumerable:!0,get:function(){return e.HardwareInfo}});a.BUILD_TYPE_SDK=!0;a.HDXMS_VERSION="3.1.0";a.FEATURE_vda_service_no_buffer_limit="wsservice_no_buffer_limit";a.FEATURE_vda_app_sharing="webrtc_app_sharing";
a.FEATURE_vda_multi_window="webrtc_multi_window";a.FEATURE_vda_delete_viewport="overlay_delete_viewport";a.FEATURE_ms_teams_desktop_sharing="ms_teams_desktop_sharing";a.FEATURE_ms_teams_speaking_indicator="ms_teams_speaking_indicator";a.FEATURE_ms_teams_common_media_constraints="ms_teams_common_media_constraints";a.FEATURE_ms_teams_1911="ms_teams_1911";a.FEATURE_ms_teams_pstn="ms_teams_pstn";a.FEATURE_ms_teams_1912="ms_teams_1912";a.FEATURE_ms_teams_mstrack_constraints="ms_teams_mstrack_constraints";
a.FEATURE_ms_teams_osinfo="ms_teams_osinfo";a.FEATURE_ms_teams_endpoint_id="ms_teams_endpoint_id";a.FEATURE_ms_teams_remote_audio_notifications="ms_teams_remote_audio_notifications";a.FEATURE_ms_teams_device_group_id="ms_teams_device_group_id";a.FEATURE_ms_teams_dtmf="ms_teams_dtmf";a.FEATURE_ms_teams_video_placement="ms_teams_video_placement";a.FEATURE_ms_teams_monitor_sharing="ms_teams_multi_monitor_sharing";a.FEATURE_ms_teams_app_sharing="ms_teams_app_sharing";a.FEATURE_ms_teams_codec_capability=
"ms_teams_codec_capability";a.FEATURE_ms_teams_e911="ms_teams_e911";a.FEATURE_ms_teams_gtc="ms_teams_gtc";a.FEATURE_ms_teams_multi_window="ms_teams_multi_windows";a.FEATURE_ms_teams_webrtc_1dot0="ms_teams_webrtc_1.0";a.FEATURE_ms_teams_data_channel="ms_teams_data_channel";a.FEATURE_ms_teams_no_vd_buffer_limit="ms_teams_no_vd_buffer_limit";a.FEATURE_ms_teams_client_info="ms_teams_client_info";a.FEATURE_ms_teams_stream_resolution="ms_teams_stream_resolution";a.FEATURE_ms_teams_secondary_audio_notifications=
"ms_teams_secondary_audio_notifications";a.FEATURE_ms_teams_hardware_info="ms_teams_hardware_info";a.FEATURE_ms_teams_stream_active_status="ms_teams_stream_active_status";a.FEATURE_ms_teams_share_system_audio="ms_teams_share_system_audio";a.FEATURE_ms_teams_audio_notifications_loop="ms_teams_audio_notifications_loop";a.FEATURE_ms_teams_track_clone_with_id="ms_teams_track_clone_with_id";a.FEATURE_ms_teams_enumerate_devices_v2="ms_teams_enumerate_devices_v2";a.FEATURE_ms_teams_sender_stats_fix="ms_teams_sender_stats_fix";
new b.WebrpcFeatureInfo(b.FEATURE_ms_teams_redirection,new b.VersionData(1,1,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_desktop_sharing,new b.VersionData(1,2,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_speaking_indicator,new b.VersionData(1,2,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_common_media_constraints,new b.VersionData(1,4,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_1911,new b.VersionData(1,4,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_1912,new b.VersionData(1,5,
0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_mstrack_constraints,new b.VersionData(1,6,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_pstn,new b.VersionData(1,6,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_osinfo,new b.VersionData(1,7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_endpoint_id,new b.VersionData(1,7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_remote_audio_notifications,new b.VersionData(1,7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_device_group_id,new b.VersionData(1,
7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_codec_capability,new b.VersionData(1,7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_dtmf,new b.VersionData(1,7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_video_placement,new b.VersionData(1,7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_monitor_sharing,new b.VersionData(1,7,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_app_sharing,new b.VersionData(1,8,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_webrtc_1dot0,new b.VersionData(1,
8,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_data_channel,new b.VersionData(1,8,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_e911,new b.VersionData(1,13,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_multi_window,new b.VersionData(1,14,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_client_info,new b.VersionData(1,19,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_stream_resolution,new b.VersionData(1,25,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_secondary_audio_notifications,
new b.VersionData(1,21,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_hardware_info,new b.VersionData(1,35,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_stream_active_status,new b.VersionData(1,32,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_audio_notifications_loop,new b.VersionData(1,33,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_track_clone_with_id,new b.VersionData(1,33,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_enumerate_devices_v2,new b.VersionData(1,35,0,0));new b.WebrpcFeatureInfo(a.FEATURE_ms_teams_sender_stats_fix,
new b.VersionData(1,36,0,0));c=function(){function a(){}a.FEATURE_public_screenshare="screenshare";a.FEATURE_public_redirection="redirection";a.FEATURE_public_speaking_indicator="speaking_indicator";a.FEATURE_public_pstn="pstn";a.FEATURE_public_osinfo="osinfo";a.FEATURE_public_endpoint_id="endpointid";a.FEATURE_public_remote_audio_notifications="remoteaudionotifications";a.FEATURE_public_device_group_id="compositedevices";a.FEATURE_public_dtmf="dtmf";a.FEATURE_public_monitor_sharing="multimonitorscreenshare";
a.FEATURE_public_app_sharing="appshare";a.FEATURE_public_codec_capability="codec_capability";a.FEATURE_public_e911="e911";a.FEATURE_public_webrtc1dot0="webrtc1.0";a.FEATURE_public_data_channel="datachannel";a.FEATURE_public_vdnobuflimit="vdnobuflimit";a.FEATURE_public_multi_window="multiwindow";a.FEATURE_public_secondary_audio_notifications="secondaryringer";a.FEATURE_public_stream_resolution="streamresolution";a.FEATURE_public_track_clone_with_id="track_clone_with_id";a.FEATURE_public_sender_stats_fix=
"sender_stats_fix";a.FEATURE_public_audio_notification_loop="loop";return a}();a.Features=c;a.featureNameMap={};a.featureNameMap[c.FEATURE_public_screenshare]=[a.FEATURE_ms_teams_desktop_sharing];a.featureNameMap[c.FEATURE_public_redirection]=[b.FEATURE_ms_teams_redirection];a.featureNameMap[c.FEATURE_public_speaking_indicator]=[a.FEATURE_ms_teams_speaking_indicator];a.featureNameMap[c.FEATURE_public_pstn]=[a.FEATURE_ms_teams_pstn];a.featureNameMap[c.FEATURE_public_osinfo]=[a.FEATURE_ms_teams_osinfo];
a.featureNameMap[c.FEATURE_public_endpoint_id]=[a.FEATURE_ms_teams_endpoint_id];a.featureNameMap[c.FEATURE_public_remote_audio_notifications]=[a.FEATURE_ms_teams_remote_audio_notifications,a.FEATURE_ms_teams_secondary_audio_notifications];a.featureNameMap[c.FEATURE_public_device_group_id]=[a.FEATURE_ms_teams_device_group_id];a.featureNameMap[c.FEATURE_public_dtmf]=[a.FEATURE_ms_teams_dtmf];a.featureNameMap[c.FEATURE_public_monitor_sharing]=[a.FEATURE_ms_teams_monitor_sharing];a.featureNameMap[c.FEATURE_public_app_sharing]=
[a.FEATURE_ms_teams_app_sharing];a.featureNameMap[c.FEATURE_public_codec_capability]=[a.FEATURE_ms_teams_codec_capability];a.featureNameMap[c.FEATURE_public_e911]=[a.FEATURE_ms_teams_e911];a.featureNameMap[c.FEATURE_public_webrtc1dot0]=[a.FEATURE_ms_teams_webrtc_1dot0];a.featureNameMap[c.FEATURE_public_multi_window]=[a.FEATURE_ms_teams_multi_window];a.featureNameMap[c.FEATURE_public_data_channel]=[a.FEATURE_ms_teams_data_channel];a.featureNameMap[c.FEATURE_public_vdnobuflimit]=[a.FEATURE_ms_teams_no_vd_buffer_limit];
a.featureNameMap[c.FEATURE_public_secondary_audio_notifications]=[a.FEATURE_ms_teams_remote_audio_notifications,a.FEATURE_ms_teams_secondary_audio_notifications];a.featureNameMap[c.FEATURE_public_stream_resolution]=[a.FEATURE_ms_teams_stream_resolution];a.featureNameMap[c.FEATURE_public_track_clone_with_id]=[a.FEATURE_ms_teams_track_clone_with_id];a.featureNameMap[c.FEATURE_public_sender_stats_fix]=[a.FEATURE_ms_teams_sender_stats_fix];a.featureNameMap[c.FEATURE_public_audio_notification_loop]=[a.FEATURE_ms_teams_audio_notifications_loop];
a.vdaFeatureNameMap={};a.vdaFeatureNameMap[c.FEATURE_public_multi_window]=[a.FEATURE_vda_multi_window];a.vdaFeatureNameMap[c.FEATURE_public_app_sharing]=[a.FEATURE_vda_app_sharing];(function(a){a[a.EngineControl=0]="EngineControl";a[a.RTCPeerConnection=1]="RTCPeerConnection";a[a.RTCSessionDescription=2]="RTCSessionDescription";a[a.RTCIceCandidate=3]="RTCIceCandidate";a[a.RTCIceCandidateEvent=4]="RTCIceCandidateEvent";a[a.MediaDevices=5]="MediaDevices";a[a.MediaDeviceInfo=6]="MediaDeviceInfo";a[a.MediaStreamTrack=
7]="MediaStreamTrack";a[a.MediaStreamEvent=8]="MediaStreamEvent";a[a.MediaStream=9]="MediaStream";a[a.NavigatorUserMedia=10]="NavigatorUserMedia";a[a.VideoElement=11]="VideoElement";a[a.AudioElement=12]="AudioElement";a[a.RTCRtpReceiver=13]="RTCRtpReceiver";a[a.RTCRtpSender=14]="RTCRtpSender";a[a.RTCDtlsTransport=15]="RTCDtlsTransport";a[a.RTCIceTransport=16]="RTCIceTransport";a[a.RTCDTMFSender=17]="RTCDTMFSender";a[a.RTCDTMFToneChangeEvent=18]="RTCDTMFToneChangeEvent";a[a.RTCIceCandidatePair=19]=
"RTCIceCandidatePair";a[a.RTCRtpTransceiver=20]="RTCRtpTransceiver";a[a.ScreenSharingRemote=21]="ScreenSharingRemote";a[a.ScreenSource=22]="ScreenSource";a[a.E911Service=23]="E911Service";a[a.reserved2=24]="reserved2";a[a.RTCDataChannel=25]="RTCDataChannel";a[a.RTCSctpTransport=26]="RTCSctpTransport";a[a.StreamResolution=27]="StreamResolution";a[a.VideoEffect=28]="VideoEffect";a[a.reserved6=29]="reserved6";a[a.reserved7=30]="reserved7";a[a.reserved8=31]="reserved8"})(c=a.class_id_t||(a.class_id_t=
{}));var l;(function(a){a[a.ctor=0]="ctor";a[a.version=1]="version";a[a.feature_flags=2]="feature_flags";a[a.version_info=3]="version_info";a[a.osinfo=4]="osinfo";a[a.endpoint_id=5]="endpoint_id";a[a.set_client_info=6]="set_client_info";a[a.hardware_info=7]="hardware_info"})(l=a.method_id_EngineControl_t||(a.method_id_EngineControl_t={}));var h;(function(a){a[a.ctor=0]="ctor";a[a.localDescription=1]="localDescription";a[a.remoteDescription=2]="remoteDescription";a[a.readyState=3]="readyState";a[a.iceState=
4]="iceState";a[a.localStreams=5]="localStreams";a[a.remoteStreams=6]="remoteStreams";a[a.createOffer=7]="createOffer";a[a.createAnswer=8]="createAnswer";a[a.setLocalDescription=9]="setLocalDescription";a[a.setRemoteDescription=10]="setRemoteDescription";a[a.updateIce=11]="updateIce";a[a.addIceCandidate=12]="addIceCandidate";a[a.addStream=13]="addStream";a[a.removeStream=14]="removeStream";a[a.close=15]="close";a[a.iceConnectionState=16]="iceConnectionState";a[a.iceGatheringState=17]="iceGatheringState";
a[a.signalingState=18]="signalingState";a[a.onaddstream=19]="onaddstream";a[a.onicecandidate=20]="onicecandidate";a[a.oniceconnectionstatechange=21]="oniceconnectionstatechange";a[a.onicegatheringstatechange=22]="onicegatheringstatechange";a[a.onsignalingstatechange=23]="onsignalingstatechange";a[a.onnegotiationneeded=24]="onnegotiationneeded";a[a.onremovestream=25]="onremovestream";a[a.getStats=26]="getStats";a[a.getReceivers=27]="getReceivers";a[a.getSenders=28]="getSenders";a[a.addTrack=29]="addTrack";
a[a.removeTrack=30]="removeTrack";a[a.ontrack=31]="ontrack";a[a.setLocalDescription_v2=32]="setLocalDescription_v2";a[a.setRemoteDescription_v2=33]="setRemoteDescription_v2";a[a.addTransceiverWithTrack=34]="addTransceiverWithTrack";a[a.addTransceiverWithKind=35]="addTransceiverWithKind";a[a.getTransceivers=36]="getTransceivers";a[a.onconnectionstatechange=37]="onconnectionstatechange";a[a.sctp=38]="sctp";a[a.ondatachannel=39]="ondatachannel";a[a.createDataChannel=40]="createDataChannel";a[a.getStats_v2=
41]="getStats_v2"})(h=a.method_id_RTCPeerConnection_t||(a.method_id_RTCPeerConnection_t={}));var d;(function(a){a[a.ctor=0]="ctor";a[a.enumerateDevices=1]="enumerateDevices";a[a.getDisplayMedia=2]="getDisplayMedia";a[a.ondevicechange=3]="ondevicechange";a[a.enumerateDevicesV2=4]="enumerateDevicesV2"})(d=a.method_id_MediaDevices_t||(a.method_id_MediaDevices_t={}));var p;(function(a){a[a.ctor=0]="ctor";a[a.deviceId=1]="deviceId";a[a.kind=2]="kind";a[a.label=3]="label";a[a.groupId=4]="groupId"})(p=a.method_id_MediaDeviceInfo_t||
(a.method_id_MediaDeviceInfo_t={}));var q;(function(a){a[a.ctor=0]="ctor";a[a.type=1]="type";a[a.sdp=2]="sdp"})(q=a.method_id_RTCSessionDescription_t||(a.method_id_RTCSessionDescription_t={}));var n;(function(a){a[a.ctor=0]="ctor";a[a.kind=1]="kind";a[a.id=2]="id";a[a.label=3]="label";a[a.enabled=4]="enabled";a[a.muted=5]="muted";a[a.readyState=6]="readyState";a[a.onended=7]="onended";a[a.onmute=8]="onmute";a[a.onunmute=9]="onunmute";a[a.clone=10]="clone";a[a.stop=11]="stop";a[a.getCapabilities=12]=
"getCapabilities";a[a.getSettings=13]="getSettings";a[a.applyConstraints=14]="applyConstraints";a[a.getConstraints=15]="getConstraints"})(n=a.method_id_MediaStreamTrack_t||(a.method_id_MediaStreamTrack_t={}));var k;(function(a){a[a.ctor=0]="ctor";a[a.id=1]="id";a[a.getAudioTracks=2]="getAudioTracks";a[a.getVideoTracks=3]="getVideoTracks";a[a.getTracks=4]="getTracks";a[a.getTrackById=5]="getTrackById";a[a.addTrack=6]="addTrack";a[a.removeTrack=7]="removeTrack";a[a.clone=8]="clone";a[a.active=9]="active"})(k=
a.method_id_MediaStream_t||(a.method_id_MediaStream_t={}));var v;(function(a){a[a.ctor=0]="ctor";a[a.getUserMedia=1]="getUserMedia";a[a.setCodecCapabilities=2]="setCodecCapabilities";a[a.getCapabilities=3]="getCapabilities"})(v=a.method_id_NavigatorUserMedia_t||(a.method_id_NavigatorUserMedia_t={}));var z;(function(a){a[a.ctor=0]="ctor";a[a.candidate=1]="candidate";a[a.sdpMid=2]="sdpMid";a[a.sdpMLineIndex=3]="sdpMLineIndex"})(z=a.method_id_RTCIceCandidate_t||(a.method_id_RTCIceCandidate_t={}));var g;
(function(a){a[a.ctor=0]="ctor";a[a.candidate=1]="candidate"})(g=a.method_id_RTCIceCandidateEvent_t||(a.method_id_RTCIceCandidateEvent_t={}));var B;(function(a){a[a.ctor=0]="ctor";a[a.stream=1]="stream"})(B=a.method_id_MediaStreamEvent_t||(a.method_id_MediaStreamEvent_t={}));var t;(function(a){a[a.ctor=0]="ctor";a[a.sinkId=1]="sinkId";a[a.connectTo=2]="connectTo";a[a.disconnect=3]="disconnect";a[a.setFrame=4]="setFrame";a[a.addClipRect=5]="addClipRect";a[a.removeClipRect=6]="removeClipRect";a[a.onerror=
7]="onerror";a[a.onvideoframechanged=8]="onvideoframechanged";a[a.placement=9]="placement"})(t=a.method_id_VideoElement_t||(a.method_id_VideoElement_t={}));var m;(function(a){a[a.ctor=0]="ctor";a[a.sinkId=1]="sinkId";a[a.srcObject=2]="srcObject";a[a.src=3]="src";a[a.play=4]="play";a[a.pause=5]="pause";a[a.loop=6]="loop"})(m=a.method_id_AudioElement_t||(a.method_id_AudioElement_t={}));var D;(function(a){a[a.ctor=0]="ctor";a[a.track=1]="track";a[a.getContributingSources=2]="getContributingSources";
a[a.getSynchronizationSources=3]="getSynchronizationSources";a[a.transport=4]="transport";a[a.rtcpTransport=5]="rtcpTransport";a[a.getCapabilities=6]="getCapabilities";a[a.getParameters=7]="getParameters";a[a.getStats=8]="getStats";a[a.getCapabilities_v2=9]="getCapabilities_v2"})(D=a.method_id_RTCRtpReceiver_t||(a.method_id_RTCRtpReceiver_t={}));var y;(function(a){a[a.ctor=0]="ctor";a[a.track=1]="track";a[a.transport=2]="transport";a[a.rtcpTransport=3]="rtcpTransport";a[a.dtmf=4]="dtmf";a[a.getCapabilities=
5]="getCapabilities";a[a.getParameters=6]="getParameters";a[a.setParameters=7]="setParameters";a[a.replaceTrack=8]="replaceTrack";a[a.getStats=9]="getStats";a[a.setStreams=10]="setStreams";a[a.getCapabilities_v2=11]="getCapabilities_v2"})(y=a.method_id_RTCRtpSender_t||(a.method_id_RTCRtpSender_t={}));var x;(function(a){a[a.ctor=0]="ctor";a[a.transport=1]="transport";a[a.state=2]="state";a[a.getRemoteCertificates=3]="getRemoteCertificates";a[a.onstatechange=4]="onstatechange";a[a.onerror=5]="onerror"})(x=
a.method_id_RTCDtlsTransport_t||(a.method_id_RTCDtlsTransport_t={}));var r;(function(a){a[a.ctor=0]="ctor";a[a.role=1]="role";a[a.component=2]="component";a[a.state=3]="state";a[a.gatheringState=4]="gatheringState";a[a.localcandidates=5]="localcandidates";a[a.remotecandidates=6]="remotecandidates";a[a.onstatechange=7]="onstatechange";a[a.ongatheringstatechange=8]="ongatheringstatechange";a[a.onselectedcandidatepairchange=9]="onselectedcandidatepairchange"})(r=a.method_id_RTCIceTransport_t||(a.method_id_RTCIceTransport_t=
{}));var A;(function(a){a[a.ctor=0]="ctor";a[a.insertDTMF=1]="insertDTMF";a[a.ontonechange=2]="ontonechange";a[a.canInsertDTMF=3]="canInsertDTMF";a[a.toneBuffer=4]="toneBuffer"})(A=a.method_id_RTCDTMFSender_t||(a.method_id_RTCDTMFSender_t={}));var M;(function(a){a[a.ctor=0]="ctor";a[a.tone=1]="tone";a[a.tone_buffer=2]="tone_buffer"})(M=a.method_id_RTCDTMFToneChangeEvent_t||(a.method_id_RTCDTMFToneChangeEvent_t={}));var F;(function(a){a[a.ctor=0]="ctor";a[a.local=1]="local";a[a.remote=2]="remote"})(F=
a.method_id_RTCIceCandidatePair_t||(a.method_id_RTCIceCandidatePair_t={}));var J;(function(a){a[a.ctor=0]="ctor";a[a.mid=1]="mid";a[a.sender=2]="sender";a[a.receiver=3]="receiver";a[a.direction=4]="direction";a[a.currentDirection=5]="currentDirection";a[a.stop=6]="stop";a[a.setCodecPreferences=7]="setCodecPreferences"})(J=a.method_id_RTCRtpTransceiver_t||(a.method_id_RTCRtpTransceiver_t={}));var G;(function(a){a[a.ctor=0]="ctor";a[a.getScreensAsync=1]="getScreensAsync";a[a.onscreentopologychanged=
2]="onscreentopologychanged"})(G=a.method_id_VDISharingRemote_t||(a.method_id_VDISharingRemote_t={}));var L;(function(a){a[a.ctor=0]="ctor";a[a.srcid=1]="srcid";a[a.deviceid=2]="deviceid";a[a.type=3]="type";a[a.name=4]="name";a[a.imagedata=5]="imagedata";a[a.hwnd=6]="hwnd";a[a.origin=7]="origin";a[a.caption=8]="caption";a[a.pid=9]="pid";a[a.bounds=10]="bounds"})(L=a.method_id_ScreenSource_t||(a.method_id_ScreenSource_t={}));var P;(function(a){a[a.ctor=0]="ctor";a[a.getE911Info=1]="getE911Info";a[a.onupdate=
2]="onupdate"})(P=a.method_id_E911Service_t||(a.method_id_E911Service_t={}));var C;(function(a){a[a.ctor=0]="ctor";a[a.label=1]="label";a[a.ordered=2]="ordered";a[a.maxPacketLifeTime=3]="maxPacketLifeTime";a[a.maxRetransmits=4]="maxRetransmits";a[a.protocol=5]="protocol";a[a.negotiated=6]="negotiated";a[a.id=7]="id";a[a.readyState=8]="readyState";a[a.bufferedAmount=9]="bufferedAmount";a[a.bufferedAmountLowThreshold=10]="bufferedAmountLowThreshold";a[a.onopen=11]="onopen";a[a.onbufferedamountlow=12]=
"onbufferedamountlow";a[a.onerror=13]="onerror";a[a.onclosing=14]="onclosing";a[a.onclose=15]="onclose";a[a.onmessage=16]="onmessage";a[a.close=17]="close";a[a.send_text=18]="send_text";a[a.send_binary=19]="send_binary"})(C=a.method_id_RTCDataChannel_t||(a.method_id_RTCDataChannel_t={}));var R;(function(a){a[a.ctor=0]="ctor";a[a.transport=1]="transport";a[a.state=2]="state";a[a.maxMessageSize=3]="maxMessageSize";a[a.maxChannels=4]="maxChannels";a[a.onstatechange=5]="onstatechange"})(R=a.method_id_RTCSctpTransport_t||
(a.method_id_RTCSctpTransport_t={}));var K;(function(a){a[a.ctor=0]="ctor";a[a.getCallConstraints=1]="getCallConstraints";a[a.onupdate=2]="onupdate"})(K=a.method_id_StreamResolution_t||(a.method_id_StreamResolution_t={}));a.class_lib_info=new b.WebrpcClassLibInfo("webrpc_class_library",[new b.WebrpcClassInfo(c.EngineControl,"EngineControl",[new b.WebrpcMethodInfo(c.EngineControl,l.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.EngineControl,l.version,"version",!0),new b.WebrpcMethodInfo(c.EngineControl,
l.feature_flags,"feature_flags",!0),new b.WebrpcMethodInfo(c.EngineControl,l.version_info,"version_info",!0,a.FEATURE_ms_teams_desktop_sharing),new b.WebrpcMethodInfo(c.EngineControl,l.osinfo,"osinfo",!0,a.FEATURE_ms_teams_osinfo),new b.WebrpcMethodInfo(c.EngineControl,l.endpoint_id,"endpoint_id",!0,a.FEATURE_ms_teams_endpoint_id),new b.WebrpcMethodInfo(c.EngineControl,l.set_client_info,"set_client_info",!1,a.FEATURE_ms_teams_client_info),new b.WebrpcMethodInfo(c.EngineControl,l.hardware_info,"hardware_info",
!0,a.FEATURE_ms_teams_hardware_info)]),new b.WebrpcClassInfo(c.RTCPeerConnection,"RTCPeerConnection",[new b.WebrpcMethodInfo(c.RTCPeerConnection,h.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.localDescription,"localDescription",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.remoteDescription,"remoteDescription",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.readyState,"readyState",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.iceState,"iceState",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,
h.localStreams,"localStreams",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.remoteStreams,"remoteStreams",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.createOffer,"createOffer",!1),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.createAnswer,"createAnswer",!1),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.setLocalDescription,"setLocalDescription",!1),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.setRemoteDescription,"setRemoteDescription",!1),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.updateIce,
"updateIce",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.addIceCandidate,"addIceCandidate",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.addStream,"addStream",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.removeStream,"removeStream",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.close,"close",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.iceConnectionState,"iceConnectionState",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.iceGatheringState,"iceGatheringState",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,
h.signalingState,"signalingState",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.onaddstream,"onaddstream",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.onicecandidate,"onicecandidate",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.oniceconnectionstatechange,"oniceconnectionstatechange",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.onicegatheringstatechange,"onicegatheringstatechange",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.onsignalingstatechange,"onsignalingstatechange",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,
h.onnegotiationneeded,"onnegotiationneeded",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.onremovestream,"onremovestream",!0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.getStats,"getStats",!1),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.getReceivers,"getReceivers",!1,a.FEATURE_ms_teams_speaking_indicator),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.getSenders,"getSenders",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.addTrack,"addTrack",!1,a.FEATURE_ms_teams_pstn),
new b.WebrpcMethodInfo(c.RTCPeerConnection,h.removeTrack,"removeTrack",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.ontrack,"ontrack",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.setLocalDescription_v2,"setLocalDescription_v2",!1,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.setRemoteDescription_v2,"setRemoteDescription_v2",!1,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.addTransceiverWithTrack,
"addTransceiverWithTrack",!1,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.addTransceiverWithKind,"addTransceiverWithKind",!1,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.getTransceivers,"getTransceivers",!1,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.onconnectionstatechange,"onconnectionstatechange",!0,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.sctp,"sctp",!0,a.FEATURE_ms_teams_data_channel),
new b.WebrpcMethodInfo(c.RTCPeerConnection,h.ondatachannel,"ondatachannel",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.createDataChannel,"createDataChannel",!1,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCPeerConnection,h.getStats_v2,"getStats_v2",!1,a.FEATURE_ms_teams_webrtc_1dot0)]),new b.WebrpcClassInfo(c.RTCSessionDescription,"RTCSessionDescription",[new b.WebrpcMethodInfo(c.RTCSessionDescription,q.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.RTCSessionDescription,
q.type,"type",!0),new b.WebrpcMethodInfo(c.RTCSessionDescription,q.sdp,"sdp",!0)]),new b.WebrpcClassInfo(c.RTCIceCandidate,"RTCIceCandidate",[new b.WebrpcMethodInfo(c.RTCIceCandidate,z.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.RTCIceCandidate,z.candidate,"candidate",!0),new b.WebrpcMethodInfo(c.RTCIceCandidate,z.sdpMid,"sdpMid",!0),new b.WebrpcMethodInfo(c.RTCIceCandidate,z.sdpMLineIndex,"sdpMLineIndex",!0)]),new b.WebrpcClassInfo(c.RTCIceCandidateEvent,"RTCIceCandidateEvent",[new b.WebrpcMethodInfo(c.RTCIceCandidateEvent,
g.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.RTCIceCandidateEvent,g.candidate,"candidate",!0)]),new b.WebrpcClassInfo(c.MediaDevices,"MediaDevices",[new b.WebrpcMethodInfo(c.MediaDevices,d.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.MediaDevices,d.enumerateDevices,"enumerateDevices",!1),new b.WebrpcMethodInfo(c.MediaDevices,d.getDisplayMedia,"getDisplayMedia",!1,a.FEATURE_ms_teams_desktop_sharing),new b.WebrpcMethodInfo(c.MediaDevices,d.ondevicechange,"ondevicechange",!0,a.FEATURE_ms_teams_speaking_indicator),
new b.WebrpcMethodInfo(c.MediaDevices,d.enumerateDevicesV2,"enuerateDevicesV2",!1,a.FEATURE_ms_teams_enumerate_devices_v2)]),new b.WebrpcClassInfo(c.MediaDeviceInfo,"MediaDeviceInfo",[new b.WebrpcMethodInfo(c.MediaDeviceInfo,p.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.MediaDeviceInfo,p.deviceId,"deviceId",!0),new b.WebrpcMethodInfo(c.MediaDeviceInfo,p.kind,"kind",!0),new b.WebrpcMethodInfo(c.MediaDeviceInfo,p.label,"label",!0),new b.WebrpcMethodInfo(c.MediaDeviceInfo,p.groupId,"groupId",!0)]),new b.WebrpcClassInfo(c.MediaStreamTrack,
"MediaStreamTrack",[new b.WebrpcMethodInfo(c.MediaStreamTrack,n.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.MediaStreamTrack,n.clone,"clone",!1),new b.WebrpcMethodInfo(c.MediaStreamTrack,n.stop,"stop",!1),new b.WebrpcMethodInfo(c.MediaStreamTrack,n.getCapabilities,"getCapabilities",!1),new b.WebrpcMethodInfo(c.MediaStreamTrack,n.getSettings,"getSettings",!1),new b.WebrpcMethodInfo(c.MediaStreamTrack,n.applyConstraints,"applyConstraints",!1,a.FEATURE_ms_teams_desktop_sharing),new b.WebrpcMethodInfo(c.MediaStreamTrack,
n.kind,"kind",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,n.id,"id",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,n.label,"label",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,n.enabled,"enabled",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,n.muted,"muted",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,n.readyState,"readyState",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,n.onended,"onended",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,n.onmute,"onmute",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,
n.onunmute,"onunmute",!0),new b.WebrpcMethodInfo(c.MediaStreamTrack,n.getConstraints,"getConstraints",!1,a.FEATURE_ms_teams_mstrack_constraints)]),new b.WebrpcClassInfo(c.MediaStream,"MediaStream",[new b.WebrpcMethodInfo(c.MediaStream,k.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.MediaStream,k.id,"id",!0),new b.WebrpcMethodInfo(c.MediaStream,k.getAudioTracks,"getAudioTracks",!1),new b.WebrpcMethodInfo(c.MediaStream,k.getVideoTracks,"getVideoTracks",!1),new b.WebrpcMethodInfo(c.MediaStream,k.getTracks,
"getTracks",!1),new b.WebrpcMethodInfo(c.MediaStream,k.getTrackById,"getTrackById",!1),new b.WebrpcMethodInfo(c.MediaStream,k.addTrack,"addTrack",!1),new b.WebrpcMethodInfo(c.MediaStream,k.removeTrack,"removeTrack",!1),new b.WebrpcMethodInfo(c.MediaStream,k.clone,"clone",!0),new b.WebrpcMethodInfo(c.MediaStream,k.active,"active",!0)]),new b.WebrpcClassInfo(c.NavigatorUserMedia,"NavigatorUserMedia",[new b.WebrpcMethodInfo(c.NavigatorUserMedia,v.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.NavigatorUserMedia,
v.getUserMedia,"getUserMedia",!1),new b.WebrpcMethodInfo(c.NavigatorUserMedia,v.setCodecCapabilities,"setCodecCapabilities",!1,a.FEATURE_ms_teams_codec_capability),new b.WebrpcMethodInfo(c.NavigatorUserMedia,v.getCapabilities,"getRtpCapabilities",!1,a.FEATURE_ms_teams_webrtc_1dot0)]),new b.WebrpcClassInfo(c.MediaStreamEvent,"MediaStreamEvent",[new b.WebrpcMethodInfo(c.MediaStreamEvent,B.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.MediaStreamEvent,B.stream,"stream",!0)]),new b.WebrpcClassInfo(c.VideoElement,
"VideoElement",[new b.WebrpcMethodInfo(c.VideoElement,t.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.VideoElement,t.sinkId,"sinkId",!0),new b.WebrpcMethodInfo(c.VideoElement,t.connectTo,"connectTo",!1),new b.WebrpcMethodInfo(c.VideoElement,t.disconnect,"disconnect",!1),new b.WebrpcMethodInfo(c.VideoElement,t.setFrame,"setFrame",!1),new b.WebrpcMethodInfo(c.VideoElement,t.addClipRect,"addClipRect",!1),new b.WebrpcMethodInfo(c.VideoElement,t.removeClipRect,"removeClipRect",!1),new b.WebrpcMethodInfo(c.VideoElement,
t.onerror,"onerror",!0),new b.WebrpcMethodInfo(c.VideoElement,t.onvideoframechanged,"onvideoframechanged",!0),new b.WebrpcMethodInfo(c.VideoElement,t.placement,"placement",!0,a.FEATURE_ms_teams_video_placement)]),new b.WebrpcClassInfo(c.AudioElement,"AudioElement",[new b.WebrpcMethodInfo(c.AudioElement,m.ctor,"ctor",!1),new b.WebrpcMethodInfo(c.AudioElement,m.sinkId,"sinkId",!0),new b.WebrpcMethodInfo(c.AudioElement,m.srcObject,"srcObject",!0),new b.WebrpcMethodInfo(c.AudioElement,m.src,"src",!0),
new b.WebrpcMethodInfo(c.AudioElement,m.play,"play",!1),new b.WebrpcMethodInfo(c.AudioElement,m.pause,"pause",!1),new b.WebrpcMethodInfo(c.AudioElement,m.loop,"loop",!0,a.FEATURE_ms_teams_audio_notifications_loop)]),new b.WebrpcClassInfo(c.RTCRtpReceiver,"RTCRtpReceiver",[new b.WebrpcMethodInfo(c.RTCRtpReceiver,D.ctor,"ctor",!1,a.FEATURE_ms_teams_speaking_indicator),new b.WebrpcMethodInfo(c.RTCRtpReceiver,D.track,"track",!0,a.FEATURE_ms_teams_speaking_indicator),new b.WebrpcMethodInfo(c.RTCRtpReceiver,
D.getContributingSources,"getContributingSources",!1,a.FEATURE_ms_teams_speaking_indicator),new b.WebrpcMethodInfo(c.RTCRtpReceiver,D.getSynchronizationSources,"getSynchronizationSources",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpReceiver,D.transport,"transport",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpReceiver,D.rtcpTransport,"rtcptransport",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpReceiver,D.getCapabilities,"getCapabilities",!1,a.FEATURE_ms_teams_pstn),
new b.WebrpcMethodInfo(c.RTCRtpReceiver,D.getParameters,"getParameters",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpReceiver,D.getStats,"getStats",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpReceiver,D.getCapabilities_v2,"getCapabilities_v2",!1,a.FEATURE_ms_teams_webrtc_1dot0)]),new b.WebrpcClassInfo(c.RTCRtpSender,"RTCRtpSender",[new b.WebrpcMethodInfo(c.RTCRtpSender,y.ctor,"ctor",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,y.track,"track",!0,a.FEATURE_ms_teams_pstn),
new b.WebrpcMethodInfo(c.RTCRtpSender,y.transport,"transport",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,y.rtcpTransport,"rtcpTransport",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,y.dtmf,"dtmf",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,y.getCapabilities,"getCapabilities",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,y.getParameters,"getParameters",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,
y.setParameters,"setParameters",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,y.replaceTrack,"replaceTrack",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,y.getStats,"getStats",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,y.setStreams,"setStreams",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCRtpSender,y.getCapabilities_v2,"getCapabilities_v2",!1,a.FEATURE_ms_teams_webrtc_1dot0)]),new b.WebrpcClassInfo(c.RTCDtlsTransport,"RTCDtlsTransport",
[new b.WebrpcMethodInfo(c.RTCDtlsTransport,x.ctor,"ctor",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDtlsTransport,x.transport,"transport",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDtlsTransport,x.state,"state",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDtlsTransport,x.getRemoteCertificates,"getRemoteCertificates",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDtlsTransport,x.onstatechange,"onstatechange",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDtlsTransport,
x.onerror,"onerror",!0,a.FEATURE_ms_teams_pstn)]),new b.WebrpcClassInfo(c.RTCIceTransport,"RTCIceTransport",[new b.WebrpcMethodInfo(c.RTCIceTransport,r.ctor,"ctor",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,r.role,"role",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,r.component,"component",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,r.state,"state",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,r.gatheringState,
"gatheringState",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,r.localcandidates,"localcandidates",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,r.remotecandidates,"remotecandidates",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,r.onstatechange,"onstatechange",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,r.ongatheringstatechange,"ongatheringstatechange",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceTransport,
r.onselectedcandidatepairchange,"onselectedcandidatepairchange",!0,a.FEATURE_ms_teams_pstn)]),new b.WebrpcClassInfo(c.RTCDTMFSender,"RTCDTMFSender",[new b.WebrpcMethodInfo(c.RTCDTMFSender,A.ctor,"ctor",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDTMFSender,A.insertDTMF,"insertDTMF",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDTMFSender,A.ontonechange,"ontonechange",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDTMFSender,A.canInsertDTMF,"canInsertDTMF",!0,a.FEATURE_ms_teams_pstn),
new b.WebrpcMethodInfo(c.RTCDTMFSender,A.toneBuffer,"toneBuffer",!0,a.FEATURE_ms_teams_pstn)]),new b.WebrpcClassInfo(c.RTCDTMFToneChangeEvent,"RTCDTMFToneChangeEvent",[new b.WebrpcMethodInfo(c.RTCDTMFToneChangeEvent,M.ctor,"ctor",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDTMFToneChangeEvent,M.tone,"tone",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCDTMFToneChangeEvent,M.tone_buffer,"tone_buffer",!0,a.FEATURE_ms_teams_pstn)]),new b.WebrpcClassInfo(c.RTCIceCandidatePair,"RTCIceCandidatePair",
[new b.WebrpcMethodInfo(c.RTCIceCandidatePair,F.ctor,"ctor",!1,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceCandidatePair,F.local,"local",!0,a.FEATURE_ms_teams_pstn),new b.WebrpcMethodInfo(c.RTCIceCandidatePair,F.remote,"remote",!0,a.FEATURE_ms_teams_pstn)]),new b.WebrpcClassInfo(c.RTCRtpTransceiver,"RTCRtpTransceiver",[new b.WebrpcMethodInfo(c.RTCRtpTransceiver,J.ctor,"ctor",!1,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCRtpTransceiver,J.mid,"mid",!0,a.FEATURE_ms_teams_webrtc_1dot0),
new b.WebrpcMethodInfo(c.RTCRtpTransceiver,J.sender,"sender",!0,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCRtpTransceiver,J.receiver,"receiver",!0,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCRtpTransceiver,J.direction,"direction",!0,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCRtpTransceiver,J.currentDirection,"currentDirection",!0,a.FEATURE_ms_teams_webrtc_1dot0),new b.WebrpcMethodInfo(c.RTCRtpTransceiver,J.stop,"stop",!1,a.FEATURE_ms_teams_webrtc_1dot0),
new b.WebrpcMethodInfo(c.RTCRtpTransceiver,J.setCodecPreferences,"setCodecPreferences",!1,a.FEATURE_ms_teams_webrtc_1dot0)]),new b.WebrpcClassInfo(c.ScreenSharingRemote,"ScreenSharingRemote",[new b.WebrpcMethodInfo(c.ScreenSharingRemote,G.ctor,"ctor",!1,a.FEATURE_ms_teams_monitor_sharing),new b.WebrpcMethodInfo(c.ScreenSharingRemote,G.getScreensAsync,"getScreensAsync",!1,a.FEATURE_ms_teams_monitor_sharing),new b.WebrpcMethodInfo(c.ScreenSharingRemote,G.onscreentopologychanged,"onscreentopologychanged",
!0,a.FEATURE_ms_teams_monitor_sharing)]),new b.WebrpcClassInfo(c.ScreenSource,"ScreenSource",[new b.WebrpcMethodInfo(c.ScreenSource,L.ctor,"ctor",!1,a.FEATURE_ms_teams_monitor_sharing),new b.WebrpcMethodInfo(c.ScreenSource,L.srcid,"srcid",!0,a.FEATURE_ms_teams_monitor_sharing),new b.WebrpcMethodInfo(c.ScreenSource,L.deviceid,"deviceid",!0,a.FEATURE_ms_teams_monitor_sharing),new b.WebrpcMethodInfo(c.ScreenSource,L.type,"type",!0,a.FEATURE_ms_teams_monitor_sharing),new b.WebrpcMethodInfo(c.ScreenSource,
L.name,"name",!0,a.FEATURE_ms_teams_monitor_sharing),new b.WebrpcMethodInfo(c.ScreenSource,L.imagedata,"imagedata",!0,a.FEATURE_ms_teams_monitor_sharing),new b.WebrpcMethodInfo(c.ScreenSource,L.hwnd,"hwnd",!0,a.FEATURE_ms_teams_monitor_sharing),new b.WebrpcMethodInfo(c.ScreenSource,L.origin,"origin",!0,a.FEATURE_ms_teams_monitor_sharing),new b.WebrpcMethodInfo(c.ScreenSource,L.caption,"caption",!0,a.FEATURE_ms_teams_monitor_sharing),new b.WebrpcMethodInfo(c.ScreenSource,L.pid,"pid",!0,a.FEATURE_ms_teams_monitor_sharing),
new b.WebrpcMethodInfo(c.ScreenSource,L.bounds,"bounds",!0,a.FEATURE_ms_teams_gtc)]),new b.WebrpcClassInfo(c.E911Service,"E911Service",[new b.WebrpcMethodInfo(c.E911Service,P.ctor,"ctor",!1,a.FEATURE_ms_teams_e911),new b.WebrpcMethodInfo(c.E911Service,P.getE911Info,"getE911Info",!1,a.FEATURE_ms_teams_e911),new b.WebrpcMethodInfo(c.E911Service,P.onupdate,"onupdate",!0,a.FEATURE_ms_teams_e911)]),new b.WebrpcClassInfo(c.RTCDataChannel,"RTCDataChannel",[new b.WebrpcMethodInfo(c.RTCDataChannel,C.ctor,
"ctor",!1,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.label,"label",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.ordered,"ordered",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.maxPacketLifeTime,"maxPacketLifeTime",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.maxRetransmits,"maxRetransmits",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.protocol,
"protocol",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.negotiated,"negotiated",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.id,"id",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.readyState,"readyState",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.bufferedAmount,"bufferedAmount",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.bufferedAmountLowThreshold,
"bufferedAmountLowThreshold",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.onopen,"onopen",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.onbufferedamountlow,"onbufferedamountlow",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.onerror,"onerror",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.onclosing,"onclosing",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,
C.onclose,"onclose",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.onmessage,"onmessage",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.close,"close",!1,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.send_text,"send_text",!1,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCDataChannel,C.send_binary,"send_binary",!1,a.FEATURE_ms_teams_data_channel)]),new b.WebrpcClassInfo(c.RTCSctpTransport,"RTCSctpTransport",
[new b.WebrpcMethodInfo(c.RTCSctpTransport,R.ctor,"ctor",!1,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCSctpTransport,R.transport,"transport",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCSctpTransport,R.state,"state",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCSctpTransport,R.maxMessageSize,"maxMessageSize",!0,a.FEATURE_ms_teams_data_channel),new b.WebrpcMethodInfo(c.RTCSctpTransport,R.maxChannels,"maxChannels",!0,a.FEATURE_ms_teams_data_channel),
new b.WebrpcMethodInfo(c.RTCSctpTransport,R.onstatechange,"onstatechange",!0,a.FEATURE_ms_teams_data_channel)]),new b.WebrpcClassInfo(c.StreamResolution,"StreamResolution",[new b.WebrpcMethodInfo(c.StreamResolution,K.ctor,"ctor",!1,a.FEATURE_ms_teams_stream_resolution),new b.WebrpcMethodInfo(c.StreamResolution,K.getCallConstraints,"getCallConstraints",!1,a.FEATURE_ms_teams_stream_resolution),new b.WebrpcMethodInfo(c.StreamResolution,K.onupdate,"onupdate",!0,a.FEATURE_ms_teams_stream_resolution)])])},
545:function(b,a,c){var e=this&&this.__spreadArrays||function(){for(var a=0,b=0,c=arguments.length;b<c;b++)a+=arguments[b].length;for(var a=Array(a),e=0,b=0;b<c;b++)for(var k=arguments[b],h=0,l=k.length;h<l;h++,e++)a[e]=k[h];return a};Object.defineProperty(a,"__esModule",{value:!0});a.WsJsonUtil=a.ws_msg_type_t=void 0;var l=c(550),h;(function(a){a[a.req=0]="req";a[a.reply=1]="reply";a[a.event_req=2]="event_req";a[a.event_reply=3]="event_reply"})(h=a.ws_msg_type_t||(a.ws_msg_type_t={}));b=function(){function a(){}
a.createMessageByid=function(a,b,c,d,h,p){for(var g=[],B=6;B<arguments.length;B++)g[B-6]=arguments[B];(B=l.WebrpcClassLibInfoUtil.getMethodByid(d,h))&&B.isprop||(a=!1);return this.createMessage.apply(this,e([c,a,b,d,h,p],g))};a.createMessage=function(a,b,c,d,h,l){for(var g=[],p=6;p<arguments.length;p++)g[p-6]=arguments[p];return{v:"webrtc",hdr:{version:this._version,msg_type:this.getMsgType(a),modifier:b,destroy:c,proc:{iid:d,methodid:h}},objref:{oid:l},params:e(g)}};a.getMsgType=function(a){var b=
"";switch(a){default:b="req";break;case h.reply:b="reply";break;case h.event_req:b="event-req";break;case h.event_reply:b="event-reply"}return b};a._version=1;return a}();a.WsJsonUtil=b}},p={};return e(307)}()});

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],2:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/object/create"), __esModule: true };
},{"core-js/library/fn/object/create":18}],3:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/object/define-property"), __esModule: true };
},{"core-js/library/fn/object/define-property":19}],4:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/object/get-own-property-descriptor"), __esModule: true };
},{"core-js/library/fn/object/get-own-property-descriptor":20}],5:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/object/get-prototype-of"), __esModule: true };
},{"core-js/library/fn/object/get-prototype-of":21}],6:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/object/set-prototype-of"), __esModule: true };
},{"core-js/library/fn/object/set-prototype-of":22}],7:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/promise"), __esModule: true };
},{"core-js/library/fn/promise":23}],8:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/symbol"), __esModule: true };
},{"core-js/library/fn/symbol":24}],9:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/symbol/iterator"), __esModule: true };
},{"core-js/library/fn/symbol/iterator":25}],10:[function(require,module,exports){
"use strict";

exports.__esModule = true;

var _promise = require("../core-js/promise");

var _promise2 = _interopRequireDefault(_promise);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function (fn) {
  return function () {
    var gen = fn.apply(this, arguments);
    return new _promise2.default(function (resolve, reject) {
      function step(key, arg) {
        try {
          var info = gen[key](arg);
          var value = info.value;
        } catch (error) {
          reject(error);
          return;
        }

        if (info.done) {
          resolve(value);
        } else {
          return _promise2.default.resolve(value).then(function (value) {
            step("next", value);
          }, function (err) {
            step("throw", err);
          });
        }
      }

      return step("next");
    });
  };
};
},{"../core-js/promise":7}],11:[function(require,module,exports){
"use strict";

exports.__esModule = true;

exports.default = function (instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
};
},{}],12:[function(require,module,exports){
"use strict";

exports.__esModule = true;

var _defineProperty = require("../core-js/object/define-property");

var _defineProperty2 = _interopRequireDefault(_defineProperty);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function () {
  function defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      (0, _defineProperty2.default)(target, descriptor.key, descriptor);
    }
  }

  return function (Constructor, protoProps, staticProps) {
    if (protoProps) defineProperties(Constructor.prototype, protoProps);
    if (staticProps) defineProperties(Constructor, staticProps);
    return Constructor;
  };
}();
},{"../core-js/object/define-property":3}],13:[function(require,module,exports){
"use strict";

exports.__esModule = true;

var _getPrototypeOf = require("../core-js/object/get-prototype-of");

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

var _getOwnPropertyDescriptor = require("../core-js/object/get-own-property-descriptor");

var _getOwnPropertyDescriptor2 = _interopRequireDefault(_getOwnPropertyDescriptor);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function get(object, property, receiver) {
  if (object === null) object = Function.prototype;
  var desc = (0, _getOwnPropertyDescriptor2.default)(object, property);

  if (desc === undefined) {
    var parent = (0, _getPrototypeOf2.default)(object);

    if (parent === null) {
      return undefined;
    } else {
      return get(parent, property, receiver);
    }
  } else if ("value" in desc) {
    return desc.value;
  } else {
    var getter = desc.get;

    if (getter === undefined) {
      return undefined;
    }

    return getter.call(receiver);
  }
};
},{"../core-js/object/get-own-property-descriptor":4,"../core-js/object/get-prototype-of":5}],14:[function(require,module,exports){
"use strict";

exports.__esModule = true;

var _setPrototypeOf = require("../core-js/object/set-prototype-of");

var _setPrototypeOf2 = _interopRequireDefault(_setPrototypeOf);

var _create = require("../core-js/object/create");

var _create2 = _interopRequireDefault(_create);

var _typeof2 = require("../helpers/typeof");

var _typeof3 = _interopRequireDefault(_typeof2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function (subClass, superClass) {
  if (typeof superClass !== "function" && superClass !== null) {
    throw new TypeError("Super expression must either be null or a function, not " + (typeof superClass === "undefined" ? "undefined" : (0, _typeof3.default)(superClass)));
  }

  subClass.prototype = (0, _create2.default)(superClass && superClass.prototype, {
    constructor: {
      value: subClass,
      enumerable: false,
      writable: true,
      configurable: true
    }
  });
  if (superClass) _setPrototypeOf2.default ? (0, _setPrototypeOf2.default)(subClass, superClass) : subClass.__proto__ = superClass;
};
},{"../core-js/object/create":2,"../core-js/object/set-prototype-of":6,"../helpers/typeof":16}],15:[function(require,module,exports){
"use strict";

exports.__esModule = true;

var _typeof2 = require("../helpers/typeof");

var _typeof3 = _interopRequireDefault(_typeof2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function (self, call) {
  if (!self) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }

  return call && ((typeof call === "undefined" ? "undefined" : (0, _typeof3.default)(call)) === "object" || typeof call === "function") ? call : self;
};
},{"../helpers/typeof":16}],16:[function(require,module,exports){
"use strict";

exports.__esModule = true;

var _iterator = require("../core-js/symbol/iterator");

var _iterator2 = _interopRequireDefault(_iterator);

var _symbol = require("../core-js/symbol");

var _symbol2 = _interopRequireDefault(_symbol);

var _typeof = typeof _symbol2.default === "function" && typeof _iterator2.default === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof _symbol2.default === "function" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? "symbol" : typeof obj; };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = typeof _symbol2.default === "function" && _typeof(_iterator2.default) === "symbol" ? function (obj) {
  return typeof obj === "undefined" ? "undefined" : _typeof(obj);
} : function (obj) {
  return obj && typeof _symbol2.default === "function" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? "symbol" : typeof obj === "undefined" ? "undefined" : _typeof(obj);
};
},{"../core-js/symbol":8,"../core-js/symbol/iterator":9}],17:[function(require,module,exports){
module.exports = require("regenerator-runtime");

},{"regenerator-runtime":115}],18:[function(require,module,exports){
require('../../modules/es6.object.create');
var $Object = require('../../modules/_core').Object;
module.exports = function create(P, D) {
  return $Object.create(P, D);
};

},{"../../modules/_core":33,"../../modules/es6.object.create":101}],19:[function(require,module,exports){
require('../../modules/es6.object.define-property');
var $Object = require('../../modules/_core').Object;
module.exports = function defineProperty(it, key, desc) {
  return $Object.defineProperty(it, key, desc);
};

},{"../../modules/_core":33,"../../modules/es6.object.define-property":102}],20:[function(require,module,exports){
require('../../modules/es6.object.get-own-property-descriptor');
var $Object = require('../../modules/_core').Object;
module.exports = function getOwnPropertyDescriptor(it, key) {
  return $Object.getOwnPropertyDescriptor(it, key);
};

},{"../../modules/_core":33,"../../modules/es6.object.get-own-property-descriptor":103}],21:[function(require,module,exports){
require('../../modules/es6.object.get-prototype-of');
module.exports = require('../../modules/_core').Object.getPrototypeOf;

},{"../../modules/_core":33,"../../modules/es6.object.get-prototype-of":104}],22:[function(require,module,exports){
require('../../modules/es6.object.set-prototype-of');
module.exports = require('../../modules/_core').Object.setPrototypeOf;

},{"../../modules/_core":33,"../../modules/es6.object.set-prototype-of":105}],23:[function(require,module,exports){
require('../modules/es6.object.to-string');
require('../modules/es6.string.iterator');
require('../modules/web.dom.iterable');
require('../modules/es6.promise');
require('../modules/es7.promise.finally');
require('../modules/es7.promise.try');
module.exports = require('../modules/_core').Promise;

},{"../modules/_core":33,"../modules/es6.object.to-string":106,"../modules/es6.promise":107,"../modules/es6.string.iterator":108,"../modules/es7.promise.finally":110,"../modules/es7.promise.try":111,"../modules/web.dom.iterable":114}],24:[function(require,module,exports){
require('../../modules/es6.symbol');
require('../../modules/es6.object.to-string');
require('../../modules/es7.symbol.async-iterator');
require('../../modules/es7.symbol.observable');
module.exports = require('../../modules/_core').Symbol;

},{"../../modules/_core":33,"../../modules/es6.object.to-string":106,"../../modules/es6.symbol":109,"../../modules/es7.symbol.async-iterator":112,"../../modules/es7.symbol.observable":113}],25:[function(require,module,exports){
require('../../modules/es6.string.iterator');
require('../../modules/web.dom.iterable');
module.exports = require('../../modules/_wks-ext').f('iterator');

},{"../../modules/_wks-ext":97,"../../modules/es6.string.iterator":108,"../../modules/web.dom.iterable":114}],26:[function(require,module,exports){
module.exports = function (it) {
  if (typeof it != 'function') throw TypeError(it + ' is not a function!');
  return it;
};

},{}],27:[function(require,module,exports){
module.exports = function () { /* empty */ };

},{}],28:[function(require,module,exports){
module.exports = function (it, Constructor, name, forbiddenField) {
  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {
    throw TypeError(name + ': incorrect invocation!');
  } return it;
};

},{}],29:[function(require,module,exports){
var isObject = require('./_is-object');
module.exports = function (it) {
  if (!isObject(it)) throw TypeError(it + ' is not an object!');
  return it;
};

},{"./_is-object":52}],30:[function(require,module,exports){
// false -> Array#indexOf
// true  -> Array#includes
var toIObject = require('./_to-iobject');
var toLength = require('./_to-length');
var toAbsoluteIndex = require('./_to-absolute-index');
module.exports = function (IS_INCLUDES) {
  return function ($this, el, fromIndex) {
    var O = toIObject($this);
    var length = toLength(O.length);
    var index = toAbsoluteIndex(fromIndex, length);
    var value;
    // Array#includes uses SameValueZero equality algorithm
    // eslint-disable-next-line no-self-compare
    if (IS_INCLUDES && el != el) while (length > index) {
      value = O[index++];
      // eslint-disable-next-line no-self-compare
      if (value != value) return true;
    // Array#indexOf ignores holes, Array#includes - not
    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {
      if (O[index] === el) return IS_INCLUDES || index || 0;
    } return !IS_INCLUDES && -1;
  };
};

},{"./_to-absolute-index":88,"./_to-iobject":90,"./_to-length":91}],31:[function(require,module,exports){
// getting tag from 19.1.3.6 Object.prototype.toString()
var cof = require('./_cof');
var TAG = require('./_wks')('toStringTag');
// ES3 wrong here
var ARG = cof(function () { return arguments; }()) == 'Arguments';

// fallback for IE11 Script Access Denied error
var tryGet = function (it, key) {
  try {
    return it[key];
  } catch (e) { /* empty */ }
};

module.exports = function (it) {
  var O, T, B;
  return it === undefined ? 'Undefined' : it === null ? 'Null'
    // @@toStringTag case
    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T
    // builtinTag case
    : ARG ? cof(O)
    // ES3 arguments fallback
    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;
};

},{"./_cof":32,"./_wks":98}],32:[function(require,module,exports){
var toString = {}.toString;

module.exports = function (it) {
  return toString.call(it).slice(8, -1);
};

},{}],33:[function(require,module,exports){
var core = module.exports = { version: '2.6.12' };
if (typeof __e == 'number') __e = core; // eslint-disable-line no-undef

},{}],34:[function(require,module,exports){
// optional / simple context binding
var aFunction = require('./_a-function');
module.exports = function (fn, that, length) {
  aFunction(fn);
  if (that === undefined) return fn;
  switch (length) {
    case 1: return function (a) {
      return fn.call(that, a);
    };
    case 2: return function (a, b) {
      return fn.call(that, a, b);
    };
    case 3: return function (a, b, c) {
      return fn.call(that, a, b, c);
    };
  }
  return function (/* ...args */) {
    return fn.apply(that, arguments);
  };
};

},{"./_a-function":26}],35:[function(require,module,exports){
// 7.2.1 RequireObjectCoercible(argument)
module.exports = function (it) {
  if (it == undefined) throw TypeError("Can't call method on  " + it);
  return it;
};

},{}],36:[function(require,module,exports){
// Thank's IE8 for his funny defineProperty
module.exports = !require('./_fails')(function () {
  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;
});

},{"./_fails":41}],37:[function(require,module,exports){
var isObject = require('./_is-object');
var document = require('./_global').document;
// typeof document.createElement is 'object' in old IE
var is = isObject(document) && isObject(document.createElement);
module.exports = function (it) {
  return is ? document.createElement(it) : {};
};

},{"./_global":43,"./_is-object":52}],38:[function(require,module,exports){
// IE 8- don't enum bug keys
module.exports = (
  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'
).split(',');

},{}],39:[function(require,module,exports){
// all enumerable object keys, includes symbols
var getKeys = require('./_object-keys');
var gOPS = require('./_object-gops');
var pIE = require('./_object-pie');
module.exports = function (it) {
  var result = getKeys(it);
  var getSymbols = gOPS.f;
  if (getSymbols) {
    var symbols = getSymbols(it);
    var isEnum = pIE.f;
    var i = 0;
    var key;
    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);
  } return result;
};

},{"./_object-gops":69,"./_object-keys":72,"./_object-pie":73}],40:[function(require,module,exports){
var global = require('./_global');
var core = require('./_core');
var ctx = require('./_ctx');
var hide = require('./_hide');
var has = require('./_has');
var PROTOTYPE = 'prototype';

var $export = function (type, name, source) {
  var IS_FORCED = type & $export.F;
  var IS_GLOBAL = type & $export.G;
  var IS_STATIC = type & $export.S;
  var IS_PROTO = type & $export.P;
  var IS_BIND = type & $export.B;
  var IS_WRAP = type & $export.W;
  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});
  var expProto = exports[PROTOTYPE];
  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE];
  var key, own, out;
  if (IS_GLOBAL) source = name;
  for (key in source) {
    // contains in native
    own = !IS_FORCED && target && target[key] !== undefined;
    if (own && has(exports, key)) continue;
    // export native or passed
    out = own ? target[key] : source[key];
    // prevent global pollution for namespaces
    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]
    // bind timers to global for call from export context
    : IS_BIND && own ? ctx(out, global)
    // wrap global constructors for prevent change them in library
    : IS_WRAP && target[key] == out ? (function (C) {
      var F = function (a, b, c) {
        if (this instanceof C) {
          switch (arguments.length) {
            case 0: return new C();
            case 1: return new C(a);
            case 2: return new C(a, b);
          } return new C(a, b, c);
        } return C.apply(this, arguments);
      };
      F[PROTOTYPE] = C[PROTOTYPE];
      return F;
    // make static versions for prototype methods
    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;
    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%
    if (IS_PROTO) {
      (exports.virtual || (exports.virtual = {}))[key] = out;
      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%
      if (type & $export.R && expProto && !expProto[key]) hide(expProto, key, out);
    }
  }
};
// type bitmap
$export.F = 1;   // forced
$export.G = 2;   // global
$export.S = 4;   // static
$export.P = 8;   // proto
$export.B = 16;  // bind
$export.W = 32;  // wrap
$export.U = 64;  // safe
$export.R = 128; // real proto method for `library`
module.exports = $export;

},{"./_core":33,"./_ctx":34,"./_global":43,"./_has":44,"./_hide":45}],41:[function(require,module,exports){
module.exports = function (exec) {
  try {
    return !!exec();
  } catch (e) {
    return true;
  }
};

},{}],42:[function(require,module,exports){
var ctx = require('./_ctx');
var call = require('./_iter-call');
var isArrayIter = require('./_is-array-iter');
var anObject = require('./_an-object');
var toLength = require('./_to-length');
var getIterFn = require('./core.get-iterator-method');
var BREAK = {};
var RETURN = {};
var exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {
  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);
  var f = ctx(fn, that, entries ? 2 : 1);
  var index = 0;
  var length, step, iterator, result;
  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');
  // fast case for arrays with default iterator
  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {
    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);
    if (result === BREAK || result === RETURN) return result;
  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {
    result = call(iterator, f, step.value, entries);
    if (result === BREAK || result === RETURN) return result;
  }
};
exports.BREAK = BREAK;
exports.RETURN = RETURN;

},{"./_an-object":29,"./_ctx":34,"./_is-array-iter":50,"./_iter-call":53,"./_to-length":91,"./core.get-iterator-method":99}],43:[function(require,module,exports){
// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028
var global = module.exports = typeof window != 'undefined' && window.Math == Math
  ? window : typeof self != 'undefined' && self.Math == Math ? self
  // eslint-disable-next-line no-new-func
  : Function('return this')();
if (typeof __g == 'number') __g = global; // eslint-disable-line no-undef

},{}],44:[function(require,module,exports){
var hasOwnProperty = {}.hasOwnProperty;
module.exports = function (it, key) {
  return hasOwnProperty.call(it, key);
};

},{}],45:[function(require,module,exports){
var dP = require('./_object-dp');
var createDesc = require('./_property-desc');
module.exports = require('./_descriptors') ? function (object, key, value) {
  return dP.f(object, key, createDesc(1, value));
} : function (object, key, value) {
  object[key] = value;
  return object;
};

},{"./_descriptors":36,"./_object-dp":64,"./_property-desc":77}],46:[function(require,module,exports){
var document = require('./_global').document;
module.exports = document && document.documentElement;

},{"./_global":43}],47:[function(require,module,exports){
module.exports = !require('./_descriptors') && !require('./_fails')(function () {
  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;
});

},{"./_descriptors":36,"./_dom-create":37,"./_fails":41}],48:[function(require,module,exports){
// fast apply, http://jsperf.lnkit.com/fast-apply/5
module.exports = function (fn, args, that) {
  var un = that === undefined;
  switch (args.length) {
    case 0: return un ? fn()
                      : fn.call(that);
    case 1: return un ? fn(args[0])
                      : fn.call(that, args[0]);
    case 2: return un ? fn(args[0], args[1])
                      : fn.call(that, args[0], args[1]);
    case 3: return un ? fn(args[0], args[1], args[2])
                      : fn.call(that, args[0], args[1], args[2]);
    case 4: return un ? fn(args[0], args[1], args[2], args[3])
                      : fn.call(that, args[0], args[1], args[2], args[3]);
  } return fn.apply(that, args);
};

},{}],49:[function(require,module,exports){
// fallback for non-array-like ES3 and non-enumerable old V8 strings
var cof = require('./_cof');
// eslint-disable-next-line no-prototype-builtins
module.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {
  return cof(it) == 'String' ? it.split('') : Object(it);
};

},{"./_cof":32}],50:[function(require,module,exports){
// check on default Array iterator
var Iterators = require('./_iterators');
var ITERATOR = require('./_wks')('iterator');
var ArrayProto = Array.prototype;

module.exports = function (it) {
  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);
};

},{"./_iterators":58,"./_wks":98}],51:[function(require,module,exports){
// 7.2.2 IsArray(argument)
var cof = require('./_cof');
module.exports = Array.isArray || function isArray(arg) {
  return cof(arg) == 'Array';
};

},{"./_cof":32}],52:[function(require,module,exports){
module.exports = function (it) {
  return typeof it === 'object' ? it !== null : typeof it === 'function';
};

},{}],53:[function(require,module,exports){
// call something on iterator step with safe closing on error
var anObject = require('./_an-object');
module.exports = function (iterator, fn, value, entries) {
  try {
    return entries ? fn(anObject(value)[0], value[1]) : fn(value);
  // 7.4.6 IteratorClose(iterator, completion)
  } catch (e) {
    var ret = iterator['return'];
    if (ret !== undefined) anObject(ret.call(iterator));
    throw e;
  }
};

},{"./_an-object":29}],54:[function(require,module,exports){
'use strict';
var create = require('./_object-create');
var descriptor = require('./_property-desc');
var setToStringTag = require('./_set-to-string-tag');
var IteratorPrototype = {};

// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()
require('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function () { return this; });

module.exports = function (Constructor, NAME, next) {
  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });
  setToStringTag(Constructor, NAME + ' Iterator');
};

},{"./_hide":45,"./_object-create":63,"./_property-desc":77,"./_set-to-string-tag":82,"./_wks":98}],55:[function(require,module,exports){
'use strict';
var LIBRARY = require('./_library');
var $export = require('./_export');
var redefine = require('./_redefine');
var hide = require('./_hide');
var Iterators = require('./_iterators');
var $iterCreate = require('./_iter-create');
var setToStringTag = require('./_set-to-string-tag');
var getPrototypeOf = require('./_object-gpo');
var ITERATOR = require('./_wks')('iterator');
var BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`
var FF_ITERATOR = '@@iterator';
var KEYS = 'keys';
var VALUES = 'values';

var returnThis = function () { return this; };

module.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {
  $iterCreate(Constructor, NAME, next);
  var getMethod = function (kind) {
    if (!BUGGY && kind in proto) return proto[kind];
    switch (kind) {
      case KEYS: return function keys() { return new Constructor(this, kind); };
      case VALUES: return function values() { return new Constructor(this, kind); };
    } return function entries() { return new Constructor(this, kind); };
  };
  var TAG = NAME + ' Iterator';
  var DEF_VALUES = DEFAULT == VALUES;
  var VALUES_BUG = false;
  var proto = Base.prototype;
  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];
  var $default = $native || getMethod(DEFAULT);
  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;
  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;
  var methods, key, IteratorPrototype;
  // Fix native
  if ($anyNative) {
    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));
    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {
      // Set @@toStringTag to native iterators
      setToStringTag(IteratorPrototype, TAG, true);
      // fix for some old engines
      if (!LIBRARY && typeof IteratorPrototype[ITERATOR] != 'function') hide(IteratorPrototype, ITERATOR, returnThis);
    }
  }
  // fix Array#{values, @@iterator}.name in V8 / FF
  if (DEF_VALUES && $native && $native.name !== VALUES) {
    VALUES_BUG = true;
    $default = function values() { return $native.call(this); };
  }
  // Define iterator
  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {
    hide(proto, ITERATOR, $default);
  }
  // Plug for library
  Iterators[NAME] = $default;
  Iterators[TAG] = returnThis;
  if (DEFAULT) {
    methods = {
      values: DEF_VALUES ? $default : getMethod(VALUES),
      keys: IS_SET ? $default : getMethod(KEYS),
      entries: $entries
    };
    if (FORCED) for (key in methods) {
      if (!(key in proto)) redefine(proto, key, methods[key]);
    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);
  }
  return methods;
};

},{"./_export":40,"./_hide":45,"./_iter-create":54,"./_iterators":58,"./_library":59,"./_object-gpo":70,"./_redefine":79,"./_set-to-string-tag":82,"./_wks":98}],56:[function(require,module,exports){
var ITERATOR = require('./_wks')('iterator');
var SAFE_CLOSING = false;

try {
  var riter = [7][ITERATOR]();
  riter['return'] = function () { SAFE_CLOSING = true; };
  // eslint-disable-next-line no-throw-literal
  Array.from(riter, function () { throw 2; });
} catch (e) { /* empty */ }

module.exports = function (exec, skipClosing) {
  if (!skipClosing && !SAFE_CLOSING) return false;
  var safe = false;
  try {
    var arr = [7];
    var iter = arr[ITERATOR]();
    iter.next = function () { return { done: safe = true }; };
    arr[ITERATOR] = function () { return iter; };
    exec(arr);
  } catch (e) { /* empty */ }
  return safe;
};

},{"./_wks":98}],57:[function(require,module,exports){
module.exports = function (done, value) {
  return { value: value, done: !!done };
};

},{}],58:[function(require,module,exports){
module.exports = {};

},{}],59:[function(require,module,exports){
module.exports = true;

},{}],60:[function(require,module,exports){
var META = require('./_uid')('meta');
var isObject = require('./_is-object');
var has = require('./_has');
var setDesc = require('./_object-dp').f;
var id = 0;
var isExtensible = Object.isExtensible || function () {
  return true;
};
var FREEZE = !require('./_fails')(function () {
  return isExtensible(Object.preventExtensions({}));
});
var setMeta = function (it) {
  setDesc(it, META, { value: {
    i: 'O' + ++id, // object ID
    w: {}          // weak collections IDs
  } });
};
var fastKey = function (it, create) {
  // return primitive with prefix
  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return 'F';
    // not necessary to add metadata
    if (!create) return 'E';
    // add missing metadata
    setMeta(it);
  // return object ID
  } return it[META].i;
};
var getWeak = function (it, create) {
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return true;
    // not necessary to add metadata
    if (!create) return false;
    // add missing metadata
    setMeta(it);
  // return hash weak collections IDs
  } return it[META].w;
};
// add metadata on freeze-family methods calling
var onFreeze = function (it) {
  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);
  return it;
};
var meta = module.exports = {
  KEY: META,
  NEED: false,
  fastKey: fastKey,
  getWeak: getWeak,
  onFreeze: onFreeze
};

},{"./_fails":41,"./_has":44,"./_is-object":52,"./_object-dp":64,"./_uid":94}],61:[function(require,module,exports){
var global = require('./_global');
var macrotask = require('./_task').set;
var Observer = global.MutationObserver || global.WebKitMutationObserver;
var process = global.process;
var Promise = global.Promise;
var isNode = require('./_cof')(process) == 'process';

module.exports = function () {
  var head, last, notify;

  var flush = function () {
    var parent, fn;
    if (isNode && (parent = process.domain)) parent.exit();
    while (head) {
      fn = head.fn;
      head = head.next;
      try {
        fn();
      } catch (e) {
        if (head) notify();
        else last = undefined;
        throw e;
      }
    } last = undefined;
    if (parent) parent.enter();
  };

  // Node.js
  if (isNode) {
    notify = function () {
      process.nextTick(flush);
    };
  // browsers with MutationObserver, except iOS Safari - https://github.com/zloirock/core-js/issues/339
  } else if (Observer && !(global.navigator && global.navigator.standalone)) {
    var toggle = true;
    var node = document.createTextNode('');
    new Observer(flush).observe(node, { characterData: true }); // eslint-disable-line no-new
    notify = function () {
      node.data = toggle = !toggle;
    };
  // environments with maybe non-completely correct, but existent Promise
  } else if (Promise && Promise.resolve) {
    // Promise.resolve without an argument throws an error in LG WebOS 2
    var promise = Promise.resolve(undefined);
    notify = function () {
      promise.then(flush);
    };
  // for other environments - macrotask based on:
  // - setImmediate
  // - MessageChannel
  // - window.postMessag
  // - onreadystatechange
  // - setTimeout
  } else {
    notify = function () {
      // strange IE + webpack dev server bug - use .call(global)
      macrotask.call(global, flush);
    };
  }

  return function (fn) {
    var task = { fn: fn, next: undefined };
    if (last) last.next = task;
    if (!head) {
      head = task;
      notify();
    } last = task;
  };
};

},{"./_cof":32,"./_global":43,"./_task":87}],62:[function(require,module,exports){
'use strict';
// 25.4.1.5 NewPromiseCapability(C)
var aFunction = require('./_a-function');

function PromiseCapability(C) {
  var resolve, reject;
  this.promise = new C(function ($$resolve, $$reject) {
    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');
    resolve = $$resolve;
    reject = $$reject;
  });
  this.resolve = aFunction(resolve);
  this.reject = aFunction(reject);
}

module.exports.f = function (C) {
  return new PromiseCapability(C);
};

},{"./_a-function":26}],63:[function(require,module,exports){
// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])
var anObject = require('./_an-object');
var dPs = require('./_object-dps');
var enumBugKeys = require('./_enum-bug-keys');
var IE_PROTO = require('./_shared-key')('IE_PROTO');
var Empty = function () { /* empty */ };
var PROTOTYPE = 'prototype';

// Create object with fake `null` prototype: use iframe Object with cleared prototype
var createDict = function () {
  // Thrash, waste and sodomy: IE GC bug
  var iframe = require('./_dom-create')('iframe');
  var i = enumBugKeys.length;
  var lt = '<';
  var gt = '>';
  var iframeDocument;
  iframe.style.display = 'none';
  require('./_html').appendChild(iframe);
  iframe.src = 'javascript:'; // eslint-disable-line no-script-url
  // createDict = iframe.contentWindow.Object;
  // html.removeChild(iframe);
  iframeDocument = iframe.contentWindow.document;
  iframeDocument.open();
  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);
  iframeDocument.close();
  createDict = iframeDocument.F;
  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];
  return createDict();
};

module.exports = Object.create || function create(O, Properties) {
  var result;
  if (O !== null) {
    Empty[PROTOTYPE] = anObject(O);
    result = new Empty();
    Empty[PROTOTYPE] = null;
    // add "__proto__" for Object.getPrototypeOf polyfill
    result[IE_PROTO] = O;
  } else result = createDict();
  return Properties === undefined ? result : dPs(result, Properties);
};

},{"./_an-object":29,"./_dom-create":37,"./_enum-bug-keys":38,"./_html":46,"./_object-dps":65,"./_shared-key":83}],64:[function(require,module,exports){
var anObject = require('./_an-object');
var IE8_DOM_DEFINE = require('./_ie8-dom-define');
var toPrimitive = require('./_to-primitive');
var dP = Object.defineProperty;

exports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {
  anObject(O);
  P = toPrimitive(P, true);
  anObject(Attributes);
  if (IE8_DOM_DEFINE) try {
    return dP(O, P, Attributes);
  } catch (e) { /* empty */ }
  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');
  if ('value' in Attributes) O[P] = Attributes.value;
  return O;
};

},{"./_an-object":29,"./_descriptors":36,"./_ie8-dom-define":47,"./_to-primitive":93}],65:[function(require,module,exports){
var dP = require('./_object-dp');
var anObject = require('./_an-object');
var getKeys = require('./_object-keys');

module.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {
  anObject(O);
  var keys = getKeys(Properties);
  var length = keys.length;
  var i = 0;
  var P;
  while (length > i) dP.f(O, P = keys[i++], Properties[P]);
  return O;
};

},{"./_an-object":29,"./_descriptors":36,"./_object-dp":64,"./_object-keys":72}],66:[function(require,module,exports){
var pIE = require('./_object-pie');
var createDesc = require('./_property-desc');
var toIObject = require('./_to-iobject');
var toPrimitive = require('./_to-primitive');
var has = require('./_has');
var IE8_DOM_DEFINE = require('./_ie8-dom-define');
var gOPD = Object.getOwnPropertyDescriptor;

exports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P) {
  O = toIObject(O);
  P = toPrimitive(P, true);
  if (IE8_DOM_DEFINE) try {
    return gOPD(O, P);
  } catch (e) { /* empty */ }
  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);
};

},{"./_descriptors":36,"./_has":44,"./_ie8-dom-define":47,"./_object-pie":73,"./_property-desc":77,"./_to-iobject":90,"./_to-primitive":93}],67:[function(require,module,exports){
// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window
var toIObject = require('./_to-iobject');
var gOPN = require('./_object-gopn').f;
var toString = {}.toString;

var windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames
  ? Object.getOwnPropertyNames(window) : [];

var getWindowNames = function (it) {
  try {
    return gOPN(it);
  } catch (e) {
    return windowNames.slice();
  }
};

module.exports.f = function getOwnPropertyNames(it) {
  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));
};

},{"./_object-gopn":68,"./_to-iobject":90}],68:[function(require,module,exports){
// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)
var $keys = require('./_object-keys-internal');
var hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');

exports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {
  return $keys(O, hiddenKeys);
};

},{"./_enum-bug-keys":38,"./_object-keys-internal":71}],69:[function(require,module,exports){
exports.f = Object.getOwnPropertySymbols;

},{}],70:[function(require,module,exports){
// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)
var has = require('./_has');
var toObject = require('./_to-object');
var IE_PROTO = require('./_shared-key')('IE_PROTO');
var ObjectProto = Object.prototype;

module.exports = Object.getPrototypeOf || function (O) {
  O = toObject(O);
  if (has(O, IE_PROTO)) return O[IE_PROTO];
  if (typeof O.constructor == 'function' && O instanceof O.constructor) {
    return O.constructor.prototype;
  } return O instanceof Object ? ObjectProto : null;
};

},{"./_has":44,"./_shared-key":83,"./_to-object":92}],71:[function(require,module,exports){
var has = require('./_has');
var toIObject = require('./_to-iobject');
var arrayIndexOf = require('./_array-includes')(false);
var IE_PROTO = require('./_shared-key')('IE_PROTO');

module.exports = function (object, names) {
  var O = toIObject(object);
  var i = 0;
  var result = [];
  var key;
  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);
  // Don't enum bug & hidden keys
  while (names.length > i) if (has(O, key = names[i++])) {
    ~arrayIndexOf(result, key) || result.push(key);
  }
  return result;
};

},{"./_array-includes":30,"./_has":44,"./_shared-key":83,"./_to-iobject":90}],72:[function(require,module,exports){
// 19.1.2.14 / 15.2.3.14 Object.keys(O)
var $keys = require('./_object-keys-internal');
var enumBugKeys = require('./_enum-bug-keys');

module.exports = Object.keys || function keys(O) {
  return $keys(O, enumBugKeys);
};

},{"./_enum-bug-keys":38,"./_object-keys-internal":71}],73:[function(require,module,exports){
exports.f = {}.propertyIsEnumerable;

},{}],74:[function(require,module,exports){
// most Object methods by ES6 should accept primitives
var $export = require('./_export');
var core = require('./_core');
var fails = require('./_fails');
module.exports = function (KEY, exec) {
  var fn = (core.Object || {})[KEY] || Object[KEY];
  var exp = {};
  exp[KEY] = exec(fn);
  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);
};

},{"./_core":33,"./_export":40,"./_fails":41}],75:[function(require,module,exports){
module.exports = function (exec) {
  try {
    return { e: false, v: exec() };
  } catch (e) {
    return { e: true, v: e };
  }
};

},{}],76:[function(require,module,exports){
var anObject = require('./_an-object');
var isObject = require('./_is-object');
var newPromiseCapability = require('./_new-promise-capability');

module.exports = function (C, x) {
  anObject(C);
  if (isObject(x) && x.constructor === C) return x;
  var promiseCapability = newPromiseCapability.f(C);
  var resolve = promiseCapability.resolve;
  resolve(x);
  return promiseCapability.promise;
};

},{"./_an-object":29,"./_is-object":52,"./_new-promise-capability":62}],77:[function(require,module,exports){
module.exports = function (bitmap, value) {
  return {
    enumerable: !(bitmap & 1),
    configurable: !(bitmap & 2),
    writable: !(bitmap & 4),
    value: value
  };
};

},{}],78:[function(require,module,exports){
var hide = require('./_hide');
module.exports = function (target, src, safe) {
  for (var key in src) {
    if (safe && target[key]) target[key] = src[key];
    else hide(target, key, src[key]);
  } return target;
};

},{"./_hide":45}],79:[function(require,module,exports){
module.exports = require('./_hide');

},{"./_hide":45}],80:[function(require,module,exports){
// Works with __proto__ only. Old v8 can't work with null proto objects.
/* eslint-disable no-proto */
var isObject = require('./_is-object');
var anObject = require('./_an-object');
var check = function (O, proto) {
  anObject(O);
  if (!isObject(proto) && proto !== null) throw TypeError(proto + ": can't set as prototype!");
};
module.exports = {
  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line
    function (test, buggy, set) {
      try {
        set = require('./_ctx')(Function.call, require('./_object-gopd').f(Object.prototype, '__proto__').set, 2);
        set(test, []);
        buggy = !(test instanceof Array);
      } catch (e) { buggy = true; }
      return function setPrototypeOf(O, proto) {
        check(O, proto);
        if (buggy) O.__proto__ = proto;
        else set(O, proto);
        return O;
      };
    }({}, false) : undefined),
  check: check
};

},{"./_an-object":29,"./_ctx":34,"./_is-object":52,"./_object-gopd":66}],81:[function(require,module,exports){
'use strict';
var global = require('./_global');
var core = require('./_core');
var dP = require('./_object-dp');
var DESCRIPTORS = require('./_descriptors');
var SPECIES = require('./_wks')('species');

module.exports = function (KEY) {
  var C = typeof core[KEY] == 'function' ? core[KEY] : global[KEY];
  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {
    configurable: true,
    get: function () { return this; }
  });
};

},{"./_core":33,"./_descriptors":36,"./_global":43,"./_object-dp":64,"./_wks":98}],82:[function(require,module,exports){
var def = require('./_object-dp').f;
var has = require('./_has');
var TAG = require('./_wks')('toStringTag');

module.exports = function (it, tag, stat) {
  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });
};

},{"./_has":44,"./_object-dp":64,"./_wks":98}],83:[function(require,module,exports){
var shared = require('./_shared')('keys');
var uid = require('./_uid');
module.exports = function (key) {
  return shared[key] || (shared[key] = uid(key));
};

},{"./_shared":84,"./_uid":94}],84:[function(require,module,exports){
var core = require('./_core');
var global = require('./_global');
var SHARED = '__core-js_shared__';
var store = global[SHARED] || (global[SHARED] = {});

(module.exports = function (key, value) {
  return store[key] || (store[key] = value !== undefined ? value : {});
})('versions', []).push({
  version: core.version,
  mode: require('./_library') ? 'pure' : 'global',
  copyright: ' 2020 Denis Pushkarev (zloirock.ru)'
});

},{"./_core":33,"./_global":43,"./_library":59}],85:[function(require,module,exports){
// 7.3.20 SpeciesConstructor(O, defaultConstructor)
var anObject = require('./_an-object');
var aFunction = require('./_a-function');
var SPECIES = require('./_wks')('species');
module.exports = function (O, D) {
  var C = anObject(O).constructor;
  var S;
  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);
};

},{"./_a-function":26,"./_an-object":29,"./_wks":98}],86:[function(require,module,exports){
var toInteger = require('./_to-integer');
var defined = require('./_defined');
// true  -> String#at
// false -> String#codePointAt
module.exports = function (TO_STRING) {
  return function (that, pos) {
    var s = String(defined(that));
    var i = toInteger(pos);
    var l = s.length;
    var a, b;
    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;
    a = s.charCodeAt(i);
    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff
      ? TO_STRING ? s.charAt(i) : a
      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;
  };
};

},{"./_defined":35,"./_to-integer":89}],87:[function(require,module,exports){
var ctx = require('./_ctx');
var invoke = require('./_invoke');
var html = require('./_html');
var cel = require('./_dom-create');
var global = require('./_global');
var process = global.process;
var setTask = global.setImmediate;
var clearTask = global.clearImmediate;
var MessageChannel = global.MessageChannel;
var Dispatch = global.Dispatch;
var counter = 0;
var queue = {};
var ONREADYSTATECHANGE = 'onreadystatechange';
var defer, channel, port;
var run = function () {
  var id = +this;
  // eslint-disable-next-line no-prototype-builtins
  if (queue.hasOwnProperty(id)) {
    var fn = queue[id];
    delete queue[id];
    fn();
  }
};
var listener = function (event) {
  run.call(event.data);
};
// Node.js 0.9+ & IE10+ has setImmediate, otherwise:
if (!setTask || !clearTask) {
  setTask = function setImmediate(fn) {
    var args = [];
    var i = 1;
    while (arguments.length > i) args.push(arguments[i++]);
    queue[++counter] = function () {
      // eslint-disable-next-line no-new-func
      invoke(typeof fn == 'function' ? fn : Function(fn), args);
    };
    defer(counter);
    return counter;
  };
  clearTask = function clearImmediate(id) {
    delete queue[id];
  };
  // Node.js 0.8-
  if (require('./_cof')(process) == 'process') {
    defer = function (id) {
      process.nextTick(ctx(run, id, 1));
    };
  // Sphere (JS game engine) Dispatch API
  } else if (Dispatch && Dispatch.now) {
    defer = function (id) {
      Dispatch.now(ctx(run, id, 1));
    };
  // Browsers with MessageChannel, includes WebWorkers
  } else if (MessageChannel) {
    channel = new MessageChannel();
    port = channel.port2;
    channel.port1.onmessage = listener;
    defer = ctx(port.postMessage, port, 1);
  // Browsers with postMessage, skip WebWorkers
  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'
  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {
    defer = function (id) {
      global.postMessage(id + '', '*');
    };
    global.addEventListener('message', listener, false);
  // IE8-
  } else if (ONREADYSTATECHANGE in cel('script')) {
    defer = function (id) {
      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {
        html.removeChild(this);
        run.call(id);
      };
    };
  // Rest old browsers
  } else {
    defer = function (id) {
      setTimeout(ctx(run, id, 1), 0);
    };
  }
}
module.exports = {
  set: setTask,
  clear: clearTask
};

},{"./_cof":32,"./_ctx":34,"./_dom-create":37,"./_global":43,"./_html":46,"./_invoke":48}],88:[function(require,module,exports){
var toInteger = require('./_to-integer');
var max = Math.max;
var min = Math.min;
module.exports = function (index, length) {
  index = toInteger(index);
  return index < 0 ? max(index + length, 0) : min(index, length);
};

},{"./_to-integer":89}],89:[function(require,module,exports){
// 7.1.4 ToInteger
var ceil = Math.ceil;
var floor = Math.floor;
module.exports = function (it) {
  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);
};

},{}],90:[function(require,module,exports){
// to indexed object, toObject with fallback for non-array-like ES3 strings
var IObject = require('./_iobject');
var defined = require('./_defined');
module.exports = function (it) {
  return IObject(defined(it));
};

},{"./_defined":35,"./_iobject":49}],91:[function(require,module,exports){
// 7.1.15 ToLength
var toInteger = require('./_to-integer');
var min = Math.min;
module.exports = function (it) {
  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991
};

},{"./_to-integer":89}],92:[function(require,module,exports){
// 7.1.13 ToObject(argument)
var defined = require('./_defined');
module.exports = function (it) {
  return Object(defined(it));
};

},{"./_defined":35}],93:[function(require,module,exports){
// 7.1.1 ToPrimitive(input [, PreferredType])
var isObject = require('./_is-object');
// instead of the ES6 spec version, we didn't implement @@toPrimitive case
// and the second argument - flag - preferred type is a string
module.exports = function (it, S) {
  if (!isObject(it)) return it;
  var fn, val;
  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;
  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;
  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;
  throw TypeError("Can't convert object to primitive value");
};

},{"./_is-object":52}],94:[function(require,module,exports){
var id = 0;
var px = Math.random();
module.exports = function (key) {
  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));
};

},{}],95:[function(require,module,exports){
var global = require('./_global');
var navigator = global.navigator;

module.exports = navigator && navigator.userAgent || '';

},{"./_global":43}],96:[function(require,module,exports){
var global = require('./_global');
var core = require('./_core');
var LIBRARY = require('./_library');
var wksExt = require('./_wks-ext');
var defineProperty = require('./_object-dp').f;
module.exports = function (name) {
  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});
  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });
};

},{"./_core":33,"./_global":43,"./_library":59,"./_object-dp":64,"./_wks-ext":97}],97:[function(require,module,exports){
exports.f = require('./_wks');

},{"./_wks":98}],98:[function(require,module,exports){
var store = require('./_shared')('wks');
var uid = require('./_uid');
var Symbol = require('./_global').Symbol;
var USE_SYMBOL = typeof Symbol == 'function';

var $exports = module.exports = function (name) {
  return store[name] || (store[name] =
    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));
};

$exports.store = store;

},{"./_global":43,"./_shared":84,"./_uid":94}],99:[function(require,module,exports){
var classof = require('./_classof');
var ITERATOR = require('./_wks')('iterator');
var Iterators = require('./_iterators');
module.exports = require('./_core').getIteratorMethod = function (it) {
  if (it != undefined) return it[ITERATOR]
    || it['@@iterator']
    || Iterators[classof(it)];
};

},{"./_classof":31,"./_core":33,"./_iterators":58,"./_wks":98}],100:[function(require,module,exports){
'use strict';
var addToUnscopables = require('./_add-to-unscopables');
var step = require('./_iter-step');
var Iterators = require('./_iterators');
var toIObject = require('./_to-iobject');

// 22.1.3.4 Array.prototype.entries()
// 22.1.3.13 Array.prototype.keys()
// 22.1.3.29 Array.prototype.values()
// 22.1.3.30 Array.prototype[@@iterator]()
module.exports = require('./_iter-define')(Array, 'Array', function (iterated, kind) {
  this._t = toIObject(iterated); // target
  this._i = 0;                   // next index
  this._k = kind;                // kind
// 22.1.5.2.1 %ArrayIteratorPrototype%.next()
}, function () {
  var O = this._t;
  var kind = this._k;
  var index = this._i++;
  if (!O || index >= O.length) {
    this._t = undefined;
    return step(1);
  }
  if (kind == 'keys') return step(0, index);
  if (kind == 'values') return step(0, O[index]);
  return step(0, [index, O[index]]);
}, 'values');

// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)
Iterators.Arguments = Iterators.Array;

addToUnscopables('keys');
addToUnscopables('values');
addToUnscopables('entries');

},{"./_add-to-unscopables":27,"./_iter-define":55,"./_iter-step":57,"./_iterators":58,"./_to-iobject":90}],101:[function(require,module,exports){
var $export = require('./_export');
// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])
$export($export.S, 'Object', { create: require('./_object-create') });

},{"./_export":40,"./_object-create":63}],102:[function(require,module,exports){
var $export = require('./_export');
// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)
$export($export.S + $export.F * !require('./_descriptors'), 'Object', { defineProperty: require('./_object-dp').f });

},{"./_descriptors":36,"./_export":40,"./_object-dp":64}],103:[function(require,module,exports){
// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)
var toIObject = require('./_to-iobject');
var $getOwnPropertyDescriptor = require('./_object-gopd').f;

require('./_object-sap')('getOwnPropertyDescriptor', function () {
  return function getOwnPropertyDescriptor(it, key) {
    return $getOwnPropertyDescriptor(toIObject(it), key);
  };
});

},{"./_object-gopd":66,"./_object-sap":74,"./_to-iobject":90}],104:[function(require,module,exports){
// 19.1.2.9 Object.getPrototypeOf(O)
var toObject = require('./_to-object');
var $getPrototypeOf = require('./_object-gpo');

require('./_object-sap')('getPrototypeOf', function () {
  return function getPrototypeOf(it) {
    return $getPrototypeOf(toObject(it));
  };
});

},{"./_object-gpo":70,"./_object-sap":74,"./_to-object":92}],105:[function(require,module,exports){
// 19.1.3.19 Object.setPrototypeOf(O, proto)
var $export = require('./_export');
$export($export.S, 'Object', { setPrototypeOf: require('./_set-proto').set });

},{"./_export":40,"./_set-proto":80}],106:[function(require,module,exports){

},{}],107:[function(require,module,exports){
'use strict';
var LIBRARY = require('./_library');
var global = require('./_global');
var ctx = require('./_ctx');
var classof = require('./_classof');
var $export = require('./_export');
var isObject = require('./_is-object');
var aFunction = require('./_a-function');
var anInstance = require('./_an-instance');
var forOf = require('./_for-of');
var speciesConstructor = require('./_species-constructor');
var task = require('./_task').set;
var microtask = require('./_microtask')();
var newPromiseCapabilityModule = require('./_new-promise-capability');
var perform = require('./_perform');
var userAgent = require('./_user-agent');
var promiseResolve = require('./_promise-resolve');
var PROMISE = 'Promise';
var TypeError = global.TypeError;
var process = global.process;
var versions = process && process.versions;
var v8 = versions && versions.v8 || '';
var $Promise = global[PROMISE];
var isNode = classof(process) == 'process';
var empty = function () { /* empty */ };
var Internal, newGenericPromiseCapability, OwnPromiseCapability, Wrapper;
var newPromiseCapability = newGenericPromiseCapability = newPromiseCapabilityModule.f;

var USE_NATIVE = !!function () {
  try {
    // correct subclassing with @@species support
    var promise = $Promise.resolve(1);
    var FakePromise = (promise.constructor = {})[require('./_wks')('species')] = function (exec) {
      exec(empty, empty);
    };
    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test
    return (isNode || typeof PromiseRejectionEvent == 'function')
      && promise.then(empty) instanceof FakePromise
      // v8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables
      // https://bugs.chromium.org/p/chromium/issues/detail?id=830565
      // we can't detect it synchronously, so just check versions
      && v8.indexOf('6.6') !== 0
      && userAgent.indexOf('Chrome/66') === -1;
  } catch (e) { /* empty */ }
}();

// helpers
var isThenable = function (it) {
  var then;
  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;
};
var notify = function (promise, isReject) {
  if (promise._n) return;
  promise._n = true;
  var chain = promise._c;
  microtask(function () {
    var value = promise._v;
    var ok = promise._s == 1;
    var i = 0;
    var run = function (reaction) {
      var handler = ok ? reaction.ok : reaction.fail;
      var resolve = reaction.resolve;
      var reject = reaction.reject;
      var domain = reaction.domain;
      var result, then, exited;
      try {
        if (handler) {
          if (!ok) {
            if (promise._h == 2) onHandleUnhandled(promise);
            promise._h = 1;
          }
          if (handler === true) result = value;
          else {
            if (domain) domain.enter();
            result = handler(value); // may throw
            if (domain) {
              domain.exit();
              exited = true;
            }
          }
          if (result === reaction.promise) {
            reject(TypeError('Promise-chain cycle'));
          } else if (then = isThenable(result)) {
            then.call(result, resolve, reject);
          } else resolve(result);
        } else reject(value);
      } catch (e) {
        if (domain && !exited) domain.exit();
        reject(e);
      }
    };
    while (chain.length > i) run(chain[i++]); // variable length - can't use forEach
    promise._c = [];
    promise._n = false;
    if (isReject && !promise._h) onUnhandled(promise);
  });
};
var onUnhandled = function (promise) {
  task.call(global, function () {
    var value = promise._v;
    var unhandled = isUnhandled(promise);
    var result, handler, console;
    if (unhandled) {
      result = perform(function () {
        if (isNode) {
          process.emit('unhandledRejection', value, promise);
        } else if (handler = global.onunhandledrejection) {
          handler({ promise: promise, reason: value });
        } else if ((console = global.console) && console.error) {
          console.error('Unhandled promise rejection', value);
        }
      });
      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should
      promise._h = isNode || isUnhandled(promise) ? 2 : 1;
    } promise._a = undefined;
    if (unhandled && result.e) throw result.v;
  });
};
var isUnhandled = function (promise) {
  return promise._h !== 1 && (promise._a || promise._c).length === 0;
};
var onHandleUnhandled = function (promise) {
  task.call(global, function () {
    var handler;
    if (isNode) {
      process.emit('rejectionHandled', promise);
    } else if (handler = global.onrejectionhandled) {
      handler({ promise: promise, reason: promise._v });
    }
  });
};
var $reject = function (value) {
  var promise = this;
  if (promise._d) return;
  promise._d = true;
  promise = promise._w || promise; // unwrap
  promise._v = value;
  promise._s = 2;
  if (!promise._a) promise._a = promise._c.slice();
  notify(promise, true);
};
var $resolve = function (value) {
  var promise = this;
  var then;
  if (promise._d) return;
  promise._d = true;
  promise = promise._w || promise; // unwrap
  try {
    if (promise === value) throw TypeError("Promise can't be resolved itself");
    if (then = isThenable(value)) {
      microtask(function () {
        var wrapper = { _w: promise, _d: false }; // wrap
        try {
          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));
        } catch (e) {
          $reject.call(wrapper, e);
        }
      });
    } else {
      promise._v = value;
      promise._s = 1;
      notify(promise, false);
    }
  } catch (e) {
    $reject.call({ _w: promise, _d: false }, e); // wrap
  }
};

// constructor polyfill
if (!USE_NATIVE) {
  // 25.4.3.1 Promise(executor)
  $Promise = function Promise(executor) {
    anInstance(this, $Promise, PROMISE, '_h');
    aFunction(executor);
    Internal.call(this);
    try {
      executor(ctx($resolve, this, 1), ctx($reject, this, 1));
    } catch (err) {
      $reject.call(this, err);
    }
  };
  // eslint-disable-next-line no-unused-vars
  Internal = function Promise(executor) {
    this._c = [];             // <- awaiting reactions
    this._a = undefined;      // <- checked in isUnhandled reactions
    this._s = 0;              // <- state
    this._d = false;          // <- done
    this._v = undefined;      // <- value
    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled
    this._n = false;          // <- notify
  };
  Internal.prototype = require('./_redefine-all')($Promise.prototype, {
    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)
    then: function then(onFulfilled, onRejected) {
      var reaction = newPromiseCapability(speciesConstructor(this, $Promise));
      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;
      reaction.fail = typeof onRejected == 'function' && onRejected;
      reaction.domain = isNode ? process.domain : undefined;
      this._c.push(reaction);
      if (this._a) this._a.push(reaction);
      if (this._s) notify(this, false);
      return reaction.promise;
    },
    // 25.4.5.1 Promise.prototype.catch(onRejected)
    'catch': function (onRejected) {
      return this.then(undefined, onRejected);
    }
  });
  OwnPromiseCapability = function () {
    var promise = new Internal();
    this.promise = promise;
    this.resolve = ctx($resolve, promise, 1);
    this.reject = ctx($reject, promise, 1);
  };
  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {
    return C === $Promise || C === Wrapper
      ? new OwnPromiseCapability(C)
      : newGenericPromiseCapability(C);
  };
}

$export($export.G + $export.W + $export.F * !USE_NATIVE, { Promise: $Promise });
require('./_set-to-string-tag')($Promise, PROMISE);
require('./_set-species')(PROMISE);
Wrapper = require('./_core')[PROMISE];

// statics
$export($export.S + $export.F * !USE_NATIVE, PROMISE, {
  // 25.4.4.5 Promise.reject(r)
  reject: function reject(r) {
    var capability = newPromiseCapability(this);
    var $$reject = capability.reject;
    $$reject(r);
    return capability.promise;
  }
});
$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {
  // 25.4.4.6 Promise.resolve(x)
  resolve: function resolve(x) {
    return promiseResolve(LIBRARY && this === Wrapper ? $Promise : this, x);
  }
});
$export($export.S + $export.F * !(USE_NATIVE && require('./_iter-detect')(function (iter) {
  $Promise.all(iter)['catch'](empty);
})), PROMISE, {
  // 25.4.4.1 Promise.all(iterable)
  all: function all(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var resolve = capability.resolve;
    var reject = capability.reject;
    var result = perform(function () {
      var values = [];
      var index = 0;
      var remaining = 1;
      forOf(iterable, false, function (promise) {
        var $index = index++;
        var alreadyCalled = false;
        values.push(undefined);
        remaining++;
        C.resolve(promise).then(function (value) {
          if (alreadyCalled) return;
          alreadyCalled = true;
          values[$index] = value;
          --remaining || resolve(values);
        }, reject);
      });
      --remaining || resolve(values);
    });
    if (result.e) reject(result.v);
    return capability.promise;
  },
  // 25.4.4.4 Promise.race(iterable)
  race: function race(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var reject = capability.reject;
    var result = perform(function () {
      forOf(iterable, false, function (promise) {
        C.resolve(promise).then(capability.resolve, reject);
      });
    });
    if (result.e) reject(result.v);
    return capability.promise;
  }
});

},{"./_a-function":26,"./_an-instance":28,"./_classof":31,"./_core":33,"./_ctx":34,"./_export":40,"./_for-of":42,"./_global":43,"./_is-object":52,"./_iter-detect":56,"./_library":59,"./_microtask":61,"./_new-promise-capability":62,"./_perform":75,"./_promise-resolve":76,"./_redefine-all":78,"./_set-species":81,"./_set-to-string-tag":82,"./_species-constructor":85,"./_task":87,"./_user-agent":95,"./_wks":98}],108:[function(require,module,exports){
'use strict';
var $at = require('./_string-at')(true);

// 21.1.3.27 String.prototype[@@iterator]()
require('./_iter-define')(String, 'String', function (iterated) {
  this._t = String(iterated); // target
  this._i = 0;                // next index
// 21.1.5.2.1 %StringIteratorPrototype%.next()
}, function () {
  var O = this._t;
  var index = this._i;
  var point;
  if (index >= O.length) return { value: undefined, done: true };
  point = $at(O, index);
  this._i += point.length;
  return { value: point, done: false };
});

},{"./_iter-define":55,"./_string-at":86}],109:[function(require,module,exports){
'use strict';
// ECMAScript 6 symbols shim
var global = require('./_global');
var has = require('./_has');
var DESCRIPTORS = require('./_descriptors');
var $export = require('./_export');
var redefine = require('./_redefine');
var META = require('./_meta').KEY;
var $fails = require('./_fails');
var shared = require('./_shared');
var setToStringTag = require('./_set-to-string-tag');
var uid = require('./_uid');
var wks = require('./_wks');
var wksExt = require('./_wks-ext');
var wksDefine = require('./_wks-define');
var enumKeys = require('./_enum-keys');
var isArray = require('./_is-array');
var anObject = require('./_an-object');
var isObject = require('./_is-object');
var toObject = require('./_to-object');
var toIObject = require('./_to-iobject');
var toPrimitive = require('./_to-primitive');
var createDesc = require('./_property-desc');
var _create = require('./_object-create');
var gOPNExt = require('./_object-gopn-ext');
var $GOPD = require('./_object-gopd');
var $GOPS = require('./_object-gops');
var $DP = require('./_object-dp');
var $keys = require('./_object-keys');
var gOPD = $GOPD.f;
var dP = $DP.f;
var gOPN = gOPNExt.f;
var $Symbol = global.Symbol;
var $JSON = global.JSON;
var _stringify = $JSON && $JSON.stringify;
var PROTOTYPE = 'prototype';
var HIDDEN = wks('_hidden');
var TO_PRIMITIVE = wks('toPrimitive');
var isEnum = {}.propertyIsEnumerable;
var SymbolRegistry = shared('symbol-registry');
var AllSymbols = shared('symbols');
var OPSymbols = shared('op-symbols');
var ObjectProto = Object[PROTOTYPE];
var USE_NATIVE = typeof $Symbol == 'function' && !!$GOPS.f;
var QObject = global.QObject;
// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173
var setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;

// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687
var setSymbolDesc = DESCRIPTORS && $fails(function () {
  return _create(dP({}, 'a', {
    get: function () { return dP(this, 'a', { value: 7 }).a; }
  })).a != 7;
}) ? function (it, key, D) {
  var protoDesc = gOPD(ObjectProto, key);
  if (protoDesc) delete ObjectProto[key];
  dP(it, key, D);
  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);
} : dP;

var wrap = function (tag) {
  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);
  sym._k = tag;
  return sym;
};

var isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {
  return typeof it == 'symbol';
} : function (it) {
  return it instanceof $Symbol;
};

var $defineProperty = function defineProperty(it, key, D) {
  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);
  anObject(it);
  key = toPrimitive(key, true);
  anObject(D);
  if (has(AllSymbols, key)) {
    if (!D.enumerable) {
      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));
      it[HIDDEN][key] = true;
    } else {
      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;
      D = _create(D, { enumerable: createDesc(0, false) });
    } return setSymbolDesc(it, key, D);
  } return dP(it, key, D);
};
var $defineProperties = function defineProperties(it, P) {
  anObject(it);
  var keys = enumKeys(P = toIObject(P));
  var i = 0;
  var l = keys.length;
  var key;
  while (l > i) $defineProperty(it, key = keys[i++], P[key]);
  return it;
};
var $create = function create(it, P) {
  return P === undefined ? _create(it) : $defineProperties(_create(it), P);
};
var $propertyIsEnumerable = function propertyIsEnumerable(key) {
  var E = isEnum.call(this, key = toPrimitive(key, true));
  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;
  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;
};
var $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {
  it = toIObject(it);
  key = toPrimitive(key, true);
  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;
  var D = gOPD(it, key);
  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;
  return D;
};
var $getOwnPropertyNames = function getOwnPropertyNames(it) {
  var names = gOPN(toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);
  } return result;
};
var $getOwnPropertySymbols = function getOwnPropertySymbols(it) {
  var IS_OP = it === ObjectProto;
  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);
  } return result;
};

// 19.4.1.1 Symbol([description])
if (!USE_NATIVE) {
  $Symbol = function Symbol() {
    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');
    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);
    var $set = function (value) {
      if (this === ObjectProto) $set.call(OPSymbols, value);
      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;
      setSymbolDesc(this, tag, createDesc(1, value));
    };
    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });
    return wrap(tag);
  };
  redefine($Symbol[PROTOTYPE], 'toString', function toString() {
    return this._k;
  });

  $GOPD.f = $getOwnPropertyDescriptor;
  $DP.f = $defineProperty;
  require('./_object-gopn').f = gOPNExt.f = $getOwnPropertyNames;
  require('./_object-pie').f = $propertyIsEnumerable;
  $GOPS.f = $getOwnPropertySymbols;

  if (DESCRIPTORS && !require('./_library')) {
    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);
  }

  wksExt.f = function (name) {
    return wrap(wks(name));
  };
}

$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });

for (var es6Symbols = (
  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14
  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'
).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);

for (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);

$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {
  // 19.4.2.1 Symbol.for(key)
  'for': function (key) {
    return has(SymbolRegistry, key += '')
      ? SymbolRegistry[key]
      : SymbolRegistry[key] = $Symbol(key);
  },
  // 19.4.2.5 Symbol.keyFor(sym)
  keyFor: function keyFor(sym) {
    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');
    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;
  },
  useSetter: function () { setter = true; },
  useSimple: function () { setter = false; }
});

$export($export.S + $export.F * !USE_NATIVE, 'Object', {
  // 19.1.2.2 Object.create(O [, Properties])
  create: $create,
  // 19.1.2.4 Object.defineProperty(O, P, Attributes)
  defineProperty: $defineProperty,
  // 19.1.2.3 Object.defineProperties(O, Properties)
  defineProperties: $defineProperties,
  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)
  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,
  // 19.1.2.7 Object.getOwnPropertyNames(O)
  getOwnPropertyNames: $getOwnPropertyNames,
  // 19.1.2.8 Object.getOwnPropertySymbols(O)
  getOwnPropertySymbols: $getOwnPropertySymbols
});

// Chrome 38 and 39 `Object.getOwnPropertySymbols` fails on primitives
// https://bugs.chromium.org/p/v8/issues/detail?id=3443
var FAILS_ON_PRIMITIVES = $fails(function () { $GOPS.f(1); });

$export($export.S + $export.F * FAILS_ON_PRIMITIVES, 'Object', {
  getOwnPropertySymbols: function getOwnPropertySymbols(it) {
    return $GOPS.f(toObject(it));
  }
});

// 24.3.2 JSON.stringify(value [, replacer [, space]])
$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {
  var S = $Symbol();
  // MS Edge converts symbol values to JSON as {}
  // WebKit converts symbol values to JSON as null
  // V8 throws on boxed symbols
  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';
})), 'JSON', {
  stringify: function stringify(it) {
    var args = [it];
    var i = 1;
    var replacer, $replacer;
    while (arguments.length > i) args.push(arguments[i++]);
    $replacer = replacer = args[1];
    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined
    if (!isArray(replacer)) replacer = function (key, value) {
      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);
      if (!isSymbol(value)) return value;
    };
    args[1] = replacer;
    return _stringify.apply($JSON, args);
  }
});

// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)
$Symbol[PROTOTYPE][TO_PRIMITIVE] || require('./_hide')($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);
// 19.4.3.5 Symbol.prototype[@@toStringTag]
setToStringTag($Symbol, 'Symbol');
// 20.2.1.9 Math[@@toStringTag]
setToStringTag(Math, 'Math', true);
// 24.3.3 JSON[@@toStringTag]
setToStringTag(global.JSON, 'JSON', true);

},{"./_an-object":29,"./_descriptors":36,"./_enum-keys":39,"./_export":40,"./_fails":41,"./_global":43,"./_has":44,"./_hide":45,"./_is-array":51,"./_is-object":52,"./_library":59,"./_meta":60,"./_object-create":63,"./_object-dp":64,"./_object-gopd":66,"./_object-gopn":68,"./_object-gopn-ext":67,"./_object-gops":69,"./_object-keys":72,"./_object-pie":73,"./_property-desc":77,"./_redefine":79,"./_set-to-string-tag":82,"./_shared":84,"./_to-iobject":90,"./_to-object":92,"./_to-primitive":93,"./_uid":94,"./_wks":98,"./_wks-define":96,"./_wks-ext":97}],110:[function(require,module,exports){
// https://github.com/tc39/proposal-promise-finally
'use strict';
var $export = require('./_export');
var core = require('./_core');
var global = require('./_global');
var speciesConstructor = require('./_species-constructor');
var promiseResolve = require('./_promise-resolve');

$export($export.P + $export.R, 'Promise', { 'finally': function (onFinally) {
  var C = speciesConstructor(this, core.Promise || global.Promise);
  var isFunction = typeof onFinally == 'function';
  return this.then(
    isFunction ? function (x) {
      return promiseResolve(C, onFinally()).then(function () { return x; });
    } : onFinally,
    isFunction ? function (e) {
      return promiseResolve(C, onFinally()).then(function () { throw e; });
    } : onFinally
  );
} });

},{"./_core":33,"./_export":40,"./_global":43,"./_promise-resolve":76,"./_species-constructor":85}],111:[function(require,module,exports){
'use strict';
// https://github.com/tc39/proposal-promise-try
var $export = require('./_export');
var newPromiseCapability = require('./_new-promise-capability');
var perform = require('./_perform');

$export($export.S, 'Promise', { 'try': function (callbackfn) {
  var promiseCapability = newPromiseCapability.f(this);
  var result = perform(callbackfn);
  (result.e ? promiseCapability.reject : promiseCapability.resolve)(result.v);
  return promiseCapability.promise;
} });

},{"./_export":40,"./_new-promise-capability":62,"./_perform":75}],112:[function(require,module,exports){
require('./_wks-define')('asyncIterator');

},{"./_wks-define":96}],113:[function(require,module,exports){
require('./_wks-define')('observable');

},{"./_wks-define":96}],114:[function(require,module,exports){
require('./es6.array.iterator');
var global = require('./_global');
var hide = require('./_hide');
var Iterators = require('./_iterators');
var TO_STRING_TAG = require('./_wks')('toStringTag');

var DOMIterables = ('CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,' +
  'DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,' +
  'MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,' +
  'SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,' +
  'TextTrackList,TouchList').split(',');

for (var i = 0; i < DOMIterables.length; i++) {
  var NAME = DOMIterables[i];
  var Collection = global[NAME];
  var proto = Collection && Collection.prototype;
  if (proto && !proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);
  Iterators[NAME] = Iterators.Array;
}

},{"./_global":43,"./_hide":45,"./_iterators":58,"./_wks":98,"./es6.array.iterator":100}],115:[function(require,module,exports){
/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

// This method of obtaining a reference to the global object needs to be
// kept identical to the way it is obtained in runtime.js
var g = (function() { return this })() || Function("return this")();

// Use `getOwnPropertyNames` because not all browsers support calling
// `hasOwnProperty` on the global `self` object in a worker. See #183.
var hadRuntime = g.regeneratorRuntime &&
  Object.getOwnPropertyNames(g).indexOf("regeneratorRuntime") >= 0;

// Save the old regeneratorRuntime in case it needs to be restored later.
var oldRuntime = hadRuntime && g.regeneratorRuntime;

// Force reevalutation of runtime.js.
g.regeneratorRuntime = undefined;

module.exports = require("./runtime");

if (hadRuntime) {
  // Restore the original runtime.
  g.regeneratorRuntime = oldRuntime;
} else {
  // Remove the global property added by runtime.js.
  try {
    delete g.regeneratorRuntime;
  } catch(e) {
    g.regeneratorRuntime = undefined;
  }
}

},{"./runtime":116}],116:[function(require,module,exports){
/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

!(function(global) {
  "use strict";

  var Op = Object.prototype;
  var hasOwn = Op.hasOwnProperty;
  var undefined; // More compressible than void 0.
  var $Symbol = typeof Symbol === "function" ? Symbol : {};
  var iteratorSymbol = $Symbol.iterator || "@@iterator";
  var asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator";
  var toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag";

  var inModule = typeof module === "object";
  var runtime = global.regeneratorRuntime;
  if (runtime) {
    if (inModule) {
      // If regeneratorRuntime is defined globally and we're in a module,
      // make the exports object identical to regeneratorRuntime.
      module.exports = runtime;
    }
    // Don't bother evaluating the rest of this file if the runtime was
    // already defined globally.
    return;
  }

  // Define the runtime globally (as expected by generated code) as either
  // module.exports (if we're in a module) or a new, empty object.
  runtime = global.regeneratorRuntime = inModule ? module.exports : {};

  function wrap(innerFn, outerFn, self, tryLocsList) {
    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.
    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;
    var generator = Object.create(protoGenerator.prototype);
    var context = new Context(tryLocsList || []);

    // The ._invoke method unifies the implementations of the .next,
    // .throw, and .return methods.
    generator._invoke = makeInvokeMethod(innerFn, self, context);

    return generator;
  }
  runtime.wrap = wrap;

  // Try/catch helper to minimize deoptimizations. Returns a completion
  // record like context.tryEntries[i].completion. This interface could
  // have been (and was previously) designed to take a closure to be
  // invoked without arguments, but in all the cases we care about we
  // already have an existing method we want to call, so there's no need
  // to create a new function object. We can even get away with assuming
  // the method takes exactly one argument, since that happens to be true
  // in every case, so we don't have to touch the arguments object. The
  // only additional allocation required is the completion record, which
  // has a stable shape and so hopefully should be cheap to allocate.
  function tryCatch(fn, obj, arg) {
    try {
      return { type: "normal", arg: fn.call(obj, arg) };
    } catch (err) {
      return { type: "throw", arg: err };
    }
  }

  var GenStateSuspendedStart = "suspendedStart";
  var GenStateSuspendedYield = "suspendedYield";
  var GenStateExecuting = "executing";
  var GenStateCompleted = "completed";

  // Returning this object from the innerFn has the same effect as
  // breaking out of the dispatch switch statement.
  var ContinueSentinel = {};

  // Dummy constructor functions that we use as the .constructor and
  // .constructor.prototype properties for functions that return Generator
  // objects. For full spec compliance, you may wish to configure your
  // minifier not to mangle the names of these two functions.
  function Generator() {}
  function GeneratorFunction() {}
  function GeneratorFunctionPrototype() {}

  // This is a polyfill for %IteratorPrototype% for environments that
  // don't natively support it.
  var IteratorPrototype = {};
  IteratorPrototype[iteratorSymbol] = function () {
    return this;
  };

  var getProto = Object.getPrototypeOf;
  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));
  if (NativeIteratorPrototype &&
      NativeIteratorPrototype !== Op &&
      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {
    // This environment has a native %IteratorPrototype%; use it instead
    // of the polyfill.
    IteratorPrototype = NativeIteratorPrototype;
  }

  var Gp = GeneratorFunctionPrototype.prototype =
    Generator.prototype = Object.create(IteratorPrototype);
  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;
  GeneratorFunctionPrototype.constructor = GeneratorFunction;
  GeneratorFunctionPrototype[toStringTagSymbol] =
    GeneratorFunction.displayName = "GeneratorFunction";

  // Helper for defining the .next, .throw, and .return methods of the
  // Iterator interface in terms of a single ._invoke method.
  function defineIteratorMethods(prototype) {
    ["next", "throw", "return"].forEach(function(method) {
      prototype[method] = function(arg) {
        return this._invoke(method, arg);
      };
    });
  }

  runtime.isGeneratorFunction = function(genFun) {
    var ctor = typeof genFun === "function" && genFun.constructor;
    return ctor
      ? ctor === GeneratorFunction ||
        // For the native GeneratorFunction constructor, the best we can
        // do is to check its .name property.
        (ctor.displayName || ctor.name) === "GeneratorFunction"
      : false;
  };

  runtime.mark = function(genFun) {
    if (Object.setPrototypeOf) {
      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);
    } else {
      genFun.__proto__ = GeneratorFunctionPrototype;
      if (!(toStringTagSymbol in genFun)) {
        genFun[toStringTagSymbol] = "GeneratorFunction";
      }
    }
    genFun.prototype = Object.create(Gp);
    return genFun;
  };

  // Within the body of any async function, `await x` is transformed to
  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test
  // `hasOwn.call(value, "__await")` to determine if the yielded value is
  // meant to be awaited.
  runtime.awrap = function(arg) {
    return { __await: arg };
  };

  function AsyncIterator(generator) {
    function invoke(method, arg, resolve, reject) {
      var record = tryCatch(generator[method], generator, arg);
      if (record.type === "throw") {
        reject(record.arg);
      } else {
        var result = record.arg;
        var value = result.value;
        if (value &&
            typeof value === "object" &&
            hasOwn.call(value, "__await")) {
          return Promise.resolve(value.__await).then(function(value) {
            invoke("next", value, resolve, reject);
          }, function(err) {
            invoke("throw", err, resolve, reject);
          });
        }

        return Promise.resolve(value).then(function(unwrapped) {
          // When a yielded Promise is resolved, its final value becomes
          // the .value of the Promise<{value,done}> result for the
          // current iteration. If the Promise is rejected, however, the
          // result for this iteration will be rejected with the same
          // reason. Note that rejections of yielded Promises are not
          // thrown back into the generator function, as is the case
          // when an awaited Promise is rejected. This difference in
          // behavior between yield and await is important, because it
          // allows the consumer to decide what to do with the yielded
          // rejection (swallow it and continue, manually .throw it back
          // into the generator, abandon iteration, whatever). With
          // await, by contrast, there is no opportunity to examine the
          // rejection reason outside the generator function, so the
          // only option is to throw it from the await expression, and
          // let the generator function handle the exception.
          result.value = unwrapped;
          resolve(result);
        }, reject);
      }
    }

    var previousPromise;

    function enqueue(method, arg) {
      function callInvokeWithMethodAndArg() {
        return new Promise(function(resolve, reject) {
          invoke(method, arg, resolve, reject);
        });
      }

      return previousPromise =
        // If enqueue has been called before, then we want to wait until
        // all previous Promises have been resolved before calling invoke,
        // so that results are always delivered in the correct order. If
        // enqueue has not been called before, then it is important to
        // call invoke immediately, without waiting on a callback to fire,
        // so that the async generator function has the opportunity to do
        // any necessary setup in a predictable way. This predictability
        // is why the Promise constructor synchronously invokes its
        // executor callback, and why async functions synchronously
        // execute code before the first await. Since we implement simple
        // async functions in terms of async generators, it is especially
        // important to get this right, even though it requires care.
        previousPromise ? previousPromise.then(
          callInvokeWithMethodAndArg,
          // Avoid propagating failures to Promises returned by later
          // invocations of the iterator.
          callInvokeWithMethodAndArg
        ) : callInvokeWithMethodAndArg();
    }

    // Define the unified helper method that is used to implement .next,
    // .throw, and .return (see defineIteratorMethods).
    this._invoke = enqueue;
  }

  defineIteratorMethods(AsyncIterator.prototype);
  AsyncIterator.prototype[asyncIteratorSymbol] = function () {
    return this;
  };
  runtime.AsyncIterator = AsyncIterator;

  // Note that simple async functions are implemented on top of
  // AsyncIterator objects; they just return a Promise for the value of
  // the final result produced by the iterator.
  runtime.async = function(innerFn, outerFn, self, tryLocsList) {
    var iter = new AsyncIterator(
      wrap(innerFn, outerFn, self, tryLocsList)
    );

    return runtime.isGeneratorFunction(outerFn)
      ? iter // If outerFn is a generator, return the full iterator.
      : iter.next().then(function(result) {
          return result.done ? result.value : iter.next();
        });
  };

  function makeInvokeMethod(innerFn, self, context) {
    var state = GenStateSuspendedStart;

    return function invoke(method, arg) {
      if (state === GenStateExecuting) {
        throw new Error("Generator is already running");
      }

      if (state === GenStateCompleted) {
        if (method === "throw") {
          throw arg;
        }

        // Be forgiving, per 25.3.3.3.3 of the spec:
        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume
        return doneResult();
      }

      context.method = method;
      context.arg = arg;

      while (true) {
        var delegate = context.delegate;
        if (delegate) {
          var delegateResult = maybeInvokeDelegate(delegate, context);
          if (delegateResult) {
            if (delegateResult === ContinueSentinel) continue;
            return delegateResult;
          }
        }

        if (context.method === "next") {
          // Setting context._sent for legacy support of Babel's
          // function.sent implementation.
          context.sent = context._sent = context.arg;

        } else if (context.method === "throw") {
          if (state === GenStateSuspendedStart) {
            state = GenStateCompleted;
            throw context.arg;
          }

          context.dispatchException(context.arg);

        } else if (context.method === "return") {
          context.abrupt("return", context.arg);
        }

        state = GenStateExecuting;

        var record = tryCatch(innerFn, self, context);
        if (record.type === "normal") {
          // If an exception is thrown from innerFn, we leave state ===
          // GenStateExecuting and loop back for another invocation.
          state = context.done
            ? GenStateCompleted
            : GenStateSuspendedYield;

          if (record.arg === ContinueSentinel) {
            continue;
          }

          return {
            value: record.arg,
            done: context.done
          };

        } else if (record.type === "throw") {
          state = GenStateCompleted;
          // Dispatch the exception by looping back around to the
          // context.dispatchException(context.arg) call above.
          context.method = "throw";
          context.arg = record.arg;
        }
      }
    };
  }

  // Call delegate.iterator[context.method](context.arg) and handle the
  // result, either by returning a { value, done } result from the
  // delegate iterator, or by modifying context.method and context.arg,
  // setting context.delegate to null, and returning the ContinueSentinel.
  function maybeInvokeDelegate(delegate, context) {
    var method = delegate.iterator[context.method];
    if (method === undefined) {
      // A .throw or .return when the delegate iterator has no .throw
      // method always terminates the yield* loop.
      context.delegate = null;

      if (context.method === "throw") {
        if (delegate.iterator.return) {
          // If the delegate iterator has a return method, give it a
          // chance to clean up.
          context.method = "return";
          context.arg = undefined;
          maybeInvokeDelegate(delegate, context);

          if (context.method === "throw") {
            // If maybeInvokeDelegate(context) changed context.method from
            // "return" to "throw", let that override the TypeError below.
            return ContinueSentinel;
          }
        }

        context.method = "throw";
        context.arg = new TypeError(
          "The iterator does not provide a 'throw' method");
      }

      return ContinueSentinel;
    }

    var record = tryCatch(method, delegate.iterator, context.arg);

    if (record.type === "throw") {
      context.method = "throw";
      context.arg = record.arg;
      context.delegate = null;
      return ContinueSentinel;
    }

    var info = record.arg;

    if (! info) {
      context.method = "throw";
      context.arg = new TypeError("iterator result is not an object");
      context.delegate = null;
      return ContinueSentinel;
    }

    if (info.done) {
      // Assign the result of the finished delegate to the temporary
      // variable specified by delegate.resultName (see delegateYield).
      context[delegate.resultName] = info.value;

      // Resume execution at the desired location (see delegateYield).
      context.next = delegate.nextLoc;

      // If context.method was "throw" but the delegate handled the
      // exception, let the outer generator proceed normally. If
      // context.method was "next", forget context.arg since it has been
      // "consumed" by the delegate iterator. If context.method was
      // "return", allow the original .return call to continue in the
      // outer generator.
      if (context.method !== "return") {
        context.method = "next";
        context.arg = undefined;
      }

    } else {
      // Re-yield the result returned by the delegate method.
      return info;
    }

    // The delegate iterator is finished, so forget it and continue with
    // the outer generator.
    context.delegate = null;
    return ContinueSentinel;
  }

  // Define Generator.prototype.{next,throw,return} in terms of the
  // unified ._invoke helper method.
  defineIteratorMethods(Gp);

  Gp[toStringTagSymbol] = "Generator";

  // A Generator should always return itself as the iterator object when the
  // @@iterator function is called on it. Some browsers' implementations of the
  // iterator prototype chain incorrectly implement this, causing the Generator
  // object to not be returned from this call. This ensures that doesn't happen.
  // See https://github.com/facebook/regenerator/issues/274 for more details.
  Gp[iteratorSymbol] = function() {
    return this;
  };

  Gp.toString = function() {
    return "[object Generator]";
  };

  function pushTryEntry(locs) {
    var entry = { tryLoc: locs[0] };

    if (1 in locs) {
      entry.catchLoc = locs[1];
    }

    if (2 in locs) {
      entry.finallyLoc = locs[2];
      entry.afterLoc = locs[3];
    }

    this.tryEntries.push(entry);
  }

  function resetTryEntry(entry) {
    var record = entry.completion || {};
    record.type = "normal";
    delete record.arg;
    entry.completion = record;
  }

  function Context(tryLocsList) {
    // The root entry object (effectively a try statement without a catch
    // or a finally block) gives us a place to store values thrown from
    // locations where there is no enclosing try statement.
    this.tryEntries = [{ tryLoc: "root" }];
    tryLocsList.forEach(pushTryEntry, this);
    this.reset(true);
  }

  runtime.keys = function(object) {
    var keys = [];
    for (var key in object) {
      keys.push(key);
    }
    keys.reverse();

    // Rather than returning an object with a next method, we keep
    // things simple and return the next function itself.
    return function next() {
      while (keys.length) {
        var key = keys.pop();
        if (key in object) {
          next.value = key;
          next.done = false;
          return next;
        }
      }

      // To avoid creating an additional object, we just hang the .value
      // and .done properties off the next function object itself. This
      // also ensures that the minifier will not anonymize the function.
      next.done = true;
      return next;
    };
  };

  function values(iterable) {
    if (iterable) {
      var iteratorMethod = iterable[iteratorSymbol];
      if (iteratorMethod) {
        return iteratorMethod.call(iterable);
      }

      if (typeof iterable.next === "function") {
        return iterable;
      }

      if (!isNaN(iterable.length)) {
        var i = -1, next = function next() {
          while (++i < iterable.length) {
            if (hasOwn.call(iterable, i)) {
              next.value = iterable[i];
              next.done = false;
              return next;
            }
          }

          next.value = undefined;
          next.done = true;

          return next;
        };

        return next.next = next;
      }
    }

    // Return an iterator with no values.
    return { next: doneResult };
  }
  runtime.values = values;

  function doneResult() {
    return { value: undefined, done: true };
  }

  Context.prototype = {
    constructor: Context,

    reset: function(skipTempReset) {
      this.prev = 0;
      this.next = 0;
      // Resetting context._sent for legacy support of Babel's
      // function.sent implementation.
      this.sent = this._sent = undefined;
      this.done = false;
      this.delegate = null;

      this.method = "next";
      this.arg = undefined;

      this.tryEntries.forEach(resetTryEntry);

      if (!skipTempReset) {
        for (var name in this) {
          // Not sure about the optimal order of these conditions:
          if (name.charAt(0) === "t" &&
              hasOwn.call(this, name) &&
              !isNaN(+name.slice(1))) {
            this[name] = undefined;
          }
        }
      }
    },

    stop: function() {
      this.done = true;

      var rootEntry = this.tryEntries[0];
      var rootRecord = rootEntry.completion;
      if (rootRecord.type === "throw") {
        throw rootRecord.arg;
      }

      return this.rval;
    },

    dispatchException: function(exception) {
      if (this.done) {
        throw exception;
      }

      var context = this;
      function handle(loc, caught) {
        record.type = "throw";
        record.arg = exception;
        context.next = loc;

        if (caught) {
          // If the dispatched exception was caught by a catch block,
          // then let that catch block handle the exception normally.
          context.method = "next";
          context.arg = undefined;
        }

        return !! caught;
      }

      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        var record = entry.completion;

        if (entry.tryLoc === "root") {
          // Exception thrown outside of any try block that could handle
          // it, so set the completion value of the entire function to
          // throw the exception.
          return handle("end");
        }

        if (entry.tryLoc <= this.prev) {
          var hasCatch = hasOwn.call(entry, "catchLoc");
          var hasFinally = hasOwn.call(entry, "finallyLoc");

          if (hasCatch && hasFinally) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            } else if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else if (hasCatch) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            }

          } else if (hasFinally) {
            if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else {
            throw new Error("try statement without catch or finally");
          }
        }
      }
    },

    abrupt: function(type, arg) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc <= this.prev &&
            hasOwn.call(entry, "finallyLoc") &&
            this.prev < entry.finallyLoc) {
          var finallyEntry = entry;
          break;
        }
      }

      if (finallyEntry &&
          (type === "break" ||
           type === "continue") &&
          finallyEntry.tryLoc <= arg &&
          arg <= finallyEntry.finallyLoc) {
        // Ignore the finally entry if control is not jumping to a
        // location outside the try/catch block.
        finallyEntry = null;
      }

      var record = finallyEntry ? finallyEntry.completion : {};
      record.type = type;
      record.arg = arg;

      if (finallyEntry) {
        this.method = "next";
        this.next = finallyEntry.finallyLoc;
        return ContinueSentinel;
      }

      return this.complete(record);
    },

    complete: function(record, afterLoc) {
      if (record.type === "throw") {
        throw record.arg;
      }

      if (record.type === "break" ||
          record.type === "continue") {
        this.next = record.arg;
      } else if (record.type === "return") {
        this.rval = this.arg = record.arg;
        this.method = "return";
        this.next = "end";
      } else if (record.type === "normal" && afterLoc) {
        this.next = afterLoc;
      }

      return ContinueSentinel;
    },

    finish: function(finallyLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.finallyLoc === finallyLoc) {
          this.complete(entry.completion, entry.afterLoc);
          resetTryEntry(entry);
          return ContinueSentinel;
        }
      }
    },

    "catch": function(tryLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc === tryLoc) {
          var record = entry.completion;
          if (record.type === "throw") {
            var thrown = record.arg;
            resetTryEntry(entry);
          }
          return thrown;
        }
      }

      // The context.catch method must only be called with a location
      // argument that corresponds to a known catch block.
      throw new Error("illegal catch attempt");
    },

    delegateYield: function(iterable, resultName, nextLoc) {
      this.delegate = {
        iterator: values(iterable),
        resultName: resultName,
        nextLoc: nextLoc
      };

      if (this.method === "next") {
        // Deliberately forget the last sent value so that we don't
        // accidentally pass it on to the delegate.
        this.arg = undefined;
      }

      return ContinueSentinel;
    }
  };
})(
  // In sloppy mode, unbound `this` refers to the global object, fallback to
  // Function constructor if we're in global strict mode. That is sadly a form
  // of indirect eval which violates Content Security Policy.
  (function() { return this })() || Function("return this")()
);

},{}],117:[function(require,module,exports){
/*
 *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var SDPUtils = require('sdp');

function fixStatsType(stat) {
  return {
    inboundrtp: 'inbound-rtp',
    outboundrtp: 'outbound-rtp',
    candidatepair: 'candidate-pair',
    localcandidate: 'local-candidate',
    remotecandidate: 'remote-candidate'
  }[stat.type] || stat.type;
}

function writeMediaSection(transceiver, caps, type, stream, dtlsRole) {
  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);

  // Map ICE parameters (ufrag, pwd) to SDP.
  sdp += SDPUtils.writeIceParameters(
      transceiver.iceGatherer.getLocalParameters());

  // Map DTLS parameters to SDP.
  sdp += SDPUtils.writeDtlsParameters(
      transceiver.dtlsTransport.getLocalParameters(),
      type === 'offer' ? 'actpass' : dtlsRole || 'active');

  sdp += 'a=mid:' + transceiver.mid + '\r\n';

  if (transceiver.rtpSender && transceiver.rtpReceiver) {
    sdp += 'a=sendrecv\r\n';
  } else if (transceiver.rtpSender) {
    sdp += 'a=sendonly\r\n';
  } else if (transceiver.rtpReceiver) {
    sdp += 'a=recvonly\r\n';
  } else {
    sdp += 'a=inactive\r\n';
  }

  if (transceiver.rtpSender) {
    var trackId = transceiver.rtpSender._initialTrackId ||
        transceiver.rtpSender.track.id;
    transceiver.rtpSender._initialTrackId = trackId;
    // spec.
    var msid = 'msid:' + (stream ? stream.id : '-') + ' ' +
        trackId + '\r\n';
    sdp += 'a=' + msid;
    // for Chrome. Legacy should no longer be required.
    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +
        ' ' + msid;

    // RTX
    if (transceiver.sendEncodingParameters[0].rtx) {
      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +
          ' ' + msid;
      sdp += 'a=ssrc-group:FID ' +
          transceiver.sendEncodingParameters[0].ssrc + ' ' +
          transceiver.sendEncodingParameters[0].rtx.ssrc +
          '\r\n';
    }
  }
  // FIXME: this should be written by writeRtpDescription.
  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +
      ' cname:' + SDPUtils.localCName + '\r\n';
  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {
    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +
        ' cname:' + SDPUtils.localCName + '\r\n';
  }
  return sdp;
}

// Edge does not like
// 1) stun: filtered after 14393 unless ?transport=udp is present
// 2) turn: that does not have all of turn:host:port?transport=udp
// 3) turn: with ipv6 addresses
// 4) turn: occurring muliple times
function filterIceServers(iceServers, edgeVersion) {
  var hasTurn = false;
  iceServers = JSON.parse(JSON.stringify(iceServers));
  return iceServers.filter(function(server) {
    if (server && (server.urls || server.url)) {
      var urls = server.urls || server.url;
      if (server.url && !server.urls) {
        console.warn('RTCIceServer.url is deprecated! Use urls instead.');
      }
      var isString = typeof urls === 'string';
      if (isString) {
        urls = [urls];
      }
      urls = urls.filter(function(url) {
        var validTurn = url.indexOf('turn:') === 0 &&
            url.indexOf('transport=udp') !== -1 &&
            url.indexOf('turn:[') === -1 &&
            !hasTurn;

        if (validTurn) {
          hasTurn = true;
          return true;
        }
        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&
            url.indexOf('?transport=udp') === -1;
      });

      delete server.url;
      server.urls = isString ? urls[0] : urls;
      return !!urls.length;
    }
  });
}

// Determines the intersection of local and remote capabilities.
function getCommonCapabilities(localCapabilities, remoteCapabilities) {
  var commonCapabilities = {
    codecs: [],
    headerExtensions: [],
    fecMechanisms: []
  };

  var findCodecByPayloadType = function(pt, codecs) {
    pt = parseInt(pt, 10);
    for (var i = 0; i < codecs.length; i++) {
      if (codecs[i].payloadType === pt ||
          codecs[i].preferredPayloadType === pt) {
        return codecs[i];
      }
    }
  };

  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {
    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);
    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);
    return lCodec && rCodec &&
        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();
  };

  localCapabilities.codecs.forEach(function(lCodec) {
    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {
      var rCodec = remoteCapabilities.codecs[i];
      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&
          lCodec.clockRate === rCodec.clockRate) {
        if (lCodec.name.toLowerCase() === 'rtx' &&
            lCodec.parameters && rCodec.parameters.apt) {
          // for RTX we need to find the local rtx that has a apt
          // which points to the same local codec as the remote one.
          if (!rtxCapabilityMatches(lCodec, rCodec,
              localCapabilities.codecs, remoteCapabilities.codecs)) {
            continue;
          }
        }
        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy
        // number of channels is the highest common number of channels
        rCodec.numChannels = Math.min(lCodec.numChannels,
            rCodec.numChannels);
        // push rCodec so we reply with offerer payload type
        commonCapabilities.codecs.push(rCodec);

        // determine common feedback mechanisms
        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {
          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {
            if (lCodec.rtcpFeedback[j].type === fb.type &&
                lCodec.rtcpFeedback[j].parameter === fb.parameter) {
              return true;
            }
          }
          return false;
        });
        // FIXME: also need to determine .parameters
        //  see https://github.com/openpeer/ortc/issues/569
        break;
      }
    }
  });

  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {
    for (var i = 0; i < remoteCapabilities.headerExtensions.length;
         i++) {
      var rHeaderExtension = remoteCapabilities.headerExtensions[i];
      if (lHeaderExtension.uri === rHeaderExtension.uri) {
        commonCapabilities.headerExtensions.push(rHeaderExtension);
        break;
      }
    }
  });

  // FIXME: fecMechanisms
  return commonCapabilities;
}

// is action=setLocalDescription with type allowed in signalingState
function isActionAllowedInSignalingState(action, type, signalingState) {
  return {
    offer: {
      setLocalDescription: ['stable', 'have-local-offer'],
      setRemoteDescription: ['stable', 'have-remote-offer']
    },
    answer: {
      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],
      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']
    }
  }[type][action].indexOf(signalingState) !== -1;
}

function maybeAddCandidate(iceTransport, candidate) {
  // Edge's internal representation adds some fields therefore
  // not all field are taken into account.
  var alreadyAdded = iceTransport.getRemoteCandidates()
      .find(function(remoteCandidate) {
        return candidate.foundation === remoteCandidate.foundation &&
            candidate.ip === remoteCandidate.ip &&
            candidate.port === remoteCandidate.port &&
            candidate.priority === remoteCandidate.priority &&
            candidate.protocol === remoteCandidate.protocol &&
            candidate.type === remoteCandidate.type;
      });
  if (!alreadyAdded) {
    iceTransport.addRemoteCandidate(candidate);
  }
  return !alreadyAdded;
}


function makeError(name, description) {
  var e = new Error(description);
  e.name = name;
  // legacy error codes from https://heycam.github.io/webidl/#idl-DOMException-error-names
  e.code = {
    NotSupportedError: 9,
    InvalidStateError: 11,
    InvalidAccessError: 15,
    TypeError: undefined,
    OperationError: undefined
  }[name];
  return e;
}

module.exports = function(window, edgeVersion) {
  // https://w3c.github.io/mediacapture-main/#mediastream
  // Helper function to add the track to the stream and
  // dispatch the event ourselves.
  function addTrackToStreamAndFireEvent(track, stream) {
    stream.addTrack(track);
    stream.dispatchEvent(new window.MediaStreamTrackEvent('addtrack',
        {track: track}));
  }

  function removeTrackFromStreamAndFireEvent(track, stream) {
    stream.removeTrack(track);
    stream.dispatchEvent(new window.MediaStreamTrackEvent('removetrack',
        {track: track}));
  }

  function fireAddTrack(pc, track, receiver, streams) {
    var trackEvent = new Event('track');
    trackEvent.track = track;
    trackEvent.receiver = receiver;
    trackEvent.transceiver = {receiver: receiver};
    trackEvent.streams = streams;
    window.setTimeout(function() {
      pc._dispatchEvent('track', trackEvent);
    });
  }

  var RTCPeerConnection = function(config) {
    var pc = this;

    var _eventTarget = document.createDocumentFragment();
    ['addEventListener', 'removeEventListener', 'dispatchEvent']
        .forEach(function(method) {
          pc[method] = _eventTarget[method].bind(_eventTarget);
        });

    this.canTrickleIceCandidates = null;

    this.needNegotiation = false;

    this.localStreams = [];
    this.remoteStreams = [];

    this._localDescription = null;
    this._remoteDescription = null;

    this.signalingState = 'stable';
    this.iceConnectionState = 'new';
    this.connectionState = 'new';
    this.iceGatheringState = 'new';

    config = JSON.parse(JSON.stringify(config || {}));

    this.usingBundle = config.bundlePolicy === 'max-bundle';
    if (config.rtcpMuxPolicy === 'negotiate') {
      throw(makeError('NotSupportedError',
          'rtcpMuxPolicy \'negotiate\' is not supported'));
    } else if (!config.rtcpMuxPolicy) {
      config.rtcpMuxPolicy = 'require';
    }

    switch (config.iceTransportPolicy) {
      case 'all':
      case 'relay':
        break;
      default:
        config.iceTransportPolicy = 'all';
        break;
    }

    switch (config.bundlePolicy) {
      case 'balanced':
      case 'max-compat':
      case 'max-bundle':
        break;
      default:
        config.bundlePolicy = 'balanced';
        break;
    }

    config.iceServers = filterIceServers(config.iceServers || [], edgeVersion);

    this._iceGatherers = [];
    if (config.iceCandidatePoolSize) {
      for (var i = config.iceCandidatePoolSize; i > 0; i--) {
        this._iceGatherers.push(new window.RTCIceGatherer({
          iceServers: config.iceServers,
          gatherPolicy: config.iceTransportPolicy
        }));
      }
    } else {
      config.iceCandidatePoolSize = 0;
    }

    this._config = config;

    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...
    // everything that is needed to describe a SDP m-line.
    this.transceivers = [];

    this._sdpSessionId = SDPUtils.generateSessionId();
    this._sdpSessionVersion = 0;

    this._dtlsRole = undefined; // role for a=setup to use in answers.

    this._isClosed = false;
  };

  Object.defineProperty(RTCPeerConnection.prototype, 'localDescription', {
    configurable: true,
    get: function() {
      return this._localDescription;
    }
  });
  Object.defineProperty(RTCPeerConnection.prototype, 'remoteDescription', {
    configurable: true,
    get: function() {
      return this._remoteDescription;
    }
  });

  // set up event handlers on prototype
  RTCPeerConnection.prototype.onicecandidate = null;
  RTCPeerConnection.prototype.onaddstream = null;
  RTCPeerConnection.prototype.ontrack = null;
  RTCPeerConnection.prototype.onremovestream = null;
  RTCPeerConnection.prototype.onsignalingstatechange = null;
  RTCPeerConnection.prototype.oniceconnectionstatechange = null;
  RTCPeerConnection.prototype.onconnectionstatechange = null;
  RTCPeerConnection.prototype.onicegatheringstatechange = null;
  RTCPeerConnection.prototype.onnegotiationneeded = null;
  RTCPeerConnection.prototype.ondatachannel = null;

  RTCPeerConnection.prototype._dispatchEvent = function(name, event) {
    if (this._isClosed) {
      return;
    }
    this.dispatchEvent(event);
    if (typeof this['on' + name] === 'function') {
      this['on' + name](event);
    }
  };

  RTCPeerConnection.prototype._emitGatheringStateChange = function() {
    var event = new Event('icegatheringstatechange');
    this._dispatchEvent('icegatheringstatechange', event);
  };

  RTCPeerConnection.prototype.getConfiguration = function() {
    return this._config;
  };

  RTCPeerConnection.prototype.getLocalStreams = function() {
    return this.localStreams;
  };

  RTCPeerConnection.prototype.getRemoteStreams = function() {
    return this.remoteStreams;
  };

  // internal helper to create a transceiver object.
  // (which is not yet the same as the WebRTC 1.0 transceiver)
  RTCPeerConnection.prototype._createTransceiver = function(kind, doNotAdd) {
    var hasBundleTransport = this.transceivers.length > 0;
    var transceiver = {
      track: null,
      iceGatherer: null,
      iceTransport: null,
      dtlsTransport: null,
      localCapabilities: null,
      remoteCapabilities: null,
      rtpSender: null,
      rtpReceiver: null,
      kind: kind,
      mid: null,
      sendEncodingParameters: null,
      recvEncodingParameters: null,
      stream: null,
      associatedRemoteMediaStreams: [],
      wantReceive: true
    };
    if (this.usingBundle && hasBundleTransport) {
      transceiver.iceTransport = this.transceivers[0].iceTransport;
      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;
    } else {
      var transports = this._createIceAndDtlsTransports();
      transceiver.iceTransport = transports.iceTransport;
      transceiver.dtlsTransport = transports.dtlsTransport;
    }
    if (!doNotAdd) {
      this.transceivers.push(transceiver);
    }
    return transceiver;
  };

  RTCPeerConnection.prototype.addTrack = function(track, stream) {
    if (this._isClosed) {
      throw makeError('InvalidStateError',
          'Attempted to call addTrack on a closed peerconnection.');
    }

    var alreadyExists = this.transceivers.find(function(s) {
      return s.track === track;
    });

    if (alreadyExists) {
      throw makeError('InvalidAccessError', 'Track already exists.');
    }

    var transceiver;
    for (var i = 0; i < this.transceivers.length; i++) {
      if (!this.transceivers[i].track &&
          this.transceivers[i].kind === track.kind) {
        transceiver = this.transceivers[i];
      }
    }
    if (!transceiver) {
      transceiver = this._createTransceiver(track.kind);
    }

    this._maybeFireNegotiationNeeded();

    if (this.localStreams.indexOf(stream) === -1) {
      this.localStreams.push(stream);
    }

    transceiver.track = track;
    transceiver.stream = stream;
    transceiver.rtpSender = new window.RTCRtpSender(track,
        transceiver.dtlsTransport);
    return transceiver.rtpSender;
  };

  RTCPeerConnection.prototype.addStream = function(stream) {
    var pc = this;
    if (edgeVersion >= 15025) {
      stream.getTracks().forEach(function(track) {
        pc.addTrack(track, stream);
      });
    } else {
      // Clone is necessary for local demos mostly, attaching directly
      // to two different senders does not work (build 10547).
      // Fixed in 15025 (or earlier)
      var clonedStream = stream.clone();
      stream.getTracks().forEach(function(track, idx) {
        var clonedTrack = clonedStream.getTracks()[idx];
        track.addEventListener('enabled', function(event) {
          clonedTrack.enabled = event.enabled;
        });
      });
      clonedStream.getTracks().forEach(function(track) {
        pc.addTrack(track, clonedStream);
      });
    }
  };

  RTCPeerConnection.prototype.removeTrack = function(sender) {
    if (this._isClosed) {
      throw makeError('InvalidStateError',
          'Attempted to call removeTrack on a closed peerconnection.');
    }

    if (!(sender instanceof window.RTCRtpSender)) {
      throw new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +
          'does not implement interface RTCRtpSender.');
    }

    var transceiver = this.transceivers.find(function(t) {
      return t.rtpSender === sender;
    });

    if (!transceiver) {
      throw makeError('InvalidAccessError',
          'Sender was not created by this connection.');
    }
    var stream = transceiver.stream;

    transceiver.rtpSender.stop();
    transceiver.rtpSender = null;
    transceiver.track = null;
    transceiver.stream = null;

    // remove the stream from the set of local streams
    var localStreams = this.transceivers.map(function(t) {
      return t.stream;
    });
    if (localStreams.indexOf(stream) === -1 &&
        this.localStreams.indexOf(stream) > -1) {
      this.localStreams.splice(this.localStreams.indexOf(stream), 1);
    }

    this._maybeFireNegotiationNeeded();
  };

  RTCPeerConnection.prototype.removeStream = function(stream) {
    var pc = this;
    stream.getTracks().forEach(function(track) {
      var sender = pc.getSenders().find(function(s) {
        return s.track === track;
      });
      if (sender) {
        pc.removeTrack(sender);
      }
    });
  };

  RTCPeerConnection.prototype.getSenders = function() {
    return this.transceivers.filter(function(transceiver) {
      return !!transceiver.rtpSender;
    })
    .map(function(transceiver) {
      return transceiver.rtpSender;
    });
  };

  RTCPeerConnection.prototype.getReceivers = function() {
    return this.transceivers.filter(function(transceiver) {
      return !!transceiver.rtpReceiver;
    })
    .map(function(transceiver) {
      return transceiver.rtpReceiver;
    });
  };


  RTCPeerConnection.prototype._createIceGatherer = function(sdpMLineIndex,
      usingBundle) {
    var pc = this;
    if (usingBundle && sdpMLineIndex > 0) {
      return this.transceivers[0].iceGatherer;
    } else if (this._iceGatherers.length) {
      return this._iceGatherers.shift();
    }
    var iceGatherer = new window.RTCIceGatherer({
      iceServers: this._config.iceServers,
      gatherPolicy: this._config.iceTransportPolicy
    });
    Object.defineProperty(iceGatherer, 'state',
        {value: 'new', writable: true}
    );

    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = [];
    this.transceivers[sdpMLineIndex].bufferCandidates = function(event) {
      var end = !event.candidate || Object.keys(event.candidate).length === 0;
      // polyfill since RTCIceGatherer.state is not implemented in
      // Edge 10547 yet.
      iceGatherer.state = end ? 'completed' : 'gathering';
      if (pc.transceivers[sdpMLineIndex].bufferedCandidateEvents !== null) {
        pc.transceivers[sdpMLineIndex].bufferedCandidateEvents.push(event);
      }
    };
    iceGatherer.addEventListener('localcandidate',
      this.transceivers[sdpMLineIndex].bufferCandidates);
    return iceGatherer;
  };

  // start gathering from an RTCIceGatherer.
  RTCPeerConnection.prototype._gather = function(mid, sdpMLineIndex) {
    var pc = this;
    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;
    if (iceGatherer.onlocalcandidate) {
      return;
    }
    var bufferedCandidateEvents =
      this.transceivers[sdpMLineIndex].bufferedCandidateEvents;
    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = null;
    iceGatherer.removeEventListener('localcandidate',
      this.transceivers[sdpMLineIndex].bufferCandidates);
    iceGatherer.onlocalcandidate = function(evt) {
      if (pc.usingBundle && sdpMLineIndex > 0) {
        // if we know that we use bundle we can drop candidates with
        // dpMLineIndex > 0. If we don't do this then our state gets
        // confused since we dispose the extra ice gatherer.
        return;
      }
      var event = new Event('icecandidate');
      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};

      var cand = evt.candidate;
      // Edge emits an empty object for RTCIceCandidateComplete
      var end = !cand || Object.keys(cand).length === 0;
      if (end) {
        // polyfill since RTCIceGatherer.state is not implemented in
        // Edge 10547 yet.
        if (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {
          iceGatherer.state = 'completed';
        }
      } else {
        if (iceGatherer.state === 'new') {
          iceGatherer.state = 'gathering';
        }
        // RTCIceCandidate doesn't have a component, needs to be added
        cand.component = 1;
        // also the usernameFragment. TODO: update SDP to take both variants.
        cand.ufrag = iceGatherer.getLocalParameters().usernameFragment;

        var serializedCandidate = SDPUtils.writeCandidate(cand);
        event.candidate = Object.assign(event.candidate,
            SDPUtils.parseCandidate(serializedCandidate));

        event.candidate.candidate = serializedCandidate;
        event.candidate.toJSON = function() {
          return {
            candidate: event.candidate.candidate,
            sdpMid: event.candidate.sdpMid,
            sdpMLineIndex: event.candidate.sdpMLineIndex,
            usernameFragment: event.candidate.usernameFragment
          };
        };
      }

      // update local description.
      var sections = SDPUtils.getMediaSections(pc._localDescription.sdp);
      if (!end) {
        sections[event.candidate.sdpMLineIndex] +=
            'a=' + event.candidate.candidate + '\r\n';
      } else {
        sections[event.candidate.sdpMLineIndex] +=
            'a=end-of-candidates\r\n';
      }
      pc._localDescription.sdp =
          SDPUtils.getDescription(pc._localDescription.sdp) +
          sections.join('');
      var complete = pc.transceivers.every(function(transceiver) {
        return transceiver.iceGatherer &&
            transceiver.iceGatherer.state === 'completed';
      });

      if (pc.iceGatheringState !== 'gathering') {
        pc.iceGatheringState = 'gathering';
        pc._emitGatheringStateChange();
      }

      // Emit candidate. Also emit null candidate when all gatherers are
      // complete.
      if (!end) {
        pc._dispatchEvent('icecandidate', event);
      }
      if (complete) {
        pc._dispatchEvent('icecandidate', new Event('icecandidate'));
        pc.iceGatheringState = 'complete';
        pc._emitGatheringStateChange();
      }
    };

    // emit already gathered candidates.
    window.setTimeout(function() {
      bufferedCandidateEvents.forEach(function(e) {
        iceGatherer.onlocalcandidate(e);
      });
    }, 0);
  };

  // Create ICE transport and DTLS transport.
  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {
    var pc = this;
    var iceTransport = new window.RTCIceTransport(null);
    iceTransport.onicestatechange = function() {
      pc._updateIceConnectionState();
      pc._updateConnectionState();
    };

    var dtlsTransport = new window.RTCDtlsTransport(iceTransport);
    dtlsTransport.ondtlsstatechange = function() {
      pc._updateConnectionState();
    };
    dtlsTransport.onerror = function() {
      // onerror does not set state to failed by itself.
      Object.defineProperty(dtlsTransport, 'state',
          {value: 'failed', writable: true});
      pc._updateConnectionState();
    };

    return {
      iceTransport: iceTransport,
      dtlsTransport: dtlsTransport
    };
  };

  // Destroy ICE gatherer, ICE transport and DTLS transport.
  // Without triggering the callbacks.
  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(
      sdpMLineIndex) {
    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;
    if (iceGatherer) {
      delete iceGatherer.onlocalcandidate;
      delete this.transceivers[sdpMLineIndex].iceGatherer;
    }
    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;
    if (iceTransport) {
      delete iceTransport.onicestatechange;
      delete this.transceivers[sdpMLineIndex].iceTransport;
    }
    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;
    if (dtlsTransport) {
      delete dtlsTransport.ondtlsstatechange;
      delete dtlsTransport.onerror;
      delete this.transceivers[sdpMLineIndex].dtlsTransport;
    }
  };

  // Start the RTP Sender and Receiver for a transceiver.
  RTCPeerConnection.prototype._transceive = function(transceiver,
      send, recv) {
    var params = getCommonCapabilities(transceiver.localCapabilities,
        transceiver.remoteCapabilities);
    if (send && transceiver.rtpSender) {
      params.encodings = transceiver.sendEncodingParameters;
      params.rtcp = {
        cname: SDPUtils.localCName,
        compound: transceiver.rtcpParameters.compound
      };
      if (transceiver.recvEncodingParameters.length) {
        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;
      }
      transceiver.rtpSender.send(params);
    }
    if (recv && transceiver.rtpReceiver && params.codecs.length > 0) {
      // remove RTX field in Edge 14942
      if (transceiver.kind === 'video'
          && transceiver.recvEncodingParameters
          && edgeVersion < 15019) {
        transceiver.recvEncodingParameters.forEach(function(p) {
          delete p.rtx;
        });
      }
      if (transceiver.recvEncodingParameters.length) {
        params.encodings = transceiver.recvEncodingParameters;
      } else {
        params.encodings = [{}];
      }
      params.rtcp = {
        compound: transceiver.rtcpParameters.compound
      };
      if (transceiver.rtcpParameters.cname) {
        params.rtcp.cname = transceiver.rtcpParameters.cname;
      }
      if (transceiver.sendEncodingParameters.length) {
        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;
      }
      transceiver.rtpReceiver.receive(params);
    }
  };

  RTCPeerConnection.prototype.setLocalDescription = function(description) {
    var pc = this;

    // Note: pranswer is not supported.
    if (['offer', 'answer'].indexOf(description.type) === -1) {
      return Promise.reject(makeError('TypeError',
          'Unsupported type "' + description.type + '"'));
    }

    if (!isActionAllowedInSignalingState('setLocalDescription',
        description.type, pc.signalingState) || pc._isClosed) {
      return Promise.reject(makeError('InvalidStateError',
          'Can not set local ' + description.type +
          ' in state ' + pc.signalingState));
    }

    var sections;
    var sessionpart;
    if (description.type === 'offer') {
      // VERY limited support for SDP munging. Limited to:
      // * changing the order of codecs
      sections = SDPUtils.splitSections(description.sdp);
      sessionpart = sections.shift();
      sections.forEach(function(mediaSection, sdpMLineIndex) {
        var caps = SDPUtils.parseRtpParameters(mediaSection);
        pc.transceivers[sdpMLineIndex].localCapabilities = caps;
      });

      pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {
        pc._gather(transceiver.mid, sdpMLineIndex);
      });
    } else if (description.type === 'answer') {
      sections = SDPUtils.splitSections(pc._remoteDescription.sdp);
      sessionpart = sections.shift();
      var isIceLite = SDPUtils.matchPrefix(sessionpart,
          'a=ice-lite').length > 0;
      sections.forEach(function(mediaSection, sdpMLineIndex) {
        var transceiver = pc.transceivers[sdpMLineIndex];
        var iceGatherer = transceiver.iceGatherer;
        var iceTransport = transceiver.iceTransport;
        var dtlsTransport = transceiver.dtlsTransport;
        var localCapabilities = transceiver.localCapabilities;
        var remoteCapabilities = transceiver.remoteCapabilities;

        // treat bundle-only as not-rejected.
        var rejected = SDPUtils.isRejected(mediaSection) &&
            SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;

        if (!rejected && !transceiver.rejected) {
          var remoteIceParameters = SDPUtils.getIceParameters(
              mediaSection, sessionpart);
          var remoteDtlsParameters = SDPUtils.getDtlsParameters(
              mediaSection, sessionpart);
          if (isIceLite) {
            remoteDtlsParameters.role = 'server';
          }

          if (!pc.usingBundle || sdpMLineIndex === 0) {
            pc._gather(transceiver.mid, sdpMLineIndex);
            if (iceTransport.state === 'new') {
              iceTransport.start(iceGatherer, remoteIceParameters,
                  isIceLite ? 'controlling' : 'controlled');
            }
            if (dtlsTransport.state === 'new') {
              dtlsTransport.start(remoteDtlsParameters);
            }
          }

          // Calculate intersection of capabilities.
          var params = getCommonCapabilities(localCapabilities,
              remoteCapabilities);

          // Start the RTCRtpSender. The RTCRtpReceiver for this
          // transceiver has already been started in setRemoteDescription.
          pc._transceive(transceiver,
              params.codecs.length > 0,
              false);
        }
      });
    }

    pc._localDescription = {
      type: description.type,
      sdp: description.sdp
    };
    if (description.type === 'offer') {
      pc._updateSignalingState('have-local-offer');
    } else {
      pc._updateSignalingState('stable');
    }

    return Promise.resolve();
  };

  RTCPeerConnection.prototype.setRemoteDescription = function(description) {
    var pc = this;

    // Note: pranswer is not supported.
    if (['offer', 'answer'].indexOf(description.type) === -1) {
      return Promise.reject(makeError('TypeError',
          'Unsupported type "' + description.type + '"'));
    }

    if (!isActionAllowedInSignalingState('setRemoteDescription',
        description.type, pc.signalingState) || pc._isClosed) {
      return Promise.reject(makeError('InvalidStateError',
          'Can not set remote ' + description.type +
          ' in state ' + pc.signalingState));
    }

    var streams = {};
    pc.remoteStreams.forEach(function(stream) {
      streams[stream.id] = stream;
    });
    var receiverList = [];
    var sections = SDPUtils.splitSections(description.sdp);
    var sessionpart = sections.shift();
    var isIceLite = SDPUtils.matchPrefix(sessionpart,
        'a=ice-lite').length > 0;
    var usingBundle = SDPUtils.matchPrefix(sessionpart,
        'a=group:BUNDLE ').length > 0;
    pc.usingBundle = usingBundle;
    var iceOptions = SDPUtils.matchPrefix(sessionpart,
        'a=ice-options:')[0];
    if (iceOptions) {
      pc.canTrickleIceCandidates = iceOptions.substr(14).split(' ')
          .indexOf('trickle') >= 0;
    } else {
      pc.canTrickleIceCandidates = false;
    }

    sections.forEach(function(mediaSection, sdpMLineIndex) {
      var lines = SDPUtils.splitLines(mediaSection);
      var kind = SDPUtils.getKind(mediaSection);
      // treat bundle-only as not-rejected.
      var rejected = SDPUtils.isRejected(mediaSection) &&
          SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;
      var protocol = lines[0].substr(2).split(' ')[2];

      var direction = SDPUtils.getDirection(mediaSection, sessionpart);
      var remoteMsid = SDPUtils.parseMsid(mediaSection);

      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();

      // Reject datachannels which are not implemented yet.
      if (rejected || (kind === 'application' && (protocol === 'DTLS/SCTP' ||
          protocol === 'UDP/DTLS/SCTP'))) {
        // TODO: this is dangerous in the case where a non-rejected m-line
        //     becomes rejected.
        pc.transceivers[sdpMLineIndex] = {
          mid: mid,
          kind: kind,
          protocol: protocol,
          rejected: true
        };
        return;
      }

      if (!rejected && pc.transceivers[sdpMLineIndex] &&
          pc.transceivers[sdpMLineIndex].rejected) {
        // recycle a rejected transceiver.
        pc.transceivers[sdpMLineIndex] = pc._createTransceiver(kind, true);
      }

      var transceiver;
      var iceGatherer;
      var iceTransport;
      var dtlsTransport;
      var rtpReceiver;
      var sendEncodingParameters;
      var recvEncodingParameters;
      var localCapabilities;

      var track;
      // FIXME: ensure the mediaSection has rtcp-mux set.
      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);
      var remoteIceParameters;
      var remoteDtlsParameters;
      if (!rejected) {
        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,
            sessionpart);
        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,
            sessionpart);
        remoteDtlsParameters.role = 'client';
      }
      recvEncodingParameters =
          SDPUtils.parseRtpEncodingParameters(mediaSection);

      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);

      var isComplete = SDPUtils.matchPrefix(mediaSection,
          'a=end-of-candidates', sessionpart).length > 0;
      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')
          .map(function(cand) {
            return SDPUtils.parseCandidate(cand);
          })
          .filter(function(cand) {
            return cand.component === 1;
          });

      // Check if we can use BUNDLE and dispose transports.
      if ((description.type === 'offer' || description.type === 'answer') &&
          !rejected && usingBundle && sdpMLineIndex > 0 &&
          pc.transceivers[sdpMLineIndex]) {
        pc._disposeIceAndDtlsTransports(sdpMLineIndex);
        pc.transceivers[sdpMLineIndex].iceGatherer =
            pc.transceivers[0].iceGatherer;
        pc.transceivers[sdpMLineIndex].iceTransport =
            pc.transceivers[0].iceTransport;
        pc.transceivers[sdpMLineIndex].dtlsTransport =
            pc.transceivers[0].dtlsTransport;
        if (pc.transceivers[sdpMLineIndex].rtpSender) {
          pc.transceivers[sdpMLineIndex].rtpSender.setTransport(
              pc.transceivers[0].dtlsTransport);
        }
        if (pc.transceivers[sdpMLineIndex].rtpReceiver) {
          pc.transceivers[sdpMLineIndex].rtpReceiver.setTransport(
              pc.transceivers[0].dtlsTransport);
        }
      }
      if (description.type === 'offer' && !rejected) {
        transceiver = pc.transceivers[sdpMLineIndex] ||
            pc._createTransceiver(kind);
        transceiver.mid = mid;

        if (!transceiver.iceGatherer) {
          transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,
              usingBundle);
        }

        if (cands.length && transceiver.iceTransport.state === 'new') {
          if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {
            transceiver.iceTransport.setRemoteCandidates(cands);
          } else {
            cands.forEach(function(candidate) {
              maybeAddCandidate(transceiver.iceTransport, candidate);
            });
          }
        }

        localCapabilities = window.RTCRtpReceiver.getCapabilities(kind);

        // filter RTX until additional stuff needed for RTX is implemented
        // in adapter.js
        if (edgeVersion < 15019) {
          localCapabilities.codecs = localCapabilities.codecs.filter(
              function(codec) {
                return codec.name !== 'rtx';
              });
        }

        sendEncodingParameters = transceiver.sendEncodingParameters || [{
          ssrc: (2 * sdpMLineIndex + 2) * 1001
        }];

        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams
        var isNewTrack = false;
        if (direction === 'sendrecv' || direction === 'sendonly') {
          isNewTrack = !transceiver.rtpReceiver;
          rtpReceiver = transceiver.rtpReceiver ||
              new window.RTCRtpReceiver(transceiver.dtlsTransport, kind);

          if (isNewTrack) {
            var stream;
            track = rtpReceiver.track;
            // FIXME: does not work with Plan B.
            if (remoteMsid && remoteMsid.stream === '-') {
              // no-op. a stream id of '-' means: no associated stream.
            } else if (remoteMsid) {
              if (!streams[remoteMsid.stream]) {
                streams[remoteMsid.stream] = new window.MediaStream();
                Object.defineProperty(streams[remoteMsid.stream], 'id', {
                  get: function() {
                    return remoteMsid.stream;
                  }
                });
              }
              Object.defineProperty(track, 'id', {
                get: function() {
                  return remoteMsid.track;
                }
              });
              stream = streams[remoteMsid.stream];
            } else {
              if (!streams.default) {
                streams.default = new window.MediaStream();
              }
              stream = streams.default;
            }
            if (stream) {
              addTrackToStreamAndFireEvent(track, stream);
              transceiver.associatedRemoteMediaStreams.push(stream);
            }
            receiverList.push([track, rtpReceiver, stream]);
          }
        } else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {
          transceiver.associatedRemoteMediaStreams.forEach(function(s) {
            var nativeTrack = s.getTracks().find(function(t) {
              return t.id === transceiver.rtpReceiver.track.id;
            });
            if (nativeTrack) {
              removeTrackFromStreamAndFireEvent(nativeTrack, s);
            }
          });
          transceiver.associatedRemoteMediaStreams = [];
        }

        transceiver.localCapabilities = localCapabilities;
        transceiver.remoteCapabilities = remoteCapabilities;
        transceiver.rtpReceiver = rtpReceiver;
        transceiver.rtcpParameters = rtcpParameters;
        transceiver.sendEncodingParameters = sendEncodingParameters;
        transceiver.recvEncodingParameters = recvEncodingParameters;

        // Start the RTCRtpReceiver now. The RTPSender is started in
        // setLocalDescription.
        pc._transceive(pc.transceivers[sdpMLineIndex],
            false,
            isNewTrack);
      } else if (description.type === 'answer' && !rejected) {
        transceiver = pc.transceivers[sdpMLineIndex];
        iceGatherer = transceiver.iceGatherer;
        iceTransport = transceiver.iceTransport;
        dtlsTransport = transceiver.dtlsTransport;
        rtpReceiver = transceiver.rtpReceiver;
        sendEncodingParameters = transceiver.sendEncodingParameters;
        localCapabilities = transceiver.localCapabilities;

        pc.transceivers[sdpMLineIndex].recvEncodingParameters =
            recvEncodingParameters;
        pc.transceivers[sdpMLineIndex].remoteCapabilities =
            remoteCapabilities;
        pc.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;

        if (cands.length && iceTransport.state === 'new') {
          if ((isIceLite || isComplete) &&
              (!usingBundle || sdpMLineIndex === 0)) {
            iceTransport.setRemoteCandidates(cands);
          } else {
            cands.forEach(function(candidate) {
              maybeAddCandidate(transceiver.iceTransport, candidate);
            });
          }
        }

        if (!usingBundle || sdpMLineIndex === 0) {
          if (iceTransport.state === 'new') {
            iceTransport.start(iceGatherer, remoteIceParameters,
                'controlling');
          }
          if (dtlsTransport.state === 'new') {
            dtlsTransport.start(remoteDtlsParameters);
          }
        }

        // If the offer contained RTX but the answer did not,
        // remove RTX from sendEncodingParameters.
        var commonCapabilities = getCommonCapabilities(
          transceiver.localCapabilities,
          transceiver.remoteCapabilities);

        var hasRtx = commonCapabilities.codecs.filter(function(c) {
          return c.name.toLowerCase() === 'rtx';
        }).length;
        if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {
          delete transceiver.sendEncodingParameters[0].rtx;
        }

        pc._transceive(transceiver,
            direction === 'sendrecv' || direction === 'recvonly',
            direction === 'sendrecv' || direction === 'sendonly');

        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams
        if (rtpReceiver &&
            (direction === 'sendrecv' || direction === 'sendonly')) {
          track = rtpReceiver.track;
          if (remoteMsid) {
            if (!streams[remoteMsid.stream]) {
              streams[remoteMsid.stream] = new window.MediaStream();
            }
            addTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);
            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);
          } else {
            if (!streams.default) {
              streams.default = new window.MediaStream();
            }
            addTrackToStreamAndFireEvent(track, streams.default);
            receiverList.push([track, rtpReceiver, streams.default]);
          }
        } else {
          // FIXME: actually the receiver should be created later.
          delete transceiver.rtpReceiver;
        }
      }
    });

    if (pc._dtlsRole === undefined) {
      pc._dtlsRole = description.type === 'offer' ? 'active' : 'passive';
    }

    pc._remoteDescription = {
      type: description.type,
      sdp: description.sdp
    };
    if (description.type === 'offer') {
      pc._updateSignalingState('have-remote-offer');
    } else {
      pc._updateSignalingState('stable');
    }
    Object.keys(streams).forEach(function(sid) {
      var stream = streams[sid];
      if (stream.getTracks().length) {
        if (pc.remoteStreams.indexOf(stream) === -1) {
          pc.remoteStreams.push(stream);
          var event = new Event('addstream');
          event.stream = stream;
          window.setTimeout(function() {
            pc._dispatchEvent('addstream', event);
          });
        }

        receiverList.forEach(function(item) {
          var track = item[0];
          var receiver = item[1];
          if (stream.id !== item[2].id) {
            return;
          }
          fireAddTrack(pc, track, receiver, [stream]);
        });
      }
    });
    receiverList.forEach(function(item) {
      if (item[2]) {
        return;
      }
      fireAddTrack(pc, item[0], item[1], []);
    });

    // check whether addIceCandidate({}) was called within four seconds after
    // setRemoteDescription.
    window.setTimeout(function() {
      if (!(pc && pc.transceivers)) {
        return;
      }
      pc.transceivers.forEach(function(transceiver) {
        if (transceiver.iceTransport &&
            transceiver.iceTransport.state === 'new' &&
            transceiver.iceTransport.getRemoteCandidates().length > 0) {
          console.warn('Timeout for addRemoteCandidate. Consider sending ' +
              'an end-of-candidates notification');
          transceiver.iceTransport.addRemoteCandidate({});
        }
      });
    }, 4000);

    return Promise.resolve();
  };

  RTCPeerConnection.prototype.close = function() {
    this.transceivers.forEach(function(transceiver) {
      /* not yet
      if (transceiver.iceGatherer) {
        transceiver.iceGatherer.close();
      }
      */
      if (transceiver.iceTransport) {
        transceiver.iceTransport.stop();
      }
      if (transceiver.dtlsTransport) {
        transceiver.dtlsTransport.stop();
      }
      if (transceiver.rtpSender) {
        transceiver.rtpSender.stop();
      }
      if (transceiver.rtpReceiver) {
        transceiver.rtpReceiver.stop();
      }
    });
    // FIXME: clean up tracks, local streams, remote streams, etc
    this._isClosed = true;
    this._updateSignalingState('closed');
  };

  // Update the signaling state.
  RTCPeerConnection.prototype._updateSignalingState = function(newState) {
    this.signalingState = newState;
    var event = new Event('signalingstatechange');
    this._dispatchEvent('signalingstatechange', event);
  };

  // Determine whether to fire the negotiationneeded event.
  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {
    var pc = this;
    if (this.signalingState !== 'stable' || this.needNegotiation === true) {
      return;
    }
    this.needNegotiation = true;
    window.setTimeout(function() {
      if (pc.needNegotiation) {
        pc.needNegotiation = false;
        var event = new Event('negotiationneeded');
        pc._dispatchEvent('negotiationneeded', event);
      }
    }, 0);
  };

  // Update the ice connection state.
  RTCPeerConnection.prototype._updateIceConnectionState = function() {
    var newState;
    var states = {
      'new': 0,
      closed: 0,
      checking: 0,
      connected: 0,
      completed: 0,
      disconnected: 0,
      failed: 0
    };
    this.transceivers.forEach(function(transceiver) {
      if (transceiver.iceTransport && !transceiver.rejected) {
        states[transceiver.iceTransport.state]++;
      }
    });

    newState = 'new';
    if (states.failed > 0) {
      newState = 'failed';
    } else if (states.checking > 0) {
      newState = 'checking';
    } else if (states.disconnected > 0) {
      newState = 'disconnected';
    } else if (states.new > 0) {
      newState = 'new';
    } else if (states.connected > 0) {
      newState = 'connected';
    } else if (states.completed > 0) {
      newState = 'completed';
    }

    if (newState !== this.iceConnectionState) {
      this.iceConnectionState = newState;
      var event = new Event('iceconnectionstatechange');
      this._dispatchEvent('iceconnectionstatechange', event);
    }
  };

  // Update the connection state.
  RTCPeerConnection.prototype._updateConnectionState = function() {
    var newState;
    var states = {
      'new': 0,
      closed: 0,
      connecting: 0,
      connected: 0,
      completed: 0,
      disconnected: 0,
      failed: 0
    };
    this.transceivers.forEach(function(transceiver) {
      if (transceiver.iceTransport && transceiver.dtlsTransport &&
          !transceiver.rejected) {
        states[transceiver.iceTransport.state]++;
        states[transceiver.dtlsTransport.state]++;
      }
    });
    // ICETransport.completed and connected are the same for this purpose.
    states.connected += states.completed;

    newState = 'new';
    if (states.failed > 0) {
      newState = 'failed';
    } else if (states.connecting > 0) {
      newState = 'connecting';
    } else if (states.disconnected > 0) {
      newState = 'disconnected';
    } else if (states.new > 0) {
      newState = 'new';
    } else if (states.connected > 0) {
      newState = 'connected';
    }

    if (newState !== this.connectionState) {
      this.connectionState = newState;
      var event = new Event('connectionstatechange');
      this._dispatchEvent('connectionstatechange', event);
    }
  };

  RTCPeerConnection.prototype.createOffer = function() {
    var pc = this;

    if (pc._isClosed) {
      return Promise.reject(makeError('InvalidStateError',
          'Can not call createOffer after close'));
    }

    var numAudioTracks = pc.transceivers.filter(function(t) {
      return t.kind === 'audio';
    }).length;
    var numVideoTracks = pc.transceivers.filter(function(t) {
      return t.kind === 'video';
    }).length;

    // Determine number of audio and video tracks we need to send/recv.
    var offerOptions = arguments[0];
    if (offerOptions) {
      // Reject Chrome legacy constraints.
      if (offerOptions.mandatory || offerOptions.optional) {
        throw new TypeError(
            'Legacy mandatory/optional constraints not supported.');
      }
      if (offerOptions.offerToReceiveAudio !== undefined) {
        if (offerOptions.offerToReceiveAudio === true) {
          numAudioTracks = 1;
        } else if (offerOptions.offerToReceiveAudio === false) {
          numAudioTracks = 0;
        } else {
          numAudioTracks = offerOptions.offerToReceiveAudio;
        }
      }
      if (offerOptions.offerToReceiveVideo !== undefined) {
        if (offerOptions.offerToReceiveVideo === true) {
          numVideoTracks = 1;
        } else if (offerOptions.offerToReceiveVideo === false) {
          numVideoTracks = 0;
        } else {
          numVideoTracks = offerOptions.offerToReceiveVideo;
        }
      }
    }

    pc.transceivers.forEach(function(transceiver) {
      if (transceiver.kind === 'audio') {
        numAudioTracks--;
        if (numAudioTracks < 0) {
          transceiver.wantReceive = false;
        }
      } else if (transceiver.kind === 'video') {
        numVideoTracks--;
        if (numVideoTracks < 0) {
          transceiver.wantReceive = false;
        }
      }
    });

    // Create M-lines for recvonly streams.
    while (numAudioTracks > 0 || numVideoTracks > 0) {
      if (numAudioTracks > 0) {
        pc._createTransceiver('audio');
        numAudioTracks--;
      }
      if (numVideoTracks > 0) {
        pc._createTransceiver('video');
        numVideoTracks--;
      }
    }

    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,
        pc._sdpSessionVersion++);
    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {
      // For each track, create an ice gatherer, ice transport,
      // dtls transport, potentially rtpsender and rtpreceiver.
      var track = transceiver.track;
      var kind = transceiver.kind;
      var mid = transceiver.mid || SDPUtils.generateIdentifier();
      transceiver.mid = mid;

      if (!transceiver.iceGatherer) {
        transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,
            pc.usingBundle);
      }

      var localCapabilities = window.RTCRtpSender.getCapabilities(kind);
      // filter RTX until additional stuff needed for RTX is implemented
      // in adapter.js
      if (edgeVersion < 15019) {
        localCapabilities.codecs = localCapabilities.codecs.filter(
            function(codec) {
              return codec.name !== 'rtx';
            });
      }
      localCapabilities.codecs.forEach(function(codec) {
        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552
        // by adding level-asymmetry-allowed=1
        if (codec.name === 'H264' &&
            codec.parameters['level-asymmetry-allowed'] === undefined) {
          codec.parameters['level-asymmetry-allowed'] = '1';
        }

        // for subsequent offers, we might have to re-use the payload
        // type of the last offer.
        if (transceiver.remoteCapabilities &&
            transceiver.remoteCapabilities.codecs) {
          transceiver.remoteCapabilities.codecs.forEach(function(remoteCodec) {
            if (codec.name.toLowerCase() === remoteCodec.name.toLowerCase() &&
                codec.clockRate === remoteCodec.clockRate) {
              codec.preferredPayloadType = remoteCodec.payloadType;
            }
          });
        }
      });
      localCapabilities.headerExtensions.forEach(function(hdrExt) {
        var remoteExtensions = transceiver.remoteCapabilities &&
            transceiver.remoteCapabilities.headerExtensions || [];
        remoteExtensions.forEach(function(rHdrExt) {
          if (hdrExt.uri === rHdrExt.uri) {
            hdrExt.id = rHdrExt.id;
          }
        });
      });

      // generate an ssrc now, to be used later in rtpSender.send
      var sendEncodingParameters = transceiver.sendEncodingParameters || [{
        ssrc: (2 * sdpMLineIndex + 1) * 1001
      }];
      if (track) {
        // add RTX
        if (edgeVersion >= 15019 && kind === 'video' &&
            !sendEncodingParameters[0].rtx) {
          sendEncodingParameters[0].rtx = {
            ssrc: sendEncodingParameters[0].ssrc + 1
          };
        }
      }

      if (transceiver.wantReceive) {
        transceiver.rtpReceiver = new window.RTCRtpReceiver(
            transceiver.dtlsTransport, kind);
      }

      transceiver.localCapabilities = localCapabilities;
      transceiver.sendEncodingParameters = sendEncodingParameters;
    });

    // always offer BUNDLE and dispose on return if not supported.
    if (pc._config.bundlePolicy !== 'max-compat') {
      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {
        return t.mid;
      }).join(' ') + '\r\n';
    }
    sdp += 'a=ice-options:trickle\r\n';

    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {
      sdp += writeMediaSection(transceiver, transceiver.localCapabilities,
          'offer', transceiver.stream, pc._dtlsRole);
      sdp += 'a=rtcp-rsize\r\n';

      if (transceiver.iceGatherer && pc.iceGatheringState !== 'new' &&
          (sdpMLineIndex === 0 || !pc.usingBundle)) {
        transceiver.iceGatherer.getLocalCandidates().forEach(function(cand) {
          cand.component = 1;
          sdp += 'a=' + SDPUtils.writeCandidate(cand) + '\r\n';
        });

        if (transceiver.iceGatherer.state === 'completed') {
          sdp += 'a=end-of-candidates\r\n';
        }
      }
    });

    var desc = new window.RTCSessionDescription({
      type: 'offer',
      sdp: sdp
    });
    return Promise.resolve(desc);
  };

  RTCPeerConnection.prototype.createAnswer = function() {
    var pc = this;

    if (pc._isClosed) {
      return Promise.reject(makeError('InvalidStateError',
          'Can not call createAnswer after close'));
    }

    if (!(pc.signalingState === 'have-remote-offer' ||
        pc.signalingState === 'have-local-pranswer')) {
      return Promise.reject(makeError('InvalidStateError',
          'Can not call createAnswer in signalingState ' + pc.signalingState));
    }

    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,
        pc._sdpSessionVersion++);
    if (pc.usingBundle) {
      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {
        return t.mid;
      }).join(' ') + '\r\n';
    }
    sdp += 'a=ice-options:trickle\r\n';

    var mediaSectionsInOffer = SDPUtils.getMediaSections(
        pc._remoteDescription.sdp).length;
    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {
      if (sdpMLineIndex + 1 > mediaSectionsInOffer) {
        return;
      }
      if (transceiver.rejected) {
        if (transceiver.kind === 'application') {
          if (transceiver.protocol === 'DTLS/SCTP') { // legacy fmt
            sdp += 'm=application 0 DTLS/SCTP 5000\r\n';
          } else {
            sdp += 'm=application 0 ' + transceiver.protocol +
                ' webrtc-datachannel\r\n';
          }
        } else if (transceiver.kind === 'audio') {
          sdp += 'm=audio 0 UDP/TLS/RTP/SAVPF 0\r\n' +
              'a=rtpmap:0 PCMU/8000\r\n';
        } else if (transceiver.kind === 'video') {
          sdp += 'm=video 0 UDP/TLS/RTP/SAVPF 120\r\n' +
              'a=rtpmap:120 VP8/90000\r\n';
        }
        sdp += 'c=IN IP4 0.0.0.0\r\n' +
            'a=inactive\r\n' +
            'a=mid:' + transceiver.mid + '\r\n';
        return;
      }

      // FIXME: look at direction.
      if (transceiver.stream) {
        var localTrack;
        if (transceiver.kind === 'audio') {
          localTrack = transceiver.stream.getAudioTracks()[0];
        } else if (transceiver.kind === 'video') {
          localTrack = transceiver.stream.getVideoTracks()[0];
        }
        if (localTrack) {
          // add RTX
          if (edgeVersion >= 15019 && transceiver.kind === 'video' &&
              !transceiver.sendEncodingParameters[0].rtx) {
            transceiver.sendEncodingParameters[0].rtx = {
              ssrc: transceiver.sendEncodingParameters[0].ssrc + 1
            };
          }
        }
      }

      // Calculate intersection of capabilities.
      var commonCapabilities = getCommonCapabilities(
          transceiver.localCapabilities,
          transceiver.remoteCapabilities);

      var hasRtx = commonCapabilities.codecs.filter(function(c) {
        return c.name.toLowerCase() === 'rtx';
      }).length;
      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {
        delete transceiver.sendEncodingParameters[0].rtx;
      }

      sdp += writeMediaSection(transceiver, commonCapabilities,
          'answer', transceiver.stream, pc._dtlsRole);
      if (transceiver.rtcpParameters &&
          transceiver.rtcpParameters.reducedSize) {
        sdp += 'a=rtcp-rsize\r\n';
      }
    });

    var desc = new window.RTCSessionDescription({
      type: 'answer',
      sdp: sdp
    });
    return Promise.resolve(desc);
  };

  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {
    var pc = this;
    var sections;
    if (candidate && !(candidate.sdpMLineIndex !== undefined ||
        candidate.sdpMid)) {
      return Promise.reject(new TypeError('sdpMLineIndex or sdpMid required'));
    }

    // TODO: needs to go into ops queue.
    return new Promise(function(resolve, reject) {
      if (!pc._remoteDescription) {
        return reject(makeError('InvalidStateError',
            'Can not add ICE candidate without a remote description'));
      } else if (!candidate || candidate.candidate === '') {
        for (var j = 0; j < pc.transceivers.length; j++) {
          if (pc.transceivers[j].rejected) {
            continue;
          }
          pc.transceivers[j].iceTransport.addRemoteCandidate({});
          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);
          sections[j] += 'a=end-of-candidates\r\n';
          pc._remoteDescription.sdp =
              SDPUtils.getDescription(pc._remoteDescription.sdp) +
              sections.join('');
          if (pc.usingBundle) {
            break;
          }
        }
      } else {
        var sdpMLineIndex = candidate.sdpMLineIndex;
        if (candidate.sdpMid) {
          for (var i = 0; i < pc.transceivers.length; i++) {
            if (pc.transceivers[i].mid === candidate.sdpMid) {
              sdpMLineIndex = i;
              break;
            }
          }
        }
        var transceiver = pc.transceivers[sdpMLineIndex];
        if (transceiver) {
          if (transceiver.rejected) {
            return resolve();
          }
          var cand = Object.keys(candidate.candidate).length > 0 ?
              SDPUtils.parseCandidate(candidate.candidate) : {};
          // Ignore Chrome's invalid candidates since Edge does not like them.
          if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {
            return resolve();
          }
          // Ignore RTCP candidates, we assume RTCP-MUX.
          if (cand.component && cand.component !== 1) {
            return resolve();
          }
          // when using bundle, avoid adding candidates to the wrong
          // ice transport. And avoid adding candidates added in the SDP.
          if (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&
              transceiver.iceTransport !== pc.transceivers[0].iceTransport)) {
            if (!maybeAddCandidate(transceiver.iceTransport, cand)) {
              return reject(makeError('OperationError',
                  'Can not add ICE candidate'));
            }
          }

          // update the remoteDescription.
          var candidateString = candidate.candidate.trim();
          if (candidateString.indexOf('a=') === 0) {
            candidateString = candidateString.substr(2);
          }
          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);
          sections[sdpMLineIndex] += 'a=' +
              (cand.type ? candidateString : 'end-of-candidates')
              + '\r\n';
          pc._remoteDescription.sdp =
              SDPUtils.getDescription(pc._remoteDescription.sdp) +
              sections.join('');
        } else {
          return reject(makeError('OperationError',
              'Can not add ICE candidate'));
        }
      }
      resolve();
    });
  };

  RTCPeerConnection.prototype.getStats = function(selector) {
    if (selector && selector instanceof window.MediaStreamTrack) {
      var senderOrReceiver = null;
      this.transceivers.forEach(function(transceiver) {
        if (transceiver.rtpSender &&
            transceiver.rtpSender.track === selector) {
          senderOrReceiver = transceiver.rtpSender;
        } else if (transceiver.rtpReceiver &&
            transceiver.rtpReceiver.track === selector) {
          senderOrReceiver = transceiver.rtpReceiver;
        }
      });
      if (!senderOrReceiver) {
        throw makeError('InvalidAccessError', 'Invalid selector.');
      }
      return senderOrReceiver.getStats();
    }

    var promises = [];
    this.transceivers.forEach(function(transceiver) {
      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',
          'dtlsTransport'].forEach(function(method) {
            if (transceiver[method]) {
              promises.push(transceiver[method].getStats());
            }
          });
    });
    return Promise.all(promises).then(function(allStats) {
      var results = new Map();
      allStats.forEach(function(stats) {
        stats.forEach(function(stat) {
          results.set(stat.id, stat);
        });
      });
      return results;
    });
  };

  // fix low-level stat names and return Map instead of object.
  var ortcObjects = ['RTCRtpSender', 'RTCRtpReceiver', 'RTCIceGatherer',
    'RTCIceTransport', 'RTCDtlsTransport'];
  ortcObjects.forEach(function(ortcObjectName) {
    var obj = window[ortcObjectName];
    if (obj && obj.prototype && obj.prototype.getStats) {
      var nativeGetstats = obj.prototype.getStats;
      obj.prototype.getStats = function() {
        return nativeGetstats.apply(this)
        .then(function(nativeStats) {
          var mapStats = new Map();
          Object.keys(nativeStats).forEach(function(id) {
            nativeStats[id].type = fixStatsType(nativeStats[id]);
            mapStats.set(id, nativeStats[id]);
          });
          return mapStats;
        });
      };
    }
  });

  // legacy callback shims. Should be moved to adapter.js some days.
  var methods = ['createOffer', 'createAnswer'];
  methods.forEach(function(method) {
    var nativeMethod = RTCPeerConnection.prototype[method];
    RTCPeerConnection.prototype[method] = function() {
      var args = arguments;
      if (typeof args[0] === 'function' ||
          typeof args[1] === 'function') { // legacy
        return nativeMethod.apply(this, [arguments[2]])
        .then(function(description) {
          if (typeof args[0] === 'function') {
            args[0].apply(null, [description]);
          }
        }, function(error) {
          if (typeof args[1] === 'function') {
            args[1].apply(null, [error]);
          }
        });
      }
      return nativeMethod.apply(this, arguments);
    };
  });

  methods = ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'];
  methods.forEach(function(method) {
    var nativeMethod = RTCPeerConnection.prototype[method];
    RTCPeerConnection.prototype[method] = function() {
      var args = arguments;
      if (typeof args[1] === 'function' ||
          typeof args[2] === 'function') { // legacy
        return nativeMethod.apply(this, arguments)
        .then(function() {
          if (typeof args[1] === 'function') {
            args[1].apply(null);
          }
        }, function(error) {
          if (typeof args[2] === 'function') {
            args[2].apply(null, [error]);
          }
        });
      }
      return nativeMethod.apply(this, arguments);
    };
  });

  // getStats is special. It doesn't have a spec legacy method yet we support
  // getStats(something, cb) without error callbacks.
  ['getStats'].forEach(function(method) {
    var nativeMethod = RTCPeerConnection.prototype[method];
    RTCPeerConnection.prototype[method] = function() {
      var args = arguments;
      if (typeof args[1] === 'function') {
        return nativeMethod.apply(this, arguments)
        .then(function() {
          if (typeof args[1] === 'function') {
            args[1].apply(null);
          }
        });
      }
      return nativeMethod.apply(this, arguments);
    };
  });

  return RTCPeerConnection;
};

},{"sdp":118}],118:[function(require,module,exports){
/* eslint-env node */
'use strict';

// SDP helpers.
var SDPUtils = {};

// Generate an alphanumeric identifier for cname or mids.
// TODO: use UUIDs instead? https://gist.github.com/jed/982883
SDPUtils.generateIdentifier = function() {
  return Math.random().toString(36).substr(2, 10);
};

// The RTCP CNAME used by all peerconnections from the same JS.
SDPUtils.localCName = SDPUtils.generateIdentifier();

// Splits SDP into lines, dealing with both CRLF and LF.
SDPUtils.splitLines = function(blob) {
  return blob.trim().split('\n').map(function(line) {
    return line.trim();
  });
};
// Splits SDP into sessionpart and mediasections. Ensures CRLF.
SDPUtils.splitSections = function(blob) {
  var parts = blob.split('\nm=');
  return parts.map(function(part, index) {
    return (index > 0 ? 'm=' + part : part).trim() + '\r\n';
  });
};

// returns the session description.
SDPUtils.getDescription = function(blob) {
  var sections = SDPUtils.splitSections(blob);
  return sections && sections[0];
};

// returns the individual media sections.
SDPUtils.getMediaSections = function(blob) {
  var sections = SDPUtils.splitSections(blob);
  sections.shift();
  return sections;
};

// Returns lines that start with a certain prefix.
SDPUtils.matchPrefix = function(blob, prefix) {
  return SDPUtils.splitLines(blob).filter(function(line) {
    return line.indexOf(prefix) === 0;
  });
};

// Parses an ICE candidate line. Sample input:
// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8
// rport 55996"
SDPUtils.parseCandidate = function(line) {
  var parts;
  // Parse both variants.
  if (line.indexOf('a=candidate:') === 0) {
    parts = line.substring(12).split(' ');
  } else {
    parts = line.substring(10).split(' ');
  }

  var candidate = {
    foundation: parts[0],
    component: parseInt(parts[1], 10),
    protocol: parts[2].toLowerCase(),
    priority: parseInt(parts[3], 10),
    ip: parts[4],
    address: parts[4], // address is an alias for ip.
    port: parseInt(parts[5], 10),
    // skip parts[6] == 'typ'
    type: parts[7]
  };

  for (var i = 8; i < parts.length; i += 2) {
    switch (parts[i]) {
      case 'raddr':
        candidate.relatedAddress = parts[i + 1];
        break;
      case 'rport':
        candidate.relatedPort = parseInt(parts[i + 1], 10);
        break;
      case 'tcptype':
        candidate.tcpType = parts[i + 1];
        break;
      case 'ufrag':
        candidate.ufrag = parts[i + 1]; // for backward compability.
        candidate.usernameFragment = parts[i + 1];
        break;
      default: // extension handling, in particular ufrag
        candidate[parts[i]] = parts[i + 1];
        break;
    }
  }
  return candidate;
};

// Translates a candidate object into SDP candidate attribute.
SDPUtils.writeCandidate = function(candidate) {
  var sdp = [];
  sdp.push(candidate.foundation);
  sdp.push(candidate.component);
  sdp.push(candidate.protocol.toUpperCase());
  sdp.push(candidate.priority);
  sdp.push(candidate.address || candidate.ip);
  sdp.push(candidate.port);

  var type = candidate.type;
  sdp.push('typ');
  sdp.push(type);
  if (type !== 'host' && candidate.relatedAddress &&
      candidate.relatedPort) {
    sdp.push('raddr');
    sdp.push(candidate.relatedAddress);
    sdp.push('rport');
    sdp.push(candidate.relatedPort);
  }
  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {
    sdp.push('tcptype');
    sdp.push(candidate.tcpType);
  }
  if (candidate.usernameFragment || candidate.ufrag) {
    sdp.push('ufrag');
    sdp.push(candidate.usernameFragment || candidate.ufrag);
  }
  return 'candidate:' + sdp.join(' ');
};

// Parses an ice-options line, returns an array of option tags.
// a=ice-options:foo bar
SDPUtils.parseIceOptions = function(line) {
  return line.substr(14).split(' ');
};

// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:
// a=rtpmap:111 opus/48000/2
SDPUtils.parseRtpMap = function(line) {
  var parts = line.substr(9).split(' ');
  var parsed = {
    payloadType: parseInt(parts.shift(), 10) // was: id
  };

  parts = parts[0].split('/');

  parsed.name = parts[0];
  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate
  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;
  // legacy alias, got renamed back to channels in ORTC.
  parsed.numChannels = parsed.channels;
  return parsed;
};

// Generate an a=rtpmap line from RTCRtpCodecCapability or
// RTCRtpCodecParameters.
SDPUtils.writeRtpMap = function(codec) {
  var pt = codec.payloadType;
  if (codec.preferredPayloadType !== undefined) {
    pt = codec.preferredPayloadType;
  }
  var channels = codec.channels || codec.numChannels || 1;
  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +
      (channels !== 1 ? '/' + channels : '') + '\r\n';
};

// Parses an a=extmap line (headerextension from RFC 5285). Sample input:
// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset
// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset
SDPUtils.parseExtmap = function(line) {
  var parts = line.substr(9).split(' ');
  return {
    id: parseInt(parts[0], 10),
    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',
    uri: parts[1]
  };
};

// Generates a=extmap line from RTCRtpHeaderExtensionParameters or
// RTCRtpHeaderExtension.
SDPUtils.writeExtmap = function(headerExtension) {
  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +
      (headerExtension.direction && headerExtension.direction !== 'sendrecv'
        ? '/' + headerExtension.direction
        : '') +
      ' ' + headerExtension.uri + '\r\n';
};

// Parses an ftmp line, returns dictionary. Sample input:
// a=fmtp:96 vbr=on;cng=on
// Also deals with vbr=on; cng=on
SDPUtils.parseFmtp = function(line) {
  var parsed = {};
  var kv;
  var parts = line.substr(line.indexOf(' ') + 1).split(';');
  for (var j = 0; j < parts.length; j++) {
    kv = parts[j].trim().split('=');
    parsed[kv[0].trim()] = kv[1];
  }
  return parsed;
};

// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.
SDPUtils.writeFmtp = function(codec) {
  var line = '';
  var pt = codec.payloadType;
  if (codec.preferredPayloadType !== undefined) {
    pt = codec.preferredPayloadType;
  }
  if (codec.parameters && Object.keys(codec.parameters).length) {
    var params = [];
    Object.keys(codec.parameters).forEach(function(param) {
      if (codec.parameters[param]) {
        params.push(param + '=' + codec.parameters[param]);
      } else {
        params.push(param);
      }
    });
    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\r\n';
  }
  return line;
};

// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:
// a=rtcp-fb:98 nack rpsi
SDPUtils.parseRtcpFb = function(line) {
  var parts = line.substr(line.indexOf(' ') + 1).split(' ');
  return {
    type: parts.shift(),
    parameter: parts.join(' ')
  };
};
// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.
SDPUtils.writeRtcpFb = function(codec) {
  var lines = '';
  var pt = codec.payloadType;
  if (codec.preferredPayloadType !== undefined) {
    pt = codec.preferredPayloadType;
  }
  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {
    // FIXME: special handling for trr-int?
    codec.rtcpFeedback.forEach(function(fb) {
      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +
      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +
          '\r\n';
    });
  }
  return lines;
};

// Parses an RFC 5576 ssrc media attribute. Sample input:
// a=ssrc:3735928559 cname:something
SDPUtils.parseSsrcMedia = function(line) {
  var sp = line.indexOf(' ');
  var parts = {
    ssrc: parseInt(line.substr(7, sp - 7), 10)
  };
  var colon = line.indexOf(':', sp);
  if (colon > -1) {
    parts.attribute = line.substr(sp + 1, colon - sp - 1);
    parts.value = line.substr(colon + 1);
  } else {
    parts.attribute = line.substr(sp + 1);
  }
  return parts;
};

SDPUtils.parseSsrcGroup = function(line) {
  var parts = line.substr(13).split(' ');
  return {
    semantics: parts.shift(),
    ssrcs: parts.map(function(ssrc) {
      return parseInt(ssrc, 10);
    })
  };
};

// Extracts the MID (RFC 5888) from a media section.
// returns the MID or undefined if no mid line was found.
SDPUtils.getMid = function(mediaSection) {
  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];
  if (mid) {
    return mid.substr(6);
  }
};

SDPUtils.parseFingerprint = function(line) {
  var parts = line.substr(14).split(' ');
  return {
    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.
    value: parts[1]
  };
};

// Extracts DTLS parameters from SDP media section or sessionpart.
// FIXME: for consistency with other functions this should only
//   get the fingerprint line as input. See also getIceParameters.
SDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {
  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,
    'a=fingerprint:');
  // Note: a=setup line is ignored since we use the 'auto' role.
  // Note2: 'algorithm' is not case sensitive except in Edge.
  return {
    role: 'auto',
    fingerprints: lines.map(SDPUtils.parseFingerprint)
  };
};

// Serializes DTLS parameters to SDP.
SDPUtils.writeDtlsParameters = function(params, setupType) {
  var sdp = 'a=setup:' + setupType + '\r\n';
  params.fingerprints.forEach(function(fp) {
    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\r\n';
  });
  return sdp;
};

// Parses a=crypto lines into
//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members
SDPUtils.parseCryptoLine = function(line) {
  var parts = line.substr(9).split(' ');
  return {
    tag: parseInt(parts[0], 10),
    cryptoSuite: parts[1],
    keyParams: parts[2],
    sessionParams: parts.slice(3),
  };
};

SDPUtils.writeCryptoLine = function(parameters) {
  return 'a=crypto:' + parameters.tag + ' ' +
    parameters.cryptoSuite + ' ' +
    (typeof parameters.keyParams === 'object'
      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)
      : parameters.keyParams) +
    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +
    '\r\n';
};

// Parses the crypto key parameters into
//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*
SDPUtils.parseCryptoKeyParams = function(keyParams) {
  if (keyParams.indexOf('inline:') !== 0) {
    return null;
  }
  var parts = keyParams.substr(7).split('|');
  return {
    keyMethod: 'inline',
    keySalt: parts[0],
    lifeTime: parts[1],
    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,
    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,
  };
};

SDPUtils.writeCryptoKeyParams = function(keyParams) {
  return keyParams.keyMethod + ':'
    + keyParams.keySalt +
    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +
    (keyParams.mkiValue && keyParams.mkiLength
      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength
      : '');
};

// Extracts all SDES paramters.
SDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {
  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,
    'a=crypto:');
  return lines.map(SDPUtils.parseCryptoLine);
};

// Parses ICE information from SDP media section or sessionpart.
// FIXME: for consistency with other functions this should only
//   get the ice-ufrag and ice-pwd lines as input.
SDPUtils.getIceParameters = function(mediaSection, sessionpart) {
  var ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,
    'a=ice-ufrag:')[0];
  var pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,
    'a=ice-pwd:')[0];
  if (!(ufrag && pwd)) {
    return null;
  }
  return {
    usernameFragment: ufrag.substr(12),
    password: pwd.substr(10),
  };
};

// Serializes ICE parameters to SDP.
SDPUtils.writeIceParameters = function(params) {
  return 'a=ice-ufrag:' + params.usernameFragment + '\r\n' +
      'a=ice-pwd:' + params.password + '\r\n';
};

// Parses the SDP media section and returns RTCRtpParameters.
SDPUtils.parseRtpParameters = function(mediaSection) {
  var description = {
    codecs: [],
    headerExtensions: [],
    fecMechanisms: [],
    rtcp: []
  };
  var lines = SDPUtils.splitLines(mediaSection);
  var mline = lines[0].split(' ');
  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]
    var pt = mline[i];
    var rtpmapline = SDPUtils.matchPrefix(
      mediaSection, 'a=rtpmap:' + pt + ' ')[0];
    if (rtpmapline) {
      var codec = SDPUtils.parseRtpMap(rtpmapline);
      var fmtps = SDPUtils.matchPrefix(
        mediaSection, 'a=fmtp:' + pt + ' ');
      // Only the first a=fmtp:<pt> is considered.
      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};
      codec.rtcpFeedback = SDPUtils.matchPrefix(
        mediaSection, 'a=rtcp-fb:' + pt + ' ')
        .map(SDPUtils.parseRtcpFb);
      description.codecs.push(codec);
      // parse FEC mechanisms from rtpmap lines.
      switch (codec.name.toUpperCase()) {
        case 'RED':
        case 'ULPFEC':
          description.fecMechanisms.push(codec.name.toUpperCase());
          break;
        default: // only RED and ULPFEC are recognized as FEC mechanisms.
          break;
      }
    }
  }
  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {
    description.headerExtensions.push(SDPUtils.parseExtmap(line));
  });
  // FIXME: parse rtcp.
  return description;
};

// Generates parts of the SDP media section describing the capabilities /
// parameters.
SDPUtils.writeRtpDescription = function(kind, caps) {
  var sdp = '';

  // Build the mline.
  sdp += 'm=' + kind + ' ';
  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.
  sdp += ' UDP/TLS/RTP/SAVPF ';
  sdp += caps.codecs.map(function(codec) {
    if (codec.preferredPayloadType !== undefined) {
      return codec.preferredPayloadType;
    }
    return codec.payloadType;
  }).join(' ') + '\r\n';

  sdp += 'c=IN IP4 0.0.0.0\r\n';
  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\r\n';

  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.
  caps.codecs.forEach(function(codec) {
    sdp += SDPUtils.writeRtpMap(codec);
    sdp += SDPUtils.writeFmtp(codec);
    sdp += SDPUtils.writeRtcpFb(codec);
  });
  var maxptime = 0;
  caps.codecs.forEach(function(codec) {
    if (codec.maxptime > maxptime) {
      maxptime = codec.maxptime;
    }
  });
  if (maxptime > 0) {
    sdp += 'a=maxptime:' + maxptime + '\r\n';
  }
  sdp += 'a=rtcp-mux\r\n';

  if (caps.headerExtensions) {
    caps.headerExtensions.forEach(function(extension) {
      sdp += SDPUtils.writeExtmap(extension);
    });
  }
  // FIXME: write fecMechanisms.
  return sdp;
};

// Parses the SDP media section and returns an array of
// RTCRtpEncodingParameters.
SDPUtils.parseRtpEncodingParameters = function(mediaSection) {
  var encodingParameters = [];
  var description = SDPUtils.parseRtpParameters(mediaSection);
  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;
  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;

  // filter a=ssrc:... cname:, ignore PlanB-msid
  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')
    .map(function(line) {
      return SDPUtils.parseSsrcMedia(line);
    })
    .filter(function(parts) {
      return parts.attribute === 'cname';
    });
  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;
  var secondarySsrc;

  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')
    .map(function(line) {
      var parts = line.substr(17).split(' ');
      return parts.map(function(part) {
        return parseInt(part, 10);
      });
    });
  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {
    secondarySsrc = flows[0][1];
  }

  description.codecs.forEach(function(codec) {
    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {
      var encParam = {
        ssrc: primarySsrc,
        codecPayloadType: parseInt(codec.parameters.apt, 10)
      };
      if (primarySsrc && secondarySsrc) {
        encParam.rtx = {ssrc: secondarySsrc};
      }
      encodingParameters.push(encParam);
      if (hasRed) {
        encParam = JSON.parse(JSON.stringify(encParam));
        encParam.fec = {
          ssrc: primarySsrc,
          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'
        };
        encodingParameters.push(encParam);
      }
    }
  });
  if (encodingParameters.length === 0 && primarySsrc) {
    encodingParameters.push({
      ssrc: primarySsrc
    });
  }

  // we support both b=AS and b=TIAS but interpret AS as TIAS.
  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');
  if (bandwidth.length) {
    if (bandwidth[0].indexOf('b=TIAS:') === 0) {
      bandwidth = parseInt(bandwidth[0].substr(7), 10);
    } else if (bandwidth[0].indexOf('b=AS:') === 0) {
      // use formula from JSEP to convert b=AS to TIAS value.
      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95
          - (50 * 40 * 8);
    } else {
      bandwidth = undefined;
    }
    encodingParameters.forEach(function(params) {
      params.maxBitrate = bandwidth;
    });
  }
  return encodingParameters;
};

// parses http://draft.ortc.org/#rtcrtcpparameters*
SDPUtils.parseRtcpParameters = function(mediaSection) {
  var rtcpParameters = {};

  // Gets the first SSRC. Note tha with RTX there might be multiple
  // SSRCs.
  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')
    .map(function(line) {
      return SDPUtils.parseSsrcMedia(line);
    })
    .filter(function(obj) {
      return obj.attribute === 'cname';
    })[0];
  if (remoteSsrc) {
    rtcpParameters.cname = remoteSsrc.value;
    rtcpParameters.ssrc = remoteSsrc.ssrc;
  }

  // Edge uses the compound attribute instead of reducedSize
  // compound is !reducedSize
  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');
  rtcpParameters.reducedSize = rsize.length > 0;
  rtcpParameters.compound = rsize.length === 0;

  // parses the rtcp-mux attrbute.
  // Note that Edge does not support unmuxed RTCP.
  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');
  rtcpParameters.mux = mux.length > 0;

  return rtcpParameters;
};

// parses either a=msid: or a=ssrc:... msid lines and returns
// the id of the MediaStream and MediaStreamTrack.
SDPUtils.parseMsid = function(mediaSection) {
  var parts;
  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');
  if (spec.length === 1) {
    parts = spec[0].substr(7).split(' ');
    return {stream: parts[0], track: parts[1]};
  }
  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')
    .map(function(line) {
      return SDPUtils.parseSsrcMedia(line);
    })
    .filter(function(msidParts) {
      return msidParts.attribute === 'msid';
    });
  if (planB.length > 0) {
    parts = planB[0].value.split(' ');
    return {stream: parts[0], track: parts[1]};
  }
};

// SCTP
// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back
// to draft-ietf-mmusic-sctp-sdp-05
SDPUtils.parseSctpDescription = function(mediaSection) {
  var mline = SDPUtils.parseMLine(mediaSection);
  var maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');
  var maxMessageSize;
  if (maxSizeLine.length > 0) {
    maxMessageSize = parseInt(maxSizeLine[0].substr(19), 10);
  }
  if (isNaN(maxMessageSize)) {
    maxMessageSize = 65536;
  }
  var sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');
  if (sctpPort.length > 0) {
    return {
      port: parseInt(sctpPort[0].substr(12), 10),
      protocol: mline.fmt,
      maxMessageSize: maxMessageSize
    };
  }
  var sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');
  if (sctpMapLines.length > 0) {
    var parts = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:')[0]
      .substr(10)
      .split(' ');
    return {
      port: parseInt(parts[0], 10),
      protocol: parts[1],
      maxMessageSize: maxMessageSize
    };
  }
};

// SCTP
// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers
// support by now receiving in this format, unless we originally parsed
// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line
// protocol of DTLS/SCTP -- without UDP/ or TCP/)
SDPUtils.writeSctpDescription = function(media, sctp) {
  var output = [];
  if (media.protocol !== 'DTLS/SCTP') {
    output = [
      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\r\n',
      'c=IN IP4 0.0.0.0\r\n',
      'a=sctp-port:' + sctp.port + '\r\n'
    ];
  } else {
    output = [
      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\r\n',
      'c=IN IP4 0.0.0.0\r\n',
      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\r\n'
    ];
  }
  if (sctp.maxMessageSize !== undefined) {
    output.push('a=max-message-size:' + sctp.maxMessageSize + '\r\n');
  }
  return output.join('');
};

// Generate a session ID for SDP.
// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1
// recommends using a cryptographically random +ve 64-bit value
// but right now this should be acceptable and within the right range
SDPUtils.generateSessionId = function() {
  return Math.random().toString().substr(2, 21);
};

// Write boilder plate for start of SDP
// sessId argument is optional - if not supplied it will
// be generated randomly
// sessVersion is optional and defaults to 2
// sessUser is optional and defaults to 'thisisadapterortc'
SDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {
  var sessionId;
  var version = sessVer !== undefined ? sessVer : 2;
  if (sessId) {
    sessionId = sessId;
  } else {
    sessionId = SDPUtils.generateSessionId();
  }
  var user = sessUser || 'thisisadapterortc';
  // FIXME: sess-id should be an NTP timestamp.
  return 'v=0\r\n' +
      'o=' + user + ' ' + sessionId + ' ' + version +
        ' IN IP4 127.0.0.1\r\n' +
      's=-\r\n' +
      't=0 0\r\n';
};

SDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {
  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);

  // Map ICE parameters (ufrag, pwd) to SDP.
  sdp += SDPUtils.writeIceParameters(
    transceiver.iceGatherer.getLocalParameters());

  // Map DTLS parameters to SDP.
  sdp += SDPUtils.writeDtlsParameters(
    transceiver.dtlsTransport.getLocalParameters(),
    type === 'offer' ? 'actpass' : 'active');

  sdp += 'a=mid:' + transceiver.mid + '\r\n';

  if (transceiver.direction) {
    sdp += 'a=' + transceiver.direction + '\r\n';
  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {
    sdp += 'a=sendrecv\r\n';
  } else if (transceiver.rtpSender) {
    sdp += 'a=sendonly\r\n';
  } else if (transceiver.rtpReceiver) {
    sdp += 'a=recvonly\r\n';
  } else {
    sdp += 'a=inactive\r\n';
  }

  if (transceiver.rtpSender) {
    // spec.
    var msid = 'msid:' + stream.id + ' ' +
        transceiver.rtpSender.track.id + '\r\n';
    sdp += 'a=' + msid;

    // for Chrome.
    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +
        ' ' + msid;
    if (transceiver.sendEncodingParameters[0].rtx) {
      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +
          ' ' + msid;
      sdp += 'a=ssrc-group:FID ' +
          transceiver.sendEncodingParameters[0].ssrc + ' ' +
          transceiver.sendEncodingParameters[0].rtx.ssrc +
          '\r\n';
    }
  }
  // FIXME: this should be written by writeRtpDescription.
  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +
      ' cname:' + SDPUtils.localCName + '\r\n';
  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {
    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +
        ' cname:' + SDPUtils.localCName + '\r\n';
  }
  return sdp;
};

// Gets the direction from the mediaSection or the sessionpart.
SDPUtils.getDirection = function(mediaSection, sessionpart) {
  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.
  var lines = SDPUtils.splitLines(mediaSection);
  for (var i = 0; i < lines.length; i++) {
    switch (lines[i]) {
      case 'a=sendrecv':
      case 'a=sendonly':
      case 'a=recvonly':
      case 'a=inactive':
        return lines[i].substr(2);
      default:
        // FIXME: What should happen here?
    }
  }
  if (sessionpart) {
    return SDPUtils.getDirection(sessionpart);
  }
  return 'sendrecv';
};

SDPUtils.getKind = function(mediaSection) {
  var lines = SDPUtils.splitLines(mediaSection);
  var mline = lines[0].split(' ');
  return mline[0].substr(2);
};

SDPUtils.isRejected = function(mediaSection) {
  return mediaSection.split(' ', 2)[1] === '0';
};

SDPUtils.parseMLine = function(mediaSection) {
  var lines = SDPUtils.splitLines(mediaSection);
  var parts = lines[0].substr(2).split(' ');
  return {
    kind: parts[0],
    port: parseInt(parts[1], 10),
    protocol: parts[2],
    fmt: parts.slice(3).join(' ')
  };
};

SDPUtils.parseOLine = function(mediaSection) {
  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];
  var parts = line.substr(2).split(' ');
  return {
    username: parts[0],
    sessionId: parts[1],
    sessionVersion: parseInt(parts[2], 10),
    netType: parts[3],
    addressType: parts[4],
    address: parts[5]
  };
};

// a very naive interpretation of a valid SDP.
SDPUtils.isValidSDP = function(blob) {
  if (typeof blob !== 'string' || blob.length === 0) {
    return false;
  }
  var lines = SDPUtils.splitLines(blob);
  for (var i = 0; i < lines.length; i++) {
    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {
      return false;
    }
    // TODO: check the modifier a bit more.
  }
  return true;
};

// Expose public methods.
if (typeof module === 'object') {
  module.exports = SDPUtils;
}

},{}],119:[function(require,module,exports){
/**
 * Convert array of 16 byte values to UUID string format of the form:
 * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
 */
var byteToHex = [];
for (var i = 0; i < 256; ++i) {
  byteToHex[i] = (i + 0x100).toString(16).substr(1);
}

function bytesToUuid(buf, offset) {
  var i = offset || 0;
  var bth = byteToHex;
  // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4
  return ([
    bth[buf[i++]], bth[buf[i++]],
    bth[buf[i++]], bth[buf[i++]], '-',
    bth[buf[i++]], bth[buf[i++]], '-',
    bth[buf[i++]], bth[buf[i++]], '-',
    bth[buf[i++]], bth[buf[i++]], '-',
    bth[buf[i++]], bth[buf[i++]],
    bth[buf[i++]], bth[buf[i++]],
    bth[buf[i++]], bth[buf[i++]]
  ]).join('');
}

module.exports = bytesToUuid;

},{}],120:[function(require,module,exports){
// Unique ID creation requires a high quality random # generator.  In the
// browser this is a little complicated due to unknown quality of Math.random()
// and inconsistent support for the `crypto` API.  We do the best we can via
// feature-detection

// getRandomValues needs to be invoked in a context where "this" is a Crypto
// implementation. Also, find the complete implementation of crypto on IE11.
var getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto)) ||
                      (typeof(msCrypto) != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto));

if (getRandomValues) {
  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto
  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef

  module.exports = function whatwgRNG() {
    getRandomValues(rnds8);
    return rnds8;
  };
} else {
  // Math.random()-based (RNG)
  //
  // If all else fails, use Math.random().  It's fast, but is of unspecified
  // quality.
  var rnds = new Array(16);

  module.exports = function mathRNG() {
    for (var i = 0, r; i < 16; i++) {
      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;
      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;
    }

    return rnds;
  };
}

},{}],121:[function(require,module,exports){
var rng = require('./lib/rng');
var bytesToUuid = require('./lib/bytesToUuid');

function v4(options, buf, offset) {
  var i = buf && offset || 0;

  if (typeof(options) == 'string') {
    buf = options === 'binary' ? new Array(16) : null;
    options = null;
  }
  options = options || {};

  var rnds = options.random || (options.rng || rng)();

  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`
  rnds[6] = (rnds[6] & 0x0f) | 0x40;
  rnds[8] = (rnds[8] & 0x3f) | 0x80;

  // Copy bytes to buffer, if provided
  if (buf) {
    for (var ii = 0; ii < 16; ++ii) {
      buf[i + ii] = rnds[ii];
    }
  }

  return buf || bytesToUuid(rnds);
}

module.exports = v4;

},{"./lib/bytesToUuid":119,"./lib/rng":120}],122:[function(require,module,exports){
(function (global){(function (){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */

'use strict';

var adapterFactory = require('./adapter_factory.js');
module.exports = adapterFactory({window: global.window});

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./adapter_factory.js":123}],123:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */

'use strict';

var utils = require('./utils');
// Shimming starts here.
module.exports = function(dependencies, opts) {
  var window = dependencies && dependencies.window;

  var options = {
    shimChrome: true,
    shimFirefox: true,
    shimEdge: true,
    shimSafari: true,
  };

  for (var key in opts) {
    if (hasOwnProperty.call(opts, key)) {
      options[key] = opts[key];
    }
  }

  // Utils.
  var logging = utils.log;
  var browserDetails = utils.detectBrowser(window);

  // Uncomment the line below if you want logging to occur, including logging
  // for the switch statement below. Can also be turned on in the browser via
  // adapter.disableLog(false), but then logging from the switch statement below
  // will not appear.
  // require('./utils').disableLog(false);

  // Browser shims.
  var chromeShim = require('./chrome/chrome_shim') || null;
  var edgeShim = require('./edge/edge_shim') || null;
  var firefoxShim = require('./firefox/firefox_shim') || null;
  var safariShim = require('./safari/safari_shim') || null;
  var commonShim = require('./common_shim') || null;

  // Export to the adapter global object visible in the browser.
  var adapter = {
    browserDetails: browserDetails,
    commonShim: commonShim,
    extractVersion: utils.extractVersion,
    disableLog: utils.disableLog,
    disableWarnings: utils.disableWarnings
  };

  // Shim browser if found.
  switch (browserDetails.browser) {
    case 'chrome':
      if (!chromeShim || !chromeShim.shimPeerConnection ||
          !options.shimChrome) {
        logging('Chrome shim is not included in this adapter release.');
        return adapter;
      }
      logging('adapter.js shimming chrome.');
      // Export to the adapter global object visible in the browser.
      adapter.browserShim = chromeShim;
      commonShim.shimCreateObjectURL(window);

      chromeShim.shimGetUserMedia(window);
      chromeShim.shimMediaStream(window);
      chromeShim.shimSourceObject(window);
      chromeShim.shimPeerConnection(window);
      chromeShim.shimOnTrack(window);
      chromeShim.shimAddTrackRemoveTrack(window);
      chromeShim.shimGetSendersWithDtmf(window);
      chromeShim.shimSenderReceiverGetStats(window);
      chromeShim.fixNegotiationNeeded(window);

      commonShim.shimRTCIceCandidate(window);
      commonShim.shimMaxMessageSize(window);
      commonShim.shimSendThrowTypeError(window);
      break;
    case 'firefox':
      if (!firefoxShim || !firefoxShim.shimPeerConnection ||
          !options.shimFirefox) {
        logging('Firefox shim is not included in this adapter release.');
        return adapter;
      }
      logging('adapter.js shimming firefox.');
      // Export to the adapter global object visible in the browser.
      adapter.browserShim = firefoxShim;
      commonShim.shimCreateObjectURL(window);

      firefoxShim.shimGetUserMedia(window);
      firefoxShim.shimSourceObject(window);
      firefoxShim.shimPeerConnection(window);
      firefoxShim.shimOnTrack(window);
      firefoxShim.shimRemoveStream(window);
      firefoxShim.shimSenderGetStats(window);
      firefoxShim.shimReceiverGetStats(window);
      firefoxShim.shimRTCDataChannel(window);

      commonShim.shimRTCIceCandidate(window);
      commonShim.shimMaxMessageSize(window);
      commonShim.shimSendThrowTypeError(window);
      break;
    case 'edge':
      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {
        logging('MS edge shim is not included in this adapter release.');
        return adapter;
      }
      logging('adapter.js shimming edge.');
      // Export to the adapter global object visible in the browser.
      adapter.browserShim = edgeShim;
      commonShim.shimCreateObjectURL(window);

      edgeShim.shimGetUserMedia(window);
      edgeShim.shimPeerConnection(window);
      edgeShim.shimReplaceTrack(window);
      edgeShim.shimGetDisplayMedia(window);

      // the edge shim implements the full RTCIceCandidate object.

      commonShim.shimMaxMessageSize(window);
      commonShim.shimSendThrowTypeError(window);
      break;
    case 'safari':
      if (!safariShim || !options.shimSafari) {
        logging('Safari shim is not included in this adapter release.');
        return adapter;
      }
      logging('adapter.js shimming safari.');
      // Export to the adapter global object visible in the browser.
      adapter.browserShim = safariShim;
      commonShim.shimCreateObjectURL(window);

      safariShim.shimRTCIceServerUrls(window);
      safariShim.shimCreateOfferLegacy(window);
      safariShim.shimCallbacksAPI(window);
      safariShim.shimLocalStreamsAPI(window);
      safariShim.shimRemoteStreamsAPI(window);
      safariShim.shimTrackEventTransceiver(window);
      safariShim.shimGetUserMedia(window);

      commonShim.shimRTCIceCandidate(window);
      commonShim.shimMaxMessageSize(window);
      commonShim.shimSendThrowTypeError(window);
      break;
    default:
      logging('Unsupported browser!');
      break;
  }

  return adapter;
};

},{"./chrome/chrome_shim":124,"./common_shim":126,"./edge/edge_shim":127,"./firefox/firefox_shim":130,"./safari/safari_shim":132,"./utils":133}],124:[function(require,module,exports){

/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';
var utils = require('../utils.js');
var logging = utils.log;

/* iterates the stats graph recursively. */
function walkStats(stats, base, resultSet) {
  if (!base || resultSet.has(base.id)) {
    return;
  }
  resultSet.set(base.id, base);
  Object.keys(base).forEach(function(name) {
    if (name.endsWith('Id')) {
      walkStats(stats, stats.get(base[name]), resultSet);
    } else if (name.endsWith('Ids')) {
      base[name].forEach(function(id) {
        walkStats(stats, stats.get(id), resultSet);
      });
    }
  });
}

/* filter getStats for a sender/receiver track. */
function filterStats(result, track, outbound) {
  var streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';
  var filteredResult = new Map();
  if (track === null) {
    return filteredResult;
  }
  var trackStats = [];
  result.forEach(function(value) {
    if (value.type === 'track' &&
        value.trackIdentifier === track.id) {
      trackStats.push(value);
    }
  });
  trackStats.forEach(function(trackStat) {
    result.forEach(function(stats) {
      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {
        walkStats(result, stats, filteredResult);
      }
    });
  });
  return filteredResult;
}

module.exports = {
  shimGetUserMedia: require('./getusermedia'),
  shimMediaStream: function(window) {
    window.MediaStream = window.MediaStream || window.webkitMediaStream;
  },

  shimOnTrack: function(window) {
    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in
        window.RTCPeerConnection.prototype)) {
      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {
        get: function() {
          return this._ontrack;
        },
        set: function(f) {
          if (this._ontrack) {
            this.removeEventListener('track', this._ontrack);
          }
          this.addEventListener('track', this._ontrack = f);
        },
        enumerable: true,
        configurable: true
      });
      var origSetRemoteDescription =
          window.RTCPeerConnection.prototype.setRemoteDescription;
      window.RTCPeerConnection.prototype.setRemoteDescription = function() {
        var pc = this;
        if (!pc._ontrackpoly) {
          pc._ontrackpoly = function(e) {
            // onaddstream does not fire when a track is added to an existing
            // stream. But stream.onaddtrack is implemented so we use that.
            e.stream.addEventListener('addtrack', function(te) {
              var receiver;
              if (window.RTCPeerConnection.prototype.getReceivers) {
                receiver = pc.getReceivers().find(function(r) {
                  return r.track && r.track.id === te.track.id;
                });
              } else {
                receiver = {track: te.track};
              }

              var event = new Event('track');
              event.track = te.track;
              event.receiver = receiver;
              event.transceiver = {receiver: receiver};
              event.streams = [e.stream];
              pc.dispatchEvent(event);
            });
            e.stream.getTracks().forEach(function(track) {
              var receiver;
              if (window.RTCPeerConnection.prototype.getReceivers) {
                receiver = pc.getReceivers().find(function(r) {
                  return r.track && r.track.id === track.id;
                });
              } else {
                receiver = {track: track};
              }
              var event = new Event('track');
              event.track = track;
              event.receiver = receiver;
              event.transceiver = {receiver: receiver};
              event.streams = [e.stream];
              pc.dispatchEvent(event);
            });
          };
          pc.addEventListener('addstream', pc._ontrackpoly);
        }
        return origSetRemoteDescription.apply(pc, arguments);
      };
    } else {
      // even if RTCRtpTransceiver is in window, it is only used and
      // emitted in unified-plan. Unfortunately this means we need
      // to unconditionally wrap the event.
      utils.wrapPeerConnectionEvent(window, 'track', function(e) {
        if (!e.transceiver) {
          Object.defineProperty(e, 'transceiver',
            {value: {receiver: e.receiver}});
        }
        return e;
      });
    }
  },

  shimGetSendersWithDtmf: function(window) {
    // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.
    if (typeof window === 'object' && window.RTCPeerConnection &&
        !('getSenders' in window.RTCPeerConnection.prototype) &&
        'createDTMFSender' in window.RTCPeerConnection.prototype) {
      var shimSenderWithDtmf = function(pc, track) {
        return {
          track: track,
          get dtmf() {
            if (this._dtmf === undefined) {
              if (track.kind === 'audio') {
                this._dtmf = pc.createDTMFSender(track);
              } else {
                this._dtmf = null;
              }
            }
            return this._dtmf;
          },
          _pc: pc
        };
      };

      // augment addTrack when getSenders is not available.
      if (!window.RTCPeerConnection.prototype.getSenders) {
        window.RTCPeerConnection.prototype.getSenders = function() {
          this._senders = this._senders || [];
          return this._senders.slice(); // return a copy of the internal state.
        };
        var origAddTrack = window.RTCPeerConnection.prototype.addTrack;
        window.RTCPeerConnection.prototype.addTrack = function(track, stream) {
          var pc = this;
          var sender = origAddTrack.apply(pc, arguments);
          if (!sender) {
            sender = shimSenderWithDtmf(pc, track);
            pc._senders.push(sender);
          }
          return sender;
        };

        var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;
        window.RTCPeerConnection.prototype.removeTrack = function(sender) {
          var pc = this;
          origRemoveTrack.apply(pc, arguments);
          var idx = pc._senders.indexOf(sender);
          if (idx !== -1) {
            pc._senders.splice(idx, 1);
          }
        };
      }
      var origAddStream = window.RTCPeerConnection.prototype.addStream;
      window.RTCPeerConnection.prototype.addStream = function(stream) {
        var pc = this;
        pc._senders = pc._senders || [];
        origAddStream.apply(pc, [stream]);
        stream.getTracks().forEach(function(track) {
          pc._senders.push(shimSenderWithDtmf(pc, track));
        });
      };

      var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;
      window.RTCPeerConnection.prototype.removeStream = function(stream) {
        var pc = this;
        pc._senders = pc._senders || [];
        origRemoveStream.apply(pc, [stream]);

        stream.getTracks().forEach(function(track) {
          var sender = pc._senders.find(function(s) {
            return s.track === track;
          });
          if (sender) {
            pc._senders.splice(pc._senders.indexOf(sender), 1); // remove sender
          }
        });
      };
    } else if (typeof window === 'object' && window.RTCPeerConnection &&
               'getSenders' in window.RTCPeerConnection.prototype &&
               'createDTMFSender' in window.RTCPeerConnection.prototype &&
               window.RTCRtpSender &&
               !('dtmf' in window.RTCRtpSender.prototype)) {
      var origGetSenders = window.RTCPeerConnection.prototype.getSenders;
      window.RTCPeerConnection.prototype.getSenders = function() {
        var pc = this;
        var senders = origGetSenders.apply(pc, []);
        senders.forEach(function(sender) {
          sender._pc = pc;
        });
        return senders;
      };

      Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {
        get: function() {
          if (this._dtmf === undefined) {
            if (this.track.kind === 'audio') {
              this._dtmf = this._pc.createDTMFSender(this.track);
            } else {
              this._dtmf = null;
            }
          }
          return this._dtmf;
        }
      });
    }
  },

  shimSenderReceiverGetStats: function(window) {
    if (!(typeof window === 'object' && window.RTCPeerConnection &&
        window.RTCRtpSender && window.RTCRtpReceiver)) {
      return;
    }

    // shim sender stats.
    if (!('getStats' in window.RTCRtpSender.prototype)) {
      var origGetSenders = window.RTCPeerConnection.prototype.getSenders;
      if (origGetSenders) {
        window.RTCPeerConnection.prototype.getSenders = function() {
          var pc = this;
          var senders = origGetSenders.apply(pc, []);
          senders.forEach(function(sender) {
            sender._pc = pc;
          });
          return senders;
        };
      }

      var origAddTrack = window.RTCPeerConnection.prototype.addTrack;
      if (origAddTrack) {
        window.RTCPeerConnection.prototype.addTrack = function() {
          var sender = origAddTrack.apply(this, arguments);
          sender._pc = this;
          return sender;
        };
      }
      window.RTCRtpSender.prototype.getStats = function() {
        var sender = this;
        return this._pc.getStats().then(function(result) {
          /* Note: this will include stats of all senders that
           *   send a track with the same id as sender.track as
           *   it is not possible to identify the RTCRtpSender.
           */
          return filterStats(result, sender.track, true);
        });
      };
    }

    // shim receiver stats.
    if (!('getStats' in window.RTCRtpReceiver.prototype)) {
      var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;
      if (origGetReceivers) {
        window.RTCPeerConnection.prototype.getReceivers = function() {
          var pc = this;
          var receivers = origGetReceivers.apply(pc, []);
          receivers.forEach(function(receiver) {
            receiver._pc = pc;
          });
          return receivers;
        };
      }
      utils.wrapPeerConnectionEvent(window, 'track', function(e) {
        e.receiver._pc = e.srcElement;
        return e;
      });
      window.RTCRtpReceiver.prototype.getStats = function() {
        var receiver = this;
        return this._pc.getStats().then(function(result) {
          return filterStats(result, receiver.track, false);
        });
      };
    }

    if (!('getStats' in window.RTCRtpSender.prototype &&
        'getStats' in window.RTCRtpReceiver.prototype)) {
      return;
    }

    // shim RTCPeerConnection.getStats(track).
    var origGetStats = window.RTCPeerConnection.prototype.getStats;
    window.RTCPeerConnection.prototype.getStats = function() {
      var pc = this;
      if (arguments.length > 0 &&
          arguments[0] instanceof window.MediaStreamTrack) {
        var track = arguments[0];
        var sender;
        var receiver;
        var err;
        pc.getSenders().forEach(function(s) {
          if (s.track === track) {
            if (sender) {
              err = true;
            } else {
              sender = s;
            }
          }
        });
        pc.getReceivers().forEach(function(r) {
          if (r.track === track) {
            if (receiver) {
              err = true;
            } else {
              receiver = r;
            }
          }
          return r.track === track;
        });
        if (err || (sender && receiver)) {
          return Promise.reject(new DOMException(
            'There are more than one sender or receiver for the track.',
            'InvalidAccessError'));
        } else if (sender) {
          return sender.getStats();
        } else if (receiver) {
          return receiver.getStats();
        }
        return Promise.reject(new DOMException(
          'There is no sender or receiver for the track.',
          'InvalidAccessError'));
      }
      return origGetStats.apply(pc, arguments);
    };
  },

  shimSourceObject: function(window) {
    var URL = window && window.URL;

    if (typeof window === 'object') {
      if (window.HTMLMediaElement &&
        !('srcObject' in window.HTMLMediaElement.prototype)) {
        // Shim the srcObject property, once, when HTMLMediaElement is found.
        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {
          get: function() {
            return this._srcObject;
          },
          set: function(stream) {
            var self = this;
            // Use _srcObject as a private property for this shim
            this._srcObject = stream;
            if (this.src) {
              URL.revokeObjectURL(this.src);
            }

            if (!stream) {
              this.src = '';
              return undefined;
            }
            this.src = URL.createObjectURL(stream);
            // We need to recreate the blob url when a track is added or
            // removed. Doing it manually since we want to avoid a recursion.
            stream.addEventListener('addtrack', function() {
              if (self.src) {
                URL.revokeObjectURL(self.src);
              }
              self.src = URL.createObjectURL(stream);
            });
            stream.addEventListener('removetrack', function() {
              if (self.src) {
                URL.revokeObjectURL(self.src);
              }
              self.src = URL.createObjectURL(stream);
            });
          }
        });
      }
    }
  },

  shimAddTrackRemoveTrackWithNative: function(window) {
    // shim addTrack/removeTrack with native variants in order to make
    // the interactions with legacy getLocalStreams behave as in other browsers.
    // Keeps a mapping stream.id => [stream, rtpsenders...]
    window.RTCPeerConnection.prototype.getLocalStreams = function() {
      var pc = this;
      this._shimmedLocalStreams = this._shimmedLocalStreams || {};
      return Object.keys(this._shimmedLocalStreams).map(function(streamId) {
        return pc._shimmedLocalStreams[streamId][0];
      });
    };

    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;
    window.RTCPeerConnection.prototype.addTrack = function(track, stream) {
      if (!stream) {
        return origAddTrack.apply(this, arguments);
      }
      this._shimmedLocalStreams = this._shimmedLocalStreams || {};

      var sender = origAddTrack.apply(this, arguments);
      if (!this._shimmedLocalStreams[stream.id]) {
        this._shimmedLocalStreams[stream.id] = [stream, sender];
      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {
        this._shimmedLocalStreams[stream.id].push(sender);
      }
      return sender;
    };

    var origAddStream = window.RTCPeerConnection.prototype.addStream;
    window.RTCPeerConnection.prototype.addStream = function(stream) {
      var pc = this;
      this._shimmedLocalStreams = this._shimmedLocalStreams || {};

      stream.getTracks().forEach(function(track) {
        var alreadyExists = pc.getSenders().find(function(s) {
          return s.track === track;
        });
        if (alreadyExists) {
          throw new DOMException('Track already exists.',
              'InvalidAccessError');
        }
      });
      var existingSenders = pc.getSenders();
      origAddStream.apply(this, arguments);
      var newSenders = pc.getSenders().filter(function(newSender) {
        return existingSenders.indexOf(newSender) === -1;
      });
      this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);
    };

    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;
    window.RTCPeerConnection.prototype.removeStream = function(stream) {
      this._shimmedLocalStreams = this._shimmedLocalStreams || {};
      delete this._shimmedLocalStreams[stream.id];
      return origRemoveStream.apply(this, arguments);
    };

    var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;
    window.RTCPeerConnection.prototype.removeTrack = function(sender) {
      var pc = this;
      this._shimmedLocalStreams = this._shimmedLocalStreams || {};
      if (sender) {
        Object.keys(this._shimmedLocalStreams).forEach(function(streamId) {
          var idx = pc._shimmedLocalStreams[streamId].indexOf(sender);
          if (idx !== -1) {
            pc._shimmedLocalStreams[streamId].splice(idx, 1);
          }
          if (pc._shimmedLocalStreams[streamId].length === 1) {
            delete pc._shimmedLocalStreams[streamId];
          }
        });
      }
      return origRemoveTrack.apply(this, arguments);
    };
  },

  shimAddTrackRemoveTrack: function(window) {
    if (!window.RTCPeerConnection) {
      return;
    }
    var browserDetails = utils.detectBrowser(window);
    // shim addTrack and removeTrack.
    if (window.RTCPeerConnection.prototype.addTrack &&
        browserDetails.version >= 65) {
      return this.shimAddTrackRemoveTrackWithNative(window);
    }

    // also shim pc.getLocalStreams when addTrack is shimmed
    // to return the original streams.
    var origGetLocalStreams = window.RTCPeerConnection.prototype
        .getLocalStreams;
    window.RTCPeerConnection.prototype.getLocalStreams = function() {
      var pc = this;
      var nativeStreams = origGetLocalStreams.apply(this);
      pc._reverseStreams = pc._reverseStreams || {};
      return nativeStreams.map(function(stream) {
        return pc._reverseStreams[stream.id];
      });
    };

    var origAddStream = window.RTCPeerConnection.prototype.addStream;
    window.RTCPeerConnection.prototype.addStream = function(stream) {
      var pc = this;
      pc._streams = pc._streams || {};
      pc._reverseStreams = pc._reverseStreams || {};

      stream.getTracks().forEach(function(track) {
        var alreadyExists = pc.getSenders().find(function(s) {
          return s.track === track;
        });
        if (alreadyExists) {
          throw new DOMException('Track already exists.',
              'InvalidAccessError');
        }
      });
      // Add identity mapping for consistency with addTrack.
      // Unless this is being used with a stream from addTrack.
      if (!pc._reverseStreams[stream.id]) {
        var newStream = new window.MediaStream(stream.getTracks());
        pc._streams[stream.id] = newStream;
        pc._reverseStreams[newStream.id] = stream;
        stream = newStream;
      }
      origAddStream.apply(pc, [stream]);
    };

    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;
    window.RTCPeerConnection.prototype.removeStream = function(stream) {
      var pc = this;
      pc._streams = pc._streams || {};
      pc._reverseStreams = pc._reverseStreams || {};

      origRemoveStream.apply(pc, [(pc._streams[stream.id] || stream)]);
      delete pc._reverseStreams[(pc._streams[stream.id] ?
          pc._streams[stream.id].id : stream.id)];
      delete pc._streams[stream.id];
    };

    window.RTCPeerConnection.prototype.addTrack = function(track, stream) {
      var pc = this;
      if (pc.signalingState === 'closed') {
        throw new DOMException(
          'The RTCPeerConnection\'s signalingState is \'closed\'.',
          'InvalidStateError');
      }
      var streams = [].slice.call(arguments, 1);
      if (streams.length !== 1 ||
          !streams[0].getTracks().find(function(t) {
            return t === track;
          })) {
        // this is not fully correct but all we can manage without
        // [[associated MediaStreams]] internal slot.
        throw new DOMException(
          'The adapter.js addTrack polyfill only supports a single ' +
          ' stream which is associated with the specified track.',
          'NotSupportedError');
      }

      var alreadyExists = pc.getSenders().find(function(s) {
        return s.track === track;
      });
      if (alreadyExists) {
        throw new DOMException('Track already exists.',
            'InvalidAccessError');
      }

      pc._streams = pc._streams || {};
      pc._reverseStreams = pc._reverseStreams || {};
      var oldStream = pc._streams[stream.id];
      if (oldStream) {
        // this is using odd Chrome behaviour, use with caution:
        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815
        // Note: we rely on the high-level addTrack/dtmf shim to
        // create the sender with a dtmf sender.
        oldStream.addTrack(track);

        // Trigger ONN async.
        Promise.resolve().then(function() {
          pc.dispatchEvent(new Event('negotiationneeded'));
        });
      } else {
        var newStream = new window.MediaStream([track]);
        pc._streams[stream.id] = newStream;
        pc._reverseStreams[newStream.id] = stream;
        pc.addStream(newStream);
      }
      return pc.getSenders().find(function(s) {
        return s.track === track;
      });
    };

    // replace the internal stream id with the external one and
    // vice versa.
    function replaceInternalStreamId(pc, description) {
      var sdp = description.sdp;
      Object.keys(pc._reverseStreams || []).forEach(function(internalId) {
        var externalStream = pc._reverseStreams[internalId];
        var internalStream = pc._streams[externalStream.id];
        sdp = sdp.replace(new RegExp(internalStream.id, 'g'),
            externalStream.id);
      });
      return new RTCSessionDescription({
        type: description.type,
        sdp: sdp
      });
    }
    function replaceExternalStreamId(pc, description) {
      var sdp = description.sdp;
      Object.keys(pc._reverseStreams || []).forEach(function(internalId) {
        var externalStream = pc._reverseStreams[internalId];
        var internalStream = pc._streams[externalStream.id];
        sdp = sdp.replace(new RegExp(externalStream.id, 'g'),
            internalStream.id);
      });
      return new RTCSessionDescription({
        type: description.type,
        sdp: sdp
      });
    }
    ['createOffer', 'createAnswer'].forEach(function(method) {
      var nativeMethod = window.RTCPeerConnection.prototype[method];
      window.RTCPeerConnection.prototype[method] = function() {
        var pc = this;
        var args = arguments;
        var isLegacyCall = arguments.length &&
            typeof arguments[0] === 'function';
        if (isLegacyCall) {
          return nativeMethod.apply(pc, [
            function(description) {
              var desc = replaceInternalStreamId(pc, description);
              args[0].apply(null, [desc]);
            },
            function(err) {
              if (args[1]) {
                args[1].apply(null, err);
              }
            }, arguments[2]
          ]);
        }
        return nativeMethod.apply(pc, arguments)
        .then(function(description) {
          return replaceInternalStreamId(pc, description);
        });
      };
    });

    var origSetLocalDescription =
        window.RTCPeerConnection.prototype.setLocalDescription;
    window.RTCPeerConnection.prototype.setLocalDescription = function() {
      var pc = this;
      if (!arguments.length || !arguments[0].type) {
        return origSetLocalDescription.apply(pc, arguments);
      }
      arguments[0] = replaceExternalStreamId(pc, arguments[0]);
      return origSetLocalDescription.apply(pc, arguments);
    };

    // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier

    var origLocalDescription = Object.getOwnPropertyDescriptor(
        window.RTCPeerConnection.prototype, 'localDescription');
    Object.defineProperty(window.RTCPeerConnection.prototype,
        'localDescription', {
          get: function() {
            var pc = this;
            var description = origLocalDescription.get.apply(this);
            if (description.type === '') {
              return description;
            }
            return replaceInternalStreamId(pc, description);
          }
        });

    window.RTCPeerConnection.prototype.removeTrack = function(sender) {
      var pc = this;
      if (pc.signalingState === 'closed') {
        throw new DOMException(
          'The RTCPeerConnection\'s signalingState is \'closed\'.',
          'InvalidStateError');
      }
      // We can not yet check for sender instanceof RTCRtpSender
      // since we shim RTPSender. So we check if sender._pc is set.
      if (!sender._pc) {
        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +
            'does not implement interface RTCRtpSender.', 'TypeError');
      }
      var isLocal = sender._pc === pc;
      if (!isLocal) {
        throw new DOMException('Sender was not created by this connection.',
            'InvalidAccessError');
      }

      // Search for the native stream the senders track belongs to.
      pc._streams = pc._streams || {};
      var stream;
      Object.keys(pc._streams).forEach(function(streamid) {
        var hasTrack = pc._streams[streamid].getTracks().find(function(track) {
          return sender.track === track;
        });
        if (hasTrack) {
          stream = pc._streams[streamid];
        }
      });

      if (stream) {
        if (stream.getTracks().length === 1) {
          // if this is the last track of the stream, remove the stream. This
          // takes care of any shimmed _senders.
          pc.removeStream(pc._reverseStreams[stream.id]);
        } else {
          // relying on the same odd chrome behaviour as above.
          stream.removeTrack(sender.track);
        }
        pc.dispatchEvent(new Event('negotiationneeded'));
      }
    };
  },

  shimPeerConnection: function(window) {
    var browserDetails = utils.detectBrowser(window);

    // The RTCPeerConnection object.
    if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {
      window.RTCPeerConnection = function(pcConfig, pcConstraints) {
        // Translate iceTransportPolicy to iceTransports,
        // see https://code.google.com/p/webrtc/issues/detail?id=4869
        // this was fixed in M56 along with unprefixing RTCPeerConnection.
        logging('PeerConnection');
        if (pcConfig && pcConfig.iceTransportPolicy) {
          pcConfig.iceTransports = pcConfig.iceTransportPolicy;
        }

        return new window.webkitRTCPeerConnection(pcConfig, pcConstraints);
      };
      window.RTCPeerConnection.prototype =
          window.webkitRTCPeerConnection.prototype;
      // wrap static methods. Currently just generateCertificate.
      if (window.webkitRTCPeerConnection.generateCertificate) {
        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {
          get: function() {
            return window.webkitRTCPeerConnection.generateCertificate;
          }
        });
      }
    }
    if (!window.RTCPeerConnection) {
      return;
    }

    var origGetStats = window.RTCPeerConnection.prototype.getStats;
    window.RTCPeerConnection.prototype.getStats = function(selector,
        successCallback, errorCallback) {
      var pc = this;
      var args = arguments;

      // If selector is a function then we are in the old style stats so just
      // pass back the original getStats format to avoid breaking old users.
      if (arguments.length > 0 && typeof selector === 'function') {
        return origGetStats.apply(this, arguments);
      }

      // When spec-style getStats is supported, return those when called with
      // either no arguments or the selector argument is null.
      if (origGetStats.length === 0 && (arguments.length === 0 ||
          typeof arguments[0] !== 'function')) {
        return origGetStats.apply(this, []);
      }

      var fixChromeStats_ = function(response) {
        var standardReport = {};
        var reports = response.result();
        reports.forEach(function(report) {
          var standardStats = {
            id: report.id,
            timestamp: report.timestamp,
            type: {
              localcandidate: 'local-candidate',
              remotecandidate: 'remote-candidate'
            }[report.type] || report.type
          };
          report.names().forEach(function(name) {
            standardStats[name] = report.stat(name);
          });
          standardReport[standardStats.id] = standardStats;
        });

        return standardReport;
      };

      // shim getStats with maplike support
      var makeMapStats = function(stats) {
        return new Map(Object.keys(stats).map(function(key) {
          return [key, stats[key]];
        }));
      };

      if (arguments.length >= 2) {
        var successCallbackWrapper_ = function(response) {
          args[1](makeMapStats(fixChromeStats_(response)));
        };

        return origGetStats.apply(this, [successCallbackWrapper_,
          arguments[0]]);
      }

      // promise-support
      return new Promise(function(resolve, reject) {
        origGetStats.apply(pc, [
          function(response) {
            resolve(makeMapStats(fixChromeStats_(response)));
          }, reject]);
      }).then(successCallback, errorCallback);
    };

    // add promise support -- natively available in Chrome 51
    if (browserDetails.version < 51) {
      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']
          .forEach(function(method) {
            var nativeMethod = window.RTCPeerConnection.prototype[method];
            window.RTCPeerConnection.prototype[method] = function() {
              var args = arguments;
              var pc = this;
              var promise = new Promise(function(resolve, reject) {
                nativeMethod.apply(pc, [args[0], resolve, reject]);
              });
              if (args.length < 2) {
                return promise;
              }
              return promise.then(function() {
                args[1].apply(null, []);
              },
              function(err) {
                if (args.length >= 3) {
                  args[2].apply(null, [err]);
                }
              });
            };
          });
    }

    // promise support for createOffer and createAnswer. Available (without
    // bugs) since M52: crbug/619289
    if (browserDetails.version < 52) {
      ['createOffer', 'createAnswer'].forEach(function(method) {
        var nativeMethod = window.RTCPeerConnection.prototype[method];
        window.RTCPeerConnection.prototype[method] = function() {
          var pc = this;
          if (arguments.length < 1 || (arguments.length === 1 &&
              typeof arguments[0] === 'object')) {
            var opts = arguments.length === 1 ? arguments[0] : undefined;
            return new Promise(function(resolve, reject) {
              nativeMethod.apply(pc, [resolve, reject, opts]);
            });
          }
          return nativeMethod.apply(this, arguments);
        };
      });
    }

    // shim implicit creation of RTCSessionDescription/RTCIceCandidate
    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']
        .forEach(function(method) {
          var nativeMethod = window.RTCPeerConnection.prototype[method];
          window.RTCPeerConnection.prototype[method] = function() {
            arguments[0] = new ((method === 'addIceCandidate') ?
                window.RTCIceCandidate :
                window.RTCSessionDescription)(arguments[0]);
            return nativeMethod.apply(this, arguments);
          };
        });

    // support for addIceCandidate(null or undefined)
    var nativeAddIceCandidate =
        window.RTCPeerConnection.prototype.addIceCandidate;
    window.RTCPeerConnection.prototype.addIceCandidate = function() {
      if (!arguments[0]) {
        if (arguments[1]) {
          arguments[1].apply(null);
        }
        return Promise.resolve();
      }
      return nativeAddIceCandidate.apply(this, arguments);
    };
  },

  fixNegotiationNeeded: function(window) {
    utils.wrapPeerConnectionEvent(window, 'negotiationneeded', function(e) {
      var pc = e.target;
      if (pc.signalingState !== 'stable') {
        return;
      }
      return e;
    });
  },

  shimGetDisplayMedia: function(window, getSourceId) {
    if (!window.navigator || !window.navigator.mediaDevices ||
        'getDisplayMedia' in window.navigator.mediaDevices) {
      return;
    }
    // getSourceId is a function that returns a promise resolving with
    // the sourceId of the screen/window/tab to be shared.
    if (typeof getSourceId !== 'function') {
      console.error('shimGetDisplayMedia: getSourceId argument is not ' +
          'a function');
      return;
    }
    window.navigator.mediaDevices.getDisplayMedia = function(constraints) {
      return getSourceId(constraints)
        .then(function(sourceId) {
          var widthSpecified = constraints.video && constraints.video.width;
          var heightSpecified = constraints.video && constraints.video.height;
          var frameRateSpecified = constraints.video &&
            constraints.video.frameRate;
          constraints.video = {
            mandatory: {
              chromeMediaSource: 'desktop',
              chromeMediaSourceId: sourceId,
              maxFrameRate: frameRateSpecified || 3
            }
          };
          if (widthSpecified) {
            constraints.video.mandatory.maxWidth = widthSpecified;
          }
          if (heightSpecified) {
            constraints.video.mandatory.maxHeight = heightSpecified;
          }
          return window.navigator.mediaDevices.getUserMedia(constraints);
        });
    };
    window.navigator.getDisplayMedia = function(constraints) {
      utils.deprecated('navigator.getDisplayMedia',
          'navigator.mediaDevices.getDisplayMedia');
      return window.navigator.mediaDevices.getDisplayMedia(constraints);
    };
  }
};

},{"../utils.js":133,"./getusermedia":125}],125:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';
var utils = require('../utils.js');
var logging = utils.log;

// Expose public methods.
module.exports = function(window) {
  var browserDetails = utils.detectBrowser(window);
  var navigator = window && window.navigator;

  var constraintsToChrome_ = function(c) {
    if (typeof c !== 'object' || c.mandatory || c.optional) {
      return c;
    }
    var cc = {};
    Object.keys(c).forEach(function(key) {
      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {
        return;
      }
      var r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};
      if (r.exact !== undefined && typeof r.exact === 'number') {
        r.min = r.max = r.exact;
      }
      var oldname_ = function(prefix, name) {
        if (prefix) {
          return prefix + name.charAt(0).toUpperCase() + name.slice(1);
        }
        return (name === 'deviceId') ? 'sourceId' : name;
      };
      if (r.ideal !== undefined) {
        cc.optional = cc.optional || [];
        var oc = {};
        if (typeof r.ideal === 'number') {
          oc[oldname_('min', key)] = r.ideal;
          cc.optional.push(oc);
          oc = {};
          oc[oldname_('max', key)] = r.ideal;
          cc.optional.push(oc);
        } else {
          oc[oldname_('', key)] = r.ideal;
          cc.optional.push(oc);
        }
      }
      if (r.exact !== undefined && typeof r.exact !== 'number') {
        cc.mandatory = cc.mandatory || {};
        cc.mandatory[oldname_('', key)] = r.exact;
      } else {
        ['min', 'max'].forEach(function(mix) {
          if (r[mix] !== undefined) {
            cc.mandatory = cc.mandatory || {};
            cc.mandatory[oldname_(mix, key)] = r[mix];
          }
        });
      }
    });
    if (c.advanced) {
      cc.optional = (cc.optional || []).concat(c.advanced);
    }
    return cc;
  };

  var shimConstraints_ = function(constraints, func) {
    if (browserDetails.version >= 61) {
      return func(constraints);
    }
    constraints = JSON.parse(JSON.stringify(constraints));
    if (constraints && typeof constraints.audio === 'object') {
      var remap = function(obj, a, b) {
        if (a in obj && !(b in obj)) {
          obj[b] = obj[a];
          delete obj[a];
        }
      };
      constraints = JSON.parse(JSON.stringify(constraints));
      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');
      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');
      constraints.audio = constraintsToChrome_(constraints.audio);
    }
    if (constraints && typeof constraints.video === 'object') {
      // Shim facingMode for mobile & surface pro.
      var face = constraints.video.facingMode;
      face = face && ((typeof face === 'object') ? face : {ideal: face});
      var getSupportedFacingModeLies = browserDetails.version < 66;

      if ((face && (face.exact === 'user' || face.exact === 'environment' ||
                    face.ideal === 'user' || face.ideal === 'environment')) &&
          !(navigator.mediaDevices.getSupportedConstraints &&
            navigator.mediaDevices.getSupportedConstraints().facingMode &&
            !getSupportedFacingModeLies)) {
        delete constraints.video.facingMode;
        var matches;
        if (face.exact === 'environment' || face.ideal === 'environment') {
          matches = ['back', 'rear'];
        } else if (face.exact === 'user' || face.ideal === 'user') {
          matches = ['front'];
        }
        if (matches) {
          // Look for matches in label, or use last cam for back (typical).
          return navigator.mediaDevices.enumerateDevices()
          .then(function(devices) {
            devices = devices.filter(function(d) {
              return d.kind === 'videoinput';
            });
            var dev = devices.find(function(d) {
              return matches.some(function(match) {
                return d.label.toLowerCase().indexOf(match) !== -1;
              });
            });
            if (!dev && devices.length && matches.indexOf('back') !== -1) {
              dev = devices[devices.length - 1]; // more likely the back cam
            }
            if (dev) {
              constraints.video.deviceId = face.exact ? {exact: dev.deviceId} :
                                                        {ideal: dev.deviceId};
            }
            constraints.video = constraintsToChrome_(constraints.video);
            logging('chrome: ' + JSON.stringify(constraints));
            return func(constraints);
          });
        }
      }
      constraints.video = constraintsToChrome_(constraints.video);
    }
    logging('chrome: ' + JSON.stringify(constraints));
    return func(constraints);
  };

  var shimError_ = function(e) {
    if (browserDetails.version >= 64) {
      return e;
    }
    return {
      name: {
        PermissionDeniedError: 'NotAllowedError',
        PermissionDismissedError: 'NotAllowedError',
        InvalidStateError: 'NotAllowedError',
        DevicesNotFoundError: 'NotFoundError',
        ConstraintNotSatisfiedError: 'OverconstrainedError',
        TrackStartError: 'NotReadableError',
        MediaDeviceFailedDueToShutdown: 'NotAllowedError',
        MediaDeviceKillSwitchOn: 'NotAllowedError',
        TabCaptureError: 'AbortError',
        ScreenCaptureError: 'AbortError',
        DeviceCaptureError: 'AbortError'
      }[e.name] || e.name,
      message: e.message,
      constraint: e.constraint || e.constraintName,
      toString: function() {
        return this.name + (this.message && ': ') + this.message;
      }
    };
  };

  var getUserMedia_ = function(constraints, onSuccess, onError) {
    shimConstraints_(constraints, function(c) {
      navigator.webkitGetUserMedia(c, onSuccess, function(e) {
        if (onError) {
          onError(shimError_(e));
        }
      });
    });
  };

  navigator.getUserMedia = getUserMedia_;

  // Returns the result of getUserMedia as a Promise.
  var getUserMediaPromise_ = function(constraints) {
    return new Promise(function(resolve, reject) {
      navigator.getUserMedia(constraints, resolve, reject);
    });
  };

  if (!navigator.mediaDevices) {
    navigator.mediaDevices = {
      getUserMedia: getUserMediaPromise_,
      enumerateDevices: function() {
        return new Promise(function(resolve) {
          var kinds = {audio: 'audioinput', video: 'videoinput'};
          return window.MediaStreamTrack.getSources(function(devices) {
            resolve(devices.map(function(device) {
              return {label: device.label,
                kind: kinds[device.kind],
                deviceId: device.id,
                groupId: ''};
            }));
          });
        });
      },
      getSupportedConstraints: function() {
        return {
          deviceId: true, echoCancellation: true, facingMode: true,
          frameRate: true, height: true, width: true
        };
      }
    };
  }

  // A shim for getUserMedia method on the mediaDevices object.
  // TODO(KaptenJansson) remove once implemented in Chrome stable.
  if (!navigator.mediaDevices.getUserMedia) {
    navigator.mediaDevices.getUserMedia = function(constraints) {
      return getUserMediaPromise_(constraints);
    };
  } else {
    // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia
    // function which returns a Promise, it does not accept spec-style
    // constraints.
    var origGetUserMedia = navigator.mediaDevices.getUserMedia.
        bind(navigator.mediaDevices);
    navigator.mediaDevices.getUserMedia = function(cs) {
      return shimConstraints_(cs, function(c) {
        return origGetUserMedia(c).then(function(stream) {
          if (c.audio && !stream.getAudioTracks().length ||
              c.video && !stream.getVideoTracks().length) {
            stream.getTracks().forEach(function(track) {
              track.stop();
            });
            throw new DOMException('', 'NotFoundError');
          }
          return stream;
        }, function(e) {
          return Promise.reject(shimError_(e));
        });
      });
    };
  }

  // Dummy devicechange event methods.
  // TODO(KaptenJansson) remove once implemented in Chrome stable.
  if (typeof navigator.mediaDevices.addEventListener === 'undefined') {
    navigator.mediaDevices.addEventListener = function() {
      logging('Dummy mediaDevices.addEventListener called.');
    };
  }
  if (typeof navigator.mediaDevices.removeEventListener === 'undefined') {
    navigator.mediaDevices.removeEventListener = function() {
      logging('Dummy mediaDevices.removeEventListener called.');
    };
  }
};

},{"../utils.js":133}],126:[function(require,module,exports){
/*
 *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var SDPUtils = require('sdp');
var utils = require('./utils');

module.exports = {
  shimRTCIceCandidate: function(window) {
    // foundation is arbitrarily chosen as an indicator for full support for
    // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface
    if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in
        window.RTCIceCandidate.prototype)) {
      return;
    }

    var NativeRTCIceCandidate = window.RTCIceCandidate;
    window.RTCIceCandidate = function(args) {
      // Remove the a= which shouldn't be part of the candidate string.
      if (typeof args === 'object' && args.candidate &&
          args.candidate.indexOf('a=') === 0) {
        args = JSON.parse(JSON.stringify(args));
        args.candidate = args.candidate.substr(2);
      }

      if (args.candidate && args.candidate.length) {
        // Augment the native candidate with the parsed fields.
        var nativeCandidate = new NativeRTCIceCandidate(args);
        var parsedCandidate = SDPUtils.parseCandidate(args.candidate);
        var augmentedCandidate = Object.assign(nativeCandidate,
            parsedCandidate);

        // Add a serializer that does not serialize the extra attributes.
        augmentedCandidate.toJSON = function() {
          return {
            candidate: augmentedCandidate.candidate,
            sdpMid: augmentedCandidate.sdpMid,
            sdpMLineIndex: augmentedCandidate.sdpMLineIndex,
            usernameFragment: augmentedCandidate.usernameFragment,
          };
        };
        return augmentedCandidate;
      }
      return new NativeRTCIceCandidate(args);
    };
    window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;

    // Hook up the augmented candidate in onicecandidate and
    // addEventListener('icecandidate', ...)
    utils.wrapPeerConnectionEvent(window, 'icecandidate', function(e) {
      if (e.candidate) {
        Object.defineProperty(e, 'candidate', {
          value: new window.RTCIceCandidate(e.candidate),
          writable: 'false'
        });
      }
      return e;
    });
  },

  // shimCreateObjectURL must be called before shimSourceObject to avoid loop.

  shimCreateObjectURL: function(window) {
    var URL = window && window.URL;

    if (!(typeof window === 'object' && window.HTMLMediaElement &&
          'srcObject' in window.HTMLMediaElement.prototype &&
        URL.createObjectURL && URL.revokeObjectURL)) {
      // Only shim CreateObjectURL using srcObject if srcObject exists.
      return undefined;
    }

    var nativeCreateObjectURL = URL.createObjectURL.bind(URL);
    var nativeRevokeObjectURL = URL.revokeObjectURL.bind(URL);
    var streams = new Map(), newId = 0;

    URL.createObjectURL = function(stream) {
      if ('getTracks' in stream) {
        var url = 'polyblob:' + (++newId);
        streams.set(url, stream);
        utils.deprecated('URL.createObjectURL(stream)',
            'elem.srcObject = stream');
        return url;
      }
      return nativeCreateObjectURL(stream);
    };
    URL.revokeObjectURL = function(url) {
      nativeRevokeObjectURL(url);
      streams.delete(url);
    };

    var dsc = Object.getOwnPropertyDescriptor(window.HTMLMediaElement.prototype,
                                              'src');
    Object.defineProperty(window.HTMLMediaElement.prototype, 'src', {
      get: function() {
        return dsc.get.apply(this);
      },
      set: function(url) {
        this.srcObject = streams.get(url) || null;
        return dsc.set.apply(this, [url]);
      }
    });

    var nativeSetAttribute = window.HTMLMediaElement.prototype.setAttribute;
    window.HTMLMediaElement.prototype.setAttribute = function() {
      if (arguments.length === 2 &&
          ('' + arguments[0]).toLowerCase() === 'src') {
        this.srcObject = streams.get(arguments[1]) || null;
      }
      return nativeSetAttribute.apply(this, arguments);
    };
  },

  shimMaxMessageSize: function(window) {
    if (window.RTCSctpTransport || !window.RTCPeerConnection) {
      return;
    }
    var browserDetails = utils.detectBrowser(window);

    if (!('sctp' in window.RTCPeerConnection.prototype)) {
      Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {
        get: function() {
          return typeof this._sctp === 'undefined' ? null : this._sctp;
        }
      });
    }

    var sctpInDescription = function(description) {
      var sections = SDPUtils.splitSections(description.sdp);
      sections.shift();
      return sections.some(function(mediaSection) {
        var mLine = SDPUtils.parseMLine(mediaSection);
        return mLine && mLine.kind === 'application'
            && mLine.protocol.indexOf('SCTP') !== -1;
      });
    };

    var getRemoteFirefoxVersion = function(description) {
      // TODO: Is there a better solution for detecting Firefox?
      var match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);
      if (match === null || match.length < 2) {
        return -1;
      }
      var version = parseInt(match[1], 10);
      // Test for NaN (yes, this is ugly)
      return version !== version ? -1 : version;
    };

    var getCanSendMaxMessageSize = function(remoteIsFirefox) {
      // Every implementation we know can send at least 64 KiB.
      // Note: Although Chrome is technically able to send up to 256 KiB, the
      //       data does not reach the other peer reliably.
      //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419
      var canSendMaxMessageSize = 65536;
      if (browserDetails.browser === 'firefox') {
        if (browserDetails.version < 57) {
          if (remoteIsFirefox === -1) {
            // FF < 57 will send in 16 KiB chunks using the deprecated PPID
            // fragmentation.
            canSendMaxMessageSize = 16384;
          } else {
            // However, other FF (and RAWRTC) can reassemble PPID-fragmented
            // messages. Thus, supporting ~2 GiB when sending.
            canSendMaxMessageSize = 2147483637;
          }
        } else if (browserDetails.version < 60) {
          // Currently, all FF >= 57 will reset the remote maximum message size
          // to the default value when a data channel is created at a later
          // stage. :(
          // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831
          canSendMaxMessageSize =
            browserDetails.version === 57 ? 65535 : 65536;
        } else {
          // FF >= 60 supports sending ~2 GiB
          canSendMaxMessageSize = 2147483637;
        }
      }
      return canSendMaxMessageSize;
    };

    var getMaxMessageSize = function(description, remoteIsFirefox) {
      // Note: 65536 bytes is the default value from the SDP spec. Also,
      //       every implementation we know supports receiving 65536 bytes.
      var maxMessageSize = 65536;

      // FF 57 has a slightly incorrect default remote max message size, so
      // we need to adjust it here to avoid a failure when sending.
      // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697
      if (browserDetails.browser === 'firefox'
           && browserDetails.version === 57) {
        maxMessageSize = 65535;
      }

      var match = SDPUtils.matchPrefix(description.sdp, 'a=max-message-size:');
      if (match.length > 0) {
        maxMessageSize = parseInt(match[0].substr(19), 10);
      } else if (browserDetails.browser === 'firefox' &&
                  remoteIsFirefox !== -1) {
        // If the maximum message size is not present in the remote SDP and
        // both local and remote are Firefox, the remote peer can receive
        // ~2 GiB.
        maxMessageSize = 2147483637;
      }
      return maxMessageSize;
    };

    var origSetRemoteDescription =
        window.RTCPeerConnection.prototype.setRemoteDescription;
    window.RTCPeerConnection.prototype.setRemoteDescription = function() {
      var pc = this;
      pc._sctp = null;

      if (sctpInDescription(arguments[0])) {
        // Check if the remote is FF.
        var isFirefox = getRemoteFirefoxVersion(arguments[0]);

        // Get the maximum message size the local peer is capable of sending
        var canSendMMS = getCanSendMaxMessageSize(isFirefox);

        // Get the maximum message size of the remote peer.
        var remoteMMS = getMaxMessageSize(arguments[0], isFirefox);

        // Determine final maximum message size
        var maxMessageSize;
        if (canSendMMS === 0 && remoteMMS === 0) {
          maxMessageSize = Number.POSITIVE_INFINITY;
        } else if (canSendMMS === 0 || remoteMMS === 0) {
          maxMessageSize = Math.max(canSendMMS, remoteMMS);
        } else {
          maxMessageSize = Math.min(canSendMMS, remoteMMS);
        }

        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'
        // attribute.
        var sctp = {};
        Object.defineProperty(sctp, 'maxMessageSize', {
          get: function() {
            return maxMessageSize;
          }
        });
        pc._sctp = sctp;
      }

      return origSetRemoteDescription.apply(pc, arguments);
    };
  },

  shimSendThrowTypeError: function(window) {
    if (!(window.RTCPeerConnection &&
        'createDataChannel' in window.RTCPeerConnection.prototype)) {
      return;
    }

    // Note: Although Firefox >= 57 has a native implementation, the maximum
    //       message size can be reset for all data channels at a later stage.
    //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831

    function wrapDcSend(dc, pc) {
      var origDataChannelSend = dc.send;
      dc.send = function() {
        var data = arguments[0];
        var length = data.length || data.size || data.byteLength;
        if (dc.readyState === 'open' &&
            pc.sctp && length > pc.sctp.maxMessageSize) {
          throw new TypeError('Message too large (can send a maximum of ' +
            pc.sctp.maxMessageSize + ' bytes)');
        }
        return origDataChannelSend.apply(dc, arguments);
      };
    }
    var origCreateDataChannel =
      window.RTCPeerConnection.prototype.createDataChannel;
    window.RTCPeerConnection.prototype.createDataChannel = function() {
      var pc = this;
      var dataChannel = origCreateDataChannel.apply(pc, arguments);
      wrapDcSend(dataChannel, pc);
      return dataChannel;
    };
    utils.wrapPeerConnectionEvent(window, 'datachannel', function(e) {
      wrapDcSend(e.channel, e.target);
      return e;
    });
  }
};

},{"./utils":133,"sdp":118}],127:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var utils = require('../utils');
var filterIceServers = require('./filtericeservers');
var shimRTCPeerConnection = require('rtcpeerconnection-shim');

module.exports = {
  shimGetUserMedia: require('./getusermedia'),
  shimPeerConnection: function(window) {
    var browserDetails = utils.detectBrowser(window);

    if (window.RTCIceGatherer) {
      if (!window.RTCIceCandidate) {
        window.RTCIceCandidate = function(args) {
          return args;
        };
      }
      if (!window.RTCSessionDescription) {
        window.RTCSessionDescription = function(args) {
          return args;
        };
      }
      // this adds an additional event listener to MediaStrackTrack that signals
      // when a tracks enabled property was changed. Workaround for a bug in
      // addStream, see below. No longer required in 15025+
      if (browserDetails.version < 15025) {
        var origMSTEnabled = Object.getOwnPropertyDescriptor(
            window.MediaStreamTrack.prototype, 'enabled');
        Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {
          set: function(value) {
            origMSTEnabled.set.call(this, value);
            var ev = new Event('enabled');
            ev.enabled = value;
            this.dispatchEvent(ev);
          }
        });
      }
    }

    // ORTC defines the DTMF sender a bit different.
    // https://github.com/w3c/ortc/issues/714
    if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {
      Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {
        get: function() {
          if (this._dtmf === undefined) {
            if (this.track.kind === 'audio') {
              this._dtmf = new window.RTCDtmfSender(this);
            } else if (this.track.kind === 'video') {
              this._dtmf = null;
            }
          }
          return this._dtmf;
        }
      });
    }
    // Edge currently only implements the RTCDtmfSender, not the
    // RTCDTMFSender alias. See http://draft.ortc.org/#rtcdtmfsender2*
    if (window.RTCDtmfSender && !window.RTCDTMFSender) {
      window.RTCDTMFSender = window.RTCDtmfSender;
    }

    var RTCPeerConnectionShim = shimRTCPeerConnection(window,
        browserDetails.version);
    window.RTCPeerConnection = function(config) {
      if (config && config.iceServers) {
        config.iceServers = filterIceServers(config.iceServers);
      }
      return new RTCPeerConnectionShim(config);
    };
    window.RTCPeerConnection.prototype = RTCPeerConnectionShim.prototype;
  },
  shimReplaceTrack: function(window) {
    // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614
    if (window.RTCRtpSender &&
        !('replaceTrack' in window.RTCRtpSender.prototype)) {
      window.RTCRtpSender.prototype.replaceTrack =
          window.RTCRtpSender.prototype.setTrack;
    }
  },
  shimGetDisplayMedia: function(window, preferredMediaSource) {
    if (!('getDisplayMedia' in window.navigator) ||
        !window.navigator.mediaDevices ||
        'getDisplayMedia' in window.navigator.mediaDevices) {
      return;
    }
    var origGetDisplayMedia = window.navigator.getDisplayMedia;
    window.navigator.mediaDevices.getDisplayMedia = function(constraints) {
      return origGetDisplayMedia.call(window.navigator, constraints);
    };
    window.navigator.getDisplayMedia = function(constraints) {
      utils.deprecated('navigator.getDisplayMedia',
          'navigator.mediaDevices.getDisplayMedia');
      return origGetDisplayMedia.call(window.navigator, constraints);
    };
  }
};

},{"../utils":133,"./filtericeservers":128,"./getusermedia":129,"rtcpeerconnection-shim":117}],128:[function(require,module,exports){
/*
 *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var utils = require('../utils');
// Edge does not like
// 1) stun: filtered after 14393 unless ?transport=udp is present
// 2) turn: that does not have all of turn:host:port?transport=udp
// 3) turn: with ipv6 addresses
// 4) turn: occurring muliple times
module.exports = function(iceServers, edgeVersion) {
  var hasTurn = false;
  iceServers = JSON.parse(JSON.stringify(iceServers));
  return iceServers.filter(function(server) {
    if (server && (server.urls || server.url)) {
      var urls = server.urls || server.url;
      if (server.url && !server.urls) {
        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');
      }
      var isString = typeof urls === 'string';
      if (isString) {
        urls = [urls];
      }
      urls = urls.filter(function(url) {
        var validTurn = url.indexOf('turn:') === 0 &&
            url.indexOf('transport=udp') !== -1 &&
            url.indexOf('turn:[') === -1 &&
            !hasTurn;

        if (validTurn) {
          hasTurn = true;
          return true;
        }
        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&
            url.indexOf('?transport=udp') === -1;
      });

      delete server.url;
      server.urls = isString ? urls[0] : urls;
      return !!urls.length;
    }
  });
};

},{"../utils":133}],129:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

// Expose public methods.
module.exports = function(window) {
  var navigator = window && window.navigator;

  var shimError_ = function(e) {
    return {
      name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,
      message: e.message,
      constraint: e.constraint,
      toString: function() {
        return this.name;
      }
    };
  };

  // getUserMedia error shim.
  var origGetUserMedia = navigator.mediaDevices.getUserMedia.
      bind(navigator.mediaDevices);
  navigator.mediaDevices.getUserMedia = function(c) {
    return origGetUserMedia(c).catch(function(e) {
      return Promise.reject(shimError_(e));
    });
  };
};

},{}],130:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var utils = require('../utils');

module.exports = {
  shimGetUserMedia: require('./getusermedia'),
  shimOnTrack: function(window) {
    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in
        window.RTCPeerConnection.prototype)) {
      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {
        get: function() {
          return this._ontrack;
        },
        set: function(f) {
          if (this._ontrack) {
            this.removeEventListener('track', this._ontrack);
            this.removeEventListener('addstream', this._ontrackpoly);
          }
          this.addEventListener('track', this._ontrack = f);
          this.addEventListener('addstream', this._ontrackpoly = function(e) {
            e.stream.getTracks().forEach(function(track) {
              var event = new Event('track');
              event.track = track;
              event.receiver = {track: track};
              event.transceiver = {receiver: event.receiver};
              event.streams = [e.stream];
              this.dispatchEvent(event);
            }.bind(this));
          }.bind(this));
        },
        enumerable: true,
        configurable: true
      });
    }
    if (typeof window === 'object' && window.RTCTrackEvent &&
        ('receiver' in window.RTCTrackEvent.prototype) &&
        !('transceiver' in window.RTCTrackEvent.prototype)) {
      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {
        get: function() {
          return {receiver: this.receiver};
        }
      });
    }
  },

  shimSourceObject: function(window) {
    // Firefox has supported mozSrcObject since FF22, unprefixed in 42.
    if (typeof window === 'object') {
      if (window.HTMLMediaElement &&
        !('srcObject' in window.HTMLMediaElement.prototype)) {
        // Shim the srcObject property, once, when HTMLMediaElement is found.
        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {
          get: function() {
            return this.mozSrcObject;
          },
          set: function(stream) {
            this.mozSrcObject = stream;
          }
        });
      }
    }
  },

  shimPeerConnection: function(window) {
    var browserDetails = utils.detectBrowser(window);

    if (typeof window !== 'object' || !(window.RTCPeerConnection ||
        window.mozRTCPeerConnection)) {
      return; // probably media.peerconnection.enabled=false in about:config
    }
    // The RTCPeerConnection object.
    if (!window.RTCPeerConnection) {
      window.RTCPeerConnection = function(pcConfig, pcConstraints) {
        if (browserDetails.version < 38) {
          // .urls is not supported in FF < 38.
          // create RTCIceServers with a single url.
          if (pcConfig && pcConfig.iceServers) {
            var newIceServers = [];
            for (var i = 0; i < pcConfig.iceServers.length; i++) {
              var server = pcConfig.iceServers[i];
              if (server.hasOwnProperty('urls')) {
                for (var j = 0; j < server.urls.length; j++) {
                  var newServer = {
                    url: server.urls[j]
                  };
                  if (server.urls[j].indexOf('turn') === 0) {
                    newServer.username = server.username;
                    newServer.credential = server.credential;
                  }
                  newIceServers.push(newServer);
                }
              } else {
                newIceServers.push(pcConfig.iceServers[i]);
              }
            }
            pcConfig.iceServers = newIceServers;
          }
        }
        return new window.mozRTCPeerConnection(pcConfig, pcConstraints);
      };
      window.RTCPeerConnection.prototype =
          window.mozRTCPeerConnection.prototype;

      // wrap static methods. Currently just generateCertificate.
      if (window.mozRTCPeerConnection.generateCertificate) {
        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {
          get: function() {
            return window.mozRTCPeerConnection.generateCertificate;
          }
        });
      }

      window.RTCSessionDescription = window.mozRTCSessionDescription;
      window.RTCIceCandidate = window.mozRTCIceCandidate;
    }

    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.
    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']
        .forEach(function(method) {
          var nativeMethod = window.RTCPeerConnection.prototype[method];
          window.RTCPeerConnection.prototype[method] = function() {
            arguments[0] = new ((method === 'addIceCandidate') ?
                window.RTCIceCandidate :
                window.RTCSessionDescription)(arguments[0]);
            return nativeMethod.apply(this, arguments);
          };
        });

    // support for addIceCandidate(null or undefined)
    var nativeAddIceCandidate =
        window.RTCPeerConnection.prototype.addIceCandidate;
    window.RTCPeerConnection.prototype.addIceCandidate = function() {
      if (!arguments[0]) {
        if (arguments[1]) {
          arguments[1].apply(null);
        }
        return Promise.resolve();
      }
      return nativeAddIceCandidate.apply(this, arguments);
    };

    // shim getStats with maplike support
    var makeMapStats = function(stats) {
      var map = new Map();
      Object.keys(stats).forEach(function(key) {
        map.set(key, stats[key]);
        map[key] = stats[key];
      });
      return map;
    };

    var modernStatsTypes = {
      inboundrtp: 'inbound-rtp',
      outboundrtp: 'outbound-rtp',
      candidatepair: 'candidate-pair',
      localcandidate: 'local-candidate',
      remotecandidate: 'remote-candidate'
    };

    var nativeGetStats = window.RTCPeerConnection.prototype.getStats;
    window.RTCPeerConnection.prototype.getStats = function(
      selector,
      onSucc,
      onErr
    ) {
      return nativeGetStats.apply(this, [selector || null])
        .then(function(stats) {
          if (browserDetails.version < 48) {
            stats = makeMapStats(stats);
          }
          if (browserDetails.version < 53 && !onSucc) {
            // Shim only promise getStats with spec-hyphens in type names
            // Leave callback version alone; misc old uses of forEach before Map
            try {
              stats.forEach(function(stat) {
                stat.type = modernStatsTypes[stat.type] || stat.type;
              });
            } catch (e) {
              if (e.name !== 'TypeError') {
                throw e;
              }
              // Avoid TypeError: "type" is read-only, in old versions. 34-43ish
              stats.forEach(function(stat, i) {
                stats.set(i, Object.assign({}, stat, {
                  type: modernStatsTypes[stat.type] || stat.type
                }));
              });
            }
          }
          return stats;
        })
        .then(onSucc, onErr);
    };
  },

  shimSenderGetStats: function(window) {
    if (!(typeof window === 'object' && window.RTCPeerConnection &&
        window.RTCRtpSender)) {
      return;
    }
    if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {
      return;
    }
    var origGetSenders = window.RTCPeerConnection.prototype.getSenders;
    if (origGetSenders) {
      window.RTCPeerConnection.prototype.getSenders = function() {
        var pc = this;
        var senders = origGetSenders.apply(pc, []);
        senders.forEach(function(sender) {
          sender._pc = pc;
        });
        return senders;
      };
    }

    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;
    if (origAddTrack) {
      window.RTCPeerConnection.prototype.addTrack = function() {
        var sender = origAddTrack.apply(this, arguments);
        sender._pc = this;
        return sender;
      };
    }
    window.RTCRtpSender.prototype.getStats = function() {
      return this.track ? this._pc.getStats(this.track) :
          Promise.resolve(new Map());
    };
  },

  shimReceiverGetStats: function(window) {
    if (!(typeof window === 'object' && window.RTCPeerConnection &&
        window.RTCRtpSender)) {
      return;
    }
    if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {
      return;
    }
    var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;
    if (origGetReceivers) {
      window.RTCPeerConnection.prototype.getReceivers = function() {
        var pc = this;
        var receivers = origGetReceivers.apply(pc, []);
        receivers.forEach(function(receiver) {
          receiver._pc = pc;
        });
        return receivers;
      };
    }
    utils.wrapPeerConnectionEvent(window, 'track', function(e) {
      e.receiver._pc = e.srcElement;
      return e;
    });
    window.RTCRtpReceiver.prototype.getStats = function() {
      return this._pc.getStats(this.track);
    };
  },

  shimRemoveStream: function(window) {
    if (!window.RTCPeerConnection ||
        'removeStream' in window.RTCPeerConnection.prototype) {
      return;
    }
    window.RTCPeerConnection.prototype.removeStream = function(stream) {
      var pc = this;
      utils.deprecated('removeStream', 'removeTrack');
      this.getSenders().forEach(function(sender) {
        if (sender.track && stream.getTracks().indexOf(sender.track) !== -1) {
          pc.removeTrack(sender);
        }
      });
    };
  },

  shimRTCDataChannel: function(window) {
    // rename DataChannel to RTCDataChannel (native fix in FF60):
    // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851
    if (window.DataChannel && !window.RTCDataChannel) {
      window.RTCDataChannel = window.DataChannel;
    }
  },

  shimGetDisplayMedia: function(window, preferredMediaSource) {
    if (!window.navigator || !window.navigator.mediaDevices ||
        'getDisplayMedia' in window.navigator.mediaDevices) {
      return;
    }
    window.navigator.mediaDevices.getDisplayMedia = function(constraints) {
      if (!(constraints && constraints.video)) {
        var err = new DOMException('getDisplayMedia without video ' +
            'constraints is undefined');
        err.name = 'NotFoundError';
        // from https://heycam.github.io/webidl/#idl-DOMException-error-names
        err.code = 8;
        return Promise.reject(err);
      }
      if (constraints.video === true) {
        constraints.video = {mediaSource: preferredMediaSource};
      } else {
        constraints.video.mediaSource = preferredMediaSource;
      }
      return window.navigator.mediaDevices.getUserMedia(constraints);
    };
    window.navigator.getDisplayMedia = function(constraints) {
      utils.deprecated('navigator.getDisplayMedia',
          'navigator.mediaDevices.getDisplayMedia');
      return window.navigator.mediaDevices.getDisplayMedia(constraints);
    };
  }
};

},{"../utils":133,"./getusermedia":131}],131:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var utils = require('../utils');
var logging = utils.log;

// Expose public methods.
module.exports = function(window) {
  var browserDetails = utils.detectBrowser(window);
  var navigator = window && window.navigator;
  var MediaStreamTrack = window && window.MediaStreamTrack;

  var shimError_ = function(e) {
    return {
      name: {
        InternalError: 'NotReadableError',
        NotSupportedError: 'TypeError',
        PermissionDeniedError: 'NotAllowedError',
        SecurityError: 'NotAllowedError'
      }[e.name] || e.name,
      message: {
        'The operation is insecure.': 'The request is not allowed by the ' +
        'user agent or the platform in the current context.'
      }[e.message] || e.message,
      constraint: e.constraint,
      toString: function() {
        return this.name + (this.message && ': ') + this.message;
      }
    };
  };

  // getUserMedia constraints shim.
  var getUserMedia_ = function(constraints, onSuccess, onError) {
    var constraintsToFF37_ = function(c) {
      if (typeof c !== 'object' || c.require) {
        return c;
      }
      var require = [];
      Object.keys(c).forEach(function(key) {
        if (key === 'require' || key === 'advanced' || key === 'mediaSource') {
          return;
        }
        var r = c[key] = (typeof c[key] === 'object') ?
            c[key] : {ideal: c[key]};
        if (r.min !== undefined ||
            r.max !== undefined || r.exact !== undefined) {
          require.push(key);
        }
        if (r.exact !== undefined) {
          if (typeof r.exact === 'number') {
            r. min = r.max = r.exact;
          } else {
            c[key] = r.exact;
          }
          delete r.exact;
        }
        if (r.ideal !== undefined) {
          c.advanced = c.advanced || [];
          var oc = {};
          if (typeof r.ideal === 'number') {
            oc[key] = {min: r.ideal, max: r.ideal};
          } else {
            oc[key] = r.ideal;
          }
          c.advanced.push(oc);
          delete r.ideal;
          if (!Object.keys(r).length) {
            delete c[key];
          }
        }
      });
      if (require.length) {
        c.require = require;
      }
      return c;
    };
    constraints = JSON.parse(JSON.stringify(constraints));
    if (browserDetails.version < 38) {
      logging('spec: ' + JSON.stringify(constraints));
      if (constraints.audio) {
        constraints.audio = constraintsToFF37_(constraints.audio);
      }
      if (constraints.video) {
        constraints.video = constraintsToFF37_(constraints.video);
      }
      logging('ff37: ' + JSON.stringify(constraints));
    }
    return navigator.mozGetUserMedia(constraints, onSuccess, function(e) {
      onError(shimError_(e));
    });
  };

  // Returns the result of getUserMedia as a Promise.
  var getUserMediaPromise_ = function(constraints) {
    return new Promise(function(resolve, reject) {
      getUserMedia_(constraints, resolve, reject);
    });
  };

  // Shim for mediaDevices on older versions.
  if (!navigator.mediaDevices) {
    navigator.mediaDevices = {getUserMedia: getUserMediaPromise_,
      addEventListener: function() { },
      removeEventListener: function() { }
    };
  }
  navigator.mediaDevices.enumerateDevices =
      navigator.mediaDevices.enumerateDevices || function() {
        return new Promise(function(resolve) {
          var infos = [
            {kind: 'audioinput', deviceId: 'default', label: '', groupId: ''},
            {kind: 'videoinput', deviceId: 'default', label: '', groupId: ''}
          ];
          resolve(infos);
        });
      };

  if (browserDetails.version < 41) {
    // Work around http://bugzil.la/1169665
    var orgEnumerateDevices =
        navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);
    navigator.mediaDevices.enumerateDevices = function() {
      return orgEnumerateDevices().then(undefined, function(e) {
        if (e.name === 'NotFoundError') {
          return [];
        }
        throw e;
      });
    };
  }
  if (browserDetails.version < 49) {
    var origGetUserMedia = navigator.mediaDevices.getUserMedia.
        bind(navigator.mediaDevices);
    navigator.mediaDevices.getUserMedia = function(c) {
      return origGetUserMedia(c).then(function(stream) {
        // Work around https://bugzil.la/802326
        if (c.audio && !stream.getAudioTracks().length ||
            c.video && !stream.getVideoTracks().length) {
          stream.getTracks().forEach(function(track) {
            track.stop();
          });
          throw new DOMException('The object can not be found here.',
                                 'NotFoundError');
        }
        return stream;
      }, function(e) {
        return Promise.reject(shimError_(e));
      });
    };
  }
  if (!(browserDetails.version > 55 &&
      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {
    var remap = function(obj, a, b) {
      if (a in obj && !(b in obj)) {
        obj[b] = obj[a];
        delete obj[a];
      }
    };

    var nativeGetUserMedia = navigator.mediaDevices.getUserMedia.
        bind(navigator.mediaDevices);
    navigator.mediaDevices.getUserMedia = function(c) {
      if (typeof c === 'object' && typeof c.audio === 'object') {
        c = JSON.parse(JSON.stringify(c));
        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');
        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');
      }
      return nativeGetUserMedia(c);
    };

    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {
      var nativeGetSettings = MediaStreamTrack.prototype.getSettings;
      MediaStreamTrack.prototype.getSettings = function() {
        var obj = nativeGetSettings.apply(this, arguments);
        remap(obj, 'mozAutoGainControl', 'autoGainControl');
        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');
        return obj;
      };
    }

    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {
      var nativeApplyConstraints = MediaStreamTrack.prototype.applyConstraints;
      MediaStreamTrack.prototype.applyConstraints = function(c) {
        if (this.kind === 'audio' && typeof c === 'object') {
          c = JSON.parse(JSON.stringify(c));
          remap(c, 'autoGainControl', 'mozAutoGainControl');
          remap(c, 'noiseSuppression', 'mozNoiseSuppression');
        }
        return nativeApplyConstraints.apply(this, [c]);
      };
    }
  }
  navigator.getUserMedia = function(constraints, onSuccess, onError) {
    if (browserDetails.version < 44) {
      return getUserMedia_(constraints, onSuccess, onError);
    }
    // Replace Firefox 44+'s deprecation warning with unprefixed version.
    utils.deprecated('navigator.getUserMedia',
        'navigator.mediaDevices.getUserMedia');
    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);
  };
};

},{"../utils":133}],132:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
'use strict';
var utils = require('../utils');

module.exports = {
  shimLocalStreamsAPI: function(window) {
    if (typeof window !== 'object' || !window.RTCPeerConnection) {
      return;
    }
    if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {
      window.RTCPeerConnection.prototype.getLocalStreams = function() {
        if (!this._localStreams) {
          this._localStreams = [];
        }
        return this._localStreams;
      };
    }
    if (!('getStreamById' in window.RTCPeerConnection.prototype)) {
      window.RTCPeerConnection.prototype.getStreamById = function(id) {
        var result = null;
        if (this._localStreams) {
          this._localStreams.forEach(function(stream) {
            if (stream.id === id) {
              result = stream;
            }
          });
        }
        if (this._remoteStreams) {
          this._remoteStreams.forEach(function(stream) {
            if (stream.id === id) {
              result = stream;
            }
          });
        }
        return result;
      };
    }
    if (!('addStream' in window.RTCPeerConnection.prototype)) {
      var _addTrack = window.RTCPeerConnection.prototype.addTrack;
      window.RTCPeerConnection.prototype.addStream = function(stream) {
        if (!this._localStreams) {
          this._localStreams = [];
        }
        if (this._localStreams.indexOf(stream) === -1) {
          this._localStreams.push(stream);
        }
        var pc = this;
        stream.getTracks().forEach(function(track) {
          _addTrack.call(pc, track, stream);
        });
      };

      window.RTCPeerConnection.prototype.addTrack = function(track, stream) {
        if (stream) {
          if (!this._localStreams) {
            this._localStreams = [stream];
          } else if (this._localStreams.indexOf(stream) === -1) {
            this._localStreams.push(stream);
          }
        }
        return _addTrack.call(this, track, stream);
      };
    }
    if (!('removeStream' in window.RTCPeerConnection.prototype)) {
      window.RTCPeerConnection.prototype.removeStream = function(stream) {
        if (!this._localStreams) {
          this._localStreams = [];
        }
        var index = this._localStreams.indexOf(stream);
        if (index === -1) {
          return;
        }
        this._localStreams.splice(index, 1);
        var pc = this;
        var tracks = stream.getTracks();
        this.getSenders().forEach(function(sender) {
          if (tracks.indexOf(sender.track) !== -1) {
            pc.removeTrack(sender);
          }
        });
      };
    }
  },
  shimRemoteStreamsAPI: function(window) {
    if (typeof window !== 'object' || !window.RTCPeerConnection) {
      return;
    }
    if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {
      window.RTCPeerConnection.prototype.getRemoteStreams = function() {
        return this._remoteStreams ? this._remoteStreams : [];
      };
    }
    if (!('onaddstream' in window.RTCPeerConnection.prototype)) {
      Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {
        get: function() {
          return this._onaddstream;
        },
        set: function(f) {
          if (this._onaddstream) {
            this.removeEventListener('addstream', this._onaddstream);
          }
          this.addEventListener('addstream', this._onaddstream = f);
        }
      });
      var origSetRemoteDescription =
          window.RTCPeerConnection.prototype.setRemoteDescription;
      window.RTCPeerConnection.prototype.setRemoteDescription = function() {
        var pc = this;
        if (!this._onaddstreampoly) {
          this.addEventListener('track', this._onaddstreampoly = function(e) {
            e.streams.forEach(function(stream) {
              if (!pc._remoteStreams) {
                pc._remoteStreams = [];
              }
              if (pc._remoteStreams.indexOf(stream) >= 0) {
                return;
              }
              pc._remoteStreams.push(stream);
              var event = new Event('addstream');
              event.stream = stream;
              pc.dispatchEvent(event);
            });
          });
        }
        return origSetRemoteDescription.apply(pc, arguments);
      };
    }
  },
  shimCallbacksAPI: function(window) {
    if (typeof window !== 'object' || !window.RTCPeerConnection) {
      return;
    }
    var prototype = window.RTCPeerConnection.prototype;
    var createOffer = prototype.createOffer;
    var createAnswer = prototype.createAnswer;
    var setLocalDescription = prototype.setLocalDescription;
    var setRemoteDescription = prototype.setRemoteDescription;
    var addIceCandidate = prototype.addIceCandidate;

    prototype.createOffer = function(successCallback, failureCallback) {
      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];
      var promise = createOffer.apply(this, [options]);
      if (!failureCallback) {
        return promise;
      }
      promise.then(successCallback, failureCallback);
      return Promise.resolve();
    };

    prototype.createAnswer = function(successCallback, failureCallback) {
      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];
      var promise = createAnswer.apply(this, [options]);
      if (!failureCallback) {
        return promise;
      }
      promise.then(successCallback, failureCallback);
      return Promise.resolve();
    };

    var withCallback = function(description, successCallback, failureCallback) {
      var promise = setLocalDescription.apply(this, [description]);
      if (!failureCallback) {
        return promise;
      }
      promise.then(successCallback, failureCallback);
      return Promise.resolve();
    };
    prototype.setLocalDescription = withCallback;

    withCallback = function(description, successCallback, failureCallback) {
      var promise = setRemoteDescription.apply(this, [description]);
      if (!failureCallback) {
        return promise;
      }
      promise.then(successCallback, failureCallback);
      return Promise.resolve();
    };
    prototype.setRemoteDescription = withCallback;

    withCallback = function(candidate, successCallback, failureCallback) {
      var promise = addIceCandidate.apply(this, [candidate]);
      if (!failureCallback) {
        return promise;
      }
      promise.then(successCallback, failureCallback);
      return Promise.resolve();
    };
    prototype.addIceCandidate = withCallback;
  },
  shimGetUserMedia: function(window) {
    var navigator = window && window.navigator;

    if (!navigator.getUserMedia) {
      if (navigator.webkitGetUserMedia) {
        navigator.getUserMedia = navigator.webkitGetUserMedia.bind(navigator);
      } else if (navigator.mediaDevices &&
          navigator.mediaDevices.getUserMedia) {
        navigator.getUserMedia = function(constraints, cb, errcb) {
          navigator.mediaDevices.getUserMedia(constraints)
          .then(cb, errcb);
        }.bind(navigator);
      }
    }
  },
  shimRTCIceServerUrls: function(window) {
    // migrate from non-spec RTCIceServer.url to RTCIceServer.urls
    var OrigPeerConnection = window.RTCPeerConnection;
    window.RTCPeerConnection = function(pcConfig, pcConstraints) {
      if (pcConfig && pcConfig.iceServers) {
        var newIceServers = [];
        for (var i = 0; i < pcConfig.iceServers.length; i++) {
          var server = pcConfig.iceServers[i];
          if (!server.hasOwnProperty('urls') &&
              server.hasOwnProperty('url')) {
            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');
            server = JSON.parse(JSON.stringify(server));
            server.urls = server.url;
            delete server.url;
            newIceServers.push(server);
          } else {
            newIceServers.push(pcConfig.iceServers[i]);
          }
        }
        pcConfig.iceServers = newIceServers;
      }
      return new OrigPeerConnection(pcConfig, pcConstraints);
    };
    window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;
    // wrap static methods. Currently just generateCertificate.
    if ('generateCertificate' in window.RTCPeerConnection) {
      Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {
        get: function() {
          return OrigPeerConnection.generateCertificate;
        }
      });
    }
  },
  shimTrackEventTransceiver: function(window) {
    // Add event.transceiver member over deprecated event.receiver
    if (typeof window === 'object' && window.RTCPeerConnection &&
        ('receiver' in window.RTCTrackEvent.prototype) &&
        // can't check 'transceiver' in window.RTCTrackEvent.prototype, as it is
        // defined for some reason even when window.RTCTransceiver is not.
        !window.RTCTransceiver) {
      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {
        get: function() {
          return {receiver: this.receiver};
        }
      });
    }
  },

  shimCreateOfferLegacy: function(window) {
    var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;
    window.RTCPeerConnection.prototype.createOffer = function(offerOptions) {
      var pc = this;
      if (offerOptions) {
        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {
          // support bit values
          offerOptions.offerToReceiveAudio = !!offerOptions.offerToReceiveAudio;
        }
        var audioTransceiver = pc.getTransceivers().find(function(transceiver) {
          return transceiver.sender.track &&
              transceiver.sender.track.kind === 'audio';
        });
        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {
          if (audioTransceiver.direction === 'sendrecv') {
            if (audioTransceiver.setDirection) {
              audioTransceiver.setDirection('sendonly');
            } else {
              audioTransceiver.direction = 'sendonly';
            }
          } else if (audioTransceiver.direction === 'recvonly') {
            if (audioTransceiver.setDirection) {
              audioTransceiver.setDirection('inactive');
            } else {
              audioTransceiver.direction = 'inactive';
            }
          }
        } else if (offerOptions.offerToReceiveAudio === true &&
            !audioTransceiver) {
          pc.addTransceiver('audio');
        }


        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {
          // support bit values
          offerOptions.offerToReceiveVideo = !!offerOptions.offerToReceiveVideo;
        }
        var videoTransceiver = pc.getTransceivers().find(function(transceiver) {
          return transceiver.sender.track &&
              transceiver.sender.track.kind === 'video';
        });
        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {
          if (videoTransceiver.direction === 'sendrecv') {
            videoTransceiver.setDirection('sendonly');
          } else if (videoTransceiver.direction === 'recvonly') {
            videoTransceiver.setDirection('inactive');
          }
        } else if (offerOptions.offerToReceiveVideo === true &&
            !videoTransceiver) {
          pc.addTransceiver('video');
        }
      }
      return origCreateOffer.apply(pc, arguments);
    };
  }
};

},{"../utils":133}],133:[function(require,module,exports){
/*
 *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
 */
 /* eslint-env node */
'use strict';

var logDisabled_ = true;
var deprecationWarnings_ = true;

/**
 * Extract browser version out of the provided user agent string.
 *
 * @param {!string} uastring userAgent string.
 * @param {!string} expr Regular expression used as match criteria.
 * @param {!number} pos position in the version string to be returned.
 * @return {!number} browser version.
 */
function extractVersion(uastring, expr, pos) {
  var match = uastring.match(expr);
  return match && match.length >= pos && parseInt(match[pos], 10);
}

// Wraps the peerconnection event eventNameToWrap in a function
// which returns the modified event object (or false to prevent
// the event).
function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {
  if (!window.RTCPeerConnection) {
    return;
  }
  var proto = window.RTCPeerConnection.prototype;
  var nativeAddEventListener = proto.addEventListener;
  proto.addEventListener = function(nativeEventName, cb) {
    if (nativeEventName !== eventNameToWrap) {
      return nativeAddEventListener.apply(this, arguments);
    }
    var wrappedCallback = function(e) {
      var modifiedEvent = wrapper(e);
      if (modifiedEvent) {
        cb(modifiedEvent);
      }
    };
    this._eventMap = this._eventMap || {};
    this._eventMap[cb] = wrappedCallback;
    return nativeAddEventListener.apply(this, [nativeEventName,
      wrappedCallback]);
  };

  var nativeRemoveEventListener = proto.removeEventListener;
  proto.removeEventListener = function(nativeEventName, cb) {
    if (nativeEventName !== eventNameToWrap || !this._eventMap
        || !this._eventMap[cb]) {
      return nativeRemoveEventListener.apply(this, arguments);
    }
    var unwrappedCb = this._eventMap[cb];
    delete this._eventMap[cb];
    return nativeRemoveEventListener.apply(this, [nativeEventName,
      unwrappedCb]);
  };

  Object.defineProperty(proto, 'on' + eventNameToWrap, {
    get: function() {
      return this['_on' + eventNameToWrap];
    },
    set: function(cb) {
      if (this['_on' + eventNameToWrap]) {
        this.removeEventListener(eventNameToWrap,
            this['_on' + eventNameToWrap]);
        delete this['_on' + eventNameToWrap];
      }
      if (cb) {
        this.addEventListener(eventNameToWrap,
            this['_on' + eventNameToWrap] = cb);
      }
    },
    enumerable: true,
    configurable: true
  });
}

// Utility methods.
module.exports = {
  extractVersion: extractVersion,
  wrapPeerConnectionEvent: wrapPeerConnectionEvent,
  disableLog: function(bool) {
    if (typeof bool !== 'boolean') {
      return new Error('Argument type: ' + typeof bool +
          '. Please use a boolean.');
    }
    logDisabled_ = bool;
    return (bool) ? 'adapter.js logging disabled' :
        'adapter.js logging enabled';
  },

  /**
   * Disable or enable deprecation warnings
   * @param {!boolean} bool set to true to disable warnings.
   */
  disableWarnings: function(bool) {
    if (typeof bool !== 'boolean') {
      return new Error('Argument type: ' + typeof bool +
          '. Please use a boolean.');
    }
    deprecationWarnings_ = !bool;
    return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');
  },

  log: function() {
    if (typeof window === 'object') {
      if (logDisabled_) {
        return;
      }
      if (typeof console !== 'undefined' && typeof console.log === 'function') {
        console.log.apply(console, arguments);
      }
    }
  },

  /**
   * Shows a deprecation warning suggesting the modern and spec-compatible API.
   */
  deprecated: function(oldMethod, newMethod) {
    if (!deprecationWarnings_) {
      return;
    }
    console.warn(oldMethod + ' is deprecated, please use ' + newMethod +
        ' instead.');
  },

  /**
   * Browser detector.
   *
   * @return {object} result containing browser and version
   *     properties.
   */
  detectBrowser: function(window) {
    var navigator = window && window.navigator;

    // Returned result object.
    var result = {};
    result.browser = null;
    result.version = null;

    // Fail early if it's not a browser
    if (typeof window === 'undefined' || !window.navigator) {
      result.browser = 'Not a browser.';
      return result;
    }

    if (navigator.mozGetUserMedia) { // Firefox.
      result.browser = 'firefox';
      result.version = extractVersion(navigator.userAgent,
          /Firefox\/(\d+)\./, 1);
    } else if (navigator.webkitGetUserMedia) {
      // Chrome, Chromium, Webview, Opera.
      // Version matches Chrome/WebRTC version.
      result.browser = 'chrome';
      result.version = extractVersion(navigator.userAgent,
          /Chrom(e|ium)\/(\d+)\./, 2);
    } else if (navigator.mediaDevices &&
        navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)) { // Edge.
      result.browser = 'edge';
      result.version = extractVersion(navigator.userAgent,
          /Edge\/(\d+).(\d+)$/, 2);
    } else if (window.RTCPeerConnection &&
        navigator.userAgent.match(/AppleWebKit\/(\d+)\./)) { // Safari.
      result.browser = 'safari';
      result.version = extractVersion(navigator.userAgent,
          /AppleWebKit\/(\d+)\./, 1);
    } else { // Default fallthrough: not supported.
      result.browser = 'Not a supported browser.';
      return result;
    }

    return result;
  }
};

},{}],134:[function(require,module,exports){
(function (global){(function (){
'use strict';

require('webrtc-adapter');

var _rtc_session = require('./rtc_session');

var _rtc_session2 = _interopRequireDefault(_rtc_session);

var _rtc_const = require('./rtc_const');

var _rtc_peer_connection_factory = require('./rtc_peer_connection_factory');

var _rtc_peer_connection_factory2 = _interopRequireDefault(_rtc_peer_connection_factory);

var _v = require('uuid/v4');

var _v2 = _interopRequireDefault(_v);

var _StandardStrategy = require('./strategies/StandardStrategy');

var _StandardStrategy2 = _interopRequireDefault(_StandardStrategy);

var _CitrixVDIStrategy = require('./strategies/CitrixVDIStrategy');

var _CitrixVDIStrategy2 = _interopRequireDefault(_CitrixVDIStrategy);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * @license
 * License info for uuid module assembled into js bundle:
 *
 * The MIT License (MIT)
 *
 * Copyright (c) 2010-2016 Robert Kieffer and other contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
global.connect = global.connect || {}; /**
                                        * @license
                                        * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
                                        *
                                        * SPDX-License-Identifier: Apache-2.0
                                        */
/**
 * @license
 * License info for webrtc-adapter module assembled into js bundle:
 *
 * Copyright (c) 2014, The WebRTC project authors. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 *
 * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 *
 * Neither the name of Google nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
/**
 * @license
 * License info for sdp module assembled into js bundle:
 *
 * See https://www.npmjs.com/package/sdp
 */

global.connect.RTCSession = _rtc_session2.default;
global.connect.RTCErrors = _rtc_const.RTC_ERRORS;
global.connect.RtcPeerConnectionFactory = _rtc_peer_connection_factory2.default;
global.connect.uuid = _v2.default;
global.connect.StandardStrategy = _StandardStrategy2.default;
global.connect.CitrixVDIStrategy = _CitrixVDIStrategy2.default;

global.lily = global.lily || {};
global.lily.RTCSession = _rtc_session2.default;
global.lily.RTCErrors = _rtc_const.RTC_ERRORS;

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./rtc_const":136,"./rtc_peer_connection_factory":137,"./rtc_session":138,"./strategies/CitrixVDIStrategy":143,"./strategies/StandardStrategy":144,"uuid/v4":121,"webrtc-adapter":122}],135:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.UnknownSignalingError = exports.UnknownSignalingErrorName = exports.CallNotFoundException = exports.CallNotFoundExceptionName = exports.BusyException = exports.BusyExceptionName = exports.UnsupportedOperation = exports.UnsupportedOperationExceptionName = exports.IllegalState = exports.IllegalStateExceptionName = exports.IllegalParameters = exports.IllegalParametersExceptionName = exports.GumTimeout = exports.GumTimeoutExceptionName = exports.Timeout = exports.TimeoutExceptionName = undefined;

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */
var TimeoutExceptionName = exports.TimeoutExceptionName = 'Timeout';

var Timeout = exports.Timeout = function (_Error) {
    (0, _inherits3.default)(Timeout, _Error);

    function Timeout(msg) {
        (0, _classCallCheck3.default)(this, Timeout);

        var _this = (0, _possibleConstructorReturn3.default)(this, (Timeout.__proto__ || Object.getPrototypeOf(Timeout)).call(this, msg));

        _this.name = TimeoutExceptionName;
        return _this;
    }

    return Timeout;
}(Error);

var GumTimeoutExceptionName = exports.GumTimeoutExceptionName = 'GumTimeout';

var GumTimeout = exports.GumTimeout = function (_Timeout) {
    (0, _inherits3.default)(GumTimeout, _Timeout);

    function GumTimeout(msg) {
        (0, _classCallCheck3.default)(this, GumTimeout);

        var _this2 = (0, _possibleConstructorReturn3.default)(this, (GumTimeout.__proto__ || Object.getPrototypeOf(GumTimeout)).call(this, msg));

        _this2.name = GumTimeoutExceptionName;
        return _this2;
    }

    return GumTimeout;
}(Timeout);

var IllegalParametersExceptionName = exports.IllegalParametersExceptionName = 'IllegalParameters';

var IllegalParameters = exports.IllegalParameters = function (_Error2) {
    (0, _inherits3.default)(IllegalParameters, _Error2);

    function IllegalParameters(msg) {
        (0, _classCallCheck3.default)(this, IllegalParameters);

        var _this3 = (0, _possibleConstructorReturn3.default)(this, (IllegalParameters.__proto__ || Object.getPrototypeOf(IllegalParameters)).call(this, msg));

        _this3.name = IllegalParametersExceptionName;
        return _this3;
    }

    return IllegalParameters;
}(Error);

var IllegalStateExceptionName = exports.IllegalStateExceptionName = 'IllegalState';

var IllegalState = exports.IllegalState = function (_Error3) {
    (0, _inherits3.default)(IllegalState, _Error3);

    function IllegalState(msg) {
        (0, _classCallCheck3.default)(this, IllegalState);

        var _this4 = (0, _possibleConstructorReturn3.default)(this, (IllegalState.__proto__ || Object.getPrototypeOf(IllegalState)).call(this, msg));

        _this4.name = IllegalStateExceptionName;
        return _this4;
    }

    return IllegalState;
}(Error);

var UnsupportedOperationExceptionName = exports.UnsupportedOperationExceptionName = 'UnsupportedOperation';

var UnsupportedOperation = exports.UnsupportedOperation = function (_Error4) {
    (0, _inherits3.default)(UnsupportedOperation, _Error4);

    function UnsupportedOperation(msg) {
        (0, _classCallCheck3.default)(this, UnsupportedOperation);

        var _this5 = (0, _possibleConstructorReturn3.default)(this, (UnsupportedOperation.__proto__ || Object.getPrototypeOf(UnsupportedOperation)).call(this, msg));

        _this5.name = UnsupportedOperationExceptionName;
        return _this5;
    }

    return UnsupportedOperation;
}(Error);

var BusyExceptionName = exports.BusyExceptionName = 'BusyException';

var BusyException = exports.BusyException = function (_Error5) {
    (0, _inherits3.default)(BusyException, _Error5);

    function BusyException(msg) {
        (0, _classCallCheck3.default)(this, BusyException);

        var _this6 = (0, _possibleConstructorReturn3.default)(this, (BusyException.__proto__ || Object.getPrototypeOf(BusyException)).call(this, msg));

        _this6.name = BusyExceptionName;
        return _this6;
    }

    return BusyException;
}(Error);

var CallNotFoundExceptionName = exports.CallNotFoundExceptionName = 'CallNotFoundException';

var CallNotFoundException = exports.CallNotFoundException = function (_Error6) {
    (0, _inherits3.default)(CallNotFoundException, _Error6);

    function CallNotFoundException(msg) {
        (0, _classCallCheck3.default)(this, CallNotFoundException);

        var _this7 = (0, _possibleConstructorReturn3.default)(this, (CallNotFoundException.__proto__ || Object.getPrototypeOf(CallNotFoundException)).call(this, msg));

        _this7.name = CallNotFoundExceptionName;
        return _this7;
    }

    return CallNotFoundException;
}(Error);

var UnknownSignalingErrorName = exports.UnknownSignalingErrorName = 'UnknownSignalingError';

var UnknownSignalingError = exports.UnknownSignalingError = function (_Error7) {
    (0, _inherits3.default)(UnknownSignalingError, _Error7);

    function UnknownSignalingError() {
        (0, _classCallCheck3.default)(this, UnknownSignalingError);

        var _this8 = (0, _possibleConstructorReturn3.default)(this, (UnknownSignalingError.__proto__ || Object.getPrototypeOf(UnknownSignalingError)).call(this));

        _this8.name = UnknownSignalingErrorName;
        return _this8;
    }

    return UnknownSignalingError;
}(Error);

},{"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/inherits":14,"babel-runtime/helpers/possibleConstructorReturn":15}],136:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});
/**
 * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * Timeout waiting for server response to accept/hangup request.
 */
var MAX_ACCEPT_BYE_DELAY_MS = exports.MAX_ACCEPT_BYE_DELAY_MS = 2000;
/**
 * Timeout waiting for server response to invite.
 */
var MAX_INVITE_DELAY_MS = exports.MAX_INVITE_DELAY_MS = 5000;
/**
 *  Default timeout on opening WebSocket connection.
 */
var DEFAULT_CONNECT_TIMEOUT_MS = exports.DEFAULT_CONNECT_TIMEOUT_MS = 10000;
/**
 * Default ice collection timeout in milliseconds.
 */
var DEFAULT_ICE_TIMEOUT_MS = exports.DEFAULT_ICE_TIMEOUT_MS = 8000;
/**
 * Default gum timeout in milliseconds to be enforced during start of a call.
 */
var DEFAULT_GUM_TIMEOUT_MS = exports.DEFAULT_GUM_TIMEOUT_MS = 10000;

var SOFTPHONE_ROUTE_KEY = exports.SOFTPHONE_ROUTE_KEY = "aws/softphone";

var INVITE_METHOD_NAME = exports.INVITE_METHOD_NAME = "invite";
var ACCEPT_METHOD_NAME = exports.ACCEPT_METHOD_NAME = "accept";
var BYE_METHOD_NAME = exports.BYE_METHOD_NAME = "bye";

var RTC_PEER_CONNECTION_CONFIG = exports.RTC_PEER_CONNECTION_CONFIG = {
    iceTransportPolicy: 'relay',
    rtcpMuxPolicy: 'require',
    bundlePolicy: 'balanced',
    sdpSemantics: 'unified-plan',
    enableDtlsSrtp: true
};

var RTC_PEER_CONNECTION_OPTIONAL_CONFIG = exports.RTC_PEER_CONNECTION_OPTIONAL_CONFIG = {
    optional: [{
        googDscp: true

    }, {
        DtlsSrtpKeyAgreement: true
    }]
};

var DEFAULT_ICE_CANDIDATE_POOL_SIZE = exports.DEFAULT_ICE_CANDIDATE_POOL_SIZE = 1;

var RTC_PEER_CONNECTION_IDLE_TIMEOUT_MS = exports.RTC_PEER_CONNECTION_IDLE_TIMEOUT_MS = 1 * 60 * 1000;

var NETWORK_CONNECTIVITY_CHECK_INTERVAL_MS = exports.NETWORK_CONNECTIVITY_CHECK_INTERVAL_MS = 250;

var CHROME_SUPPORTED_VERSION = exports.CHROME_SUPPORTED_VERSION = 59;

/**
 * RTC error names.
 */
var RTC_ERRORS = exports.RTC_ERRORS = {
    ICE_COLLECTION_TIMEOUT: 'Ice Collection Timeout',
    USER_BUSY: 'User Busy',
    SIGNALLING_CONNECTION_FAILURE: 'Signalling Connection Failure',
    SIGNALLING_HANDSHAKE_FAILURE: 'Signalling Handshake Failure',
    SET_REMOTE_DESCRIPTION_FAILURE: 'Set Remote Description Failure',
    CREATE_OFFER_FAILURE: 'Create Offer Failure',
    SET_LOCAL_DESCRIPTION_FAILURE: 'Set Local Description Failure',
    INVALID_REMOTE_SDP: 'Invalid Remote SDP',
    NO_REMOTE_ICE_CANDIDATE: 'No Remote ICE Candidate',
    GUM_TIMEOUT_FAILURE: 'GUM Timeout Failure',
    GUM_OTHER_FAILURE: 'GUM Other Failure',
    CALL_NOT_FOUND: 'Call Not Found'
};

var ICE_CONNECTION_STATE = exports.ICE_CONNECTION_STATE = {
    NEW: 'new',
    CHECKING: 'checking',
    CONNECTED: 'connected',
    COMPLETED: 'completed',
    FAILED: 'failed',
    DISCONNECTED: 'disconnected',
    CLOSED: 'closed'
};

var PEER_CONNECTION_STATE = exports.PEER_CONNECTION_STATE = {
    NEW: 'new',
    CONNECTING: 'connecting',
    CONNECTED: 'connected',
    FAILED: 'failed',
    DISCONNECTED: 'disconnected',
    CLOSED: 'closed'
};

},{}],137:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _utils = require('./utils');

var _rtc_const = require('./rtc_const');

var _CCPInitiationStrategyInterface = require('./strategies/CCPInitiationStrategyInterface');

var _CCPInitiationStrategyInterface2 = _interopRequireDefault(_CCPInitiationStrategyInterface);

var _StandardStrategy = require('./strategies/StandardStrategy');

var _StandardStrategy2 = _interopRequireDefault(_StandardStrategy);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var RtcPeerConnectionFactory = function () {

    //transportHandle must be a callback function which should return a promise which is going to return the iceServers. Please refer https://www.w3.org/TR/webrtc/#rtciceserver-dictionary for iceServer example
    //publishError(errorType, errorMessage) must be a callback function which will publish the passed error message to client browser
    function RtcPeerConnectionFactory(logger, wssManager, clientId, transportHandle, publishError) {
        var strategy = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : new _StandardStrategy2.default();
        (0, _classCallCheck3.default)(this, RtcPeerConnectionFactory);

        if (!(strategy instanceof _CCPInitiationStrategyInterface2.default)) {
            throw new Error('Expected a strategy of type CCPInitiationStrategyInterface');
        }
        (0, _utils.assertTrue)((0, _utils.isFunction)(transportHandle), 'transportHandle must be a function');
        (0, _utils.assertTrue)((0, _utils.isFunction)(publishError), 'publishError must be a function');
        this._strategy = strategy;
        this._logger = logger;
        this._clientId = clientId;
        this._wssManager = wssManager;
        this._requestIceAccess = transportHandle;
        this._publishError = publishError;
        this._earlyMediaConnectionSupported = this._isEarlyMediaConnectionSupported();
        this._initializeWebSocketEventListeners();
        this._requestPeerConnection();
        this._networkConnectivityChecker();

        this._logger.log("RTC.js is using " + strategy.getStrategyName());
    }

    (0, _createClass3.default)(RtcPeerConnectionFactory, [{
        key: '_isEarlyMediaConnectionSupported',
        value: function _isEarlyMediaConnectionSupported() {
            return this._strategy._isEarlyMediaConnectionSupported();
        }

        //This will handle the idleConnection and quota limits notification from the server

    }, {
        key: '_webSocketManagerOnMessage',
        value: function _webSocketManagerOnMessage(event) {
            var content = void 0;
            if (event.content) {
                content = JSON.parse(event.content);
            }
            if (content && this._clientId === content.clientId) {
                if (content.jsonRpcMsg.method === "idleConnection") {
                    this._clearIdleRtcPeerConnection();
                } else if (content.jsonRpcMsg.method === "quotaBreached") {
                    this._logger.log("Number of active sessions are more then allowed limit for the client " + this._clientId);
                    this._closeRTCPeerConnection();
                    this._publishError("multiple_softphone_active_sessions", "Number of active sessions are more then allowed limit.");
                }
            }
        }
    }, {
        key: '_initializeWebSocketEventListeners',
        value: function _initializeWebSocketEventListeners() {
            this._wssManager.subscribeTopics([_rtc_const.SOFTPHONE_ROUTE_KEY]);
            this._unSubscribe = this._wssManager.onMessage(_rtc_const.SOFTPHONE_ROUTE_KEY, (0, _utils.hitch)(this, this._webSocketManagerOnMessage));
        }

        // This method will create and return new peer connection if browser is not supporting early ice collection.
        // For the supported browser, this method will request for new peerConnection after returning the existing peerConnection

    }, {
        key: 'get',
        value: function get(iceServers) {
            var self = this;
            var pc = self._pc;
            self._pc = null;
            if (pc == null) {
                pc = self._createRtcPeerConnection(iceServers);
            }
            self.clearIdleRtcPeerConnectionTimerId();
            self._requestPeerConnection();
            return pc;
        }
    }, {
        key: 'clearIdleRtcPeerConnectionTimerId',
        value: function clearIdleRtcPeerConnectionTimerId() {
            var self = this;
            if (self._idleRtcPeerConnectionTimerId) {
                clearTimeout(self._idleRtcPeerConnectionTimerId);
                self._idleRtcPeerConnectionTimerId = null;
            }
        }
    }, {
        key: '_requestPeerConnection',
        value: function _requestPeerConnection() {
            var self = this;
            if (!self._peerConnectionRequestInFlight && self._earlyMediaConnectionSupported) {
                self._peerConnectionRequestInFlight = true;
                self._requestIceAccess().then(function (response) {
                    self._pc = self._createRtcPeerConnection(response);
                    self._peerConnectionRequestInFlight = false;
                    self._idleRtcPeerConnectionTimerId = setTimeout((0, _utils.hitch)(self, self._refreshRtcPeerConnection), _rtc_const.RTC_PEER_CONNECTION_IDLE_TIMEOUT_MS);
                },
                // eslint-disable-next-line no-unused-vars
                function (reason) {
                    self._peerConnectionRequestInFlight = false;
                });
            }
        }
    }, {
        key: '_networkConnectivityChecker',
        value: function _networkConnectivityChecker() {
            var self = this;
            setInterval(function () {
                if (!navigator.onLine && self._pc) {
                    self._logger.log("Network offline. Cleaning up early connection");
                    self._pc.close();
                    self._pc = null;
                }
            }, _rtc_const.NETWORK_CONNECTIVITY_CHECK_INTERVAL_MS);
        }
    }, {
        key: '_createRtcPeerConnection',
        value: function _createRtcPeerConnection(iceServers) {
            var rtcPeerConnectionConfig = JSON.parse(JSON.stringify(_rtc_const.RTC_PEER_CONNECTION_CONFIG));
            rtcPeerConnectionConfig.iceServers = iceServers;
            rtcPeerConnectionConfig.iceCandidatePoolSize = _rtc_const.DEFAULT_ICE_CANDIDATE_POOL_SIZE;
            return this._strategy._createRtcPeerConnection(rtcPeerConnectionConfig, _rtc_const.RTC_PEER_CONNECTION_OPTIONAL_CONFIG);
        }
    }, {
        key: '_clearIdleRtcPeerConnection',
        value: function _clearIdleRtcPeerConnection() {
            this._logger.log("session is idle from long time. closing the peer connection for client " + this._clientId);
            this._closeRTCPeerConnection();
        }
    }, {
        key: '_refreshRtcPeerConnection',
        value: function _refreshRtcPeerConnection() {
            this._idleRtcPeerConnectionTimerId = null;
            this._clearIdleRtcPeerConnection();
            this._logger.log("refreshing peer connection for client " + this._clientId);
            this._requestPeerConnection();
        }
    }, {
        key: '_closeRTCPeerConnection',
        value: function _closeRTCPeerConnection() {
            if (this._pc) {
                this._pc.close();
                this._pc = null;
            }
        }
    }]);
    return RtcPeerConnectionFactory;
}();

exports.default = RtcPeerConnectionFactory;

},{"./rtc_const":136,"./strategies/CCPInitiationStrategyInterface":142,"./strategies/StandardStrategy":144,"./utils":145,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],138:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.FailedState = exports.DisconnectedState = exports.CleanUpState = exports.TalkingState = exports.AcceptState = exports.InviteAnswerState = exports.ConnectSignalingAndIceCollectionState = exports.SetLocalSessionDescriptionState = exports.CreateOfferState = exports.GrabLocalMediaState = exports.RTCSessionState = undefined;

var _regenerator = require('babel-runtime/regenerator');

var _regenerator2 = _interopRequireDefault(_regenerator);

var _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _typeof2 = require('babel-runtime/helpers/typeof');

var _typeof3 = _interopRequireDefault(_typeof2);

var _get2 = require('babel-runtime/helpers/get');

var _get3 = _interopRequireDefault(_get2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _utils = require('./utils');

var _session_report = require('./session_report');

var _rtc_const = require('./rtc_const');

var _exceptions = require('./exceptions');

var _signaling = require('./signaling');

var _signaling2 = _interopRequireDefault(_signaling);

var _v = require('uuid/v4');

var _v2 = _interopRequireDefault(_v);

var _rtpStats = require('./rtp-stats');

var _sdp = require('sdp');

var _CCPInitiationStrategyInterface = require('./strategies/CCPInitiationStrategyInterface');

var _CCPInitiationStrategyInterface2 = _interopRequireDefault(_CCPInitiationStrategyInterface);

var _StandardStrategy = require('./strategies/StandardStrategy');

var _StandardStrategy2 = _interopRequireDefault(_StandardStrategy);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */
var RTCSessionState = exports.RTCSessionState = function () {
    /**
     *
     * @param {RtcSession} rtcSession
     */
    function RTCSessionState(rtcSession) {
        (0, _classCallCheck3.default)(this, RTCSessionState);

        this._rtcSession = rtcSession;
    }

    (0, _createClass3.default)(RTCSessionState, [{
        key: 'onEnter',
        value: function onEnter() {}
    }, {
        key: 'onExit',
        value: function onExit() {}
    }, {
        key: '_isCurrentState',
        value: function _isCurrentState() {
            return this._rtcSession._state === this;
        }
    }, {
        key: 'transit',
        value: function transit(nextState) {
            if (this._isCurrentState()) {
                this._rtcSession.transit(nextState);
            }
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            this.transit(new FailedState(this._rtcSession));
        }
    }, {
        key: 'onIceCandidate',
        value: function onIceCandidate(evt) {// eslint-disable-line no-unused-vars
            //ignore candidate by default, ConnectSignalingAndIceCollectionState will override to collect candidates, but collecting process could last much longer than ConnectSignalingAndIceCollectionState
            //we don't want to spam the console log
        }
    }, {
        key: 'onRemoteHungup',
        value: function onRemoteHungup() {
            throw new _exceptions.UnsupportedOperation('onRemoteHungup not implemented by ' + this.name);
        }
    }, {
        key: 'onSignalingConnected',
        value: function onSignalingConnected() {
            throw new _exceptions.UnsupportedOperation('onSignalingConnected not implemented by ' + this.name);
        }
    }, {
        key: 'onSignalingHandshaked',
        value: function onSignalingHandshaked() {
            throw new _exceptions.UnsupportedOperation('onSignalingHandshaked not implemented by ' + this.name);
        }
    }, {
        key: 'onSignalingFailed',
        value: function onSignalingFailed(e) {
            // eslint-disable-line no-unused-vars
            throw new _exceptions.UnsupportedOperation('onSignalingFailed not implemented by ' + this.name);
        }
    }, {
        key: 'onIceStateChange',
        value: function onIceStateChange(evt) {// eslint-disable-line no-unused-vars
        }
    }, {
        key: 'logger',
        get: function get() {
            return this._rtcSession._logger;
        }
    }, {
        key: 'name',
        get: function get() {
            return "RTCSessionState";
        }
    }]);
    return RTCSessionState;
}();

var GrabLocalMediaState = exports.GrabLocalMediaState = function (_RTCSessionState) {
    (0, _inherits3.default)(GrabLocalMediaState, _RTCSessionState);

    function GrabLocalMediaState() {
        (0, _classCallCheck3.default)(this, GrabLocalMediaState);
        return (0, _possibleConstructorReturn3.default)(this, (GrabLocalMediaState.__proto__ || Object.getPrototypeOf(GrabLocalMediaState)).apply(this, arguments));
    }

    (0, _createClass3.default)(GrabLocalMediaState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            var startTime = Date.now();
            if (self._rtcSession._isUserProvidedStream) {
                self.transit(new CreateOfferState(self._rtcSession));
            } else {
                var gumTimeoutPromise = new Promise(function (resolve, reject) {
                    setTimeout(function () {
                        reject(new _exceptions.GumTimeout('Local media has not been initialized yet.'));
                    }, self._rtcSession._gumTimeoutMillis);
                });
                var sessionGumPromise = self._gUM(self._rtcSession._buildMediaConstraints());

                Promise.race([sessionGumPromise, gumTimeoutPromise]).then(function (stream) {
                    self._rtcSession._sessionReport.gumTimeMillis = Date.now() - startTime;
                    self._rtcSession._onGumSuccess(self._rtcSession);
                    self._rtcSession._localStream = stream;
                    self._rtcSession._sessionReport.gumOtherFailure = false;
                    self._rtcSession._sessionReport.gumTimeoutFailure = false;
                    self.transit(new CreateOfferState(self._rtcSession));
                }).catch(function (e) {
                    self._rtcSession._sessionReport.gumTimeMillis = Date.now() - startTime;
                    var errorReason;
                    if (e instanceof _exceptions.GumTimeout) {
                        errorReason = _rtc_const.RTC_ERRORS.GUM_TIMEOUT_FAILURE;
                        self._rtcSession._sessionReport.gumTimeoutFailure = true;
                        self._rtcSession._sessionReport.gumOtherFailure = false;
                    } else {
                        errorReason = _rtc_const.RTC_ERRORS.GUM_OTHER_FAILURE;
                        self._rtcSession._sessionReport.gumOtherFailure = true;
                        self._rtcSession._sessionReport.gumTimeoutFailure = false;
                    }
                    self.logger.error('Local media initialization failed', e);
                    self._rtcSession._onGumError(self._rtcSession);
                    self.transit(new FailedState(self._rtcSession, errorReason));
                });
            }
        }
    }, {
        key: '_gUM',
        value: function _gUM(constraints) {
            return this._rtcSession._strategy._gUM(constraints);
        }
    }, {
        key: 'name',
        get: function get() {
            return "GrabLocalMediaState";
        }
    }]);
    return GrabLocalMediaState;
}(RTCSessionState);

var CreateOfferState = exports.CreateOfferState = function (_RTCSessionState2) {
    (0, _inherits3.default)(CreateOfferState, _RTCSessionState2);

    function CreateOfferState() {
        (0, _classCallCheck3.default)(this, CreateOfferState);
        return (0, _possibleConstructorReturn3.default)(this, (CreateOfferState.__proto__ || Object.getPrototypeOf(CreateOfferState)).apply(this, arguments));
    }

    (0, _createClass3.default)(CreateOfferState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            var stream = self._rtcSession._localStream;
            self._rtcSession._strategy.addStream(self._rtcSession._pc, stream);
            self._rtcSession._onLocalStreamAdded(self._rtcSession, stream);
            self._rtcSession._pc.createOffer().then(function (rtcSessionDescription) {
                self._rtcSession._localSessionDescription = rtcSessionDescription;
                self._rtcSession._sessionReport.createOfferFailure = false;
                self.transit(new SetLocalSessionDescriptionState(self._rtcSession));
            }).catch(function (e) {
                self.logger.error('CreateOffer failed', e);
                self._rtcSession._sessionReport.createOfferFailure = true;
                self.transit(new FailedState(self._rtcSession, _rtc_const.RTC_ERRORS.CREATE_OFFER_FAILURE));
            });
        }
    }, {
        key: 'name',
        get: function get() {
            return "CreateOfferState";
        }
    }]);
    return CreateOfferState;
}(RTCSessionState);

var SetLocalSessionDescriptionState = exports.SetLocalSessionDescriptionState = function (_RTCSessionState3) {
    (0, _inherits3.default)(SetLocalSessionDescriptionState, _RTCSessionState3);

    function SetLocalSessionDescriptionState() {
        (0, _classCallCheck3.default)(this, SetLocalSessionDescriptionState);
        return (0, _possibleConstructorReturn3.default)(this, (SetLocalSessionDescriptionState.__proto__ || Object.getPrototypeOf(SetLocalSessionDescriptionState)).apply(this, arguments));
    }

    (0, _createClass3.default)(SetLocalSessionDescriptionState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;

            // fix/modify SDP as needed here, before setLocalDescription
            var localDescription = self._rtcSession._localSessionDescription;
            var sdpOptions = new _utils.SdpOptions();
            // Set audio codec.
            if (self._rtcSession._forceAudioCodec) {
                sdpOptions.forceCodec['audio'] = self._rtcSession._forceAudioCodec;
            }
            // Set video codec.
            if (self._rtcSession._forceVideoCodec) {
                sdpOptions.forceCodec['video'] = self._rtcSession._forceVideoCodec;
            }
            sdpOptions.enableOpusDtx = self._rtcSession._enableOpusDtx;

            var transformedSdp = (0, _utils.transformSdp)(localDescription.sdp, sdpOptions);
            localDescription.sdp = transformedSdp.sdp;
            localDescription.sdp += 'a=ptime:20\r\n';
            localDescription.sdp += 'a=maxptime:20\r\n';
            localDescription.sdp = localDescription.sdp.replace("minptime=10", "minptime=20");

            self.logger.info('LocalSD', self._rtcSession._localSessionDescription);
            self._rtcSession._pc.setLocalDescription(self._rtcSession._localSessionDescription).then(function () {
                var initializationTime = Date.now() - self._rtcSession._connectTimeStamp;
                self._rtcSession._sessionReport.initializationTimeMillis = initializationTime;
                self._rtcSession._onSessionInitialized(self._rtcSession, initializationTime);
                self._rtcSession._sessionReport.setLocalDescriptionFailure = false;
                self.transit(new ConnectSignalingAndIceCollectionState(self._rtcSession, transformedSdp.mLines));
            }).catch(function (e) {
                self.logger.error('SetLocalDescription failed', e);
                self._rtcSession._sessionReport.setLocalDescriptionFailure = true;
                self.transit(new FailedState(self._rtcSession, _rtc_const.RTC_ERRORS.SET_LOCAL_DESCRIPTION_FAILURE));
            });
        }
    }, {
        key: 'name',
        get: function get() {
            return "SetLocalSessionDescriptionState";
        }
    }]);
    return SetLocalSessionDescriptionState;
}(RTCSessionState);

/**
 * Kick off signaling connection. Wait until signaling connects and ICE collection (which already started in previous state) completes.
 * ICE collection times out after user specified amount of time (default to DEFAULT_ICE_TIMEOUT_MS) in case user has complex network environment that blackholes STUN/TURN requests. In this case at least one candidate is required to move forward.
 * ICE collection could also wrap up before timeout if it's determined that RTP candidates from same TURN server have been collected for all m lines.
 */


var ConnectSignalingAndIceCollectionState = exports.ConnectSignalingAndIceCollectionState = function (_RTCSessionState4) {
    (0, _inherits3.default)(ConnectSignalingAndIceCollectionState, _RTCSessionState4);

    /**
     * Create ConnectSignalingAndIceCollectionState object.
     * @param {RtcSession} rtcSession
     * @param {number} mLines Number of m lines in SDP
     */
    function ConnectSignalingAndIceCollectionState(rtcSession, mLines) {
        (0, _classCallCheck3.default)(this, ConnectSignalingAndIceCollectionState);

        var _this4 = (0, _possibleConstructorReturn3.default)(this, (ConnectSignalingAndIceCollectionState.__proto__ || Object.getPrototypeOf(ConnectSignalingAndIceCollectionState)).call(this, rtcSession));

        _this4._iceCandidates = [];
        _this4._iceCandidateFoundationsMap = {};
        _this4._mLines = mLines;
        return _this4;
    }

    (0, _createClass3.default)(ConnectSignalingAndIceCollectionState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            self._startTime = Date.now();
            setTimeout(function () {
                if (self._isCurrentState() && !self._iceCompleted) {
                    self.logger.warn('ICE collection timed out');
                    self._reportIceCompleted(true);
                }
            }, self._rtcSession._iceTimeoutMillis);
            self._rtcSession._createSignalingChannel().connect();
        }
    }, {
        key: 'onSignalingConnected',
        value: function onSignalingConnected() {
            this._rtcSession._signallingConnectTimestamp = Date.now();
            this._rtcSession._sessionReport.signallingConnectTimeMillis = this._rtcSession._signallingConnectTimestamp - this._startTime;
            this._signalingConnected = true;
            this._rtcSession._onSignalingConnected(this._rtcSession);
            this._rtcSession._sessionReport.signallingConnectionFailure = false;
            this._checkAndTransit();
        }
    }, {
        key: 'onSignalingFailed',
        value: function onSignalingFailed(e) {
            this._rtcSession._sessionReport.signallingConnectTimeMillis = Date.now() - this._startTime;
            this.logger.error('Failed connecting to signaling server', e);
            this._rtcSession._sessionReport.signallingConnectionFailure = true;
            this.transit(new FailedState(this._rtcSession, _rtc_const.RTC_ERRORS.SIGNALLING_CONNECTION_FAILURE));
        }
    }, {
        key: '_createLocalCandidate',
        value: function _createLocalCandidate(initDict) {
            return new RTCIceCandidate(initDict);
        }
    }, {
        key: 'onIceCandidate',
        value: function onIceCandidate(evt) {
            var candidate = evt.candidate;
            this.logger.log('onicecandidate ' + JSON.stringify(candidate));
            if (candidate) {
                if (candidate.candidate) {
                    this._iceCandidates.push(this._createLocalCandidate(candidate));
                    if (!this._iceCompleted) {
                        this._checkCandidatesSufficient(candidate);
                    }
                }
            } else {
                this._reportIceCompleted(false);
            }
        }
    }, {
        key: '_checkCandidatesSufficient',
        value: function _checkCandidatesSufficient(candidate) {
            //check if we collected sufficient candidates from single media server to start the call
            var candidateObj = (0, _sdp.parseCandidate)(candidate.candidate);
            if (candidateObj.component != 1) {
                return;
            }
            var candidateFoundation = candidateObj.foundation;
            var candidateMLineIndex = candidate.sdpMLineIndex;
            if (candidateFoundation && candidateMLineIndex >= 0 && candidateMLineIndex < this._mLines) {
                var mIndexList = this._iceCandidateFoundationsMap[candidateFoundation] || [];
                if (!mIndexList.includes(candidateMLineIndex)) {
                    mIndexList.push(candidateMLineIndex);
                }
                this._iceCandidateFoundationsMap[candidateFoundation] = mIndexList;

                if (this._mLines == mIndexList.length) {
                    this._reportIceCompleted(false);
                }
            }
        }
    }, {
        key: '_reportIceCompleted',
        value: function _reportIceCompleted(isTimeout) {
            this._rtcSession._sessionReport.iceCollectionTimeMillis = Date.now() - this._startTime;
            this._iceCompleted = true;
            this._rtcSession._onIceCollectionComplete(this._rtcSession, isTimeout, this._iceCandidates.length);
            if (this._iceCandidates.length > 0) {
                this._rtcSession._sessionReport.iceCollectionFailure = false;
                this._checkAndTransit();
            } else {
                this.logger.error('No ICE candidate');
                this._rtcSession._sessionReport.iceCollectionFailure = true;
                this.transit(new FailedState(this._rtcSession, _rtc_const.RTC_ERRORS.ICE_COLLECTION_TIMEOUT));
            }
        }
    }, {
        key: '_checkAndTransit',
        value: function _checkAndTransit() {
            if (this._iceCompleted && this._signalingConnected) {
                this.transit(new InviteAnswerState(this._rtcSession, this._iceCandidates));
            } else if (!this._iceCompleted) {
                this.logger.log('Pending ICE collection');
            } else {
                //implies _signalingConnected == false
                this.logger.log('Pending signaling connection');
            }
        }
    }, {
        key: 'name',
        get: function get() {
            return "ConnectSignalingAndIceCollectionState";
        }
    }]);
    return ConnectSignalingAndIceCollectionState;
}(RTCSessionState);

var InviteAnswerState = exports.InviteAnswerState = function (_RTCSessionState5) {
    (0, _inherits3.default)(InviteAnswerState, _RTCSessionState5);

    function InviteAnswerState(rtcSession, iceCandidates) {
        (0, _classCallCheck3.default)(this, InviteAnswerState);

        var _this5 = (0, _possibleConstructorReturn3.default)(this, (InviteAnswerState.__proto__ || Object.getPrototypeOf(InviteAnswerState)).call(this, rtcSession));

        _this5._iceCandidates = iceCandidates;
        return _this5;
    }

    (0, _createClass3.default)(InviteAnswerState, [{
        key: 'onEnter',
        value: function onEnter() {
            var rtcSession = this._rtcSession;
            rtcSession._onSignalingStarted(rtcSession);
            rtcSession._signalingChannel.invite(rtcSession._localSessionDescription.sdp, this._iceCandidates);
        }
    }, {
        key: 'onSignalingAnswered',
        value: function onSignalingAnswered(sdp, candidates) {
            this._rtcSession._sessionReport.userBusyFailure = false;
            this._rtcSession._sessionReport.handshakingFailure = false;
            this.transit(new AcceptState(this._rtcSession, sdp, candidates));
        }
    }, {
        key: 'onSignalingFailed',
        value: function onSignalingFailed(e) {
            var reason;
            if (e.name == _exceptions.BusyExceptionName) {
                this.logger.error('User Busy, possibly multiple CCP windows open', e);
                this._rtcSession._sessionReport.userBusyFailure = true;
                this._rtcSession._sessionReport.handshakingFailure = true;
                reason = _rtc_const.RTC_ERRORS.USER_BUSY;
            } else if (e.name == _exceptions.CallNotFoundExceptionName) {
                this.logger.error('Call not found. One of the participant probably hungup.', e);
                reason = _rtc_const.RTC_ERRORS.CALL_NOT_FOUND;
                this._rtcSession._sessionReport.handshakingFailure = true;
            } else {
                this.logger.error('Failed handshaking with signaling server', e);
                this._rtcSession._sessionReport.userBusyFailure = false;
                this._rtcSession._sessionReport.handshakingFailure = true;
                reason = _rtc_const.RTC_ERRORS.SIGNALLING_HANDSHAKE_FAILURE;
            }
            this.transit(new FailedState(this._rtcSession, reason));
        }
    }, {
        key: 'name',
        get: function get() {
            return "InviteAnswerState";
        }
    }]);
    return InviteAnswerState;
}(RTCSessionState);

var AcceptState = exports.AcceptState = function (_RTCSessionState6) {
    (0, _inherits3.default)(AcceptState, _RTCSessionState6);

    function AcceptState(rtcSession, sdp, candidates) {
        (0, _classCallCheck3.default)(this, AcceptState);

        var _this6 = (0, _possibleConstructorReturn3.default)(this, (AcceptState.__proto__ || Object.getPrototypeOf(AcceptState)).call(this, rtcSession));

        _this6._sdp = sdp;
        _this6._candidates = candidates;
        return _this6;
    }

    (0, _createClass3.default)(AcceptState, [{
        key: '_createSessionDescription',
        value: function _createSessionDescription(initDict) {
            return new RTCSessionDescription(initDict);
        }
    }, {
        key: '_createRemoteCandidate',
        value: function _createRemoteCandidate(initDict) {
            return new RTCIceCandidate(initDict);
        }
    }, {
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            var rtcSession = self._rtcSession;

            if (!self._sdp) {
                self.logger.error('Invalid remote SDP');
                rtcSession._stopSession();
                rtcSession._sessionReport.invalidRemoteSDPFailure = true;
                self.transit(new FailedState(rtcSession, _rtc_const.RTC_ERRORS.INVALID_REMOTE_SDP));
                return;
            } else if (!self._candidates || self._candidates.length < 1) {
                self.logger.error('No remote ICE candidate');
                rtcSession._stopSession();
                rtcSession._sessionReport.noRemoteIceCandidateFailure = true;
                self.transit(new FailedState(rtcSession, _rtc_const.RTC_ERRORS.NO_REMOTE_ICE_CANDIDATE));
                return;
            }

            rtcSession._sessionReport.invalidRemoteSDPFailure = false;
            rtcSession._sessionReport.noRemoteIceCandidateFailure = false;
            self._rtcSession._strategy.setRemoteDescription(self, rtcSession);
        }
    }, {
        key: 'onSignalingHandshaked',
        value: function onSignalingHandshaked() {
            this._rtcSession._sessionReport.handshakingTimeMillis = Date.now() - this._rtcSession._signallingConnectTimestamp;
            this._signalingHandshaked = true;
            this._checkAndTransit();
        }
    }, {
        key: '_checkAndTransit',
        value: function _checkAndTransit() {
            if (this._signalingHandshaked && this._remoteDescriptionSet) {
                this.transit(new TalkingState(this._rtcSession));
            } else if (!this._signalingHandshaked) {
                this.logger.log('Pending handshaking');
            } else {
                //implies _remoteDescriptionSet == false
                this.logger.log('Pending setting remote description');
            }
        }
    }, {
        key: 'name',
        get: function get() {
            return "AcceptState";
        }
    }]);
    return AcceptState;
}(RTCSessionState);

var TalkingState = exports.TalkingState = function (_RTCSessionState7) {
    (0, _inherits3.default)(TalkingState, _RTCSessionState7);

    function TalkingState() {
        (0, _classCallCheck3.default)(this, TalkingState);
        return (0, _possibleConstructorReturn3.default)(this, (TalkingState.__proto__ || Object.getPrototypeOf(TalkingState)).apply(this, arguments));
    }

    (0, _createClass3.default)(TalkingState, [{
        key: 'onEnter',
        value: function onEnter() {
            this._startTime = Date.now();
            this._rtcSession._sessionReport.preTalkingTimeMillis = this._startTime - this._rtcSession._connectTimeStamp;
            this._rtcSession._onSessionConnected(this._rtcSession);
        }
    }, {
        key: 'onSignalingReconnected',
        value: function onSignalingReconnected() {}
    }, {
        key: 'onRemoteHungup',
        value: function onRemoteHungup() {
            this._rtcSession._signalingChannel.hangup();
            this.transit(new DisconnectedState(this._rtcSession));
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            this._rtcSession._signalingChannel.hangup();
            this.transit(new DisconnectedState(this._rtcSession));
        }
    }, {
        key: 'onIceStateChange',
        value: function onIceStateChange(evt) {
            var iceState = this._rtcSession._strategy.onIceStateChange(evt, this._rtcSession._pc);
            this.logger.info('ICE Connection State: ', iceState);

            if (iceState == _rtc_const.ICE_CONNECTION_STATE.DISCONNECTED) {
                this.logger.info('Lost ICE connection');
                this._rtcSession._sessionReport.iceConnectionsLost += 1;
            }
            if (iceState == _rtc_const.ICE_CONNECTION_STATE.FAILED) {
                this._rtcSession._sessionReport.iceConnectionsFailed = true;
            }
        }
    }, {
        key: 'onPeerConnectionStateChange',
        value: function onPeerConnectionStateChange() {
            var peerConnectionState = this._rtcSession._strategy.onPeerConnectionStateChange(this._rtcSession._pc);
            this.logger.info('Peer Connection State: ', peerConnectionState);

            if (peerConnectionState == _rtc_const.PEER_CONNECTION_STATE.FAILED) {
                this._rtcSession._sessionReport.peerConnectionFailed = true;
            }
        }
    }, {
        key: 'onExit',
        value: function onExit() {
            this._rtcSession._sessionReport.talkingTimeMillis = Date.now() - this._startTime;
            this._rtcSession._detachMedia();
            this._rtcSession._sessionReport.sessionEndTime = new Date();
            this._rtcSession._onSessionCompleted(this._rtcSession);
        }
    }, {
        key: 'name',
        get: function get() {
            return "TalkingState";
        }
    }]);
    return TalkingState;
}(RTCSessionState);

var CleanUpState = exports.CleanUpState = function (_RTCSessionState8) {
    (0, _inherits3.default)(CleanUpState, _RTCSessionState8);

    function CleanUpState() {
        (0, _classCallCheck3.default)(this, CleanUpState);
        return (0, _possibleConstructorReturn3.default)(this, (CleanUpState.__proto__ || Object.getPrototypeOf(CleanUpState)).apply(this, arguments));
    }

    (0, _createClass3.default)(CleanUpState, [{
        key: 'onEnter',
        value: function onEnter() {
            this._startTime = Date.now();
            this._rtcSession._stopSession();
            this._rtcSession._sessionReport.cleanupTimeMillis = Date.now() - this._startTime;
            this._rtcSession._onSessionDestroyed(this._rtcSession, this._rtcSession._sessionReport);
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            //do nothing, already at the end of lifecycle
        }
    }, {
        key: 'name',
        get: function get() {
            return "CleanUpState";
        }
    }]);
    return CleanUpState;
}(RTCSessionState);

var DisconnectedState = exports.DisconnectedState = function (_CleanUpState) {
    (0, _inherits3.default)(DisconnectedState, _CleanUpState);

    function DisconnectedState() {
        (0, _classCallCheck3.default)(this, DisconnectedState);
        return (0, _possibleConstructorReturn3.default)(this, (DisconnectedState.__proto__ || Object.getPrototypeOf(DisconnectedState)).apply(this, arguments));
    }

    (0, _createClass3.default)(DisconnectedState, [{
        key: 'name',
        get: function get() {
            return "DisconnectedState";
        }
    }]);
    return DisconnectedState;
}(CleanUpState);

var FailedState = exports.FailedState = function (_CleanUpState2) {
    (0, _inherits3.default)(FailedState, _CleanUpState2);

    function FailedState(rtcSession, failureReason) {
        (0, _classCallCheck3.default)(this, FailedState);

        var _this10 = (0, _possibleConstructorReturn3.default)(this, (FailedState.__proto__ || Object.getPrototypeOf(FailedState)).call(this, rtcSession));

        _this10._failureReason = failureReason;
        return _this10;
    }

    (0, _createClass3.default)(FailedState, [{
        key: 'onEnter',
        value: function onEnter() {
            this._rtcSession._sessionReport.sessionEndTime = new Date();
            this._rtcSession._onSessionFailed(this._rtcSession, this._failureReason);
            (0, _get3.default)(FailedState.prototype.__proto__ || Object.getPrototypeOf(FailedState.prototype), 'onEnter', this).call(this);
        }
    }, {
        key: 'name',
        get: function get() {
            return "FailedState";
        }
    }]);
    return FailedState;
}(CleanUpState);

var RtcSession = function () {
    /**
     * Build an AmazonConnect RTC session.
     * @param {*} signalingUri
     * @param {*} iceServers Array of ice servers
     * @param {*} contactToken A string representing the contact token (optional)
     * @param {*} logger An object provides logging functions, such as console
     * @param {*} contactId Must be UUID, uniquely identifies the session.
     */
    function RtcSession(signalingUri, iceServers, contactToken, logger, contactId, connectionId, wssManager) {
        var strategy = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : new _StandardStrategy2.default();
        (0, _classCallCheck3.default)(this, RtcSession);

        if (!(strategy instanceof _CCPInitiationStrategyInterface2.default)) {
            throw new Error('Expected a strategy of type CCPInitiationStrategyInterface');
        }
        if (typeof signalingUri !== 'string' || signalingUri.trim().length === 0) {
            throw new _exceptions.IllegalParameters('signalingUri required');
        }
        if (!iceServers) {
            throw new _exceptions.IllegalParameters('iceServers required');
        }
        if ((typeof logger === 'undefined' ? 'undefined' : (0, _typeof3.default)(logger)) !== 'object') {
            throw new _exceptions.IllegalParameters('logger required');
        }
        if (!contactId) {
            this._callId = (0, _v2.default)();
        } else {
            this._callId = contactId;
        }
        this._strategy = strategy;
        this._connectionId = connectionId;
        this._wssManager = wssManager;
        this._sessionReport = new _session_report.SessionReport();
        this._signalingUri = signalingUri;
        this._iceServers = iceServers;
        this._contactToken = contactToken;
        this._originalLogger = logger;
        this._logger = (0, _utils.wrapLogger)(this._originalLogger, this._callId, 'SESSION');
        this._iceTimeoutMillis = _rtc_const.DEFAULT_ICE_TIMEOUT_MS;
        this._gumTimeoutMillis = _rtc_const.DEFAULT_GUM_TIMEOUT_MS;

        this._enableAudio = true;
        this._enableVideo = false;
        this._facingMode = 'user';
        this._legacyStatsReportSupport = false;
        /**
         * user may provide the stream to the RtcSession directly to connect to the other end.
         * user may also acquire the stream from the local device.
         * This flag is used to track where the stream is acquired.
         * If it's acquired from local devices, then we must close the stream when the session ends.
         * If it's provided by user (rather than local camera/microphone), then we should leave it open when the
         * session ends.
         */
        this._isUserProvidedStream = false;

        this._onGumError = this._onGumSuccess = this._onLocalStreamAdded = this._onSessionFailed = this._onSessionInitialized = this._onSignalingConnected = this._onIceCollectionComplete = this._onSignalingStarted = this._onSessionConnected = this._onRemoteStreamAdded = this._onSessionCompleted = this._onSessionDestroyed = function () {};
    }

    (0, _createClass3.default)(RtcSession, [{
        key: 'pauseLocalVideo',
        value: function pauseLocalVideo() {
            if (this._localStream) {
                var videoTrack = this._localStream.getVideoTracks()[0];
                if (videoTrack) {
                    videoTrack.enabled = false;
                }
            }
        }
    }, {
        key: 'resumeLocalVideo',
        value: function resumeLocalVideo() {
            if (this._localStream) {
                var videoTrack = this._localStream.getVideoTracks()[0];
                if (videoTrack) {
                    videoTrack.enabled = true;
                }
            }
        }
    }, {
        key: 'pauseRemoteVideo',
        value: function pauseRemoteVideo() {
            if (this._remoteVideoStream) {
                var videoTrack = this._remoteVideoStream.getTracks()[1];
                if (videoTrack) {
                    videoTrack.enabled = false;
                }
            }
        }
    }, {
        key: 'resumeRemoteVideo',
        value: function resumeRemoteVideo() {
            if (this._remoteVideoStream) {
                var videoTrack = this._remoteVideoStream.getTracks()[1];
                if (videoTrack) {
                    videoTrack.enabled = true;
                }
            }
        }
    }, {
        key: 'pauseLocalAudio',
        value: function pauseLocalAudio() {
            if (this._localStream) {
                var audioTrack = this._localStream.getAudioTracks()[0];
                if (audioTrack) {
                    audioTrack.enabled = false;
                }
            }
        }
    }, {
        key: 'resumeLocalAudio',
        value: function resumeLocalAudio() {
            if (this._localStream) {
                var audioTrack = this._localStream.getAudioTracks()[0];
                if (audioTrack) {
                    audioTrack.enabled = true;
                }
            }
        }
    }, {
        key: 'pauseRemoteAudio',
        value: function pauseRemoteAudio() {
            if (this._remoteAudioStream) {
                var audioTrack = this._remoteAudioStream.getTracks()[0];
                if (audioTrack) {
                    audioTrack.enabled = false;
                }
            }
        }
    }, {
        key: 'resumeRemoteAudio',
        value: function resumeRemoteAudio() {
            if (this._remoteAudioStream) {
                var audioTrack = this._remoteAudioStream.getTracks()[0];
                if (audioTrack) {
                    audioTrack.enabled = true;
                }
            }
        }
        /**
         * Callback when gUM succeeds.
         * First param is RtcSession object.
         */

    }, {
        key: 'transit',
        value: function transit(nextState) {
            try {
                this._logger.info((this._state ? this._state.name : 'null') + ' => ' + nextState.name);
                if (this._state && this._state.onExit) {
                    this._state.onExit();
                }
            } finally {
                this._state = nextState;
                if (nextState.onEnter) {
                    try {
                        nextState.onEnter();
                    } catch (e) {
                        this._logger.warn(nextState.name + '#onEnter failed', e);
                        throw e; // eslint-disable-line no-unsafe-finally
                    }
                }
            }
        }
    }, {
        key: '_createSignalingChannel',
        value: function _createSignalingChannel() {
            var signalingChannel = new _signaling2.default(this._callId, this._signalingUri, this._contactToken, this._originalLogger, this._signalingConnectTimeout, this._connectionId, this._wssManager);
            signalingChannel.onConnected = (0, _utils.hitch)(this, this._signalingConnected);
            signalingChannel.onAnswered = (0, _utils.hitch)(this, this._signalingAnswered);
            signalingChannel.onHandshaked = (0, _utils.hitch)(this, this._signalingHandshaked);
            signalingChannel.onRemoteHungup = (0, _utils.hitch)(this, this._signalingRemoteHungup);
            signalingChannel.onFailed = (0, _utils.hitch)(this, this._signalingFailed);
            signalingChannel.onDisconnected = (0, _utils.hitch)(this, this._signalingDisconnected);

            this._signalingChannel = signalingChannel;

            return signalingChannel;
        }
    }, {
        key: '_signalingConnected',
        value: function _signalingConnected() {
            this._state.onSignalingConnected();
        }
    }, {
        key: '_signalingAnswered',
        value: function _signalingAnswered(sdp, candidates) {
            this._state.onSignalingAnswered(sdp, candidates);
        }
    }, {
        key: '_signalingHandshaked',
        value: function _signalingHandshaked() {
            this._state.onSignalingHandshaked();
        }
    }, {
        key: '_signalingRemoteHungup',
        value: function _signalingRemoteHungup() {
            this._state.onRemoteHungup();
        }
    }, {
        key: '_signalingFailed',
        value: function _signalingFailed(e) {
            this._state.onSignalingFailed(e);
        }
    }, {
        key: '_signalingDisconnected',
        value: function _signalingDisconnected() {}
    }, {
        key: '_createPeerConnection',
        value: function _createPeerConnection(configuration, optionalConfiguration) {
            return this._strategy._createPeerConnection(configuration, optionalConfiguration);
        }
    }, {
        key: 'connect',
        value: function connect(pc) {
            var self = this;
            var now = new Date();
            self._sessionReport.sessionStartTime = now;
            self._connectTimeStamp = now.getTime();
            if (pc && pc.signalingState != 'closed') {
                self._pc = pc;
            } else {
                if (pc) {
                    pc.close();
                    pc = null;
                }
                _rtc_const.RTC_PEER_CONNECTION_CONFIG.iceServers = self._iceServers;
                self._pc = self._createPeerConnection(_rtc_const.RTC_PEER_CONNECTION_CONFIG, _rtc_const.RTC_PEER_CONNECTION_OPTIONAL_CONFIG);
            }
            self._pc.ontrack = (0, _utils.hitch)(self, self._ontrack);
            self._pc.onicecandidate = (0, _utils.hitch)(self, self._onIceCandidate);
            self._pc.onconnectionstatechange = (0, _utils.hitch)(self, self._onPeerConnectionStateChange);
            self._pc.oniceconnectionstatechange = (0, _utils.hitch)(self, self._onIceStateChange);

            (0, _utils.isLegacyStatsReportSupported)(self._pc).then(function (result) {
                self._legacyStatsReportSupport = result;
                self.transit(new GrabLocalMediaState(self));
            });
        }
    }, {
        key: 'accept',
        value: function accept() {
            throw new _exceptions.UnsupportedOperation('accept does not go through signaling channel at this moment');
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            this._state.hangup();
        }

        /**
         * Get a promise containing an object with two named lists of audio stats, one for each channel on each
         * media type of 'video' and 'audio'.
         * @return Rejected promise if failed to get MediaRtpStats. The promise is never resolved with null value.
         */

    }, {
        key: 'getStats',
        value: function () {
            var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3() {
                var _this11 = this;

                var timestamp, impl, statsResult, rttReducer, audioInputRttMilliseconds, videoInputRttMilliseconds;
                return _regenerator2.default.wrap(function _callee3$(_context3) {
                    while (1) {
                        switch (_context3.prev = _context3.next) {
                            case 0:
                                timestamp = new Date();

                                impl = function () {
                                    var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2(stream, streamType) {
                                        var tracks;
                                        return _regenerator2.default.wrap(function _callee2$(_context2) {
                                            while (1) {
                                                switch (_context2.prev = _context2.next) {
                                                    case 0:
                                                        tracks = [];

                                                        if (stream) {
                                                            _context2.next = 3;
                                                            break;
                                                        }

                                                        return _context2.abrupt('return', []);

                                                    case 3:
                                                        _context2.t0 = streamType;
                                                        _context2.next = _context2.t0 === 'audio_input' ? 6 : _context2.t0 === 'audio_output' ? 6 : _context2.t0 === 'video_input' ? 8 : _context2.t0 === 'video_output' ? 8 : 10;
                                                        break;

                                                    case 6:
                                                        tracks = stream.getAudioTracks();
                                                        return _context2.abrupt('break', 11);

                                                    case 8:
                                                        tracks = stream.getVideoTracks();
                                                        return _context2.abrupt('break', 11);

                                                    case 10:
                                                        throw new Error('Unsupported stream type while trying to get stats: ' + streamType);

                                                    case 11:
                                                        _context2.next = 13;
                                                        return Promise.all(tracks.map((0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {
                                                            return _regenerator2.default.wrap(function _callee$(_context) {
                                                                while (1) {
                                                                    switch (_context.prev = _context.next) {
                                                                        case 0:
                                                                            return _context.abrupt('return', _this11._pc.getStats().then(function (rawStats) {
                                                                                var digestedStats = (0, _rtpStats.extractMediaStatsFromStats)(timestamp, rawStats, streamType);
                                                                                if (!digestedStats) {
                                                                                    throw new Error('Failed to extract MediaRtpStats from RTCStatsReport for stream type ' + streamType);
                                                                                }
                                                                                return digestedStats;
                                                                            }));

                                                                        case 1:
                                                                        case 'end':
                                                                            return _context.stop();
                                                                    }
                                                                }
                                                            }, _callee, _this11);
                                                        }))));

                                                    case 13:
                                                        return _context2.abrupt('return', _context2.sent);

                                                    case 14:
                                                    case 'end':
                                                        return _context2.stop();
                                                }
                                            }
                                        }, _callee2, _this11);
                                    }));

                                    return function impl(_x2, _x3) {
                                        return _ref2.apply(this, arguments);
                                    };
                                }();

                                if (!(this._pc && this._pc.signalingState === 'stable')) {
                                    _context3.next = 26;
                                    break;
                                }

                                _context3.next = 5;
                                return impl(this._remoteAudioStream, 'audio_input');

                            case 5:
                                _context3.t0 = _context3.sent;
                                _context3.next = 8;
                                return impl(this._localStream, 'audio_output');

                            case 8:
                                _context3.t1 = _context3.sent;
                                _context3.t2 = {
                                    input: _context3.t0,
                                    output: _context3.t1
                                };
                                _context3.next = 12;
                                return impl(this._remoteVideoStream, 'video_input');

                            case 12:
                                _context3.t3 = _context3.sent;
                                _context3.next = 15;
                                return impl(this._localStream, 'video_output');

                            case 15:
                                _context3.t4 = _context3.sent;
                                _context3.t5 = {
                                    input: _context3.t3,
                                    output: _context3.t4
                                };
                                statsResult = {
                                    audio: _context3.t2,
                                    video: _context3.t5
                                };

                                // For consistency's sake, coalesce rttMilliseconds into the output for audio and video.
                                rttReducer = function rttReducer(acc, stats) {
                                    if (stats.rttMilliseconds !== null && (acc === null || stats.rttMilliseconds > acc)) {
                                        acc = stats.rttMilliseconds;
                                    }
                                    stats._rttMilliseconds = null;
                                    return acc;
                                };

                                audioInputRttMilliseconds = statsResult.audio.input.reduce(rttReducer, null);
                                videoInputRttMilliseconds = statsResult.video.input.reduce(rttReducer, null);


                                if (audioInputRttMilliseconds !== null) {
                                    statsResult.audio.output.forEach(function (stats) {
                                        stats._rttMilliseconds = audioInputRttMilliseconds;
                                    });
                                }

                                if (videoInputRttMilliseconds !== null) {
                                    statsResult.video.output.forEach(function (stats) {
                                        stats._rttMilliseconds = videoInputRttMilliseconds;
                                    });
                                }

                                return _context3.abrupt('return', statsResult);

                            case 26:
                                return _context3.abrupt('return', Promise.reject(new _exceptions.IllegalState()));

                            case 27:
                            case 'end':
                                return _context3.stop();
                        }
                    }
                }, _callee3, this);
            }));

            function getStats() {
                return _ref.apply(this, arguments);
            }

            return getStats;
        }()

        /**
         * Get a promise of MediaRtpStats object for remote audio (from Amazon Connect to client).
         * @return Rejected promise if failed to get MediaRtpStats. The promise is never resolved with null value.
         * @deprecated in favor of getStats()
         */

    }, {
        key: 'getRemoteAudioStats',
        value: function getRemoteAudioStats() {
            return this.getStats().then(function (stats) {
                if (stats.audio.output.length > 0) {
                    return stats.audio.output[0];
                } else {
                    return Promise.reject(new _exceptions.IllegalState());
                }
            });
        }

        /**
         * Get a promise of MediaRtpStats object for user audio (from client to Amazon Connect).
         * @return Rejected promise if failed to get MediaRtpStats. The promise is never resolved with null value.
         * @deprecated in favor of getStats()
         */

    }, {
        key: 'getUserAudioStats',
        value: function getUserAudioStats() {
            return this.getStats().then(function (stats) {
                if (stats.audio.input.length > 0) {
                    return stats.audio.input[0];
                } else {
                    return Promise.reject(new _exceptions.IllegalState());
                }
            });
        }

        /**
         * Get a promise of MediaRtpStats object for user video (from client to Amazon Connect).
         * @return Rejected promise if failed to get MediaRtpStats. The promise is never resolved with null value.
         * @deprecated in favor of getStats()
         */

    }, {
        key: 'getRemoteVideoStats',
        value: function getRemoteVideoStats() {
            return this.getStats().then(function (stats) {
                if (stats.video.output.length > 0) {
                    return stats.video.output[0];
                } else {
                    return Promise.reject(new _exceptions.IllegalState());
                }
            });
        }

        /**
         * Get a promise of MediaRtpStats object for user video (from client to Amazon Connect).
         * @return Rejected promise if failed to get MediaRtpStats. The promise is never resolved with null value.
         * @deprecated in favor of getStats()
         */

    }, {
        key: 'getUserVideoStats',
        value: function getUserVideoStats() {
            return this.getStats().then(function (stats) {
                if (stats.video.input.length > 0) {
                    return stats.video.input[0];
                } else {
                    return Promise.reject(new _exceptions.IllegalState());
                }
            });
        }
    }, {
        key: '_onIceCandidate',
        value: function _onIceCandidate(evt) {
            this._state.onIceCandidate(evt);
        }
    }, {
        key: '_onPeerConnectionStateChange',
        value: function _onPeerConnectionStateChange() {
            this._state.onPeerConnectionStateChange();
        }
    }, {
        key: '_onIceStateChange',
        value: function _onIceStateChange(evt) {
            this._state.onIceStateChange(evt);
        }

        /**
         * Attach remote media stream to web element.
         */

    }, {
        key: '_ontrack',
        value: function _ontrack(evt) {
            this._strategy._ontrack(this, evt);
            this._onRemoteStreamAdded(this, evt.streams[0]);
        }
    }, {
        key: '_detachMedia',
        value: function _detachMedia() {
            if (this._remoteVideoElement) {
                this._remoteVideoElement.srcObject = null;
            }
            if (this._remoteAudioElement) {
                this._remoteAudioElement.srcObject = null;
                this._remoteAudioStream = null;
            }
        }
    }, {
        key: '_stopSession',
        value: function _stopSession() {
            try {
                if (this._localStream && !this._isUserProvidedStream) {
                    (0, _utils.closeStream)(this._localStream);
                    this._localStream = null;
                    this._isUserProvidedStream = false;
                }
            } finally {
                try {
                    if (this._pc) {
                        this._pc.close();
                    }
                } catch (e) {
                    // eat exception
                } finally {
                    this._pc = null;
                }
            }
        }
    }, {
        key: '_buildMediaConstraints',
        value: function _buildMediaConstraints() {
            var self = this;
            var mediaConstraints = {};

            self._strategy._buildMediaConstraints(self, mediaConstraints);

            if (self._enableVideo) {
                var videoConstraints = {};
                var widthConstraints = {};
                var heightConstraints = {};
                var frameRateConstraints = {};

                //build video width constraints
                if (typeof self._idealVideoWidth !== 'undefined') {
                    widthConstraints.ideal = self._idealVideoWidth;
                }
                if (typeof self._maxVideoWidth !== 'undefined') {
                    widthConstraints.max = self._maxVideoWidth;
                }
                if (typeof self._minVideoWidth !== 'undefined') {
                    widthConstraints.min = self._minVideoWidth;
                }
                // build video height constraints
                if (typeof self._idealVideoHeight !== 'undefined') {
                    heightConstraints.ideal = self._idealVideoHeight;
                }
                if (typeof self._maxVideoHeight !== 'undefined') {
                    heightConstraints.max = self._maxVideoHeight;
                }
                if (typeof self._minVideoHeight !== 'undefined') {
                    heightConstraints.min = self._minVideoHeight;
                }
                if (Object.keys(widthConstraints).length > 0 && Object.keys(heightConstraints).length > 0) {
                    videoConstraints.width = widthConstraints;
                    videoConstraints.height = heightConstraints;
                }
                // build frame rate constraints
                if (typeof self._videoFrameRate !== 'undefined') {
                    frameRateConstraints.ideal = self._videoFrameRate;
                }
                if (typeof self._minVideoFrameRate !== 'undefined') {
                    frameRateConstraints.min = self._minVideoFrameRate;
                }
                if (typeof self._maxVideoFrameRate !== 'undefined') {
                    frameRateConstraints.max = self._maxVideoFrameRate;
                }
                if (Object.keys(frameRateConstraints).length > 0) {
                    videoConstraints.frameRate = frameRateConstraints;
                }

                // build facing mode constraints
                if (self._facingMode !== 'user' && self._facingMode !== "environment") {
                    self._facingMode = 'user';
                }
                videoConstraints.facingMode = self._facingMode;

                // set video constraints
                if (Object.keys(videoConstraints).length > 0) {
                    mediaConstraints.video = videoConstraints;
                } else {
                    mediaConstraints.video = true;
                }
            }

            return mediaConstraints;
        }
    }, {
        key: 'sessionReport',
        get: function get() {
            return this._sessionReport;
        }
    }, {
        key: 'callId',
        get: function get() {
            return this._callId;
        }
        /**
         * getMediaStream returns the local stream, which may be acquired from local device or from user provided stream.
         * Rather than getting a stream by calling getUserMedia (which gets a stream from local device such as camera),
         * user could also provide the stream to the RtcSession directly to connect to the other end.
         */

    }, {
        key: 'mediaStream',
        get: function get() {
            return this._localStream;
        },

        /**
         * Optional. RtcSession will grab input device if this is not specified.
         * Please note: this RtcSession class only support single audio track and/or single video track.
         */
        set: function set(input) {
            this._localStream = input;
            this._isUserProvidedStream = true;
        }
        /**
         * Needed, expect an audio element that can be used to play remote audio stream.
         */

    }, {
        key: 'remoteVideoStream',
        get: function get() {
            return this._remoteVideoStream;
        }
    }, {
        key: 'onGumSuccess',
        set: function set(handler) {
            this._onGumSuccess = handler;
        }
        /**
         * Callback when gUM fails.
         * First param is RtcSession object.
         * Second param is the error.
         */

    }, {
        key: 'onGumError',
        set: function set(handler) {
            this._onGumError = handler;
        }
        /**
         * Callback if failed initializing local resources
         * First param is RtcSession object.
         */

    }, {
        key: 'onSessionFailed',
        set: function set(handler) {
            this._onSessionFailed = handler;
        }
        /**
         * Callback after local user media stream is added to the session.
         * First param is RtcSession object.
         * Second param is media stream
         */

    }, {
        key: 'onLocalStreamAdded',
        set: function set(handler) {
            this._onLocalStreamAdded = handler;
        }
        /**
         * Callback when all local resources are ready. Establishing signaling chanel and ICE collection happens at the same time after this.
         * First param is RtcSession object.
         */

    }, {
        key: 'onSessionInitialized',
        set: function set(handler) {
            this._onSessionInitialized = handler;
        }
        /**
         * Callback when signaling channel is established.
         * RTC session will move forward only if onSignalingConnected and onIceCollectionComplete are both called.
         *
         * First param is RtcSession object.
         */

    }, {
        key: 'onSignalingConnected',
        set: function set(handler) {
            this._onSignalingConnected = handler;
        }
        /**
         * Callback when ICE collection completes either because there is no more candidate or collection timed out.
         * RTC session will move forward only if onSignalingConnected and onIceCollectionComplete are both called.
         *
         * First param is RtcSession object.
         * Second param is boolean, TRUE - ICE collection timed out.
         * Third param is number of candidates collected.
         */

    }, {
        key: 'onIceCollectionComplete',
        set: function set(handler) {
            this._onIceCollectionComplete = handler;
        }
        /**
         * Callback when signaling channel is established and ICE collection completed with at least one candidate.
         * First param is RtcSession object.
         */

    }, {
        key: 'onSignalingStarted',
        set: function set(handler) {
            this._onSignalingStarted = handler;
        }
        /**
         * Callback when the call is established (handshaked and media stream should be flowing)
         * First param is RtcSession object.
         */

    }, {
        key: 'onSessionConnected',
        set: function set(handler) {
            this._onSessionConnected = handler;
        }
        /**
         * Callback after remote media stream is added to the session.
         * This could be called multiple times with the same stream if multiple tracks are included in the same stream.
         *
         * First param is RtcSession object.
         * Second param is media stream track.
         */

    }, {
        key: 'onRemoteStreamAdded',
        set: function set(handler) {
            this._onRemoteStreamAdded = handler;
        }
        /**
         * Callback when the hangup is initiated (implies the call was successfully established).
         * First param is RtcSession object.
         */

    }, {
        key: 'onSessionCompleted',
        set: function set(handler) {
            this._onSessionCompleted = handler;
        }
        /**
         * Callback after session is cleaned up, no matter if the call was successfully established or not.
         * First param is RtcSession object.
         * Second param is SessionReport object.
         */

    }, {
        key: 'onSessionDestroyed',
        set: function set(handler) {
            this._onSessionDestroyed = handler;
        }
    }, {
        key: 'enableAudio',
        set: function set(flag) {
            this._enableAudio = flag;
        }
    }, {
        key: 'echoCancellation',
        set: function set(flag) {
            this._echoCancellation = flag;
        }
    }, {
        key: 'enableVideo',
        set: function set(flag) {
            this._enableVideo = flag;
        }
    }, {
        key: 'maxVideoFrameRate',
        set: function set(frameRate) {
            this._maxVideoFrameRate = frameRate;
        }
    }, {
        key: 'minVideoFrameRate',
        set: function set(frameRate) {
            this._minVideoFrameRate = frameRate;
        }
    }, {
        key: 'videoFrameRate',
        set: function set(frameRate) {
            this._videoFrameRate = frameRate;
        }
    }, {
        key: 'maxVideoWidth',
        set: function set(width) {
            this._maxVideoWidth = width;
        }
    }, {
        key: 'minVideoWidth',
        set: function set(width) {
            this._minVideoWidth = width;
        }
    }, {
        key: 'idealVideoWidth',
        set: function set(width) {
            this._idealVideoWidth = width;
        }
    }, {
        key: 'maxVideoHeight',
        set: function set(height) {
            this._maxVideoHeight = height;
        }
    }, {
        key: 'minVideoHeight',
        set: function set(height) {
            this._minVideoHeight = height;
        }
    }, {
        key: 'idealVideoHeight',
        set: function set(height) {
            this._idealVideoHeight = height;
        }
    }, {
        key: 'facingMode',
        set: function set(mode) {
            this._facingMode = mode;
        }
    }, {
        key: 'remoteAudioElement',
        set: function set(element) {
            this._remoteAudioElement = element;
        }
    }, {
        key: 'remoteVideoElement',
        set: function set(element) {
            this._remoteVideoElement = element;
        }
        /**
         * Override the default signaling connect time out.
         */

    }, {
        key: 'signalingConnectTimeout',
        set: function set(ms) {
            this._signalingConnectTimeout = ms;
        }
        /**
         * Override the default ICE collection time limit.
         */

    }, {
        key: 'iceTimeoutMillis',
        set: function set(timeoutMillis) {
            this._iceTimeoutMillis = timeoutMillis;
        }
        /**
         * Override the default GUM timeout time limit.
         */

    }, {
        key: 'gumTimeoutMillis',
        set: function set(timeoutMillis) {
            this._gumTimeoutMillis = timeoutMillis;
        }
        /**
         * connect-rtc-js initiate the handshaking with all browser supported codec by default, Amazon Connect service will choose the codec according to its preference setting.
         * Setting this attribute will force connect-rtc-js to only use specified codec.
         * WARNING: Setting this to unsupported codec will cause the failure of handshaking.
         * Supported audio codecs: opus.
         */

    }, {
        key: 'forceAudioCodec',
        set: function set(audioCodec) {
            this._forceAudioCodec = audioCodec;
        }

        /**
         * connect-rtc-js initiate the handshaking with all browser supported codec by default, Amazon Connect service will choose the codec according to its preference setting.
         * Setting this attribute will force connect-rtc-js to only use specified codec.
         * WARNING: Setting this to unsupported codec will cause the failure of handshaking.
         * Supported video codecs: VP8, VP9, H264.
         */

    }, {
        key: 'forceVideoCodec',
        set: function set(videoCodec) {
            this._forceVideoCodec = videoCodec;
        }

        /**
         * connect-rtc-js disables OPUS DTX by default because it harms audio quality.
         * @param flag boolean
         */

    }, {
        key: 'enableOpusDtx',
        set: function set(flag) {
            this._enableOpusDtx = flag;
        }
    }]);
    return RtcSession;
}();

exports.default = RtcSession;

},{"./exceptions":135,"./rtc_const":136,"./rtp-stats":139,"./session_report":140,"./signaling":141,"./strategies/CCPInitiationStrategyInterface":142,"./strategies/StandardStrategy":144,"./utils":145,"babel-runtime/helpers/asyncToGenerator":10,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12,"babel-runtime/helpers/get":13,"babel-runtime/helpers/inherits":14,"babel-runtime/helpers/possibleConstructorReturn":15,"babel-runtime/helpers/typeof":16,"babel-runtime/regenerator":17,"sdp":118,"uuid/v4":121}],139:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

exports.extractMediaStatsFromStats = extractMediaStatsFromStats;

var _utils = require('./utils');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function extractMediaStatsFromStats(timestamp, stats, streamType) {
    var extractedStats = null;
    var reportType = null;

    stats.forEach(function (statsReport) {
        if (statsReport) {
            if (statsReport.type === 'inbound-rtp' && streamType === 'audio_input') {
                // inbound-rtp: Stats for stream from Server to CCP, as seen on the browser
                reportType = statsReport.type;
                extractedStats = {
                    timestamp: timestamp,
                    packetsLost: statsReport.packetsLost,
                    // packetsCount: number of packet received by CCP, as seen on the browser
                    packetsCount: statsReport.packetsReceived,
                    jbMilliseconds: Math.floor((0, _utils.when_defined)(statsReport.jitter, 0) * 1000),
                    // Multiplying audioLevel by 32768 aligns its value with the legacy getStats API.
                    audioLevel: (0, _utils.is_defined)(statsReport.audioLevel) ? Math.floor(statsReport.audioLevel * 32768) : null
                };
            } else if (statsReport.type === 'outbound-rtp' && streamType === 'audio_output') {
                // outbound-rtp: Stats for stream from CCP to Server, as seen on the browser
                extractedStats = extractedStats || {};
                // packetsCount: number of packet sent by CCP, as seen on the browser
                extractedStats.packetsCount = statsReport.packetsSent;
            } else if (statsReport.type === 'media-source' && streamType === 'audio_output') {
                extractedStats = extractedStats || {};
                // Multiplying audioLevel by 32768 aligns its value with the legacy getStats API.
                extractedStats.audioLevel = (0, _utils.is_defined)(statsReport.audioLevel) ? Math.floor(statsReport.audioLevel * 32768) : null;
            } else if (statsReport.type === 'remote-inbound-rtp' && streamType === 'audio_output') {
                // remote-inbound-rtp: Stats for stream from CCP to Server, as seen on Server side
                reportType = statsReport.type;
                extractedStats = extractedStats || {};
                extractedStats.timestamp = timestamp;
                extractedStats.packetsLost = statsReport.packetsLost;
                extractedStats.rttMilliseconds = (0, _utils.is_defined)(statsReport.roundTripTime) ? Math.floor(statsReport.roundTripTime * 1000) : null;
                extractedStats.jbMilliseconds = Math.floor((0, _utils.when_defined)(statsReport.jitter, 0) * 1000);
            }
        }
    });

    return extractedStats ? new MediaRtpStats(extractedStats, reportType, streamType) : null;
}

/**
 * Basic RTP statistics object, represents statistics of an audio or video stream.
 */
/**
 * Extract rtp stats of specified stream from RTCStatsReport
 * Chrome reports all stream stats in statsReports whereas firefox reports only single stream stats in report
 * StreamType is passed only to pull right stream stats audio_input or audio_output.
 */

var MediaRtpStats = function () {
    function MediaRtpStats(paramsIn, statsReportType, streamType) {
        (0, _classCallCheck3.default)(this, MediaRtpStats);

        var params = paramsIn || {};

        this._timestamp = params.timestamp || new Date().getTime();
        this._packetsLost = (0, _utils.when_defined)(params.packetsLost);
        this._packetsCount = (0, _utils.when_defined)(params.packetsCount);
        this._audioLevel = (0, _utils.when_defined)(params.audioLevel);
        this._procMilliseconds = (0, _utils.when_defined)(params.procMilliseconds);
        this._rttMilliseconds = (0, _utils.when_defined)(params.rttMilliseconds);
        this._jbMilliseconds = (0, _utils.when_defined)(params.jbMilliseconds);
        this._bytesSent = (0, _utils.when_defined)(params.bytesSent);
        this._bytesReceived = (0, _utils.when_defined)(params.bytesReceived);
        this._framesEncoded = (0, _utils.when_defined)(params.framesEncoded);
        this._framesDecoded = (0, _utils.when_defined)(params.framesDecoded);
        this._frameRateSent = (0, _utils.when_defined)(params.frameRateSent);
        this._frameRateReceived = (0, _utils.when_defined)(params.frameRateReceived);
        this._statsReportType = statsReportType || params._statsReportType || "unknown";
        this._streamType = streamType || params.streamType || "unknown";
    }

    /** {number} number of packets sent to the channel */


    (0, _createClass3.default)(MediaRtpStats, [{
        key: 'packetsCount',
        get: function get() {
            return this._packetsCount;
        }
        /** {number} number of packets lost after travelling through the channel */

    }, {
        key: 'packetsLost',
        get: function get() {
            return this._packetsLost;
        }
        /** {number} number of packets lost after travelling through the channel */

    }, {
        key: 'packetLossPercentage',
        get: function get() {
            return this._packetsCount > 0 ? this._packetsLost / this._packetsCount : 0;
        }
        /** Audio volume level
         * Currently firefox doesn't provide audio level in rtp stats.
         */

    }, {
        key: 'audioLevel',
        get: function get() {
            return this._audioLevel;
        }
        /** Timestamp when stats are collected. */

    }, {
        key: 'timestamp',
        get: function get() {
            return this._timestamp;
        }
        /** {number} Processing delay calculated by time to process packet header */

    }, {
        key: 'procMilliseconds',
        get: function get() {
            return this._procMilliseconds;
        }
        /** {number} Round trip time calculated with RTCP reports */

    }, {
        key: 'rttMilliseconds',
        get: function get() {
            return this._rttMilliseconds;
        }
        /** {number} Statistical variance of RTP data packet inter-arrival time */

    }, {
        key: 'jbMilliseconds',
        get: function get() {
            return this._jbMilliseconds;
        }
        /** {number} number of bytes sent to the channel*/

    }, {
        key: 'bytesSent',
        get: function get() {
            return this._bytesSent;
        }
        /** {number} number of bytes received from the channel*/

    }, {
        key: 'bytesReceived',
        get: function get() {
            return this._bytesReceived;
        }
        /** {number} number of video frames encoded*/

    }, {
        key: 'framesEncoded',
        get: function get() {
            return this._framesEncoded;
        }
        /** {number} number of video frames decoded*/

    }, {
        key: 'framesDecoded',
        get: function get() {
            return this._framesDecoded;
        }
        /** {number} frames per second sent to the channel*/

    }, {
        key: 'frameRateSent',
        get: function get() {
            return this._frameRateSent;
        }
        /** {number} frames per second received from the channel*/

    }, {
        key: 'frameRateReceived',
        get: function get() {
            return this._frameRateReceived;
        }
        /** {string} the type of the stats report */

    }, {
        key: 'statsReportType',
        get: function get() {
            return this._statsReportType;
        }
        /** {string} the type of the stream */

    }, {
        key: 'streamType',
        get: function get() {
            return this._streamType;
        }
    }]);
    return MediaRtpStats;
}();

},{"./utils":145,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],140:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.SessionReport = undefined;

var _classCallCheck2 = require("babel-runtime/helpers/classCallCheck");

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require("babel-runtime/helpers/createClass");

var _createClass3 = _interopRequireDefault(_createClass2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */

var SessionReport = exports.SessionReport = function () {
    /**
     * @class Prototype for tracking various RTC session report
     * @constructs
     */
    function SessionReport() {
        (0, _classCallCheck3.default)(this, SessionReport);

        this._sessionStartTime = null;
        this._sessionEndTime = null;
        this._gumTimeMillis = null;
        this._initializationTimeMillis = null;
        this._iceCollectionTimeMillis = null;
        this._signallingConnectTimeMillis = null;
        this._handshakingTimeMillis = null;
        this._preTalkingTimeMillis = null;
        this._talkingTimeMillis = null;
        this._iceConnectionsLost = 0;
        this._iceConnectionsFailed = null;
        this._peerConnectionFailed = null;
        this._cleanupTimeMillis = null;
        this._iceCollectionFailure = null;
        this._signallingConnectionFailure = null;
        this._handshakingFailure = null;
        this._gumOtherFailure = null;
        this._gumTimeoutFailure = null;
        this._createOfferFailure = null;
        this._setLocalDescriptionFailure = null;
        this._userBusyFailure = null;
        this._invalidRemoteSDPFailure = null;
        this._noRemoteIceCandidateFailure = null;
        this._setRemoteDescriptionFailure = null;
        this._streamStats = [];
        this._rtcJsVersion = "1.1.24";
    }
    /**
     *Timestamp when RTCSession started.
     */


    (0, _createClass3.default)(SessionReport, [{
        key: "sessionStartTime",
        get: function get() {
            return this._sessionStartTime;
        }
        /**
         * Timestamp when RTCSession ended.
         */
        ,
        set: function set(value) {
            this._sessionStartTime = value;
        }
    }, {
        key: "sessionEndTime",
        get: function get() {
            return this._sessionEndTime;
        }
        /**
         * Time taken for grabbing user microphone at the time of connecting RTCSession.
         */
        ,
        set: function set(value) {
            this._sessionEndTime = value;
        }
    }, {
        key: "gumTimeMillis",
        get: function get() {
            return this._gumTimeMillis;
        }
        /**
         * Time taken for session initialization in millis. Includes time spent in GrabLocalMedia, SetLocalSDP states.
         */
        ,
        set: function set(value) {
            this._gumTimeMillis = value;
        }
    }, {
        key: "initializationTimeMillis",
        get: function get() {
            return this._initializationTimeMillis;
        }
        /**
         * Time spent on ICECollection in millis.
         */
        ,
        set: function set(value) {
            this._initializationTimeMillis = value;
        }
    }, {
        key: "iceCollectionTimeMillis",
        get: function get() {
            return this._iceCollectionTimeMillis;
        }
        /**
         * Time taken for connecting the signalling in millis.
         */
        ,
        set: function set(value) {
            this._iceCollectionTimeMillis = value;
        }
    }, {
        key: "signallingConnectTimeMillis",
        get: function get() {
            return this._signallingConnectTimeMillis;
        }
        /**
         * Times spent from RTCSession connection until entering Talking state in millis.
         */
        ,
        set: function set(value) {
            this._signallingConnectTimeMillis = value;
        }
    }, {
        key: "preTalkingTimeMillis",
        get: function get() {
            return this._preTalkingTimeMillis;
        }
        /**
         *  Times spent in completing handshaking process of the RTCSession in millis.
         */
        ,
        set: function set(value) {
            this._preTalkingTimeMillis = value;
        }
    }, {
        key: "handshakingTimeMillis",
        get: function get() {
            return this._handshakingTimeMillis;
        }
        /**
         *  Times spent in Talking state in millis.
         */
        ,
        set: function set(value) {
            this._handshakingTimeMillis = value;
        }
    }, {
        key: "talkingTimeMillis",
        get: function get() {
            return this._talkingTimeMillis;
        }
        /**
         * How many times the RTCSession has lost ICE connection in talking state.
         */
        ,
        set: function set(value) {
            this._talkingTimeMillis = value;
        }
    }, {
        key: "iceConnectionsLost",
        get: function get() {
            return this._iceConnectionsLost;
        }
        /**
         * Tells if the RTCSession has failed RTCPeerConnection.iceConnectionState
         */
        ,
        set: function set(value) {
            this._iceConnectionsLost = value;
        }
    }, {
        key: "iceConnectionsFailed",
        get: function get() {
            return this._iceConnectionsFailed;
        }
        /**
         * Tells if the RTCSession has failed RTCPeerConnection.connectionState
         */
        ,
        set: function set(value) {
            this._iceConnectionsFailed = value;
        }
    }, {
        key: "peerConnectionFailed",
        get: function get() {
            return this._peerConnectionFailed;
        }
        /**
         * Times spent in Cleanup state in millis
         */
        ,
        set: function set(value) {
            this._peerConnectionFailed = value;
        }
    }, {
        key: "cleanupTimeMillis",
        get: function get() {
            return this._cleanupTimeMillis;
        }
        /**
         * Tells if the RTCSession fails in ICECollection.
         */
        ,
        set: function set(value) {
            this._cleanupTimeMillis = value;
        }
    }, {
        key: "iceCollectionFailure",
        get: function get() {
            return this._iceCollectionFailure;
        }
        /**
         * Tells if the RTCSession failed in signalling connect stage.
         */
        ,
        set: function set(value) {
            this._iceCollectionFailure = value;
        }
    }, {
        key: "signallingConnectionFailure",
        get: function get() {
            return this._signallingConnectionFailure;
        }
        /**
         * Handshaking failure of the RTCSession
         */
        ,
        set: function set(value) {
            this._signallingConnectionFailure = value;
        }
    }, {
        key: "handshakingFailure",
        get: function get() {
            return this._handshakingFailure;
        }
        /**
         * Gum failed due to timeout at the time of new RTCSession connection
         */
        ,
        set: function set(value) {
            this._handshakingFailure = value;
        }
    }, {
        key: "gumTimeoutFailure",
        get: function get() {
            return this._gumTimeoutFailure;
        }
        /**
         * Gum failed due to other reasons (other than Timeout)
         */
        ,
        set: function set(value) {
            this._gumTimeoutFailure = value;
        }
    }, {
        key: "gumOtherFailure",
        get: function get() {
            return this._gumOtherFailure;
        }
        /**
         * RTC Session failed in create Offer state.
         */
        ,
        set: function set(value) {
            this._gumOtherFailure = value;
        }
    }, {
        key: "createOfferFailure",
        get: function get() {
            return this._createOfferFailure;
        }
        /**
         * Tells if setLocalDescription failed for the RTC Session.
         */
        ,
        set: function set(value) {
            this._createOfferFailure = value;
        }
    }, {
        key: "setLocalDescriptionFailure",
        get: function get() {
            return this._setLocalDescriptionFailure;
        }
        /**
         * Tells if handshaking failed due to user busy case,
         * happens when multiple softphone calls are initiated at same time.
         */
        ,
        set: function set(value) {
            this._setLocalDescriptionFailure = value;
        }
    }, {
        key: "userBusyFailure",
        get: function get() {
            return this._userBusyFailure;
        }
        /**
         * Tells it remote SDP is invalid.
         */
        ,
        set: function set(value) {
            this._userBusyFailure = value;
        }
    }, {
        key: "invalidRemoteSDPFailure",
        get: function get() {
            return this._invalidRemoteSDPFailure;
        }
        /**
         * Tells if the setRemoteDescription failed for the RTC Session.
         */
        ,
        set: function set(value) {
            this._invalidRemoteSDPFailure = value;
        }
    }, {
        key: "setRemoteDescriptionFailure",
        get: function get() {
            return this._setRemoteDescriptionFailure;
        }
        /**
         * A failure case when there is no RemoteIceCandidate.
         */
        ,
        set: function set(value) {
            this._setRemoteDescriptionFailure = value;
        }
    }, {
        key: "noRemoteIceCandidateFailure",
        get: function get() {
            return this._noRemoteIceCandidateFailure;
        }
        /**
         * Statistics for each stream(audio-in, audio-out, video-in, video-out) of the RTCSession.
         */
        ,
        set: function set(value) {
            this._noRemoteIceCandidateFailure = value;
        }
    }, {
        key: "streamStats",
        get: function get() {
            return this._streamStats;
        }
        /**
         * get current connect-rtc-js version
         */
        ,
        set: function set(value) {
            this._streamStats = value;
        }
    }, {
        key: "rtcJsVersion",
        get: function get() {
            return this._rtcJsVersion;
        },
        set: function set(value) {
            this._rtcJsVersion = value;
        }
    }]);
    return SessionReport;
}();

},{"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],141:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.FailedState = exports.DisconnectedState = exports.PendingLocalHangupState = exports.PendingRemoteHangupState = exports.PendingReconnectState = exports.TalkingState = exports.PendingAcceptAckState = exports.PendingAcceptState = exports.PendingAnswerState = exports.PendingInviteState = exports.PendingConnectState = exports.FailOnTimeoutState = exports.SignalingState = undefined;

var _regenerator = require('babel-runtime/regenerator');

var _regenerator2 = _interopRequireDefault(_regenerator);

var _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _utils = require('./utils');

var _rtc_const = require('./rtc_const');

var _exceptions = require('./exceptions');

var _v = require('uuid/v4');

var _v2 = _interopRequireDefault(_v);

var _virtual_wss_connection_manager = require('./virtual_wss_connection_manager');

var _virtual_wss_connection_manager2 = _interopRequireDefault(_virtual_wss_connection_manager);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var CONNECT_MAX_RETRIES = 3;

/**
 * Abstract signaling state class.
 */
/**
 * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */

var SignalingState = exports.SignalingState = function () {
    /**
     * @param {AmznRtcSignaling} signaling Signaling object.
     */
    function SignalingState(signaling) {
        (0, _classCallCheck3.default)(this, SignalingState);

        this._signaling = signaling;
        this._createTime = new Date().getTime();
    }

    (0, _createClass3.default)(SignalingState, [{
        key: 'setStateTimeout',
        value: function setStateTimeout(timeoutMs) {
            setTimeout((0, _utils.hitch)(this, this._onTimeoutChecked), timeoutMs);
        }
    }, {
        key: 'onEnter',
        value: function onEnter() {}
    }, {
        key: '_onTimeoutChecked',
        value: function _onTimeoutChecked() {
            if (this.isCurrentState) {
                this.onTimeout();
            }
        }
    }, {
        key: 'onTimeout',
        value: function onTimeout() {
            throw new _exceptions.UnsupportedOperation();
        }
    }, {
        key: 'transit',
        value: function transit(newState) {
            this._signaling.transit(newState);
        }
    }, {
        key: 'onExit',
        value: function onExit() {}
    }, {
        key: 'onOpen',
        value: function onOpen() {
            throw new _exceptions.UnsupportedOperation('onOpen not supported by ' + this.name);
        }
    }, {
        key: 'onError',
        value: function onError() {
            this.channelDown();
        }
    }, {
        key: 'onClose',
        value: function onClose() {
            this.channelDown();
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            throw new _exceptions.UnsupportedOperation('channelDown not supported by ' + this.name);
        }
    }, {
        key: 'onRpcMsg',
        value: function onRpcMsg(rpcMsg) {
            // eslint-disable-line no-unused-vars
            throw new _exceptions.UnsupportedOperation('onRpcMsg not supported by ' + this.name);
        }
    }, {
        key: 'invite',
        value: function invite(sdp, iceCandidates) {
            // eslint-disable-line no-unused-vars
            throw new _exceptions.UnsupportedOperation('invite not supported by ' + this.name);
        }
    }, {
        key: 'accept',
        value: function accept() {
            throw new _exceptions.UnsupportedOperation('accept not supported by ' + this.name);
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            throw new _exceptions.UnsupportedOperation('hangup not supported by ' + this.name);
        }
    }, {
        key: 'isCurrentState',
        get: function get() {
            return this === this._signaling.state;
        }
    }, {
        key: 'name',
        get: function get() {
            return "SignalingState";
        }
    }, {
        key: 'logger',
        get: function get() {
            return this._signaling._logger;
        }
    }]);
    return SignalingState;
}();

var FailOnTimeoutState = exports.FailOnTimeoutState = function (_SignalingState) {
    (0, _inherits3.default)(FailOnTimeoutState, _SignalingState);

    function FailOnTimeoutState(signaling, timeoutMs) {
        (0, _classCallCheck3.default)(this, FailOnTimeoutState);

        var _this = (0, _possibleConstructorReturn3.default)(this, (FailOnTimeoutState.__proto__ || Object.getPrototypeOf(FailOnTimeoutState)).call(this, signaling));

        _this._timeoutMs = timeoutMs;
        return _this;
    }

    (0, _createClass3.default)(FailOnTimeoutState, [{
        key: 'onEnter',
        value: function onEnter() {
            this.setStateTimeout(this._timeoutMs);
        }
    }, {
        key: 'onTimeout',
        value: function onTimeout() {
            this.transit(new FailedState(this._signaling, new _exceptions.Timeout()));
        }
    }, {
        key: 'name',
        get: function get() {
            return "FailOnTimeoutState";
        }
    }]);
    return FailOnTimeoutState;
}(SignalingState);

var PendingConnectState = exports.PendingConnectState = function (_FailOnTimeoutState) {
    (0, _inherits3.default)(PendingConnectState, _FailOnTimeoutState);

    function PendingConnectState(signaling, timeoutMs, initialStartTimeIn, retriesIn) {
        (0, _classCallCheck3.default)(this, PendingConnectState);

        var _this2 = (0, _possibleConstructorReturn3.default)(this, (PendingConnectState.__proto__ || Object.getPrototypeOf(PendingConnectState)).call(this, signaling, timeoutMs));

        _this2._initialStartTime = initialStartTimeIn || new Date().getTime();
        _this2._retries = retriesIn || 0;
        return _this2;
    }

    (0, _createClass3.default)(PendingConnectState, [{
        key: 'onOpen',
        value: function onOpen() {
            this.transit(new PendingInviteState(this._signaling));
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            var now = new Date().getTime();
            var untilTimeoutMs = this._initialStartTime + this._timeoutMs - now;
            if (untilTimeoutMs > 0 && ++this._retries < CONNECT_MAX_RETRIES) {
                this._signaling._connect();
                this.transit(new PendingConnectState(this._signaling, untilTimeoutMs, this._initialStartTime, this._retries));
            } else {
                this.transit(new FailedState(this._signaling, new Error('channelDown')));
            }
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingConnectState";
        }
    }]);
    return PendingConnectState;
}(FailOnTimeoutState);

var PendingInviteState = exports.PendingInviteState = function (_SignalingState2) {
    (0, _inherits3.default)(PendingInviteState, _SignalingState2);

    function PendingInviteState() {
        (0, _classCallCheck3.default)(this, PendingInviteState);
        return (0, _possibleConstructorReturn3.default)(this, (PendingInviteState.__proto__ || Object.getPrototypeOf(PendingInviteState)).apply(this, arguments));
    }

    (0, _createClass3.default)(PendingInviteState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            new Promise(function notifyConnected(resolve) {
                self._signaling._connectedHandler();
                resolve();
            });
        }
    }, {
        key: 'invite',
        value: function invite(sdp, iceCandidates) {
            var self = this;
            var inviteId = (0, _v2.default)();

            var inviteParams = {
                sdp: sdp,
                candidates: iceCandidates,
                callContextToken: self._signaling._contactToken
            };
            self.logger.log('Sending SDP', (0, _utils.getRedactedSdp)(sdp));
            self._signaling._wss.send(JSON.stringify({
                jsonrpc: '2.0',
                method: _rtc_const.INVITE_METHOD_NAME,
                params: inviteParams,
                id: inviteId
            }));
            self.transit(new PendingAnswerState(self._signaling, inviteId));
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            this.transit(new FailedState(this._signaling));
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingInviteState";
        }
    }]);
    return PendingInviteState;
}(SignalingState);

var PendingAnswerState = exports.PendingAnswerState = function (_FailOnTimeoutState2) {
    (0, _inherits3.default)(PendingAnswerState, _FailOnTimeoutState2);

    function PendingAnswerState(signaling, inviteId) {
        (0, _classCallCheck3.default)(this, PendingAnswerState);

        var _this4 = (0, _possibleConstructorReturn3.default)(this, (PendingAnswerState.__proto__ || Object.getPrototypeOf(PendingAnswerState)).call(this, signaling, _rtc_const.MAX_INVITE_DELAY_MS));

        _this4._inviteId = inviteId;
        return _this4;
    }

    (0, _createClass3.default)(PendingAnswerState, [{
        key: 'onRpcMsg',
        value: function onRpcMsg(msg) {
            var self = this;
            if (msg.id === this._inviteId) {
                if (msg.error || !msg.result) {
                    this.transit(new FailedState(this._signaling, self.translateInviteError(msg)));
                } else {
                    new Promise(function notifyAnswered(resolve) {
                        self.logger.log('Received SDP', (0, _utils.getRedactedSdp)(msg.result.sdp));
                        self._signaling._answeredHandler(msg.result.sdp, msg.result.candidates);
                        resolve();
                    });
                    this.transit(new PendingAcceptState(this._signaling, this._signaling._autoAnswer));
                }
            }
        }
    }, {
        key: 'translateInviteError',
        value: function translateInviteError(msg) {
            if (msg.error && msg.error.code == 486) {
                return new _exceptions.BusyException(msg.error.message);
            } else if (msg.error && msg.error.code == 404) {
                return new _exceptions.CallNotFoundException(msg.error.message);
            } else {
                return new _exceptions.UnknownSignalingError();
            }
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingAnswerState";
        }
    }]);
    return PendingAnswerState;
}(FailOnTimeoutState);

var PendingAcceptState = exports.PendingAcceptState = function (_SignalingState3) {
    (0, _inherits3.default)(PendingAcceptState, _SignalingState3);

    function PendingAcceptState(signaling, autoAnswer) {
        (0, _classCallCheck3.default)(this, PendingAcceptState);

        var _this5 = (0, _possibleConstructorReturn3.default)(this, (PendingAcceptState.__proto__ || Object.getPrototypeOf(PendingAcceptState)).call(this, signaling));

        _this5._autoAnswer = autoAnswer;
        return _this5;
    }

    (0, _createClass3.default)(PendingAcceptState, [{
        key: 'onEnter',
        value: function onEnter() {
            if (this._autoAnswer) {
                this.accept();
            }
        }
    }, {
        key: 'accept',
        value: function accept() {
            this.sendAcceptRequest();
            this.transit(new TalkingState(this._signaling));
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            this.transit(new FailedState(this._signaling));
        }
    }, {
        key: 'sendAcceptRequest',
        value: function () {
            var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {
                var acceptId;
                return _regenerator2.default.wrap(function _callee$(_context) {
                    while (1) {
                        switch (_context.prev = _context.next) {
                            case 0:
                                acceptId = (0, _v2.default)();

                                this._signaling._wss.send(JSON.stringify({
                                    jsonrpc: '2.0',
                                    method: _rtc_const.ACCEPT_METHOD_NAME,
                                    params: {},
                                    id: acceptId
                                }));

                            case 2:
                            case 'end':
                                return _context.stop();
                        }
                    }
                }, _callee, this);
            }));

            function sendAcceptRequest() {
                return _ref.apply(this, arguments);
            }

            return sendAcceptRequest;
        }()
    }, {
        key: 'name',
        get: function get() {
            return "PendingAcceptState";
        }
    }]);
    return PendingAcceptState;
}(SignalingState);

var PendingAcceptAckState = exports.PendingAcceptAckState = function (_FailOnTimeoutState3) {
    (0, _inherits3.default)(PendingAcceptAckState, _FailOnTimeoutState3);

    function PendingAcceptAckState(signaling, acceptId) {
        (0, _classCallCheck3.default)(this, PendingAcceptAckState);

        var _this6 = (0, _possibleConstructorReturn3.default)(this, (PendingAcceptAckState.__proto__ || Object.getPrototypeOf(PendingAcceptAckState)).call(this, signaling, _rtc_const.MAX_ACCEPT_BYE_DELAY_MS));

        _this6._acceptId = acceptId;
        return _this6;
    }

    (0, _createClass3.default)(PendingAcceptAckState, [{
        key: 'onRpcMsg',
        value: function onRpcMsg(msg) {
            if (msg.id === this._acceptId) {
                if (msg.error) {
                    this.transit(new FailedState(this._signaling));
                } else {
                    this._signaling._clientToken = msg.result.clientToken;
                    this.transit(new TalkingState(this._signaling));
                }
            }
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingAcceptAckState";
        }
    }]);
    return PendingAcceptAckState;
}(FailOnTimeoutState);

var TalkingState = exports.TalkingState = function (_SignalingState4) {
    (0, _inherits3.default)(TalkingState, _SignalingState4);

    function TalkingState() {
        (0, _classCallCheck3.default)(this, TalkingState);
        return (0, _possibleConstructorReturn3.default)(this, (TalkingState.__proto__ || Object.getPrototypeOf(TalkingState)).apply(this, arguments));
    }

    (0, _createClass3.default)(TalkingState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            new Promise(function notifyHandshaked(resolve) {
                self._signaling._handshakedHandler();
                resolve();
            });
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            var byeId = (0, _v2.default)();
            this._signaling._wss.send(JSON.stringify({
                jsonrpc: '2.0',
                method: _rtc_const.BYE_METHOD_NAME,
                params: { callContextToken: this._signaling._contactToken },
                id: byeId
            }));
            this.transit(new PendingRemoteHangupState(this._signaling, byeId));
        }
    }, {
        key: 'onRpcMsg',
        value: function onRpcMsg(msg) {
            if (msg.method === _rtc_const.BYE_METHOD_NAME) {
                this.transit(new PendingLocalHangupState(this._signaling, msg.id));
            } else if (msg.method === 'renewClientToken') {
                this._signaling._clientToken = msg.params.clientToken;
            }
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            this._signaling._reconnect();
            this._signaling.transit(new PendingReconnectState(this._signaling));
        }
    }, {
        key: 'name',
        get: function get() {
            return "TalkingState";
        }
    }]);
    return TalkingState;
}(SignalingState);

var PendingReconnectState = exports.PendingReconnectState = function (_FailOnTimeoutState4) {
    (0, _inherits3.default)(PendingReconnectState, _FailOnTimeoutState4);

    function PendingReconnectState(signaling) {
        (0, _classCallCheck3.default)(this, PendingReconnectState);
        return (0, _possibleConstructorReturn3.default)(this, (PendingReconnectState.__proto__ || Object.getPrototypeOf(PendingReconnectState)).call(this, signaling, _rtc_const.DEFAULT_CONNECT_TIMEOUT_MS));
    }

    (0, _createClass3.default)(PendingReconnectState, [{
        key: 'onOpen',
        value: function onOpen() {
            this.transit(new TalkingState(this._signaling));
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            this.transit(new FailedState(this._signaling));
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingReconnectState";
        }
    }]);
    return PendingReconnectState;
}(FailOnTimeoutState);

var PendingRemoteHangupState = exports.PendingRemoteHangupState = function (_FailOnTimeoutState5) {
    (0, _inherits3.default)(PendingRemoteHangupState, _FailOnTimeoutState5);

    function PendingRemoteHangupState(signaling, byeId) {
        (0, _classCallCheck3.default)(this, PendingRemoteHangupState);

        var _this9 = (0, _possibleConstructorReturn3.default)(this, (PendingRemoteHangupState.__proto__ || Object.getPrototypeOf(PendingRemoteHangupState)).call(this, signaling, _rtc_const.MAX_ACCEPT_BYE_DELAY_MS));

        _this9._byeId = byeId;
        return _this9;
    }

    (0, _createClass3.default)(PendingRemoteHangupState, [{
        key: 'onRpcMsg',
        value: function onRpcMsg(msg) {
            if (msg.id === this._byeId || msg.method === _rtc_const.BYE_METHOD_NAME) {
                this.transit(new DisconnectedState(this._signaling));
            }
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingRemoteHangupState";
        }
    }]);
    return PendingRemoteHangupState;
}(FailOnTimeoutState);

var PendingLocalHangupState = exports.PendingLocalHangupState = function (_SignalingState5) {
    (0, _inherits3.default)(PendingLocalHangupState, _SignalingState5);

    function PendingLocalHangupState(signaling, byeId) {
        (0, _classCallCheck3.default)(this, PendingLocalHangupState);

        var _this10 = (0, _possibleConstructorReturn3.default)(this, (PendingLocalHangupState.__proto__ || Object.getPrototypeOf(PendingLocalHangupState)).call(this, signaling));

        _this10._byeId = byeId;
        return _this10;
    }

    (0, _createClass3.default)(PendingLocalHangupState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            new Promise(function notifyRemoteHungup(resolve) {
                self._signaling._remoteHungupHandler();
                resolve();
            });
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            var self = this;
            self._signaling._wss.send(JSON.stringify({
                jsonrpc: '2.0',
                result: {},
                id: self._byeId
            }));
            self.transit(new DisconnectedState(self._signaling));
        }
    }, {
        key: 'onRpcMsg',
        value: function onRpcMsg() {
            //Do nothing
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            this.transit(new DisconnectedState(this._signaling));
        }
    }, {
        key: 'name',
        get: function get() {
            return "PendingLocalHangupState";
        }
    }]);
    return PendingLocalHangupState;
}(SignalingState);

var DisconnectedState = exports.DisconnectedState = function (_SignalingState6) {
    (0, _inherits3.default)(DisconnectedState, _SignalingState6);

    function DisconnectedState() {
        (0, _classCallCheck3.default)(this, DisconnectedState);
        return (0, _possibleConstructorReturn3.default)(this, (DisconnectedState.__proto__ || Object.getPrototypeOf(DisconnectedState)).apply(this, arguments));
    }

    (0, _createClass3.default)(DisconnectedState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            new Promise(function notifyDisconnected(resolve) {
                self._signaling._disconnectedHandler();
                resolve();
            });
            this._signaling._wss.close();
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            //Do nothing
        }
    }, {
        key: 'onRpcMsg',
        value: function onRpcMsg() {
            //Do nothing
        }
    }, {
        key: 'name',
        get: function get() {
            return "DisconnectedState";
        }
    }]);
    return DisconnectedState;
}(SignalingState);

var FailedState = exports.FailedState = function (_SignalingState7) {
    (0, _inherits3.default)(FailedState, _SignalingState7);

    function FailedState(signaling, exception) {
        (0, _classCallCheck3.default)(this, FailedState);

        var _this12 = (0, _possibleConstructorReturn3.default)(this, (FailedState.__proto__ || Object.getPrototypeOf(FailedState)).call(this, signaling));

        _this12._exception = exception;
        return _this12;
    }

    (0, _createClass3.default)(FailedState, [{
        key: 'onEnter',
        value: function onEnter() {
            var self = this;
            new Promise(function notifyFailed(resolve) {
                self._signaling._failedHandler(self._exception);
                resolve();
            });
            this._signaling._wss.close();
        }
    }, {
        key: 'channelDown',
        value: function channelDown() {
            //Do nothing
        }
    }, {
        key: 'name',
        get: function get() {
            return "FailedState";
        }
    }, {
        key: 'exception',
        get: function get() {
            return this._exception;
        }
    }]);
    return FailedState;
}(SignalingState);

var AmznRtcSignaling = function () {
    function AmznRtcSignaling(callId, signalingUri, contactToken, logger, connectTimeoutMs, connectionId, wssManager) {
        (0, _classCallCheck3.default)(this, AmznRtcSignaling);

        this._callId = callId;
        this._connectTimeoutMs = connectTimeoutMs || _rtc_const.DEFAULT_CONNECT_TIMEOUT_MS;
        this._autoAnswer = true;
        this._signalingUri = signalingUri;
        this._contactToken = contactToken;
        this._logger = (0, _utils.wrapLogger)(logger, callId, 'SIGNALING');
        this._connectionId = connectionId;
        this._wssManager = wssManager;

        //empty event handlers
        this._connectedHandler = this._answeredHandler = this._handshakedHandler = this._reconnectedHandler = this._remoteHungupHandler = this._disconnectedHandler = this._failedHandler = function noOp() {};
    }

    (0, _createClass3.default)(AmznRtcSignaling, [{
        key: 'connect',
        value: function connect() {
            this._connect();
            this.transit(new PendingConnectState(this, this._connectTimeoutMs));
        }
    }, {
        key: '_connect',
        value: function _connect() {
            this._wss = this._connectWebSocket(this._buildInviteUri());
        }
    }, {
        key: 'transit',
        value: function transit(nextState) {
            try {
                this._logger.info((this._state ? this._state.name : 'null') + ' => ' + nextState.name);
                if (this.state && this.state.onExit) {
                    this.state.onExit();
                }
            } finally {
                this._state = nextState;
                if (this._state.onEnter) {
                    this._state.onEnter();
                }
            }
        }
    }, {
        key: '_connectWebSocket',
        value: function _connectWebSocket(uri) {
            var wsConnection = void 0;
            if (this._wssManager) {
                wsConnection = new _virtual_wss_connection_manager2.default(this._logger, this._connectionId, this._wssManager);
            } else {
                wsConnection = new WebSocket(uri);
            }
            wsConnection.onopen = (0, _utils.hitch)(this, this._onOpen);
            wsConnection.onmessage = (0, _utils.hitch)(this, this._onMessage);
            wsConnection.onerror = (0, _utils.hitch)(this, this._onError);
            wsConnection.onclose = (0, _utils.hitch)(this, this._onClose);
            return wsConnection;
        }
    }, {
        key: '_buildInviteUri',
        value: function _buildInviteUri() {
            if (this._contactToken) {
                return this._buildUriBase() + '&contactCtx=' + encodeURIComponent(this._contactToken);
            } else {
                return this._buildUriBase();
            }
        }
    }, {
        key: '_buildReconnectUri',
        value: function _buildReconnectUri() {
            return this._buildUriBase() + '&clientToken=' + encodeURIComponent(this._clientToken);
        }
    }, {
        key: '_buildUriBase',
        value: function _buildUriBase() {
            var separator = '?';
            if (this._signalingUri.indexOf(separator) > -1) {
                separator = '&';
            }
            return this._signalingUri + separator + 'callId=' + encodeURIComponent(this._callId);
        }
    }, {
        key: '_onMessage',
        value: function _onMessage(evt) {
            this.state.onRpcMsg(JSON.parse(evt.data));
        }
    }, {
        key: '_onOpen',
        value: function _onOpen(evt) {
            this.state.onOpen(evt);
        }
    }, {
        key: '_onError',
        value: function _onError(evt) {
            this.state.onError(evt);
        }
    }, {
        key: '_onClose',
        value: function _onClose(evt) {
            this._logger.log('WebSocket onclose code=' + evt.code + ', reason=' + evt.reason);
            this.state.onClose(evt);
        }
    }, {
        key: '_reconnect',
        value: function _reconnect() {
            this._wss = this._connectWebSocket(this._buildReconnectUri());
        }
    }, {
        key: 'invite',
        value: function invite(sdp, iceCandidates) {
            this.state.invite(sdp, iceCandidates);
        }
    }, {
        key: 'accept',
        value: function accept() {
            this.state.accept();
        }
    }, {
        key: 'hangup',
        value: function hangup() {
            this.state.hangup();
        }
    }, {
        key: 'callId',
        get: function get() {
            return this._callId;
        }
    }, {
        key: 'onConnected',
        set: function set(connectedHandler) {
            this._connectedHandler = connectedHandler;
        }
    }, {
        key: 'onAnswered',
        set: function set(answeredHandler) {
            this._answeredHandler = answeredHandler;
        }
    }, {
        key: 'onHandshaked',
        set: function set(handshakedHandler) {
            this._handshakedHandler = handshakedHandler;
        }
    }, {
        key: 'onReconnected',
        set: function set(reconnectedHandler) {
            this._reconnectedHandler = reconnectedHandler;
        }
    }, {
        key: 'onRemoteHungup',
        set: function set(remoteHungupHandler) {
            this._remoteHungupHandler = remoteHungupHandler;
        }
    }, {
        key: 'onDisconnected',
        set: function set(disconnectedHandler) {
            this._disconnectedHandler = disconnectedHandler;
        }
    }, {
        key: 'onFailed',
        set: function set(failedHandler) {
            this._failedHandler = failedHandler;
        }
    }, {
        key: 'state',
        get: function get() {
            return this._state;
        }
    }]);
    return AmznRtcSignaling;
}();

exports.default = AmznRtcSignaling;

},{"./exceptions":135,"./rtc_const":136,"./utils":145,"./virtual_wss_connection_manager":146,"babel-runtime/helpers/asyncToGenerator":10,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12,"babel-runtime/helpers/inherits":14,"babel-runtime/helpers/possibleConstructorReturn":15,"babel-runtime/regenerator":17,"uuid/v4":121}],142:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _classCallCheck2 = require("babel-runtime/helpers/classCallCheck");

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require("babel-runtime/helpers/createClass");

var _createClass3 = _interopRequireDefault(_createClass2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var CCPInitiationStrategyInterface = function () {
    function CCPInitiationStrategyInterface() {
        (0, _classCallCheck3.default)(this, CCPInitiationStrategyInterface);

        console.log("CCPInitiationStrategyInterface initialized");
    }

    (0, _createClass3.default)(CCPInitiationStrategyInterface, [{
        key: "getStrategyName",
        value: function getStrategyName() {
            console.error("getStrategyName needs to be overridden");
        }

        // the following functions are rtc_peer_connection_factory related functions
        // check if the browser supports early media connection

    }, {
        key: "_isEarlyMediaConnectionSupported",
        value: function _isEarlyMediaConnectionSupported() {
            console.error("_isEarlyMediaConnectionSupported needs to be overridden");
        }
    }, {
        key: "_createRtcPeerConnection",
        value: function _createRtcPeerConnection() {
            console.error("_createRtcPeerConnection needs to be overridden");
        }

        // the following functions are rtc_session related functions

    }, {
        key: "_guM",
        value: function _guM() {
            console.error("_guM needs to be overridden");
        }
    }, {
        key: "addStream",
        value: function addStream() {
            console.error("addStream needs to be overridden");
        }
    }, {
        key: "setRemoteDescription",
        value: function setRemoteDescription() {
            console.error("setRemoteDescription needs to be overridden");
        }
    }, {
        key: "onIceStateChange",
        value: function onIceStateChange() {
            console.error("onIceStateChange needs to be overridden");
        }
    }, {
        key: "onPeerConnectionStateChange",
        value: function onPeerConnectionStateChange() {
            console.error("onPeerConnectionStateChange needs to be overridden");
        }
    }, {
        key: "_createPeerConnection",
        value: function _createPeerConnection() {
            console.error("_createPeerConnection needs to be overridden");
        }
    }, {
        key: "connect",
        value: function connect() {
            console.error("connect needs to be overridden");
        }
    }, {
        key: "_ontrack",
        value: function _ontrack() {
            console.error("_ontrack needs to be overridden");
        }
    }, {
        key: "_buildMediaConstraints",
        value: function _buildMediaConstraints() {
            console.error("_buildMediaConstraints needs to be overridden");
        }
    }]);
    return CCPInitiationStrategyInterface;
}();

exports.default = CCPInitiationStrategyInterface;

},{"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}],143:[function(require,module,exports){
(function (global){(function (){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _classCallCheck2 = require("babel-runtime/helpers/classCallCheck");

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require("babel-runtime/helpers/createClass");

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require("babel-runtime/helpers/possibleConstructorReturn");

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require("babel-runtime/helpers/inherits");

var _inherits3 = _interopRequireDefault(_inherits2);

var _CCPInitiationStrategyInterface = require("./CCPInitiationStrategyInterface");

var _CCPInitiationStrategyInterface2 = _interopRequireDefault(_CCPInitiationStrategyInterface);

var _rtc_session = require("../rtc_session");

var _rtc_const = require("../rtc_const");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var CitrixVDIStrategy = function (_CCPInitiationStrateg) {
    (0, _inherits3.default)(CitrixVDIStrategy, _CCPInitiationStrateg);

    function CitrixVDIStrategy() {
        var useRealCitrix = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
        (0, _classCallCheck3.default)(this, CitrixVDIStrategy);

        var _this = (0, _possibleConstructorReturn3.default)(this, (CitrixVDIStrategy.__proto__ || Object.getPrototypeOf(CitrixVDIStrategy)).call(this));

        if (useRealCitrix) {
            require("@citrix/ucsdk/CitrixWebRTC");
        }
        console.log("CitrixVDIStrategy initializing");
        _this.initCitrixWebRTC();
        _this.initGetCitrixWebrtcRedir();
        _this.initLog();
        return _this;
    }

    (0, _createClass3.default)(CitrixVDIStrategy, [{
        key: "initCitrixWebRTC",
        value: function initCitrixWebRTC() {
            window.CitrixWebRTC.setVMEventCallback(function (event) {
                if (event.event === 'vdiClientConnected') {
                    if (!window.CitrixWebRTC.isFeatureOn("webrtc1.0")) {
                        throw new Error('Citrix WebRTC redirection feature is NOT supported!');
                    }
                    console.log("CitrixVDIStrategy initialized");
                } else if (event.event === 'vdiClientDisconnected') {
                    console.log("vdiClientDisconnected");
                }
            });
            window.CitrixWebRTC.initUCSDK("AmazonConnect");
        }
    }, {
        key: "initGetCitrixWebrtcRedir",
        value: function initGetCitrixWebrtcRedir() {
            window.getCitrixWebrtcRedir = function () {
                return Promise.resolve(1);
            };
        }
    }, {
        key: "initLog",
        value: function initLog() {
            window.CitrixWebRTC.initLog(global.connect.getLog());
        }

        // the following functions are rtc_peer_connection_factory related functions
        // check if the browser supports early media connection

    }, {
        key: "_isEarlyMediaConnectionSupported",
        value: function _isEarlyMediaConnectionSupported() {
            // Citrix WebRTC SDK doesn't support early media connection
            return false;
        }
    }, {
        key: "_createRtcPeerConnection",
        value: function _createRtcPeerConnection(rtcPeerConnectionConfig, rtcPeerConnectionOptionalConfig) {
            return new window.CitrixWebRTC.CitrixPeerConnection(rtcPeerConnectionConfig, rtcPeerConnectionOptionalConfig);
        }

        // the following functions are rtc_session related functions

    }, {
        key: "_gUM",
        value: function _gUM(constraints) {
            return window.CitrixWebRTC.getUserMedia(constraints);
        }
    }, {
        key: "addStream",
        value: function addStream(_pc, stream) {
            stream.getTracks().forEach(function (track) {
                _pc.addTransceiver(track, {});
            });
        }
    }, {
        key: "setRemoteDescription",
        value: function setRemoteDescription(self, rtcSession) {
            var answerSessionDescription = self._createSessionDescription({ type: 'answer', sdp: self._sdp });

            rtcSession._pc.setRemoteDescription(answerSessionDescription, function () {
                var remoteCandidatePromises = Promise.all(self._candidates.map(function (candidate) {
                    var remoteCandidate = self._createRemoteCandidate(candidate);
                    self.logger.info('Adding remote candidate', remoteCandidate);
                    return rtcSession._pc.addIceCandidate(remoteCandidate);
                }));
                remoteCandidatePromises.catch(function (reason) {
                    self.logger.warn('Error adding remote candidate', reason);
                });
                rtcSession._sessionReport.setRemoteDescriptionFailure = false;
                self._remoteDescriptionSet = true;
                self._checkAndTransit();
            }, function () {
                rtcSession._stopSession();
                rtcSession._sessionReport.setRemoteDescriptionFailure = true;
                self.transit(new _rtc_session.FailedState(rtcSession, _rtc_const.RTC_ERRORS.SET_REMOTE_DESCRIPTION_FAILURE));
            });
        }
    }, {
        key: "onIceStateChange",
        value: function onIceStateChange(evt, _pc) {
            return _pc.iceConnectionState;
        }
    }, {
        key: "onPeerConnectionStateChange",
        value: function onPeerConnectionStateChange(_pc) {
            return _pc.connectionState_;
        }
    }, {
        key: "_createPeerConnection",
        value: function _createPeerConnection(configuration, optionalConfiguration) {
            return new window.CitrixWebRTC.CitrixPeerConnection(configuration, optionalConfiguration);
        }
    }, {
        key: "_ontrack",
        value: function _ontrack(self, evt) {
            window.CitrixWebRTC.mapAudioElement(self._remoteAudioElement);
            if (evt.streams.length > 1) {
                self._logger.warn('Found more than 1 streams for ' + evt.track.kind + ' track ' + evt.track.id + ' : ' + evt.streams.map(function (stream) {
                    return stream.id;
                }).join(','));
            }
            if (evt.track.kind === 'video' && self._remoteVideoElement) {
                self._remoteVideoElement.srcObject = evt.streams[0];
                self._remoteVideoStream = evt.streams[0];
            } else if (evt.track.kind === 'audio' && self._remoteAudioElement) {
                self._remoteAudioElement.srcObject = evt.streams[0];
                self._remoteAudioStream = evt.streams[0];
            }
            self._remoteAudioElement.play();
        }
    }, {
        key: "_buildMediaConstraints",
        value: function _buildMediaConstraints(self, mediaConstraints) {
            if (self._enableAudio) {
                var audioConstraints = {};
                if (typeof self._echoCancellation !== 'undefined') {
                    audioConstraints.echoCancellation = !!self._echoCancellation;
                }
                if (window.audio_input) {
                    audioConstraints.deviceId = window.audio_input;
                }
                if (Object.keys(audioConstraints).length > 0) {
                    mediaConstraints.audio = audioConstraints;
                } else {
                    mediaConstraints.audio = true;
                }
            } else {
                mediaConstraints.audio = false;
            }
        }
    }, {
        key: "getStrategyName",
        value: function getStrategyName() {
            return 'CitrixVDIStrategy';
        }
    }]);
    return CitrixVDIStrategy;
}(_CCPInitiationStrategyInterface2.default); /**
                                              * By using the Citrix ucsdk (https://www.npmjs.com/package/@citrix/ucsdk), you are accepting the Citrix Developer Terms of Use  located here: https://www.cloud.com/terms-of-use.
                                              */

exports.default = CitrixVDIStrategy;

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../rtc_const":136,"../rtc_session":138,"./CCPInitiationStrategyInterface":142,"@citrix/ucsdk/CitrixWebRTC":1,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12,"babel-runtime/helpers/inherits":14,"babel-runtime/helpers/possibleConstructorReturn":15}],144:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _classCallCheck2 = require("babel-runtime/helpers/classCallCheck");

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require("babel-runtime/helpers/createClass");

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require("babel-runtime/helpers/possibleConstructorReturn");

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require("babel-runtime/helpers/inherits");

var _inherits3 = _interopRequireDefault(_inherits2);

var _CCPInitiationStrategyInterface = require("./CCPInitiationStrategyInterface");

var _CCPInitiationStrategyInterface2 = _interopRequireDefault(_CCPInitiationStrategyInterface);

var _rtc_const = require("../rtc_const");

var _utils = require("../utils");

var _rtc_session = require("../rtc_session");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var StandardStrategy = function (_CCPInitiationStrateg) {
    (0, _inherits3.default)(StandardStrategy, _CCPInitiationStrateg);

    function StandardStrategy() {
        (0, _classCallCheck3.default)(this, StandardStrategy);

        var _this = (0, _possibleConstructorReturn3.default)(this, (StandardStrategy.__proto__ || Object.getPrototypeOf(StandardStrategy)).call(this));

        console.log("StandardStrategy initialized");
        return _this;
    }

    // the following functions are rtc_peer_connection_factory related functions
    // check if the browser supports early media connection


    (0, _createClass3.default)(StandardStrategy, [{
        key: "_isEarlyMediaConnectionSupported",
        value: function _isEarlyMediaConnectionSupported() {
            return (0, _utils.isChromeBrowser)() && (0, _utils.getChromeBrowserVersion)() >= _rtc_const.CHROME_SUPPORTED_VERSION;
        }
    }, {
        key: "_createRtcPeerConnection",
        value: function _createRtcPeerConnection(rtcPeerConnectionConfig, rtcPeerConnectionOptionalConfig) {
            return new RTCPeerConnection(rtcPeerConnectionConfig, rtcPeerConnectionOptionalConfig);
        }

        // the following functions are rtc_session related functions

    }, {
        key: "_gUM",
        value: function _gUM(constraints) {
            return navigator.mediaDevices.getUserMedia(constraints);
        }
    }, {
        key: "addStream",
        value: function addStream(_pc, stream) {
            _pc.addStream(stream);
        }
    }, {
        key: "setRemoteDescription",
        value: function setRemoteDescription(self, rtcSession) {
            var setRemoteDescriptionPromise = rtcSession._pc.setRemoteDescription(self._createSessionDescription({
                type: 'answer',
                sdp: self._sdp
            }));
            setRemoteDescriptionPromise.catch(function (e) {
                self.logger.error('SetRemoteDescription failed', e);
            });
            setRemoteDescriptionPromise.then(function () {
                var remoteCandidatePromises = Promise.all(self._candidates.map(function (candidate) {
                    var remoteCandidate = self._createRemoteCandidate(candidate);
                    self.logger.info('Adding remote candidate', remoteCandidate);
                    return rtcSession._pc.addIceCandidate(remoteCandidate);
                }));
                remoteCandidatePromises.catch(function (reason) {
                    self.logger.warn('Error adding remote candidate', reason);
                });
                return remoteCandidatePromises;
            }).then(function () {
                rtcSession._sessionReport.setRemoteDescriptionFailure = false;
                self._remoteDescriptionSet = true;
                self._checkAndTransit();
            }).catch(function () {
                rtcSession._stopSession();
                rtcSession._sessionReport.setRemoteDescriptionFailure = true;
                self.transit(new _rtc_session.FailedState(rtcSession, _rtc_const.RTC_ERRORS.SET_REMOTE_DESCRIPTION_FAILURE));
            });
        }
    }, {
        key: "onIceStateChange",
        value: function onIceStateChange(evt, _pc) {
            // eslint-disable-line no-unused-vars
            return evt.currentTarget.iceConnectionState;
        }
    }, {
        key: "onPeerConnectionStateChange",
        value: function onPeerConnectionStateChange(_pc) {
            return _pc.connectionState;
        }
    }, {
        key: "_createPeerConnection",
        value: function _createPeerConnection(configuration, optionalConfiguration) {
            return new RTCPeerConnection(configuration, optionalConfiguration);
        }
    }, {
        key: "_ontrack",
        value: function _ontrack(self, evt) {
            if (evt.streams.length > 1) {
                self._logger.warn('Found more than 1 streams for ' + evt.track.kind + ' track ' + evt.track.id + ' : ' + evt.streams.map(function (stream) {
                    return stream.id;
                }).join(','));
            }
            if (evt.track.kind === 'video' && self._remoteVideoElement) {
                self._remoteVideoElement.srcObject = evt.streams[0];
                self._remoteVideoStream = evt.streams[0];
            } else if (evt.track.kind === 'audio' && self._remoteAudioElement) {
                self._remoteAudioElement.srcObject = evt.streams[0];
                self._remoteAudioStream = evt.streams[0];
            }
        }
    }, {
        key: "_buildMediaConstraints",
        value: function _buildMediaConstraints(self, mediaConstraints) {
            if (self._enableAudio) {
                var audioConstraints = {};
                if (typeof self._echoCancellation !== 'undefined') {
                    audioConstraints.echoCancellation = !!self._echoCancellation;
                }
                if (Object.keys(audioConstraints).length > 0) {
                    mediaConstraints.audio = audioConstraints;
                } else {
                    mediaConstraints.audio = true;
                }
            } else {
                mediaConstraints.audio = false;
            }
        }
    }, {
        key: "getStrategyName",
        value: function getStrategyName() {
            return 'StandardStrategy';
        }
    }]);
    return StandardStrategy;
}(_CCPInitiationStrategyInterface2.default);

exports.default = StandardStrategy;

},{"../rtc_const":136,"../rtc_session":138,"../utils":145,"./CCPInitiationStrategyInterface":142,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12,"babel-runtime/helpers/inherits":14,"babel-runtime/helpers/possibleConstructorReturn":15}],145:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.SdpOptions = undefined;

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

exports.hitch = hitch;
exports.wrapLogger = wrapLogger;
exports.closeStream = closeStream;
exports.transformSdp = transformSdp;
exports.is_defined = is_defined;
exports.when_defined = when_defined;
exports.isLegacyStatsReportSupported = isLegacyStatsReportSupported;
exports.isFunction = isFunction;
exports.assertTrue = assertTrue;
exports.isChromeBrowser = isChromeBrowser;
exports.getChromeBrowserVersion = getChromeBrowserVersion;
exports.getRedactedSdp = getRedactedSdp;

var _exceptions = require('./exceptions');

var _sdp = require('sdp');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * All logging methods used by connect-rtc.
 */
/**
 * Copyright 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */

var logMethods = ['log', 'info', 'warn', 'error'];

/**
 * Binds the given instance object as the context for
 * the method provided.
 *
 * @param scope The instance object to be set as the scope
 *    of the function.
 * @param method The method to be encapsulated.
 *
 * All other arguments, if any, are bound to the method
 * invocation inside the closure.
 *
 * @return A closure encapsulating the invocation of the
 *    method provided in context of the given instance.
 */
function hitch() {
    var args = Array.prototype.slice.call(arguments);
    var scope = args.shift();
    var method = args.shift();

    if (!scope) {
        throw new _exceptions.IllegalParameters('utils.hitch(): scope is required!');
    }

    if (!method) {
        throw new _exceptions.IllegalParameters('utils.hitch(): method is required!');
    }

    if (typeof method !== 'function') {
        throw new _exceptions.IllegalParameters('utils.hitch(): method is not a function!');
    }

    return function _hitchedFunction() {
        var closureArgs = Array.prototype.slice.call(arguments);
        return method.apply(scope, args.concat(closureArgs));
    };
}

function wrapLogger(logger, callId, logCategory) {
    var _logger = {};
    logMethods.forEach(function (logMethod) {
        if (!logger[logMethod]) {
            throw new Error('Logging method ' + logMethod + ' required');
        }
        _logger[logMethod] = hitch(logger, logger[logMethod], callId, logCategory);
    });
    return _logger;
}

function closeStream(stream) {
    if (stream) {
        var tracks = stream.getTracks();
        for (var i = 0; i < tracks.length; i++) {
            var track = tracks[i];
            try {
                track.stop();
            } catch (e) {
                // eat exception
            }
        }
    }
}

/**
 * A parameter of transformSdp.
 * This defines all the SDP options connect-rtc-js supports.
 */

var SdpOptions = exports.SdpOptions = function () {
    function SdpOptions() {
        (0, _classCallCheck3.default)(this, SdpOptions);

        this._forceCodec = {};
    }

    (0, _createClass3.default)(SdpOptions, [{
        key: '_shouldDeleteCodec',


        /**
         * Test if given codec should be removed from SDP.
         * @param mediaType audio|video
         * @param codecName case insensitive
         * @return TRUE - should remove
         */
        value: function _shouldDeleteCodec(mediaType, codecName) {
            var upperCaseCodecName = codecName.toUpperCase();
            return this._forceCodec[mediaType] && upperCaseCodecName !== this._forceCodec[mediaType].toUpperCase() && upperCaseCodecName !== 'TELEPHONE-EVENT';
        }
    }, {
        key: 'enableOpusDtx',
        get: function get() {
            return this._enableOpusDtx;
        }

        /**
         * By default transformSdp disables dtx for OPUS codec.
         * Setting this to true would force it to turn on DTX.
         */
        ,
        set: function set(flag) {
            this._enableOpusDtx = flag;
        }

        /**
         * A map from media type (audio/video) to codec (case insensitive).
         * Add entry for force connect-rtc-js to use specified codec for certain media type.
         * For example: sdpOptions.forceCodec['audio'] = 'opus';
         */

    }, {
        key: 'forceCodec',
        get: function get() {
            return this._forceCodec;
        }
    }]);
    return SdpOptions;
}();

/**
 * Modifies input SDP according to sdpOptions.
 * See SdpOptions for available options.
 * @param sdp original SDP
 * @param sdpOptions defines changes to be applied to SDP
 * @returns a map with 'sdp' containing the transformed SDP and 'mLines' containing the number of m lines in SDP
 */


function transformSdp(sdp, sdpOptions) {
    var sections = (0, _sdp.splitSections)(sdp);
    for (var i = 1; i < sections.length; i++) {
        var mediaType = (0, _sdp.getKind)(sections[i]);
        var rtpParams = (0, _sdp.parseRtpParameters)(sections[i]);
        // a map from payload type (string) to codec object
        var codecMap = rtpParams.codecs.reduce(function (map, codec) {
            map['' + codec.payloadType] = codec;
            return map;
        }, {});
        sections[i] = (0, _sdp.splitLines)(sections[i]).map(function (line) {
            if (line.startsWith('m=')) {
                // modify m= line if SdpOptions#forceCodec specifies codec for current media type
                if (sdpOptions.forceCodec[mediaType]) {
                    var targetCodecPts = Object.keys(codecMap).filter(function (pt) {
                        return !sdpOptions._shouldDeleteCodec(mediaType, codecMap[pt].name);
                    });
                    return (/.*RTP\/S?AVPF? /.exec(line) + targetCodecPts.join(' ')
                    );
                } else {
                    return line;
                }
            } else if (line.startsWith('a=rtpmap:')) {
                var rtpMap = (0, _sdp.parseRtpMap)(line);
                var currentCodec = codecMap[rtpMap.payloadType];

                // remove this codec if SdpOptions#forceCodec specifies a different codec for current media type
                if (is_defined(currentCodec) && sdpOptions._shouldDeleteCodec(mediaType, currentCodec.name)) {
                    return null;
                }

                // append a=fmtp line immediately if current codec is OPUS (to explicitly specify OPUS parameters)
                if (is_defined(currentCodec) && currentCodec.name.toUpperCase() === 'OPUS') {
                    currentCodec.parameters.usedtx = sdpOptions.enableOpusDtx ? "1" : "0";
                    // generate fmtp line immediately after rtpmap line, and remove original fmtp line once we see it
                    return (line + "\r\n" + (0, _sdp.writeFmtp)(currentCodec)).trim();
                } else {
                    return line;
                }
            } else if (line.startsWith('a=fmtp:')) {
                var pt = line.substring('a=fmtp:'.length, line.indexOf(' '));
                var currentCodec = codecMap[pt]; // eslint-disable-line no-redeclare

                // remove this codec if SdpOptions#forceCodec specifies a different codec for current media type
                if (is_defined(currentCodec) && sdpOptions._shouldDeleteCodec(mediaType, currentCodec.name)) {
                    return null;
                }

                if (is_defined(currentCodec) && currentCodec.name.toUpperCase() === 'OPUS') {
                    // this is a line for OPUS, remove it because FMTP line is already generated when rtpmap line is processed
                    return null;
                } else {
                    return line;
                }
            } else if (line.startsWith('a=rtcp-fb:')) {
                var pt = line.substring(line.indexOf(':') + 1, line.indexOf(' ')); // eslint-disable-line no-redeclare
                if (pt === '*') {
                    //always allow wildcard in rtc-fb
                    return line;
                } else {
                    var currentCodec = codecMap[pt]; // eslint-disable-line no-redeclare

                    // remove this codec if SdpOptions#forceCodec specifies a different codec for current media type
                    if (is_defined(currentCodec) && sdpOptions._shouldDeleteCodec(mediaType, currentCodec.name)) {
                        return null;
                    } else {
                        return line;
                    }
                }
            } else {
                return line;
            }
        }).filter(function (line) {
            return line !== null;
        }).join('\r\n');
    }
    return {
        sdp: sections.map(function (section) {
            return section.trim();
        }).join('\r\n') + '\r\n',
        mLines: sections.length - 1 // first section is session description, the rest are media descriptions
    };
}

function is_defined(v) {
    return typeof v !== 'undefined';
}

function when_defined(v, alternativeIn) {
    var alternative = is_defined(alternativeIn) ? alternativeIn : null;
    return is_defined(v) ? v : alternative;
}

/**
 * Check if the getStats API for retrieving legacy stats report is supported
 */
function isLegacyStatsReportSupported(pc) {
    return new Promise(function (resolve) {
        pc.getStats(function () {
            resolve(true);
        }).catch(function () {
            // Exception thrown if browser does not support legacy stats report
            resolve(false);
        });
    });
}

/**
 * Determine if the given value is a callable function type.
 * Borrowed from Underscore.js.
 */
function isFunction(obj) {
    return !!(obj && obj.constructor && obj.call && obj.apply);
}

/**
 * Asserts that a premise is true.
 */
function assertTrue(premise, message) {
    if (!premise) {
        throw new Error(message);
    }
}

function isChromeBrowser() {
    return navigator.userAgent.indexOf("Chrome") !== -1;
}

function getChromeBrowserVersion() {
    var userAgent = navigator.userAgent;
    var chromeVersion = userAgent.substring(userAgent.indexOf("Chrome") + 7);
    if (chromeVersion) {
        return parseFloat(chromeVersion);
    } else {
        return -1;
    }
}

function getRedactedSdp(sdp) {
    // pattern to find and redact the value after 'a=ice-pwd:'
    var pattern = /a=ice-pwd:[^\r\n]*/;

    // Use the replace method to redact the value with '[redacted]'
    return sdp.replace(pattern, 'a=ice-pwd:[redacted]');
}

},{"./exceptions":135,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12,"sdp":118}],146:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _utils = require('./utils');

var _rtc_const = require('./rtc_const');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var VirtualWssConnectionManager = function () {
    function VirtualWssConnectionManager(logger, connectionId, wssManager) {
        (0, _classCallCheck3.default)(this, VirtualWssConnectionManager);

        this._logger = logger;
        this._connectionId = connectionId;
        this._wssManager = wssManager;
        this._initializeWebSocketEventListeners();
    }

    (0, _createClass3.default)(VirtualWssConnectionManager, [{
        key: '_initializeWebSocketEventListeners',
        value: function _initializeWebSocketEventListeners() {
            var _this = this;

            this._wssManager.subscribeTopics([_rtc_const.SOFTPHONE_ROUTE_KEY]);
            this._unSubscribe = this._wssManager.onMessage(_rtc_const.SOFTPHONE_ROUTE_KEY, (0, _utils.hitch)(this, this._webSocketManagerOnMessage));
            setTimeout(function () {
                _this._onOpen();
            }, 0);
        }
    }, {
        key: '_webSocketManagerOnMessage',
        value: function _webSocketManagerOnMessage(event) {
            var content = void 0;
            if (event.content) {
                content = JSON.parse(event.content);
            }
            if (this._onMessage && content && this._connectionId === content.connectionId) {
                this._onMessage({ data: JSON.stringify(content.jsonRpcMsg) });
            }
        }
    }, {
        key: 'send',
        value: function send(webSocketPayload) {
            var payload = {};
            try {
                payload.topic = _rtc_const.SOFTPHONE_ROUTE_KEY;
                payload.connectionId = this._connectionId;
                payload.jsonRpcMsg = JSON.parse(webSocketPayload);
                this._wssManager.sendMessage(payload);
            } catch (error) {
                this._logger.error("Error in sendMessage ", error);
            }
        }
    }, {
        key: 'close',
        value: function close() {
            this._logger.info("closing virtual connection");
            this._unSubscribe();
        }
    }, {
        key: 'onmessage',
        set: function set(callBack) {
            this._onMessage = callBack;
        }
    }, {
        key: 'onopen',
        set: function set(callBack) {
            this._onOpen = callBack;
        }
    }]);
    return VirtualWssConnectionManager;
}();

exports.default = VirtualWssConnectionManager;

},{"./rtc_const":136,"./utils":145,"babel-runtime/helpers/classCallCheck":11,"babel-runtime/helpers/createClass":12}]},{},[134])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvQGNpdHJpeC91Y3Nkay9DaXRyaXhXZWJSVEMuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9jcmVhdGUuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHkuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9nZXQtcHJvdG90eXBlLW9mLmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZi5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZS5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2NvcmUtanMvc3ltYm9sLmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvY29yZS1qcy9zeW1ib2wvaXRlcmF0b3IuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3IuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrLmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcy5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0LmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvaGVscGVycy9pbmhlcml0cy5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybi5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2hlbHBlcnMvdHlwZW9mLmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvcmVnZW5lcmF0b3IvaW5kZXguanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9jcmVhdGUuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9kZWZpbmUtcHJvcGVydHkuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9nZXQtcHJvdG90eXBlLW9mLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9mbi9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZi5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvZm4vcHJvbWlzZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvZm4vc3ltYm9sL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9mbi9zeW1ib2wvaXRlcmF0b3IuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2EtZnVuY3Rpb24uanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2FkZC10by11bnNjb3BhYmxlcy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fYW4taW5zdGFuY2UuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2FuLW9iamVjdC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fYXJyYXktaW5jbHVkZXMuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2NsYXNzb2YuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2NvZi5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fY29yZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fY3R4LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19kZWZpbmVkLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19kZXNjcmlwdG9ycy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fZG9tLWNyZWF0ZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fZW51bS1idWcta2V5cy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fZW51bS1rZXlzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19leHBvcnQuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2ZhaWxzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19mb3Itb2YuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2dsb2JhbC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faGFzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19oaWRlLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19odG1sLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pZTgtZG9tLWRlZmluZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faW52b2tlLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pb2JqZWN0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pcy1hcnJheS1pdGVyLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pcy1hcnJheS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faXMtb2JqZWN0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pdGVyLWNhbGwuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2l0ZXItY3JlYXRlLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pdGVyLWRlZmluZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faXRlci1kZXRlY3QuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2l0ZXItc3RlcC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9faXRlcmF0b3JzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19saWJyYXJ5LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19tZXRhLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19taWNyb3Rhc2suanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX25ldy1wcm9taXNlLWNhcGFiaWxpdHkuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1jcmVhdGUuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1kcC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fb2JqZWN0LWRwcy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fb2JqZWN0LWdvcGQuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1nb3BuLWV4dC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fb2JqZWN0LWdvcG4uanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1nb3BzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3QtZ3BvLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19vYmplY3Qta2V5cy1pbnRlcm5hbC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fb2JqZWN0LWtleXMuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1waWUuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX29iamVjdC1zYXAuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3BlcmZvcm0uanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3Byb21pc2UtcmVzb2x2ZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fcHJvcGVydHktZGVzYy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fcmVkZWZpbmUtYWxsLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19yZWRlZmluZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fc2V0LXByb3RvLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19zZXQtc3BlY2llcy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fc2V0LXRvLXN0cmluZy10YWcuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3NoYXJlZC1rZXkuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3NoYXJlZC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fc3BlY2llcy1jb25zdHJ1Y3Rvci5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fc3RyaW5nLWF0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190YXNrLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190by1hYnNvbHV0ZS1pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fdG8taW50ZWdlci5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fdG8taW9iamVjdC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fdG8tbGVuZ3RoLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL190by1vYmplY3QuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX3RvLXByaW1pdGl2ZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fdWlkLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL191c2VyLWFnZW50LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL193a3MtZGVmaW5lLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL193a3MtZXh0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL193a3MuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5hcnJheS5pdGVyYXRvci5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYub2JqZWN0LmNyZWF0ZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvci5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYub2JqZWN0LmdldC1wcm90b3R5cGUtb2YuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvZXM2Lm9iamVjdC5zZXQtcHJvdG90eXBlLW9mLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5wcm9taXNlLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvZXM2LnN5bWJvbC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczcucHJvbWlzZS5maW5hbGx5LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNy5wcm9taXNlLnRyeS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczcuc3ltYm9sLmFzeW5jLWl0ZXJhdG9yLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNy5zeW1ib2wub2JzZXJ2YWJsZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlLmpzIiwibm9kZV9tb2R1bGVzL3JlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS1tb2R1bGUuanMiLCJub2RlX21vZHVsZXMvcmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIiwibm9kZV9tb2R1bGVzL3J0Y3BlZXJjb25uZWN0aW9uLXNoaW0vcnRjcGVlcmNvbm5lY3Rpb24uanMiLCJub2RlX21vZHVsZXMvc2RwL3NkcC5qcyIsIm5vZGVfbW9kdWxlcy91dWlkL2xpYi9ieXRlc1RvVXVpZC5qcyIsIm5vZGVfbW9kdWxlcy91dWlkL2xpYi9ybmctYnJvd3Nlci5qcyIsIm5vZGVfbW9kdWxlcy91dWlkL3Y0LmpzIiwibm9kZV9tb2R1bGVzL3dlYnJ0Yy1hZGFwdGVyL3NyYy9qcy9hZGFwdGVyX2NvcmUuanMiLCJub2RlX21vZHVsZXMvd2VicnRjLWFkYXB0ZXIvc3JjL2pzL2FkYXB0ZXJfZmFjdG9yeS5qcyIsIm5vZGVfbW9kdWxlcy93ZWJydGMtYWRhcHRlci9zcmMvanMvY2hyb21lL2Nocm9tZV9zaGltLmpzIiwibm9kZV9tb2R1bGVzL3dlYnJ0Yy1hZGFwdGVyL3NyYy9qcy9jaHJvbWUvZ2V0dXNlcm1lZGlhLmpzIiwibm9kZV9tb2R1bGVzL3dlYnJ0Yy1hZGFwdGVyL3NyYy9qcy9jb21tb25fc2hpbS5qcyIsIm5vZGVfbW9kdWxlcy93ZWJydGMtYWRhcHRlci9zcmMvanMvZWRnZS9lZGdlX3NoaW0uanMiLCJub2RlX21vZHVsZXMvd2VicnRjLWFkYXB0ZXIvc3JjL2pzL2VkZ2UvZmlsdGVyaWNlc2VydmVycy5qcyIsIm5vZGVfbW9kdWxlcy93ZWJydGMtYWRhcHRlci9zcmMvanMvZWRnZS9nZXR1c2VybWVkaWEuanMiLCJub2RlX21vZHVsZXMvd2VicnRjLWFkYXB0ZXIvc3JjL2pzL2ZpcmVmb3gvZmlyZWZveF9zaGltLmpzIiwibm9kZV9tb2R1bGVzL3dlYnJ0Yy1hZGFwdGVyL3NyYy9qcy9maXJlZm94L2dldHVzZXJtZWRpYS5qcyIsIm5vZGVfbW9kdWxlcy93ZWJydGMtYWRhcHRlci9zcmMvanMvc2FmYXJpL3NhZmFyaV9zaGltLmpzIiwibm9kZV9tb2R1bGVzL3dlYnJ0Yy1hZGFwdGVyL3NyYy9qcy91dGlscy5qcyIsInNyYy9qcy9jb25uZWN0LXJ0Yy5qcyIsInNyYy9qcy9leGNlcHRpb25zLmpzIiwic3JjL2pzL3J0Y19jb25zdC5qcyIsInNyYy9qcy9ydGNfcGVlcl9jb25uZWN0aW9uX2ZhY3RvcnkuanMiLCJzcmMvanMvcnRjX3Nlc3Npb24uanMiLCJzcmMvanMvcnRwLXN0YXRzLmpzIiwic3JjL2pzL3Nlc3Npb25fcmVwb3J0LmpzIiwic3JjL2pzL3NpZ25hbGluZy5qcyIsInNyYy9qcy9zdHJhdGVnaWVzL0NDUEluaXRpYXRpb25TdHJhdGVneUludGVyZmFjZS5qcyIsInNyYy9qcy9zdHJhdGVnaWVzL0NpdHJpeFZESVN0cmF0ZWd5LmpzIiwic3JjL2pzL3N0cmF0ZWdpZXMvU3RhbmRhcmRTdHJhdGVneS5qcyIsInNyYy9qcy91dGlscy5qcyIsInNyYy9qcy92aXJ0dWFsX3dzc19jb25uZWN0aW9uX21hbmFnZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUMzb0JBOztBQ0FBOztBQ0FBOztBQ0FBOztBQ0FBOztBQ0FBOztBQ0FBOztBQ0FBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BCQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTs7QUNGQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNKQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTs7QUNGQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7O0FDREE7QUFDQTs7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUEE7QUFDQTs7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNUQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVEE7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5UkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0UEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNaQTtBQUNBOztBQ0RBO0FBQ0E7O0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3Z0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDajBEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6ekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6NkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdlBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUN4SkE7O0FBZUE7Ozs7QUFDQTs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7O0FBbkJBOzs7Ozs7Ozs7Ozs7OztBQXFCQSxPQUFPLE9BQVAsR0FBaUIsT0FBTyxPQUFQLElBQWtCLEVBQW5DLEMsQ0FsREE7Ozs7OztBQU1BOzs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JBOzs7Ozs7O0FBNkJBLE9BQU8sT0FBUCxDQUFlLFVBQWYsR0FBNEIscUJBQTVCO0FBQ0EsT0FBTyxPQUFQLENBQWUsU0FBZixHQUEyQixxQkFBM0I7QUFDQSxPQUFPLE9BQVAsQ0FBZSx3QkFBZixHQUEwQyxxQ0FBMUM7QUFDQSxPQUFPLE9BQVAsQ0FBZSxJQUFmLEdBQXNCLFdBQXRCO0FBQ0EsT0FBTyxPQUFQLENBQWUsZ0JBQWYsR0FBa0MsMEJBQWxDO0FBQ0EsT0FBTyxPQUFQLENBQWUsaUJBQWYsR0FBbUMsMkJBQW5DOztBQUVBLE9BQU8sSUFBUCxHQUFjLE9BQU8sSUFBUCxJQUFlLEVBQTdCO0FBQ0EsT0FBTyxJQUFQLENBQVksVUFBWixHQUF5QixxQkFBekI7QUFDQSxPQUFPLElBQVAsQ0FBWSxTQUFaLEdBQXdCLHFCQUF4Qjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1REE7Ozs7O0FBS08sSUFBTSxzREFBdUIsU0FBN0I7O0lBQ00sTyxXQUFBLE87OztBQUNULHFCQUFZLEdBQVosRUFBaUI7QUFBQTs7QUFBQSxvSUFDUCxHQURPOztBQUViLGNBQUssSUFBTCxHQUFZLG9CQUFaO0FBRmE7QUFHaEI7OztFQUp3QixLOztBQU90QixJQUFNLDREQUEwQixZQUFoQzs7SUFDTSxVLFdBQUEsVTs7O0FBQ1Qsd0JBQVksR0FBWixFQUFpQjtBQUFBOztBQUFBLDJJQUNQLEdBRE87O0FBRWIsZUFBSyxJQUFMLEdBQVksdUJBQVo7QUFGYTtBQUdoQjs7O0VBSjJCLE87O0FBT3pCLElBQU0sMEVBQWlDLG1CQUF2Qzs7SUFDTSxpQixXQUFBLGlCOzs7QUFDVCwrQkFBWSxHQUFaLEVBQWlCO0FBQUE7O0FBQUEseUpBQ1AsR0FETzs7QUFFYixlQUFLLElBQUwsR0FBWSw4QkFBWjtBQUZhO0FBR2hCOzs7RUFKa0MsSzs7QUFPaEMsSUFBTSxnRUFBNEIsY0FBbEM7O0lBQ00sWSxXQUFBLFk7OztBQUNULDBCQUFZLEdBQVosRUFBaUI7QUFBQTs7QUFBQSwrSUFDUCxHQURPOztBQUViLGVBQUssSUFBTCxHQUFZLHlCQUFaO0FBRmE7QUFHaEI7OztFQUo2QixLOztBQU8zQixJQUFNLGdGQUFvQyxzQkFBMUM7O0lBQ00sb0IsV0FBQSxvQjs7O0FBQ1Qsa0NBQVksR0FBWixFQUFpQjtBQUFBOztBQUFBLCtKQUNQLEdBRE87O0FBRWIsZUFBSyxJQUFMLEdBQVksaUNBQVo7QUFGYTtBQUdoQjs7O0VBSnFDLEs7O0FBT25DLElBQU0sZ0RBQW9CLGVBQTFCOztJQUNNLGEsV0FBQSxhOzs7QUFDVCwyQkFBWSxHQUFaLEVBQWlCO0FBQUE7O0FBQUEsaUpBQ1AsR0FETzs7QUFFYixlQUFLLElBQUwsR0FBWSxpQkFBWjtBQUZhO0FBR2hCOzs7RUFKOEIsSzs7QUFPNUIsSUFBTSxnRUFBNEIsdUJBQWxDOztJQUNNLHFCLFdBQUEscUI7OztBQUNULG1DQUFZLEdBQVosRUFBaUI7QUFBQTs7QUFBQSxpS0FDUCxHQURPOztBQUViLGVBQUssSUFBTCxHQUFZLHlCQUFaO0FBRmE7QUFHaEI7OztFQUpzQyxLOztBQU9wQyxJQUFNLGdFQUE0Qix1QkFBbEM7O0lBQ00scUIsV0FBQSxxQjs7O0FBQ1QscUNBQWM7QUFBQTs7QUFBQTs7QUFFVixlQUFLLElBQUwsR0FBWSx5QkFBWjtBQUZVO0FBR2I7OztFQUpzQyxLOzs7Ozs7OztBQzlEM0M7Ozs7OztBQU1BOzs7QUFHTyxJQUFNLDREQUEwQixJQUFoQztBQUNQOzs7QUFHTyxJQUFNLG9EQUFzQixJQUE1QjtBQUNQOzs7QUFHTyxJQUFNLGtFQUE2QixLQUFuQztBQUNQOzs7QUFHTyxJQUFNLDBEQUF5QixJQUEvQjtBQUNQOzs7QUFHTyxJQUFNLDBEQUF5QixLQUEvQjs7QUFFQSxJQUFNLG9EQUFzQixlQUE1Qjs7QUFFQSxJQUFNLGtEQUFxQixRQUEzQjtBQUNBLElBQU0sa0RBQXFCLFFBQTNCO0FBQ0EsSUFBTSw0Q0FBa0IsS0FBeEI7O0FBRUEsSUFBTSxrRUFBNkI7QUFDdEMsd0JBQW9CLE9BRGtCO0FBRXRDLG1CQUFlLFNBRnVCO0FBR3RDLGtCQUFjLFVBSHdCO0FBSXRDLGtCQUFjLGNBSndCO0FBS3RDLG9CQUFnQjtBQUxzQixDQUFuQzs7QUFRQSxJQUFNLG9GQUFzQztBQUMvQyxjQUFVLENBQ047QUFDSSxrQkFBVTs7QUFEZCxLQURNLEVBS047QUFDSSw4QkFBc0I7QUFEMUIsS0FMTTtBQURxQyxDQUE1Qzs7QUFZQSxJQUFNLDRFQUFrQyxDQUF4Qzs7QUFFQSxJQUFNLG9GQUFzQyxJQUFFLEVBQUYsR0FBSyxJQUFqRDs7QUFFQSxJQUFNLDBGQUF5QyxHQUEvQzs7QUFFQSxJQUFNLDhEQUEyQixFQUFqQzs7QUFFUDs7O0FBR08sSUFBTSxrQ0FBYTtBQUN0Qiw0QkFBeUIsd0JBREg7QUFFdEIsZUFBWSxXQUZVO0FBR3RCLG1DQUFnQywrQkFIVjtBQUl0QixrQ0FBK0IsOEJBSlQ7QUFLdEIsb0NBQWlDLGdDQUxYO0FBTXRCLDBCQUF1QixzQkFORDtBQU90QixtQ0FBZ0MsK0JBUFY7QUFRdEIsd0JBQXFCLG9CQVJDO0FBU3RCLDZCQUEwQix5QkFUSjtBQVV0Qix5QkFBc0IscUJBVkE7QUFXdEIsdUJBQW9CLG1CQVhFO0FBWXRCLG9CQUFnQjtBQVpNLENBQW5COztBQWVBLElBQU0sc0RBQXVCO0FBQ2hDLFNBQU0sS0FEMEI7QUFFaEMsY0FBVyxVQUZxQjtBQUdoQyxlQUFZLFdBSG9CO0FBSWhDLGVBQVksV0FKb0I7QUFLaEMsWUFBUyxRQUx1QjtBQU1oQyxrQkFBZSxjQU5pQjtBQU9oQyxZQUFTO0FBUHVCLENBQTdCOztBQVVBLElBQU0sd0RBQXdCO0FBQ2pDLFNBQU0sS0FEMkI7QUFFakMsZ0JBQWEsWUFGb0I7QUFHakMsZUFBWSxXQUhxQjtBQUlqQyxZQUFTLFFBSndCO0FBS2pDLGtCQUFlLGNBTGtCO0FBTWpDLFlBQVM7QUFOd0IsQ0FBOUI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDekZQOztBQUNBOztBQVFBOzs7O0FBQ0E7Ozs7OztJQUVxQix3Qjs7QUFFakI7QUFDQTtBQUNBLHNDQUFZLE1BQVosRUFBb0IsVUFBcEIsRUFBZ0MsUUFBaEMsRUFBMEMsZUFBMUMsRUFBMkQsWUFBM0QsRUFBNEc7QUFBQSxZQUFuQyxRQUFtQyx1RUFBeEIsSUFBSSwwQkFBSixFQUF3QjtBQUFBOztBQUN4RyxZQUFJLEVBQUUsb0JBQW9CLHdDQUF0QixDQUFKLEVBQTJEO0FBQ3ZELGtCQUFNLElBQUksS0FBSixDQUFVLDREQUFWLENBQU47QUFDSDtBQUNELCtCQUFXLHVCQUFXLGVBQVgsQ0FBWCxFQUF3QyxvQ0FBeEM7QUFDQSwrQkFBVyx1QkFBVyxZQUFYLENBQVgsRUFBcUMsaUNBQXJDO0FBQ0EsYUFBSyxTQUFMLEdBQWlCLFFBQWpCO0FBQ0EsYUFBSyxPQUFMLEdBQWUsTUFBZjtBQUNBLGFBQUssU0FBTCxHQUFpQixRQUFqQjtBQUNBLGFBQUssV0FBTCxHQUFtQixVQUFuQjtBQUNBLGFBQUssaUJBQUwsR0FBeUIsZUFBekI7QUFDQSxhQUFLLGFBQUwsR0FBcUIsWUFBckI7QUFDQSxhQUFLLDhCQUFMLEdBQXNDLEtBQUssZ0NBQUwsRUFBdEM7QUFDQSxhQUFLLGtDQUFMO0FBQ0EsYUFBSyxzQkFBTDtBQUNBLGFBQUssMkJBQUw7O0FBRUEsYUFBSyxPQUFMLENBQWEsR0FBYixDQUFpQixxQkFBcUIsU0FBUyxlQUFULEVBQXRDO0FBQ0g7Ozs7MkRBRWtDO0FBQy9CLG1CQUFPLEtBQUssU0FBTCxDQUFlLGdDQUFmLEVBQVA7QUFDSDs7QUFFRDs7OzttREFDMkIsSyxFQUFPO0FBQzlCLGdCQUFJLGdCQUFKO0FBQ0EsZ0JBQUksTUFBTSxPQUFWLEVBQW1CO0FBQ2YsMEJBQVUsS0FBSyxLQUFMLENBQVcsTUFBTSxPQUFqQixDQUFWO0FBQ0g7QUFDRCxnQkFBSSxXQUFXLEtBQUssU0FBTCxLQUFtQixRQUFRLFFBQTFDLEVBQW9EO0FBQ2hELG9CQUFJLFFBQVEsVUFBUixDQUFtQixNQUFuQixLQUE4QixnQkFBbEMsRUFBb0Q7QUFDaEQseUJBQUssMkJBQUw7QUFDSCxpQkFGRCxNQUVPLElBQUksUUFBUSxVQUFSLENBQW1CLE1BQW5CLEtBQThCLGVBQWxDLEVBQW1EO0FBQ3RELHlCQUFLLE9BQUwsQ0FBYSxHQUFiLENBQWlCLDBFQUEwRSxLQUFLLFNBQWhHO0FBQ0EseUJBQUssdUJBQUw7QUFDQSx5QkFBSyxhQUFMLENBQW1CLG9DQUFuQixFQUF5RCx3REFBekQ7QUFDSDtBQUNKO0FBQ0o7Ozs2REFFb0M7QUFDakMsaUJBQUssV0FBTCxDQUFpQixlQUFqQixDQUFpQyxDQUFDLDhCQUFELENBQWpDO0FBQ0EsaUJBQUssWUFBTCxHQUFvQixLQUFLLFdBQUwsQ0FBaUIsU0FBakIsQ0FBMkIsOEJBQTNCLEVBQWdELGtCQUFNLElBQU4sRUFBWSxLQUFLLDBCQUFqQixDQUFoRCxDQUFwQjtBQUNIOztBQUVEO0FBQ0E7Ozs7NEJBQ0ksVSxFQUFZO0FBQ1osZ0JBQUksT0FBTyxJQUFYO0FBQ0EsZ0JBQUksS0FBSyxLQUFLLEdBQWQ7QUFDQSxpQkFBSyxHQUFMLEdBQVcsSUFBWDtBQUNBLGdCQUFJLE1BQU0sSUFBVixFQUFnQjtBQUNaLHFCQUFLLEtBQUssd0JBQUwsQ0FBOEIsVUFBOUIsQ0FBTDtBQUNIO0FBQ0QsaUJBQUssaUNBQUw7QUFDQSxpQkFBSyxzQkFBTDtBQUNBLG1CQUFPLEVBQVA7QUFDSDs7OzREQUVtQztBQUNoQyxnQkFBSSxPQUFPLElBQVg7QUFDQSxnQkFBSSxLQUFLLDZCQUFULEVBQXdDO0FBQ3BDLDZCQUFhLEtBQUssNkJBQWxCO0FBQ0EscUJBQUssNkJBQUwsR0FBcUMsSUFBckM7QUFDSDtBQUNKOzs7aURBRXdCO0FBQ3JCLGdCQUFJLE9BQU8sSUFBWDtBQUNBLGdCQUFJLENBQUMsS0FBSyw4QkFBTixJQUF3QyxLQUFLLDhCQUFqRCxFQUFpRjtBQUM3RSxxQkFBSyw4QkFBTCxHQUFzQyxJQUF0QztBQUNBLHFCQUFLLGlCQUFMLEdBQXlCLElBQXpCLENBQThCLFVBQVUsUUFBVixFQUFvQjtBQUMxQyx5QkFBSyxHQUFMLEdBQVcsS0FBSyx3QkFBTCxDQUE4QixRQUE5QixDQUFYO0FBQ0EseUJBQUssOEJBQUwsR0FBc0MsS0FBdEM7QUFDQSx5QkFBSyw2QkFBTCxHQUFxQyxXQUFXLGtCQUFNLElBQU4sRUFBWSxLQUFLLHlCQUFqQixDQUFYLEVBQXdELDhDQUF4RCxDQUFyQztBQUNILGlCQUpMO0FBS0k7QUFDQSwwQkFBVSxNQUFWLEVBQWtCO0FBQ2QseUJBQUssOEJBQUwsR0FBc0MsS0FBdEM7QUFDSCxpQkFSTDtBQVNIO0FBQ0o7OztzREFFNkI7QUFDMUIsZ0JBQUksT0FBTyxJQUFYO0FBQ0Esd0JBQVksWUFBWTtBQUNwQixvQkFBSSxDQUFDLFVBQVUsTUFBWCxJQUFxQixLQUFLLEdBQTlCLEVBQW1DO0FBQy9CLHlCQUFLLE9BQUwsQ0FBYSxHQUFiLENBQWlCLCtDQUFqQjtBQUNBLHlCQUFLLEdBQUwsQ0FBUyxLQUFUO0FBQ0EseUJBQUssR0FBTCxHQUFXLElBQVg7QUFDSDtBQUNKLGFBTkQsRUFNRyxpREFOSDtBQU9IOzs7aURBRXdCLFUsRUFBWTtBQUNqQyxnQkFBSSwwQkFBMEIsS0FBSyxLQUFMLENBQVcsS0FBSyxTQUFMLENBQWUscUNBQWYsQ0FBWCxDQUE5QjtBQUNBLG9DQUF3QixVQUF4QixHQUFxQyxVQUFyQztBQUNBLG9DQUF3QixvQkFBeEIsR0FBK0MsMENBQS9DO0FBQ0EsbUJBQU8sS0FBSyxTQUFMLENBQWUsd0JBQWYsQ0FBd0MsdUJBQXhDLEVBQWlFLDhDQUFqRSxDQUFQO0FBQ0g7OztzREFFNkI7QUFDMUIsaUJBQUssT0FBTCxDQUFhLEdBQWIsQ0FBaUIsNEVBQTRFLEtBQUssU0FBbEc7QUFDQSxpQkFBSyx1QkFBTDtBQUNIOzs7b0RBRTJCO0FBQ3hCLGlCQUFLLDZCQUFMLEdBQXFDLElBQXJDO0FBQ0EsaUJBQUssMkJBQUw7QUFDQSxpQkFBSyxPQUFMLENBQWEsR0FBYixDQUFpQiwyQ0FBMkMsS0FBSyxTQUFqRTtBQUNBLGlCQUFLLHNCQUFMO0FBQ0g7OztrREFFeUI7QUFDdEIsZ0JBQUksS0FBSyxHQUFULEVBQWM7QUFDVixxQkFBSyxHQUFMLENBQVMsS0FBVDtBQUNBLHFCQUFLLEdBQUwsR0FBVyxJQUFYO0FBQ0g7QUFDSjs7Ozs7a0JBM0hnQix3Qjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDUHJCOztBQUNBOztBQUNBOztBQVNBOztBQVFBOzs7O0FBQ0E7Ozs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQUNBOzs7Ozs7QUE3QkE7Ozs7O0lBK0JhLGUsV0FBQSxlO0FBQ1Q7Ozs7QUFJQSw2QkFBWSxVQUFaLEVBQXdCO0FBQUE7O0FBQ3BCLGFBQUssV0FBTCxHQUFtQixVQUFuQjtBQUNIOzs7O2tDQUNTLENBQ1Q7OztpQ0FDUSxDQUNSOzs7MENBQ2lCO0FBQ2QsbUJBQU8sS0FBSyxXQUFMLENBQWlCLE1BQWpCLEtBQTRCLElBQW5DO0FBQ0g7OztnQ0FDTyxTLEVBQVc7QUFDZixnQkFBSSxLQUFLLGVBQUwsRUFBSixFQUE0QjtBQUN4QixxQkFBSyxXQUFMLENBQWlCLE9BQWpCLENBQXlCLFNBQXpCO0FBQ0g7QUFDSjs7O2lDQUlRO0FBQ0wsaUJBQUssT0FBTCxDQUFhLElBQUksV0FBSixDQUFnQixLQUFLLFdBQXJCLENBQWI7QUFDSDs7O3VDQUNjLEcsRUFBSyxDQUFDO0FBQ2pCO0FBQ0E7QUFDSDs7O3lDQUNnQjtBQUNiLGtCQUFNLElBQUksZ0NBQUosQ0FBeUIsdUNBQXVDLEtBQUssSUFBckUsQ0FBTjtBQUNIOzs7K0NBSXNCO0FBQ25CLGtCQUFNLElBQUksZ0NBQUosQ0FBeUIsNkNBQTZDLEtBQUssSUFBM0UsQ0FBTjtBQUNIOzs7Z0RBQ3VCO0FBQ3BCLGtCQUFNLElBQUksZ0NBQUosQ0FBeUIsOENBQThDLEtBQUssSUFBNUUsQ0FBTjtBQUNIOzs7MENBQ2lCLEMsRUFBRztBQUFDO0FBQ2xCLGtCQUFNLElBQUksZ0NBQUosQ0FBeUIsMENBQTBDLEtBQUssSUFBeEUsQ0FBTjtBQUNIOzs7eUNBQ2dCLEcsRUFBSyxDQUFDO0FBQ3RCOzs7NEJBMUJZO0FBQ1QsbUJBQU8sS0FBSyxXQUFMLENBQWlCLE9BQXhCO0FBQ0g7Ozs0QkFXVTtBQUNQLG1CQUFPLGlCQUFQO0FBQ0g7Ozs7O0lBYVEsbUIsV0FBQSxtQjs7Ozs7Ozs7OztrQ0FDQztBQUNOLGdCQUFJLE9BQU8sSUFBWDtBQUNBLGdCQUFJLFlBQVksS0FBSyxHQUFMLEVBQWhCO0FBQ0EsZ0JBQUksS0FBSyxXQUFMLENBQWlCLHFCQUFyQixFQUE0QztBQUN4QyxxQkFBSyxPQUFMLENBQWEsSUFBSSxnQkFBSixDQUFxQixLQUFLLFdBQTFCLENBQWI7QUFDSCxhQUZELE1BRU87QUFDSCxvQkFBSSxvQkFBb0IsSUFBSSxPQUFKLENBQVksVUFBQyxPQUFELEVBQVUsTUFBVixFQUFxQjtBQUNyRCwrQkFBVyxZQUFNO0FBQ2IsK0JBQU8sSUFBSSxzQkFBSixDQUFlLDJDQUFmLENBQVA7QUFDSCxxQkFGRCxFQUVHLEtBQUssV0FBTCxDQUFpQixpQkFGcEI7QUFHSCxpQkFKdUIsQ0FBeEI7QUFLQSxvQkFBSSxvQkFBb0IsS0FBSyxJQUFMLENBQVUsS0FBSyxXQUFMLENBQWlCLHNCQUFqQixFQUFWLENBQXhCOztBQUVBLHdCQUFRLElBQVIsQ0FBYSxDQUFDLGlCQUFELEVBQW9CLGlCQUFwQixDQUFiLEVBQ0ssSUFETCxDQUNVLGtCQUFVO0FBQ1oseUJBQUssV0FBTCxDQUFpQixjQUFqQixDQUFnQyxhQUFoQyxHQUFnRCxLQUFLLEdBQUwsS0FBYSxTQUE3RDtBQUNBLHlCQUFLLFdBQUwsQ0FBaUIsYUFBakIsQ0FBK0IsS0FBSyxXQUFwQztBQUNBLHlCQUFLLFdBQUwsQ0FBaUIsWUFBakIsR0FBZ0MsTUFBaEM7QUFDQSx5QkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLGVBQWhDLEdBQWtELEtBQWxEO0FBQ0EseUJBQUssV0FBTCxDQUFpQixjQUFqQixDQUFnQyxpQkFBaEMsR0FBb0QsS0FBcEQ7QUFDQSx5QkFBSyxPQUFMLENBQWEsSUFBSSxnQkFBSixDQUFxQixLQUFLLFdBQTFCLENBQWI7QUFDSCxpQkFSTCxFQVFPLEtBUlAsQ0FRYSxhQUFLO0FBQ1YseUJBQUssV0FBTCxDQUFpQixjQUFqQixDQUFnQyxhQUFoQyxHQUFnRCxLQUFLLEdBQUwsS0FBYSxTQUE3RDtBQUNBLHdCQUFJLFdBQUo7QUFDQSx3QkFBSSxhQUFhLHNCQUFqQixFQUE2QjtBQUN6QixzQ0FBYyxzQkFBVyxtQkFBekI7QUFDQSw2QkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLGlCQUFoQyxHQUFvRCxJQUFwRDtBQUNBLDZCQUFLLFdBQUwsQ0FBaUIsY0FBakIsQ0FBZ0MsZUFBaEMsR0FBa0QsS0FBbEQ7QUFDSCxxQkFKRCxNQUlPO0FBQ0gsc0NBQWMsc0JBQVcsaUJBQXpCO0FBQ0EsNkJBQUssV0FBTCxDQUFpQixjQUFqQixDQUFnQyxlQUFoQyxHQUFrRCxJQUFsRDtBQUNBLDZCQUFLLFdBQUwsQ0FBaUIsY0FBakIsQ0FBZ0MsaUJBQWhDLEdBQW9ELEtBQXBEO0FBQ0g7QUFDRCx5QkFBSyxNQUFMLENBQVksS0FBWixDQUFrQixtQ0FBbEIsRUFBdUQsQ0FBdkQ7QUFDQSx5QkFBSyxXQUFMLENBQWlCLFdBQWpCLENBQTZCLEtBQUssV0FBbEM7QUFDQSx5QkFBSyxPQUFMLENBQWEsSUFBSSxXQUFKLENBQWdCLEtBQUssV0FBckIsRUFBa0MsV0FBbEMsQ0FBYjtBQUNILGlCQXZCTDtBQXdCSDtBQUNKOzs7NkJBSUksVyxFQUFhO0FBQ2QsbUJBQU8sS0FBSyxXQUFMLENBQWlCLFNBQWpCLENBQTJCLElBQTNCLENBQWdDLFdBQWhDLENBQVA7QUFDSDs7OzRCQUxVO0FBQ1AsbUJBQU8scUJBQVA7QUFDSDs7O0VBMUNvQyxlOztJQStDNUIsZ0IsV0FBQSxnQjs7Ozs7Ozs7OztrQ0FDQztBQUNOLGdCQUFJLE9BQU8sSUFBWDtBQUNBLGdCQUFJLFNBQVMsS0FBSyxXQUFMLENBQWlCLFlBQTlCO0FBQ0EsaUJBQUssV0FBTCxDQUFpQixTQUFqQixDQUEyQixTQUEzQixDQUFxQyxLQUFLLFdBQUwsQ0FBaUIsR0FBdEQsRUFBMkQsTUFBM0Q7QUFDQSxpQkFBSyxXQUFMLENBQWlCLG1CQUFqQixDQUFxQyxLQUFLLFdBQTFDLEVBQXVELE1BQXZEO0FBQ0EsaUJBQUssV0FBTCxDQUFpQixHQUFqQixDQUFxQixXQUFyQixHQUFtQyxJQUFuQyxDQUF3QyxpQ0FBeUI7QUFDN0QscUJBQUssV0FBTCxDQUFpQix3QkFBakIsR0FBNEMscUJBQTVDO0FBQ0EscUJBQUssV0FBTCxDQUFpQixjQUFqQixDQUFnQyxrQkFBaEMsR0FBcUQsS0FBckQ7QUFDQSxxQkFBSyxPQUFMLENBQWEsSUFBSSwrQkFBSixDQUFvQyxLQUFLLFdBQXpDLENBQWI7QUFDSCxhQUpELEVBSUcsS0FKSCxDQUlTLGFBQUs7QUFDVixxQkFBSyxNQUFMLENBQVksS0FBWixDQUFrQixvQkFBbEIsRUFBd0MsQ0FBeEM7QUFDQSxxQkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLGtCQUFoQyxHQUFxRCxJQUFyRDtBQUNBLHFCQUFLLE9BQUwsQ0FBYSxJQUFJLFdBQUosQ0FBZ0IsS0FBSyxXQUFyQixFQUFrQyxzQkFBVyxvQkFBN0MsQ0FBYjtBQUNILGFBUkQ7QUFTSDs7OzRCQUNVO0FBQ1AsbUJBQU8sa0JBQVA7QUFDSDs7O0VBbEJpQyxlOztJQW9CekIsK0IsV0FBQSwrQjs7Ozs7Ozs7OztrQ0FDQztBQUNOLGdCQUFJLE9BQU8sSUFBWDs7QUFFQTtBQUNBLGdCQUFJLG1CQUFtQixLQUFLLFdBQUwsQ0FBaUIsd0JBQXhDO0FBQ0EsZ0JBQUksYUFBYSxJQUFJLGlCQUFKLEVBQWpCO0FBQ0E7QUFDQSxnQkFBSSxLQUFLLFdBQUwsQ0FBaUIsZ0JBQXJCLEVBQXVDO0FBQ25DLDJCQUFXLFVBQVgsQ0FBc0IsT0FBdEIsSUFBaUMsS0FBSyxXQUFMLENBQWlCLGdCQUFsRDtBQUNIO0FBQ0Q7QUFDQSxnQkFBSSxLQUFLLFdBQUwsQ0FBaUIsZ0JBQXJCLEVBQXVDO0FBQ25DLDJCQUFXLFVBQVgsQ0FBc0IsT0FBdEIsSUFBaUMsS0FBSyxXQUFMLENBQWlCLGdCQUFsRDtBQUNIO0FBQ0QsdUJBQVcsYUFBWCxHQUEyQixLQUFLLFdBQUwsQ0FBaUIsY0FBNUM7O0FBRUEsZ0JBQUksaUJBQWlCLHlCQUFhLGlCQUFpQixHQUE5QixFQUFtQyxVQUFuQyxDQUFyQjtBQUNBLDZCQUFpQixHQUFqQixHQUF1QixlQUFlLEdBQXRDO0FBQ0EsNkJBQWlCLEdBQWpCLElBQXdCLGdCQUF4QjtBQUNBLDZCQUFpQixHQUFqQixJQUF3QixtQkFBeEI7QUFDQSw2QkFBaUIsR0FBakIsR0FBdUIsaUJBQWlCLEdBQWpCLENBQXFCLE9BQXJCLENBQTZCLGFBQTdCLEVBQTRDLGFBQTVDLENBQXZCOztBQUVBLGlCQUFLLE1BQUwsQ0FBWSxJQUFaLENBQWlCLFNBQWpCLEVBQTRCLEtBQUssV0FBTCxDQUFpQix3QkFBN0M7QUFDQSxpQkFBSyxXQUFMLENBQWlCLEdBQWpCLENBQXFCLG1CQUFyQixDQUF5QyxLQUFLLFdBQUwsQ0FBaUIsd0JBQTFELEVBQW9GLElBQXBGLENBQXlGLFlBQU07QUFDM0Ysb0JBQUkscUJBQXFCLEtBQUssR0FBTCxLQUFhLEtBQUssV0FBTCxDQUFpQixpQkFBdkQ7QUFDQSxxQkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLHdCQUFoQyxHQUEyRCxrQkFBM0Q7QUFDQSxxQkFBSyxXQUFMLENBQWlCLHFCQUFqQixDQUF1QyxLQUFLLFdBQTVDLEVBQXlELGtCQUF6RDtBQUNBLHFCQUFLLFdBQUwsQ0FBaUIsY0FBakIsQ0FBZ0MsMEJBQWhDLEdBQTZELEtBQTdEO0FBQ0EscUJBQUssT0FBTCxDQUFhLElBQUkscUNBQUosQ0FBMEMsS0FBSyxXQUEvQyxFQUE0RCxlQUFlLE1BQTNFLENBQWI7QUFDSCxhQU5ELEVBTUcsS0FOSCxDQU1TLGFBQUs7QUFDVixxQkFBSyxNQUFMLENBQVksS0FBWixDQUFrQiw0QkFBbEIsRUFBZ0QsQ0FBaEQ7QUFDQSxxQkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLDBCQUFoQyxHQUE2RCxJQUE3RDtBQUNBLHFCQUFLLE9BQUwsQ0FBYSxJQUFJLFdBQUosQ0FBZ0IsS0FBSyxXQUFyQixFQUFrQyxzQkFBVyw2QkFBN0MsQ0FBYjtBQUNILGFBVkQ7QUFXSDs7OzRCQUNVO0FBQ1AsbUJBQU8saUNBQVA7QUFDSDs7O0VBdENnRCxlOztBQXlDckQ7Ozs7Ozs7SUFLYSxxQyxXQUFBLHFDOzs7QUFDVDs7Ozs7QUFLQSxtREFBWSxVQUFaLEVBQXdCLE1BQXhCLEVBQWdDO0FBQUE7O0FBQUEsaU1BQ3RCLFVBRHNCOztBQUU1QixlQUFLLGNBQUwsR0FBc0IsRUFBdEI7QUFDQSxlQUFLLDJCQUFMLEdBQW1DLEVBQW5DO0FBQ0EsZUFBSyxPQUFMLEdBQWUsTUFBZjtBQUo0QjtBQUsvQjs7OztrQ0FDUztBQUNOLGdCQUFJLE9BQU8sSUFBWDtBQUNBLGlCQUFLLFVBQUwsR0FBa0IsS0FBSyxHQUFMLEVBQWxCO0FBQ0EsdUJBQVcsWUFBTTtBQUNiLG9CQUFJLEtBQUssZUFBTCxNQUEwQixDQUFDLEtBQUssYUFBcEMsRUFBbUQ7QUFDL0MseUJBQUssTUFBTCxDQUFZLElBQVosQ0FBaUIsMEJBQWpCO0FBQ0EseUJBQUssbUJBQUwsQ0FBeUIsSUFBekI7QUFDSDtBQUNKLGFBTEQsRUFLRyxLQUFLLFdBQUwsQ0FBaUIsaUJBTHBCO0FBTUEsaUJBQUssV0FBTCxDQUFpQix1QkFBakIsR0FBMkMsT0FBM0M7QUFDSDs7OytDQUNzQjtBQUNuQixpQkFBSyxXQUFMLENBQWlCLDJCQUFqQixHQUErQyxLQUFLLEdBQUwsRUFBL0M7QUFDQSxpQkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLDJCQUFoQyxHQUE4RCxLQUFLLFdBQUwsQ0FBaUIsMkJBQWpCLEdBQStDLEtBQUssVUFBbEg7QUFDQSxpQkFBSyxtQkFBTCxHQUEyQixJQUEzQjtBQUNBLGlCQUFLLFdBQUwsQ0FBaUIscUJBQWpCLENBQXVDLEtBQUssV0FBNUM7QUFDQSxpQkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLDJCQUFoQyxHQUE4RCxLQUE5RDtBQUNBLGlCQUFLLGdCQUFMO0FBQ0g7OzswQ0FDaUIsQyxFQUFHO0FBQ2pCLGlCQUFLLFdBQUwsQ0FBaUIsY0FBakIsQ0FBZ0MsMkJBQWhDLEdBQThELEtBQUssR0FBTCxLQUFhLEtBQUssVUFBaEY7QUFDQSxpQkFBSyxNQUFMLENBQVksS0FBWixDQUFrQix1Q0FBbEIsRUFBMkQsQ0FBM0Q7QUFDQSxpQkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLDJCQUFoQyxHQUE4RCxJQUE5RDtBQUNBLGlCQUFLLE9BQUwsQ0FBYSxJQUFJLFdBQUosQ0FBZ0IsS0FBSyxXQUFyQixFQUFrQyxzQkFBVyw2QkFBN0MsQ0FBYjtBQUNIOzs7OENBQ3FCLFEsRUFBVTtBQUM1QixtQkFBTyxJQUFJLGVBQUosQ0FBb0IsUUFBcEIsQ0FBUDtBQUNIOzs7dUNBQ2MsRyxFQUFLO0FBQ2hCLGdCQUFJLFlBQVksSUFBSSxTQUFwQjtBQUNBLGlCQUFLLE1BQUwsQ0FBWSxHQUFaLENBQWdCLG9CQUFvQixLQUFLLFNBQUwsQ0FBZSxTQUFmLENBQXBDO0FBQ0EsZ0JBQUksU0FBSixFQUFlO0FBQ1gsb0JBQUksVUFBVSxTQUFkLEVBQXlCO0FBQ3JCLHlCQUFLLGNBQUwsQ0FBb0IsSUFBcEIsQ0FBeUIsS0FBSyxxQkFBTCxDQUEyQixTQUEzQixDQUF6QjtBQUNBLHdCQUFJLENBQUMsS0FBSyxhQUFWLEVBQXlCO0FBQ3JCLDZCQUFLLDBCQUFMLENBQWdDLFNBQWhDO0FBQ0g7QUFDSjtBQUVKLGFBUkQsTUFRTztBQUNILHFCQUFLLG1CQUFMLENBQXlCLEtBQXpCO0FBQ0g7QUFDSjs7O21EQUMwQixTLEVBQVc7QUFDbEM7QUFDQSxnQkFBSSxlQUFlLHlCQUFlLFVBQVUsU0FBekIsQ0FBbkI7QUFDQSxnQkFBSSxhQUFhLFNBQWIsSUFBMEIsQ0FBOUIsRUFBaUM7QUFDN0I7QUFDSDtBQUNELGdCQUFJLHNCQUFzQixhQUFhLFVBQXZDO0FBQ0EsZ0JBQUksc0JBQXNCLFVBQVUsYUFBcEM7QUFDQSxnQkFBSSx1QkFBdUIsdUJBQXVCLENBQTlDLElBQW1ELHNCQUFzQixLQUFLLE9BQWxGLEVBQTJGO0FBQ3ZGLG9CQUFJLGFBQWEsS0FBSywyQkFBTCxDQUFpQyxtQkFBakMsS0FBeUQsRUFBMUU7QUFDQSxvQkFBSSxDQUFDLFdBQVcsUUFBWCxDQUFvQixtQkFBcEIsQ0FBTCxFQUErQztBQUMzQywrQkFBVyxJQUFYLENBQWdCLG1CQUFoQjtBQUNIO0FBQ0QscUJBQUssMkJBQUwsQ0FBaUMsbUJBQWpDLElBQXdELFVBQXhEOztBQUVBLG9CQUFJLEtBQUssT0FBTCxJQUFnQixXQUFXLE1BQS9CLEVBQXVDO0FBQ25DLHlCQUFLLG1CQUFMLENBQXlCLEtBQXpCO0FBQ0g7QUFDSjtBQUNKOzs7NENBQ21CLFMsRUFBVztBQUMzQixpQkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLHVCQUFoQyxHQUEwRCxLQUFLLEdBQUwsS0FBYSxLQUFLLFVBQTVFO0FBQ0EsaUJBQUssYUFBTCxHQUFxQixJQUFyQjtBQUNBLGlCQUFLLFdBQUwsQ0FBaUIsd0JBQWpCLENBQTBDLEtBQUssV0FBL0MsRUFBNEQsU0FBNUQsRUFBdUUsS0FBSyxjQUFMLENBQW9CLE1BQTNGO0FBQ0EsZ0JBQUksS0FBSyxjQUFMLENBQW9CLE1BQXBCLEdBQTZCLENBQWpDLEVBQW9DO0FBQ2hDLHFCQUFLLFdBQUwsQ0FBaUIsY0FBakIsQ0FBZ0Msb0JBQWhDLEdBQXVELEtBQXZEO0FBQ0EscUJBQUssZ0JBQUw7QUFDSCxhQUhELE1BR087QUFDSCxxQkFBSyxNQUFMLENBQVksS0FBWixDQUFrQixrQkFBbEI7QUFDQSxxQkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLG9CQUFoQyxHQUF1RCxJQUF2RDtBQUNBLHFCQUFLLE9BQUwsQ0FBYSxJQUFJLFdBQUosQ0FBZ0IsS0FBSyxXQUFyQixFQUFrQyxzQkFBVyxzQkFBN0MsQ0FBYjtBQUNIO0FBQ0o7OzsyQ0FDa0I7QUFDZixnQkFBSSxLQUFLLGFBQUwsSUFBc0IsS0FBSyxtQkFBL0IsRUFBb0Q7QUFDaEQscUJBQUssT0FBTCxDQUFhLElBQUksaUJBQUosQ0FBc0IsS0FBSyxXQUEzQixFQUF3QyxLQUFLLGNBQTdDLENBQWI7QUFDSCxhQUZELE1BRU8sSUFBSSxDQUFDLEtBQUssYUFBVixFQUF5QjtBQUM1QixxQkFBSyxNQUFMLENBQVksR0FBWixDQUFnQix3QkFBaEI7QUFDSCxhQUZNLE1BRUE7QUFBQztBQUNKLHFCQUFLLE1BQUwsQ0FBWSxHQUFaLENBQWdCLDhCQUFoQjtBQUNIO0FBQ0o7Ozs0QkFDVTtBQUNQLG1CQUFPLHVDQUFQO0FBQ0g7OztFQW5Hc0QsZTs7SUFzRzlDLGlCLFdBQUEsaUI7OztBQUNULCtCQUFZLFVBQVosRUFBd0IsYUFBeEIsRUFBdUM7QUFBQTs7QUFBQSx5SkFDN0IsVUFENkI7O0FBRW5DLGVBQUssY0FBTCxHQUFzQixhQUF0QjtBQUZtQztBQUd0Qzs7OztrQ0FDUztBQUNOLGdCQUFJLGFBQWEsS0FBSyxXQUF0QjtBQUNBLHVCQUFXLG1CQUFYLENBQStCLFVBQS9CO0FBQ0EsdUJBQVcsaUJBQVgsQ0FBNkIsTUFBN0IsQ0FBb0MsV0FBVyx3QkFBWCxDQUFvQyxHQUF4RSxFQUNJLEtBQUssY0FEVDtBQUVIOzs7NENBQ21CLEcsRUFBSyxVLEVBQVk7QUFDakMsaUJBQUssV0FBTCxDQUFpQixjQUFqQixDQUFnQyxlQUFoQyxHQUFrRCxLQUFsRDtBQUNBLGlCQUFLLFdBQUwsQ0FBaUIsY0FBakIsQ0FBZ0Msa0JBQWhDLEdBQXFELEtBQXJEO0FBQ0EsaUJBQUssT0FBTCxDQUFhLElBQUksV0FBSixDQUFnQixLQUFLLFdBQXJCLEVBQWtDLEdBQWxDLEVBQXVDLFVBQXZDLENBQWI7QUFDSDs7OzBDQUNpQixDLEVBQUc7QUFDakIsZ0JBQUksTUFBSjtBQUNBLGdCQUFJLEVBQUUsSUFBRixJQUFVLDZCQUFkLEVBQWlDO0FBQzdCLHFCQUFLLE1BQUwsQ0FBWSxLQUFaLENBQWtCLCtDQUFsQixFQUFtRSxDQUFuRTtBQUNBLHFCQUFLLFdBQUwsQ0FBaUIsY0FBakIsQ0FBZ0MsZUFBaEMsR0FBa0QsSUFBbEQ7QUFDQSxxQkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLGtCQUFoQyxHQUFxRCxJQUFyRDtBQUNBLHlCQUFTLHNCQUFXLFNBQXBCO0FBQ0gsYUFMRCxNQUtPLElBQUksRUFBRSxJQUFGLElBQVUscUNBQWQsRUFBeUM7QUFDNUMscUJBQUssTUFBTCxDQUFZLEtBQVosQ0FBa0IseURBQWxCLEVBQTZFLENBQTdFO0FBQ0EseUJBQVMsc0JBQVcsY0FBcEI7QUFDQSxxQkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLGtCQUFoQyxHQUFxRCxJQUFyRDtBQUNILGFBSk0sTUFJQTtBQUNILHFCQUFLLE1BQUwsQ0FBWSxLQUFaLENBQWtCLDBDQUFsQixFQUE4RCxDQUE5RDtBQUNBLHFCQUFLLFdBQUwsQ0FBaUIsY0FBakIsQ0FBZ0MsZUFBaEMsR0FBa0QsS0FBbEQ7QUFDQSxxQkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLGtCQUFoQyxHQUFxRCxJQUFyRDtBQUNBLHlCQUFTLHNCQUFXLDRCQUFwQjtBQUNIO0FBQ0QsaUJBQUssT0FBTCxDQUFhLElBQUksV0FBSixDQUFnQixLQUFLLFdBQXJCLEVBQWtDLE1BQWxDLENBQWI7QUFDSDs7OzRCQUNVO0FBQ1AsbUJBQU8sbUJBQVA7QUFDSDs7O0VBckNrQyxlOztJQXVDMUIsVyxXQUFBLFc7OztBQUNULHlCQUFZLFVBQVosRUFBd0IsR0FBeEIsRUFBNkIsVUFBN0IsRUFBeUM7QUFBQTs7QUFBQSw2SUFDL0IsVUFEK0I7O0FBRXJDLGVBQUssSUFBTCxHQUFZLEdBQVo7QUFDQSxlQUFLLFdBQUwsR0FBbUIsVUFBbkI7QUFIcUM7QUFJeEM7Ozs7a0RBQ3lCLFEsRUFBVTtBQUNoQyxtQkFBTyxJQUFJLHFCQUFKLENBQTBCLFFBQTFCLENBQVA7QUFDSDs7OytDQUNzQixRLEVBQVU7QUFDN0IsbUJBQU8sSUFBSSxlQUFKLENBQW9CLFFBQXBCLENBQVA7QUFDSDs7O2tDQUNTO0FBQ04sZ0JBQUksT0FBTyxJQUFYO0FBQ0EsZ0JBQUksYUFBYSxLQUFLLFdBQXRCOztBQUVBLGdCQUFJLENBQUMsS0FBSyxJQUFWLEVBQWdCO0FBQ1oscUJBQUssTUFBTCxDQUFZLEtBQVosQ0FBa0Isb0JBQWxCO0FBQ0EsMkJBQVcsWUFBWDtBQUNBLDJCQUFXLGNBQVgsQ0FBMEIsdUJBQTFCLEdBQW9ELElBQXBEO0FBQ0EscUJBQUssT0FBTCxDQUFhLElBQUksV0FBSixDQUFnQixVQUFoQixFQUE0QixzQkFBVyxrQkFBdkMsQ0FBYjtBQUNBO0FBQ0gsYUFORCxNQU1PLElBQUksQ0FBQyxLQUFLLFdBQU4sSUFBcUIsS0FBSyxXQUFMLENBQWlCLE1BQWpCLEdBQTBCLENBQW5ELEVBQXNEO0FBQ3pELHFCQUFLLE1BQUwsQ0FBWSxLQUFaLENBQWtCLHlCQUFsQjtBQUNBLDJCQUFXLFlBQVg7QUFDQSwyQkFBVyxjQUFYLENBQTBCLDJCQUExQixHQUF3RCxJQUF4RDtBQUNBLHFCQUFLLE9BQUwsQ0FBYSxJQUFJLFdBQUosQ0FBZ0IsVUFBaEIsRUFBNEIsc0JBQVcsdUJBQXZDLENBQWI7QUFDQTtBQUNIOztBQUVELHVCQUFXLGNBQVgsQ0FBMEIsdUJBQTFCLEdBQW9ELEtBQXBEO0FBQ0EsdUJBQVcsY0FBWCxDQUEwQiwyQkFBMUIsR0FBd0QsS0FBeEQ7QUFDQSxpQkFBSyxXQUFMLENBQWlCLFNBQWpCLENBQTJCLG9CQUEzQixDQUFnRCxJQUFoRCxFQUFzRCxVQUF0RDtBQUNIOzs7Z0RBQ3VCO0FBQ3BCLGlCQUFLLFdBQUwsQ0FBaUIsY0FBakIsQ0FBZ0MscUJBQWhDLEdBQXdELEtBQUssR0FBTCxLQUFhLEtBQUssV0FBTCxDQUFpQiwyQkFBdEY7QUFDQSxpQkFBSyxvQkFBTCxHQUE0QixJQUE1QjtBQUNBLGlCQUFLLGdCQUFMO0FBQ0g7OzsyQ0FDa0I7QUFDZixnQkFBSSxLQUFLLG9CQUFMLElBQTZCLEtBQUsscUJBQXRDLEVBQTZEO0FBQ3pELHFCQUFLLE9BQUwsQ0FBYSxJQUFJLFlBQUosQ0FBaUIsS0FBSyxXQUF0QixDQUFiO0FBQ0gsYUFGRCxNQUVPLElBQUksQ0FBQyxLQUFLLG9CQUFWLEVBQWdDO0FBQ25DLHFCQUFLLE1BQUwsQ0FBWSxHQUFaLENBQWdCLHFCQUFoQjtBQUNILGFBRk0sTUFFQTtBQUFDO0FBQ0oscUJBQUssTUFBTCxDQUFZLEdBQVosQ0FBZ0Isb0NBQWhCO0FBQ0g7QUFDSjs7OzRCQUNVO0FBQ1AsbUJBQU8sYUFBUDtBQUNIOzs7RUFsRDRCLGU7O0lBb0RwQixZLFdBQUEsWTs7Ozs7Ozs7OztrQ0FFQztBQUNOLGlCQUFLLFVBQUwsR0FBa0IsS0FBSyxHQUFMLEVBQWxCO0FBQ0EsaUJBQUssV0FBTCxDQUFpQixjQUFqQixDQUFnQyxvQkFBaEMsR0FBdUQsS0FBSyxVQUFMLEdBQWtCLEtBQUssV0FBTCxDQUFpQixpQkFBMUY7QUFDQSxpQkFBSyxXQUFMLENBQWlCLG1CQUFqQixDQUFxQyxLQUFLLFdBQTFDO0FBQ0g7OztpREFDd0IsQ0FDeEI7Ozt5Q0FDZ0I7QUFDYixpQkFBSyxXQUFMLENBQWlCLGlCQUFqQixDQUFtQyxNQUFuQztBQUNBLGlCQUFLLE9BQUwsQ0FBYSxJQUFJLGlCQUFKLENBQXNCLEtBQUssV0FBM0IsQ0FBYjtBQUNIOzs7aUNBQ1E7QUFDTCxpQkFBSyxXQUFMLENBQWlCLGlCQUFqQixDQUFtQyxNQUFuQztBQUNBLGlCQUFLLE9BQUwsQ0FBYSxJQUFJLGlCQUFKLENBQXNCLEtBQUssV0FBM0IsQ0FBYjtBQUNIOzs7eUNBQ2dCLEcsRUFBSztBQUNsQixnQkFBSSxXQUFXLEtBQUssV0FBTCxDQUFpQixTQUFqQixDQUEyQixnQkFBM0IsQ0FBNEMsR0FBNUMsRUFBaUQsS0FBSyxXQUFMLENBQWlCLEdBQWxFLENBQWY7QUFDQSxpQkFBSyxNQUFMLENBQVksSUFBWixDQUFpQix3QkFBakIsRUFBMkMsUUFBM0M7O0FBRUEsZ0JBQUksWUFBWSxnQ0FBcUIsWUFBckMsRUFBbUQ7QUFDL0MscUJBQUssTUFBTCxDQUFZLElBQVosQ0FBaUIscUJBQWpCO0FBQ0EscUJBQUssV0FBTCxDQUFpQixjQUFqQixDQUFnQyxrQkFBaEMsSUFBc0QsQ0FBdEQ7QUFDSDtBQUNELGdCQUFJLFlBQVksZ0NBQXFCLE1BQXJDLEVBQTZDO0FBQ3pDLHFCQUFLLFdBQUwsQ0FBaUIsY0FBakIsQ0FBZ0Msb0JBQWhDLEdBQXVELElBQXZEO0FBQ0g7QUFDSjs7O3NEQUU2QjtBQUMxQixnQkFBSSxzQkFBc0IsS0FBSyxXQUFMLENBQWlCLFNBQWpCLENBQTJCLDJCQUEzQixDQUF1RCxLQUFLLFdBQUwsQ0FBaUIsR0FBeEUsQ0FBMUI7QUFDQSxpQkFBSyxNQUFMLENBQVksSUFBWixDQUFpQix5QkFBakIsRUFBNEMsbUJBQTVDOztBQUVBLGdCQUFJLHVCQUF1QixpQ0FBc0IsTUFBakQsRUFBeUQ7QUFDckQscUJBQUssV0FBTCxDQUFpQixjQUFqQixDQUFnQyxvQkFBaEMsR0FBdUQsSUFBdkQ7QUFDSDtBQUNKOzs7aUNBRVE7QUFDTCxpQkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLGlCQUFoQyxHQUFvRCxLQUFLLEdBQUwsS0FBYSxLQUFLLFVBQXRFO0FBQ0EsaUJBQUssV0FBTCxDQUFpQixZQUFqQjtBQUNBLGlCQUFLLFdBQUwsQ0FBaUIsY0FBakIsQ0FBZ0MsY0FBaEMsR0FBaUQsSUFBSSxJQUFKLEVBQWpEO0FBQ0EsaUJBQUssV0FBTCxDQUFpQixtQkFBakIsQ0FBcUMsS0FBSyxXQUExQztBQUNIOzs7NEJBQ1U7QUFDUCxtQkFBTyxjQUFQO0FBQ0g7OztFQS9DNkIsZTs7SUFpRHJCLFksV0FBQSxZOzs7Ozs7Ozs7O2tDQUNDO0FBQ04saUJBQUssVUFBTCxHQUFrQixLQUFLLEdBQUwsRUFBbEI7QUFDQSxpQkFBSyxXQUFMLENBQWlCLFlBQWpCO0FBQ0EsaUJBQUssV0FBTCxDQUFpQixjQUFqQixDQUFnQyxpQkFBaEMsR0FBb0QsS0FBSyxHQUFMLEtBQWEsS0FBSyxVQUF0RTtBQUNBLGlCQUFLLFdBQUwsQ0FBaUIsbUJBQWpCLENBQXFDLEtBQUssV0FBMUMsRUFBdUQsS0FBSyxXQUFMLENBQWlCLGNBQXhFO0FBQ0g7OztpQ0FJUTtBQUNMO0FBQ0g7Ozs0QkFMVTtBQUNQLG1CQUFPLGNBQVA7QUFDSDs7O0VBVDZCLGU7O0lBY3JCLGlCLFdBQUEsaUI7Ozs7Ozs7Ozs7NEJBQ0U7QUFDUCxtQkFBTyxtQkFBUDtBQUNIOzs7RUFIa0MsWTs7SUFLMUIsVyxXQUFBLFc7OztBQUNULHlCQUFZLFVBQVosRUFBd0IsYUFBeEIsRUFBdUM7QUFBQTs7QUFBQSw4SUFDN0IsVUFENkI7O0FBRW5DLGdCQUFLLGNBQUwsR0FBc0IsYUFBdEI7QUFGbUM7QUFHdEM7Ozs7a0NBQ1M7QUFDTixpQkFBSyxXQUFMLENBQWlCLGNBQWpCLENBQWdDLGNBQWhDLEdBQWlELElBQUksSUFBSixFQUFqRDtBQUNBLGlCQUFLLFdBQUwsQ0FBaUIsZ0JBQWpCLENBQWtDLEtBQUssV0FBdkMsRUFBb0QsS0FBSyxjQUF6RDtBQUNBO0FBQ0g7Ozs0QkFDVTtBQUNQLG1CQUFPLGFBQVA7QUFDSDs7O0VBWjRCLFk7O0lBZVosVTtBQUNqQjs7Ozs7Ozs7QUFRQSx3QkFBWSxZQUFaLEVBQTBCLFVBQTFCLEVBQXNDLFlBQXRDLEVBQW9ELE1BQXBELEVBQTRELFNBQTVELEVBQXVFLFlBQXZFLEVBQXFGLFVBQXJGLEVBQW9JO0FBQUEsWUFBbkMsUUFBbUMsdUVBQXhCLElBQUksMEJBQUosRUFBd0I7QUFBQTs7QUFDaEksWUFBSSxFQUFFLG9CQUFvQix3Q0FBdEIsQ0FBSixFQUEyRDtBQUN2RCxrQkFBTSxJQUFJLEtBQUosQ0FBVSw0REFBVixDQUFOO0FBQ0g7QUFDRCxZQUFJLE9BQU8sWUFBUCxLQUF3QixRQUF4QixJQUFvQyxhQUFhLElBQWIsR0FBb0IsTUFBcEIsS0FBK0IsQ0FBdkUsRUFBMEU7QUFDdEUsa0JBQU0sSUFBSSw2QkFBSixDQUFzQix1QkFBdEIsQ0FBTjtBQUNIO0FBQ0QsWUFBSSxDQUFDLFVBQUwsRUFBaUI7QUFDYixrQkFBTSxJQUFJLDZCQUFKLENBQXNCLHFCQUF0QixDQUFOO0FBQ0g7QUFDRCxZQUFJLFFBQU8sTUFBUCx1REFBTyxNQUFQLE9BQWtCLFFBQXRCLEVBQWdDO0FBQzVCLGtCQUFNLElBQUksNkJBQUosQ0FBc0IsaUJBQXRCLENBQU47QUFDSDtBQUNELFlBQUksQ0FBQyxTQUFMLEVBQWdCO0FBQ1osaUJBQUssT0FBTCxHQUFlLGtCQUFmO0FBQ0gsU0FGRCxNQUVPO0FBQ0gsaUJBQUssT0FBTCxHQUFlLFNBQWY7QUFDSDtBQUNELGFBQUssU0FBTCxHQUFpQixRQUFqQjtBQUNBLGFBQUssYUFBTCxHQUFxQixZQUFyQjtBQUNBLGFBQUssV0FBTCxHQUFtQixVQUFuQjtBQUNBLGFBQUssY0FBTCxHQUFzQixJQUFJLDZCQUFKLEVBQXRCO0FBQ0EsYUFBSyxhQUFMLEdBQXFCLFlBQXJCO0FBQ0EsYUFBSyxXQUFMLEdBQW1CLFVBQW5CO0FBQ0EsYUFBSyxhQUFMLEdBQXFCLFlBQXJCO0FBQ0EsYUFBSyxlQUFMLEdBQXVCLE1BQXZCO0FBQ0EsYUFBSyxPQUFMLEdBQWUsdUJBQVcsS0FBSyxlQUFoQixFQUFpQyxLQUFLLE9BQXRDLEVBQStDLFNBQS9DLENBQWY7QUFDQSxhQUFLLGlCQUFMLEdBQXlCLGlDQUF6QjtBQUNBLGFBQUssaUJBQUwsR0FBeUIsaUNBQXpCOztBQUVBLGFBQUssWUFBTCxHQUFvQixJQUFwQjtBQUNBLGFBQUssWUFBTCxHQUFvQixLQUFwQjtBQUNBLGFBQUssV0FBTCxHQUFtQixNQUFuQjtBQUNBLGFBQUsseUJBQUwsR0FBaUMsS0FBakM7QUFDQTs7Ozs7Ozs7QUFRQSxhQUFLLHFCQUFMLEdBQTZCLEtBQTdCOztBQUVBLGFBQUssV0FBTCxHQUNBLEtBQUssYUFBTCxHQUNBLEtBQUssbUJBQUwsR0FDQSxLQUFLLGdCQUFMLEdBQ0EsS0FBSyxxQkFBTCxHQUNBLEtBQUsscUJBQUwsR0FDQSxLQUFLLHdCQUFMLEdBQ0EsS0FBSyxtQkFBTCxHQUNBLEtBQUssbUJBQUwsR0FDQSxLQUFLLG9CQUFMLEdBQ0EsS0FBSyxtQkFBTCxHQUNBLEtBQUssbUJBQUwsR0FBMkIsWUFBTSxDQUNoQyxDQVpEO0FBYUg7Ozs7MENBa0JpQjtBQUNkLGdCQUFHLEtBQUssWUFBUixFQUFzQjtBQUNsQixvQkFBSSxhQUFhLEtBQUssWUFBTCxDQUFrQixjQUFsQixHQUFtQyxDQUFuQyxDQUFqQjtBQUNBLG9CQUFHLFVBQUgsRUFBZTtBQUNYLCtCQUFXLE9BQVgsR0FBcUIsS0FBckI7QUFDSDtBQUNKO0FBQ0o7OzsyQ0FDa0I7QUFDZixnQkFBRyxLQUFLLFlBQVIsRUFBc0I7QUFDbEIsb0JBQUksYUFBYSxLQUFLLFlBQUwsQ0FBa0IsY0FBbEIsR0FBbUMsQ0FBbkMsQ0FBakI7QUFDQSxvQkFBRyxVQUFILEVBQWU7QUFDWCwrQkFBVyxPQUFYLEdBQXFCLElBQXJCO0FBQ0g7QUFDSjtBQUNKOzs7MkNBQ2tCO0FBQ2YsZ0JBQUksS0FBSyxrQkFBVCxFQUE2QjtBQUN6QixvQkFBSSxhQUFhLEtBQUssa0JBQUwsQ0FBd0IsU0FBeEIsR0FBb0MsQ0FBcEMsQ0FBakI7QUFDQSxvQkFBRyxVQUFILEVBQWU7QUFDWCwrQkFBVyxPQUFYLEdBQXFCLEtBQXJCO0FBQ0g7QUFDSjtBQUNKOzs7NENBQ21CO0FBQ2hCLGdCQUFJLEtBQUssa0JBQVQsRUFBNkI7QUFDekIsb0JBQUksYUFBYSxLQUFLLGtCQUFMLENBQXdCLFNBQXhCLEdBQW9DLENBQXBDLENBQWpCO0FBQ0Esb0JBQUcsVUFBSCxFQUFlO0FBQ1gsK0JBQVcsT0FBWCxHQUFxQixJQUFyQjtBQUNIO0FBQ0o7QUFDSjs7OzBDQUNpQjtBQUNkLGdCQUFJLEtBQUssWUFBVCxFQUF1QjtBQUNuQixvQkFBSSxhQUFhLEtBQUssWUFBTCxDQUFrQixjQUFsQixHQUFtQyxDQUFuQyxDQUFqQjtBQUNBLG9CQUFHLFVBQUgsRUFBZTtBQUNYLCtCQUFXLE9BQVgsR0FBcUIsS0FBckI7QUFDSDtBQUNKO0FBQ0o7OzsyQ0FDa0I7QUFDZixnQkFBSSxLQUFLLFlBQVQsRUFBdUI7QUFDbkIsb0JBQUksYUFBYSxLQUFLLFlBQUwsQ0FBa0IsY0FBbEIsR0FBbUMsQ0FBbkMsQ0FBakI7QUFDQSxvQkFBRyxVQUFILEVBQWU7QUFDWCwrQkFBVyxPQUFYLEdBQXFCLElBQXJCO0FBQ0g7QUFDSjtBQUNKOzs7MkNBQ2tCO0FBQ2YsZ0JBQUksS0FBSyxrQkFBVCxFQUE2QjtBQUN6QixvQkFBSSxhQUFhLEtBQUssa0JBQUwsQ0FBd0IsU0FBeEIsR0FBb0MsQ0FBcEMsQ0FBakI7QUFDQSxvQkFBRyxVQUFILEVBQWU7QUFDWCwrQkFBVyxPQUFYLEdBQXFCLEtBQXJCO0FBQ0g7QUFDSjtBQUNKOzs7NENBQ21CO0FBQ2hCLGdCQUFJLEtBQUssa0JBQVQsRUFBNkI7QUFDekIsb0JBQUksYUFBYSxLQUFLLGtCQUFMLENBQXdCLFNBQXhCLEdBQW9DLENBQXBDLENBQWpCO0FBQ0Esb0JBQUcsVUFBSCxFQUFlO0FBQ1gsK0JBQVcsT0FBWCxHQUFxQixJQUFyQjtBQUNIO0FBQ0o7QUFDSjtBQUNEOzs7Ozs7O2dDQXNNUSxTLEVBQVc7QUFDZixnQkFBSTtBQUNBLHFCQUFLLE9BQUwsQ0FBYSxJQUFiLENBQWtCLENBQUMsS0FBSyxNQUFMLEdBQWMsS0FBSyxNQUFMLENBQVksSUFBMUIsR0FBaUMsTUFBbEMsSUFBNEMsTUFBNUMsR0FBcUQsVUFBVSxJQUFqRjtBQUNBLG9CQUFJLEtBQUssTUFBTCxJQUFlLEtBQUssTUFBTCxDQUFZLE1BQS9CLEVBQXVDO0FBQ25DLHlCQUFLLE1BQUwsQ0FBWSxNQUFaO0FBQ0g7QUFDSixhQUxELFNBS1U7QUFDTixxQkFBSyxNQUFMLEdBQWMsU0FBZDtBQUNBLG9CQUFJLFVBQVUsT0FBZCxFQUF1QjtBQUNuQix3QkFBSTtBQUNBLGtDQUFVLE9BQVY7QUFDSCxxQkFGRCxDQUVFLE9BQU8sQ0FBUCxFQUFVO0FBQ1IsNkJBQUssT0FBTCxDQUFhLElBQWIsQ0FBa0IsVUFBVSxJQUFWLEdBQWlCLGlCQUFuQyxFQUFzRCxDQUF0RDtBQUNBLDhCQUFNLENBQU4sQ0FGUSxDQUVDO0FBQ1o7QUFDSjtBQUNKO0FBQ0o7OztrREFFeUI7QUFDdEIsZ0JBQUksbUJBQW1CLElBQUksbUJBQUosQ0FBaUIsS0FBSyxPQUF0QixFQUErQixLQUFLLGFBQXBDLEVBQW1ELEtBQUssYUFBeEQsRUFBdUUsS0FBSyxlQUE1RSxFQUE2RixLQUFLLHdCQUFsRyxFQUE0SCxLQUFLLGFBQWpJLEVBQWdKLEtBQUssV0FBckosQ0FBdkI7QUFDQSw2QkFBaUIsV0FBakIsR0FBK0Isa0JBQU0sSUFBTixFQUFZLEtBQUssbUJBQWpCLENBQS9CO0FBQ0EsNkJBQWlCLFVBQWpCLEdBQThCLGtCQUFNLElBQU4sRUFBWSxLQUFLLGtCQUFqQixDQUE5QjtBQUNBLDZCQUFpQixZQUFqQixHQUFnQyxrQkFBTSxJQUFOLEVBQVksS0FBSyxvQkFBakIsQ0FBaEM7QUFDQSw2QkFBaUIsY0FBakIsR0FBa0Msa0JBQU0sSUFBTixFQUFZLEtBQUssc0JBQWpCLENBQWxDO0FBQ0EsNkJBQWlCLFFBQWpCLEdBQTRCLGtCQUFNLElBQU4sRUFBWSxLQUFLLGdCQUFqQixDQUE1QjtBQUNBLDZCQUFpQixjQUFqQixHQUFrQyxrQkFBTSxJQUFOLEVBQVksS0FBSyxzQkFBakIsQ0FBbEM7O0FBRUEsaUJBQUssaUJBQUwsR0FBeUIsZ0JBQXpCOztBQUVBLG1CQUFPLGdCQUFQO0FBQ0g7Ozs4Q0FFcUI7QUFDbEIsaUJBQUssTUFBTCxDQUFZLG9CQUFaO0FBQ0g7OzsyQ0FDa0IsRyxFQUFLLFUsRUFBWTtBQUNoQyxpQkFBSyxNQUFMLENBQVksbUJBQVosQ0FBZ0MsR0FBaEMsRUFBcUMsVUFBckM7QUFDSDs7OytDQUNzQjtBQUNuQixpQkFBSyxNQUFMLENBQVkscUJBQVo7QUFDSDs7O2lEQUN3QjtBQUNyQixpQkFBSyxNQUFMLENBQVksY0FBWjtBQUNIOzs7eUNBQ2dCLEMsRUFBRztBQUNoQixpQkFBSyxNQUFMLENBQVksaUJBQVosQ0FBOEIsQ0FBOUI7QUFDSDs7O2lEQUN3QixDQUN4Qjs7OzhDQUNxQixhLEVBQWUscUIsRUFBdUI7QUFDeEQsbUJBQU8sS0FBSyxTQUFMLENBQWUscUJBQWYsQ0FBcUMsYUFBckMsRUFBb0QscUJBQXBELENBQVA7QUFDSDs7O2dDQUNPLEUsRUFBSTtBQUNSLGdCQUFJLE9BQU8sSUFBWDtBQUNBLGdCQUFJLE1BQU0sSUFBSSxJQUFKLEVBQVY7QUFDQSxpQkFBSyxjQUFMLENBQW9CLGdCQUFwQixHQUF1QyxHQUF2QztBQUNBLGlCQUFLLGlCQUFMLEdBQXlCLElBQUksT0FBSixFQUF6QjtBQUNBLGdCQUFJLE1BQU0sR0FBRyxjQUFILElBQXFCLFFBQS9CLEVBQXlDO0FBQ3JDLHFCQUFLLEdBQUwsR0FBVyxFQUFYO0FBQ0gsYUFGRCxNQUVPO0FBQ0gsb0JBQUksRUFBSixFQUFRO0FBQ0osdUJBQUcsS0FBSDtBQUNBLHlCQUFLLElBQUw7QUFDSDtBQUNELHNEQUEyQixVQUEzQixHQUF3QyxLQUFLLFdBQTdDO0FBQ0EscUJBQUssR0FBTCxHQUFXLEtBQUsscUJBQUwsQ0FBMkIscUNBQTNCLEVBQXVELDhDQUF2RCxDQUFYO0FBQ0g7QUFDRCxpQkFBSyxHQUFMLENBQVMsT0FBVCxHQUFtQixrQkFBTSxJQUFOLEVBQVksS0FBSyxRQUFqQixDQUFuQjtBQUNBLGlCQUFLLEdBQUwsQ0FBUyxjQUFULEdBQTBCLGtCQUFNLElBQU4sRUFBWSxLQUFLLGVBQWpCLENBQTFCO0FBQ0EsaUJBQUssR0FBTCxDQUFTLHVCQUFULEdBQW1DLGtCQUFNLElBQU4sRUFBWSxLQUFLLDRCQUFqQixDQUFuQztBQUNBLGlCQUFLLEdBQUwsQ0FBUywwQkFBVCxHQUFzQyxrQkFBTSxJQUFOLEVBQVksS0FBSyxpQkFBakIsQ0FBdEM7O0FBRUEscURBQTZCLEtBQUssR0FBbEMsRUFBdUMsSUFBdkMsQ0FBNEMsa0JBQVU7QUFDbEQscUJBQUsseUJBQUwsR0FBaUMsTUFBakM7QUFDQSxxQkFBSyxPQUFMLENBQWEsSUFBSSxtQkFBSixDQUF3QixJQUF4QixDQUFiO0FBQ0gsYUFIRDtBQUlIOzs7aUNBQ1E7QUFDTCxrQkFBTSxJQUFJLGdDQUFKLENBQXlCLDZEQUF6QixDQUFOO0FBQ0g7OztpQ0FDUTtBQUNMLGlCQUFLLE1BQUwsQ0FBWSxNQUFaO0FBQ0g7O0FBRUQ7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBTVEseUMsR0FBWSxJQUFJLElBQUosRTs7QUFFWixvQzt5SEFBTyxrQkFBTyxNQUFQLEVBQWUsVUFBZjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDSCw4REFERyxHQUNNLEVBRE47O0FBQUEsNERBR0YsTUFIRTtBQUFBO0FBQUE7QUFBQTs7QUFBQSwwRkFJSSxFQUpKOztBQUFBO0FBQUEsdUVBT0MsVUFQRDtBQUFBLDBGQVFFLGFBUkYsd0JBU0UsY0FURix3QkFZRSxhQVpGLHdCQWFFLGNBYkY7QUFBQTs7QUFBQTtBQVVDLGlFQUFTLE9BQU8sY0FBUCxFQUFUO0FBVkQ7O0FBQUE7QUFjQyxpRUFBUyxPQUFPLGNBQVAsRUFBVDtBQWREOztBQUFBO0FBQUEsOERBaUJPLElBQUksS0FBSixDQUFVLHdEQUF3RCxVQUFsRSxDQWpCUDs7QUFBQTtBQUFBO0FBQUEsK0RBb0JNLFFBQVEsR0FBUixDQUFZLE9BQU8sR0FBUCwwRUFBVztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsNkdBRXpCLFFBQUssR0FBTCxDQUFTLFFBQVQsR0FBb0IsSUFBcEIsQ0FBeUIsVUFBVSxRQUFWLEVBQW9CO0FBQ2hELG9GQUFJLGdCQUFnQiwwQ0FBMkIsU0FBM0IsRUFBc0MsUUFBdEMsRUFBZ0QsVUFBaEQsQ0FBcEI7QUFDQSxvRkFBSSxDQUFDLGFBQUwsRUFBb0I7QUFDaEIsMEZBQU0sSUFBSSxLQUFKLENBQVUseUVBQXlFLFVBQW5GLENBQU47QUFDSDtBQUNELHVGQUFPLGFBQVA7QUFDSCw2RUFOTSxDQUZ5Qjs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSx5REFBWCxHQUFaLENBcEJOOztBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEscUM7O29EQUFQLEk7Ozs7O3NDQWlDQSxLQUFLLEdBQUwsSUFBWSxLQUFLLEdBQUwsQ0FBUyxjQUFULEtBQTRCLFE7Ozs7Ozt1Q0FHbkIsS0FBSyxLQUFLLGtCQUFWLEVBQThCLGFBQTlCLEM7Ozs7O3VDQUNDLEtBQUssS0FBSyxZQUFWLEVBQXdCLGNBQXhCLEM7Ozs7O0FBRGQseUM7QUFDQSwwQzs7O3VDQUlhLEtBQUssS0FBSyxrQkFBVixFQUE4QixhQUE5QixDOzs7Ozt1Q0FDQyxLQUFLLEtBQUssWUFBVixFQUF3QixjQUF4QixDOzs7OztBQURkLHlDO0FBQ0EsMEM7O0FBUkosMkM7QUFDQSx5QztBQUtBLHlDOzs7QUFNSjtBQUNJLDBDLEdBQWEsU0FBYixVQUFhLENBQUMsR0FBRCxFQUFNLEtBQU4sRUFBZ0I7QUFDN0Isd0NBQUksTUFBTSxlQUFOLEtBQTBCLElBQTFCLEtBQW1DLFFBQVEsSUFBUixJQUFnQixNQUFNLGVBQU4sR0FBd0IsR0FBM0UsQ0FBSixFQUFxRjtBQUNqRiw4Q0FBTSxNQUFNLGVBQVo7QUFDSDtBQUNELDBDQUFNLGdCQUFOLEdBQXlCLElBQXpCO0FBQ0EsMkNBQU8sR0FBUDtBQUNILGlDOztBQUVHLHlELEdBQTRCLFlBQVksS0FBWixDQUFrQixLQUFsQixDQUF3QixNQUF4QixDQUErQixVQUEvQixFQUEyQyxJQUEzQyxDO0FBQzVCLHlELEdBQTRCLFlBQVksS0FBWixDQUFrQixLQUFsQixDQUF3QixNQUF4QixDQUErQixVQUEvQixFQUEyQyxJQUEzQyxDOzs7QUFFaEMsb0NBQUksOEJBQThCLElBQWxDLEVBQXdDO0FBQ3BDLGdEQUFZLEtBQVosQ0FBa0IsTUFBbEIsQ0FBeUIsT0FBekIsQ0FBaUMsVUFBQyxLQUFELEVBQVc7QUFBRSw4Q0FBTSxnQkFBTixHQUF5Qix5QkFBekI7QUFBcUQscUNBQW5HO0FBQ0g7O0FBRUQsb0NBQUksOEJBQThCLElBQWxDLEVBQXdDO0FBQ3BDLGdEQUFZLEtBQVosQ0FBa0IsTUFBbEIsQ0FBeUIsT0FBekIsQ0FBaUMsVUFBQyxLQUFELEVBQVc7QUFBRSw4Q0FBTSxnQkFBTixHQUF5Qix5QkFBekI7QUFBcUQscUNBQW5HO0FBQ0g7O2tFQUVNLFc7OztrRUFHQSxRQUFRLE1BQVIsQ0FBZSxJQUFJLHdCQUFKLEVBQWYsQzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFLZjs7Ozs7Ozs7OENBS3NCO0FBQ2xCLG1CQUFPLEtBQUssUUFBTCxHQUFnQixJQUFoQixDQUFxQixVQUFTLEtBQVQsRUFBZ0I7QUFDeEMsb0JBQUksTUFBTSxLQUFOLENBQVksTUFBWixDQUFtQixNQUFuQixHQUE0QixDQUFoQyxFQUFtQztBQUMvQiwyQkFBTyxNQUFNLEtBQU4sQ0FBWSxNQUFaLENBQW1CLENBQW5CLENBQVA7QUFDSCxpQkFGRCxNQUVPO0FBQ0gsMkJBQU8sUUFBUSxNQUFSLENBQWUsSUFBSSx3QkFBSixFQUFmLENBQVA7QUFDSDtBQUNKLGFBTk0sQ0FBUDtBQU9IOztBQUVEOzs7Ozs7Ozs0Q0FLb0I7QUFDaEIsbUJBQU8sS0FBSyxRQUFMLEdBQWdCLElBQWhCLENBQXFCLFVBQVMsS0FBVCxFQUFnQjtBQUN4QyxvQkFBSSxNQUFNLEtBQU4sQ0FBWSxLQUFaLENBQWtCLE1BQWxCLEdBQTJCLENBQS9CLEVBQWtDO0FBQzlCLDJCQUFPLE1BQU0sS0FBTixDQUFZLEtBQVosQ0FBa0IsQ0FBbEIsQ0FBUDtBQUNILGlCQUZELE1BRU87QUFDSCwyQkFBTyxRQUFRLE1BQVIsQ0FBZSxJQUFJLHdCQUFKLEVBQWYsQ0FBUDtBQUNIO0FBQ0osYUFOTSxDQUFQO0FBT0g7O0FBRUQ7Ozs7Ozs7OzhDQUtzQjtBQUNsQixtQkFBTyxLQUFLLFFBQUwsR0FBZ0IsSUFBaEIsQ0FBcUIsVUFBUyxLQUFULEVBQWdCO0FBQ3hDLG9CQUFJLE1BQU0sS0FBTixDQUFZLE1BQVosQ0FBbUIsTUFBbkIsR0FBNEIsQ0FBaEMsRUFBbUM7QUFDL0IsMkJBQU8sTUFBTSxLQUFOLENBQVksTUFBWixDQUFtQixDQUFuQixDQUFQO0FBQ0gsaUJBRkQsTUFFTztBQUNILDJCQUFPLFFBQVEsTUFBUixDQUFlLElBQUksd0JBQUosRUFBZixDQUFQO0FBQ0g7QUFDSixhQU5NLENBQVA7QUFPSDs7QUFFRDs7Ozs7Ozs7NENBS29CO0FBQ2hCLG1CQUFPLEtBQUssUUFBTCxHQUFnQixJQUFoQixDQUFxQixVQUFTLEtBQVQsRUFBZ0I7QUFDeEMsb0JBQUksTUFBTSxLQUFOLENBQVksS0FBWixDQUFrQixNQUFsQixHQUEyQixDQUEvQixFQUFrQztBQUM5QiwyQkFBTyxNQUFNLEtBQU4sQ0FBWSxLQUFaLENBQWtCLENBQWxCLENBQVA7QUFDSCxpQkFGRCxNQUVPO0FBQ0gsMkJBQU8sUUFBUSxNQUFSLENBQWUsSUFBSSx3QkFBSixFQUFmLENBQVA7QUFDSDtBQUNKLGFBTk0sQ0FBUDtBQU9IOzs7d0NBRWUsRyxFQUFLO0FBQ2pCLGlCQUFLLE1BQUwsQ0FBWSxjQUFaLENBQTJCLEdBQTNCO0FBQ0g7Ozt1REFFOEI7QUFDM0IsaUJBQUssTUFBTCxDQUFZLDJCQUFaO0FBQ0g7OzswQ0FFaUIsRyxFQUFLO0FBQ25CLGlCQUFLLE1BQUwsQ0FBWSxnQkFBWixDQUE2QixHQUE3QjtBQUNIOztBQUVEOzs7Ozs7aUNBR1MsRyxFQUFLO0FBQ1YsaUJBQUssU0FBTCxDQUFlLFFBQWYsQ0FBd0IsSUFBeEIsRUFBOEIsR0FBOUI7QUFDQSxpQkFBSyxvQkFBTCxDQUEwQixJQUExQixFQUFnQyxJQUFJLE9BQUosQ0FBWSxDQUFaLENBQWhDO0FBQ0g7Ozt1Q0FDYztBQUNYLGdCQUFJLEtBQUssbUJBQVQsRUFBOEI7QUFDMUIscUJBQUssbUJBQUwsQ0FBeUIsU0FBekIsR0FBcUMsSUFBckM7QUFDSDtBQUNELGdCQUFJLEtBQUssbUJBQVQsRUFBOEI7QUFDMUIscUJBQUssbUJBQUwsQ0FBeUIsU0FBekIsR0FBcUMsSUFBckM7QUFDQSxxQkFBSyxrQkFBTCxHQUEwQixJQUExQjtBQUNIO0FBQ0o7Ozt1Q0FDYztBQUNYLGdCQUFJO0FBQ0Esb0JBQUksS0FBSyxZQUFMLElBQXFCLENBQUMsS0FBSyxxQkFBL0IsRUFBc0Q7QUFDbEQsNENBQVksS0FBSyxZQUFqQjtBQUNBLHlCQUFLLFlBQUwsR0FBb0IsSUFBcEI7QUFDQSx5QkFBSyxxQkFBTCxHQUE2QixLQUE3QjtBQUNIO0FBQ0osYUFORCxTQU1VO0FBQ04sb0JBQUk7QUFDQSx3QkFBSSxLQUFLLEdBQVQsRUFBYztBQUNWLDZCQUFLLEdBQUwsQ0FBUyxLQUFUO0FBQ0g7QUFDSixpQkFKRCxDQUlFLE9BQU8sQ0FBUCxFQUFVO0FBQ1I7QUFDSCxpQkFORCxTQU1VO0FBQ04seUJBQUssR0FBTCxHQUFXLElBQVg7QUFDSDtBQUNKO0FBQ0o7OztpREFFd0I7QUFDckIsZ0JBQUksT0FBTyxJQUFYO0FBQ0EsZ0JBQUksbUJBQW1CLEVBQXZCOztBQUVBLGlCQUFLLFNBQUwsQ0FBZSxzQkFBZixDQUFzQyxJQUF0QyxFQUE0QyxnQkFBNUM7O0FBRUEsZ0JBQUksS0FBSyxZQUFULEVBQXVCO0FBQ25CLG9CQUFJLG1CQUFtQixFQUF2QjtBQUNBLG9CQUFJLG1CQUFtQixFQUF2QjtBQUNBLG9CQUFJLG9CQUFvQixFQUF4QjtBQUNBLG9CQUFJLHVCQUF1QixFQUEzQjs7QUFFQTtBQUNBLG9CQUFJLE9BQU8sS0FBSyxnQkFBWixLQUFpQyxXQUFyQyxFQUFrRDtBQUM5QyxxQ0FBaUIsS0FBakIsR0FBeUIsS0FBSyxnQkFBOUI7QUFDSDtBQUNELG9CQUFJLE9BQU8sS0FBSyxjQUFaLEtBQStCLFdBQW5DLEVBQWdEO0FBQzVDLHFDQUFpQixHQUFqQixHQUF1QixLQUFLLGNBQTVCO0FBQ0g7QUFDRCxvQkFBSSxPQUFPLEtBQUssY0FBWixLQUErQixXQUFuQyxFQUFnRDtBQUM1QyxxQ0FBaUIsR0FBakIsR0FBdUIsS0FBSyxjQUE1QjtBQUNIO0FBQ0Q7QUFDQSxvQkFBSSxPQUFPLEtBQUssaUJBQVosS0FBa0MsV0FBdEMsRUFBbUQ7QUFDL0Msc0NBQWtCLEtBQWxCLEdBQTBCLEtBQUssaUJBQS9CO0FBQ0g7QUFDRCxvQkFBSSxPQUFPLEtBQUssZUFBWixLQUFnQyxXQUFwQyxFQUFpRDtBQUM3QyxzQ0FBa0IsR0FBbEIsR0FBd0IsS0FBSyxlQUE3QjtBQUNIO0FBQ0Qsb0JBQUksT0FBTyxLQUFLLGVBQVosS0FBZ0MsV0FBcEMsRUFBaUQ7QUFDN0Msc0NBQWtCLEdBQWxCLEdBQXdCLEtBQUssZUFBN0I7QUFDSDtBQUNELG9CQUFHLE9BQU8sSUFBUCxDQUFZLGdCQUFaLEVBQThCLE1BQTlCLEdBQXVDLENBQXZDLElBQTRDLE9BQU8sSUFBUCxDQUFZLGlCQUFaLEVBQStCLE1BQS9CLEdBQXdDLENBQXZGLEVBQTBGO0FBQ3RGLHFDQUFpQixLQUFqQixHQUF5QixnQkFBekI7QUFDQSxxQ0FBaUIsTUFBakIsR0FBMEIsaUJBQTFCO0FBQ0g7QUFDRDtBQUNBLG9CQUFJLE9BQU8sS0FBSyxlQUFaLEtBQWdDLFdBQXBDLEVBQWlEO0FBQzdDLHlDQUFxQixLQUFyQixHQUE2QixLQUFLLGVBQWxDO0FBQ0g7QUFDRCxvQkFBSSxPQUFPLEtBQUssa0JBQVosS0FBbUMsV0FBdkMsRUFBb0Q7QUFDaEQseUNBQXFCLEdBQXJCLEdBQTJCLEtBQUssa0JBQWhDO0FBQ0g7QUFDRCxvQkFBSSxPQUFPLEtBQUssa0JBQVosS0FBbUMsV0FBdkMsRUFBb0Q7QUFDaEQseUNBQXFCLEdBQXJCLEdBQTJCLEtBQUssa0JBQWhDO0FBQ0g7QUFDRCxvQkFBRyxPQUFPLElBQVAsQ0FBWSxvQkFBWixFQUFrQyxNQUFsQyxHQUEyQyxDQUE5QyxFQUFpRDtBQUM3QyxxQ0FBaUIsU0FBakIsR0FBNkIsb0JBQTdCO0FBQ0g7O0FBRUQ7QUFDQSxvQkFBRyxLQUFLLFdBQUwsS0FBcUIsTUFBckIsSUFBK0IsS0FBSyxXQUFMLEtBQXFCLGFBQXZELEVBQXNFO0FBQ2xFLHlCQUFLLFdBQUwsR0FBbUIsTUFBbkI7QUFDSDtBQUNELGlDQUFpQixVQUFqQixHQUE4QixLQUFLLFdBQW5DOztBQUVBO0FBQ0Esb0JBQUksT0FBTyxJQUFQLENBQVksZ0JBQVosRUFBOEIsTUFBOUIsR0FBdUMsQ0FBM0MsRUFBOEM7QUFDMUMscUNBQWlCLEtBQWpCLEdBQXlCLGdCQUF6QjtBQUNILGlCQUZELE1BRU87QUFDSCxxQ0FBaUIsS0FBakIsR0FBeUIsSUFBekI7QUFDSDtBQUNKOztBQUVELG1CQUFPLGdCQUFQO0FBQ0g7Ozs0QkEzbUJtQjtBQUNoQixtQkFBTyxLQUFLLGNBQVo7QUFDSDs7OzRCQUNZO0FBQ1QsbUJBQU8sS0FBSyxPQUFaO0FBQ0g7QUFDRDs7Ozs7Ozs7NEJBS2tCO0FBQ2QsbUJBQU8sS0FBSyxZQUFaO0FBQ0gsUzs7QUEyTUQ7Ozs7MEJBSWdCLEssRUFBTztBQUNuQixpQkFBSyxZQUFMLEdBQW9CLEtBQXBCO0FBQ0EsaUJBQUsscUJBQUwsR0FBNkIsSUFBN0I7QUFDSDtBQUNEOzs7Ozs7NEJBbE53QjtBQUNwQixtQkFBTyxLQUFLLGtCQUFaO0FBQ0g7OzswQkFxRWdCLE8sRUFBUztBQUN0QixpQkFBSyxhQUFMLEdBQXFCLE9BQXJCO0FBQ0g7QUFDRDs7Ozs7Ozs7MEJBS2UsTyxFQUFTO0FBQ3BCLGlCQUFLLFdBQUwsR0FBbUIsT0FBbkI7QUFDSDtBQUNEOzs7Ozs7OzBCQUlvQixPLEVBQVM7QUFDekIsaUJBQUssZ0JBQUwsR0FBd0IsT0FBeEI7QUFDSDtBQUNEOzs7Ozs7OzswQkFLdUIsTyxFQUFTO0FBQzVCLGlCQUFLLG1CQUFMLEdBQTJCLE9BQTNCO0FBQ0g7QUFDRDs7Ozs7OzswQkFJeUIsTyxFQUFTO0FBQzlCLGlCQUFLLHFCQUFMLEdBQTZCLE9BQTdCO0FBQ0g7QUFDRDs7Ozs7Ozs7OzBCQU15QixPLEVBQVM7QUFDOUIsaUJBQUsscUJBQUwsR0FBNkIsT0FBN0I7QUFDSDtBQUNEOzs7Ozs7Ozs7OzswQkFRNEIsTyxFQUFTO0FBQ2pDLGlCQUFLLHdCQUFMLEdBQWdDLE9BQWhDO0FBQ0g7QUFDRDs7Ozs7OzswQkFJdUIsTyxFQUFTO0FBQzVCLGlCQUFLLG1CQUFMLEdBQTJCLE9BQTNCO0FBQ0g7QUFDRDs7Ozs7OzswQkFJdUIsTyxFQUFTO0FBQzVCLGlCQUFLLG1CQUFMLEdBQTJCLE9BQTNCO0FBQ0g7QUFDRDs7Ozs7Ozs7OzswQkFPd0IsTyxFQUFTO0FBQzdCLGlCQUFLLG9CQUFMLEdBQTRCLE9BQTVCO0FBQ0g7QUFDRDs7Ozs7OzswQkFJdUIsTyxFQUFTO0FBQzVCLGlCQUFLLG1CQUFMLEdBQTJCLE9BQTNCO0FBQ0g7QUFDRDs7Ozs7Ozs7MEJBS3VCLE8sRUFBUztBQUM1QixpQkFBSyxtQkFBTCxHQUEyQixPQUEzQjtBQUNIOzs7MEJBQ2UsSSxFQUFNO0FBQ2xCLGlCQUFLLFlBQUwsR0FBb0IsSUFBcEI7QUFDSDs7OzBCQUNvQixJLEVBQU07QUFDdkIsaUJBQUssaUJBQUwsR0FBeUIsSUFBekI7QUFDSDs7OzBCQUNlLEksRUFBTTtBQUNsQixpQkFBSyxZQUFMLEdBQW9CLElBQXBCO0FBQ0g7OzswQkFDcUIsUyxFQUFXO0FBQzdCLGlCQUFLLGtCQUFMLEdBQTBCLFNBQTFCO0FBQ0g7OzswQkFDcUIsUyxFQUFXO0FBQzdCLGlCQUFLLGtCQUFMLEdBQTBCLFNBQTFCO0FBQ0g7OzswQkFDa0IsUyxFQUFXO0FBQzFCLGlCQUFLLGVBQUwsR0FBdUIsU0FBdkI7QUFDSDs7OzBCQUNpQixLLEVBQU87QUFDckIsaUJBQUssY0FBTCxHQUFzQixLQUF0QjtBQUNIOzs7MEJBQ2lCLEssRUFBTztBQUNyQixpQkFBSyxjQUFMLEdBQXNCLEtBQXRCO0FBQ0g7OzswQkFDbUIsSyxFQUFPO0FBQ3ZCLGlCQUFLLGdCQUFMLEdBQXdCLEtBQXhCO0FBQ0g7OzswQkFDa0IsTSxFQUFRO0FBQ3ZCLGlCQUFLLGVBQUwsR0FBdUIsTUFBdkI7QUFDSDs7OzBCQUNrQixNLEVBQVE7QUFDdkIsaUJBQUssZUFBTCxHQUF1QixNQUF2QjtBQUNIOzs7MEJBQ29CLE0sRUFBUTtBQUN6QixpQkFBSyxpQkFBTCxHQUF5QixNQUF6QjtBQUNIOzs7MEJBQ2MsSSxFQUFNO0FBQ2pCLGlCQUFLLFdBQUwsR0FBbUIsSUFBbkI7QUFDSDs7OzBCQVlzQixPLEVBQVM7QUFDNUIsaUJBQUssbUJBQUwsR0FBMkIsT0FBM0I7QUFDSDs7OzBCQUNzQixPLEVBQVM7QUFDNUIsaUJBQUssbUJBQUwsR0FBMkIsT0FBM0I7QUFDSDtBQUNEOzs7Ozs7MEJBRzRCLEUsRUFBSTtBQUM1QixpQkFBSyx3QkFBTCxHQUFnQyxFQUFoQztBQUNIO0FBQ0Q7Ozs7OzswQkFHcUIsYSxFQUFlO0FBQ2hDLGlCQUFLLGlCQUFMLEdBQXlCLGFBQXpCO0FBQ0g7QUFDRDs7Ozs7OzBCQUdxQixhLEVBQWU7QUFDaEMsaUJBQUssaUJBQUwsR0FBeUIsYUFBekI7QUFDSDtBQUNEOzs7Ozs7Ozs7MEJBTW9CLFUsRUFBWTtBQUM1QixpQkFBSyxnQkFBTCxHQUF3QixVQUF4QjtBQUNIOztBQUVEOzs7Ozs7Ozs7MEJBTW9CLFUsRUFBWTtBQUM1QixpQkFBSyxnQkFBTCxHQUF3QixVQUF4QjtBQUNIOztBQUVEOzs7Ozs7OzBCQUlrQixJLEVBQU07QUFDcEIsaUJBQUssY0FBTCxHQUFzQixJQUF0QjtBQUNIOzs7OztrQkF4VmdCLFU7Ozs7Ozs7Ozs7Ozs7Ozs7O1FDN2NMLDBCLEdBQUEsMEI7O0FBRGhCOzs7O0FBQ08sU0FBUywwQkFBVCxDQUFvQyxTQUFwQyxFQUErQyxLQUEvQyxFQUFzRCxVQUF0RCxFQUFrRTtBQUNyRSxRQUFJLGlCQUFpQixJQUFyQjtBQUNBLFFBQUksYUFBYSxJQUFqQjs7QUFFQSxVQUFNLE9BQU4sQ0FBYyx1QkFBZTtBQUN6QixZQUFJLFdBQUosRUFBaUI7QUFDYixnQkFBSSxZQUFZLElBQVosS0FBcUIsYUFBckIsSUFBc0MsZUFBZSxhQUF6RCxFQUF3RTtBQUNwRTtBQUNBLDZCQUFhLFlBQVksSUFBekI7QUFDQSxpQ0FBaUI7QUFDYiwrQkFBVyxTQURFO0FBRWIsaUNBQWEsWUFBWSxXQUZaO0FBR2I7QUFDQSxrQ0FBYyxZQUFZLGVBSmI7QUFLYixvQ0FBZ0IsS0FBSyxLQUFMLENBQVcseUJBQWEsWUFBWSxNQUF6QixFQUFpQyxDQUFqQyxJQUFzQyxJQUFqRCxDQUxIO0FBTWI7QUFDQSxnQ0FBWSx1QkFBVyxZQUFZLFVBQXZCLElBQXFDLEtBQUssS0FBTCxDQUFXLFlBQVksVUFBWixHQUF5QixLQUFwQyxDQUFyQyxHQUFrRjtBQVBqRixpQkFBakI7QUFTSCxhQVpELE1BWU8sSUFBSSxZQUFZLElBQVosS0FBcUIsY0FBckIsSUFBdUMsZUFBZSxjQUExRCxFQUEwRTtBQUM3RTtBQUNBLGlDQUFpQixrQkFBa0IsRUFBbkM7QUFDQTtBQUNBLCtCQUFlLFlBQWYsR0FBOEIsWUFBWSxXQUExQztBQUNILGFBTE0sTUFLQSxJQUFJLFlBQVksSUFBWixLQUFxQixjQUFyQixJQUF1QyxlQUFlLGNBQTFELEVBQTBFO0FBQzdFLGlDQUFpQixrQkFBa0IsRUFBbkM7QUFDQTtBQUNBLCtCQUFlLFVBQWYsR0FBNEIsdUJBQVcsWUFBWSxVQUF2QixJQUFxQyxLQUFLLEtBQUwsQ0FBVyxZQUFZLFVBQVosR0FBeUIsS0FBcEMsQ0FBckMsR0FBa0YsSUFBOUc7QUFDSCxhQUpNLE1BSUEsSUFBSSxZQUFZLElBQVosS0FBcUIsb0JBQXJCLElBQTZDLGVBQWUsY0FBaEUsRUFBZ0Y7QUFDbkY7QUFDQSw2QkFBYSxZQUFZLElBQXpCO0FBQ0EsaUNBQWlCLGtCQUFrQixFQUFuQztBQUNBLCtCQUFlLFNBQWYsR0FBMkIsU0FBM0I7QUFDQSwrQkFBZSxXQUFmLEdBQTZCLFlBQVksV0FBekM7QUFDQSwrQkFBZSxlQUFmLEdBQWlDLHVCQUFXLFlBQVksYUFBdkIsSUFBd0MsS0FBSyxLQUFMLENBQVcsWUFBWSxhQUFaLEdBQTRCLElBQXZDLENBQXhDLEdBQXVGLElBQXhIO0FBQ0EsK0JBQWUsY0FBZixHQUFnQyxLQUFLLEtBQUwsQ0FBVyx5QkFBYSxZQUFZLE1BQXpCLEVBQWlDLENBQWpDLElBQXNDLElBQWpELENBQWhDO0FBQ0g7QUFDSjtBQUNKLEtBakNEOztBQW1DQSxXQUFPLGlCQUFpQixJQUFJLGFBQUosQ0FBa0IsY0FBbEIsRUFBa0MsVUFBbEMsRUFBOEMsVUFBOUMsQ0FBakIsR0FBNkUsSUFBcEY7QUFDSDs7QUFFRDs7O0FBakRBOzs7Ozs7SUFvRE0sYTtBQUNGLDJCQUFZLFFBQVosRUFBc0IsZUFBdEIsRUFBdUMsVUFBdkMsRUFBbUQ7QUFBQTs7QUFDL0MsWUFBSSxTQUFTLFlBQVksRUFBekI7O0FBRUEsYUFBSyxVQUFMLEdBQTBCLE9BQU8sU0FBUCxJQUFvQixJQUFJLElBQUosR0FBVyxPQUFYLEVBQTlDO0FBQ0EsYUFBSyxZQUFMLEdBQTBCLHlCQUFhLE9BQU8sV0FBcEIsQ0FBMUI7QUFDQSxhQUFLLGFBQUwsR0FBMEIseUJBQWEsT0FBTyxZQUFwQixDQUExQjtBQUNBLGFBQUssV0FBTCxHQUEwQix5QkFBYSxPQUFPLFVBQXBCLENBQTFCO0FBQ0EsYUFBSyxpQkFBTCxHQUEwQix5QkFBYSxPQUFPLGdCQUFwQixDQUExQjtBQUNBLGFBQUssZ0JBQUwsR0FBMEIseUJBQWEsT0FBTyxlQUFwQixDQUExQjtBQUNBLGFBQUssZUFBTCxHQUEwQix5QkFBYSxPQUFPLGNBQXBCLENBQTFCO0FBQ0EsYUFBSyxVQUFMLEdBQTBCLHlCQUFhLE9BQU8sU0FBcEIsQ0FBMUI7QUFDQSxhQUFLLGNBQUwsR0FBMEIseUJBQWEsT0FBTyxhQUFwQixDQUExQjtBQUNBLGFBQUssY0FBTCxHQUEwQix5QkFBYSxPQUFPLGFBQXBCLENBQTFCO0FBQ0EsYUFBSyxjQUFMLEdBQTBCLHlCQUFhLE9BQU8sYUFBcEIsQ0FBMUI7QUFDQSxhQUFLLGNBQUwsR0FBMEIseUJBQWEsT0FBTyxhQUFwQixDQUExQjtBQUNBLGFBQUssa0JBQUwsR0FBMEIseUJBQWEsT0FBTyxpQkFBcEIsQ0FBMUI7QUFDQSxhQUFLLGdCQUFMLEdBQTBCLG1CQUFtQixPQUFPLGdCQUExQixJQUE4QyxTQUF4RTtBQUNBLGFBQUssV0FBTCxHQUEwQixjQUFjLE9BQU8sVUFBckIsSUFBbUMsU0FBN0Q7QUFDSDs7QUFFRDs7Ozs7NEJBQ21CO0FBQ2YsbUJBQU8sS0FBSyxhQUFaO0FBQ0g7QUFDRDs7Ozs0QkFDa0I7QUFDZCxtQkFBTyxLQUFLLFlBQVo7QUFDSDtBQUNEOzs7OzRCQUMyQjtBQUN2QixtQkFBTyxLQUFLLGFBQUwsR0FBcUIsQ0FBckIsR0FBeUIsS0FBSyxZQUFMLEdBQW9CLEtBQUssYUFBbEQsR0FBa0UsQ0FBekU7QUFDSDtBQUNEOzs7Ozs7NEJBR2lCO0FBQ2IsbUJBQU8sS0FBSyxXQUFaO0FBQ0g7QUFDRDs7Ozs0QkFDZ0I7QUFDWixtQkFBTyxLQUFLLFVBQVo7QUFDSDtBQUNEOzs7OzRCQUN1QjtBQUNuQixtQkFBTyxLQUFLLGlCQUFaO0FBQ0g7QUFDRDs7Ozs0QkFDc0I7QUFDbEIsbUJBQU8sS0FBSyxnQkFBWjtBQUNIO0FBQ0Q7Ozs7NEJBQ3FCO0FBQ2pCLG1CQUFPLEtBQUssZUFBWjtBQUNIO0FBQ0Q7Ozs7NEJBQ2dCO0FBQ1osbUJBQU8sS0FBSyxVQUFaO0FBQ0g7QUFDRDs7Ozs0QkFDb0I7QUFDaEIsbUJBQU8sS0FBSyxjQUFaO0FBQ0g7QUFDRDs7Ozs0QkFDb0I7QUFDaEIsbUJBQU8sS0FBSyxjQUFaO0FBQ0g7QUFDRDs7Ozs0QkFDb0I7QUFDaEIsbUJBQU8sS0FBSyxjQUFaO0FBQ0g7QUFDRDs7Ozs0QkFDb0I7QUFDaEIsbUJBQU8sS0FBSyxjQUFaO0FBQ0g7QUFDRDs7Ozs0QkFDd0I7QUFDcEIsbUJBQU8sS0FBSyxrQkFBWjtBQUNIO0FBQ0Q7Ozs7NEJBQ3NCO0FBQ2xCLG1CQUFPLEtBQUssZ0JBQVo7QUFDSDtBQUNEOzs7OzRCQUNpQjtBQUNiLG1CQUFPLEtBQUssV0FBWjtBQUNIOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzFJTDs7Ozs7O0lBTWEsYSxXQUFBLGE7QUFDVDs7OztBQUlBLDZCQUFjO0FBQUE7O0FBQ1YsYUFBSyxpQkFBTCxHQUF5QixJQUF6QjtBQUNBLGFBQUssZUFBTCxHQUF1QixJQUF2QjtBQUNBLGFBQUssY0FBTCxHQUFzQixJQUF0QjtBQUNBLGFBQUsseUJBQUwsR0FBaUMsSUFBakM7QUFDQSxhQUFLLHdCQUFMLEdBQWdDLElBQWhDO0FBQ0EsYUFBSyw0QkFBTCxHQUFvQyxJQUFwQztBQUNBLGFBQUssc0JBQUwsR0FBOEIsSUFBOUI7QUFDQSxhQUFLLHFCQUFMLEdBQTZCLElBQTdCO0FBQ0EsYUFBSyxrQkFBTCxHQUEwQixJQUExQjtBQUNBLGFBQUssbUJBQUwsR0FBMkIsQ0FBM0I7QUFDQSxhQUFLLHFCQUFMLEdBQTZCLElBQTdCO0FBQ0EsYUFBSyxxQkFBTCxHQUE2QixJQUE3QjtBQUNBLGFBQUssa0JBQUwsR0FBMEIsSUFBMUI7QUFDQSxhQUFLLHFCQUFMLEdBQTZCLElBQTdCO0FBQ0EsYUFBSyw0QkFBTCxHQUFvQyxJQUFwQztBQUNBLGFBQUssbUJBQUwsR0FBMkIsSUFBM0I7QUFDQSxhQUFLLGdCQUFMLEdBQXdCLElBQXhCO0FBQ0EsYUFBSyxrQkFBTCxHQUEwQixJQUExQjtBQUNBLGFBQUssbUJBQUwsR0FBMkIsSUFBM0I7QUFDQSxhQUFLLDJCQUFMLEdBQW1DLElBQW5DO0FBQ0EsYUFBSyxnQkFBTCxHQUF3QixJQUF4QjtBQUNBLGFBQUssd0JBQUwsR0FBZ0MsSUFBaEM7QUFDQSxhQUFLLDRCQUFMLEdBQW9DLElBQXBDO0FBQ0EsYUFBSyw0QkFBTCxHQUFvQyxJQUFwQztBQUNBLGFBQUssWUFBTCxHQUFvQixFQUFwQjtBQUNBLGFBQUssYUFBTCxHQUFxQixrQkFBckI7QUFDSDtBQUNEOzs7Ozs7OzRCQUd1QjtBQUNuQixtQkFBTyxLQUFLLGlCQUFaO0FBQ0g7QUFDRDs7OzswQkF3SnFCLEssRUFBTztBQUN4QixpQkFBSyxpQkFBTCxHQUF5QixLQUF6QjtBQUNIOzs7NEJBdkpvQjtBQUNqQixtQkFBTyxLQUFLLGVBQVo7QUFDSDtBQUNEOzs7OzBCQXFKbUIsSyxFQUFPO0FBQ3RCLGlCQUFLLGVBQUwsR0FBdUIsS0FBdkI7QUFDSDs7OzRCQXBKbUI7QUFDaEIsbUJBQU8sS0FBSyxjQUFaO0FBQ0g7QUFDRDs7OzswQkFrSmtCLEssRUFBTztBQUNyQixpQkFBSyxjQUFMLEdBQXNCLEtBQXRCO0FBQ0g7Ozs0QkFqSjhCO0FBQzNCLG1CQUFPLEtBQUsseUJBQVo7QUFDSDtBQUNEOzs7OzBCQStJNkIsSyxFQUFPO0FBQ2hDLGlCQUFLLHlCQUFMLEdBQWlDLEtBQWpDO0FBQ0g7Ozs0QkE5STZCO0FBQzFCLG1CQUFPLEtBQUssd0JBQVo7QUFDSDtBQUNEOzs7OzBCQTRJNEIsSyxFQUFPO0FBQy9CLGlCQUFLLHdCQUFMLEdBQWdDLEtBQWhDO0FBQ0g7Ozs0QkEzSWlDO0FBQzlCLG1CQUFPLEtBQUssNEJBQVo7QUFDSDtBQUNEOzs7OzBCQXlJZ0MsSyxFQUFPO0FBQ25DLGlCQUFLLDRCQUFMLEdBQW9DLEtBQXBDO0FBQ0g7Ozs0QkF4STBCO0FBQ3ZCLG1CQUFPLEtBQUsscUJBQVo7QUFDSDtBQUNEOzs7OzBCQXNJeUIsSyxFQUFPO0FBQzVCLGlCQUFLLHFCQUFMLEdBQTZCLEtBQTdCO0FBQ0g7Ozs0QkFySTJCO0FBQ3hCLG1CQUFPLEtBQUssc0JBQVo7QUFDSDtBQUNEOzs7OzBCQW1JMEIsSyxFQUFPO0FBQzdCLGlCQUFLLHNCQUFMLEdBQThCLEtBQTlCO0FBQ0g7Ozs0QkFsSXVCO0FBQ3BCLG1CQUFPLEtBQUssa0JBQVo7QUFDSDtBQUNEOzs7OzBCQWdJc0IsSyxFQUFPO0FBQ3pCLGlCQUFLLGtCQUFMLEdBQTBCLEtBQTFCO0FBQ0g7Ozs0QkEvSHdCO0FBQ3JCLG1CQUFPLEtBQUssbUJBQVo7QUFDSDtBQUNEOzs7OzBCQTZIdUIsSyxFQUFPO0FBQzFCLGlCQUFLLG1CQUFMLEdBQTJCLEtBQTNCO0FBQ0g7Ozs0QkE1SDBCO0FBQ3ZCLG1CQUFPLEtBQUsscUJBQVo7QUFDSDtBQUNEOzs7OzBCQTBIeUIsSyxFQUFPO0FBQzVCLGlCQUFLLHFCQUFMLEdBQTZCLEtBQTdCO0FBQ0g7Ozs0QkF6SDBCO0FBQ3ZCLG1CQUFPLEtBQUsscUJBQVo7QUFDSDtBQUNEOzs7OzBCQXVIeUIsSyxFQUFPO0FBQzVCLGlCQUFLLHFCQUFMLEdBQTZCLEtBQTdCO0FBQ0g7Ozs0QkF0SHVCO0FBQ3BCLG1CQUFPLEtBQUssa0JBQVo7QUFDSDtBQUNEOzs7OzBCQW9Ic0IsSyxFQUFPO0FBQ3pCLGlCQUFLLGtCQUFMLEdBQTBCLEtBQTFCO0FBQ0g7Ozs0QkFuSDBCO0FBQ3ZCLG1CQUFPLEtBQUsscUJBQVo7QUFDSDtBQUNEOzs7OzBCQWlIeUIsSyxFQUFPO0FBQzVCLGlCQUFLLHFCQUFMLEdBQTZCLEtBQTdCO0FBQ0g7Ozs0QkFoSGlDO0FBQzlCLG1CQUFPLEtBQUssNEJBQVo7QUFDSDtBQUNEOzs7OzBCQThHZ0MsSyxFQUFPO0FBQ25DLGlCQUFLLDRCQUFMLEdBQW9DLEtBQXBDO0FBQ0g7Ozs0QkE3R3dCO0FBQ3JCLG1CQUFPLEtBQUssbUJBQVo7QUFDSDtBQUNEOzs7OzBCQTJHdUIsSyxFQUFPO0FBQzFCLGlCQUFLLG1CQUFMLEdBQTJCLEtBQTNCO0FBQ0g7Ozs0QkExR3VCO0FBQ3BCLG1CQUFPLEtBQUssa0JBQVo7QUFDSDtBQUNEOzs7OzBCQXdHc0IsSyxFQUFPO0FBQ3pCLGlCQUFLLGtCQUFMLEdBQTBCLEtBQTFCO0FBQ0g7Ozs0QkF2R3FCO0FBQ2xCLG1CQUFPLEtBQUssZ0JBQVo7QUFDSDtBQUNEOzs7OzBCQXFHb0IsSyxFQUFPO0FBQ3ZCLGlCQUFLLGdCQUFMLEdBQXdCLEtBQXhCO0FBQ0g7Ozs0QkFwR3dCO0FBQ3JCLG1CQUFPLEtBQUssbUJBQVo7QUFDSDtBQUNEOzs7OzBCQWtHdUIsSyxFQUFPO0FBQzFCLGlCQUFLLG1CQUFMLEdBQTJCLEtBQTNCO0FBQ0g7Ozs0QkFqR2dDO0FBQzdCLG1CQUFPLEtBQUssMkJBQVo7QUFDSDtBQUNEOzs7OzswQkErRitCLEssRUFBTztBQUNsQyxpQkFBSywyQkFBTCxHQUFtQyxLQUFuQztBQUNIOzs7NEJBN0ZxQjtBQUNsQixtQkFBTyxLQUFLLGdCQUFaO0FBQ0g7QUFDRDs7OzswQkEyRm9CLEssRUFBTztBQUN2QixpQkFBSyxnQkFBTCxHQUF3QixLQUF4QjtBQUNIOzs7NEJBMUY2QjtBQUMxQixtQkFBTyxLQUFLLHdCQUFaO0FBQ0g7QUFDRDs7OzswQkF3RjRCLEssRUFBTztBQUMvQixpQkFBSyx3QkFBTCxHQUFnQyxLQUFoQztBQUNIOzs7NEJBdkZpQztBQUM5QixtQkFBTyxLQUFLLDRCQUFaO0FBQ0g7QUFDRDs7OzswQkF3RmdDLEssRUFBTztBQUNuQyxpQkFBSyw0QkFBTCxHQUFvQyxLQUFwQztBQUNIOzs7NEJBdkZpQztBQUM5QixtQkFBTyxLQUFLLDRCQUFaO0FBQ0g7QUFDRDs7OzswQkErRWdDLEssRUFBTztBQUNuQyxpQkFBSyw0QkFBTCxHQUFvQyxLQUFwQztBQUNIOzs7NEJBOUVpQjtBQUNkLG1CQUFPLEtBQUssWUFBWjtBQUNIO0FBQ0Q7Ozs7MEJBK0VnQixLLEVBQU87QUFDbkIsaUJBQUssWUFBTCxHQUFvQixLQUFwQjtBQUNIOzs7NEJBOUVrQjtBQUNmLG1CQUFPLEtBQUssYUFBWjtBQUNILFM7MEJBNkVnQixLLEVBQU87QUFDcEIsaUJBQUssYUFBTCxHQUFxQixLQUFyQjtBQUNIOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDNVFMOztBQUNBOztBQUNBOztBQUNBOzs7O0FBQ0E7Ozs7OztBQUVBLElBQUksc0JBQXNCLENBQTFCOztBQUVBOzs7QUFkQTs7Ozs7O0lBaUJhLGMsV0FBQSxjO0FBQ1Q7OztBQUdBLDRCQUFZLFNBQVosRUFBdUI7QUFBQTs7QUFDbkIsYUFBSyxVQUFMLEdBQWtCLFNBQWxCO0FBQ0EsYUFBSyxXQUFMLEdBQW1CLElBQUksSUFBSixHQUFXLE9BQVgsRUFBbkI7QUFDSDs7Ozt3Q0FDZSxTLEVBQVc7QUFDdkIsdUJBQVcsa0JBQU0sSUFBTixFQUFZLEtBQUssaUJBQWpCLENBQVgsRUFBZ0QsU0FBaEQ7QUFDSDs7O2tDQUlTLENBQUU7Ozs0Q0FDUTtBQUNoQixnQkFBSSxLQUFLLGNBQVQsRUFBeUI7QUFDckIscUJBQUssU0FBTDtBQUNIO0FBQ0o7OztvQ0FDVztBQUNSLGtCQUFNLElBQUksZ0NBQUosRUFBTjtBQUNIOzs7Z0NBQ08sUSxFQUFVO0FBQ2QsaUJBQUssVUFBTCxDQUFnQixPQUFoQixDQUF3QixRQUF4QjtBQUNIOzs7aUNBQ1EsQ0FBRTs7O2lDQUNGO0FBQ0wsa0JBQU0sSUFBSSxnQ0FBSixDQUF5Qiw2QkFBNkIsS0FBSyxJQUEzRCxDQUFOO0FBQ0g7OztrQ0FDUztBQUNOLGlCQUFLLFdBQUw7QUFDSDs7O2tDQUNTO0FBQ04saUJBQUssV0FBTDtBQUNIOzs7c0NBQ2E7QUFDVixrQkFBTSxJQUFJLGdDQUFKLENBQXlCLGtDQUFrQyxLQUFLLElBQWhFLENBQU47QUFDSDs7O2lDQUNRLE0sRUFBUTtBQUFFO0FBQ2Ysa0JBQU0sSUFBSSxnQ0FBSixDQUF5QiwrQkFBK0IsS0FBSyxJQUE3RCxDQUFOO0FBQ0g7OzsrQkFDTSxHLEVBQUssYSxFQUFlO0FBQUU7QUFDekIsa0JBQU0sSUFBSSxnQ0FBSixDQUF5Qiw2QkFBNkIsS0FBSyxJQUEzRCxDQUFOO0FBQ0g7OztpQ0FDUTtBQUNMLGtCQUFNLElBQUksZ0NBQUosQ0FBeUIsNkJBQTZCLEtBQUssSUFBM0QsQ0FBTjtBQUNIOzs7aUNBQ1E7QUFDTCxrQkFBTSxJQUFJLGdDQUFKLENBQXlCLDZCQUE2QixLQUFLLElBQTNELENBQU47QUFDSDs7OzRCQXZDb0I7QUFDakIsbUJBQU8sU0FBUyxLQUFLLFVBQUwsQ0FBZ0IsS0FBaEM7QUFDSDs7OzRCQXNDVTtBQUNQLG1CQUFPLGdCQUFQO0FBQ0g7Ozs0QkFDWTtBQUNULG1CQUFPLEtBQUssVUFBTCxDQUFnQixPQUF2QjtBQUNIOzs7OztJQUVRLGtCLFdBQUEsa0I7OztBQUNULGdDQUFZLFNBQVosRUFBdUIsU0FBdkIsRUFBa0M7QUFBQTs7QUFBQSwwSkFDeEIsU0FEd0I7O0FBRTlCLGNBQUssVUFBTCxHQUFrQixTQUFsQjtBQUY4QjtBQUdqQzs7OztrQ0FDUztBQUNOLGlCQUFLLGVBQUwsQ0FBcUIsS0FBSyxVQUExQjtBQUNIOzs7b0NBQ1c7QUFDUixpQkFBSyxPQUFMLENBQWEsSUFBSSxXQUFKLENBQWdCLEtBQUssVUFBckIsRUFBaUMsSUFBSSxtQkFBSixFQUFqQyxDQUFiO0FBQ0g7Ozs0QkFDVTtBQUNQLG1CQUFPLG9CQUFQO0FBQ0g7OztFQWJtQyxjOztJQWUzQixtQixXQUFBLG1COzs7QUFDVCxpQ0FBWSxTQUFaLEVBQXVCLFNBQXZCLEVBQWtDLGtCQUFsQyxFQUFzRCxTQUF0RCxFQUFpRTtBQUFBOztBQUFBLDZKQUN2RCxTQUR1RCxFQUM1QyxTQUQ0Qzs7QUFFN0QsZUFBSyxpQkFBTCxHQUF5QixzQkFBc0IsSUFBSSxJQUFKLEdBQVcsT0FBWCxFQUEvQztBQUNBLGVBQUssUUFBTCxHQUFnQixhQUFhLENBQTdCO0FBSDZEO0FBSWhFOzs7O2lDQUNRO0FBQ0wsaUJBQUssT0FBTCxDQUFhLElBQUksa0JBQUosQ0FBdUIsS0FBSyxVQUE1QixDQUFiO0FBQ0g7OztzQ0FDYTtBQUNWLGdCQUFJLE1BQU0sSUFBSSxJQUFKLEdBQVcsT0FBWCxFQUFWO0FBQ0EsZ0JBQUksaUJBQWtCLEtBQUssaUJBQUwsR0FBeUIsS0FBSyxVQUEvQixHQUE2QyxHQUFsRTtBQUNBLGdCQUFJLGlCQUFpQixDQUFqQixJQUFzQixFQUFFLEtBQUssUUFBUCxHQUFrQixtQkFBNUMsRUFBaUU7QUFDN0QscUJBQUssVUFBTCxDQUFnQixRQUFoQjtBQUNBLHFCQUFLLE9BQUwsQ0FBYSxJQUFJLG1CQUFKLENBQXdCLEtBQUssVUFBN0IsRUFBeUMsY0FBekMsRUFBeUQsS0FBSyxpQkFBOUQsRUFBaUYsS0FBSyxRQUF0RixDQUFiO0FBQ0gsYUFIRCxNQUdPO0FBQ0gscUJBQUssT0FBTCxDQUFhLElBQUksV0FBSixDQUFnQixLQUFLLFVBQXJCLEVBQWlDLElBQUksS0FBSixDQUFVLGFBQVYsQ0FBakMsQ0FBYjtBQUNIO0FBQ0o7Ozs0QkFDVTtBQUNQLG1CQUFPLHFCQUFQO0FBQ0g7OztFQXJCb0Msa0I7O0lBdUI1QixrQixXQUFBLGtCOzs7Ozs7Ozs7O2tDQUNDO0FBQ04sZ0JBQUksT0FBTyxJQUFYO0FBQ0EsZ0JBQUksT0FBSixDQUFZLFNBQVMsZUFBVCxDQUF5QixPQUF6QixFQUFrQztBQUMxQyxxQkFBSyxVQUFMLENBQWdCLGlCQUFoQjtBQUNBO0FBQ0gsYUFIRDtBQUlIOzs7K0JBQ00sRyxFQUFLLGEsRUFBZTtBQUN2QixnQkFBSSxPQUFPLElBQVg7QUFDQSxnQkFBSSxXQUFXLGtCQUFmOztBQUVBLGdCQUFJLGVBQWU7QUFDZixxQkFBSyxHQURVO0FBRWYsNEJBQVksYUFGRztBQUdmLGtDQUFtQixLQUFLLFVBQUwsQ0FBZ0I7QUFIcEIsYUFBbkI7QUFLQSxpQkFBSyxNQUFMLENBQVksR0FBWixDQUFnQixhQUFoQixFQUErQiwyQkFBZSxHQUFmLENBQS9CO0FBQ0EsaUJBQUssVUFBTCxDQUFnQixJQUFoQixDQUFxQixJQUFyQixDQUEwQixLQUFLLFNBQUwsQ0FBZTtBQUNyQyx5QkFBUyxLQUQ0QjtBQUVyQyx3QkFBUSw2QkFGNkI7QUFHckMsd0JBQVEsWUFINkI7QUFJckMsb0JBQUk7QUFKaUMsYUFBZixDQUExQjtBQU1BLGlCQUFLLE9BQUwsQ0FBYSxJQUFJLGtCQUFKLENBQXVCLEtBQUssVUFBNUIsRUFBd0MsUUFBeEMsQ0FBYjtBQUNIOzs7c0NBQ2E7QUFDVixpQkFBSyxPQUFMLENBQWEsSUFBSSxXQUFKLENBQWdCLEtBQUssVUFBckIsQ0FBYjtBQUNIOzs7NEJBQ1U7QUFDUCxtQkFBTyxvQkFBUDtBQUNIOzs7RUEvQm1DLGM7O0lBaUMzQixrQixXQUFBLGtCOzs7QUFDVCxnQ0FBWSxTQUFaLEVBQXVCLFFBQXZCLEVBQWlDO0FBQUE7O0FBQUEsMkpBQ3ZCLFNBRHVCLEVBQ1osOEJBRFk7O0FBRTdCLGVBQUssU0FBTCxHQUFpQixRQUFqQjtBQUY2QjtBQUdoQzs7OztpQ0FDUSxHLEVBQUs7QUFDVixnQkFBSSxPQUFPLElBQVg7QUFDQSxnQkFBSSxJQUFJLEVBQUosS0FBVyxLQUFLLFNBQXBCLEVBQStCO0FBQzNCLG9CQUFJLElBQUksS0FBSixJQUFhLENBQUMsSUFBSSxNQUF0QixFQUE4QjtBQUMxQix5QkFBSyxPQUFMLENBQWEsSUFBSSxXQUFKLENBQWdCLEtBQUssVUFBckIsRUFBaUMsS0FBSyxvQkFBTCxDQUEwQixHQUExQixDQUFqQyxDQUFiO0FBQ0gsaUJBRkQsTUFFTztBQUNILHdCQUFJLE9BQUosQ0FBWSxTQUFTLGNBQVQsQ0FBd0IsT0FBeEIsRUFBaUM7QUFDekMsNkJBQUssTUFBTCxDQUFZLEdBQVosQ0FBZ0IsY0FBaEIsRUFBZ0MsMkJBQWUsSUFBSSxNQUFKLENBQVcsR0FBMUIsQ0FBaEM7QUFDQSw2QkFBSyxVQUFMLENBQWdCLGdCQUFoQixDQUFpQyxJQUFJLE1BQUosQ0FBVyxHQUE1QyxFQUFpRCxJQUFJLE1BQUosQ0FBVyxVQUE1RDtBQUNBO0FBQ0gscUJBSkQ7QUFLQSx5QkFBSyxPQUFMLENBQWEsSUFBSSxrQkFBSixDQUF1QixLQUFLLFVBQTVCLEVBQXdDLEtBQUssVUFBTCxDQUFnQixXQUF4RCxDQUFiO0FBQ0g7QUFDSjtBQUNKOzs7NkNBQ29CLEcsRUFBSztBQUN0QixnQkFBSSxJQUFJLEtBQUosSUFBYSxJQUFJLEtBQUosQ0FBVSxJQUFWLElBQWtCLEdBQW5DLEVBQXdDO0FBQ3BDLHVCQUFPLElBQUkseUJBQUosQ0FBa0IsSUFBSSxLQUFKLENBQVUsT0FBNUIsQ0FBUDtBQUNILGFBRkQsTUFFTyxJQUFJLElBQUksS0FBSixJQUFhLElBQUksS0FBSixDQUFVLElBQVYsSUFBa0IsR0FBbkMsRUFBd0M7QUFDM0MsdUJBQU8sSUFBSSxpQ0FBSixDQUEwQixJQUFJLEtBQUosQ0FBVSxPQUFwQyxDQUFQO0FBQ0gsYUFGTSxNQUVBO0FBQ0gsdUJBQU8sSUFBSSxpQ0FBSixFQUFQO0FBQ0g7QUFDSjs7OzRCQUVVO0FBQ1AsbUJBQU8sb0JBQVA7QUFDSDs7O0VBaENtQyxrQjs7SUFrQzNCLGtCLFdBQUEsa0I7OztBQUNULGdDQUFZLFNBQVosRUFBdUIsVUFBdkIsRUFBbUM7QUFBQTs7QUFBQSwySkFDekIsU0FEeUI7O0FBRS9CLGVBQUssV0FBTCxHQUFtQixVQUFuQjtBQUYrQjtBQUdsQzs7OztrQ0FDUztBQUNOLGdCQUFJLEtBQUssV0FBVCxFQUFzQjtBQUNsQixxQkFBSyxNQUFMO0FBQ0g7QUFDSjs7O2lDQUNRO0FBQ0wsaUJBQUssaUJBQUw7QUFDQSxpQkFBSyxPQUFMLENBQWEsSUFBSSxZQUFKLENBQWlCLEtBQUssVUFBdEIsQ0FBYjtBQUNIOzs7c0NBQ2E7QUFDVixpQkFBSyxPQUFMLENBQWEsSUFBSSxXQUFKLENBQWdCLEtBQUssVUFBckIsQ0FBYjtBQUNIOzs7Ozs7Ozs7O0FBS08sd0MsR0FBVyxrQjs7QUFDZixxQ0FBSyxVQUFMLENBQWdCLElBQWhCLENBQXFCLElBQXJCLENBQTBCLEtBQUssU0FBTCxDQUFlO0FBQ3JDLDZDQUFTLEtBRDRCO0FBRXJDLDRDQUFRLDZCQUY2QjtBQUdyQyw0Q0FBUSxFQUg2QjtBQUlyQyx3Q0FBSTtBQUppQyxpQ0FBZixDQUExQjs7Ozs7Ozs7Ozs7Ozs7Ozs7OzRCQUxPO0FBQ1AsbUJBQU8sb0JBQVA7QUFDSDs7O0VBbkJtQyxjOztJQThCM0IscUIsV0FBQSxxQjs7O0FBQ1QsbUNBQVksU0FBWixFQUF1QixRQUF2QixFQUFpQztBQUFBOztBQUFBLGlLQUN2QixTQUR1QixFQUNaLGtDQURZOztBQUU3QixlQUFLLFNBQUwsR0FBaUIsUUFBakI7QUFGNkI7QUFHaEM7Ozs7aUNBQ1EsRyxFQUFLO0FBQ1YsZ0JBQUksSUFBSSxFQUFKLEtBQVcsS0FBSyxTQUFwQixFQUErQjtBQUMzQixvQkFBSSxJQUFJLEtBQVIsRUFBZTtBQUNYLHlCQUFLLE9BQUwsQ0FBYSxJQUFJLFdBQUosQ0FBZ0IsS0FBSyxVQUFyQixDQUFiO0FBQ0gsaUJBRkQsTUFFTztBQUNILHlCQUFLLFVBQUwsQ0FBZ0IsWUFBaEIsR0FBK0IsSUFBSSxNQUFKLENBQVcsV0FBMUM7QUFDQSx5QkFBSyxPQUFMLENBQWEsSUFBSSxZQUFKLENBQWlCLEtBQUssVUFBdEIsQ0FBYjtBQUNIO0FBQ0o7QUFDSjs7OzRCQUNVO0FBQ1AsbUJBQU8sdUJBQVA7QUFDSDs7O0VBakJzQyxrQjs7SUFtQjlCLFksV0FBQSxZOzs7Ozs7Ozs7O2tDQUNDO0FBQ04sZ0JBQUksT0FBTyxJQUFYO0FBQ0EsZ0JBQUksT0FBSixDQUFZLFNBQVMsZ0JBQVQsQ0FBMEIsT0FBMUIsRUFBbUM7QUFDM0MscUJBQUssVUFBTCxDQUFnQixrQkFBaEI7QUFDQTtBQUNILGFBSEQ7QUFJSDs7O2lDQUNRO0FBQ0wsZ0JBQUksUUFBUSxrQkFBWjtBQUNBLGlCQUFLLFVBQUwsQ0FBZ0IsSUFBaEIsQ0FBcUIsSUFBckIsQ0FBMEIsS0FBSyxTQUFMLENBQWU7QUFDckMseUJBQVMsS0FENEI7QUFFckMsd0JBQVEsMEJBRjZCO0FBR3JDLHdCQUFRLEVBQUMsa0JBQWtCLEtBQUssVUFBTCxDQUFnQixhQUFuQyxFQUg2QjtBQUlyQyxvQkFBSTtBQUppQyxhQUFmLENBQTFCO0FBTUEsaUJBQUssT0FBTCxDQUFhLElBQUksd0JBQUosQ0FBNkIsS0FBSyxVQUFsQyxFQUE4QyxLQUE5QyxDQUFiO0FBQ0g7OztpQ0FDUSxHLEVBQUs7QUFDVixnQkFBSSxJQUFJLE1BQUosS0FBZSwwQkFBbkIsRUFBb0M7QUFDaEMscUJBQUssT0FBTCxDQUFhLElBQUksdUJBQUosQ0FBNEIsS0FBSyxVQUFqQyxFQUE2QyxJQUFJLEVBQWpELENBQWI7QUFDSCxhQUZELE1BRU8sSUFBSSxJQUFJLE1BQUosS0FBZSxrQkFBbkIsRUFBdUM7QUFDMUMscUJBQUssVUFBTCxDQUFnQixZQUFoQixHQUErQixJQUFJLE1BQUosQ0FBVyxXQUExQztBQUNIO0FBQ0o7OztzQ0FDYTtBQUNWLGlCQUFLLFVBQUwsQ0FBZ0IsVUFBaEI7QUFDQSxpQkFBSyxVQUFMLENBQWdCLE9BQWhCLENBQXdCLElBQUkscUJBQUosQ0FBMEIsS0FBSyxVQUEvQixDQUF4QjtBQUNIOzs7NEJBQ1U7QUFDUCxtQkFBTyxjQUFQO0FBQ0g7OztFQS9CNkIsYzs7SUFpQ3JCLHFCLFdBQUEscUI7OztBQUNULG1DQUFZLFNBQVosRUFBdUI7QUFBQTtBQUFBLDJKQUNiLFNBRGEsRUFDRixxQ0FERTtBQUV0Qjs7OztpQ0FDUTtBQUNMLGlCQUFLLE9BQUwsQ0FBYSxJQUFJLFlBQUosQ0FBaUIsS0FBSyxVQUF0QixDQUFiO0FBQ0g7OztzQ0FDYTtBQUNWLGlCQUFLLE9BQUwsQ0FBYSxJQUFJLFdBQUosQ0FBZ0IsS0FBSyxVQUFyQixDQUFiO0FBQ0g7Ozs0QkFDVTtBQUNQLG1CQUFPLHVCQUFQO0FBQ0g7OztFQVpzQyxrQjs7SUFjOUIsd0IsV0FBQSx3Qjs7O0FBQ1Qsc0NBQVksU0FBWixFQUF1QixLQUF2QixFQUE4QjtBQUFBOztBQUFBLHVLQUNwQixTQURvQixFQUNULGtDQURTOztBQUUxQixlQUFLLE1BQUwsR0FBYyxLQUFkO0FBRjBCO0FBRzdCOzs7O2lDQUNRLEcsRUFBSztBQUNWLGdCQUFJLElBQUksRUFBSixLQUFXLEtBQUssTUFBaEIsSUFBMEIsSUFBSSxNQUFKLEtBQWUsMEJBQTdDLEVBQThEO0FBQzFELHFCQUFLLE9BQUwsQ0FBYSxJQUFJLGlCQUFKLENBQXNCLEtBQUssVUFBM0IsQ0FBYjtBQUNIO0FBQ0o7Ozs0QkFDVTtBQUNQLG1CQUFPLDBCQUFQO0FBQ0g7OztFQVp5QyxrQjs7SUFjakMsdUIsV0FBQSx1Qjs7O0FBQ1QscUNBQVksU0FBWixFQUF1QixLQUF2QixFQUE4QjtBQUFBOztBQUFBLHNLQUNwQixTQURvQjs7QUFFMUIsZ0JBQUssTUFBTCxHQUFjLEtBQWQ7QUFGMEI7QUFHN0I7Ozs7a0NBQ1M7QUFDTixnQkFBSSxPQUFPLElBQVg7QUFDQSxnQkFBSSxPQUFKLENBQVksU0FBUyxrQkFBVCxDQUE0QixPQUE1QixFQUFxQztBQUM3QyxxQkFBSyxVQUFMLENBQWdCLG9CQUFoQjtBQUNBO0FBQ0gsYUFIRDtBQUlIOzs7aUNBQ1E7QUFDTCxnQkFBSSxPQUFPLElBQVg7QUFDQSxpQkFBSyxVQUFMLENBQWdCLElBQWhCLENBQXFCLElBQXJCLENBQTBCLEtBQUssU0FBTCxDQUFlO0FBQ3JDLHlCQUFTLEtBRDRCO0FBRXJDLHdCQUFRLEVBRjZCO0FBR3JDLG9CQUFJLEtBQUs7QUFINEIsYUFBZixDQUExQjtBQUtBLGlCQUFLLE9BQUwsQ0FBYSxJQUFJLGlCQUFKLENBQXNCLEtBQUssVUFBM0IsQ0FBYjtBQUNIOzs7bUNBQ1U7QUFDUDtBQUNIOzs7c0NBQ2E7QUFDVixpQkFBSyxPQUFMLENBQWEsSUFBSSxpQkFBSixDQUFzQixLQUFLLFVBQTNCLENBQWI7QUFDSDs7OzRCQUNVO0FBQ1AsbUJBQU8seUJBQVA7QUFDSDs7O0VBN0J3QyxjOztJQStCaEMsaUIsV0FBQSxpQjs7Ozs7Ozs7OztrQ0FDQztBQUNOLGdCQUFJLE9BQU8sSUFBWDtBQUNBLGdCQUFJLE9BQUosQ0FBWSxTQUFTLGtCQUFULENBQTRCLE9BQTVCLEVBQXFDO0FBQzdDLHFCQUFLLFVBQUwsQ0FBZ0Isb0JBQWhCO0FBQ0E7QUFDSCxhQUhEO0FBSUEsaUJBQUssVUFBTCxDQUFnQixJQUFoQixDQUFxQixLQUFyQjtBQUNIOzs7c0NBQ2E7QUFDVjtBQUNIOzs7bUNBQ1U7QUFDUDtBQUNIOzs7NEJBQ1U7QUFDUCxtQkFBTyxtQkFBUDtBQUNIOzs7RUFqQmtDLGM7O0lBbUIxQixXLFdBQUEsVzs7O0FBQ1QseUJBQVksU0FBWixFQUF1QixTQUF2QixFQUFrQztBQUFBOztBQUFBLDhJQUN4QixTQUR3Qjs7QUFFOUIsZ0JBQUssVUFBTCxHQUFrQixTQUFsQjtBQUY4QjtBQUdqQzs7OztrQ0FDUztBQUNOLGdCQUFJLE9BQU8sSUFBWDtBQUNBLGdCQUFJLE9BQUosQ0FBWSxTQUFTLFlBQVQsQ0FBc0IsT0FBdEIsRUFBK0I7QUFDdkMscUJBQUssVUFBTCxDQUFnQixjQUFoQixDQUErQixLQUFLLFVBQXBDO0FBQ0E7QUFDSCxhQUhEO0FBSUEsaUJBQUssVUFBTCxDQUFnQixJQUFoQixDQUFxQixLQUFyQjtBQUNIOzs7c0NBQ2E7QUFDVjtBQUNIOzs7NEJBQ1U7QUFDUCxtQkFBTyxhQUFQO0FBQ0g7Ozs0QkFDZTtBQUNaLG1CQUFPLEtBQUssVUFBWjtBQUNIOzs7RUFyQjRCLGM7O0lBd0JaLGdCO0FBQ2pCLDhCQUFZLE1BQVosRUFBb0IsWUFBcEIsRUFBa0MsWUFBbEMsRUFBZ0QsTUFBaEQsRUFBd0QsZ0JBQXhELEVBQTBFLFlBQTFFLEVBQXdGLFVBQXhGLEVBQW9HO0FBQUE7O0FBQ2hHLGFBQUssT0FBTCxHQUFlLE1BQWY7QUFDQSxhQUFLLGlCQUFMLEdBQXlCLG9CQUFvQixxQ0FBN0M7QUFDQSxhQUFLLFdBQUwsR0FBbUIsSUFBbkI7QUFDQSxhQUFLLGFBQUwsR0FBcUIsWUFBckI7QUFDQSxhQUFLLGFBQUwsR0FBcUIsWUFBckI7QUFDQSxhQUFLLE9BQUwsR0FBZSx1QkFBVyxNQUFYLEVBQW1CLE1BQW5CLEVBQTJCLFdBQTNCLENBQWY7QUFDQSxhQUFLLGFBQUwsR0FBcUIsWUFBckI7QUFDQSxhQUFLLFdBQUwsR0FBbUIsVUFBbkI7O0FBRUE7QUFDQSxhQUFLLGlCQUFMLEdBQ0EsS0FBSyxnQkFBTCxHQUNBLEtBQUssa0JBQUwsR0FDQSxLQUFLLG1CQUFMLEdBQ0EsS0FBSyxvQkFBTCxHQUNBLEtBQUssb0JBQUwsR0FDQSxLQUFLLGNBQUwsR0FBc0IsU0FBUyxJQUFULEdBQWdCLENBQUUsQ0FOeEM7QUFPSDs7OztrQ0E2QlM7QUFDTixpQkFBSyxRQUFMO0FBQ0EsaUJBQUssT0FBTCxDQUFhLElBQUksbUJBQUosQ0FBd0IsSUFBeEIsRUFBOEIsS0FBSyxpQkFBbkMsQ0FBYjtBQUNIOzs7bUNBRVU7QUFDUCxpQkFBSyxJQUFMLEdBQVksS0FBSyxpQkFBTCxDQUF1QixLQUFLLGVBQUwsRUFBdkIsQ0FBWjtBQUNIOzs7Z0NBQ08sUyxFQUFXO0FBQ2YsZ0JBQUk7QUFDQSxxQkFBSyxPQUFMLENBQWEsSUFBYixDQUFrQixDQUFDLEtBQUssTUFBTCxHQUFjLEtBQUssTUFBTCxDQUFZLElBQTFCLEdBQWlDLE1BQWxDLElBQTRDLE1BQTVDLEdBQXFELFVBQVUsSUFBakY7QUFDQSxvQkFBSSxLQUFLLEtBQUwsSUFBYyxLQUFLLEtBQUwsQ0FBVyxNQUE3QixFQUFxQztBQUNqQyx5QkFBSyxLQUFMLENBQVcsTUFBWDtBQUNIO0FBQ0osYUFMRCxTQUtVO0FBQ04scUJBQUssTUFBTCxHQUFjLFNBQWQ7QUFDQSxvQkFBSSxLQUFLLE1BQUwsQ0FBWSxPQUFoQixFQUF5QjtBQUNyQix5QkFBSyxNQUFMLENBQVksT0FBWjtBQUNIO0FBQ0o7QUFDSjs7OzBDQUNpQixHLEVBQUs7QUFDbkIsZ0JBQUkscUJBQUo7QUFDQSxnQkFBSSxLQUFLLFdBQVQsRUFBc0I7QUFDbEIsK0JBQWUsSUFBSSx3Q0FBSixDQUFnQyxLQUFLLE9BQXJDLEVBQThDLEtBQUssYUFBbkQsRUFBa0UsS0FBSyxXQUF2RSxDQUFmO0FBQ0gsYUFGRCxNQUVNO0FBQ0YsK0JBQWUsSUFBSSxTQUFKLENBQWMsR0FBZCxDQUFmO0FBQ0g7QUFDRCx5QkFBYSxNQUFiLEdBQXNCLGtCQUFNLElBQU4sRUFBWSxLQUFLLE9BQWpCLENBQXRCO0FBQ0EseUJBQWEsU0FBYixHQUF5QixrQkFBTSxJQUFOLEVBQVksS0FBSyxVQUFqQixDQUF6QjtBQUNBLHlCQUFhLE9BQWIsR0FBdUIsa0JBQU0sSUFBTixFQUFZLEtBQUssUUFBakIsQ0FBdkI7QUFDQSx5QkFBYSxPQUFiLEdBQXVCLGtCQUFNLElBQU4sRUFBWSxLQUFLLFFBQWpCLENBQXZCO0FBQ0EsbUJBQU8sWUFBUDtBQUNIOzs7MENBQ2lCO0FBQ2QsZ0JBQUksS0FBSyxhQUFULEVBQXdCO0FBQ3BCLHVCQUFPLEtBQUssYUFBTCxLQUF1QixjQUF2QixHQUF3QyxtQkFBbUIsS0FBSyxhQUF4QixDQUEvQztBQUNILGFBRkQsTUFFTztBQUNILHVCQUFPLEtBQUssYUFBTCxFQUFQO0FBQ0g7QUFDSjs7OzZDQUNvQjtBQUNqQixtQkFBTyxLQUFLLGFBQUwsS0FBdUIsZUFBdkIsR0FBeUMsbUJBQW1CLEtBQUssWUFBeEIsQ0FBaEQ7QUFDSDs7O3dDQUNlO0FBQ1osZ0JBQUksWUFBWSxHQUFoQjtBQUNBLGdCQUFJLEtBQUssYUFBTCxDQUFtQixPQUFuQixDQUEyQixTQUEzQixJQUF3QyxDQUFDLENBQTdDLEVBQWdEO0FBQzVDLDRCQUFZLEdBQVo7QUFDSDtBQUNELG1CQUFPLEtBQUssYUFBTCxHQUFxQixTQUFyQixHQUFpQyxTQUFqQyxHQUE2QyxtQkFBbUIsS0FBSyxPQUF4QixDQUFwRDtBQUNIOzs7bUNBQ1UsRyxFQUFLO0FBQ1osaUJBQUssS0FBTCxDQUFXLFFBQVgsQ0FBb0IsS0FBSyxLQUFMLENBQVcsSUFBSSxJQUFmLENBQXBCO0FBQ0g7OztnQ0FDTyxHLEVBQUs7QUFDVCxpQkFBSyxLQUFMLENBQVcsTUFBWCxDQUFrQixHQUFsQjtBQUNIOzs7aUNBQ1EsRyxFQUFLO0FBQ1YsaUJBQUssS0FBTCxDQUFXLE9BQVgsQ0FBbUIsR0FBbkI7QUFDSDs7O2lDQUNRLEcsRUFBSztBQUNWLGlCQUFLLE9BQUwsQ0FBYSxHQUFiLENBQWlCLDRCQUE0QixJQUFJLElBQWhDLEdBQXVDLFdBQXZDLEdBQXFELElBQUksTUFBMUU7QUFDQSxpQkFBSyxLQUFMLENBQVcsT0FBWCxDQUFtQixHQUFuQjtBQUNIOzs7cUNBQ1k7QUFDVCxpQkFBSyxJQUFMLEdBQVksS0FBSyxpQkFBTCxDQUF1QixLQUFLLGtCQUFMLEVBQXZCLENBQVo7QUFDSDs7OytCQUNNLEcsRUFBSyxhLEVBQWU7QUFDdkIsaUJBQUssS0FBTCxDQUFXLE1BQVgsQ0FBa0IsR0FBbEIsRUFBdUIsYUFBdkI7QUFDSDs7O2lDQUNRO0FBQ0wsaUJBQUssS0FBTCxDQUFXLE1BQVg7QUFDSDs7O2lDQUNRO0FBQ0wsaUJBQUssS0FBTCxDQUFXLE1BQVg7QUFDSDs7OzRCQXZHWTtBQUNULG1CQUFPLEtBQUssT0FBWjtBQUNIOzs7MEJBQ2UsZ0IsRUFBa0I7QUFDOUIsaUJBQUssaUJBQUwsR0FBeUIsZ0JBQXpCO0FBQ0g7OzswQkFDYyxlLEVBQWlCO0FBQzVCLGlCQUFLLGdCQUFMLEdBQXdCLGVBQXhCO0FBQ0g7OzswQkFDZ0IsaUIsRUFBbUI7QUFDaEMsaUJBQUssa0JBQUwsR0FBMEIsaUJBQTFCO0FBQ0g7OzswQkFDaUIsa0IsRUFBb0I7QUFDbEMsaUJBQUssbUJBQUwsR0FBMkIsa0JBQTNCO0FBQ0g7OzswQkFDa0IsbUIsRUFBcUI7QUFDcEMsaUJBQUssb0JBQUwsR0FBNEIsbUJBQTVCO0FBQ0g7OzswQkFDa0IsbUIsRUFBcUI7QUFDcEMsaUJBQUssb0JBQUwsR0FBNEIsbUJBQTVCO0FBQ0g7OzswQkFDWSxhLEVBQWU7QUFDeEIsaUJBQUssY0FBTCxHQUFzQixhQUF0QjtBQUNIOzs7NEJBQ1c7QUFDUixtQkFBTyxLQUFLLE1BQVo7QUFDSDs7Ozs7a0JBOUNnQixnQjs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQzNXQSw4QjtBQUNqQiw4Q0FBYztBQUFBOztBQUNWLGdCQUFRLEdBQVIsQ0FBWSw0Q0FBWjtBQUNIOzs7OzBDQUVnQjtBQUNiLG9CQUFRLEtBQVIsQ0FBYyx3Q0FBZDtBQUNIOztBQUVEO0FBQ0E7Ozs7MkRBQ2tDO0FBQzlCLG9CQUFRLEtBQVIsQ0FBYyx5REFBZDtBQUNIOzs7bURBRTBCO0FBQ3ZCLG9CQUFRLEtBQVIsQ0FBYyxpREFBZDtBQUNIOztBQUVEOzs7OytCQUNPO0FBQ0gsb0JBQVEsS0FBUixDQUFjLDZCQUFkO0FBQ0g7OztvQ0FFVztBQUNSLG9CQUFRLEtBQVIsQ0FBYyxrQ0FBZDtBQUNIOzs7K0NBRXNCO0FBQ25CLG9CQUFRLEtBQVIsQ0FBYyw2Q0FBZDtBQUNIOzs7MkNBRWtCO0FBQ2Ysb0JBQVEsS0FBUixDQUFjLHlDQUFkO0FBQ0g7OztzREFFNkI7QUFDMUIsb0JBQVEsS0FBUixDQUFjLG9EQUFkO0FBQ0g7OztnREFFdUI7QUFDcEIsb0JBQVEsS0FBUixDQUFjLDhDQUFkO0FBQ0g7OztrQ0FFUztBQUNOLG9CQUFRLEtBQVIsQ0FBYyxnQ0FBZDtBQUNIOzs7bUNBRVU7QUFDUCxvQkFBUSxLQUFSLENBQWMsaUNBQWQ7QUFDSDs7O2lEQUV3QjtBQUNyQixvQkFBUSxLQUFSLENBQWMsK0NBQWQ7QUFDSDs7Ozs7a0JBdERnQiw4Qjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNHckI7Ozs7QUFDQTs7QUFDQTs7OztJQUVxQixpQjs7O0FBRWpCLGlDQUFrQztBQUFBLFlBQXRCLGFBQXNCLHVFQUFOLElBQU07QUFBQTs7QUFBQTs7QUFFOUIsWUFBRyxhQUFILEVBQWlCO0FBQ2Isb0JBQVEsNEJBQVI7QUFDSDtBQUNELGdCQUFRLEdBQVIsQ0FBWSxnQ0FBWjtBQUNBLGNBQUssZ0JBQUw7QUFDQSxjQUFLLHdCQUFMO0FBQ0EsY0FBSyxPQUFMO0FBUjhCO0FBU2pDOzs7OzJDQUVrQjtBQUNmLG1CQUFPLFlBQVAsQ0FBb0Isa0JBQXBCLENBQXVDLFVBQUMsS0FBRCxFQUFXO0FBQzlDLG9CQUFJLE1BQU0sS0FBTixLQUFnQixvQkFBcEIsRUFBMEM7QUFDdEMsd0JBQUksQ0FBQyxPQUFPLFlBQVAsQ0FBb0IsV0FBcEIsQ0FBZ0MsV0FBaEMsQ0FBTCxFQUFtRDtBQUMvQyw4QkFBTSxJQUFJLEtBQUosQ0FBVSxxREFBVixDQUFOO0FBQ0g7QUFDRCw0QkFBUSxHQUFSLENBQVksK0JBQVo7QUFDSCxpQkFMRCxNQUtPLElBQUksTUFBTSxLQUFOLEtBQWdCLHVCQUFwQixFQUE2QztBQUNoRCw0QkFBUSxHQUFSLENBQVksdUJBQVo7QUFDSDtBQUNKLGFBVEQ7QUFVQSxtQkFBTyxZQUFQLENBQW9CLFNBQXBCLENBQThCLGVBQTlCO0FBQ0g7OzttREFDMEI7QUFDdkIsbUJBQU8sb0JBQVAsR0FBOEI7QUFBQSx1QkFBTSxRQUFRLE9BQVIsQ0FBZ0IsQ0FBaEIsQ0FBTjtBQUFBLGFBQTlCO0FBQ0g7OztrQ0FFUztBQUNOLG1CQUFPLFlBQVAsQ0FBb0IsT0FBcEIsQ0FBNEIsT0FBTyxPQUFQLENBQWUsTUFBZixFQUE1QjtBQUNIOztBQUVEO0FBQ0E7Ozs7MkRBQ21DO0FBQy9CO0FBQ0EsbUJBQU8sS0FBUDtBQUNIOzs7aURBRXdCLHVCLEVBQXlCLCtCLEVBQWlDO0FBQy9FLG1CQUFPLElBQUksT0FBTyxZQUFQLENBQW9CLG9CQUF4QixDQUE2Qyx1QkFBN0MsRUFBc0UsK0JBQXRFLENBQVA7QUFDSDs7QUFFRDs7Ozs2QkFDSyxXLEVBQWE7QUFDZCxtQkFBTyxPQUFPLFlBQVAsQ0FBb0IsWUFBcEIsQ0FBaUMsV0FBakMsQ0FBUDtBQUNIOzs7a0NBRVMsRyxFQUFLLE0sRUFBUTtBQUNuQixtQkFBTyxTQUFQLEdBQW1CLE9BQW5CLENBQTJCLGlCQUFTO0FBQ2hDLG9CQUFJLGNBQUosQ0FBbUIsS0FBbkIsRUFBMEIsRUFBMUI7QUFDSCxhQUZEO0FBR0g7Ozs2Q0FFb0IsSSxFQUFNLFUsRUFBWTtBQUNuQyxnQkFBTSwyQkFBMkIsS0FBSyx5QkFBTCxDQUErQixFQUFDLE1BQU0sUUFBUCxFQUFpQixLQUFLLEtBQUssSUFBM0IsRUFBL0IsQ0FBakM7O0FBRUEsdUJBQVcsR0FBWCxDQUFlLG9CQUFmLENBQW9DLHdCQUFwQyxFQUE4RCxZQUFNO0FBQ2hFLG9CQUFJLDBCQUEwQixRQUFRLEdBQVIsQ0FBWSxLQUFLLFdBQUwsQ0FBaUIsR0FBakIsQ0FBcUIsVUFBVSxTQUFWLEVBQXFCO0FBQ2hGLHdCQUFJLGtCQUFrQixLQUFLLHNCQUFMLENBQTRCLFNBQTVCLENBQXRCO0FBQ0EseUJBQUssTUFBTCxDQUFZLElBQVosQ0FBaUIseUJBQWpCLEVBQTRDLGVBQTVDO0FBQ0EsMkJBQU8sV0FBVyxHQUFYLENBQWUsZUFBZixDQUErQixlQUEvQixDQUFQO0FBQ0gsaUJBSnlDLENBQVosQ0FBOUI7QUFLQSx3Q0FBd0IsS0FBeEIsQ0FBOEIsa0JBQVU7QUFDcEMseUJBQUssTUFBTCxDQUFZLElBQVosQ0FBaUIsK0JBQWpCLEVBQWtELE1BQWxEO0FBQ0gsaUJBRkQ7QUFHQSwyQkFBVyxjQUFYLENBQTBCLDJCQUExQixHQUF3RCxLQUF4RDtBQUNBLHFCQUFLLHFCQUFMLEdBQTZCLElBQTdCO0FBQ0EscUJBQUssZ0JBQUw7QUFDSCxhQVpELEVBWUcsWUFBTTtBQUNMLDJCQUFXLFlBQVg7QUFDQSwyQkFBVyxjQUFYLENBQTBCLDJCQUExQixHQUF3RCxJQUF4RDtBQUNBLHFCQUFLLE9BQUwsQ0FBYSxJQUFJLHdCQUFKLENBQWdCLFVBQWhCLEVBQTRCLHNCQUFXLDhCQUF2QyxDQUFiO0FBQ0gsYUFoQkQ7QUFpQkg7Ozt5Q0FFZ0IsRyxFQUFLLEcsRUFBSztBQUN2QixtQkFBTyxJQUFJLGtCQUFYO0FBQ0g7OztvREFFMkIsRyxFQUFLO0FBQzdCLG1CQUFPLElBQUksZ0JBQVg7QUFDSDs7OzhDQUVxQixhLEVBQWUscUIsRUFBdUI7QUFDeEQsbUJBQU8sSUFBSSxPQUFPLFlBQVAsQ0FBb0Isb0JBQXhCLENBQTZDLGFBQTdDLEVBQTRELHFCQUE1RCxDQUFQO0FBQ0g7OztpQ0FFUSxJLEVBQU0sRyxFQUFLO0FBQ2hCLG1CQUFPLFlBQVAsQ0FBb0IsZUFBcEIsQ0FBb0MsS0FBSyxtQkFBekM7QUFDQSxnQkFBSSxJQUFJLE9BQUosQ0FBWSxNQUFaLEdBQXFCLENBQXpCLEVBQTRCO0FBQ3hCLHFCQUFLLE9BQUwsQ0FBYSxJQUFiLENBQWtCLG1DQUFtQyxJQUFJLEtBQUosQ0FBVSxJQUE3QyxHQUFvRCxTQUFwRCxHQUFnRSxJQUFJLEtBQUosQ0FBVSxFQUExRSxHQUErRSxLQUEvRSxHQUNkLElBQUksT0FBSixDQUFZLEdBQVosQ0FBZ0I7QUFBQSwyQkFBVSxPQUFPLEVBQWpCO0FBQUEsaUJBQWhCLEVBQXFDLElBQXJDLENBQTBDLEdBQTFDLENBREo7QUFFSDtBQUNELGdCQUFJLElBQUksS0FBSixDQUFVLElBQVYsS0FBbUIsT0FBbkIsSUFBOEIsS0FBSyxtQkFBdkMsRUFBNEQ7QUFDeEQscUJBQUssbUJBQUwsQ0FBeUIsU0FBekIsR0FBcUMsSUFBSSxPQUFKLENBQVksQ0FBWixDQUFyQztBQUNBLHFCQUFLLGtCQUFMLEdBQTBCLElBQUksT0FBSixDQUFZLENBQVosQ0FBMUI7QUFDSCxhQUhELE1BR08sSUFBSSxJQUFJLEtBQUosQ0FBVSxJQUFWLEtBQW1CLE9BQW5CLElBQThCLEtBQUssbUJBQXZDLEVBQTREO0FBQy9ELHFCQUFLLG1CQUFMLENBQXlCLFNBQXpCLEdBQXFDLElBQUksT0FBSixDQUFZLENBQVosQ0FBckM7QUFDQSxxQkFBSyxrQkFBTCxHQUEwQixJQUFJLE9BQUosQ0FBWSxDQUFaLENBQTFCO0FBQ0g7QUFDRCxpQkFBSyxtQkFBTCxDQUF5QixJQUF6QjtBQUNIOzs7K0NBRXNCLEksRUFBTSxnQixFQUFrQjtBQUMzQyxnQkFBSSxLQUFLLFlBQVQsRUFBdUI7QUFDbkIsb0JBQUksbUJBQW1CLEVBQXZCO0FBQ0Esb0JBQUksT0FBTyxLQUFLLGlCQUFaLEtBQWtDLFdBQXRDLEVBQW1EO0FBQy9DLHFDQUFpQixnQkFBakIsR0FBb0MsQ0FBQyxDQUFDLEtBQUssaUJBQTNDO0FBQ0g7QUFDRCxvQkFBSSxPQUFPLFdBQVgsRUFBd0I7QUFDcEIscUNBQWlCLFFBQWpCLEdBQTRCLE9BQU8sV0FBbkM7QUFDSDtBQUNELG9CQUFJLE9BQU8sSUFBUCxDQUFZLGdCQUFaLEVBQThCLE1BQTlCLEdBQXVDLENBQTNDLEVBQThDO0FBQzFDLHFDQUFpQixLQUFqQixHQUF5QixnQkFBekI7QUFDSCxpQkFGRCxNQUVPO0FBQ0gscUNBQWlCLEtBQWpCLEdBQXlCLElBQXpCO0FBQ0g7QUFDSixhQWJELE1BYU87QUFDSCxpQ0FBaUIsS0FBakIsR0FBeUIsS0FBekI7QUFDSDtBQUNKOzs7MENBRWlCO0FBQ2QsbUJBQU8sbUJBQVA7QUFDSDs7O0VBL0gwQyx3QyxHQVIvQzs7OztrQkFRcUIsaUI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ1JyQjs7OztBQUNBOztBQUNBOztBQUNBOzs7O0lBRXFCLGdCOzs7QUFDakIsZ0NBQWM7QUFBQTs7QUFBQTs7QUFFVixnQkFBUSxHQUFSLENBQVksOEJBQVo7QUFGVTtBQUdiOztBQUVEO0FBQ0E7Ozs7OzJEQUNrQztBQUM5QixtQkFBTyxpQ0FBcUIseUNBQTZCLG1DQUF6RDtBQUNIOzs7aURBRXdCLHVCLEVBQXlCLCtCLEVBQWlDO0FBQy9FLG1CQUFPLElBQUksaUJBQUosQ0FBc0IsdUJBQXRCLEVBQStDLCtCQUEvQyxDQUFQO0FBQ0g7O0FBRUQ7Ozs7NkJBQ0ssVyxFQUFhO0FBQ2QsbUJBQU8sVUFBVSxZQUFWLENBQXVCLFlBQXZCLENBQW9DLFdBQXBDLENBQVA7QUFDSDs7O2tDQUVTLEcsRUFBSyxNLEVBQVE7QUFDbkIsZ0JBQUksU0FBSixDQUFjLE1BQWQ7QUFDSDs7OzZDQUVvQixJLEVBQU0sVSxFQUFZO0FBQ25DLGdCQUFJLDhCQUE4QixXQUFXLEdBQVgsQ0FBZSxvQkFBZixDQUFvQyxLQUFLLHlCQUFMLENBQStCO0FBQ2pHLHNCQUFNLFFBRDJGO0FBRWpHLHFCQUFLLEtBQUs7QUFGdUYsYUFBL0IsQ0FBcEMsQ0FBbEM7QUFJQSx3Q0FBNEIsS0FBNUIsQ0FBa0MsYUFBSztBQUNuQyxxQkFBSyxNQUFMLENBQVksS0FBWixDQUFrQiw2QkFBbEIsRUFBaUQsQ0FBakQ7QUFDSCxhQUZEO0FBR0Esd0NBQTRCLElBQTVCLENBQWlDLFlBQU07QUFDbkMsb0JBQUksMEJBQTBCLFFBQVEsR0FBUixDQUFZLEtBQUssV0FBTCxDQUFpQixHQUFqQixDQUFxQixVQUFVLFNBQVYsRUFBcUI7QUFDaEYsd0JBQUksa0JBQWtCLEtBQUssc0JBQUwsQ0FBNEIsU0FBNUIsQ0FBdEI7QUFDQSx5QkFBSyxNQUFMLENBQVksSUFBWixDQUFpQix5QkFBakIsRUFBNEMsZUFBNUM7QUFDQSwyQkFBTyxXQUFXLEdBQVgsQ0FBZSxlQUFmLENBQStCLGVBQS9CLENBQVA7QUFDSCxpQkFKeUMsQ0FBWixDQUE5QjtBQUtBLHdDQUF3QixLQUF4QixDQUE4QixrQkFBVTtBQUNwQyx5QkFBSyxNQUFMLENBQVksSUFBWixDQUFpQiwrQkFBakIsRUFBa0QsTUFBbEQ7QUFDSCxpQkFGRDtBQUdBLHVCQUFPLHVCQUFQO0FBQ0gsYUFWRCxFQVVHLElBVkgsQ0FVUSxZQUFNO0FBQ1YsMkJBQVcsY0FBWCxDQUEwQiwyQkFBMUIsR0FBd0QsS0FBeEQ7QUFDQSxxQkFBSyxxQkFBTCxHQUE2QixJQUE3QjtBQUNBLHFCQUFLLGdCQUFMO0FBQ0gsYUFkRCxFQWNHLEtBZEgsQ0FjUyxZQUFNO0FBQ1gsMkJBQVcsWUFBWDtBQUNBLDJCQUFXLGNBQVgsQ0FBMEIsMkJBQTFCLEdBQXdELElBQXhEO0FBQ0EscUJBQUssT0FBTCxDQUFhLElBQUksd0JBQUosQ0FBZ0IsVUFBaEIsRUFBNEIsc0JBQVcsOEJBQXZDLENBQWI7QUFDSCxhQWxCRDtBQW1CSDs7O3lDQUVnQixHLEVBQUssRyxFQUFLO0FBQUU7QUFDekIsbUJBQU8sSUFBSSxhQUFKLENBQWtCLGtCQUF6QjtBQUNIOzs7b0RBRTJCLEcsRUFBSztBQUM3QixtQkFBTyxJQUFJLGVBQVg7QUFDSDs7OzhDQUVxQixhLEVBQWUscUIsRUFBdUI7QUFDeEQsbUJBQU8sSUFBSSxpQkFBSixDQUFzQixhQUF0QixFQUFxQyxxQkFBckMsQ0FBUDtBQUNIOzs7aUNBRVEsSSxFQUFNLEcsRUFBSztBQUNoQixnQkFBSSxJQUFJLE9BQUosQ0FBWSxNQUFaLEdBQXFCLENBQXpCLEVBQTRCO0FBQ3hCLHFCQUFLLE9BQUwsQ0FBYSxJQUFiLENBQWtCLG1DQUFtQyxJQUFJLEtBQUosQ0FBVSxJQUE3QyxHQUFvRCxTQUFwRCxHQUFnRSxJQUFJLEtBQUosQ0FBVSxFQUExRSxHQUErRSxLQUEvRSxHQUNkLElBQUksT0FBSixDQUFZLEdBQVosQ0FBZ0I7QUFBQSwyQkFBVSxPQUFPLEVBQWpCO0FBQUEsaUJBQWhCLEVBQXFDLElBQXJDLENBQTBDLEdBQTFDLENBREo7QUFFSDtBQUNELGdCQUFJLElBQUksS0FBSixDQUFVLElBQVYsS0FBbUIsT0FBbkIsSUFBOEIsS0FBSyxtQkFBdkMsRUFBNEQ7QUFDeEQscUJBQUssbUJBQUwsQ0FBeUIsU0FBekIsR0FBcUMsSUFBSSxPQUFKLENBQVksQ0FBWixDQUFyQztBQUNBLHFCQUFLLGtCQUFMLEdBQTBCLElBQUksT0FBSixDQUFZLENBQVosQ0FBMUI7QUFDSCxhQUhELE1BR08sSUFBSSxJQUFJLEtBQUosQ0FBVSxJQUFWLEtBQW1CLE9BQW5CLElBQThCLEtBQUssbUJBQXZDLEVBQTREO0FBQy9ELHFCQUFLLG1CQUFMLENBQXlCLFNBQXpCLEdBQXFDLElBQUksT0FBSixDQUFZLENBQVosQ0FBckM7QUFDQSxxQkFBSyxrQkFBTCxHQUEwQixJQUFJLE9BQUosQ0FBWSxDQUFaLENBQTFCO0FBQ0g7QUFDSjs7OytDQUVzQixJLEVBQU0sZ0IsRUFBa0I7QUFDM0MsZ0JBQUksS0FBSyxZQUFULEVBQXVCO0FBQ25CLG9CQUFJLG1CQUFtQixFQUF2QjtBQUNBLG9CQUFJLE9BQU8sS0FBSyxpQkFBWixLQUFrQyxXQUF0QyxFQUFtRDtBQUMvQyxxQ0FBaUIsZ0JBQWpCLEdBQW9DLENBQUMsQ0FBQyxLQUFLLGlCQUEzQztBQUNIO0FBQ0Qsb0JBQUksT0FBTyxJQUFQLENBQVksZ0JBQVosRUFBOEIsTUFBOUIsR0FBdUMsQ0FBM0MsRUFBOEM7QUFDMUMscUNBQWlCLEtBQWpCLEdBQXlCLGdCQUF6QjtBQUNILGlCQUZELE1BRU87QUFDSCxxQ0FBaUIsS0FBakIsR0FBeUIsSUFBekI7QUFDSDtBQUNKLGFBVkQsTUFVTztBQUNILGlDQUFpQixLQUFqQixHQUF5QixLQUF6QjtBQUNIO0FBQ0o7OzswQ0FFaUI7QUFDZCxtQkFBTyxrQkFBUDtBQUNIOzs7RUFsR3lDLHdDOztrQkFBekIsZ0I7Ozs7Ozs7Ozs7Ozs7Ozs7OztRQ3VCTCxLLEdBQUEsSztRQXVCQSxVLEdBQUEsVTtRQVdBLFcsR0FBQSxXO1FBK0RBLFksR0FBQSxZO1FBNkVBLFUsR0FBQSxVO1FBSUEsWSxHQUFBLFk7UUFRQSw0QixHQUFBLDRCO1FBZUEsVSxHQUFBLFU7UUFPQSxVLEdBQUEsVTtRQU1BLGUsR0FBQSxlO1FBSUEsdUIsR0FBQSx1QjtRQVVBLGMsR0FBQSxjOztBQTFQaEI7O0FBQ0E7Ozs7QUFFQTs7O0FBVEE7Ozs7OztBQVlBLElBQUksYUFBYSxDQUFDLEtBQUQsRUFBUSxNQUFSLEVBQWdCLE1BQWhCLEVBQXdCLE9BQXhCLENBQWpCOztBQUVBOzs7Ozs7Ozs7Ozs7OztBQWNPLFNBQVMsS0FBVCxHQUFpQjtBQUNwQixRQUFJLE9BQU8sTUFBTSxTQUFOLENBQWdCLEtBQWhCLENBQXNCLElBQXRCLENBQTJCLFNBQTNCLENBQVg7QUFDQSxRQUFJLFFBQVEsS0FBSyxLQUFMLEVBQVo7QUFDQSxRQUFJLFNBQVMsS0FBSyxLQUFMLEVBQWI7O0FBRUEsUUFBSSxDQUFDLEtBQUwsRUFBWTtBQUNSLGNBQU0sSUFBSSw2QkFBSixDQUFzQixtQ0FBdEIsQ0FBTjtBQUNIOztBQUVELFFBQUksQ0FBQyxNQUFMLEVBQWE7QUFDVCxjQUFNLElBQUksNkJBQUosQ0FBc0Isb0NBQXRCLENBQU47QUFDSDs7QUFFRCxRQUFJLE9BQU8sTUFBUCxLQUFrQixVQUF0QixFQUFrQztBQUM5QixjQUFNLElBQUksNkJBQUosQ0FBc0IsMENBQXRCLENBQU47QUFDSDs7QUFFRCxXQUFPLFNBQVMsZ0JBQVQsR0FBNEI7QUFDL0IsWUFBSSxjQUFjLE1BQU0sU0FBTixDQUFnQixLQUFoQixDQUFzQixJQUF0QixDQUEyQixTQUEzQixDQUFsQjtBQUNBLGVBQU8sT0FBTyxLQUFQLENBQWEsS0FBYixFQUFvQixLQUFLLE1BQUwsQ0FBWSxXQUFaLENBQXBCLENBQVA7QUFDSCxLQUhEO0FBSUg7O0FBRU0sU0FBUyxVQUFULENBQW9CLE1BQXBCLEVBQTRCLE1BQTVCLEVBQW9DLFdBQXBDLEVBQWlEO0FBQ3BELFFBQUksVUFBVSxFQUFkO0FBQ0EsZUFBVyxPQUFYLENBQW1CLFVBQVUsU0FBVixFQUFxQjtBQUNwQyxZQUFJLENBQUMsT0FBTyxTQUFQLENBQUwsRUFBd0I7QUFDcEIsa0JBQU0sSUFBSSxLQUFKLENBQVUsb0JBQW9CLFNBQXBCLEdBQWdDLFdBQTFDLENBQU47QUFDSDtBQUNELGdCQUFRLFNBQVIsSUFBcUIsTUFBTSxNQUFOLEVBQWMsT0FBTyxTQUFQLENBQWQsRUFBaUMsTUFBakMsRUFBeUMsV0FBekMsQ0FBckI7QUFDSCxLQUxEO0FBTUEsV0FBTyxPQUFQO0FBQ0g7O0FBRU0sU0FBUyxXQUFULENBQXFCLE1BQXJCLEVBQTZCO0FBQ2hDLFFBQUksTUFBSixFQUFZO0FBQ1IsWUFBSSxTQUFTLE9BQU8sU0FBUCxFQUFiO0FBQ0EsYUFBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLE9BQU8sTUFBM0IsRUFBbUMsR0FBbkMsRUFBd0M7QUFDcEMsZ0JBQUksUUFBUSxPQUFPLENBQVAsQ0FBWjtBQUNBLGdCQUFJO0FBQ0Esc0JBQU0sSUFBTjtBQUNILGFBRkQsQ0FFRSxPQUFPLENBQVAsRUFBVTtBQUNSO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7O0FBRUQ7Ozs7O0lBSWEsVSxXQUFBLFU7QUFDVCwwQkFBYztBQUFBOztBQUNWLGFBQUssV0FBTCxHQUFtQixFQUFuQjtBQUNIOzs7Ozs7QUF1QkQ7Ozs7OzsyQ0FNbUIsUyxFQUFXLFMsRUFBVztBQUNyQyxnQkFBSSxxQkFBcUIsVUFBVSxXQUFWLEVBQXpCO0FBQ0EsbUJBQU8sS0FBSyxXQUFMLENBQWlCLFNBQWpCLEtBQStCLHVCQUF1QixLQUFLLFdBQUwsQ0FBaUIsU0FBakIsRUFBNEIsV0FBNUIsRUFBdEQsSUFBbUcsdUJBQXVCLGlCQUFqSTtBQUNIOzs7NEJBOUJtQjtBQUNoQixtQkFBTyxLQUFLLGNBQVo7QUFDSDs7QUFFRDs7Ozs7MEJBSWtCLEksRUFBTTtBQUNwQixpQkFBSyxjQUFMLEdBQXNCLElBQXRCO0FBQ0g7O0FBRUQ7Ozs7Ozs7OzRCQUtpQjtBQUNiLG1CQUFPLEtBQUssV0FBWjtBQUNIOzs7OztBQWNMOzs7Ozs7Ozs7QUFPTyxTQUFTLFlBQVQsQ0FBc0IsR0FBdEIsRUFBMkIsVUFBM0IsRUFBdUM7QUFDMUMsUUFBSSxXQUFXLHdCQUFjLEdBQWQsQ0FBZjtBQUNBLFNBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxTQUFTLE1BQTdCLEVBQXFDLEdBQXJDLEVBQTBDO0FBQ3RDLFlBQUksWUFBWSxrQkFBUSxTQUFTLENBQVQsQ0FBUixDQUFoQjtBQUNBLFlBQUksWUFBWSw2QkFBbUIsU0FBUyxDQUFULENBQW5CLENBQWhCO0FBQ0E7QUFDQSxZQUFJLFdBQVcsVUFBVSxNQUFWLENBQWlCLE1BQWpCLENBQXdCLFVBQUMsR0FBRCxFQUFNLEtBQU4sRUFBZ0I7QUFDbkQsZ0JBQUksS0FBSyxNQUFNLFdBQWYsSUFBOEIsS0FBOUI7QUFDQSxtQkFBTyxHQUFQO0FBQ0gsU0FIYyxFQUdaLEVBSFksQ0FBZjtBQUlBLGlCQUFTLENBQVQsSUFBYyxxQkFBVyxTQUFTLENBQVQsQ0FBWCxFQUF3QixHQUF4QixDQUE0QixnQkFBUTtBQUM5QyxnQkFBSSxLQUFLLFVBQUwsQ0FBZ0IsSUFBaEIsQ0FBSixFQUEyQjtBQUN2QjtBQUNBLG9CQUFJLFdBQVcsVUFBWCxDQUFzQixTQUF0QixDQUFKLEVBQXNDO0FBQ2xDLHdCQUFJLGlCQUFpQixPQUFPLElBQVAsQ0FBWSxRQUFaLEVBQXNCLE1BQXRCLENBQTZCO0FBQUEsK0JBQU0sQ0FBQyxXQUFXLGtCQUFYLENBQThCLFNBQTlCLEVBQXlDLFNBQVMsRUFBVCxFQUFhLElBQXRELENBQVA7QUFBQSxxQkFBN0IsQ0FBckI7QUFDQSwyQkFBTyxtQkFBa0IsSUFBbEIsQ0FBdUIsSUFBdkIsSUFBK0IsZUFBZSxJQUFmLENBQW9CLEdBQXBCO0FBQXRDO0FBQ0gsaUJBSEQsTUFHTztBQUNILDJCQUFPLElBQVA7QUFDSDtBQUNKLGFBUkQsTUFRTyxJQUFJLEtBQUssVUFBTCxDQUFnQixXQUFoQixDQUFKLEVBQWtDO0FBQ3JDLG9CQUFJLFNBQVMsc0JBQVksSUFBWixDQUFiO0FBQ0Esb0JBQUksZUFBZSxTQUFTLE9BQU8sV0FBaEIsQ0FBbkI7O0FBRUE7QUFDQSxvQkFBSSxXQUFXLFlBQVgsS0FBNEIsV0FBVyxrQkFBWCxDQUE4QixTQUE5QixFQUF5QyxhQUFhLElBQXRELENBQWhDLEVBQTZGO0FBQ3pGLDJCQUFPLElBQVA7QUFDSDs7QUFFRDtBQUNBLG9CQUFJLFdBQVcsWUFBWCxLQUE0QixhQUFhLElBQWIsQ0FBa0IsV0FBbEIsT0FBb0MsTUFBcEUsRUFBNEU7QUFDeEUsaUNBQWEsVUFBYixDQUF3QixNQUF4QixHQUFpQyxXQUFXLGFBQVgsR0FBMkIsR0FBM0IsR0FBaUMsR0FBbEU7QUFDQTtBQUNBLDJCQUFPLENBQUMsT0FBTyxNQUFQLEdBQWdCLG9CQUFVLFlBQVYsQ0FBakIsRUFBMEMsSUFBMUMsRUFBUDtBQUNILGlCQUpELE1BSU87QUFDSCwyQkFBTyxJQUFQO0FBQ0g7QUFDSixhQWpCTSxNQWlCQSxJQUFJLEtBQUssVUFBTCxDQUFnQixTQUFoQixDQUFKLEVBQWdDO0FBQ25DLG9CQUFJLEtBQUssS0FBSyxTQUFMLENBQWUsVUFBVSxNQUF6QixFQUFpQyxLQUFLLE9BQUwsQ0FBYSxHQUFiLENBQWpDLENBQVQ7QUFDQSxvQkFBSSxlQUFlLFNBQVMsRUFBVCxDQUFuQixDQUZtQyxDQUVIOztBQUVoQztBQUNBLG9CQUFJLFdBQVcsWUFBWCxLQUE0QixXQUFXLGtCQUFYLENBQThCLFNBQTlCLEVBQXlDLGFBQWEsSUFBdEQsQ0FBaEMsRUFBNkY7QUFDekYsMkJBQU8sSUFBUDtBQUNIOztBQUVELG9CQUFJLFdBQVcsWUFBWCxLQUE0QixhQUFhLElBQWIsQ0FBa0IsV0FBbEIsT0FBb0MsTUFBcEUsRUFBNEU7QUFDeEU7QUFDQSwyQkFBTyxJQUFQO0FBQ0gsaUJBSEQsTUFHTztBQUNILDJCQUFPLElBQVA7QUFDSDtBQUNKLGFBZk0sTUFlQSxJQUFJLEtBQUssVUFBTCxDQUFnQixZQUFoQixDQUFKLEVBQW1DO0FBQ3RDLG9CQUFJLEtBQUssS0FBSyxTQUFMLENBQWUsS0FBSyxPQUFMLENBQWEsR0FBYixJQUFvQixDQUFuQyxFQUFzQyxLQUFLLE9BQUwsQ0FBYSxHQUFiLENBQXRDLENBQVQsQ0FEc0MsQ0FDNEI7QUFDbEUsb0JBQUksT0FBTyxHQUFYLEVBQWdCO0FBQUU7QUFDZCwyQkFBTyxJQUFQO0FBQ0gsaUJBRkQsTUFFTztBQUNILHdCQUFJLGVBQWUsU0FBUyxFQUFULENBQW5CLENBREcsQ0FDNkI7O0FBRWhDO0FBQ0Esd0JBQUksV0FBVyxZQUFYLEtBQTRCLFdBQVcsa0JBQVgsQ0FBOEIsU0FBOUIsRUFBeUMsYUFBYSxJQUF0RCxDQUFoQyxFQUE2RjtBQUN6RiwrQkFBTyxJQUFQO0FBQ0gscUJBRkQsTUFFTztBQUNILCtCQUFPLElBQVA7QUFDSDtBQUNKO0FBQ0osYUFkTSxNQWNBO0FBQ0gsdUJBQU8sSUFBUDtBQUNIO0FBQ0osU0ExRGEsRUEwRFgsTUExRFcsQ0EwREo7QUFBQSxtQkFBUSxTQUFTLElBQWpCO0FBQUEsU0ExREksRUEwRG1CLElBMURuQixDQTBEd0IsTUExRHhCLENBQWQ7QUE0REg7QUFDRCxXQUFPO0FBQ0gsYUFBSyxTQUFTLEdBQVQsQ0FBYTtBQUFBLG1CQUFXLFFBQVEsSUFBUixFQUFYO0FBQUEsU0FBYixFQUF3QyxJQUF4QyxDQUE2QyxNQUE3QyxJQUF1RCxNQUR6RDtBQUVILGdCQUFRLFNBQVMsTUFBVCxHQUFrQixDQUZ2QixDQUV5QjtBQUZ6QixLQUFQO0FBSUg7O0FBRU0sU0FBUyxVQUFULENBQW9CLENBQXBCLEVBQXVCO0FBQzFCLFdBQU8sT0FBTyxDQUFQLEtBQWEsV0FBcEI7QUFDSDs7QUFFTSxTQUFTLFlBQVQsQ0FBc0IsQ0FBdEIsRUFBeUIsYUFBekIsRUFBd0M7QUFDM0MsUUFBSSxjQUFjLFdBQVcsYUFBWCxJQUE0QixhQUE1QixHQUE0QyxJQUE5RDtBQUNBLFdBQU8sV0FBVyxDQUFYLElBQWdCLENBQWhCLEdBQW9CLFdBQTNCO0FBQ0g7O0FBRUQ7OztBQUdPLFNBQVMsNEJBQVQsQ0FBc0MsRUFBdEMsRUFBMEM7QUFDN0MsV0FBTyxJQUFJLE9BQUosQ0FBWSxVQUFTLE9BQVQsRUFBa0I7QUFDakMsV0FBRyxRQUFILENBQVksWUFBVztBQUNuQixvQkFBUSxJQUFSO0FBQ0gsU0FGRCxFQUVHLEtBRkgsQ0FFUyxZQUFXO0FBQ2hCO0FBQ0Esb0JBQVEsS0FBUjtBQUNILFNBTEQ7QUFNSCxLQVBNLENBQVA7QUFRSDs7QUFFRDs7OztBQUlPLFNBQVMsVUFBVCxDQUFvQixHQUFwQixFQUF5QjtBQUM1QixXQUFPLENBQUMsRUFBRSxPQUFPLElBQUksV0FBWCxJQUEwQixJQUFJLElBQTlCLElBQXNDLElBQUksS0FBNUMsQ0FBUjtBQUNIOztBQUVEOzs7QUFHTyxTQUFTLFVBQVQsQ0FBb0IsT0FBcEIsRUFBNkIsT0FBN0IsRUFBc0M7QUFDekMsUUFBSSxDQUFDLE9BQUwsRUFBYztBQUNWLGNBQU0sSUFBSSxLQUFKLENBQVUsT0FBVixDQUFOO0FBQ0g7QUFDSjs7QUFFTSxTQUFTLGVBQVQsR0FBMEI7QUFDN0IsV0FBTyxVQUFVLFNBQVYsQ0FBb0IsT0FBcEIsQ0FBNEIsUUFBNUIsTUFBMEMsQ0FBQyxDQUFsRDtBQUNIOztBQUVNLFNBQVMsdUJBQVQsR0FBa0M7QUFDckMsUUFBSSxZQUFZLFVBQVUsU0FBMUI7QUFDQSxRQUFJLGdCQUFnQixVQUFVLFNBQVYsQ0FBb0IsVUFBVSxPQUFWLENBQWtCLFFBQWxCLElBQTRCLENBQWhELENBQXBCO0FBQ0EsUUFBSSxhQUFKLEVBQW1CO0FBQ2YsZUFBTyxXQUFXLGFBQVgsQ0FBUDtBQUNILEtBRkQsTUFFTztBQUNILGVBQU8sQ0FBQyxDQUFSO0FBQ0g7QUFDSjs7QUFFTSxTQUFTLGNBQVQsQ0FBd0IsR0FBeEIsRUFBNkI7QUFDaEM7QUFDQSxRQUFJLFVBQVUsb0JBQWQ7O0FBRUE7QUFDQSxXQUFPLElBQUksT0FBSixDQUFZLE9BQVosRUFBcUIsc0JBQXJCLENBQVA7QUFDSDs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN0UUQ7O0FBQ0E7Ozs7SUFFcUIsMkI7QUFDakIseUNBQVksTUFBWixFQUFvQixZQUFwQixFQUFrQyxVQUFsQyxFQUE4QztBQUFBOztBQUMxQyxhQUFLLE9BQUwsR0FBZSxNQUFmO0FBQ0EsYUFBSyxhQUFMLEdBQXFCLFlBQXJCO0FBQ0EsYUFBSyxXQUFMLEdBQW1CLFVBQW5CO0FBQ0EsYUFBSyxrQ0FBTDtBQUNIOzs7OzZEQUVvQztBQUFBOztBQUNqQyxpQkFBSyxXQUFMLENBQWlCLGVBQWpCLENBQWlDLENBQUMsOEJBQUQsQ0FBakM7QUFDQSxpQkFBSyxZQUFMLEdBQW9CLEtBQUssV0FBTCxDQUFpQixTQUFqQixDQUEyQiw4QkFBM0IsRUFBZ0Qsa0JBQU0sSUFBTixFQUFZLEtBQUssMEJBQWpCLENBQWhELENBQXBCO0FBQ0EsdUJBQVcsWUFBTTtBQUNiLHNCQUFLLE9BQUw7QUFDSCxhQUZELEVBRUcsQ0FGSDtBQUdIOzs7bURBRTBCLEssRUFBTztBQUM5QixnQkFBSSxnQkFBSjtBQUNBLGdCQUFJLE1BQU0sT0FBVixFQUFtQjtBQUNmLDBCQUFVLEtBQUssS0FBTCxDQUFXLE1BQU0sT0FBakIsQ0FBVjtBQUNIO0FBQ0QsZ0JBQUksS0FBSyxVQUFMLElBQW1CLE9BQW5CLElBQThCLEtBQUssYUFBTCxLQUF1QixRQUFRLFlBQWpFLEVBQStFO0FBQzNFLHFCQUFLLFVBQUwsQ0FBZ0IsRUFBQyxNQUFNLEtBQUssU0FBTCxDQUFlLFFBQVEsVUFBdkIsQ0FBUCxFQUFoQjtBQUNIO0FBQ0o7Ozs2QkFVSSxnQixFQUFrQjtBQUNuQixnQkFBTSxVQUFVLEVBQWhCO0FBQ0EsZ0JBQUk7QUFDQSx3QkFBUSxLQUFSLEdBQWdCLDhCQUFoQjtBQUNBLHdCQUFRLFlBQVIsR0FBdUIsS0FBSyxhQUE1QjtBQUNBLHdCQUFRLFVBQVIsR0FBcUIsS0FBSyxLQUFMLENBQVcsZ0JBQVgsQ0FBckI7QUFDQSxxQkFBSyxXQUFMLENBQWlCLFdBQWpCLENBQTZCLE9BQTdCO0FBQ0gsYUFMRCxDQUtFLE9BQU8sS0FBUCxFQUFjO0FBQ1oscUJBQUssT0FBTCxDQUFhLEtBQWIsQ0FBbUIsdUJBQW5CLEVBQTRDLEtBQTVDO0FBQ0g7QUFDSjs7O2dDQUVPO0FBQ0osaUJBQUssT0FBTCxDQUFhLElBQWIsQ0FBa0IsNEJBQWxCO0FBQ0EsaUJBQUssWUFBTDtBQUNIOzs7MEJBdkJhLFEsRUFBVTtBQUNwQixpQkFBSyxVQUFMLEdBQWtCLFFBQWxCO0FBQ0g7OzswQkFFVSxRLEVBQVU7QUFDakIsaUJBQUssT0FBTCxHQUFlLFFBQWY7QUFDSDs7Ozs7a0JBaENnQiwyQiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQnkgdXNpbmcgdGhlc2UgRGV2ZWxvcGVyIE1hdGVyaWFscywgeW91IGFjY2VwdCBhbmQgYWdyZWUgdG8gY29tcGx5IHdpdGhcclxuLy8gdGhlIHRlcm1zIG9mIHRoZSBDbG91ZCBTb2Z0d2FyZSBHcm91cCBEZXZlbG9wZXIgVGVybXMgb2YgVXNlIGZvdW5kIGhlcmVcclxuLy8gKGh0dHBzOi8vd3d3LmNsb3VkLmNvbS9sZWdhbClcclxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHJcblxyXG52YXIgJGpzY29tcD17c2NvcGU6e30sZ2V0R2xvYmFsOmZ1bmN0aW9uKGUpe3JldHVyblwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdz09PWU/ZTpcInVuZGVmaW5lZFwiIT10eXBlb2YgZ2xvYmFsP2dsb2JhbDplfX07JGpzY29tcC5nbG9iYWw9JGpzY29tcC5nZXRHbG9iYWwodGhpcyk7JGpzY29tcC5pbml0U3ltYm9sPWZ1bmN0aW9uKCl7JGpzY29tcC5nbG9iYWwuU3ltYm9sfHwoJGpzY29tcC5nbG9iYWwuU3ltYm9sPSRqc2NvbXAuU3ltYm9sKTskanNjb21wLmluaXRTeW1ib2w9ZnVuY3Rpb24oKXt9fTskanNjb21wLnN5bWJvbENvdW50ZXJfPTA7JGpzY29tcC5TeW1ib2w9ZnVuY3Rpb24oZSl7cmV0dXJuXCJqc2NvbXBfc3ltYm9sX1wiK2UrJGpzY29tcC5zeW1ib2xDb3VudGVyXysrfTtcclxuJGpzY29tcC5pbml0U3ltYm9sSXRlcmF0b3I9ZnVuY3Rpb24oKXskanNjb21wLmluaXRTeW1ib2woKTskanNjb21wLmdsb2JhbC5TeW1ib2wuaXRlcmF0b3J8fCgkanNjb21wLmdsb2JhbC5TeW1ib2wuaXRlcmF0b3I9JGpzY29tcC5nbG9iYWwuU3ltYm9sKFwiaXRlcmF0b3JcIikpOyRqc2NvbXAuaW5pdFN5bWJvbEl0ZXJhdG9yPWZ1bmN0aW9uKCl7fX07JGpzY29tcC5tYWtlSXRlcmF0b3I9ZnVuY3Rpb24oZSl7JGpzY29tcC5pbml0U3ltYm9sSXRlcmF0b3IoKTtpZihlWyRqc2NvbXAuZ2xvYmFsLlN5bWJvbC5pdGVyYXRvcl0pcmV0dXJuIGVbJGpzY29tcC5nbG9iYWwuU3ltYm9sLml0ZXJhdG9yXSgpO3ZhciBsPTA7cmV0dXJue25leHQ6ZnVuY3Rpb24oKXtyZXR1cm4gbD09ZS5sZW5ndGg/e2RvbmU6ITB9Ontkb25lOiExLHZhbHVlOmVbbCsrXX19fX07XHJcbiRqc2NvbXAuYXJyYXlGcm9tSXRlcmF0b3I9ZnVuY3Rpb24oZSl7Zm9yKHZhciBsLHA9W107IShsPWUubmV4dCgpKS5kb25lOylwLnB1c2gobC52YWx1ZSk7cmV0dXJuIHB9OyRqc2NvbXAuYXJyYXlGcm9tSXRlcmFibGU9ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBBcnJheT9lOiRqc2NvbXAuYXJyYXlGcm9tSXRlcmF0b3IoJGpzY29tcC5tYWtlSXRlcmF0b3IoZSkpfTtcclxuJGpzY29tcC5pbmhlcml0cz1mdW5jdGlvbihlLGwpe2Z1bmN0aW9uIHAoKXt9cC5wcm90b3R5cGU9bC5wcm90b3R5cGU7ZS5wcm90b3R5cGU9bmV3IHA7ZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZTtmb3IodmFyIGIgaW4gbClpZigkanNjb21wLmdsb2JhbC5PYmplY3QuZGVmaW5lUHJvcGVydGllcyl7dmFyIGE9JGpzY29tcC5nbG9iYWwuT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihsLGIpO2EmJiRqc2NvbXAuZ2xvYmFsLk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLGIsYSl9ZWxzZSBlW2JdPWxbYl19OyRqc2NvbXAuYXJyYXk9JGpzY29tcC5hcnJheXx8e307JGpzY29tcC5hcnJheS5kb25lXz1mdW5jdGlvbigpe3JldHVybntkb25lOiEwLHZhbHVlOnZvaWQgMH19O1xyXG4kanNjb21wLmFycmF5LmFycmF5SXRlcmF0b3JfPWZ1bmN0aW9uKGUsbCl7ZSBpbnN0YW5jZW9mIFN0cmluZyYmKGU9U3RyaW5nKGUpKTt2YXIgcD0wOyRqc2NvbXAuaW5pdFN5bWJvbCgpOyRqc2NvbXAuaW5pdFN5bWJvbEl0ZXJhdG9yKCk7dmFyIGI9e30sYT0oYi5uZXh0PWZ1bmN0aW9uKCl7aWYocDxlLmxlbmd0aCl7dmFyIGI9cCsrO3JldHVybnt2YWx1ZTpsKGIsZVtiXSksZG9uZTohMX19YS5uZXh0PSRqc2NvbXAuYXJyYXkuZG9uZV87cmV0dXJuICRqc2NvbXAuYXJyYXkuZG9uZV8oKX0sYltTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIGF9LGIpO3JldHVybiBhfTtcclxuJGpzY29tcC5hcnJheS5maW5kSW50ZXJuYWxfPWZ1bmN0aW9uKGUsbCxwKXtlIGluc3RhbmNlb2YgU3RyaW5nJiYoZT1TdHJpbmcoZSkpO2Zvcih2YXIgYj1lLmxlbmd0aCxhPTA7YTxiO2ErKyl7dmFyIGM9ZVthXTtpZihsLmNhbGwocCxjLGEsZSkpcmV0dXJue2k6YSx2OmN9fXJldHVybntpOi0xLHY6dm9pZCAwfX07XHJcbiRqc2NvbXAuYXJyYXkuZnJvbT1mdW5jdGlvbihlLGwscCl7bD12b2lkIDA9PT1sP2Z1bmN0aW9uKGEpe3JldHVybiBhfTpsO3ZhciBiPVtdOyRqc2NvbXAuaW5pdFN5bWJvbCgpOyRqc2NvbXAuaW5pdFN5bWJvbEl0ZXJhdG9yKCk7aWYoZVtTeW1ib2wuaXRlcmF0b3JdKXskanNjb21wLmluaXRTeW1ib2woKTskanNjb21wLmluaXRTeW1ib2xJdGVyYXRvcigpO2U9ZVtTeW1ib2wuaXRlcmF0b3JdKCk7Zm9yKHZhciBhOyEoYT1lLm5leHQoKSkuZG9uZTspYi5wdXNoKGwuY2FsbChwLGEudmFsdWUpKX1lbHNle2E9ZS5sZW5ndGg7Zm9yKHZhciBjPTA7YzxhO2MrKyliLnB1c2gobC5jYWxsKHAsZVtjXSkpfXJldHVybiBifTskanNjb21wLmFycmF5Lm9mPWZ1bmN0aW9uKGUpe2Zvcih2YXIgbD1bXSxwPTA7cDxhcmd1bWVudHMubGVuZ3RoOysrcClsW3AtMF09YXJndW1lbnRzW3BdO3JldHVybiAkanNjb21wLmFycmF5LmZyb20obCl9O1xyXG4kanNjb21wLmFycmF5LmVudHJpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gJGpzY29tcC5hcnJheS5hcnJheUl0ZXJhdG9yXyh0aGlzLGZ1bmN0aW9uKGUsbCl7cmV0dXJuW2UsbF19KX07JGpzY29tcC5hcnJheS5lbnRyaWVzJGluc3RhbGw9ZnVuY3Rpb24oKXtBcnJheS5wcm90b3R5cGUuZW50cmllc3x8KEFycmF5LnByb3RvdHlwZS5lbnRyaWVzPSRqc2NvbXAuYXJyYXkuZW50cmllcyl9OyRqc2NvbXAuYXJyYXkua2V5cz1mdW5jdGlvbigpe3JldHVybiAkanNjb21wLmFycmF5LmFycmF5SXRlcmF0b3JfKHRoaXMsZnVuY3Rpb24oZSl7cmV0dXJuIGV9KX07JGpzY29tcC5hcnJheS5rZXlzJGluc3RhbGw9ZnVuY3Rpb24oKXtBcnJheS5wcm90b3R5cGUua2V5c3x8KEFycmF5LnByb3RvdHlwZS5rZXlzPSRqc2NvbXAuYXJyYXkua2V5cyl9OyRqc2NvbXAuYXJyYXkudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuICRqc2NvbXAuYXJyYXkuYXJyYXlJdGVyYXRvcl8odGhpcyxmdW5jdGlvbihlLGwpe3JldHVybiBsfSl9O1xyXG4kanNjb21wLmFycmF5LnZhbHVlcyRpbnN0YWxsPWZ1bmN0aW9uKCl7QXJyYXkucHJvdG90eXBlLnZhbHVlc3x8KEFycmF5LnByb3RvdHlwZS52YWx1ZXM9JGpzY29tcC5hcnJheS52YWx1ZXMpfTskanNjb21wLmFycmF5LmNvcHlXaXRoaW49ZnVuY3Rpb24oZSxsLHApe3ZhciBiPXRoaXMubGVuZ3RoO2U9TnVtYmVyKGUpO2w9TnVtYmVyKGwpO3A9TnVtYmVyKG51bGwhPXA/cDpiKTtpZihlPGwpZm9yKHA9TWF0aC5taW4ocCxiKTtsPHA7KWwgaW4gdGhpcz90aGlzW2UrK109dGhpc1tsKytdOihkZWxldGUgdGhpc1tlKytdLGwrKyk7ZWxzZSBmb3IocD1NYXRoLm1pbihwLGIrbC1lKSxlKz1wLWw7cD5sOyktLXAgaW4gdGhpcz90aGlzWy0tZV09dGhpc1twXTpkZWxldGUgdGhpc1tlXTtyZXR1cm4gdGhpc307JGpzY29tcC5hcnJheS5jb3B5V2l0aGluJGluc3RhbGw9ZnVuY3Rpb24oKXtBcnJheS5wcm90b3R5cGUuY29weVdpdGhpbnx8KEFycmF5LnByb3RvdHlwZS5jb3B5V2l0aGluPSRqc2NvbXAuYXJyYXkuY29weVdpdGhpbil9O1xyXG4kanNjb21wLmFycmF5LmZpbGw9ZnVuY3Rpb24oZSxsLHApe251bGwhPXAmJmUubGVuZ3RofHwocD10aGlzLmxlbmd0aHx8MCk7cD1OdW1iZXIocCk7Zm9yKGw9TnVtYmVyKCh2b2lkIDA9PT1sPzA6bCl8fDApO2w8cDtsKyspdGhpc1tsXT1lO3JldHVybiB0aGlzfTskanNjb21wLmFycmF5LmZpbGwkaW5zdGFsbD1mdW5jdGlvbigpe0FycmF5LnByb3RvdHlwZS5maWxsfHwoQXJyYXkucHJvdG90eXBlLmZpbGw9JGpzY29tcC5hcnJheS5maWxsKX07JGpzY29tcC5hcnJheS5maW5kPWZ1bmN0aW9uKGUsbCl7cmV0dXJuICRqc2NvbXAuYXJyYXkuZmluZEludGVybmFsXyh0aGlzLGUsbCkudn07JGpzY29tcC5hcnJheS5maW5kJGluc3RhbGw9ZnVuY3Rpb24oKXtBcnJheS5wcm90b3R5cGUuZmluZHx8KEFycmF5LnByb3RvdHlwZS5maW5kPSRqc2NvbXAuYXJyYXkuZmluZCl9O1xyXG4kanNjb21wLmFycmF5LmZpbmRJbmRleD1mdW5jdGlvbihlLGwpe3JldHVybiAkanNjb21wLmFycmF5LmZpbmRJbnRlcm5hbF8odGhpcyxlLGwpLml9OyRqc2NvbXAuYXJyYXkuZmluZEluZGV4JGluc3RhbGw9ZnVuY3Rpb24oKXtBcnJheS5wcm90b3R5cGUuZmluZEluZGV4fHwoQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleD0kanNjb21wLmFycmF5LmZpbmRJbmRleCl9OyRqc2NvbXAuTWFwPWZ1bmN0aW9uKGUpe2U9dm9pZCAwPT09ZT9bXTplO3RoaXMuZGF0YV89e307dGhpcy5oZWFkXz0kanNjb21wLk1hcC5jcmVhdGVIZWFkXygpO3RoaXMuc2l6ZT0wO2lmKGUpe2U9JGpzY29tcC5tYWtlSXRlcmF0b3IoZSk7Zm9yKHZhciBsPWUubmV4dCgpOyFsLmRvbmU7bD1lLm5leHQoKSlsPWwudmFsdWUsdGhpcy5zZXQobFswXSxsWzFdKX19O1xyXG4kanNjb21wLk1hcC5jaGVja0Jyb3dzZXJDb25mb3JtYW5jZV89ZnVuY3Rpb24oKXt2YXIgZT0kanNjb21wLmdsb2JhbC5NYXA7aWYoIWV8fCFlLnByb3RvdHlwZS5lbnRyaWVzfHwhT2JqZWN0LnNlYWwpcmV0dXJuITE7dHJ5e3ZhciBsPU9iamVjdC5zZWFsKHt4OjR9KSxwPW5ldyBlKCRqc2NvbXAubWFrZUl0ZXJhdG9yKFtbbCxcInNcIl1dKSk7aWYoXCJzXCIhPXAuZ2V0KGwpfHwxIT1wLnNpemV8fHAuZ2V0KHt4OjR9KXx8cC5zZXQoe3g6NH0sXCJ0XCIpIT1wfHwyIT1wLnNpemUpcmV0dXJuITE7dmFyIGI9cC5lbnRyaWVzKCksYT1iLm5leHQoKTtpZihhLmRvbmV8fGEudmFsdWVbMF0hPWx8fFwic1wiIT1hLnZhbHVlWzFdKXJldHVybiExO2E9Yi5uZXh0KCk7cmV0dXJuIGEuZG9uZXx8NCE9YS52YWx1ZVswXS54fHxcInRcIiE9YS52YWx1ZVsxXXx8IWIubmV4dCgpLmRvbmU/ITE6ITB9Y2F0Y2goYyl7cmV0dXJuITF9fTtcclxuJGpzY29tcC5NYXAuY3JlYXRlSGVhZF89ZnVuY3Rpb24oKXt2YXIgZT17fTtyZXR1cm4gZS5wcmV2aW91cz1lLm5leHQ9ZS5oZWFkPWV9OyRqc2NvbXAuTWFwLmdldElkXz1mdW5jdGlvbihlKXtpZighKGUgaW5zdGFuY2VvZiBPYmplY3QpKXJldHVybiBTdHJpbmcoZSk7JGpzY29tcC5NYXAua2V5XyBpbiBlfHxlIGluc3RhbmNlb2YgT2JqZWN0JiZPYmplY3QuaXNFeHRlbnNpYmxlJiZPYmplY3QuaXNFeHRlbnNpYmxlKGUpJiYkanNjb21wLk1hcC5kZWZpbmVQcm9wZXJ0eV8oZSwkanNjb21wLk1hcC5rZXlfLCsrJGpzY29tcC5NYXAuaW5kZXhfKTtyZXR1cm4gJGpzY29tcC5NYXAua2V5XyBpbiBlP2VbJGpzY29tcC5NYXAua2V5X106XCIgXCIrZX07XHJcbiRqc2NvbXAuTWFwLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24oZSxsKXt2YXIgcD10aGlzLm1heWJlR2V0RW50cnlfKGUpLGI9cC5pZCxhPXAubGlzdCxwPXAuZW50cnk7YXx8KGE9dGhpcy5kYXRhX1tiXT1bXSk7cD9wLnZhbHVlPWw6KHA9e25leHQ6dGhpcy5oZWFkXyxwcmV2aW91czp0aGlzLmhlYWRfLnByZXZpb3VzLGhlYWQ6dGhpcy5oZWFkXyxrZXk6ZSx2YWx1ZTpsfSxhLnB1c2gocCksdGhpcy5oZWFkXy5wcmV2aW91cy5uZXh0PXAsdGhpcy5oZWFkXy5wcmV2aW91cz1wLHRoaXMuc2l6ZSsrKTtyZXR1cm4gdGhpc307XHJcbiRqc2NvbXAuTWFwLnByb3RvdHlwZVtcImRlbGV0ZVwiXT1mdW5jdGlvbihlKXt2YXIgbD10aGlzLm1heWJlR2V0RW50cnlfKGUpO2U9bC5pZDt2YXIgcD1sLmxpc3QsYj1sLmluZGV4O3JldHVybihsPWwuZW50cnkpJiZwPyhwLnNwbGljZShiLDEpLHAubGVuZ3RofHxkZWxldGUgdGhpcy5kYXRhX1tlXSxsLnByZXZpb3VzLm5leHQ9bC5uZXh0LGwubmV4dC5wcmV2aW91cz1sLnByZXZpb3VzLGwuaGVhZD1udWxsLHRoaXMuc2l6ZS0tLCEwKTohMX07JGpzY29tcC5NYXAucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5kYXRhXz17fTt0aGlzLmhlYWRfPXRoaXMuaGVhZF8ucHJldmlvdXM9JGpzY29tcC5NYXAuY3JlYXRlSGVhZF8oKTt0aGlzLnNpemU9MH07JGpzY29tcC5NYXAucHJvdG90eXBlLmhhcz1mdW5jdGlvbihlKXtyZXR1cm4hIXRoaXMubWF5YmVHZXRFbnRyeV8oZSkuZW50cnl9O1xyXG4kanNjb21wLk1hcC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGUpe3JldHVybihlPXRoaXMubWF5YmVHZXRFbnRyeV8oZSkuZW50cnkpJiZlLnZhbHVlfTskanNjb21wLk1hcC5wcm90b3R5cGUubWF5YmVHZXRFbnRyeV89ZnVuY3Rpb24oZSl7dmFyIGw9JGpzY29tcC5NYXAuZ2V0SWRfKGUpLHA9dGhpcy5kYXRhX1tsXTtpZihwKWZvcih2YXIgYj0wO2I8cC5sZW5ndGg7YisrKXt2YXIgYT1wW2JdO2lmKGUhPT1lJiZhLmtleSE9PWEua2V5fHxlPT09YS5rZXkpcmV0dXJue2lkOmwsbGlzdDpwLGluZGV4OmIsZW50cnk6YX19cmV0dXJue2lkOmwsbGlzdDpwLGluZGV4Oi0xLGVudHJ5OnZvaWQgMH19OyRqc2NvbXAuTWFwLnByb3RvdHlwZS5lbnRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlcl8oZnVuY3Rpb24oZSl7cmV0dXJuW2Uua2V5LGUudmFsdWVdfSl9OyRqc2NvbXAuTWFwLnByb3RvdHlwZS5rZXlzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlcl8oZnVuY3Rpb24oZSl7cmV0dXJuIGUua2V5fSl9O1xyXG4kanNjb21wLk1hcC5wcm90b3R5cGUudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlcl8oZnVuY3Rpb24oZSl7cmV0dXJuIGUudmFsdWV9KX07JGpzY29tcC5NYXAucHJvdG90eXBlLmZvckVhY2g9ZnVuY3Rpb24oZSxsKXtmb3IodmFyIHA9JGpzY29tcC5tYWtlSXRlcmF0b3IodGhpcy5lbnRyaWVzKCkpLGI9cC5uZXh0KCk7IWIuZG9uZTtiPXAubmV4dCgpKWI9Yi52YWx1ZSxlLmNhbGwobCxiWzFdLGJbMF0sdGhpcyl9O1xyXG4kanNjb21wLk1hcC5wcm90b3R5cGUuaXRlcl89ZnVuY3Rpb24oZSl7dmFyIGw9dGhpcyxwPXRoaXMuaGVhZF87JGpzY29tcC5pbml0U3ltYm9sKCk7JGpzY29tcC5pbml0U3ltYm9sSXRlcmF0b3IoKTt2YXIgYj17fTtyZXR1cm4gYi5uZXh0PWZ1bmN0aW9uKCl7aWYocCl7Zm9yKDtwLmhlYWQhPWwuaGVhZF87KXA9cC5wcmV2aW91cztmb3IoO3AubmV4dCE9cC5oZWFkOylyZXR1cm4gcD1wLm5leHQse2RvbmU6ITEsdmFsdWU6ZShwKX07cD1udWxsfXJldHVybntkb25lOiEwLHZhbHVlOnZvaWQgMH19LGJbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSxifTskanNjb21wLk1hcC5pbmRleF89MDskanNjb21wLk1hcC5kZWZpbmVQcm9wZXJ0eV89T2JqZWN0LmRlZmluZVByb3BlcnR5P2Z1bmN0aW9uKGUsbCxwKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxsLHt2YWx1ZTpTdHJpbmcocCl9KX06ZnVuY3Rpb24oZSxsLHApe2VbbF09U3RyaW5nKHApfTtcclxuJGpzY29tcC5NYXAuRW50cnlfPWZ1bmN0aW9uKCl7fTskanNjb21wLk1hcC5BU1NVTUVfTk9fTkFUSVZFPSExOyRqc2NvbXAuTWFwJGluc3RhbGw9ZnVuY3Rpb24oKXskanNjb21wLmluaXRTeW1ib2woKTskanNjb21wLmluaXRTeW1ib2xJdGVyYXRvcigpOyEkanNjb21wLk1hcC5BU1NVTUVfTk9fTkFUSVZFJiYkanNjb21wLk1hcC5jaGVja0Jyb3dzZXJDb25mb3JtYW5jZV8oKT8kanNjb21wLk1hcD0kanNjb21wLmdsb2JhbC5NYXA6KCRqc2NvbXAuaW5pdFN5bWJvbCgpLCRqc2NvbXAuaW5pdFN5bWJvbEl0ZXJhdG9yKCksJGpzY29tcC5NYXAucHJvdG90eXBlW1N5bWJvbC5pdGVyYXRvcl09JGpzY29tcC5NYXAucHJvdG90eXBlLmVudHJpZXMsJGpzY29tcC5pbml0U3ltYm9sKCksJGpzY29tcC5NYXAua2V5Xz1TeW1ib2woXCJtYXAtaWQta2V5XCIpKTskanNjb21wLk1hcCRpbnN0YWxsPWZ1bmN0aW9uKCl7fX07JGpzY29tcC5tYXRoPSRqc2NvbXAubWF0aHx8e307XHJcbiRqc2NvbXAubWF0aC5jbHozMj1mdW5jdGlvbihlKXtlPU51bWJlcihlKT4+PjA7aWYoMD09PWUpcmV0dXJuIDMyO3ZhciBsPTA7MD09PShlJjQyOTQ5MDE3NjApJiYoZTw8PTE2LGwrPTE2KTswPT09KGUmNDI3ODE5MDA4MCkmJihlPDw9OCxsKz04KTswPT09KGUmNDAyNjUzMTg0MCkmJihlPDw9NCxsKz00KTswPT09KGUmMzIyMTIyNTQ3MikmJihlPDw9MixsKz0yKTswPT09KGUmMjE0NzQ4MzY0OCkmJmwrKztyZXR1cm4gbH07JGpzY29tcC5tYXRoLmltdWw9ZnVuY3Rpb24oZSxsKXtlPU51bWJlcihlKTtsPU51bWJlcihsKTt2YXIgcD1lJjY1NTM1LGI9bCY2NTUzNTtyZXR1cm4gcCpiKygoZT4+PjE2JjY1NTM1KSpiK3AqKGw+Pj4xNiY2NTUzNSk8PDE2Pj4+MCl8MH07JGpzY29tcC5tYXRoLnNpZ249ZnVuY3Rpb24oZSl7ZT1OdW1iZXIoZSk7cmV0dXJuIDA9PT1lfHxpc05hTihlKT9lOjA8ZT8xOi0xfTtcclxuJGpzY29tcC5tYXRoLmxvZzEwPWZ1bmN0aW9uKGUpe3JldHVybiBNYXRoLmxvZyhlKS9NYXRoLkxOMTB9OyRqc2NvbXAubWF0aC5sb2cyPWZ1bmN0aW9uKGUpe3JldHVybiBNYXRoLmxvZyhlKS9NYXRoLkxOMn07JGpzY29tcC5tYXRoLmxvZzFwPWZ1bmN0aW9uKGUpe2U9TnVtYmVyKGUpO2lmKC4yNT5lJiYtLjI1PGUpe2Zvcih2YXIgbD1lLHA9MSxiPWUsYT0wLGM9MTthIT1iOylsKj1lLGMqPS0xLGI9KGE9YikrYypsLysrcDtyZXR1cm4gYn1yZXR1cm4gTWF0aC5sb2coMStlKX07JGpzY29tcC5tYXRoLmV4cG0xPWZ1bmN0aW9uKGUpe2U9TnVtYmVyKGUpO2lmKC4yNT5lJiYtLjI1PGUpe2Zvcih2YXIgbD1lLHA9MSxiPWUsYT0wO2EhPWI7KWwqPWUvKytwLGI9KGE9YikrbDtyZXR1cm4gYn1yZXR1cm4gTWF0aC5leHAoZSktMX07JGpzY29tcC5tYXRoLmNvc2g9ZnVuY3Rpb24oZSl7ZT1OdW1iZXIoZSk7cmV0dXJuKE1hdGguZXhwKGUpK01hdGguZXhwKC1lKSkvMn07XHJcbiRqc2NvbXAubWF0aC5zaW5oPWZ1bmN0aW9uKGUpe2U9TnVtYmVyKGUpO3JldHVybiAwPT09ZT9lOihNYXRoLmV4cChlKS1NYXRoLmV4cCgtZSkpLzJ9OyRqc2NvbXAubWF0aC50YW5oPWZ1bmN0aW9uKGUpe2U9TnVtYmVyKGUpO2lmKDA9PT1lKXJldHVybiBlO3ZhciBsPU1hdGguZXhwKDIqLU1hdGguYWJzKGUpKSxsPSgxLWwpLygxK2wpO3JldHVybiAwPmU/LWw6bH07JGpzY29tcC5tYXRoLmFjb3NoPWZ1bmN0aW9uKGUpe2U9TnVtYmVyKGUpO3JldHVybiBNYXRoLmxvZyhlK01hdGguc3FydChlKmUtMSkpfTskanNjb21wLm1hdGguYXNpbmg9ZnVuY3Rpb24oZSl7ZT1OdW1iZXIoZSk7aWYoMD09PWUpcmV0dXJuIGU7dmFyIGw9TWF0aC5sb2coTWF0aC5hYnMoZSkrTWF0aC5zcXJ0KGUqZSsxKSk7cmV0dXJuIDA+ZT8tbDpsfTtcclxuJGpzY29tcC5tYXRoLmF0YW5oPWZ1bmN0aW9uKGUpe2U9TnVtYmVyKGUpO3JldHVybigkanNjb21wLm1hdGgubG9nMXAoZSktJGpzY29tcC5tYXRoLmxvZzFwKC1lKSkvMn07XHJcbiRqc2NvbXAubWF0aC5oeXBvdD1mdW5jdGlvbihlLGwscCl7Zm9yKHZhciBiPVtdLGE9MjthPGFyZ3VtZW50cy5sZW5ndGg7KythKWJbYS0yXT1hcmd1bWVudHNbYV07ZT1OdW1iZXIoZSk7bD1OdW1iZXIobCk7Zm9yKHZhciBjPU1hdGgubWF4KE1hdGguYWJzKGUpLE1hdGguYWJzKGwpKSxRPSRqc2NvbXAubWFrZUl0ZXJhdG9yKGIpLGE9US5uZXh0KCk7IWEuZG9uZTthPVEubmV4dCgpKWM9TWF0aC5tYXgoYyxNYXRoLmFicyhhLnZhbHVlKSk7aWYoMUUxMDA8Y3x8MUUtMTAwPmMpe2UvPWM7bC89YztRPWUqZStsKmw7Yj0kanNjb21wLm1ha2VJdGVyYXRvcihiKTtmb3IoYT1iLm5leHQoKTshYS5kb25lO2E9Yi5uZXh0KCkpYT1hLnZhbHVlLGE9TnVtYmVyKGEpL2MsUSs9YSphO3JldHVybiBNYXRoLnNxcnQoUSkqY31jPWUqZStsKmw7Yj0kanNjb21wLm1ha2VJdGVyYXRvcihiKTtmb3IoYT1iLm5leHQoKTshYS5kb25lO2E9Yi5uZXh0KCkpYT1hLnZhbHVlLGE9TnVtYmVyKGEpLGMrPVxyXG5hKmE7cmV0dXJuIE1hdGguc3FydChjKX07JGpzY29tcC5tYXRoLnRydW5jPWZ1bmN0aW9uKGUpe2U9TnVtYmVyKGUpO2lmKGlzTmFOKGUpfHxJbmZpbml0eT09PWV8fC1JbmZpbml0eT09PWV8fDA9PT1lKXJldHVybiBlO3ZhciBsPU1hdGguZmxvb3IoTWF0aC5hYnMoZSkpO3JldHVybiAwPmU/LWw6bH07JGpzY29tcC5tYXRoLmNicnQ9ZnVuY3Rpb24oZSl7aWYoMD09PWUpcmV0dXJuIGU7ZT1OdW1iZXIoZSk7dmFyIGw9TWF0aC5wb3coTWF0aC5hYnMoZSksMS8zKTtyZXR1cm4gMD5lPy1sOmx9OyRqc2NvbXAubnVtYmVyPSRqc2NvbXAubnVtYmVyfHx7fTskanNjb21wLm51bWJlci5pc0Zpbml0ZT1mdW5jdGlvbihlKXtyZXR1cm5cIm51bWJlclwiIT09dHlwZW9mIGU/ITE6IWlzTmFOKGUpJiZJbmZpbml0eSE9PWUmJi1JbmZpbml0eSE9PWV9O1xyXG4kanNjb21wLm51bWJlci5pc0ludGVnZXI9ZnVuY3Rpb24oZSl7cmV0dXJuICRqc2NvbXAubnVtYmVyLmlzRmluaXRlKGUpP2U9PT1NYXRoLmZsb29yKGUpOiExfTskanNjb21wLm51bWJlci5pc05hTj1mdW5jdGlvbihlKXtyZXR1cm5cIm51bWJlclwiPT09dHlwZW9mIGUmJmlzTmFOKGUpfTskanNjb21wLm51bWJlci5pc1NhZmVJbnRlZ2VyPWZ1bmN0aW9uKGUpe3JldHVybiAkanNjb21wLm51bWJlci5pc0ludGVnZXIoZSkmJk1hdGguYWJzKGUpPD0kanNjb21wLm51bWJlci5NQVhfU0FGRV9JTlRFR0VSfTskanNjb21wLm51bWJlci5FUFNJTE9OPU1hdGgucG93KDIsLTUyKTskanNjb21wLm51bWJlci5NQVhfU0FGRV9JTlRFR0VSPTkwMDcxOTkyNTQ3NDA5OTE7JGpzY29tcC5udW1iZXIuTUlOX1NBRkVfSU5URUdFUj0tOTAwNzE5OTI1NDc0MDk5MTskanNjb21wLm9iamVjdD0kanNjb21wLm9iamVjdHx8e307XHJcbiRqc2NvbXAub2JqZWN0LmFzc2lnbj1mdW5jdGlvbihlLGwpe2Zvcih2YXIgcD1bXSxiPTE7Yjxhcmd1bWVudHMubGVuZ3RoOysrYilwW2ItMV09YXJndW1lbnRzW2JdO3A9JGpzY29tcC5tYWtlSXRlcmF0b3IocCk7Zm9yKGI9cC5uZXh0KCk7IWIuZG9uZTtiPXAubmV4dCgpKWlmKGI9Yi52YWx1ZSlmb3IodmFyIGEgaW4gYilPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYixhKSYmKGVbYV09YlthXSk7cmV0dXJuIGV9OyRqc2NvbXAub2JqZWN0LmlzPWZ1bmN0aW9uKGUsbCl7cmV0dXJuIGU9PT1sPzAhPT1lfHwxL2U9PT0xL2w6ZSE9PWUmJmwhPT1sfTskanNjb21wLlNldD1mdW5jdGlvbihlKXtlPXZvaWQgMD09PWU/W106ZTt0aGlzLm1hcF89bmV3ICRqc2NvbXAuTWFwO2lmKGUpe2U9JGpzY29tcC5tYWtlSXRlcmF0b3IoZSk7Zm9yKHZhciBsPWUubmV4dCgpOyFsLmRvbmU7bD1lLm5leHQoKSl0aGlzLmFkZChsLnZhbHVlKX10aGlzLnNpemU9dGhpcy5tYXBfLnNpemV9O1xyXG4kanNjb21wLlNldC5jaGVja0Jyb3dzZXJDb25mb3JtYW5jZV89ZnVuY3Rpb24oKXt2YXIgZT0kanNjb21wLmdsb2JhbC5TZXQ7aWYoIWV8fCFlLnByb3RvdHlwZS5lbnRyaWVzfHwhT2JqZWN0LnNlYWwpcmV0dXJuITE7dmFyIGw9T2JqZWN0LnNlYWwoe3g6NH0pLGU9bmV3IGUoJGpzY29tcC5tYWtlSXRlcmF0b3IoW2xdKSk7aWYoZS5oYXMobCl8fDEhPWUuc2l6ZXx8ZS5hZGQobCkhPWV8fDEhPWUuc2l6ZXx8ZS5hZGQoe3g6NH0pIT1lfHwyIT1lLnNpemUpcmV0dXJuITE7dmFyIGU9ZS5lbnRyaWVzKCkscD1lLm5leHQoKTtpZihwLmRvbmV8fHAudmFsdWVbMF0hPWx8fHAudmFsdWVbMV0hPWwpcmV0dXJuITE7cD1lLm5leHQoKTtyZXR1cm4gcC5kb25lfHxwLnZhbHVlWzBdPT1sfHw0IT1wLnZhbHVlWzBdLnh8fHAudmFsdWVbMV0hPXAudmFsdWVbMF0/ITE6ZS5uZXh0KCkuZG9uZX07XHJcbiRqc2NvbXAuU2V0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZSl7dGhpcy5tYXBfLnNldChlLGUpO3RoaXMuc2l6ZT10aGlzLm1hcF8uc2l6ZTtyZXR1cm4gdGhpc307JGpzY29tcC5TZXQucHJvdG90eXBlW1wiZGVsZXRlXCJdPWZ1bmN0aW9uKGUpe2U9dGhpcy5tYXBfW1wiZGVsZXRlXCJdKGUpO3RoaXMuc2l6ZT10aGlzLm1hcF8uc2l6ZTtyZXR1cm4gZX07JGpzY29tcC5TZXQucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5tYXBfLmNsZWFyKCk7dGhpcy5zaXplPTB9OyRqc2NvbXAuU2V0LnByb3RvdHlwZS5oYXM9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMubWFwXy5oYXMoZSl9OyRqc2NvbXAuU2V0LnByb3RvdHlwZS5lbnRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwXy5lbnRyaWVzKCl9OyRqc2NvbXAuU2V0LnByb3RvdHlwZS52YWx1ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXBfLnZhbHVlcygpfTtcclxuJGpzY29tcC5TZXQucHJvdG90eXBlLmZvckVhY2g9ZnVuY3Rpb24oZSxsKXt2YXIgcD10aGlzO3RoaXMubWFwXy5mb3JFYWNoKGZ1bmN0aW9uKGIpe3JldHVybiBlLmNhbGwobCxiLGIscCl9KX07JGpzY29tcC5TZXQuQVNTVU1FX05PX05BVElWRT0hMTskanNjb21wLlNldCRpbnN0YWxsPWZ1bmN0aW9uKCl7ISRqc2NvbXAuU2V0LkFTU1VNRV9OT19OQVRJVkUmJiRqc2NvbXAuU2V0LmNoZWNrQnJvd3NlckNvbmZvcm1hbmNlXygpPyRqc2NvbXAuU2V0PSRqc2NvbXAuZ2xvYmFsLlNldDooJGpzY29tcC5NYXAkaW5zdGFsbCgpLCRqc2NvbXAuaW5pdFN5bWJvbCgpLCRqc2NvbXAuaW5pdFN5bWJvbEl0ZXJhdG9yKCksJGpzY29tcC5TZXQucHJvdG90eXBlW1N5bWJvbC5pdGVyYXRvcl09JGpzY29tcC5TZXQucHJvdG90eXBlLnZhbHVlcyk7JGpzY29tcC5TZXQkaW5zdGFsbD1mdW5jdGlvbigpe319OyRqc2NvbXAuc3RyaW5nPSRqc2NvbXAuc3RyaW5nfHx7fTtcclxuJGpzY29tcC5zdHJpbmcubm9SZWdFeHBfPWZ1bmN0aW9uKGUsbCl7aWYoZSBpbnN0YW5jZW9mIFJlZ0V4cCl0aHJvdyBuZXcgVHlwZUVycm9yKFwiRmlyc3QgYXJndW1lbnQgdG8gU3RyaW5nLnByb3RvdHlwZS5cIitsK1wiIG11c3Qgbm90IGJlIGEgcmVndWxhciBleHByZXNzaW9uXCIpO307XHJcbiRqc2NvbXAuc3RyaW5nLmZyb21Db2RlUG9pbnQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciBsPVtdLHA9MDtwPGFyZ3VtZW50cy5sZW5ndGg7KytwKWxbcC0wXT1hcmd1bWVudHNbcF07Zm9yKHZhciBwPVwiXCIsbD0kanNjb21wLm1ha2VJdGVyYXRvcihsKSxiPWwubmV4dCgpOyFiLmRvbmU7Yj1sLm5leHQoKSl7Yj1iLnZhbHVlO2I9K2I7aWYoMD5ifHwxMTE0MTExPGJ8fGIhPT1NYXRoLmZsb29yKGIpKXRocm93IG5ldyBSYW5nZUVycm9yKFwiaW52YWxpZF9jb2RlX3BvaW50IFwiK2IpOzY1NTM1Pj1iP3ArPVN0cmluZy5mcm9tQ2hhckNvZGUoYik6KGItPTY1NTM2LHArPVN0cmluZy5mcm9tQ2hhckNvZGUoYj4+PjEwJjEwMjN8NTUyOTYpLHArPVN0cmluZy5mcm9tQ2hhckNvZGUoYiYxMDIzfDU2MzIwKSl9cmV0dXJuIHB9O1xyXG4kanNjb21wLnN0cmluZy5yZXBlYXQ9ZnVuY3Rpb24oZSl7dmFyIGw9dGhpcy50b1N0cmluZygpO2lmKDA+ZXx8MTM0MjE3NzI3OTxlKXRocm93IG5ldyBSYW5nZUVycm9yKFwiSW52YWxpZCBjb3VudCB2YWx1ZVwiKTtlfD0wO2Zvcih2YXIgcD1cIlwiO2U7KWlmKGUmMSYmKHArPWwpLGU+Pj49MSlsKz1sO3JldHVybiBwfTskanNjb21wLnN0cmluZy5yZXBlYXQkaW5zdGFsbD1mdW5jdGlvbigpe1N0cmluZy5wcm90b3R5cGUucmVwZWF0fHwoU3RyaW5nLnByb3RvdHlwZS5yZXBlYXQ9JGpzY29tcC5zdHJpbmcucmVwZWF0KX07XHJcbiRqc2NvbXAuc3RyaW5nLmNvZGVQb2ludEF0PWZ1bmN0aW9uKGUpe3ZhciBsPXRoaXMudG9TdHJpbmcoKSxwPWwubGVuZ3RoO2U9TnVtYmVyKGUpfHwwO2lmKDA8PWUmJmU8cCl7ZXw9MDt2YXIgYj1sLmNoYXJDb2RlQXQoZSk7aWYoNTUyOTY+Ynx8NTYzMTk8Ynx8ZSsxPT09cClyZXR1cm4gYjtlPWwuY2hhckNvZGVBdChlKzEpO3JldHVybiA1NjMyMD5lfHw1NzM0MzxlP2I6MTAyNCooYi01NTI5NikrZSs5MjE2fX07JGpzY29tcC5zdHJpbmcuY29kZVBvaW50QXQkaW5zdGFsbD1mdW5jdGlvbigpe1N0cmluZy5wcm90b3R5cGUuY29kZVBvaW50QXR8fChTdHJpbmcucHJvdG90eXBlLmNvZGVQb2ludEF0PSRqc2NvbXAuc3RyaW5nLmNvZGVQb2ludEF0KX07XHJcbiRqc2NvbXAuc3RyaW5nLmluY2x1ZGVzPWZ1bmN0aW9uKGUsbCl7bD12b2lkIDA9PT1sPzA6bDskanNjb21wLnN0cmluZy5ub1JlZ0V4cF8oZSxcImluY2x1ZGVzXCIpO3JldHVybi0xIT09dGhpcy50b1N0cmluZygpLmluZGV4T2YoZSxsKX07JGpzY29tcC5zdHJpbmcuaW5jbHVkZXMkaW5zdGFsbD1mdW5jdGlvbigpe1N0cmluZy5wcm90b3R5cGUuaW5jbHVkZXN8fChTdHJpbmcucHJvdG90eXBlLmluY2x1ZGVzPSRqc2NvbXAuc3RyaW5nLmluY2x1ZGVzKX07XHJcbiRqc2NvbXAuc3RyaW5nLnN0YXJ0c1dpdGg9ZnVuY3Rpb24oZSxsKXtsPXZvaWQgMD09PWw/MDpsOyRqc2NvbXAuc3RyaW5nLm5vUmVnRXhwXyhlLFwic3RhcnRzV2l0aFwiKTt2YXIgcD10aGlzLnRvU3RyaW5nKCk7ZSs9XCJcIjtmb3IodmFyIGI9cC5sZW5ndGgsYT1lLmxlbmd0aCxjPU1hdGgubWF4KDAsTWF0aC5taW4obHwwLHAubGVuZ3RoKSksUT0wO1E8YSYmYzxiOylpZihwW2MrK10hPWVbUSsrXSlyZXR1cm4hMTtyZXR1cm4gUT49YX07JGpzY29tcC5zdHJpbmcuc3RhcnRzV2l0aCRpbnN0YWxsPWZ1bmN0aW9uKCl7U3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRofHwoU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoPSRqc2NvbXAuc3RyaW5nLnN0YXJ0c1dpdGgpfTtcclxuJGpzY29tcC5zdHJpbmcuZW5kc1dpdGg9ZnVuY3Rpb24oZSxsKXskanNjb21wLnN0cmluZy5ub1JlZ0V4cF8oZSxcImVuZHNXaXRoXCIpO3ZhciBwPXRoaXMudG9TdHJpbmcoKTtlKz1cIlwiO3ZvaWQgMD09PWwmJihsPXAubGVuZ3RoKTtmb3IodmFyIGI9TWF0aC5tYXgoMCxNYXRoLm1pbihsfDAscC5sZW5ndGgpKSxhPWUubGVuZ3RoOzA8YSYmMDxiOylpZihwWy0tYl0hPWVbLS1hXSlyZXR1cm4hMTtyZXR1cm4gMD49YX07JGpzY29tcC5zdHJpbmcuZW5kc1dpdGgkaW5zdGFsbD1mdW5jdGlvbigpe1N0cmluZy5wcm90b3R5cGUuZW5kc1dpdGh8fChTdHJpbmcucHJvdG90eXBlLmVuZHNXaXRoPSRqc2NvbXAuc3RyaW5nLmVuZHNXaXRoKX07XHJcbihmdW5jdGlvbihlLGwpe1wib2JqZWN0XCI9PT10eXBlb2YgZXhwb3J0cyYmXCJvYmplY3RcIj09PXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9bCgpOlwiZnVuY3Rpb25cIj09PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtdLGwpOlwib2JqZWN0XCI9PT10eXBlb2YgZXhwb3J0cz9leHBvcnRzLkNpdHJpeFdlYlJUQz1sKCk6ZS5DaXRyaXhXZWJSVEM9bCgpfSkoc2VsZixmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbigpe2Z1bmN0aW9uIGUoYil7dmFyIGE9cFtiXTtpZih2b2lkIDAhPT1hKXJldHVybiBhLmV4cG9ydHM7YT1wW2JdPXtleHBvcnRzOnt9fTtsW2JdLmNhbGwoYS5leHBvcnRzLGEsYS5leHBvcnRzLGUpO3JldHVybiBhLmV4cG9ydHN9dmFyIGw9ezk0NTpmdW5jdGlvbihiLGEsYyl7dmFyIGU9dGhpcyYmdGhpcy5fX2V4dGVuZHN8fGZ1bmN0aW9uKCl7dmFyIGE9ZnVuY3Rpb24oayx2KXthPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mXHJcbkFycmF5JiZmdW5jdGlvbihhLGcpe2EuX19wcm90b19fPWd9fHxmdW5jdGlvbihhLGcpe2Zvcih2YXIgayBpbiBnKWcuaGFzT3duUHJvcGVydHkoaykmJihhW2tdPWdba10pfTtyZXR1cm4gYShrLHYpfTtyZXR1cm4gZnVuY3Rpb24oayx2KXtmdW5jdGlvbiBiKCl7dGhpcy5jb25zdHJ1Y3Rvcj1rfWEoayx2KTtrLnByb3RvdHlwZT1udWxsPT09dj9PYmplY3QuY3JlYXRlKHYpOihiLnByb3RvdHlwZT12LnByb3RvdHlwZSxuZXcgYil9fSgpO09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO2EuQXVkaW9FbGVtZW50PXZvaWQgMDt2YXIgdT1jKDY1OCksaD1jKDU1MCksZD1jKDg1MSksdz1jKDk0NikscTsoZnVuY3Rpb24oYSl7YS5Jbml0PVwiSW5pdFwiO2EuUGxheVN0YXJ0ZWQ9XCJQbGF5U3RhcnRlZFwiO2EuUGF1c2VDYWxsZWQ9XCJQYXVzZUNhbGxlZFwifSkocXx8KHE9e30pKTtiPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGsoKXt2YXIgaz1hLmNhbGwodGhpcyxcclxubnVsbCxoLmNsYXNzX2lkX3QuQXVkaW9FbGVtZW50LDAsdS5Qcm94eU1vZGUuTG9jYWwpfHx0aGlzO2suc2lua0lkXz1cIlwiO2suc3JjT2JqZWN0Xz1udWxsO2subG9vcF89ITE7ay5ub3RpU3RhdGU9cS5Jbml0O3JldHVybiBrfWUoayxhKTtrLnByb3RvdHlwZS5zZXRTaW5rSWQ9ZnVuY3Rpb24oYSl7dmFyIGs9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0U2lua0lkOiBzZXQgc2lua0lkIHRvIFwiK2EpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihnLGIpe2sud2FpdFVudGlsQ29ubmVjdGVkKFwiQXVkaW9FbGVtZW50LnNpbmtJZFwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGI9ay5yZW1vdGVJbnZva2UoITAsaC5tZXRob2RfaWRfQXVkaW9FbGVtZW50X3Quc2lua0lkLGEpO3cuZ2V0UmVkaXJlY3RvcigpLmdldEZlYXR1cmVWYWx1ZShoLkZFQVRVUkVfbXNfdGVhbXNfcHN0bil8fChrLnNpbmtJZF89YSxnKCkpO3JldHVybiBifSkudGhlbihmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyhrLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuc2V0U2lua0lkOiBzdWNjZXNzISByZXNvbHZpbmcuLi5cIik7ay5zaW5rSWRfPWE7ZygpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPWsubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zaW5rSWQgc2V0dGVyOiBmYWlsZWQgdG8gY29ubmVjdCFcIik7YihhKX0pfSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShrLnByb3RvdHlwZSxcInNpbmtJZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zaW5rSWRffSxzZXQ6ZnVuY3Rpb24oYSl7dGhpcy5zZXRTaW5rSWQoYSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGsucHJvdG90eXBlLFwic3JjT2JqZWN0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNyY09iamVjdF99LHNldDpmdW5jdGlvbihhKXt2YXIgaz10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zcmNPYmplY3Q6IHNldCBzcmNPYmplY3QgdG8gXCIrSlNPTi5zdHJpbmdpZnkoYSkpO2EhPT1cclxudGhpcy5zcmNPYmplY3RfJiYodGhpcy5zcmNPYmplY3RfPWEsdGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJBdWRpb0VsZW1lbnQuc3JjT2JqZWN0XCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYS5zeW5jQmFycmllcigpfSkudGhlbihmdW5jdGlvbihhKXtkLmxvZ2dlci5sb2coay51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3JjT2JqZWN0OiBzZXQgc3JjT2JqZWN0IHRvIHMgXCIrSlNPTi5zdHJpbmdpZnkoYSkpO3JldHVybiBrLnJlbW90ZUludm9rZSghMCxoLm1ldGhvZF9pZF9BdWRpb0VsZW1lbnRfdC5zcmNPYmplY3QsbnVsbCE9PWEmJnZvaWQgMCE9PWE/YS5pZDpcIm51bGxcIil9KS50aGVuKGZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKGsudXNlcl9mcmllbmRseV9pZCgpK1wiLnNyY09iamVjdCBzZXR0ZXI6IHJlbW90ZSBzdWNjZXNzIVwiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7ay5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnNyY09iamVjdCBzZXR0ZXI6IGZhaWxlZCB0byBjb25uZWN0IVwiKX0pKX0sXHJcbmVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGsucHJvdG90eXBlLFwic3JjXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNyY199LHNldDpmdW5jdGlvbihhKXt2YXIgaz10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zcmM6IHNldCBzcmMgdG8gXCIrYSk7dGhpcy5zcmNfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJBdWRpb0VsZW1lbnQuc3JjXCIpLnRoZW4oZnVuY3Rpb24oKXtrLnJlbW90ZUludm9rZSghMCxoLm1ldGhvZF9pZF9BdWRpb0VsZW1lbnRfdC5zcmMsYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2subG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zcmMgc2V0dGVyOiBmYWlsZWQgdG8gY29ubmVjdCFcIil9KX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtrLnByb3RvdHlwZS5wbGF5PWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLnBsYXkoKSBjYWxsZWQuXCIpO3RoaXMudG9nZ2xlQXVkaW8oITApO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihrLGcpe2Eud2FpdFVudGlsQ29ubmVjdGVkKFwiQXVkaW9FbGVtZW50LnBsYXlcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBhLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9BdWRpb0VsZW1lbnRfdC5wbGF5KX0pLnRoZW4oZnVuY3Rpb24oKXtrKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGspe2EubG9nUmVtb3RlSW52b2tlRXJyb3IoayxcIi5wbGF5OiBmYWlsZWQgdG8gY29ubmVjdCFcIik7ZyhrKX0pfSl9O2sucHJvdG90eXBlLnBsYXlFeD1mdW5jdGlvbihhLGssZyl7dmFyIGI9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucGxheUV4KCkgc3JjOlwiK2ErXCIgc2lua0lkOlwiK2srXCIgbG9vcDpcIitnKTt0aGlzLm5vdGlTdGF0ZT1xLlBsYXlTdGFydGVkO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiQXVkaW9FbGVtZW50LnBsYXlFeFwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGE9XHJcbltdO2smJmEucHVzaChiLnNldFNpbmtJZChrKSk7dm9pZCAwIT09ZyYmbnVsbCE9PWcmJihiLmxvb3BfPWcsYS5wdXNoKGIucmVtb3RlSW52b2tlKCEwLGgubWV0aG9kX2lkX0F1ZGlvRWxlbWVudF90Lmxvb3AsZykpKTtyZXR1cm4gUHJvbWlzZS5hbGwoYSl9KS50aGVuKGZ1bmN0aW9uKCl7Yi5zcmNfPWE7cmV0dXJuIGIucmVtb3RlSW52b2tlKCEwLGgubWV0aG9kX2lkX0F1ZGlvRWxlbWVudF90LnNyYyxhKX0pLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYi5wbGF5KCl9KS50aGVuKGZ1bmN0aW9uKCl7aWYoYi5ub3RpU3RhdGU9PXEuUGF1c2VDYWxsZWQpcmV0dXJuIGQubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5wbGF5RXgoKSBydW4gZGVmZXJyZWQgcGF1c2VcIiksYi5kb1BhdXNlQW5kRGlzcG9zZSgpfSkudGhlbihmdW5jdGlvbigpe2Iubm90aVN0YXRlPXEuSW5pdDtkLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucGxheUV4KCkgZG9uZVwiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5ub3RpU3RhdGU9XHJcbnEuSW5pdDtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIucGxheUV4KCkgZmFpbGVkIVwiKX0pfTtrLnByb3RvdHlwZS5wYXVzZT1mdW5jdGlvbigpe3ZhciBhPXRoaXM7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnBhdXNlKCkgY2FsbGVkLlwiKTt0aGlzLnRvZ2dsZUF1ZGlvKCExKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oayxnKXthLndhaXRVbnRpbENvbm5lY3RlZChcIkF1ZGlvRWxlbWVudC5wYXVzZVwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGEucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX0F1ZGlvRWxlbWVudF90LnBhdXNlKX0pLnRoZW4oZnVuY3Rpb24oKXtrKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGspe2EubG9nUmVtb3RlSW52b2tlRXJyb3IoayxcIi5wYXVzZTogZmFpbGVkIVwiKTtnKCl9KX0pfTtrLnByb3RvdHlwZS5kb1BhdXNlQW5kRGlzcG9zZT1mdW5jdGlvbigpe3ZhciBhPXRoaXM7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5kb1BhdXNlQW5kRGlzcG9zZSgpIGNhbGxlZC5cIik7dGhpcy50b2dnbGVBdWRpbyghMSk7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGssZyl7YS53YWl0VW50aWxDb25uZWN0ZWQoXCJBdWRpb0VsZW1lbnQuZG9QYXVzZUFuZERpc3Bvc2VcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBhLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9BdWRpb0VsZW1lbnRfdC5wYXVzZSxbXSl9KS50aGVuKGZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmRvUGF1c2VBbmREaXNwb3NlKCkgcmVzb2x2aW5nLi4uXCIpO2soKTthLmRpc3Bvc2UoKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oZyl7YS5sb2dSZW1vdGVJbnZva2VFcnJvcihnLFwiLmRvUGF1c2VBbmREaXNwb3NlOiBmYWlsZWQgdG8gY29ubmVjdCFcIil9KX0pfTtrLnByb3RvdHlwZS5wYXVzZUFuZERpc3Bvc2U9ZnVuY3Rpb24oKXt0aGlzLm5vdGlTdGF0ZT09cS5QbGF5U3RhcnRlZD8oZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5wYXVzZUFuZERpc3Bvc2UoKSBkZWZlcnJlZFwiKSx0aGlzLm5vdGlTdGF0ZT1xLlBhdXNlQ2FsbGVkKTp0aGlzLmRvUGF1c2VBbmREaXNwb3NlKCl9O2sucHJvdG90eXBlLnRvZ2dsZUF1ZGlvPWZ1bmN0aW9uKGEpe3RoaXMuc3JjT2JqZWN0XyYmKGQubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi50b2dnbGVBdWRpbygpIHRvZ2dsZSBhdWRpbyB0cmFja3M6XCIrYSksdGhpcy5zcmNPYmplY3RfLnRvZ2dsZUF1ZGlvKGEpKX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGsucHJvdG90eXBlLFwibG9vcFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sb29wX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBrPXRoaXM7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmxvb3A6IHNldCBsb29wIHRvIFwiK2EpO3RoaXMubG9vcF89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIkF1ZGlvRWxlbWVudC5sb29wXCIpLnRoZW4oZnVuY3Rpb24oKXtrLnJlbW90ZUludm9rZSghMCxcclxuaC5tZXRob2RfaWRfQXVkaW9FbGVtZW50X3QubG9vcCxhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7ay5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLmxvb3Agc2V0dGVyOiBmYWlsZWQgdG8gY29ubmVjdCFcIil9KX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtrLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmRpc3Bvc2UoKVwiKTt0aGlzLnNyY189dGhpcy5zaW5rSWRfPVwiXCI7dGhpcy5zcmNPYmplY3RfPW51bGw7dGhpcy5sb29wXz0hMTt0aGlzLnJlbGVhc2UoKX07cmV0dXJuIGt9KHUuUHJveHlPYmplY3QpO2EuQXVkaW9FbGVtZW50PWJ9LDIzOTpmdW5jdGlvbihiLGEsYyl7YS5FPXZvaWQgMDt2YXIgZT1jKDk0NSksdT1jKDg1MSksaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt0aGlzLnNpbmtJZD12b2lkIDA7dGhpcy5zcmM9XCJcIjt0aGlzLmxvb3A9dm9pZCAwO3RoaXMuZWxlbWVudD1udWxsfVxyXG5hLnByb3RvdHlwZS5nZXRTcmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zcmN9O2EucHJvdG90eXBlLnNldFNpbmtJZD1mdW5jdGlvbihhKXt0aGlzLnNpbmtJZD1hfTthLnByb3RvdHlwZS5nZXRMb29wPWZ1bmN0aW9uKCl7cmV0dXJuITA9PT10aGlzLmxvb3B9O2EucHJvdG90eXBlLnNldExvb3A9ZnVuY3Rpb24oYSl7dGhpcy5sb29wPWF9O2EucHJvdG90eXBlLnBsYXk9ZnVuY3Rpb24oYSl7dGhpcy5lbGVtZW50PW5ldyBlLkF1ZGlvRWxlbWVudDt0aGlzLnNyYz1hO3RoaXMuZWxlbWVudC5wbGF5RXgodGhpcy5zcmMsdGhpcy5zaW5rSWQsdGhpcy5sb29wKX07YS5wcm90b3R5cGUucGF1c2U9ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQmJih0aGlzLmVsZW1lbnQucGF1c2VBbmREaXNwb3NlKCksdGhpcy5lbGVtZW50PW51bGwpfTthLnByb3RvdHlwZS5yZWxlYXNlPWZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50JiYodGhpcy5lbGVtZW50LmRpc3Bvc2UoKSx0aGlzLmVsZW1lbnQ9bnVsbCl9O1xyXG5yZXR1cm4gYX0oKTtiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe3RoaXMuYXVkaW9JZE1hcD1udWxsO3RoaXMuYXVkaW9JZE1hcD1uZXcgTWFwfWEucHJvdG90eXBlLmdldE5vdGlmaWNhdGlvbkluZm89ZnVuY3Rpb24oYSl7aWYodGhpcy5hdWRpb0lkTWFwLmhhcyhhKSlyZXR1cm4gdGhpcy5hdWRpb0lkTWFwLmdldChhKTt2YXIgYj1uZXcgaDt0aGlzLmF1ZGlvSWRNYXAuc2V0KGEsYik7cmV0dXJuIGJ9O2EucHJvdG90eXBlLnBsYXlOb3RpZnlBdWRpbz1mdW5jdGlvbihhLGIpe2ImJih1LmxvZ2dlci5sb2coXCJBdWRpb05vdGlmaWNhdGlvbi5wbGF5Tm90aWZ5QXVkaW8sIFJlbW90ZSB0byBUaGluIENsaWVudCBhdWRpb0lkOlwiK2ErXCIgc3JjOlwiK2IpLHRoaXMuZ2V0Tm90aWZpY2F0aW9uSW5mbyhhKS5wbGF5KGIpKX07YS5wcm90b3R5cGUucGF1c2VOb3RpZnlBdWRpbz1mdW5jdGlvbihhLGIpe2lmKHRoaXMuYXVkaW9JZE1hcC5oYXMoYSkpe3ZhciBkPXRoaXMuYXVkaW9JZE1hcC5nZXQoYSk7XHJcbmImJmIhPWQuZ2V0U3JjKCkmJnUubG9nZ2VyLmxvZyhcIkF1ZGlvTm90aWZpY2F0aW9uLnBhdXNlTm90aWZ5QXVkaW8gd2FybmluZzogZm9yIGF1ZGlvSWQ6XCIrYStcIiwgZGlmZmVyZW50IHBhcmFtIHNyYzpcIitiK1wiIGZyb20gb3JnIHNyYzpcIitkLmdldFNyYygpKTtkLnBhdXNlKCl9ZWxzZSB1LmxvZ2dlci5sb2coXCJBdWRpb05vdGlmaWNhdGlvbi5wYXVzZU5vdGlmeUF1ZGlvIG5vIGF1ZGlvSWQ6XCIrYStcIiBzcmM6XCIrYil9O2EucHJvdG90eXBlLnNldFNpbmtJZD1mdW5jdGlvbihhLGIpe2lmKG51bGwhPWImJmIuc3RhcnRzV2l0aChcInNwZWFrZXI6XCIpKXt1LmxvZ2dlci5sb2coXCJBdWRpb05vdGlmaWNhdGlvbi5zZXRTaW5rSWQgYmVmb3JlIHBhcnNpbmcgYXVkaW9JZDpcIithK1wiIHNpbmtJZDpcIitiKTt2YXIgZD1iLnNsaWNlKDgpO3UubG9nZ2VyLmxvZyhcIkF1ZGlvTm90aWZpY2F0aW9uLnNldFNpbmtJZCBhZnRlciBwYXJzaW5nIGF1ZGlvSWQ6XCIrYStcIiBzcGVha2Vyc2lua0lkOlwiK2QpO1xyXG5iPWR9dGhpcy5nZXROb3RpZmljYXRpb25JbmZvKGEpLnNldFNpbmtJZChiKX07YS5wcm90b3R5cGUuZ2V0TG9vcD1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5nZXROb3RpZmljYXRpb25JbmZvKGEpLmdldExvb3AoKX07YS5wcm90b3R5cGUuc2V0TG9vcD1mdW5jdGlvbihhLGIpe3RoaXMuZ2V0Tm90aWZpY2F0aW9uSW5mbyhhKS5zZXRMb29wKGIpfTthLnByb3RvdHlwZS5yZWxlYXNlPWZ1bmN0aW9uKCl7dGhpcy5hdWRpb0lkTWFwLmZvckVhY2goZnVuY3Rpb24oYSxiLGQpe2EucmVsZWFzZSgpfSk7dGhpcy5hdWRpb0lkTWFwLmNsZWFyKCl9O3JldHVybiBhfSgpO2EuRT1ifSw2MTM6ZnVuY3Rpb24oYixhLGMpe3ZhciBlPXRoaXMmJnRoaXMuX19leHRlbmRzfHxmdW5jdGlvbigpe3ZhciBhPWZ1bmN0aW9uKGIsZCl7YT1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oYSxiKXthLl9fcHJvdG9fXz1ifXx8ZnVuY3Rpb24oYSxcclxuYil7Zm9yKHZhciBkIGluIGIpYi5oYXNPd25Qcm9wZXJ0eShkKSYmKGFbZF09YltkXSl9O3JldHVybiBhKGIsZCl9O3JldHVybiBmdW5jdGlvbihiLGQpe2Z1bmN0aW9uIGsoKXt0aGlzLmNvbnN0cnVjdG9yPWJ9YShiLGQpO2IucHJvdG90eXBlPW51bGw9PT1kP09iamVjdC5jcmVhdGUoZCk6KGsucHJvdG90eXBlPWQucHJvdG90eXBlLG5ldyBrKX19KCk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7YS5FOTExU2VydmljZT12b2lkIDA7dmFyIHU9Yyg1NTApLGg9Yyg2NTgpLGQ9Yyg4NTEpO2I9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYigpe3ZhciBkPWEuY2FsbCh0aGlzLG51bGwsdS5jbGFzc19pZF90LkU5MTFTZXJ2aWNlLDAsaC5Qcm94eU1vZGUuTG9jYWwpfHx0aGlzO2QucHJlRTkxMUluZm9fPW51bGw7cmV0dXJuIGR9ZShiLGEpO2IucHJvdG90eXBlLmlzU2FtZUluZm89ZnVuY3Rpb24oYSl7aWYobnVsbD09dGhpcy5wcmVFOTExSW5mb18mJlxyXG5udWxsIT1hfHxudWxsIT10aGlzLnByZUU5MTFJbmZvXyYmbnVsbD09YXx8dGhpcy5wcmVFOTExSW5mb18uZTkxMS5sZW5ndGghPWEuZTkxMS5sZW5ndGh8fHRoaXMucHJlRTkxMUluZm9fLmJzc2lkIT1hLmJzc2lkfHx0aGlzLnByZUU5MTFJbmZvXy5pcHY0IT1hLmlwdjR8fHRoaXMucHJlRTkxMUluZm9fLnN1Ym5ldExlbmd0aElwdjQhPWEuc3VibmV0TGVuZ3RoSXB2NHx8dGhpcy5wcmVFOTExSW5mb18uaXB2NiE9YS5pcHY2fHx0aGlzLnByZUU5MTFJbmZvXy5zdWJuZXRMZW5ndGhJcHY2IT1hLnN1Ym5ldExlbmd0aElwdjZ8fHRoaXMucHJlRTkxMUluZm9fLm1hYyE9YS5tYWN8fDFFLTQ8PU1hdGguYWJzKHRoaXMucHJlRTkxMUluZm9fLmxhdGl0dWRlLWEubGF0aXR1ZGUpfHwxRS00PD1NYXRoLmFicyh0aGlzLnByZUU5MTFJbmZvXy5sb25naXR1ZGUtYS5sb25naXR1ZGUpKXJldHVybiExO2Zvcih2YXIgaz0wO2s8YS5lOTExLmxlbmd0aDtrKyspaWYodGhpcy5wcmVFOTExSW5mb18uZTkxMVtrXS5jaGFzc2lzSWQhPVxyXG5hLmU5MTFba10uY2hhc3Npc0lkfHx0aGlzLnByZUU5MTFJbmZvXy5lOTExW2tdLnBvcnRJZCE9YS5lOTExW2tdLnBvcnRJZClyZXR1cm4hMTtyZXR1cm4hMH07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib251cGRhdGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub251cGRhdGVffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGs9dGhpczt0aGlzLm9udXBkYXRlXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9udXBkYXRlXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYT1rLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGsuaXNOdWxsQ2FsbGJhY2soay5vbnVwZGF0ZV8pLHUubWV0aG9kX2lkX0U5MTFTZXJ2aWNlX3Qub251cGRhdGUpO2EudGhlbihmdW5jdGlvbihhKXthPWEucGFyYW1zO3ZhciBnPWFbMF07YS5zbGljZSgxKTtudWxsIT09ay5wcmVFOTExSW5mb18mJmsuaXNTYW1lSW5mbyhnKXx8KGQubG9nZ2VyLmxvZyhrLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIub251cGRhdGVcIixKU09OLnN0cmluZ2lmeShnKSksay5vbnVwZGF0ZV8mJmsub251cGRhdGVfKGcpLGsucHJlRTkxMUluZm9fPWcpfSk7cmV0dXJuIGsucmVtb3RlSW52b2tlKCEwLHUubWV0aG9kX2lkX0U5MTFTZXJ2aWNlX3Qub251cGRhdGUsYS5zdWNjZXNzKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtyZXR1cm4gZC5sb2dnZXIubG9nKGsudXNlcl9mcmllbmRseV9pZCgpK1wiLm9udXBkYXRlLCBjb3VsZCBub3Qgc2V0IGxpc3RlbmVyXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuZ2V0RTkxMUluZm89ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihrLGIpe2Eud2FpdFVudGlsQ29ubmVjdGVkKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldEU5MTFJbmZvXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYS5yZW1vdGVJbnZva2UoITEsdS5tZXRob2RfaWRfRTkxMVNlcnZpY2VfdC5nZXRFOTExSW5mbyl9KS50aGVuKGZ1bmN0aW9uKGIpe2QubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuZ2V0RTkxMUluZm9cIixKU09OLnN0cmluZ2lmeShhLnBhcmFtMChiKSkpO2soYS5wYXJhbTAoYikpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRFOTExSW5mbyBwcm9taXNlIHJlamVjdGVkXCIpO2IoKX0pfSl9O2IucHJvdG90eXBlLnVwZGF0ZUU5MTFJbmZvPWZ1bmN0aW9uKCl7dmFyIGE9dGhpczt0aGlzLmdldEU5MTFJbmZvKCkudGhlbihmdW5jdGlvbihiKXtyZXR1cm4gYS5vbnVwZGF0ZSYmYS5vbnVwZGF0ZShiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtyZXR1cm4gZC5sb2dnZXIubG9nKFwiRmFpbCB0byBnZXQgZTkxMSBpbmZvcm1hdGlvbiFcIil9KX07cmV0dXJuIGJ9KGguUHJveHlPYmplY3QpO2EuRTkxMVNlcnZpY2U9Yn0sOTpmdW5jdGlvbihiLGEsYyl7dmFyIGU9dGhpcyYmdGhpcy5fX2V4dGVuZHN8fGZ1bmN0aW9uKCl7dmFyIGE9ZnVuY3Rpb24oYixrKXthPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mXHJcbkFycmF5JiZmdW5jdGlvbihhLGIpe2EuX19wcm90b19fPWJ9fHxmdW5jdGlvbihhLGIpe2Zvcih2YXIgZyBpbiBiKWIuaGFzT3duUHJvcGVydHkoZykmJihhW2ddPWJbZ10pfTtyZXR1cm4gYShiLGspfTtyZXR1cm4gZnVuY3Rpb24oYixrKXtmdW5jdGlvbiBkKCl7dGhpcy5jb25zdHJ1Y3Rvcj1ifWEoYixrKTtiLnByb3RvdHlwZT1udWxsPT09az9PYmplY3QuY3JlYXRlKGspOihkLnByb3RvdHlwZT1rLnByb3RvdHlwZSxuZXcgZCl9fSgpO09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO2EuRW5naW5lQ29udHJvbD1hLlZlcnNpb25UeXBlPXZvaWQgMDt2YXIgdT1jKDU1MCksaD1jKDk0NiksZD1jKDY1OCksdz1jKDg1MSk7KGZ1bmN0aW9uKGEpe2FbYS5XZWJycGM9MF09XCJXZWJycGNcIjthW2EuV2VicnRjQ29kZWNzPTFdPVwiV2VicnRjQ29kZWNzXCI7YVthLlJlY2VpdmVyPTJdPVwiUmVjZWl2ZXJcIjthW2EuVmRhPTNdPVwiVmRhXCI7YVthLkVuZHBvaW50PVxyXG40XT1cIkVuZHBvaW50XCI7YVthLlR5cGVTY3JpcHQ9NV09XCJUeXBlU2NyaXB0XCI7YVthLkhkeFJ0Y0VuZ2luZT02XT1cIkhkeFJ0Y0VuZ2luZVwiO2FbYS5NYXg9N109XCJNYXhcIn0pKGEuVmVyc2lvblR5cGV8fChhLlZlcnNpb25UeXBlPXt9KSk7Yj1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKGspe3ZhciBjPWEuY2FsbCh0aGlzLG51bGwsdS5jbGFzc19pZF90LkVuZ2luZUNvbnRyb2wsMCxkLlByb3h5TW9kZS5Mb2NhbCl8fHRoaXM7Yy5jbGllbnRJbmZvXz1cIlwiO2MuY2xpZW50SW5mb189aztyZXR1cm4gY31lKGIsYSk7Yi5wcm90b3R5cGUuYmluZD1mdW5jdGlvbigpe3cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5iaW5kKCkgY2FsbGVkLlwiKTt0aGlzLnJlY29uc3RydWN0b3IobnVsbCx1LmNsYXNzX2lkX3QuRW5naW5lQ29udHJvbCwwKX07Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuc3luY0JhcnJpZXIoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGQpe2Euc3luY0JhcnJpZXJEZWVwKGIsZCkmJmEud2FpdFVudGlsQ29ubmVjdGVkKFwiRW5naW5lQ29udHJvbC5zeW5jQmFycmllclwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFthLnJlbW90ZUludm9rZSghMSx1Lm1ldGhvZF9pZF9FbmdpbmVDb250cm9sX3QudmVyc2lvbix7bWFqb3I6MCxtaW5vcjowLHJldmlzaW9uOjAsYnVpbGQ6MH0pLGEucmVtb3RlSW52b2tlKCExLHUubWV0aG9kX2lkX0VuZ2luZUNvbnRyb2xfdC5mZWF0dXJlX2ZsYWdzLFtdKV0pfSkudGhlbihmdW5jdGlvbihiKXt3LmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCJyZWNlaXZlZCB3ZWJycGMgdmVyc2lvbiBhbmQgc3VwcG9ydGVkIGZlYXR1cmUgbGlzdC5cIik7Yj1iLm1hcChmdW5jdGlvbihiKXtyZXR1cm4gYS5wYXJhbTAoYil9KTthLnZlcnNpb25fPWJbMF07YS5mZWF0dXJlc189XHJcbmJbMV07aC5nZXRSZWRpcmVjdG9yKCkuc2V0RmVhdHVyZXMoYS5mZWF0dXJlc18pO2EucmVtb3RlSW52b2tlKCExLHUubWV0aG9kX2lkX0VuZ2luZUNvbnRyb2xfdC5zZXRfY2xpZW50X2luZm8sKGEuY2xpZW50SW5mb198fFwiVW5rbm93blwiKStcIjsgdmRpU2hpbS9cIit1LkhEWE1TX1ZFUlNJT04saC5nZXRSZWRpcmVjdG9yKCkuc2Vzc2lvbkNsaWVudElkKVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7cmV0dXJuIHcubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIiBjb3VsZCBub3Qgc2V0IGNsaWVudCBpbmZvXCIpfSk7Yj1bXTtmb3IodmFyIGQ9MCx0PWEuZmVhdHVyZXNfO2Q8dC5sZW5ndGg7ZCsrKXt2YXIgbT10W2RdO1wibXNfdGVhbXNfZGVza3RvcF9zaGFyaW5nXCI9PT1tLm5hbWUmJm0udmFsdWU/Yi5wdXNoKGEucmVtb3RlSW52b2tlKCExLHUubWV0aG9kX2lkX0VuZ2luZUNvbnRyb2xfdC52ZXJzaW9uX2luZm8sW10pKTpcIm1zX3RlYW1zX29zaW5mb1wiPT09bS5uYW1lJiZtLnZhbHVlP1xyXG5iLnB1c2goYS5yZW1vdGVJbnZva2UoITEsdS5tZXRob2RfaWRfRW5naW5lQ29udHJvbF90Lm9zaW5mbyx7ZmFtaWx5OlwiXCIsdmVyc2lvbjpcIlwiLGFyY2hpdGVjdHVyZTpcIlwiLGRpc3RybzpcIlwiLGVkaXRpb246XCJcIn0pKTpcIm1zX3RlYW1zX2VuZHBvaW50X2lkXCI9PT1tLm5hbWUmJm0udmFsdWU/Yi5wdXNoKGEucmVtb3RlSW52b2tlKCExLHUubWV0aG9kX2lkX0VuZ2luZUNvbnRyb2xfdC5lbmRwb2ludF9pZCx7bWFjaGluZV9pZDpcIlwiLHVzZXJfaWQ6XCJcIn0pKTpcIm1zX3RlYW1zX2hhcmR3YXJlX2luZm9cIj09PW0ubmFtZSYmbS52YWx1ZSYmYi5wdXNoKGEucmVtb3RlSW52b2tlKCExLHUubWV0aG9kX2lkX0VuZ2luZUNvbnRyb2xfdC5oYXJkd2FyZV9pbmZvKSl9aWYoMDxiLmxlbmd0aClyZXR1cm4gUHJvbWlzZS5hbGwoYil9KS50aGVuKGZ1bmN0aW9uKGIpe2lmKHZvaWQgMD09PWIpdy5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wicmVsZWFzZS0xOTA1IGNsaWVudC5cIik7ZWxzZXt3LmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwicmVsZWFzZS0xOTA2IG9yIGxhdGVyIGNsaWVudDogcmVjZWl2ZWQgZGV0YWlsZWQgY2xpZW50IHZlcnNpb24gbGlzdC5cIik7Zm9yKHZhciBkPTA7ZDxiLmxlbmd0aDtkKyspe3ZhciB0PWJbZF07dC5oZHIucHJvYy5paWQ9PXUuY2xhc3NfaWRfdC5FbmdpbmVDb250cm9sJiZ0Lmhkci5wcm9jLm1ldGhvZGlkPT11Lm1ldGhvZF9pZF9FbmdpbmVDb250cm9sX3QudmVyc2lvbl9pbmZvP2EudmVyc2lvbnNfPWEucGFyYW0wKHQpOnQuaGRyLnByb2MuaWlkPT11LmNsYXNzX2lkX3QuRW5naW5lQ29udHJvbCYmdC5oZHIucHJvYy5tZXRob2RpZD09dS5tZXRob2RfaWRfRW5naW5lQ29udHJvbF90Lm9zaW5mbz9hLm9zaW5mb189YS5wYXJhbTAodCk6dC5oZHIucHJvYy5paWQ9PXUuY2xhc3NfaWRfdC5FbmdpbmVDb250cm9sJiZ0Lmhkci5wcm9jLm1ldGhvZGlkPT11Lm1ldGhvZF9pZF9FbmdpbmVDb250cm9sX3QuZW5kcG9pbnRfaWQ/YS5lbmRwb2ludGlkXz1hLnBhcmFtMCh0KTp0Lmhkci5wcm9jLmlpZD09XHJcbnUuY2xhc3NfaWRfdC5FbmdpbmVDb250cm9sJiZ0Lmhkci5wcm9jLm1ldGhvZGlkPT11Lm1ldGhvZF9pZF9FbmdpbmVDb250cm9sX3QuaGFyZHdhcmVfaW5mbyYmKGEuaGFyZHdhcmVpbmZvXz1hLnBhcmFtMCh0KSl9fWEuc3luY0JhcnJpZXJSZXNvbHZlKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtiPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcImZhaWx1cmUgdG8gcmV0cmlldmUgdmVyc2lvbi9mZWF0dXJlIHJlbGF0ZWQgY2xpZW50IGluZm8uXCIpO2Euc3luY0JhcnJpZXJSZWplY3QoYil9KX0pfTtyZXR1cm4gYn0oZC5Qcm94eU9iamVjdCk7YS5FbmdpbmVDb250cm9sPWJ9LDM2ODpmdW5jdGlvbihiLGEsYyl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7YS5GcmFtZXM9YS5GcmFtZVRyYWNrZXI9dm9pZCAwO3ZhciBlPWMoODUxKSx1PWMoOTQ2KSxoPWMoNjc5KSxkPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYil7dGhpcy5yZXNvbHZlPVxyXG5hO3RoaXMucmVqZWN0PWJ9fSgpLHc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7dGhpcy5uYW1lPVwib3ZlcmxheVwiO3RoaXMucmVxc189W107dS5nZXRSZWRpcmVjdG9yKCkuYWRkUHJvdG9jb2xIYW5kbGVyKHRoaXMpfWEucHJvdG90eXBlLmluaXQ9ZnVuY3Rpb24oYSl7fTthLnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbigpe3RoaXMucmVxc18uZm9yRWFjaChmdW5jdGlvbihhLGIpe2EucmVqZWN0KCl9KTt0aGlzLnJlcXNfPVtdfTthLnByb3RvdHlwZS5vbl9tZXNzYWdlPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7ZS5sb2dnZXIubG9nKFwiSERYTVM6IE92ZXJsYXkgPDw8IFwiK0pTT04uc3RyaW5naWZ5KGEpKTtpZihcImNhcGFiaWxpdGllc1wiPT1hLmNvbW1hbmQpbmV3IFByb21pc2UoZnVuY3Rpb24oYSxrKXtiLnJlcXNfLnB1c2gobmV3IGQoYSxrKSk7dS5nZXRSZWRpcmVjdG9yKCkuV1NTZW5kT2JqZWN0KHt2Olwib3ZlcmxheVwiLGNvbW1hbmQ6XCJjb25maWd1cmVcIixjYXBzOltdfSl9KTtlbHNle3ZhciBjPVxyXG50aGlzLnJlcXNfLnNoaWZ0KCk7dm9pZCAwIT1jPzE9PWEuc3RhdHVzJiYoXCJ0cmFja193aW5kb3dcIj09YS5jb21tYW5kP2MucmVzb2x2ZShhLndpbmRvd0lkKTpcInVudHJhY2tfd2luZG93XCI9PWEuY29tbWFuZD9jLnJlc29sdmUoYS53aW5kb3dIYW5kbGUpOlwiY29uZmlndXJlXCI9PWEuY29tbWFuZD9jLnJlc29sdmUoe30pOmMucmVqZWN0KHt9KSk6ZS5sb2dnZXIubG9nKFwic3B1cmlvdXMgcmVzcG9uc2UgZm9yIG1lc3NhZ2U6IFwiK2EuY29tbWFuZCl9fTthLnByb3RvdHlwZS5yZWdpc3RlcldpbmRvd1dpdGhTZXJ2aWNlPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsZyl7dmFyIEI9dS5nZXRSZWRpcmVjdG9yKCk7aWYodm9pZCAwPT1hKXtlLmxvZ2dlci5sb2coXCJGcmFtZVRyYWNrZXJQcm90b2NvbC5yZWdpc3RlcldpbmRvd1dpdGhTZXJ2aWNlOiBsZWdhY3kgY2FzZVwiKTt2YXIgdD13aW5kb3cuZ2V0V2luZG93SGFuZGxlQXNIZXguYmluZCh3aW5kb3cpO1xyXG5pZih2b2lkIDA9PT10fHxudWxsPT09dCllLmxvZ2dlci5sb2coXCJGcmFtZVRyYWNrZXJQcm90b2NvbC5yZWdpc3RlcldpbmRvd1dpdGhTZXJ2aWNlOiBnZXRXaW5kb3dIYW5kbGUgbWV0aG9kIGlzIHVuZGVmaW5lZCBvciBudWxsXCIpLGcoe30pO1Byb21pc2UuYWxsKFt0KCksQi5zdGFydFJlZGlyZWN0aW9uKCExLFwicmVnaXN0ZXJXaW5kb3dXaXRoU2VydmljZVwiKV0pLnRoZW4oZnVuY3Rpb24oYSl7ZS5sb2dnZXIubG9nKFwiRnJhbWVUcmFja2VyLnJlZ2lzdGVyV2luZG93V2l0aFNlcnZpY2U6IHNldCB3aW5kb3cgaGFuZGxlOiBcIithWzBdKTtCLldTU2VuZE9iamVjdCh7djpcIm92ZXJsYXlcIixjb21tYW5kOlwid2luZG93XCIsd2luZG93SGFuZGxlOmFbMF19KTtjKHZvaWQgMCl9KX1lbHNlIGUubG9nZ2VyLmxvZyhcIkZyYW1lVHJhY2tlclByb3RvY29sLnJlZ2lzdGVyV2luZG93V2l0aFNlcnZpY2U6IG5ldyBNVyBjYXNlXCIpLEIuc3RhcnRSZWRpcmVjdGlvbighMSxcInJlZ2lzdGVyV2luZG93V2l0aFNlcnZpY2VcIikudGhlbihmdW5jdGlvbigpe2IucmVxc18ucHVzaChuZXcgZChjLFxyXG5nKSk7Qi5XU1NlbmRPYmplY3Qoe3Y6XCJvdmVybGF5XCIsY29tbWFuZDpcInRyYWNrX3dpbmRvd1wiLHdpbmRvd0hhbmRsZTphfSl9KX0pfTthLnByb3RvdHlwZS51bnJlZ2lzdGVyV2luZG93V2l0aFNlcnZpY2U9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztlLmxvZ2dlci5sb2coXCJGcmFtZVRyYWNrZXJQcm90b2NvbC51bnJlZ2lzdGVyV2luZG93V2l0aFNlcnZpY2UoaGFuZGxlOiBcIithK1wiKVwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxnKXt2b2lkIDA9PWE/Zyh7fSk6KGIucmVxc18ucHVzaChuZXcgZChjLGcpKSx1LmdldFJlZGlyZWN0b3IoKS5XU1NlbmRPYmplY3Qoe3Y6XCJvdmVybGF5XCIsY29tbWFuZDpcInVudHJhY2tfd2luZG93XCIsd2luZG93SGFuZGxlOmF9KSl9KX07cmV0dXJuIGF9KCkscT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYil7dmFyIGQ9dGhpczt0aGlzLnJ1bm5pbmdfPSExO3RoaXMuZWxlbWVudHNfPVtdO3RoaXMuY2xpcFJlY3RzPW5ldyBTZXQ7dGhpcy52aWRlb3NfPVxyXG5bXTt0aGlzLmNvbm5lY3RlZF89ITE7dGhpcy55Q2xpZW50QXJlYU9mZnNldF89dGhpcy54Q2xpZW50QXJlYU9mZnNldF89MDt0aGlzLndoZWVsRXZlbnRIYW5kbGVyPWZ1bmN0aW9uKGEpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXtkLnVwZGF0ZUFsbCgpfSwxMCl9O3RoaXMuc2Nyb2xsRXZlbnRIYW5kbGVyPWZ1bmN0aW9uKGEpe2QudXBkYXRlQWxsKCl9O3RoaXMua2V5dXBFdmVudEhhbmRsZXI9ZnVuY3Rpb24oYSl7XCJUYWJcIiE9YS5jb2RlJiZcIkFycm93VXBcIiE9YS5jb2RlJiZcIkFycm93RG93blwiIT1hLmNvZGUmJlwiQXJyb3dMZWZ0XCIhPWEuY29kZSYmXCJBcnJvd1JpZ2h0XCIhPWEuY29kZSYmXCJQYWdlVXBcIiE9YS5jb2RlJiZcIlBhZ2VEb3duXCIhPWEuY29kZSYmXCJIb21lXCIhPWEuY29kZSYmXCJFbmRcIiE9YS5jb2RlfHxkLnVwZGF0ZUFsbCgpfTt0aGlzLnJlc2l6ZUV2ZW50SGFuZGxlcj1mdW5jdGlvbihhKXtlLmxvZ2dlci5sb2coXCJvbldpbmRvd1Jlc2l6ZS4uLiB1cGRhdGUgdmlkZW8gZWxlbWVudHMgcG9zaXRpb25cIik7XHJcbmQudXBkYXRlQWxsKCl9O2UubG9nZ2VyLmxvZyhcIkZyYW1lVHJhY2tlci5jb25zdHJ1Y3RvcjogKGhhbmRsZTogXCIrYitcIilcIik7dGhpcy5oYW5kbGVfPWI7dGhpcy5jb25uZWN0VG9TZXJ2aWNlKCk7dGhpcy5vYnNlcnZlcl89bmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24oYSl7ZC51cGRhdGVBbGwoKX0pfWEucHJvdG90eXBlLmNvbm5lY3RUb1NlcnZpY2U9ZnVuY3Rpb24oKXt2YXIgYj10aGlzO2EuUHJvdG9jb2wucmVnaXN0ZXJXaW5kb3dXaXRoU2VydmljZSh0aGlzLmhhbmRsZV8pLnRoZW4oZnVuY3Rpb24oYSl7ZS5sb2dnZXIubG9nKFwiRnJhbWVUcmFja2VyOiBjb25uZWN0ZWQgdG8gc2VydmljZS4gKHdpbmRvd0lkPVwiK2ErXCIpXCIpO2IuY29ubmVjdGVkXz0hMDtiLndpbmRvd0lkXz1hO2IudmlkZW9zXy5mb3JFYWNoKGZ1bmN0aW9uKGEpe2Euc2lua0lkPUpTT04uc3RyaW5naWZ5KGIud2luZG93SWRfKX0pO2IudmlkZW9zXz1bXX0pfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYS5wcm90b3R5cGUsXHJcblwiaGFuZGxlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmhhbmRsZV99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7YS5wcm90b3R5cGUuZ2V0V2luZG93RnJvbUVsZW1lbnQ9ZnVuY3Rpb24oYSl7cmV0dXJuIGEub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlld307YS5wcm90b3R5cGUucmVjdGFuZ2xlc0ludGVyc2VjdD1mdW5jdGlvbihhLGIpe3JldHVybiBhLng8Yi54K2Iud2lkdGgmJmEueCthLndpZHRoPmIueCYmYS55PGIueStiLmhlaWdodCYmYS55K2EuaGVpZ2h0PmIueT8hMDohMX07YS5wcm90b3R5cGUuaW50ZXJzZWN0aW5nUmVjdD1mdW5jdGlvbihhLGIpe3ZhciBkPU1hdGgubWF4KGEubGVmdCxiLmxlZnQpLGc9TWF0aC5tYXgoYS50b3AsYi50b3ApO3JldHVybiBuZXcgRE9NUmVjdChkLGcsTWF0aC5taW4oYS5yaWdodCxiLnJpZ2h0KS1kLE1hdGgubWluKGEuYm90dG9tLGIuYm90dG9tKS1nKX07YS5wcm90b3R5cGUucGVkaWdyZWVDb3VudD1mdW5jdGlvbihhLFxyXG5iKXtmb3IodmFyIGQ9MCxnPWEucGFyZW50RWxlbWVudDtudWxsIT1nJiZnIT1iOylkKyssZz1nLnBhcmVudEVsZW1lbnQ7cmV0dXJue2lzQW5jZXN0b3I6bnVsbCE9ZyxwZWRpZ3JlZTpkfX07YS5wcm90b3R5cGUuc2VsZWN0VG9wbW9zdD1mdW5jdGlvbihhLGIpe3ZhciBkPXRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGEpLGc9dGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoYiksZD10aGlzLmludGVyc2VjdGluZ1JlY3QoZCxnKSxnPWEub3duZXJEb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KGQubGVmdCtkLndpZHRoLzIsZC50b3ArZC5oZWlnaHQvMik7aWYoZz09YSlyZXR1cm4gYTtpZihnPT1iKXJldHVybiBiO2Q9dGhpcy5wZWRpZ3JlZUNvdW50KGEsZyk7Zz10aGlzLnBlZGlncmVlQ291bnQoYixnKTtpZihkLmlzQW5jZXN0b3ImJmcuaXNBbmNlc3Rvcil7aWYoZC5wZWRpZ3JlZTxnLnBlZGlncmVlKXJldHVybiBhO2lmKGcucGVkaWdyZWU8ZC5wZWRpZ3JlZSlyZXR1cm4gYn1lbHNle2lmKGQuaXNBbmNlc3RvcilyZXR1cm4gYTtcclxuaWYoZy5pc0FuY2VzdG9yKXJldHVybiBifX07YS5wcm90b3R5cGUuY2hlY2tPdmVybGFwcGluZ1ZpZGVvcz1mdW5jdGlvbihhKXt2YXIgYj10aGlzLGQ9dGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoYS50YXJnZXQpO2Eub3ZlcmxhcHMuZm9yRWFjaChmdW5jdGlvbihiKXthLnRhcmdldC5yZW1vdGVWaWRlb0VsZW1lbnQucmVtb3ZlQ2xpcFJlY3QoYi5yZWN0KX0pO2Eub3ZlcmxhcHM9W107dGhpcy5lbGVtZW50c18uZm9yRWFjaChmdW5jdGlvbihnKXtpZihnIT1hKXt2YXIgYz1nLm92ZXJsYXBzLm1hcChmdW5jdGlvbihhKXtyZXR1cm4gYS5lbGVtZW50fSkuaW5kZXhPZihhLnRhcmdldCk7LTEhPWMmJihjPWcub3ZlcmxhcHMuc3BsaWNlKGMsMSlbMF0sZy50YXJnZXQucmVtb3RlVmlkZW9FbGVtZW50LnJlbW92ZUNsaXBSZWN0KGMucmVjdCkpO2M9Yi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoZy50YXJnZXQpO2lmKGIucmVjdGFuZ2xlc0ludGVyc2VjdChkLGMpKXt2YXIgdD1iLnNlbGVjdFRvcG1vc3QoYS50YXJnZXQsXHJcbmcudGFyZ2V0KTt0PT1hLnRhcmdldD8oZy5vdmVybGFwcy5wdXNoKHtlbGVtZW50OmEudGFyZ2V0LHJlY3Q6ZH0pLGcudGFyZ2V0LnJlbW90ZVZpZGVvRWxlbWVudC5hZGRDbGlwUmVjdChkKSk6dD09Zy50YXJnZXQmJihhLm92ZXJsYXBzLnB1c2goe2VsZW1lbnQ6Zy50YXJnZXQscmVjdDpjfSksYS50YXJnZXQucmVtb3RlVmlkZW9FbGVtZW50LmFkZENsaXBSZWN0KGMpKX19fSl9O2EucHJvdG90eXBlLnVwZGF0ZUFsbD1mdW5jdGlvbigpe3ZhciBhPXRoaXM7dGhpcy5lbGVtZW50c18uZm9yRWFjaChmdW5jdGlvbihiKXt2YXIgZD1hLmdldEJvdW5kaW5nQ2xpZW50UmVjdChiLnRhcmdldCk7aWYodm9pZCAwIT09ZCl7dmFyIGc9Yi5jbGllbnRSZWN0O2lmKHZvaWQgMD09PWd8fGcueCE9PWQueHx8Zy55IT09ZC55fHxnLndpZHRoIT09ZC53aWR0aHx8Zy5oZWlnaHQhPT1kLmhlaWdodCliLmNsaWVudFJlY3Q9ZCxiLmNhbGxiYWNrKGQpLGEuY2hlY2tPdmVybGFwcGluZ1ZpZGVvcyhiKX19KX07XHJcbmEucHJvdG90eXBlLnRyYWNrPWZ1bmN0aW9uKGEsYil7dmFyIGQ9dGhpcyxnPXRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGEpO2UubG9nZ2VyLmxvZyhcIlRyYWNrIChoYW5kbGU6IFwiK3RoaXMuaGFuZGxlXytcIikgZWxlbWVudCBmcmFtZVwiLGEsSlNPTi5zdHJpbmdpZnkoZykpO2NvbnNvbGUubG9nKGEpO3RoaXMuZWxlbWVudHNfLnB1c2goe3RhcmdldDphLGNsaWVudFJlY3Q6dm9pZCAwLGNhbGxiYWNrOmIsb3ZlcmxhcHM6W119KTt0cnl7ZS5sb2dnZXIubG9nKFwiW0hkeFdlYlJUQy5qc10gSW5pdGlhbGl6aW5nIG9jY2x1c2lvbiBmb3IgbmV3IHZpZGVvRWxlbWVudFwiKSx0aGlzLmNsaXBSZWN0cy5mb3JFYWNoKGZ1bmN0aW9uKGIpe2QuYXBwbHlPY2NsdXNpb24oYSxKU09OLnBhcnNlKGIpKX0pfWNhdGNoKGMpe2UubG9nZ2VyLmxvZyhcIltIZHhXZWJSVEMuanNdIGFkZE9jY2x1c2lvbkluaXQgZmFpbGVkISBcIitjKX10aGlzLnJ1bm5pbmdffHwoZS5sb2dnZXIubG9nKFwiU3RhcnQgRnJhbWVUcmFja2VyIG9ic2VydmVyLi4uXCIpLFxyXG50aGlzLm9ic2VydmVyXy5vYnNlcnZlKGEub3duZXJEb2N1bWVudC5ib2R5LHthdHRyaWJ1dGVzOiEwLGNoaWxkTGlzdDohMCxzdWJ0cmVlOiEwfSksZz10aGlzLmdldFdpbmRvd0Zyb21FbGVtZW50KGEpLGcuYWRkRXZlbnRMaXN0ZW5lcihcIndoZWVsXCIsdGhpcy53aGVlbEV2ZW50SGFuZGxlciksZy5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsdGhpcy5zY3JvbGxFdmVudEhhbmRsZXIpLGcuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsdGhpcy5rZXl1cEV2ZW50SGFuZGxlciksZy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsdGhpcy5yZXNpemVFdmVudEhhbmRsZXIpLHRoaXMucnVubmluZ189ITApO3RoaXMudXBkYXRlQWxsKCl9O2EucHJvdG90eXBlLnVudHJhY2s9ZnVuY3Rpb24oYSl7ZS5sb2dnZXIubG9nKFwiVW50cmFjayAoaGFuZGxlOiBcIit0aGlzLmhhbmRsZV8rXCIpIGVsZW1lbnQgZnJhbWVcIixhKTt2YXIgYj0tMTt0aGlzLmVsZW1lbnRzXy5mb3JFYWNoKGZ1bmN0aW9uKGcsXHJcbmQpe2cudGFyZ2V0PT09YSYmKGI9ZCl9KTtpZigwPD1iJiYodGhpcy5lbGVtZW50c18uc3BsaWNlKGIsMSksMD09PXRoaXMuZWxlbWVudHNfLmxlbmd0aCkpe2UubG9nZ2VyLmxvZyhcIlN0b3AgRnJhbWVUcmFja2VyIG9ic2VydmVyLi4uXCIpO3RoaXMub2JzZXJ2ZXJfLmRpc2Nvbm5lY3QoKTt2YXIgZD10aGlzLmdldFdpbmRvd0Zyb21FbGVtZW50KGEpO2QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIndoZWVsXCIsdGhpcy53aGVlbEV2ZW50SGFuZGxlcik7ZC5yZW1vdmVFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsdGhpcy5zY3JvbGxFdmVudEhhbmRsZXIpO2QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsdGhpcy5rZXl1cEV2ZW50SGFuZGxlcik7ZC5yZW1vdmVFdmVudExpc3RlbmVyKFwicmVzaXplXCIsdGhpcy5yZXNpemVFdmVudEhhbmRsZXIpO3RoaXMucnVubmluZ189ITF9fTthLnByb3RvdHlwZS5hcHBseU9jY2x1c2lvbj1mdW5jdGlvbihhLGIpe3ZhciBkPXRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGEpO1xyXG50aGlzLnJlY3RhbmdsZXNJbnRlcnNlY3QoYixkKSYmdm9pZCAwIT09YS5yZW1vdGVWaWRlb0VsZW1lbnQmJmEucmVtb3RlVmlkZW9FbGVtZW50LmFkZENsaXBSZWN0KGIpfTthLnByb3RvdHlwZS5hZGRPY2NsdXNpb249ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztlLmxvZ2dlci5sb2coXCJbSGR4V2ViUlRDLmpzXSBBZGRpbmcgb2NjbHVzaW9uIFwiK0pTT04uc3RyaW5naWZ5KGEpKTtlLmxvZ2dlci5sb2coXCJbSGR4V2ViUlRDLmpzXSBUcmFja2luZyAnXCIrdGhpcy5lbGVtZW50c18ubGVuZ3RoK1wiJyBlbGVtZW50cy5cIik7dGhpcy5jbGlwUmVjdHMuYWRkKEpTT04uc3RyaW5naWZ5KGEpKTt0aGlzLmVsZW1lbnRzXy5mb3JFYWNoKGZ1bmN0aW9uKGQpe2IuYXBwbHlPY2NsdXNpb24oZC50YXJnZXQsYSl9KX07YS5wcm90b3R5cGUucmVtb3ZlT2NjbHVzaW9uPWZ1bmN0aW9uKGEpe2UubG9nZ2VyLmxvZyhcIltIZHhXZWJSVEMuanNdIFJlbW92aW5nIG9jY2x1c2lvbiBcIitKU09OLnN0cmluZ2lmeShhKSk7XHJcbmUubG9nZ2VyLmxvZyhcIltIZHhXZWJSVEMuanNdIFRyYWNraW5nICdcIit0aGlzLmVsZW1lbnRzXy5sZW5ndGgrXCInIGVsZW1lbnRzLlwiKTt0aGlzLmNsaXBSZWN0c1tcImRlbGV0ZVwiXShKU09OLnN0cmluZ2lmeShhKSk7dGhpcy5lbGVtZW50c18uZm9yRWFjaChmdW5jdGlvbihiKXt2b2lkIDAhPT1iLnRhcmdldC5yZW1vdGVWaWRlb0VsZW1lbnQmJmIudGFyZ2V0LnJlbW90ZVZpZGVvRWxlbWVudC5yZW1vdmVDbGlwUmVjdChhKX0pfTthLnByb3RvdHlwZS5zZXRDbGllbnRBcmVhT2Zmc2V0PWZ1bmN0aW9uKGEsYil7dGhpcy54Q2xpZW50QXJlYU9mZnNldF89YTt0aGlzLnlDbGllbnRBcmVhT2Zmc2V0Xz1ifTthLnByb3RvdHlwZS5nZXRCb3VuZGluZ0NsaWVudFJlY3Q9ZnVuY3Rpb24oYSl7YT1hLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO2EueCs9dGhpcy54Q2xpZW50QXJlYU9mZnNldF87YS55Kz10aGlzLnlDbGllbnRBcmVhT2Zmc2V0XztyZXR1cm4gYX07YS5wcm90b3R5cGUubmV3VmlkZW9FbGVtZW50PVxyXG5mdW5jdGlvbihiKXt2YXIgZD10aGlzO2UubG9nZ2VyLmxvZyhcIkZyYW1lVHJhY2tlci5uZXdWaWRlb0VsZW1lbnQ6IChpZDogXCIrYi5pZCtcIilcIik7aWYodm9pZCAwIT09Yi5yZW1vdGVWaWRlb0VsZW1lbnQpZS5sb2dnZXIubG9nKFwiVmlkZW8gZWxlbWVudCBpcyBhbHJlYWR5IGNvbmZpZ3VyZWQhISFcIik7ZWxzZXtiLmlkfHwoYi5pZD1cImN0eC12aWQtXCIrYS52aWRlb0VsZW1lbnRJRHMrKyk7dmFyIGM9bmV3IGguVmlkZW9FbGVtZW50KGIuaWQsdGhpcy5nZXRXaW5kb3dGcm9tRWxlbWVudChiKSk7dGhpcy5jb25uZWN0ZWRfPyhlLmxvZ2dlci5sb2coXCJGcmFtZVRyYWNrZXIubmV3VmlkZW9FbGVtZW50OiBpbml0aWFsaXppbmcgdmlkZW8gZWxlbWVudCB3aXRoIHNpbmsgaWQgXCIrdGhpcy53aW5kb3dJZF8pLGMuc2lua0lkPUpTT04uc3RyaW5naWZ5KHRoaXMud2luZG93SWRfKSk6KGUubG9nZ2VyLmxvZyhcIkZyYW1lVHJhY2tlci5uZXdWaWRlb0VsZW1lbnQ6IHZpZGVvIGVsZW1lbnQgYXdhaXRpbmcgc3RhYmxlIHdpbmRvdyBzdGF0ZVwiKSxcclxudGhpcy52aWRlb3NfLnB1c2goYykpO2Mub25sb2FkZWRtZXRhZGF0YT1mdW5jdGlvbigpe2IuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoXCJsb2FkZWRtZXRhZGF0YVwiKSl9O2Mub250aW1ldXBkYXRlPWZ1bmN0aW9uKCl7Yi5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChcInRpbWV1cGRhdGVcIikpfTtjLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7XCJjb25uZWN0ZWRcIj09Yy5jb25uZWN0aW9uU3RhdGU/ZC50cmFjayhiLGZ1bmN0aW9uKGEpe2Muc2V0RnJhbWUoYSl9KTpkLnVudHJhY2soYil9O2RlbGV0ZSBiLnJlbW90ZVZpZGVvRWxlbWVudDtPYmplY3QuZGVmaW5lUHJvcGVydHkoYixcInJlbW90ZVZpZGVvRWxlbWVudFwiLHt3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITAsdmFsdWU6bnVsbH0pO2IucmVtb3RlVmlkZW9FbGVtZW50PWM7ZGVsZXRlIGIuc3JjT2JqZWN0O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLFwic3JjT2JqZWN0XCIse2NvbmZpZ3VyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gYy5zcmNPYmplY3R9LFxyXG5zZXQ6ZnVuY3Rpb24oYSl7ZS5sb2dnZXIubG9nKFwiVkRJIFNoaW0gc2V0IHZpZGVvIGVsZW1lbnQgc3JjT2JqZWN0IFwiK2EpO2Muc3JjT2JqZWN0PWF9fSk7ZGVsZXRlIGIudmlkZW9XaWR0aDtPYmplY3QuZGVmaW5lUHJvcGVydHkoYixcInZpZGVvV2lkdGhcIix7Y29uZmlndXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiBjLnZpZGVvV2lkdGh9fSk7ZGVsZXRlIGIudmlkZW9IZWlnaHQ7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIsXCJ2aWRlb0hlaWdodFwiLHtjb25maWd1cmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGMudmlkZW9IZWlnaHR9fSl9fTthLnByb3RvdHlwZS5kaXNwb3NlVmlkZW9FbGVtZW50PWZ1bmN0aW9uKGEpe2UubG9nZ2VyLmxvZyhcIkZyYW1lVHJhY2tlci5kaXNwb3NlVmlkZW9FbGVtZW50OiAoaWQ6IFwiK2EuaWQrXCIpXCIpO3ZhciBiPWEucmVtb3RlVmlkZW9FbGVtZW50O2lmKHZvaWQgMCE9Yil7dmFyIGQ9dGhpcy52aWRlb3NfLmZpbmRJbmRleChmdW5jdGlvbihhKXtyZXR1cm4gYS5JZD09XHJcbmIuSWR9KTstMTxkJiZ0aGlzLnZpZGVvc18uc3BsaWNlKGQsMSk7Yi5kaXNwb3NlKCk7YS5yZW1vdGVWaWRlb0VsZW1lbnQ9dm9pZCAwfX07YS52aWRlb0VsZW1lbnRJRHM9MDthLlByb3RvY29sPW5ldyB3O3JldHVybiBhfSgpO2EuRnJhbWVUcmFja2VyPXE7Yj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYil7dGhpcy5mcmFtZXNfPVtdO2ImJnRoaXMuZnJhbWVzXy5wdXNoKG5ldyBxKHZvaWQgMCkpfWEucHJvdG90eXBlLm5ld0ZyYW1lPWZ1bmN0aW9uKGEpe2UubG9nZ2VyLmxvZyhcIkZyYW1lcy5uZXdGcmFtZTogKGhhbmRsZTogXCIrYStcIilcIik7dmFyIGI9dGhpcy5maW5kRnJhbWUoYSk7dm9pZCAwPT1iJiYoYj1uZXcgcShhKSx0aGlzLmZyYW1lc18ucHVzaChiKSk7cmV0dXJuIGJ9O2EucHJvdG90eXBlLmRpc3Bvc2VGcmFtZT1mdW5jdGlvbihhKXtlLmxvZ2dlci5sb2coXCJGcmFtZXMuZGlzcG9zZUZyYW1lOiAoaGFuZGxlOiBcIithK1wiKVwiKTt2YXIgYj10aGlzLmZyYW1lc18uZmluZEluZGV4KGZ1bmN0aW9uKGIpe3JldHVybiBiLmhhbmRsZT09XHJcbmF9KTstMTxiJiYocS5Qcm90b2NvbC51bnJlZ2lzdGVyV2luZG93V2l0aFNlcnZpY2UoYSkudGhlbihmdW5jdGlvbihhKXtlLmxvZ2dlci5sb2coXCJVbnRyYWNrIHdpbmRvdyAoaGFuZGxlOiBcIithK1wiKSBzdWNjZXNzZnVsXCIpfSksdGhpcy5mcmFtZXNfLnNwbGljZShiLDEpKX07YS5wcm90b3R5cGUuZmluZEZyYW1lPWZ1bmN0aW9uKGEpe2UubG9nZ2VyLmxvZyhcIkZyYW1lcy5maW5kRnJhbWU6IChoYW5kbGU6IFwiK2ErXCIpXCIpO3JldHVybiB2b2lkIDAhPWE/dGhpcy5mcmFtZXNfLmZpbmQoZnVuY3Rpb24oYil7cmV0dXJuIGIuaGFuZGxlPT1hfSk6dGhpcy5mcmFtZXNfWzBdfTthLnByb3RvdHlwZS5yZWNvbm5lY3Q9ZnVuY3Rpb24oKXtlLmxvZ2dlci5sb2coXCJGcmFtZXMucmVjb25uZWN0KClcIik7dGhpcy5mcmFtZXNfLmZvckVhY2goZnVuY3Rpb24oYSl7YS5jb25uZWN0VG9TZXJ2aWNlKCl9KX07cmV0dXJuIGF9KCk7YS5GcmFtZXM9Yn0sMjQ3OmZ1bmN0aW9uKGIsYSl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXHJcblwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO2EuZ2V0R0M9YS5HQz12b2lkIDA7dmFyIGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIpe3RoaXMucGFyZW50Xz10aGlzLm9iamVjdF89bnVsbDt0aGlzLmNoaWxkcmVuXz1bXTt0aGlzLm9iamVjdF89Yn1hLnByb3RvdHlwZS5hZGRDaGlsZD1mdW5jdGlvbihhKXthLnBhcmVudF8hPXRoaXMmJihhLnBhcmVudF89dGhpcyx0aGlzLmNoaWxkcmVuXy5wdXNoKGEpKX07YS5wcm90b3R5cGUucmVtb3ZlQ2hpbGQ9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGlsZHJlbl8uaW5kZXhPZihhKTt0aGlzLmNoaWxkcmVuXy5zcGxpY2UoYiwxKTthLnBhcmVudF89bnVsbH07cmV0dXJuIGF9KCksZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt0aGlzLnJvb3RfPW5ldyBjKG51bGwpfWEucHJvdG90eXBlLnRyYWNrT2JqZWN0PWZ1bmN0aW9uKGEsYil7dm9pZCAwPT09YiYmKGI9bnVsbCk7aWYobnVsbD09PXRoaXMuZmluZE5vZGUoYSx0aGlzLnJvb3RfKSl7dmFyIGU9XHJcbnRoaXMuZmluZE5vZGUoYix0aGlzLnJvb3RfKSxoPW5ldyBjKGEpO2U/ZS5hZGRDaGlsZChoKTp0aGlzLnJvb3RfLmFkZENoaWxkKGgpfX07YS5wcm90b3R5cGUucmVsZWFzZU9iamVjdD1mdW5jdGlvbihhKXthPXRoaXMuZmluZE5vZGUoYSx0aGlzLnJvb3RfKTtpZihudWxsPT09YXx8YT09PXRoaXMucm9vdF8pcmV0dXJuITE7dGhpcy5kZXN0cm95Tm9kZU9iamVjdFJlY3Vyc2UoYSk7YS5wYXJlbnRfLnJlbW92ZUNoaWxkKGEpO3JldHVybiEwfTthLnByb3RvdHlwZS5kZXN0cm95Tm9kZU9iamVjdFJlY3Vyc2U9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsYz1hLmNoaWxkcmVuXztiPGMubGVuZ3RoO2IrKyl0aGlzLmRlc3Ryb3lOb2RlT2JqZWN0UmVjdXJzZShjW2JdKTthLm9iamVjdF8uZGVzdHJveSgpfTthLnByb3RvdHlwZS5zZXRQYXJlbnQ9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmZpbmROb2RlKGEsdGhpcy5yb290Xyk7aWYobnVsbD09PWMpcmV0dXJuITE7dmFyIGU9dGhpcy5maW5kTm9kZShiLFxyXG50aGlzLnJvb3RfKTtpZihudWxsPT09ZSlyZXR1cm4hMTtpZihjLnBhcmVudF89PT1lKXJldHVybiEwO2MucGFyZW50Xy5yZW1vdmVDaGlsZChjKTtlLmFkZENoaWxkKGMpO3JldHVybiEwfTthLnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbigpe3RoaXMucm9vdF8uY2hpbGRyZW5fPVtdfTthLnByb3RvdHlwZS5maW5kTm9kZT1mdW5jdGlvbihhLGIpe2lmKGIub2JqZWN0Xz09PWEpcmV0dXJuIGI7Zm9yKHZhciBjPW51bGwsZT0wLGs9Yi5jaGlsZHJlbl87ZTxrLmxlbmd0aCYmKGM9dGhpcy5maW5kTm9kZShhLGtbZV0pLG51bGw9PT1jKTtlKyspO3JldHVybiBjfTtyZXR1cm4gYX0oKTthLkdDPWU7dmFyIHU9bmV3IGU7YS5nZXRHQz1mdW5jdGlvbigpe3JldHVybiB1fX0sOTQ2OmZ1bmN0aW9uKGIsYSxjKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTthLmdldFJlZGlyZWN0b3I9YS5IZHhNZWRpYVN0cmVhbT1hLlJlZGlyZWN0aW9uU3RhdHVzPVxyXG5hLldlYnJwY1N0YXR1c0NvZGU9dm9pZCAwO3ZhciBlPWMoNjU4KSx1PWMoODUxKSxoPWMoNTUwKSxkPWMoNTQ1KSx3PWMoMzk0KSxxPWMoNjkxKSxuPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYixkLG0sYyxrLHgscil7dm9pZCAwPT09ciYmKHI9dm9pZCAwKTt0aGlzLnJlc29sdmU9YTt0aGlzLnJlamVjdD1iO3RoaXMuaWlkPWQ7dGhpcy5vaWQ9bTt0aGlzLmNiaWQ9Yzt0aGlzLm9uZVNob3Q9azt0aGlzLm1pZD14O3RoaXMuY29tcGxldGlvbl9jYj1yfX0oKSxrOyhmdW5jdGlvbihhKXthW2EucnBjX3N0YXR1c19zdWNjZXNzPTBdPVwicnBjX3N0YXR1c19zdWNjZXNzXCI7YVthLnJwY19zdGF0dXNfdW5zcGVjaWZpZWRfZXJyb3I9MV09XCJycGNfc3RhdHVzX3Vuc3BlY2lmaWVkX2Vycm9yXCI7YVthLnJwY19zdGF0dXNfdW5leHBlY3RlZD0yXT1cInJwY19zdGF0dXNfdW5leHBlY3RlZFwiO2FbYS5ycGNfc3RhdHVzX2luZGV4X291dF9vZl9ib3VuZHM9M109XCJycGNfc3RhdHVzX2luZGV4X291dF9vZl9ib3VuZHNcIjtcclxuYVthLnJwY19zdGF0dXNfbWlzc2luZ19wYXJhbWV0ZXI9NF09XCJycGNfc3RhdHVzX21pc3NpbmdfcGFyYW1ldGVyXCI7YVthLnJwY19zdGF0dXNfbWlzc2luZ19yZXR1cm5fdmFsdWU9NV09XCJycGNfc3RhdHVzX21pc3NpbmdfcmV0dXJuX3ZhbHVlXCI7YVthLnJwY19zdGF0dXNfaW52YWxpZF9vYmplY3Q9Nl09XCJycGNfc3RhdHVzX2ludmFsaWRfb2JqZWN0XCI7YVthLnJwY19zdGF0dXNfdXNlcl9leGNlcHRpb249N109XCJycGNfc3RhdHVzX3VzZXJfZXhjZXB0aW9uXCI7YVthLnJwY19zdGF0dXNfc3lzdGVtX2Vycm9yPThdPVwicnBjX3N0YXR1c19zeXN0ZW1fZXJyb3JcIn0pKGs9YS5XZWJycGNTdGF0dXNDb2RlfHwoYS5XZWJycGNTdGF0dXNDb2RlPXt9KSk7dmFyIHY7KGZ1bmN0aW9uKGEpe2FbYS5Ob3RSZWRpcmVjdGVkPTBdPVwiTm90UmVkaXJlY3RlZFwiO2FbYS5Db25uZWN0aW5nPTFdPVwiQ29ubmVjdGluZ1wiO2FbYS5CaW5kaW5nPTJdPVwiQmluZGluZ1wiO2FbYS5SZWRpcmVjdGVkPTNdPVwiUmVkaXJlY3RlZFwifSkodj1cclxuYS5SZWRpcmVjdGlvblN0YXR1c3x8KGEuUmVkaXJlY3Rpb25TdGF0dXM9e30pKTtiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe3RoaXMuc2Vzc2lvbklkXz1cIlwiO3RoaXMuaGFuZGxlcnNfPVtdO3RoaXMucGluZ2FjdGl2ZT0hMTt0aGlzLnN0YXR1cz12Lk5vdFJlZGlyZWN0ZWQ7dGhpcy5yZXFzPVtdO3RoaXMuY2JzPVtdO3RoaXMuZGVmZXJyZWRBY3Rpb25zPVtdO3RoaXMudGVsZW1ldHJ5Xz1uZXcgdy5UZWxlbWV0cnk7dGhpcy5zY3JlZW5zaGFyZV89bmV3IHEuU2NyZWVuU2hhcmVVdGlsO3RoaXMuc3RhdGVDaGFuZ2VOb3RpZmNhdGlvbnM9W107dGhpcy52ZGFmZWF0dXJlc189W119T2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwidGVsZW1ldHJ5XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRlbGVtZXRyeV99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwic2NyZWVuc2hhcmVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2NyZWVuc2hhcmVffSxcclxuZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTthLnByb3RvdHlwZS5zZXRSZW1vdGVTZXNzaW9uSW5mb0NiPWZ1bmN0aW9uKGEpe3RoaXMucmVtb3RlU2Vzc2lvbkluZm9DYj1hfTthLnByb3RvdHlwZS5zZXRGZWF0dXJlcz1mdW5jdGlvbihhKXt0aGlzLmZlYXR1cmVzPWE7dGhpcy5zY3JlZW5zaGFyZS5vbkluaXRDb21wbGV0ZSgpO3RoaXMuaGFuZGxlcnNfLmZvckVhY2goZnVuY3Rpb24oYixkKXtiLmluaXQoYSl9KX07YS5wcm90b3R5cGUuZ2V0RmVhdHVyZVZhbHVlPWZ1bmN0aW9uKGEpe2lmKHRoaXMuZmVhdHVyZXMpe3ZhciBiPXRoaXMuZmVhdHVyZXMuZmluZChmdW5jdGlvbihiKXtyZXR1cm4gYi5uYW1lPT09YX0pO3JldHVybiB2b2lkIDAhPT1iP2IudmFsdWU6ITF9cmV0dXJuITF9O2EucHJvdG90eXBlLmdldFZEQUZlYXR1cmVWYWx1ZT1mdW5jdGlvbihhKXtyZXR1cm4gdm9pZCAwIT09dGhpcy52ZGFmZWF0dXJlc18uZmluZChmdW5jdGlvbihiKXtyZXR1cm4gYj09PVxyXG5hfSk/ITA6ITF9O2EucHJvdG90eXBlLm9uUmVkaXJlY3Rpb25Db21wbGV0ZT1mdW5jdGlvbigpe2Zvcig7dGhpcy5kZWZlcnJlZEFjdGlvbnMmJjA8dGhpcy5kZWZlcnJlZEFjdGlvbnMubGVuZ3RoOyl0aGlzLmRlZmVycmVkQWN0aW9ucy5zaGlmdCgpLnBvc3QodGhpcy5zdGF0dXM9PXYuUmVkaXJlY3RlZCl9O2EucHJvdG90eXBlLmNvbm5lY3RUb1NlcnZpY2U9ZnVuY3Rpb24oKXt1LmxvZ2dlci5sb2coXCJSZWRpcmVjdGlvbiBzdGF0dXM6IENvbm5lY3RpbmcuLi5cIik7dGhpcy5zdGF0dXM9di5Db25uZWN0aW5nO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihhLGIpe3ZhciBkPW5ldyBXZWJTb2NrZXQoXCJ3c3M6Ly8xMjcuMC4wLjE6OTAwMlwiKTtkLm9ub3Blbj1mdW5jdGlvbigpe2EoZCl9O2Qub25lcnJvcj1mdW5jdGlvbihhKXt1LmxvZ2dlci5sb2coXCJ3ZWJzb2NrZXQgY29ubmVjdGlvbiBlcnJvcjogXCIrYS50eXBlKTtiKGEpfX0pfTthLnByb3RvdHlwZS53YWl0VW50aWxSZWRpcmVjdGVkPVxyXG5mdW5jdGlvbihhKXt2YXIgYj10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihkLGMpe2Iuc3RhdHVzPT12LlJlZGlyZWN0ZWQ/ZCgpOjA+PWE/YygpOnNldFRpbWVvdXQoZnVuY3Rpb24oKXt1LmxvZ2dlci5sb2coXCJ3YWl0VW50aWxSZWRpcmVjdGVkKCkgdGltZW91dC4gY291bnQ9XCIrYSk7Yi5zdGF0dXMhPXYuUmVkaXJlY3RlZD9iLndhaXRVbnRpbFJlZGlyZWN0ZWQoLS1hKS50aGVuKGZ1bmN0aW9uKCl7ZCgpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2MoKX0pOmQoKX0sMkUzKX0pfTthLnByb3RvdHlwZS5oYW5kbGVSZW1vdGVTZXNzaW9uSW5mbz1mdW5jdGlvbigpe3ZhciBhPXRoaXM7dS5sb2dnZXIubG9nKFwiaGFuZGxlUmVtb3RlU2Vzc2lvbkluZm8gY2FsbGVkLlwiKTt2YXIgYj10aGlzO2IucmVtb3RlU2Vzc2lvbkluZm9DYj9iLnJlbW90ZVNlc3Npb25JbmZvQ2IoKS50aGVuKGZ1bmN0aW9uKGQpe3UubG9nZ2VyLmxvZyhcInJlbW90ZVNlc3Npb25JbmZvIHN1Y2Nlc3MhIGluZm86XCIrXHJcbkpTT04uc3RyaW5naWZ5KGQpKTt1LmxvZ2dlci5sb2coXCJSZWRpcmVjdGlvbiBzdGF0dXM6IFJlZGlyZWN0ZWRcIik7Yi5zdGF0dXM9di5SZWRpcmVjdGVkO2IucGluZ0Nvbm5lY3Rpb25FbmQoKTsoZD13aW5kb3cub25WZGlDbGllbnRDb25uZWN0ZWQpJiZkKCk7YS50ZWxlbWV0cnkuU2VuZFRlbGVtZXRyeUluaXQoKTtiLm9uUmVkaXJlY3Rpb25Db21wbGV0ZSgpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe3UubG9nZ2VyLmxvZyhcInJlbW90ZVNlc3Npb25JbmZvIGZhaWx1cmUhXCIpO2Iuc3VzcGVuZFJlZGlyZWN0aW9uKCEwKTtiLm9uUmVkaXJlY3Rpb25Db21wbGV0ZSgpfSk6KHUubG9nZ2VyLmxvZyhcInJlbW90ZVNlc3Npb25JbmZvQ2IgaXMgaW52YWxpZCFcIiksYi5zdXNwZW5kUmVkaXJlY3Rpb24oITApLGIub25SZWRpcmVjdGlvbkNvbXBsZXRlKCkpfTthLnByb3RvdHlwZS5zdGFydFJlZGlyZWN0aW9uPWZ1bmN0aW9uKGEsYil7dmFyIGQ9dGhpcyxjPXdpbmRvdy5vblZkaUNsaWVudERpc2Nvbm5lY3RlZDtcclxucmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGcsayl7ZC5zdGF0dXMhPXYuUmVkaXJlY3RlZD8odS5sb2dnZXIubG9nKFwiQXR0ZW1wdGluZyB0byBzdGFydCByZWRpcmVjdGlvbjogXCIrYiksITE9PT1hP2QuZGVmZXJyZWRBY3Rpb25zLnB1c2gobmV3IGUuZGVmZXJyZWRfYWN0aW9uKGcsayxiKSk6ZC5jb25uZWN0VG9TZXJ2aWNlKCkudGhlbihmdW5jdGlvbihhKXt1LmxvZ2dlci5sb2coXCJSZWRpcmVjdGlvbiBzdGF0dXM6IEJpbmRpbmcuLi5cIik7ZC5zdGF0dXM9di5CaW5kaW5nO2Qud2Vic29ja2V0PWE7ZC53ZWJzb2NrZXQub25tZXNzYWdlPWZ1bmN0aW9uKGEpe2Qub25XU01lc3NhZ2UoYSl9O2Qud2Vic29ja2V0Lm9uY2xvc2U9ZnVuY3Rpb24oYSl7ZC5vbldTQ2xvc2UoYSl9O2coKTtkLmhhbmRsZVJlbW90ZVNlc3Npb25JbmZvKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe3UubG9nZ2VyLmxvZyhcIlVuYWJsZSB0byBjb25uZWN0IHRvIHdlYnNvY2tldCBzZXJ2aWNlISBcIithKTtcclxuaygpO2Quc3VzcGVuZFJlZGlyZWN0aW9uKCEwKTtkLm9uUmVkaXJlY3Rpb25Db21wbGV0ZSgpO2MmJmMoITApfSkpOih1LmxvZ2dlci5sb2coXCJSZWRpcmVjdGlvbiBhbHJlYWR5IHN0YXJ0ZWQuXCIpLGcoKSl9KX07YS5wcm90b3R5cGUudGVybWluYXRlT3B0aW1pemF0aW9uPWZ1bmN0aW9uKCl7dGhpcy53ZWJzb2NrZXQuY2xvc2UoMUUzLFwibm9ybWFsIGRpc2Nvbm5lY3RpbmchXCIpfTthLnByb3RvdHlwZS5zdXNwZW5kUmVkaXJlY3Rpb249ZnVuY3Rpb24oYSl7dmFyIGI9dGhpczt1LmxvZ2dlci5sb2coXCJTdXNwZW5kaW5nIHJlZGlyZWN0aW9uLlwiKTt0aGlzLmhhbmRsZXJzXy5mb3JFYWNoKGZ1bmN0aW9uKGEsYil7YS5yZXNldCgpfSk7dmFyIGQ9d2luZG93Lm9uVmRpQ2xpZW50RGlzY29ubmVjdGVkO3RyeXtkJiZkKCExKX1jYXRjaChjKXt1LmxvZ2dlci5sb2coXCJzdXNwZW5kUmVkaXJlY3Rpb24oKTogZXhjZXB0aW9uIGR1cmluZyB2ZGlDbGllbnREaXNjb25uZWN0OiBcIitjLm1lc3NhZ2UpfXUubG9nZ2VyLmxvZyhcIlJlZGlyZWN0aW9uIHN0YXR1czogTm90UmVkaXJlY3RlZFwiKTtcclxudmFyIGc9dGhpcy5zdGF0dXM7dGhpcy5zdGF0dXM9di5Ob3RSZWRpcmVjdGVkO3ZhciBrPSExLGQ9d2luZG93LmdldENpdHJpeE1TVGVhbXNSZWRpcix4PXdpbmRvdy5nZXRDaXRyaXhXZWJydGNSZWRpcixyO2Q/cj1kOngmJihyPXgpO3ImJnIoKS50aGVuKGZ1bmN0aW9uKGQpe3UubG9nZ2VyLmxvZyhcInN1Y2Vzc3Mgb24gZGlzY29ubmVjdFwiK2QpO1wiMVwiPT1kJiYoaz0hMCx1LmxvZ2dlci5sb2coXCJSZWcga2V5IGV4aXN0cyB3aGlsZSBkaXNjb25uZWN0aW5nXCIpKTthJiZnPT09di5SZWRpcmVjdGVkJiYxPT1rJiYodS5sb2dnZXIubG9nKFwiQ2FsbGluZyBwaW5nIG5vdCBub3JtYWwgZGlzY29ubmVjdFwiKSxiLnBpbmdDb25uZWN0aW9uQmVnaW4oITEpKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXt1LmxvZ2dlci5sb2coXCJGYWlsdXJlIHRvIFJlYWQgTVMgVGVhbXMgcmVkaXIgUmVnIEtleSwgbm90IHJldHJ5aW5nLi4uXCIpfSk7dGhpcy5kaXNwYXRjaFN0YXRlQ2hhbmdlTm90aWZpY2F0aW9ucygpfTtcclxuYS5wcm90b3R5cGUub25XU09wZW49ZnVuY3Rpb24oKXt9O2EucHJvdG90eXBlLm9uV1NDbG9zZT1mdW5jdGlvbihhKXt1LmxvZ2dlci5sb2coXCJkaXNjb25uZWN0ZWQgZnJvbSB3ZWJzb2NrZXQgc2VydmljZS4gXCIrSlNPTi5zdHJpbmdpZnkoYSkpO3RyeXthJiYxRTM9PWEuY29kZT90aGlzLnN1c3BlbmRSZWRpcmVjdGlvbighMSk6dGhpcy5zdXNwZW5kUmVkaXJlY3Rpb24oITApfWNhdGNoKGIpe3UubG9nZ2VyLmxvZyhcInN1c3BlbmRSZWRpcmVjdGlvbigpOiBleGNlcHRpb24gY2xvc2luZyBXZWJTb2NrZXQ6IFwiK2IubWVzc2FnZSl9fTthLnByb3RvdHlwZS5vbldTRXJyb3I9ZnVuY3Rpb24oKXt0cnl7dGhpcy5zdXNwZW5kUmVkaXJlY3Rpb24oITApfWNhdGNoKGEpe3UubG9nZ2VyLmxvZyhcInN1c3BlbmRSZWRpcmVjdGlvbigpOiBleGNlcHRpb24gb24gV2ViU29ja2V0IGVycm9yOiBcIithLm1lc3NhZ2UpfX07YS5wcm90b3R5cGUuV1NTZW5kT2JqZWN0V3JhcHBlcj1mdW5jdGlvbihhLFxyXG5iLGQsYyl7dmFyIGc9ITA7YiE9aC5jbGFzc19pZF90LkVuZ2luZUNvbnRyb2x8fGQhPWgubWV0aG9kX2lkX0VuZ2luZUNvbnRyb2xfdC5jdG9yJiZkIT1oLm1ldGhvZF9pZF9FbmdpbmVDb250cm9sX3QudmVyc2lvbiYmZCE9aC5tZXRob2RfaWRfRW5naW5lQ29udHJvbF90LmZlYXR1cmVfZmxhZ3N8fChnPSExKTt2YXIgaz0hMDtpZihnJiYoaz0hMSx2b2lkIDAhPXRoaXMuZmVhdHVyZXMpKWZvcih2YXIgZz0wLHI9dGhpcy5mZWF0dXJlcztnPHIubGVuZ3RoO2crKyl7dmFyIEE9cltnXTtpZighMD09PUEudmFsdWUmJkEubmFtZT09YSl7az0hMDticmVha319cmV0dXJuIDE9PWs/dGhpcy5XU1NlbmRPYmplY3QoYyk6UHJvbWlzZS5yZWplY3QoXCJDYW5ub3QgaW52b2tlIG1ldGhvZCB0aGF0IGlzIG5vdCBzdXBwb3J0ZWQgYnkgd2VicnBjOiBpaWQoXCIrYitcIikgbWlkKFwiK2QrXCIpXCIpfTthLnByb3RvdHlwZS5XU1NlbmRPYmplY3Q9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oZCxcclxuYyl7aWYoXCJ3ZWJydGNcIj09YS52KXt2YXIgZz1hLmhkci5wcm9jLmlpZCxrPWEuaGRyLnByb2MubWV0aG9kaWQscj1hLm9ianJlZi5vaWQ7YS5oZHIuZGVzdHJveXx8KGc9bmV3IG4oZCxjLGcsciwwLCEwLGspLGIucmVxcy5wdXNoKGcpKTtnPUpTT04uc3RyaW5naWZ5KGEpO3UubG9nZ2VyLnRyYWNlKFwiV1NTZW5kT2JqZWN0OiA+Pj4gXCIraC5XZWJycGNDbGFzc0xpYkluZm9VdGlsLmNvbXBvc2VDbGFzc0luZm9EYXRhKGEpK1wiIFwiK2cpO3RyeXtiLndlYnNvY2tldC5yZWFkeVN0YXRlPT1XZWJTb2NrZXQuT1BFTj9iLndlYnNvY2tldC5zZW5kKGcpOih1LmxvZ2dlci5sb2coXCJXU1NlbmRPYmplY3QoKTogd2FyaW5pZzogd2ViIHNvY2tldCBpcyBub3Qgb3BlbiwgZHJvcHBpbmcgdGhlIG1lc3NhZ2UhXCIpLGQoe30pKX1jYXRjaChBKXt1LmxvZ2dlci5sb2coXCJXU1NlbmRPYmplY3QoKTogZXhjZXB0aW9uOiBcIitBLm1lc3NhZ2UpLGMoQS5tZXNzYWdlKX19ZWxzZSBpZihcIm92ZXJsYXlcIj09XHJcbmEudil7Zz1KU09OLnN0cmluZ2lmeShhKTt1LmxvZ2dlci5sb2coXCJIRFhNUzogU2VuZE92ZXJsYXlEYXRhOiA+Pj4gXCIrZytcIidcIik7dHJ5e2Iud2Vic29ja2V0LnJlYWR5U3RhdGU9PVdlYlNvY2tldC5PUEVOP2Iud2Vic29ja2V0LnNlbmQoZyk6KHUubG9nZ2VyLmxvZyhcIldTU2VuZE9iamVjdCgpOiB3YXJpbmlnOiB3ZWIgc29ja2V0IGlzIG5vdCBvcGVuLCBkcm9wcGluZyB0aGUgbWVzc2FnZSFcIiksZCh7fSkpfWNhdGNoKEEpe3UubG9nZ2VyLmxvZyhcIldTU2VuZE9iamVjdCgpOiBleGNlcHRpb246IFwiK0EubWVzc2FnZSksYyhBLm1lc3NhZ2UpfX1lbHNlIGlmKFwidGVsZW1ldHJ5XCI9PWEudil7Zz1KU09OLnN0cmluZ2lmeShhKTt1LmxvZ2dlci5sb2coXCJIRFhNUzogU2VuZFRlbGVtZXRyeURhdGE6ID4+PiBcIitnK1wiJ1wiKTt0cnl7Yi53ZWJzb2NrZXQucmVhZHlTdGF0ZT09V2ViU29ja2V0Lk9QRU4/Yi53ZWJzb2NrZXQuc2VuZChnKToodS5sb2dnZXIubG9nKFwiV1NTZW5kT2JqZWN0KCk6IHdhcmluaWc6IHdlYiBzb2NrZXQgaXMgbm90IG9wZW4sIGRyb3BwaW5nIHRoZSBtZXNzYWdlIVwiKSxcclxuZCh7fSkpfWNhdGNoKEEpe3UubG9nZ2VyLmxvZyhcIldTU2VuZE9iamVjdCgpOiBleGNlcHRpb246IFwiK0EubWVzc2FnZSksYyhBLm1lc3NhZ2UpfX1lbHNlIGlmKFwiYXBwc2hhcmluZ1wiPT1hLnYpe2c9SlNPTi5zdHJpbmdpZnkoYSk7dS5sb2dnZXIubG9nKFwiSERYTVM6IFNlbmRTY3JlZW5TaGFyaW5nRGF0YTogPj4+IFwiK2crXCInXCIpO3RyeXtiLndlYnNvY2tldC5yZWFkeVN0YXRlPT1XZWJTb2NrZXQuT1BFTj9iLndlYnNvY2tldC5zZW5kKGcpOih1LmxvZ2dlci5sb2coXCJXU1NlbmRPYmplY3QoKTogd2FyaW5pZzogd2ViIHNvY2tldCBpcyBub3Qgb3BlbiwgZHJvcHBpbmcgdGhlIG1lc3NhZ2UhXCIpLGQoe30pKX1jYXRjaChBKXt1LmxvZ2dlci5sb2coXCJXU1NlbmRPYmplY3QoKTogZXhjZXB0aW9uOiBcIitBLm1lc3NhZ2UpLGMoQS5tZXNzYWdlKX19ZWxzZSB1LmxvZ2dlci5sb2coXCJIRFhNUzogV1NTZW5kT2JqZWN0OiBVbmtub3duIHByb3RvY29sOiAnXCIrSlNPTi5zdHJpbmdpZnkoYSkrXHJcblwiJ1wiKX0pfTthLnByb3RvdHlwZS53ZWJycGNTdGF0dXNDb2RlVG9OYW1lPWZ1bmN0aW9uKGEpe3N3aXRjaChhKXtjYXNlIGsucnBjX3N0YXR1c19zdWNjZXNzOmE9XCJycGNfc3RhdHVzX3N1Y2Nlc3NcIjticmVhaztjYXNlIGsucnBjX3N0YXR1c191bnNwZWNpZmllZF9lcnJvcjphPVwicnBjX3N0YXR1c191bnNwZWNpZmllZF9lcnJvclwiO2JyZWFrO2Nhc2Ugay5ycGNfc3RhdHVzX3VuZXhwZWN0ZWQ6YT1cInJwY19zdGF0dXNfdW5leHBlY3RlZFwiO2JyZWFrO2Nhc2Ugay5ycGNfc3RhdHVzX2luZGV4X291dF9vZl9ib3VuZHM6YT1cInJwY19zdGF0dXNfaW5kZXhfb3V0X29mX2JvdW5kc1wiO2JyZWFrO2Nhc2Ugay5ycGNfc3RhdHVzX21pc3NpbmdfcGFyYW1ldGVyOmE9XCJycGNfc3RhdHVzX21pc3NpbmdfcGFyYW1ldGVyXCI7YnJlYWs7Y2FzZSBrLnJwY19zdGF0dXNfbWlzc2luZ19yZXR1cm5fdmFsdWU6YT1cInJwY19zdGF0dXNfbWlzc2luZ19yZXR1cm5fdmFsdWVcIjticmVhaztjYXNlIGsucnBjX3N0YXR1c19pbnZhbGlkX29iamVjdDphPVxyXG5cInJwY19zdGF0dXNfaW52YWxpZF9vYmplY3RcIjticmVhaztjYXNlIGsucnBjX3N0YXR1c191c2VyX2V4Y2VwdGlvbjphPVwicnBjX3N0YXR1c191c2VyX2V4Y2VwdGlvblwiO2JyZWFrO2Nhc2Ugay5ycGNfc3RhdHVzX3N5c3RlbV9lcnJvcjphPVwicnBjX3N0YXR1c19zeXN0ZW1fZXJyb3JcIjticmVhaztkZWZhdWx0OmE9XCJ1bmtub3duXCJ9cmV0dXJuIGF9O2EucHJvdG90eXBlLnBhcmNlV2VicnBjRXJyb3I9ZnVuY3Rpb24oYSxiKXt2b2lkIDA9PT1hJiYoYT1iJiYwPGIubGVuZ3RoP2JbMF0uY2F0ZWdvcnl8fGJbMF0uY29kZXx8YlswXS5tZXNzYWdlP2sucnBjX3N0YXR1c19zeXN0ZW1fZXJyb3I6ay5ycGNfc3RhdHVzX3VzZXJfZXhjZXB0aW9uOmsucnBjX3N0YXR1c191bnNwZWNpZmllZF9lcnJvcik7dmFyIGQ7c3dpdGNoKGEpe2Nhc2Ugay5ycGNfc3RhdHVzX3Vuc3BlY2lmaWVkX2Vycm9yOmNhc2Ugay5ycGNfc3RhdHVzX3VuZXhwZWN0ZWQ6Y2FzZSBrLnJwY19zdGF0dXNfaW5kZXhfb3V0X29mX2JvdW5kczpjYXNlIGsucnBjX3N0YXR1c19taXNzaW5nX3BhcmFtZXRlcjpjYXNlIGsucnBjX3N0YXR1c19taXNzaW5nX3JldHVybl92YWx1ZTpjYXNlIGsucnBjX3N0YXR1c19pbnZhbGlkX29iamVjdDpkPVxyXG5uZXcgRE9NRXhjZXB0aW9uKHRoaXMud2VicnBjU3RhdHVzQ29kZVRvTmFtZShhKSx0aGlzLndlYnJwY1N0YXR1c0NvZGVUb05hbWUoYSkpO2JyZWFrO2Nhc2Ugay5ycGNfc3RhdHVzX3VzZXJfZXhjZXB0aW9uOmQ9YiYmMDxiLmxlbmd0aD9uZXcgRE9NRXhjZXB0aW9uKGJbMF0sdGhpcy53ZWJycGNTdGF0dXNDb2RlVG9OYW1lKGEpKTpuZXcgRE9NRXhjZXB0aW9uKHRoaXMud2VicnBjU3RhdHVzQ29kZVRvTmFtZShhKSx0aGlzLndlYnJwY1N0YXR1c0NvZGVUb05hbWUoYSkpO2JyZWFrO2Nhc2Ugay5ycGNfc3RhdHVzX3N5c3RlbV9lcnJvcjppZihiJiYwPGIubGVuZ3RoKXtkPU9iamVjdC5jcmVhdGUoRE9NRXhjZXB0aW9uKTt2YXIgZz17dmFsdWU6bnVsbCx3cml0YWJsZTohMCxlbnVtZXJhYmxlOiExLENvbmZpZ3VyYWJsZTohMH07Zy52YWx1ZT1iWzBdLmNhdGVnb3J5O09iamVjdC5kZWZpbmVQcm9wZXJ0eShkLFwibmFtZVwiLGcpO2cudmFsdWU9YlswXS5jb2RlO09iamVjdC5kZWZpbmVQcm9wZXJ0eShkLFxyXG5cImNvZGVcIixnKTtnLnZhbHVlPWJbMF0ubWVzc2FnZTtPYmplY3QuZGVmaW5lUHJvcGVydHkoZCxcIm1lc3NhZ2VcIixnKX1lbHNlIGQ9bmV3IERPTUV4Y2VwdGlvbih0aGlzLndlYnJwY1N0YXR1c0NvZGVUb05hbWUoYSksdGhpcy53ZWJycGNTdGF0dXNDb2RlVG9OYW1lKGEpKX1yZXR1cm4gZH07YS5wcm90b3R5cGUub25XU01lc3NhZ2U9ZnVuY3Rpb24oYSl7YT1hLmRhdGE7dmFyIGI7dHJ5e2I9SlNPTi5wYXJzZShhKX1jYXRjaChnKXt1LmxvZ2dlci5sb2coXCJpbnZhbGlkIEpTT04hISFcIik7dS5sb2dnZXIubG9nKGcpO3UubG9nZ2VyLmxvZyhhKTtyZXR1cm59aWYoXCJ3ZWJydGNcIj09Yi52KXt1LmxvZ2dlci50cmFjZShcIm9uV1NNZXNzYWdlOiA8PDwgXCIraC5XZWJycGNDbGFzc0xpYkluZm9VdGlsLmNvbXBvc2VDbGFzc0luZm9EYXRhKGIpK1wiIFwiK2EpO3ZhciBjPWIuaGRyLnByb2MuaWlkLGs9Yi5oZHIucHJvYy5tZXRob2RpZCxlPWIub2JqcmVmLm9pZCx4PWIuc3RhdHVzO2lmKGIuaGRyLm1zZ190eXBlPT1cclxuZC5Xc0pzb25VdGlsLmdldE1zZ1R5cGUoZC53c19tc2dfdHlwZV90LnJlcGx5KSlhPXRoaXMucmVxcy5maW5kSW5kZXgoZnVuY3Rpb24oYSl7cmV0dXJuIGEuaWlkPT1jJiZhLm9pZD09ZSYmYS5taWQ9PWt9KSwwPD1hPzA9PXg/dGhpcy5yZXFzLnNwbGljZShhLDEpLnNoaWZ0KCkucmVzb2x2ZShiKTooeD10aGlzLnBhcmNlV2VicnBjRXJyb3IoeCxiLnBhcmFtcyksdGhpcy5yZXFzLnNwbGljZShhLDEpLnNoaWZ0KCkucmVqZWN0KHgpKToodS5sb2dnZXIubG9nKFwiSERYTVMgZGlkbnQgZmluZCB0aGlzIG9uZS4gKHJlcXMpXCIpLHUubG9nZ2VyLmxvZyh0aGlzLnJlcXMpKTtlbHNlIGlmKGIuaGRyLm1zZ190eXBlPT1kLldzSnNvblV0aWwuZ2V0TXNnVHlwZShkLndzX21zZ190eXBlX3QuZXZlbnRfcmVxKSl7dmFyIHI9Yi5mdW5jLmlkO2E9dGhpcy5jYnMuZmluZEluZGV4KGZ1bmN0aW9uKGEpe3JldHVybiBhLmlpZD09YyYmYS5vaWQ9PWUmJmEuY2JpZD09cj4+MTZ9KTswPD1hPygwPT1cclxuKHImNjU1MzUpP3RoaXMuY2JzW2FdLnJlc29sdmUoYik6KHg9dGhpcy5wYXJjZVdlYnJwY0Vycm9yKHgsYi5wYXJhbXMpLHRoaXMuY2JzW2FdLnJlamVjdCh4KSksMT09dGhpcy5jYnNbYV0ub25lU2hvdCYmKHRoaXMuY2JzW2FdLmNvbXBsZXRpb25fY2I/dGhpcy5jYnNbYV0uY29tcGxldGlvbl9jYih0aGlzLmNic1thXS5jYmlkLHRoaXMuY2JzW2FdLm1pZCk6dS5sb2dnZXIubG9nKFwiSERYTVMgZGlkbnQgZmluZCBjb21wbGV0aW9uX2NiIGZvciBvbmVTaG90IGNhbGxiYWNrLCBzb21ldGhpbmcgd2VudCB3cm9uZyEhISEgY2JpZD1cIit0aGlzLmNic1thXS5jYmlkK1wiIChpaWQsIG1pZCk9KFwiK3RoaXMuY2JzW2FdLmlpZCxcIixcIit0aGlzLmNic1thXS5taWQrXCIpXCIpKSk6KHUubG9nZ2VyLmxvZyhcIkhEWE1TIGRpZG50IGZpbmQgdGhpcyBvbmUuIChjYnMpXCIpLHUubG9nZ2VyLmxvZyhKU09OLnN0cmluZ2lmeSh0aGlzLmNicykpKX1lbHNlIHUubG9nZ2VyLmxvZyhcIkhEWE1TIFJlY2VpdmVkIGJvZ3VzIG1lc3NhZ2U6IFwiK1xyXG5hK1wiJ1wiKX1lbHNlIGlmKFwidGVsZW1ldHJ5XCI9PWIudikwPT1iLnN0YXR1cyYmKHg9Yi5oZHIuY29tbWFuZCwyPT0oeCYyMTQ3NDgzNjQ3KSYmKGE9Yi5oZHIuaWQsdGhpcy50ZWxlbWV0cnkub25Jbml0aWFsaXplZChhKSx1LmxvZ2dlci5sb2coXCJUZWxlbWV0cnkgaW5pdCByZXNwb25zZSByZWNlaXZlZFwiKSkpO2Vsc2UgaWYoXCJmZWF0dXJlc1wiPT1iLnYpe2E9Yi5mZWF0dXJlcztpZihcImZlYXR1cmUtc3VwcG9ydFwiPT1iLmNvbW1hbmQpZm9yKHUubG9nZ2VyLmxvZyhcImZlYXR1cmVzIGNhcGFiaWxpdGllcyByZWNlaXZlZCwgZmVhdHVyZXM6XCIrYSksdGhpcy52ZGFmZWF0dXJlc189YSx4PTA7eDxhLmxlbmd0aDt4KyspaWYoYVt4XT09PWguRkVBVFVSRV92ZGFfYXBwX3NoYXJpbmcpdGhpcy5zY3JlZW5zaGFyZS5vbkluaXRpYWxpemVkKCEwKTt0aGlzLmNsaWVudFZpZXdwb3J0TW9kZV89Yi5jbGllbnRfdmlld3BvcnRfbW9kZTt1LmxvZ2dlci5sb2coXCJmZWF0dXJlcyBjbGllbnRfdmlld3BvcnRfbW9kZSB2YWx1ZTogXCIrXHJcbnRoaXMuY2xpZW50Vmlld3BvcnRNb2RlXyk7dGhpcy5zZXNzaW9uSWRfPWIuY2xpZW50X3Nlc3Npb25faWR9ZWxzZSBpZihcImFwcHNoYXJpbmdcIj09Yi52KWE9Yi5zdGF0dXMsMD09YT8oeD1iLmhkci5jb21tYW5kLGE9Yi5oZHIuaWQsKHgmMjE0NzQ4MzY0Nyk9PXEuc3NoYXJlX2NtZC5HZXRTb3VyY2VzPyh1LmxvZ2dlci5sb2coXCJhcHBzaGFyaW5nIEdldFNvdXJjZXMgcmVzcG9uc2UgcmVjZWl2ZWRcIikseD1iLmRhdGEsdGhpcy5zY3JlZW5zaGFyZS5vbkdldFNvdXJjZXMoYSx4KSk6KHgmMjE0NzQ4MzY0Nyk9PXEuc3NoYXJlX2NtZC5TZXRBY3RpdmU/KHUubG9nZ2VyLmxvZyhcImFwcHNoYXJpbmcgU2V0QWN0aXZlIHJlc3BvbnNlIHJlY2VpdmVkXCIpLHg9Yi5kYXRhLHRoaXMuc2NyZWVuc2hhcmUub25TZXRBY3RpdmUoYSx4KSk6KHgmMjE0NzQ4MzY0Nyk9PXEuc3NoYXJlX2NtZC5Ub3BvbG9neUNoYW5nZWQ/KHUubG9nZ2VyLmxvZyhcImFwcHNoYXJpbmcgV2luZG93IHRvcG9sb2d5IGNoYW5nZWQgY21kIHJlY2VpdmVkXCIpLFxyXG50aGlzLnNjcmVlbnNoYXJlLm9uVG9wbG9neUNoYW5nZWQoKSk6KHUubG9nZ2VyLmxvZyhcImludmFsaWQgY29tbWFuZCByZXBseTpcIit4KSx0aGlzLnNjcmVlbnNoYXJlLm9uRXJyb3IoYSkpKToodS5sb2dnZXIubG9nKFwiaW52YWxpZCBzdGF0dXMgcmVwbHk6XCIrYSksYT1iLmhkci5pZCx0aGlzLnNjcmVlbnNoYXJlLm9uRXJyb3IoYSkpO2Vsc2UgaWYoeD10aGlzLmhhbmRsZXJzXy5maW5kKGZ1bmN0aW9uKGEpe3JldHVybiBhLm5hbWU9PWIudn0pLHZvaWQgMCE9eCl4Lm9uX21lc3NhZ2UoYik7ZWxzZSB1LmxvZ2dlci5sb2coXCJIRFhNUzogb25XU01lc3NhZ2U6IFVua25vd24gcHJvdG9jb2w6IFwiK2ErXCInXCIpfTthLnByb3RvdHlwZS5jbGVhclJlcXM9ZnVuY3Rpb24oKXt1LmxvZ2dlci5sb2coXCJjbGVhclJlcXMoKVwiKTt0aGlzLnJlcXMuZm9yRWFjaChmdW5jdGlvbihhLGIpe2EucmVqZWN0KCl9KTt0aGlzLnJlcXM9W119O2EucHJvdG90eXBlLnJlZ2lzdGVySGFuZGxlcj1mdW5jdGlvbihhLFxyXG5iLGQsZyl7YT1uZXcgbihnLnJlc29sdmUuYmluZChnKSxnLnJlamVjdC5iaW5kKGcpLGEsYixnLmlkLGcub25lU2hvdCxkLGcuY29tcGxldGlvbl9jYik7dGhpcy5jYnMucHVzaChhKX07YS5wcm90b3R5cGUudW5yZWdpc3RlckhhbmRsZXI9ZnVuY3Rpb24oYSxiLGQpe3ZhciBnPXRoaXMuY2JzLmZpbmRJbmRleChmdW5jdGlvbihnKXtyZXR1cm4gZy5paWQ9PWEmJmcub2lkPT1iJiZnLmNiaWQ9PWR9KTswPD1nP3RoaXMuY2JzLnNwbGljZShnLDEpOih1LmxvZ2dlci5sb2coXCJIRFhNUyBEaWRudCBmaW5kIHRoaXMgY2FsbGJhY2sgaW4gdGhlIGxpc3QhXCIpLHUubG9nZ2VyLmxvZyhKU09OLnN0cmluZ2lmeSh0aGlzLmNicykpKX07YS5wcm90b3R5cGUuaXNSZWRpcmVjdGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdHVzPT09di5SZWRpcmVjdGVkfHx0aGlzLnN0YXR1cz09PXYuQmluZGluZ3x8dGhpcy5zdGF0dXM9PT12LkNvbm5lY3Rpbmd9O2EucHJvdG90eXBlLmlzQ29ubmVjdGVkPVxyXG5mdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXR1cz09di5SZWRpcmVjdGVkfTthLnByb3RvdHlwZS5pc1BpbmdBY3RpdmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5waW5nYWN0aXZlfTthLnByb3RvdHlwZS5waW5nQ29ubmVjdGlvbkJlZ2luPWZ1bmN0aW9uKGEpe3UubG9nZ2VyLmxvZyhcIlN0YXJ0ZWQgdGltZXJcIik7dGhpcy5waW5nYWN0aXZlPSEwO3ZhciBiPXdpbmRvdy5vblZkaUNsaWVudERpc2Nvbm5lY3RlZFRpbWVyOzE9PWE/KHUubG9nZ2VyLmxvZyhcImNoZWNraW5nIGlmIHdlIGFyZSBjb25uZWN0ZWQuLi5cIiksYigpKTp0aGlzLmNvbm50aW1lcj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dS5sb2dnZXIubG9nKFwiY2hlY2tpbmcgaWYgd2UgYXJlIGNvbm5lY3RlZC4uLlwiKTtiJiZiKCl9LDE1RTMpfTthLnByb3RvdHlwZS5waW5nQ29ubmVjdGlvbkVuZD1mdW5jdGlvbigpe3RoaXMucGluZ2FjdGl2ZT0hMTtjbGVhclRpbWVvdXQodGhpcy5jb25udGltZXIpfTthLnByb3RvdHlwZS5TZW5kVGVsZW1ldHJ5RGF0YV9TcGVha2VyPVxyXG5mdW5jdGlvbihhKXt0aGlzLnRlbGVtZXRyeS5TZW5kVGVsZW1ldHJ5RGF0YSh3LnRlbF9jbWQuRGF0YSx3LnRlbF9rZXlfU3BlYWtlckRldmljZVVzZWQsYSwwKX07YS5wcm90b3R5cGUucmVnaXN0ZXJTdGF0ZUNoYW5nZU5vdGlmaWNhdGlvbj1mdW5jdGlvbihhKXt0aGlzLnN0YXRlQ2hhbmdlTm90aWZjYXRpb25zLnB1c2goYSl9O2EucHJvdG90eXBlLnVucmVnaXN0ZXJTdGF0ZUNoYW5nZU5vdGlmaWNhdGlvbj1mdW5jdGlvbihhKXt0aGlzLnN0YXRlQ2hhbmdlTm90aWZjYXRpb25zPXRoaXMuc3RhdGVDaGFuZ2VOb3RpZmNhdGlvbnMuZmlsdGVyKGZ1bmN0aW9uKGIpe3JldHVybiBiIT1hfSl9O2EucHJvdG90eXBlLmRpc3BhdGNoU3RhdGVDaGFuZ2VOb3RpZmljYXRpb25zPWZ1bmN0aW9uKCl7dGhpcy5zdGF0ZUNoYW5nZU5vdGlmY2F0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGEpe2EoKX0pfTthLnByb3RvdHlwZS52ZGFidWZmZXJOb0xpbWl0PWZ1bmN0aW9uKCl7Zm9yKHZhciBhPSExLFxyXG5iPTAsZD10aGlzLnZkYWZlYXR1cmVzXztiPGQubGVuZ3RoO2IrKylpZihkW2JdPT09aC5GRUFUVVJFX3ZkYV9zZXJ2aWNlX25vX2J1ZmZlcl9saW1pdCl7YT0hMDticmVha31yZXR1cm4gYX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwiY2xpZW50Vmlld3BvcnRNb2RlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNsaWVudFZpZXdwb3J0TW9kZV98fFwidW5rbm93blwifSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLnByb3RvdHlwZSxcInNlc3Npb25DbGllbnRJZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZXNzaW9uSWRffHxcIlwifSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO2EucHJvdG90eXBlLmFkZFByb3RvY29sSGFuZGxlcj1mdW5jdGlvbihhKXt2b2lkIDA9PXRoaXMuaGFuZGxlcnNfLmZpbmQoZnVuY3Rpb24oYil7cmV0dXJuIGIubmFtZT09YS5uYW1lfSkmJnRoaXMuaGFuZGxlcnNfLnB1c2goYSl9O1xyXG5yZXR1cm4gYX0oKTthLkhkeE1lZGlhU3RyZWFtPWI7dmFyIHo9bmV3IGI7YS5nZXRSZWRpcmVjdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIHp9fSw5ODU6ZnVuY3Rpb24oYixhLGMpe3ZhciBlPXRoaXMmJnRoaXMuX19leHRlbmRzfHxmdW5jdGlvbigpe3ZhciBhPWZ1bmN0aW9uKGIsZCl7YT1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oYSxiKXthLl9fcHJvdG9fXz1ifXx8ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGQgaW4gYiliLmhhc093blByb3BlcnR5KGQpJiYoYVtkXT1iW2RdKX07cmV0dXJuIGEoYixkKX07cmV0dXJuIGZ1bmN0aW9uKGIsZCl7ZnVuY3Rpb24gYygpe3RoaXMuY29uc3RydWN0b3I9Yn1hKGIsZCk7Yi5wcm90b3R5cGU9bnVsbD09PWQ/T2JqZWN0LmNyZWF0ZShkKTooYy5wcm90b3R5cGU9ZC5wcm90b3R5cGUsbmV3IGMpfX0oKSx1PXRoaXMmJnRoaXMuX19zcHJlYWRBcnJheXN8fGZ1bmN0aW9uKCl7Zm9yKHZhciBhPVxyXG4wLGI9MCxkPWFyZ3VtZW50cy5sZW5ndGg7YjxkO2IrKylhKz1hcmd1bWVudHNbYl0ubGVuZ3RoO2Zvcih2YXIgYT1BcnJheShhKSxjPTAsYj0wO2I8ZDtiKyspZm9yKHZhciBlPWFyZ3VtZW50c1tiXSxnPTAsaD1lLmxlbmd0aDtnPGg7ZysrLGMrKylhW2NdPWVbZ107cmV0dXJuIGF9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO2EuSWNlQ2FuZGlkYXRlUGFpcj1hLkljZUNhbmRpZGF0ZT12b2lkIDA7dmFyIGg9Yyg2NTgpLGQ9Yyg1NTApLHc9Yyg4NTEpO2I9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjLGUseil7Zm9yKHZhciBnPVtdLGg9MztoPGFyZ3VtZW50cy5sZW5ndGg7aCsrKWdbaC0zXT1hcmd1bWVudHNbaF07cmV0dXJuIGEuYXBwbHkodGhpcyx1KFtjLGQuY2xhc3NfaWRfdC5SVENJY2VDYW5kaWRhdGUsZSx6LG51bGwsW11dLGcpKXx8dGhpc31lKGIsYSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwiY2FuZGlkYXRlXCIsXHJcbntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jYW5kaWRhdGVffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInNkcE1pZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZHBNaWRffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInNkcE1MaW5lSW5kZXhcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2RwTUxpbmVJbmRleF99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3cubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllcigpIGNhbGxlZC5cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGIsYyl7YS5zeW5jQmFycmllckRlZXAoYixjKSYmYS53YWl0VW50aWxDb25uZWN0ZWQoXCJJY2VDYW5kaWRhdGUuc3luY0JhcnJpZXJcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEsXHJcbmQubWV0aG9kX2lkX1JUQ0ljZUNhbmRpZGF0ZV90LmNhbmRpZGF0ZSxcIlwiKSxhLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9SVENJY2VDYW5kaWRhdGVfdC5zZHBNaWQsXCJcIiksYS5yZW1vdGVJbnZva2UoITEsZC5tZXRob2RfaWRfUlRDSWNlQ2FuZGlkYXRlX3Quc2RwTUxpbmVJbmRleCwwKV0pfSkudGhlbihmdW5jdGlvbihiKXtiPWIubWFwKGZ1bmN0aW9uKGIpe3JldHVybiBhLnBhcmFtMChiKX0pO2EuY2FuZGlkYXRlXz1iWzBdO2Euc2RwTWlkXz1iWzFdO2Euc2RwTUxpbmVJbmRleF89YlsyXTthLnN5bmNCYXJyaWVyUmVzb2x2ZShhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7Yj1hLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuc3luY0JhcnJpZXIgZmFpbGVkIVwiKTthLnN5bmNCYXJyaWVyUmVqZWN0KGIpfSl9KX07cmV0dXJuIGJ9KGguUHJveHlPYmplY3QpO2EuSWNlQ2FuZGlkYXRlPWI7Yj1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKGMsZSl7cmV0dXJuIGEuY2FsbCh0aGlzLFxyXG5jLGQuY2xhc3NfaWRfdC5SVENJY2VDYW5kaWRhdGVQYWlyLGUsaC5Qcm94eU1vZGUuUmVtb3RlKXx8dGhpc31lKGIsYSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwibG9jYWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubG9jYWxffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInJlbW90ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZW1vdGVffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLnN5bmNCYXJyaWVyPWZ1bmN0aW9uKCl7dmFyIGE9dGhpczt3LmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2Euc3luY0JhcnJpZXJEZWVwKGIsYykmJmEud2FpdFVudGlsQ29ubmVjdGVkKFwiSWNlQ2FuZGlkYXRlUGFpci5zeW5jQmFycmllclwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFthLnJlbW90ZUludm9rZSghMSxcclxuZC5tZXRob2RfaWRfUlRDSWNlQ2FuZGlkYXRlUGFpcl90LmxvY2FsLHt9KSxhLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9SVENJY2VDYW5kaWRhdGVQYWlyX3QucmVtb3RlLHt9KV0pfSkudGhlbihmdW5jdGlvbihiKXtiPWIubWFwKGZ1bmN0aW9uKGIpe3JldHVybiBhLnBhcmFtMChiKX0pO2EubG9jYWxfPWJbMF07YS5yZW1vdGVfPWJbMV07YS5zeW5jQmFycmllclJlc29sdmUoYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2I9YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLnN5bmNCYXJyaWVyIGZhaWxlZCFcIik7YS5zeW5jQmFycmllclJlamVjdChiKX0pfSl9O3JldHVybiBifShoLlByb3h5T2JqZWN0KTthLkljZUNhbmRpZGF0ZVBhaXI9Yn0sODUxOmZ1bmN0aW9uKGIsYSxjKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTthLmxvZ2dlcj1hLkxvZ2dlcj12b2lkIDA7dmFyIGU9Yyg1NTApO2I9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIpe3RoaXMudHJhY2luZz1cclxuITE7dGhpcy5tc2xvZ2dlcl89dm9pZCAwO3RoaXMuZW5hYmxlX3RpbWVzdGFtcF89ITE7dGhpcy50YWc9Yjt0aGlzLmVuYWJsZWQ9ITA7ZS5CVUlMRF9UWVBFX1NESyYmKHRoaXMuZW5hYmxlX3RpbWVzdGFtcF89ITApfWEucHJvdG90eXBlLnNldE1TTG9nZ2VyPWZ1bmN0aW9uKGEsYil7dGhpcy5tc2xvZ2dlcl89YTt2b2lkIDAhPWImJih0aGlzLmVuYWJsZV90aW1lc3RhbXBfPWIpfTthLnByb3RvdHlwZS5sb2c9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wO2I8YXJndW1lbnRzLmxlbmd0aDtiKyspYVtiXT1hcmd1bWVudHNbYl07dGhpcy5lbmFibGVkJiYoYT10aGlzLnRhZytcIiBcIithLHRoaXMuZW5hYmxlX3RpbWVzdGFtcF8mJihiPW5ldyBEYXRlLGE9XCJbXCIrYi5nZXRUaW1lKCkrXCJdIFwiK2IudG9JU09TdHJpbmcoKStcIiBcIithKSx2b2lkIDAhPXRoaXMubXNsb2dnZXJfP3RoaXMubXNsb2dnZXJfLmluZm8oYSk6Y29uc29sZS5sb2coYSkpfTthLnByb3RvdHlwZS5sb2d4PWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1cclxuW10sYz0xO2M8YXJndW1lbnRzLmxlbmd0aDtjKyspYltjLTFdPWFyZ3VtZW50c1tjXTthfHx0aGlzLmxvZyhiKX07YS5wcm90b3R5cGUudHJhY2U9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wO2I8YXJndW1lbnRzLmxlbmd0aDtiKyspYVtiXT1hcmd1bWVudHNbYl07dGhpcy50cmFjaW5nJiZ0aGlzLmxvZy5hcHBseSh0aGlzLGEpfTtyZXR1cm4gYX0oKTthLkxvZ2dlcj1iO2EubG9nZ2VyPW5ldyBiKFwiW0hkeFdlYlJUQy5qc11cIik7YS5sb2dnZXIuZW5hYmxlZD0hMH0sMzYwOmZ1bmN0aW9uKGIsYSxjKXt2YXIgZT10aGlzJiZ0aGlzLl9fZXh0ZW5kc3x8ZnVuY3Rpb24oKXt2YXIgYT1mdW5jdGlvbihiLGQpe2E9T2JqZWN0LnNldFByb3RvdHlwZU9mfHx7X19wcm90b19fOltdfWluc3RhbmNlb2YgQXJyYXkmJmZ1bmN0aW9uKGEsYil7YS5fX3Byb3RvX189Yn18fGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBkIGluIGIpYi5oYXNPd25Qcm9wZXJ0eShkKSYmKGFbZF09YltkXSl9O3JldHVybiBhKGIsXHJcbmQpfTtyZXR1cm4gZnVuY3Rpb24oYixkKXtmdW5jdGlvbiBmKCl7dGhpcy5jb25zdHJ1Y3Rvcj1ifWEoYixkKTtiLnByb3RvdHlwZT1udWxsPT09ZD9PYmplY3QuY3JlYXRlKGQpOihmLnByb3RvdHlwZT1kLnByb3RvdHlwZSxuZXcgZil9fSgpLHU9dGhpcyYmdGhpcy5fX2F3YWl0ZXJ8fGZ1bmN0aW9uKGEsYixkLGYpe2Z1bmN0aW9uIGMoYSl7cmV0dXJuIGEgaW5zdGFuY2VvZiBkP2E6bmV3IGQoZnVuY3Rpb24oZil7ZihhKX0pfXJldHVybiBuZXcgKGR8fChkPVByb21pc2UpKShmdW5jdGlvbihkLEspe2Z1bmN0aW9uIGcoYSl7dHJ5e20oZi5uZXh0KGEpKX1jYXRjaChiKXtLKGIpfX1mdW5jdGlvbiByKGEpe3RyeXttKGZbXCJ0aHJvd1wiXShhKSl9Y2F0Y2goYil7SyhiKX19ZnVuY3Rpb24gbShhKXthLmRvbmU/ZChhLnZhbHVlKTpjKGEudmFsdWUpLnRoZW4oZyxyKX1tKChmPWYuYXBwbHkoYSxifHxbXSkpLm5leHQoKSl9KX0saD10aGlzJiZ0aGlzLl9fZ2VuZXJhdG9yfHxmdW5jdGlvbihhLFxyXG5iKXtmdW5jdGlvbiBkKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gZihbYSxiXSl9fWZ1bmN0aW9uIGYoZil7aWYoZyl0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtmb3IoO2M7KXRyeXtpZihnPTEsciYmKG09ZlswXSYyP3JbXCJyZXR1cm5cIl06ZlswXT9yW1widGhyb3dcIl18fCgobT1yW1wicmV0dXJuXCJdKSYmbS5jYWxsKHIpLDApOnIubmV4dCkmJiEobT1tLmNhbGwocixmWzFdKSkuZG9uZSlyZXR1cm4gbTtpZihyPTAsbSlmPVtmWzBdJjIsbS52YWx1ZV07c3dpdGNoKGZbMF0pe2Nhc2UgMDpjYXNlIDE6bT1mO2JyZWFrO2Nhc2UgNDpyZXR1cm4gYy5sYWJlbCsrLHt2YWx1ZTpmWzFdLGRvbmU6ITF9O2Nhc2UgNTpjLmxhYmVsKys7cj1mWzFdO2Y9WzBdO2NvbnRpbnVlO2Nhc2UgNzpmPWMub3BzLnBvcCgpO2MudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEobT1jLnRyeXMsbT0wPG0ubGVuZ3RoJiZtW20ubGVuZ3RoLVxyXG4xXSkmJig2PT09ZlswXXx8Mj09PWZbMF0pKXtjPTA7Y29udGludWV9aWYoMz09PWZbMF0mJighbXx8ZlsxXT5tWzBdJiZmWzFdPG1bM10pKWMubGFiZWw9ZlsxXTtlbHNlIGlmKDY9PT1mWzBdJiZjLmxhYmVsPG1bMV0pYy5sYWJlbD1tWzFdLG09ZjtlbHNlIGlmKG0mJmMubGFiZWw8bVsyXSljLmxhYmVsPW1bMl0sYy5vcHMucHVzaChmKTtlbHNle21bMl0mJmMub3BzLnBvcCgpO2MudHJ5cy5wb3AoKTtjb250aW51ZX19Zj1iLmNhbGwoYSxjKX1jYXRjaChkKXtmPVs2LGRdLHI9MH1maW5hbGx5e2c9bT0wfWlmKGZbMF0mNSl0aHJvdyBmWzFdO3JldHVybnt2YWx1ZTpmWzBdP2ZbMV06dm9pZCAwLGRvbmU6ITB9fXZhciBjPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZihtWzBdJjEpdGhyb3cgbVsxXTtyZXR1cm4gbVsxXX0sdHJ5czpbXSxvcHM6W119LGcscixtLGU7JGpzY29tcC5pbml0U3ltYm9sKCk7JGpzY29tcC5pbml0U3ltYm9sKCk7JGpzY29tcC5pbml0U3ltYm9sSXRlcmF0b3IoKTtcclxucmV0dXJuIGU9e25leHQ6ZCgwKSxcInRocm93XCI6ZCgxKSxcInJldHVyblwiOmQoMil9LFwiZnVuY3Rpb25cIj09PXR5cGVvZiBTeW1ib2wmJihlW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLGV9LGQ9dGhpcyYmdGhpcy5fX3NwcmVhZEFycmF5c3x8ZnVuY3Rpb24oKXtmb3IodmFyIGE9MCxiPTAsZD1hcmd1bWVudHMubGVuZ3RoO2I8ZDtiKyspYSs9YXJndW1lbnRzW2JdLmxlbmd0aDtmb3IodmFyIGE9QXJyYXkoYSksZj0wLGI9MDtiPGQ7YisrKWZvcih2YXIgYz1hcmd1bWVudHNbYl0sZz0wLHI9Yy5sZW5ndGg7ZzxyO2crKyxmKyspYVtmXT1jW2ddO3JldHVybiBhfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTthLlBlZXJDb25uZWN0aW9uPWEuU2Vzc2lvbkRlc2NyaXB0aW9uPWEuU2Vzc2lvbkRlc2NyaXB0aW9uSW5pdD1hLlJ0Y0NvbmZpZ3VyYXRpb249YS5SdGNJY2VTZXJ2ZXI9YS5JY2VDYW5kaWRhdGVFdmVudD1cclxudm9pZCAwO3ZhciB3PWMoOTQ2KSxxPWMoMTQ0KSxuPWMoNTg5KSxrPWMoNjU4KSx2PWMoOTg1KSx6PWMoMzc3KSxnPWMoNjUwKSxCPWMoMjQpLHQ9Yyg1NTApLG09Yyg4NTEpLEQ9Yyg1MTcpLHk9YygzOTQpLHg9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihkLGYsYyl7ZD1hLmNhbGwodGhpcyxkLHQuY2xhc3NfaWRfdC5SVENJY2VDYW5kaWRhdGVFdmVudCxmLGsuUHJveHlNb2RlLlJlbW90ZSl8fHRoaXM7ZC50YXJnZXQ9YztkLnR5cGU9XCJpY2VjYW5kaWRhdGVcIjtyZXR1cm4gZH1lKGIsYSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwiY2FuZGlkYXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNhbmRpZGF0ZV99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllcigpIGNhbGxlZC5cIik7XHJcbnJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihmLGIpe2Euc3luY0JhcnJpZXJEZWVwKGYsYikmJmEud2FpdFVudGlsQ29ubmVjdGVkKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYS5yZW1vdGVJbnZva2UoITEsdC5tZXRob2RfaWRfUlRDSWNlQ2FuZGlkYXRlRXZlbnRfdC5jYW5kaWRhdGUse29pZDowfSl9KS50aGVuKGZ1bmN0aW9uKGYpe2Y9YS5wYXJhbTAoZik7cmV0dXJuITE9PT1mLmlzX251bGw/KG5ldyB2LkljZUNhbmRpZGF0ZShhLGYub2lkLGsuUHJveHlNb2RlLlJlbW90ZSkpLnN5bmNCYXJyaWVyKCk6UHJvbWlzZS5yZXNvbHZlKG51bGwpfSkudGhlbihmdW5jdGlvbihmKXttLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25pY2VjYW5kaWRhdGU6IGljZWNhbmRpZGF0ZSBhdmFpbGFibGUhXCIpO2EuY2FuZGlkYXRlXz1mO2Euc3luY0JhcnJpZXJSZXNvbHZlKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihmKXtmPVxyXG5hLmxvZ1JlbW90ZUludm9rZUVycm9yKGYsXCIub25pY2VjYW5kaWRhdGUoKSBmYWlsZWQhXCIpO2Euc3luY0JhcnJpZXJSZWplY3QoZil9KX0pfTtyZXR1cm4gYn0oay5Qcm94eU9iamVjdCk7YS5JY2VDYW5kaWRhdGVFdmVudD14O3ZhciByPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQpe3RoaXMuc3RhdGVfPVwibmV3XCI7dGhpcy5jYW5kaWRhdGVzXz1bXTt0aGlzLmdhdGhlcmluZ3N0YXRldXBkYXRlY2JfPXZvaWQgMDt0aGlzLnBjXz1iO3RoaXMuZ2F0aGVyaW5nc3RhdGV1cGRhdGVjYl89ZH1hLnByb3RvdHlwZS5wdXNoU3RhdGU9ZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKHRoaXMucGNfLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlOiBuZXcgc3RhdGUgaXMgXCIrYSk7dGhpcy5zdGF0ZV89YTtcImdhdGhlcmluZ1wiPT10aGlzLnN0YXRlXz8odGhpcy5jYW5kaWRhdGVzXz1bXSx0aGlzLnBvc3RVcGRhdGUoKSk6dGhpcy5wcm9jZXNzUmVtYWluaW5nKCl9O1xyXG5hLnByb3RvdHlwZS5hZGRJY2VDYW5kaWRhdGU9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpczt0aGlzLmNhbmRpZGF0ZXNfLnB1c2goYSk7dmFyIGY9W107Zi5wdXNoKGEuc3luY0JhcnJpZXIoKSk7Zi5wdXNoKHRoaXMucGNfLnVwZGF0ZVNkcERlc2NyaXB0aW9uKCEwKSk7UHJvbWlzZS5hbGwoZikudGhlbihmdW5jdGlvbihhKXttLmxvZ2dlci5sb2coYi5wY18udXNlcl9mcmllbmRseV9pZCgpK1wiLm9uaWNlY2FuZGlkYXRlOiBpY2VjYW5kaWRhdGUgYXZhaWxhYmxlIVwiKTtiLnBvc3RJY2VDYW5kaWRhdGUoYVswXSl9KX07YS5wcm90b3R5cGUucG9zdEljZUNhbmRpZGF0ZT1mdW5jdGlvbihhKXttLmxvZ2dlci5sb2codGhpcy5wY18udXNlcl9mcmllbmRseV9pZCgpK1wiLm9uaWNlY2FuZGlkYXRlOiBwb3N0aW5nIGljZSBjYW5kaWRhdGUgbm93IVwiKTtpZihudWxsIT10aGlzLnBjXy5vbmljZWNhbmRpZGF0ZSl0aGlzLnBjXy5vbmljZWNhbmRpZGF0ZShhKTtlbHNlIG0ubG9nZ2VyLmxvZyh0aGlzLnBjXy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwib25pY2VjYW5kaWRhdGUgaXMgTlVMTCEhIVwiKTt0aGlzLmNhbmRpZGF0ZXNfLnNoaWZ0KCk7dGhpcy5wcm9jZXNzUmVtYWluaW5nKCl9O2EucHJvdG90eXBlLnBvc3RVcGRhdGU9ZnVuY3Rpb24oKXttLmxvZ2dlci5sb2codGhpcy5wY18udXNlcl9mcmllbmRseV9pZCgpK1wiLm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2U6IHBvc3RpbmcgZXZlbnQgbm93IVwiKTt2YXIgYT1uZXcgcChcIm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2VcIix0aGlzLnBjXyk7dGhpcy5nYXRoZXJpbmdzdGF0ZXVwZGF0ZWNiXyYmdGhpcy5nYXRoZXJpbmdzdGF0ZXVwZGF0ZWNiXyh0aGlzLnN0YXRlXyk7dGhpcy5wY18ub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZShhKX07YS5wcm90b3R5cGUucHJvY2Vzc1JlbWFpbmluZz1mdW5jdGlvbigpezA9PXRoaXMuY2FuZGlkYXRlc18ubGVuZ3RoJiZcImNvbXBsZXRlXCI9PXRoaXMuc3RhdGVfPyh0aGlzLnBjXy5vbmljZWNhbmRpZGF0ZSh7Y2FuZGlkYXRlOm51bGwsdGFyZ2V0OnRoaXN9KSxcclxudGhpcy5wb3N0VXBkYXRlKCkpOm0ubG9nZ2VyLmxvZyh0aGlzLnBjXy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25pY2VjYW5kaWRhdGU6IGNhbmRpZGF0ZXMgcmVtYWluaW5nPVtcIit0aGlzLmNhbmRpZGF0ZXNfLm1hcChmdW5jdGlvbihhKXtyZXR1cm4gYS5vYmplY3RfaWQoKX0pK1wiXSwgc3RhdGU9XCIrdGhpcy5zdGF0ZV8pfTtyZXR1cm4gYX0oKSxBPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe31hLnRvUnRjSWNlU2VydmVyPWZ1bmN0aW9uKGEsYil7dmFyIGY9e3VybHM6W10sY3JlZGVudGlhbDpcIlwiLHVzZXJuYW1lOlwiXCJ9O2EmJihhLnVybHM/QXJyYXkuaXNBcnJheShhLnVybHMpP2YudXJscz1hLnVybHM6Zi51cmxzLnB1c2goYS51cmxzKTptLmxvZ2dlci5sb2coXCJSdGNJY2VTZXJ2ZXIudG9SdGNJY2VTZXJ2ZXIoKS51cmxzIHByb3BlcnR5IGlzIG1pc3NpbmchIHRoaXMgaXMgcmVxdWlyZWQgcHJvcGVydHkhXCIpLGEuY3JlZGVudGlhbCYmKGEuY3JlZGVudGlhbC5oYXNPd25Qcm9wZXJ0eShcImFjY2Vzc1Rva2VuXCIpP1xyXG5mLmNyZWRlbnRpYWw9YS5jcmVkZW50aWFsLmFjY2Vzc1Rva2VuOmYuY3JlZGVudGlhbD1hLmNyZWRlbnRpYWwpLGEudXNlcm5hbWUmJihmLnVzZXJuYW1lPWEudXNlcm5hbWUpKTtpZigxPT1iKWZvcih2YXIgZCBpbiBhKVwidXJsc1wiIT1kJiZcImNyZWRlbnRpYWxcIiE9ZCYmXCJ1c2VybmFtZVwiIT1kJiZtLmxvZ2dlci5sb2coXCJSdGNJY2VTZXJ2ZXIudG9SdGNJY2VTZXJ2ZXIoKSB3YXJuaW5nOiB1bnN1cHBvcnRlZCBwcm9wZXJ0eTpcIitkKTtyZXR1cm4gZn07cmV0dXJuIGF9KCk7YS5SdGNJY2VTZXJ2ZXI9QTt2YXIgTT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt9YS50b1J0Y0NvbmZpZ3VyYXRpb249ZnVuY3Rpb24oYSxiKXsxPT1iJiZtLmxvZ2dlci5sb2coXCJSdGNDb25maWd1cmF0aW9uLnRvUnRjQ29uZmlndXJhdGlvbigpIGluIFJUQ0NvbmZpZ3VyYXRpb24gY29uZmlnOlwiK0pTT04uc3RyaW5naWZ5KGEpKTt2YXIgZj17fTtpZihhKXtpZihhLmljZVNlcnZlcnMpe2YuaWNlU2VydmVycz1cclxuW107Zm9yKHZhciBkPTAsYz1hLmljZVNlcnZlcnM7ZDxjLmxlbmd0aDtkKyspZi5pY2VTZXJ2ZXJzLnB1c2goQS50b1J0Y0ljZVNlcnZlcihjW2RdLGIpKX1hLmljZVRyYW5zcG9ydFBvbGljeSYmKGYuaWNlVHJhbnNwb3J0UG9saWN5PWEuaWNlVHJhbnNwb3J0UG9saWN5KTthLmJ1bmRsZVBvbGljeSYmKGYuYnVuZGxlUG9saWN5PWEuYnVuZGxlUG9saWN5KTthLnJ0Y3BNdXhQb2xpY3kmJihmLnJ0Y3BNdXhQb2xpY3k9YS5ydGNwTXV4UG9saWN5KTthLmljZVRyYW5zcG9ydHMmJihmLmljZVRyYW5zcG9ydHM9YS5pY2VUcmFuc3BvcnRzKTthLnNkcFNlbWFudGljcyYmKGYuc2RwU2VtYW50aWNzPWEuc2RwU2VtYW50aWNzKTthLmVuYWJsZUR0bHNTcnRwJiYoZi5lbmFibGVEdGxzU3J0cD1hLmVuYWJsZUR0bHNTcnRwKTthLmVuYWJsZURzY3AmJihmLmVuYWJsZURzY3A9YS5lbmFibGVEc2NwKX1pZigxPT1iKXtmb3IodmFyIGcgaW4gYSlcImljZVNlcnZlcnNcIiE9ZyYmXCJpY2VUcmFuc3BvcnRQb2xpY3lcIiE9XHJcbmcmJlwiYnVuZGxlUG9saWN5XCIhPWcmJlwicnRjcE11eFBvbGljeVwiIT1nJiZcImljZVRyYW5zcG9ydHNcIiE9ZyYmXCJzZHBTZW1hbnRpY3NcIiE9ZyYmXCJlbmFibGVEdGxzU3J0cFwiIT1nJiZcImVuYWJsZURzY3BcIiE9ZyYmbS5sb2dnZXIubG9nKFwiUnRjQ29uZmlndXJhdGlvbi50b1J0Y0NvbmZpZ3VyYXRpb24oKSB3YXJuaW5nOiB1bnN1cHBvcnRlZCBwcm9wZXJ0eTpcIitnKTttLmxvZ2dlci5sb2coXCJSdGNDb25maWd1cmF0aW9uLnRvUnRjQ29uZmlndXJhdGlvbigpIGNvbnZlcnRlZCBSdGNDb25maWd1cmF0aW9uIGNvbmZpZzpcIitKU09OLnN0cmluZ2lmeShmKSl9cmV0dXJuIGZ9O3JldHVybiBhfSgpO2EuUnRjQ29uZmlndXJhdGlvbj1NO3ZhciBGPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYil7dGhpcy5zZHA9Yjt0aGlzLnR5cGU9YX19KCk7YS5TZXNzaW9uRGVzY3JpcHRpb25Jbml0PUY7dmFyIGw9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjLGYsZyl7Zm9yKHZhciByPVtdLG09MzttPFxyXG5hcmd1bWVudHMubGVuZ3RoO20rKylyW20tM109YXJndW1lbnRzW21dO3JldHVybiBhLmFwcGx5KHRoaXMsZChbYyx0LmNsYXNzX2lkX3QuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uLGYsZyxudWxsLFtdXSxyKSl8fHRoaXN9ZShiLGEpO2IucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybnt0eXBlOnRoaXMudHlwZV8sc2RwOnRoaXMuc2RwX319O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInNkcFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZHBffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInR5cGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHlwZV99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllcigpIGNhbGxlZC5cIik7XHJcbnJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihmLGIpe2Euc3luY0JhcnJpZXJEZWVwKGYsYikmJmEud2FpdFVudGlsQ29ubmVjdGVkKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5hbGwoW2EucmVtb3RlSW52b2tlKCExLHQubWV0aG9kX2lkX1JUQ1Nlc3Npb25EZXNjcmlwdGlvbl90LnR5cGUsMCksYS5yZW1vdGVJbnZva2UoITEsdC5tZXRob2RfaWRfUlRDU2Vzc2lvbkRlc2NyaXB0aW9uX3Quc2RwLFwiXCIpXSl9KS50aGVuKGZ1bmN0aW9uKGYpe2EudHlwZV89YS5jb252ZXJ0VHlwZShhLnBhcmFtMChmWzBdKSk7YS5zZHBfPWEucGFyYW0wKGZbMV0pO2Euc3luY0JhcnJpZXJSZXNvbHZlKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihmKXtmPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoZixcIi5zeW5jQmFycmllcigpIGZhaWxlZCFcIik7YS5zeW5jQmFycmllclJlamVjdChmKX0pfSl9O2IucHJvdG90eXBlLmNvbnZlcnRUeXBlPVxyXG5mdW5jdGlvbihhKXtyZXR1cm4gMD09YT9cIm9mZmVyXCI6MT09YT9cInByYW5zd2VyXCI6Mj09YT9cImFuc3dlclwiOlwicm9sbGJhY2tcIn07Yi5jb252ZXJ0QzJIPWZ1bmN0aW9uKGEpe3JldHVyblwib2ZmZXJcIj09YT8wOlwicHJhbnN3ZXJcIj09YT8xOlwiYW5zd2VyXCI9PWE/MjozfTtyZXR1cm4gYn0oay5Qcm94eU9iamVjdCk7YS5TZXNzaW9uRGVzY3JpcHRpb249bDt2YXIgcD1mdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihhLGIpe3RoaXMudHlwZT1hO3RoaXMudGFyZ2V0PWJ9fSgpLEw9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oKXt9fSgpLFA9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCl7dGhpcy5sb2NhbD1iO3RoaXMucmVtb3RlPWR9T2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwiYWN0aXZlXCIse2dldDpmdW5jdGlvbigpe3ZhciBhPSExO2lmKDE9PXRoaXMubG9jYWx8fDE9PXRoaXMucmVtb3RlKWE9ITA7cmV0dXJuIGF9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7XHJcbnJldHVybiBhfSgpO2I9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihkKXt2YXIgZj1hLmNhbGwodGhpcyxudWxsLHQuY2xhc3NfaWRfdC5SVENQZWVyQ29ubmVjdGlvbiwwLGsuUHJveHlNb2RlLkxvY2FsLG51bGwsW10sYi5lbnN1cmVfY29uZmlnX2RlZmluZWQoZCwhMSkse30pfHx0aGlzO2YudGltZWVyc3RhcnRlZF89ITE7Zi5maXJzdHRpbWVyZW1vdGVvZmZlcl89ITE7Zi5maXJzdHN0YWJsZV89ITE7Zi5maXJzdHRpbWVsb2NhbG9mZmVyXz0hMTtmLmF1ZGlvY2FsbF89bmV3IFAoITEsITEpO2YudmlkZW9jYWxsXz1uZXcgUCghMSwhMSk7Zi5zY3JlZW5zaGFyaW5nY2FsbF89bmV3IFAoITEsITEpO2YuY29uZmVyZW5jZWNhbGxfPSExO2YuaW5jb21pbmdjYWxsXz0hMTtmLm91dGdvaW5nY2FsbF89ITE7Zi51c2luZ2FzeW5jb25seV89ITE7Zi5ydGNjb25maWdfPWIuZW5zdXJlX2NvbmZpZ19kZWZpbmVkKGQsITApO20ubG9nZ2VyLmxvZyhmLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jb25zdHJ1Y3RvciBzZHBTZW1hbnRpY3M9XCIrXHJcbmYucnRjY29uZmlnXy5zZHBTZW1hbnRpY3MpO2lmKCF0LkJVSUxEX1RZUEVfU0RLJiZmLmlzVW5pZmllZCgpJiYhdy5nZXRSZWRpcmVjdG9yKCkuZ2V0RmVhdHVyZVZhbHVlKHQuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDApKXRocm93IG5ldyBET01FeGNlcHRpb24oXCJDV0EgY2xpZW50IGRvZXMgbm90IHN1cHBvcnQgdW5pZmllZCBzZHBTZW1hbnRpY1wiLFwiY3JlYXRlUGVlckNvbm5lY3Rpb25cIik7Zi5wZW5kaW5ndHJhbnNjZWl2ZXJfPTA7Zi5wZW5kaW5ndHJhY2tfPTA7Zi5kZWZlcnJlZE9mZmVyQW5zd2Vycz1bXTtmLmxvY2FsU3RyZWFtcz1bXTtmLnJlbW90ZVN0cmVhbXM9W107Zi5vbmFkZHN0cmVhbV89bnVsbDtmLnNpZ25hbGluZ1N0YXRlXz1cInN0YWJsZVwiO2YuaWNlQ29ubmVjdGlvblN0YXRlXz1cIm5ld1wiO2YuaWNlR2F0aGVyaW5nU3RhdGVfPVwibmV3XCI7Zi5pY2VRXz1uZXcgcihmLGZ1bmN0aW9uKGEpe2Yub25pY2VnYXRoZXJpbmdzdGF0ZXVwZGF0ZShhKX0pO2YucmVjZWl2ZXJzXz1cclxuW107Zi5zZW5kZXJzXz1bXTtmLnRyYW5zY2VpdmVyc189W107Zi5yZWdpc3RlclN0YXRlQ2hhbmdlTm90aWZpY2F0aW9uKGYub25TdGF0ZUNoYW5nZSk7Zi5sb2NhbGRhdGFjaGFubmVsXz1udWxsO2YucmVtb3RlZGF0YWNoYW5uZWxfPW51bGw7cmV0dXJuIGZ9ZShiLGEpO2IuZW5zdXJlX2NvbmZpZ19kZWZpbmVkPWZ1bmN0aW9uKGEsZil7cmV0dXJuIE0udG9SdGNDb25maWd1cmF0aW9uKGEsZil9O2IucHJvdG90eXBlLmR1bXBTZHA9ZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmR1bXBTZHBcIik7YSYmKG0ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIiAgLS0gdHlwZTogXCIrYS50eXBlKSxtLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIgIC0tIHNkcDogXCIrYS5zZHApKX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwibG9jYWxEZXNjcmlwdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLmdldF9sb2NhbERlc2NyaXB0aW9uKCkgY2FsbGVkLlwiKTtyZXR1cm4gdGhpcy5sb2NhbERlc2NyaXB0aW9uX30sc2V0OmZ1bmN0aW9uKGEpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfbG9jYWxEZXNjcmlwdGlvbigpIGNhbGxlZC5cIik7dGhpcy5sb2NhbERlc2NyaXB0aW9uXz1hfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInJlbW90ZURlc2NyaXB0aW9uXCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfcmVtb3RlRGVzY3JpcHRpb24oKSBjYWxsZWQuXCIpO3JldHVybiB0aGlzLnJlbW90ZURlc2NyaXB0aW9uX30sc2V0OmZ1bmN0aW9uKGEpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfcmVtb3RlRGVzY3JpcHRpb24oKSBjYWxsZWQuXCIpO3RoaXMucmVtb3RlRGVzY3JpcHRpb25fPWF9LFxyXG5lbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmlzVW5pZmllZD1mdW5jdGlvbigpe3JldHVyblwidW5pZmllZFwiPT10aGlzLnJ0Y2NvbmZpZ18uc2RwU2VtYW50aWNzfHxcInVuaWZpZWQtcGxhblwiPT10aGlzLnJ0Y2NvbmZpZ18uc2RwU2VtYW50aWNzfTtiLnByb3RvdHlwZS5vblN0YXRlQ2hhbmdlPWZ1bmN0aW9uKCl7dmFyIGE9bmV3IHAoXCJpY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2VcIix0aGlzKTtpZih0aGlzLm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlXyl0aGlzLm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlXyhhKX07Yi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlPWZ1bmN0aW9uKGEpe3ZhciBmPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmFkZEljZUNhbmRpZGF0ZSgpIGNhbGxlZC5cIik7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkSWNlQ2FuZGlkYXRlXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYj1cclxue2NhbmRpZGF0ZTphLmNhbmRpZGF0ZSxzZHBNaWQ6YS5zZHBNaWQsc2RwTUxpbmVJbmRleDphLnNkcE1MaW5lSW5kZXh9O2lmKHZvaWQgMD09Yi5jYW5kaWRhdGV8fG51bGw9PWIuY2FuZGlkYXRlKWIuY2FuZGlkYXRlPVwiXCI7dm9pZCAwPT1iLnNkcE1pZCYmKGIuc2RwTWlkPW51bGwpO3ZvaWQgMD09Yi5zZHBNTGluZUluZGV4JiYoYi5zZHBNTGluZUluZGV4PW51bGwpO3JldHVybihuZXcgdi5JY2VDYW5kaWRhdGUoZiwwLGsuUHJveHlNb2RlLkxvY2FsLGIpKS5zeW5jQmFycmllcigpfSkudGhlbihmdW5jdGlvbihhKXtyZXR1cm4gZi5yZW1vdGVJbnZva2VFeCghMSx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmFkZEljZUNhbmRpZGF0ZSxbYV0se30pfSkudGhlbihmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhmLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5hZGRJY2VDYW5kaWRhdGUoKSBzdWNjZXNzLlwiKTtyZXR1cm4gZi51cGRhdGVTZHBEZXNjcmlwdGlvbighMSl9KS50aGVuKGZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKGYudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5hZGRJY2VDYW5kaWRhdGUoKSAtIHN5bmMgcmVtb3RlIHNkcCBzdWNjZXNzLlwiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Zi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLmFkZEljZUNhbmRpZGF0ZSgpIGZhaWxlZCFcIil9KX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25pY2VjYW5kaWRhdGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub25pY2VjYW5kaWRhdGVffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGY9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uaWNlY2FuZGlkYXRlKCkgY2FsbGVkLlwiKTt0aGlzLm9uaWNlY2FuZGlkYXRlXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uaWNlY2FuZGlkYXRlXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYj1mLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGYuaXNOdWxsQ2FsbGJhY2soYSksdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbmljZWNhbmRpZGF0ZSk7XHJcbmIudGhlbihmdW5jdGlvbihhKXttLmxvZ2dlci5sb2coZi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25pY2VjYW5kaWRhdGUgY2FsbGJhY2sgcmVjZWl2ZWQhISFcIik7YT1uZXcgeChmLGYucGFyYW0wKGEpLm9pZCxmKTtudWxsIT1mLmljZVFfJiZmLmljZVFfLmFkZEljZUNhbmRpZGF0ZShhKX0pO3JldHVybiBmLnJlbW90ZUludm9rZSghMCx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90Lm9uaWNlY2FuZGlkYXRlLGIuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2YubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfb25pY2VjYW5kaWRhdGUoKSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuY29udmVydEljZUNvbm5lY3Rpb25TdGF0ZT1mdW5jdGlvbihhKXtyZXR1cm4gMD09YT9cIm5ld1wiOjE9PWE/XCJjaGVja2luZ1wiOjI9PWE/XCJjb25uZWN0ZWRcIjozPT1hP1wiY29tcGxldGVkXCI6ND09YT9cImZhaWxlZFwiOjU9PWE/XHJcblwiZGlzY29ubmVjdGVkXCI6XCJjbG9zZWRcIn07Yi5wcm90b3R5cGUuY29udmVydENvbm5lY3Rpb25TdGF0ZT1mdW5jdGlvbihhKXtpZigwIT1hKXtpZigxPT1hKXJldHVyblwiY29ubmVjdGluZ1wiO2lmKDI9PWEpcmV0dXJuXCJjb25uZWN0ZWRcIjtpZigzPT1hKXJldHVyblwiZGlzY29ubmVjdGVkXCI7aWYoND09YSlyZXR1cm5cImZhaWxlZFwiO2lmKDU9PWEpcmV0dXJuXCJjbG9zZWRcIn1yZXR1cm5cIm5ld1wifTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZV99LHNldDpmdW5jdGlvbihhKXt2YXIgZj10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25jb25uZWN0aW9uc3RhdGVjaGFuZ2UoKSBjYWxsZWQuXCIpO3RoaXMub25jb25uZWN0aW9uc3RhdGVjaGFuZ2VfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYj1mLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGYuaXNOdWxsQ2FsbGJhY2soYSksdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZSk7Yi50aGVuKGZ1bmN0aW9uKGEpe20ubG9nZ2VyLmxvZyhmLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZSgpOiBzdWNjZXNzIGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO2YuY29ubmVjdGlvblN0YXRlXz1mLmNvbnZlcnRDb25uZWN0aW9uU3RhdGUoZi5wYXJhbTAoYSkpO20ubG9nZ2VyLmxvZyhmLnVzZXJfZnJpZW5kbHlfaWQoKStcIiBjb25uZWN0aW9uU3RhdGU9OlwiK2YuY29ubmVjdGlvblN0YXRlXyk7YT1uZXcgcChcImNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLGYpO2lmKGYub25jb25uZWN0aW9uc3RhdGVjaGFuZ2VfKWYub25jb25uZWN0aW9uc3RhdGVjaGFuZ2VfKGEpfSk7cmV0dXJuIGYucmVtb3RlSW52b2tlKCEwLFxyXG50Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90Lm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlLGIuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2YubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfb25jb25uZWN0aW9uc3RhdGVjaGFuZ2UoKSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuZ2V0X2Nvbm5lY3Rpb25TdGF0ZT1mdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfY29ubmVjdGlvblN0YXRlKCkgY2FsbGVkLCB2YWx1ZSA9IFwiK3RoaXMuY29ubmVjdGlvblN0YXRlXyk7cmV0dXJuIHRoaXMuaXNSZWRpcmVjdGVkKCk/dGhpcy5jb25uZWN0aW9uU3RhdGVfOlwiZmFpbGVkXCJ9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlX30sXHJcbnNldDpmdW5jdGlvbihhKXt2YXIgZj10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2UoKSBjYWxsZWQuXCIpO3RoaXMub25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2VfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2VcIikudGhlbihmdW5jdGlvbigpe3ZhciBiPWYucmVnaXN0ZXJDYWxsYmFja3MoITEsZi5pc051bGxDYWxsYmFjayhhKSx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90Lm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlKTtiLnRoZW4oZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKGYudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlKCk6IHN1Y2Nlc3MgY2FsbGJhY2sgcmVjZWl2ZWQhISFcIik7Zi5pY2VDb25uZWN0aW9uU3RhdGVfPWYuY29udmVydEljZUNvbm5lY3Rpb25TdGF0ZShmLnBhcmFtMChhKSk7XHJcbmE9bmV3IHAoXCJpY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2VcIixmKTtpZihmLm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlXylmLm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlXyhhKX0pO3JldHVybiBmLnJlbW90ZUludm9rZSghMCx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90Lm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlLGIuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2YubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfb25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2UoKSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwiaWNlQ29ubmVjdGlvblN0YXRlXCIse2dldDpmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfaWNlQ29ubmVjdGlvblN0YXRlKCkgY2FsbGVkLCB2YWx1ZSA9IFwiK3RoaXMuaWNlQ29ubmVjdGlvblN0YXRlXyk7XHJcbnJldHVybiB0aGlzLmlzUmVkaXJlY3RlZCgpP3RoaXMuaWNlQ29ubmVjdGlvblN0YXRlXzpcImZhaWxlZFwifSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmNvbnZlcnRJY2VHYXRoZXJpbmdTdGF0ZT1mdW5jdGlvbihhKXtyZXR1cm4gMD09YT9cIm5ld1wiOjE9PWE/XCJnYXRoZXJpbmdcIjpcImNvbXBsZXRlXCJ9O2IucHJvdG90eXBlLm9uaWNlZ2F0aGVyaW5nc3RhdGV1cGRhdGU9ZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uaWNlZ2F0aGVyaW5nc3RhdGV1cGRhdGUoKSBjdXJyZW50OlwiK3RoaXMuaWNlR2F0aGVyaW5nU3RhdGVfK1wiIHVwZGF0aW5nIHRvOlwiK2EpO3RoaXMuaWNlR2F0aGVyaW5nU3RhdGVfPWE7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uaWNlZ2F0aGVyaW5nc3RhdGV1cGRhdGUoKSBhZnRlciB1cGRhdGU6IGljZUdhdGhlcmluZ1N0YXRlXzpcIit0aGlzLmljZUdhdGhlcmluZ1N0YXRlXyl9O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2VffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGY9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2UoKSBjYWxsZWQuXCIpO3RoaXMub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZV89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYj1mLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGYuaXNOdWxsQ2FsbGJhY2soYSksdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlKTtiLnRoZW4oZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKGYudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlKCk6IGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO2E9Zi5jb252ZXJ0SWNlR2F0aGVyaW5nU3RhdGUoZi5wYXJhbTAoYSkpO251bGwhPWYuaWNlUV8mJmYuaWNlUV8ucHVzaFN0YXRlKGEpfSk7cmV0dXJuIGYucmVtb3RlSW52b2tlKCEwLHQubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Qub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZSxiLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtmLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0X29uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2UoKSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwiaWNlR2F0aGVyaW5nU3RhdGVcIix7Z2V0OmZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9pY2VHYXRoZXJpbmdTdGF0ZSgpIGNhbGxlZCwgdmFsdWUgPSBcIitcclxudGhpcy5pY2VHYXRoZXJpbmdTdGF0ZV8pO3JldHVybiB0aGlzLmljZUdhdGhlcmluZ1N0YXRlX30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtiLnByb3RvdHlwZS5jb252ZXJ0U2lnbmFsU3RhdGU9ZnVuY3Rpb24oYSl7cmV0dXJuIDA9PWE/XCJzdGFibGVcIjoxPT1hP1wiaGF2ZS1sb2NhbC1vZmZlclwiOjI9PWE/XCJoYXZlLWxvY2FsLXByYW5zd2VyXCI6Mz09YT9cImhhdmUtcmVtb3RlLW9mZmVyXCI6ND09YT9cImhhdmUtcmVtb3RlLXByYW5zd2VyXCI6XCJjbG9zZWRcIn07Yi5wcm90b3R5cGUuVGVsZW10cnlSZWFkaW5nc189ZnVuY3Rpb24oKXt2YXIgYT10aGlzO1wiaGF2ZS1sb2NhbC1vZmZlclwiPT10aGlzLnNpZ25hbGluZ1N0YXRlXyYmMD09dGhpcy5maXJzdHRpbWVsb2NhbG9mZmVyXyYmMD09dGhpcy5maXJzdHRpbWVyZW1vdGVvZmZlcl8mJih0aGlzLm91dGdvaW5nY2FsbHN0YXJ0Xz0obmV3IERhdGUpLmdldFRpbWUoKSwwPT10aGlzLm91dGdvaW5nY2FsbF8mJih0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHkudGVsX2tleV9QZXJmQ2FsbFN0YXRlLFxyXG55LnRlbF9DYWxsU3RhdGUuYWN0aXZlLDEpLHRoaXMuU2VuZFRlbGVtZXRyeURhdGEoeS50ZWxfa2V5X1BlcmZDYWxsRGlyZWN0aW9uLHkudGVsX0NhbGxEaXJlY3Rpb24ub3V0Z29pbmcsMSksdGhpcy5vdXRnb2luZ2NhbGxfPSEwKSx0aGlzLmZpcnN0dGltZWxvY2Fsb2ZmZXJfPSEwKTtcImhhdmUtcmVtb3RlLW9mZmVyXCI9PXRoaXMuc2lnbmFsaW5nU3RhdGVfJiYwPT10aGlzLmZpcnN0dGltZXJlbW90ZW9mZmVyXyYmMD09dGhpcy5maXJzdHRpbWVsb2NhbG9mZmVyXyYmKHRoaXMuaW5jb21pbmdjYWxsc3RhcnRfPShuZXcgRGF0ZSkuZ2V0VGltZSgpLDA9PXRoaXMuaW5jb21pbmdjYWxsXyYmKHRoaXMuU2VuZFRlbGVtZXRyeURhdGEoeS50ZWxfa2V5X1BlcmZDYWxsU3RhdGUseS50ZWxfQ2FsbFN0YXRlLmFjdGl2ZSwxKSx0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHkudGVsX2tleV9QZXJmQ2FsbERpcmVjdGlvbix5LnRlbF9DYWxsRGlyZWN0aW9uLmluY29taW5nLDEpLHRoaXMuaW5jb21pbmdjYWxsXz1cclxuITApLHRoaXMuZmlyc3R0aW1lcmVtb3Rlb2ZmZXJfPSEwKTtcInN0YWJsZVwiPT10aGlzLnNpZ25hbGluZ1N0YXRlXyYmMD09dGhpcy5maXJzdHN0YWJsZV8mJih0aGlzLmNhbGxzdGFydFRpbWVfPShuZXcgRGF0ZSkuZ2V0VGltZSgpLHRoaXMuZmlyc3RzdGFibGVfPXRoaXMudGltZWVyc3RhcnRlZF89ITApO2lmKFwic3RhYmxlXCI9PXRoaXMuc2lnbmFsaW5nU3RhdGVfKXtmb3IodmFyIGY9MCxiPXRoaXMubG9jYWxTdHJlYW1zO2Y8Yi5sZW5ndGg7ZisrKXt2YXIgZD1iW2ZdOzE8PWQuZ2V0QXVkaW9UcmFja3MoKS5sZW5ndGgmJjA9PXRoaXMuYXVkaW9jYWxsXy5sb2NhbCYmKHRoaXMuU2VuZFRlbGVtZXRyeURhdGEoeS50ZWxfa2V5X1BlcmZDYWxsVHlwZSx5LnRlbF9DYWxsVHlwZS5hdWRpbywxKSx0aGlzLmF1ZGlvY2FsbF8ubG9jYWw9ITApO2Q9ZC5nZXRWaWRlb1RyYWNrcygpO2lmKDE8PWQubGVuZ3RoKWZvcih2YXIgYz0wLGc9ZDtjPGcubGVuZ3RoO2MrKylkPWdbY10sMT09ZC5nZXRTZXR0aW5ncygpLmRldmljZUlkLmluY2x1ZGVzKFwiZGlzcGxheVwiKT9cclxuMD09dGhpcy5zY3JlZW5zaGFyaW5nY2FsbF8ubG9jYWwmJih0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHkudGVsX2tleV9QZXJmQ2FsbFR5cGUseS50ZWxfQ2FsbFR5cGUuZHNoYXJlLDEpLHRoaXMuc2NyZWVuc2hhcmluZ2NhbGxfLmxvY2FsPSEwKTowPT10aGlzLnZpZGVvY2FsbF8ubG9jYWwmJih0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHkudGVsX2tleV9QZXJmQ2FsbFR5cGUseS50ZWxfQ2FsbFR5cGUudmlkZW8sMSksdGhpcy52aWRlb2NhbGxfLmxvY2FsPSEwKX1mPTA7Zm9yKGI9dGhpcy5yZW1vdGVTdHJlYW1zO2Y8Yi5sZW5ndGg7ZisrKWlmKGQ9YltmXSwxPD1kLmdldEF1ZGlvVHJhY2tzKCkubGVuZ3RoJiYwPT10aGlzLmF1ZGlvY2FsbF8ucmVtb3RlJiYodGhpcy5TZW5kVGVsZW1ldHJ5RGF0YSh5LnRlbF9rZXlfUGVyZkNhbGxUeXBlLHkudGVsX0NhbGxUeXBlLmF1ZGlvLDEpLHRoaXMuYXVkaW9jYWxsXy5yZW1vdGU9ITApLGM9ZC5nZXRWaWRlb1RyYWNrcygpLDE8PWMubGVuZ3RoKWZvcihkPVxyXG4wO2Q8Yy5sZW5ndGg7ZCsrKTE9PWNbZF0uaWQuaW5jbHVkZXMoXCJhcHBsaWNhdGlvbnNoYXJpbmdWaWRlb1wiKT8wPT10aGlzLnNjcmVlbnNoYXJpbmdjYWxsXy5yZW1vdGUmJih0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHkudGVsX2tleV9QZXJmQ2FsbFR5cGUseS50ZWxfQ2FsbFR5cGUuZHNoYXJlLDEpLHRoaXMuc2NyZWVuc2hhcmluZ2NhbGxfLnJlbW90ZT0hMCk6MD09dGhpcy52aWRlb2NhbGxfLnJlbW90ZSYmKHRoaXMuU2VuZFRlbGVtZXRyeURhdGEoeS50ZWxfa2V5X1BlcmZDYWxsVHlwZSx5LnRlbF9DYWxsVHlwZS52aWRlbywxKSx0aGlzLnZpZGVvY2FsbF8ucmVtb3RlPSEwKTt0aGlzLmdldFJlY2VpdmVyc0FzeW5jKCkudGhlbihmdW5jdGlvbihmKXsyPGYubGVuZ3RoJiYwPT1hLmNvbmZlcmVuY2VjYWxsXyYmKGEuU2VuZFRlbGVtZXRyeURhdGEoeS50ZWxfa2V5X1BlcmZDYWxsVHlwZSx5LnRlbF9DYWxsVHlwZS5tdWx0aSwxKSxhLmNvbmZlcmVuY2VjYWxsXz0hMCl9KX19O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbnNpZ25hbGluZ3N0YXRlY2hhbmdlXCIse3NldDpmdW5jdGlvbihhKXt2YXIgZj10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25zaWduYWxpbmdzdGF0ZWNoYW5nZSgpIGNhbGxlZC5cIik7dGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2VkXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYj1mLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGYuaXNOdWxsQ2FsbGJhY2soYSksdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlKTtiLnRoZW4oZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKGYudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2UoKTogY2FsbGJhY2sgcmVjZWl2ZWQhISFcIik7Zi5zaWduYWxpbmdTdGF0ZV89XHJcbmYuY29udmVydFNpZ25hbFN0YXRlKGYucGFyYW0wKGEpKTthPW5ldyBwKFwib25zaWduYWxpbmdzdGF0ZWNoYW5nZVwiLGYpO2lmKGYub25zaWduYWxpbmdzdGF0ZWNoYW5nZV8pZi5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlXyhhKTtmLlRlbGVtdHJ5UmVhZGluZ3NfKCl9KTtyZXR1cm4gZi5yZW1vdGVJbnZva2UoITAsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlLGIuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2YubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfb25zaWduYWxpbmdzdGF0ZWNoYW5nZSgpIGZhaWxlZCFcIil9KX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbnNpZ25hbGluZ3N0YXRlY2hhbmdlZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlX30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib250cmFja1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbnRyYWNrX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBmPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbnRyYWNrKCkgY2FsbGVkLlwiKTt0aGlzLm9udHJhY2tfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub250cmFja1wiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGI9Zi5yZWdpc3RlckNhbGxiYWNrcyghMSxmLmlzTnVsbENhbGxiYWNrKGEpLHQubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Qub250cmFjayk7Yi50aGVuKGZ1bmN0aW9uKGEpe3JldHVybiB1KGYsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbigpe3ZhciBmLGIsZCxjLHIsSyxDLGUseCxBLHQsdj10aGlzO3JldHVybiBoKHRoaXMsZnVuY3Rpb24oaCl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5vbnRyYWNrKCk6IGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO2Y9bmV3IEw7Yj1bXTtkPXRoaXMucGFyYW0wKGEpO3ZvaWQgMCE9ZC50cmFjayYmITE9PT1kLnRyYWNrLmlzX251bGwmJihtLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIgYWRkaW5nIGEgUmVtb3RlTWVkaWFUcmFjayB3aXRoIG9pZDpcIitkLnRyYWNrLm9pZCksYz1uZXcgcS5SZW1vdGVNZWRpYVRyYWNrKHRoaXMsZC50cmFjay5vaWQpLGIucHVzaChjLnN5bmNCYXJyaWVyKCkpKTtmLnRyYWNrPWM7dm9pZCAwIT1kLnJlY2VpdmVyJiYhMT09PWQucmVjZWl2ZXIuaXNfbnVsbCYmKHI9dGhpcy5yZWNlaXZlcnNfLmZpbmQoZnVuY3Rpb24oYSl7cmV0dXJuIGEub2JqZWN0X2lkKCk9PT1kLnJlY2VpdmVyLm9pZH0pLHZvaWQgMD09PXImJihtLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIgYWRkaW5nIGEgUnRwUmVjZWl2ZXIgd2l0aCBvaWQ6XCIrZC5yZWNlaXZlci5vaWQpLHI9bmV3IG4uUnRwUmVjZWl2ZXIodGhpcyxcclxuZC5yZWNlaXZlci5vaWQsay5Qcm94eU1vZGUuUmVtb3RlLHRoaXMuaXNVbmlmaWVkKCksYykpLGIucHVzaChyLnN5bmNCYXJyaWVyKCkpKTtmLnJlY2VpdmVyPXI7Zy5SZW1vdGVTZXNzaW9uLmlzRmVhdHVyZVdlYnJ0YzFkb3QwU3VwcG9ydGVkKCkmJnZvaWQgMCE9ZC50cmFuc2NlaXZlciYmITE9PT1kLnRyYW5zY2VpdmVyLmlzX251bGwmJihLPXRoaXMudHJhbnNjZWl2ZXJzXy5maW5kKGZ1bmN0aW9uKGEpe3JldHVybiBhLm9iamVjdF9pZCgpPT09ZC50cmFuc2NlaXZlci5vaWR9KSx2b2lkIDA9PT1LJiYobS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiIGFkZGluZyBhIFJ0cFRyYW5zY2VpdmVyIHdpdGggb2lkOlwiK2QudHJhbnNjZWl2ZXIub2lkKSxLPW5ldyB6LlJ0cFRyYW5zY2VpdmVyKHRoaXMsZC50cmFuc2NlaXZlci5vaWQsay5Qcm94eU1vZGUuUmVtb3RlLHRoaXMuaXNVbmlmaWVkKCksei5SdGNSdHBUcmFuc2NlaXZlckRpcmVjdGlvbi5pbmFjdGl2ZSxcclxuciksdGhpcy50cmFuc2NlaXZlcnNfLnB1c2goSykpLGIucHVzaChLLnN5bmNCYXJyaWVyKCkpKTtmLnRyYW5zY2VpdmVyPUs7Zi5zdHJlYW1zPVtdO2lmKHZvaWQgMCE9ZC5zdHJlYW1zKWZvcihDPWZ1bmN0aW9uKGEpe3ZhciBkPWUucmVtb3RlU3RyZWFtcy5maW5kKGZ1bmN0aW9uKGYpe3JldHVybiExPT09YS5pc19udWxsJiZmLm9iamVjdF9pZCgpPT09YS5vaWR9KTt2b2lkIDA9PT1kJiYobS5sb2dnZXIubG9nKGUudXNlcl9mcmllbmRseV9pZCgpK1wiIGFkZGluZyBhIFJlbW90ZVN0cmVhbSB3aXRoIG9pZDpcIithLm9pZCksZD1uZXcgcS5SZW1vdGVTdHJlYW0oZSxhLm9pZCxrLlByb3h5TW9kZS5SZW1vdGUpLGUucmVtb3RlU3RyZWFtcy5wdXNoKGQpKTtiLnB1c2goZC5zeW5jQmFycmllcigpKTtmLnN0cmVhbXMucHVzaChkKX0sZT10aGlzLHg9MCxBPWQuc3RyZWFtczt4PEEubGVuZ3RoO3grKyl0PUFbeF0sQyh0KTttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLm9udHJhY2soKTogLnByb3Auc3luY0JhcnJpZXIgc3RhcnRcIik7UHJvbWlzZS5hbGwoYikudGhlbihmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh2LnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbnRyYWNrKCk6IG5vdGlmaWVkISEhIHdpdGggZXZ0OiBcIitmKTtmb3IodmFyIGE9MCxiPWYuc3RyZWFtczthPGIubGVuZ3RoO2ErKyliW2FdLnRvZ2dsZUF1ZGlvKCExKTtpZih2Lm9udHJhY2tfKXYub250cmFja18oZil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe3YubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5vbnRyYWNrKCk6IC5wcm9wLnN5bmNCYXJyaWVyIGZhaWxlZC5cIil9KTtyZXR1cm5bMl19KX0pfSk7cmV0dXJuIGYucmVtb3RlSW52b2tlKCEwLHQubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Qub250cmFjayxiLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtmLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0X29udHJhY2soKTogZmFpbGVkLlwiKX0pfSxlbnVtZXJhYmxlOiExLFxyXG5jb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJzaWduYWxpbmdTdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X3NpZ25hbGluZ1N0YXRlKCkgY2FsbGVkLCB2YWx1ZSA9IFwiK3RoaXMuc2lnbmFsaW5nU3RhdGVfKTtyZXR1cm4gdGhpcy5zaWduYWxpbmdTdGF0ZV99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25uZWdvdGlhdGlvbm5lZWRlZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbm5lZ290aWF0aW9ubmVlZGVkX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBmPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbm5lZ290aWF0aW9ubmVlZGVkKCkgY2FsbGVkLlwiKTt0aGlzLm9ubmVnb3RpYXRpb25uZWVkZWRfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLm9ubmVnb3RpYXRpb25uZWVkZWRcIikudGhlbihmdW5jdGlvbigpe3ZhciBiPWYucmVnaXN0ZXJDYWxsYmFja3MoITEsZi5pc051bGxDYWxsYmFjayhhKSx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90Lm9ubmVnb3RpYXRpb25uZWVkZWQpO2IudGhlbihmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhmLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbm5lZ290aWF0aW9ubmVlZGVkKCk6IGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO3ZhciBhPW5ldyBwKFwibmVnb3RpYXRpb25uZWVkZWRcIixmKTtpZihmLm9ubmVnb3RpYXRpb25uZWVkZWRfKWYub25uZWdvdGlhdGlvbm5lZWRlZF8oYSl9KTtyZXR1cm4gZi5yZW1vdGVJbnZva2UoITAsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbm5lZ290aWF0aW9ubmVlZGVkLGIuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2YubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfb25uZWdvdGlhdGlvbm5lZWRlZCgpOiBmYWlsZWQuXCIpfSl9LFxyXG5lbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmR1bXBDb25zdHJhaW50cz1mdW5jdGlvbihhKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCJjb25zdHJhaW50czogXCIrYSk7dm9pZCAwIT09YSYmMCE9PU9iamVjdC5rZXlzKGEpLmxlbmd0aHx8bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiY29uc3RyYWludHMgZWl0aGVyIHVuZGVmaW5lZCBvciBlbXB0eSFcIik7YSYmKG0ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIiAgLS0gdmlkZW86IFwiK2Eub2ZmZXJUb1JlY2VpdmVWaWRlbyksbS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiICAtLSBhdWRpbzogXCIrYS5vZmZlclRvUmVjZWl2ZUF1ZGlvKSxtLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIgIC0tIGljZVJlc3RhcnQ6IFwiK2EuaWNlUmVzdGFydCksbS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIiAgLS0gdm9pY2VBY3Rpdml0eURldGVjdGlvbjogXCIrYS52b2ljZUFjdGl2aXR5RGV0ZWN0aW9uKSl9O2IucHJvdG90eXBlLmZpeF9jb25zdHJhaW50cz1mdW5jdGlvbihhKXt0aGlzLmR1bXBDb25zdHJhaW50cyhhKTt2YXIgZj17fTt0aGlzLmlzVW5pZmllZCgpfHwoZj17YXVkaW86ITAsdmlkZW86ITB9KTtpZihhKXtpZih2b2lkIDAhPT1hLnZpZGVvfHx2b2lkIDAhPT1hLm9mZmVyVG9SZWNlaXZlVmlkZW8pZi52aWRlbz1hLm9mZmVyVG9SZWNlaXZlVmlkZW87aWYodm9pZCAwIT09YS5hdWRpb3x8dm9pZCAwIT09YS5vZmZlclRvUmVjZWl2ZUF1ZGlvKWYuYXVkaW89YS5vZmZlclRvUmVjZWl2ZUF1ZGlvO3ZvaWQgMCE9PWEuaWNlUmVzdGFydCYmKGYuaWNlUmVzdGFydD1hLmljZVJlc3RhcnQpO3ZvaWQgMCE9PWEudm9pY2VBY3Rpdml0eURldGVjdGlvbiYmKGYudm9pY2VBY3Rpdml0eURldGVjdGlvbj1hLnZvaWNlQWN0aXZpdHlEZXRlY3Rpb24pfXJldHVybiBmfTtiLnByb3RvdHlwZS5jcmVhdGVPZmZlcj1cclxuZnVuY3Rpb24oYSxmLGIpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jcmVhdGVPZmZlcigpIGNhbGxlZC5cIixKU09OLnN0cmluZ2lmeShhKSk7cmV0dXJuIHRoaXMuaXNVbmlmaWVkKCk/dm9pZCAwPT1hP3RoaXMuY3JlYXRlT2ZmZXJfdjIoKTphP3RoaXMuY3JlYXRlT2ZmZXJfdjIoYSk6dGhpcy5jcmVhdGVPZmZlcl92MShhLGYsYik6dGhpcy5jcmVhdGVPZmZlcl92MShhLGYsYil9O2IucHJvdG90eXBlLmNyZWF0ZU9mZmVyX3YyPWZ1bmN0aW9uKGEpe3ZhciBmPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZU9mZmVyX3YyKCkgY2FsbGVkLlwiLEpTT04uc3RyaW5naWZ5KGEpKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixkKXtmLmNyZWF0ZU9mZmVyX3YxKGZ1bmN0aW9uKGEpe20ubG9nZ2VyLmxvZyhmLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jcmVhdGVPZmZlcl92MigpOiBnb3Qgc2RwISEhXCIsSlNPTi5zdHJpbmdpZnkoYSkpO1xyXG5hPW5ldyBGKGEudHlwZSxhLnNkcCk7YihhKX0sZnVuY3Rpb24oYSl7dm9pZCAwIT1hJiYoYT1mLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuY3JlYXRlT2ZmZXJfdjIoKSBmYWlsZWQuXCIpLGQoYSkpfSxhKX0pfTtiLnByb3RvdHlwZS5jcmVhdGVPZmZlcl92MT1mdW5jdGlvbihhLGYsYil7dmFyIGQ9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY3JlYXRlT2ZmZXJfdjEoKS5cIixKU09OLnN0cmluZ2lmeShiKSk7dmFyIGM9W3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZU9mZmVyX3YxXCIpLHRoaXMud2FpdFRyYW5zY2VpdmVyQW5kVHJhY2tSZWFkeSh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jcmVhdGVPZmZlcl92MVwiKV07UHJvbWlzZS5hbGwoYykudGhlbihmdW5jdGlvbigpe3ZhciBhPWQucmVnaXN0ZXJDYWxsYmFja3MoITAsITEsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5jcmVhdGVPZmZlcik7XHJcbmQucmVtb3RlSW52b2tlKCExLHQubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3QuY3JlYXRlT2ZmZXIsYS5zdWNjZXNzLGEuZmFpbCxkLmZpeF9jb25zdHJhaW50cyhiKSk7cmV0dXJuIGEucHJvbSgpfSkudGhlbihmdW5jdGlvbihhKXttLmxvZ2dlci5sb2coZC51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY3JlYXRlT2ZmZXJfdjEoKTogc3VjY2VzcyBjYWxsYmFjayByZWNlaXZlZCEhIVwiKTtyZXR1cm4obmV3IGwoZCxkLnBhcmFtMChhKS5vaWQsay5Qcm94eU1vZGUuUmVtb3RlKSkuc3luY0JhcnJpZXIoKX0pLnRoZW4oZnVuY3Rpb24oZil7YSYmYShmKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7dm9pZCAwIT1hJiYoYT1kLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuY3JlYXRlT2ZmZXJfdjEoKSBmYWlsZWQuXCIpLGYmJmYoYSkpfSl9O2IucHJvdG90eXBlLmNyZWF0ZUFuc3dlcj1mdW5jdGlvbihhLGYsYil7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZUFuc3dlcigpIGNhbGxlZC5cIixcclxuSlNPTi5zdHJpbmdpZnkoYSkpO3JldHVybiB0aGlzLmlzVW5pZmllZCgpP3ZvaWQgMD09YT90aGlzLmNyZWF0ZUFuc3dlcl92MigpOmE/dGhpcy5jcmVhdGVBbnN3ZXJfdjIoYSk6dGhpcy5jcmVhdGVBbnN3ZXJfdjEoYSxmLGIpOnRoaXMuY3JlYXRlQW5zd2VyX3YxKGEsZixiKX07Yi5wcm90b3R5cGUuY3JlYXRlQW5zd2VyX3YyPWZ1bmN0aW9uKGEpe3ZhciBmPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZUFuc3dlcl92MigpIGNhbGxlZC5cIixKU09OLnN0cmluZ2lmeShhKSk7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGIsZCl7Zi5jcmVhdGVBbnN3ZXJfdjEoZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKGYudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZUFuc3dlcl92MigpOiBnb3Qgc2RwISEhXCIsSlNPTi5zdHJpbmdpZnkoYSkpO2E9bmV3IEYoYS50eXBlLGEuc2RwKTtiKGEpfSxmdW5jdGlvbihhKXt2b2lkIDAhPWEmJihhPWYubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcclxuXCIuY3JlYXRlQW5zd2VyX3YyKCkgZmFpbGVkLlwiKSxkKGEpKX0sYSl9KX07Yi5wcm90b3R5cGUuY3JlYXRlQW5zd2VyX3YxPWZ1bmN0aW9uKGEsZixiKXt2YXIgZD10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jcmVhdGVBbnN3ZXJfdjEoKSBjYWxsZWQuXCIsSlNPTi5zdHJpbmdpZnkoYikpO3ZhciBjPVt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jcmVhdGVBbnN3ZXJfdjFcIiksdGhpcy53YWl0VHJhbnNjZWl2ZXJBbmRUcmFja1JlYWR5KHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZUFuc3dlcl92MVwiKV07UHJvbWlzZS5hbGwoYykudGhlbihmdW5jdGlvbigpe3ZhciBhPWQucmVnaXN0ZXJDYWxsYmFja3MoITAsITEsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5jcmVhdGVBbnN3ZXIpO2QucmVtb3RlSW52b2tlKCExLHQubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3QuY3JlYXRlQW5zd2VyLFxyXG5hLnN1Y2Nlc3MsYS5mYWlsLGQuZml4X2NvbnN0cmFpbnRzKGIpLHt9KTtyZXR1cm4gYS5wcm9tKCl9KS50aGVuKGZ1bmN0aW9uKGEpe20ubG9nZ2VyLmxvZyhkLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jcmVhdGVBbnN3ZXJfdjEoKTogc3VjY2VzcyBjYWxsYmFjayByZWNlaXZlZCEhIVwiKTtyZXR1cm4obmV3IGwoZCxkLnBhcmFtMChhKS5vaWQsay5Qcm94eU1vZGUuUmVtb3RlKSkuc3luY0JhcnJpZXIoKX0pLnRoZW4oZnVuY3Rpb24oZil7YSYmYShmKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7YT1kLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuY3JlYXRlQW5zd2VyX3YxKCkgZmFpbGVkLlwiKTtmJiZmKGEubWVzc2FnZSl9KX07Yi5wcm90b3R5cGUudXBkYXRlU2RwRGVzY3JpcHRpb249ZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnVwZGF0ZVNkcERlc2NyaXB0aW9uKCkgY2FsbGVkLlwiKTt2YXIgZj10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLFxyXG5kKXt2YXIgYz1bXTsxPT1hP2MucHVzaChmLnJlbW90ZUludm9rZSghMSx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmxvY2FsRGVzY3JpcHRpb24se29pZDowfSkpOmMucHVzaChmLnJlbW90ZUludm9rZSghMSx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LnJlbW90ZURlc2NyaXB0aW9uLHtvaWQ6MH0pKTtQcm9taXNlLmFsbChjKS50aGVuKGZ1bmN0aW9uKGEpe20ubG9nZ2VyLmxvZyhmLnVzZXJfZnJpZW5kbHlfaWQoKStcIi51cGRhdGVTZHBEZXNjcmlwdGlvbigpIHJlc29sdmVkLlwiKTtyZXR1cm4obmV3IGwoZixmLnBhcmFtMChhWzBdKS5vaWQsay5Qcm94eU1vZGUuUmVtb3RlKSkuc3luY0JhcnJpZXIoKX0pLnRoZW4oZnVuY3Rpb24oZCl7MT09YT9mLmxvY2FsRGVzY3JpcHRpb25fPWQ6Zi5yZW1vdGVEZXNjcmlwdGlvbl89ZDttLmxvZ2dlci5sb2coZi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIudXBkYXRlU2RwRGVzY3JpcHRpb24oKSB1cGRhdGVkIHNkcFwiKTtiKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2YubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcclxuXCJzZHAuc3luY0JhcnJpZXIoKSBmYWlsZWQhXCIpO2QoKX0pfSl9O2IucHJvdG90eXBlLnNkcFRvU3RyaW5nPWZ1bmN0aW9uKGEpe3ZhciBmPVwiXCIsYj0wO2ZvcihhPWE/YS5zcGxpdCgvXFxyP1xcbi8pOltdO2I8YS5sZW5ndGg7YisrKXt2YXIgZD1hW2JdOy0xIT1kLmluZGV4T2YoXCJtPVwiLDApP2YrPWQrXCJcXFxcclxcXFxuXCI6LTEhPWQuaW5kZXhPZihcIm89LVwiLDApP2YrPWQrXCJcXFxcclxcXFxuXCI6LTEhPWQuaW5kZXhPZihcImE9c3NyY1wiLDApJiYoZis9ZCtcIlxcXFxyXFxcXG5cIil9cmV0dXJuIGZ9O2IucHJvdG90eXBlLnNldExvY2FsRGVzY3JpcHRpb249ZnVuY3Rpb24oYSxmLGIpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRMb2NhbERlc2NyaXB0aW9uKCkgY2FsbGVkLlwiLHRoaXMuc2RwVG9TdHJpbmcoYS5zZHApKTtpZihhIGluc3RhbmNlb2YgRilyZXR1cm4gdGhpcy5zZXRMb2NhbERlc2NyaXB0aW9uX3YyKGEpO2lmKGEgaW5zdGFuY2VvZiBSVENTZXNzaW9uRGVzY3JpcHRpb24mJlxyXG5mKXJldHVybiB0aGlzLnNldExvY2FsRGVzY3JpcHRpb25fdjEoYSxmLGIpO2Y9dm9pZCAwO2E/Zj1uZXcgRihhLnR5cGUsYS5zZHApOihtLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0TG9jYWxEZXNjcmlwdGlvbigpIGVtcHR5IHBhcmFtMSwgc2V0dGluZyBzZHAgdHlwZSB0byByb2xsYmFja1wiKSxhPXZvaWQgMCxhPVwiaGF2ZS1yZW1vdGUtb2ZmZXJcIj09dGhpcy5zaWduYWxpbmdTdGF0ZV8/XCJhbnN3ZXJcIjpcImhhdmUtbG9jYWwtcHJhbnN3ZXJcIj09dGhpcy5zaWduYWxpbmdTdGF0ZV98fFwiaGF2ZS1yZW1vdGUtcHJhbnN3ZXJcIj09dGhpcy5zaWduYWxpbmdTdGF0ZV8/XCJwcmFuc3dlclwiOlwib2ZmZXJcIixmPW5ldyBGKGEsXCJcIikpO3JldHVybiB0aGlzLnNldExvY2FsRGVzY3JpcHRpb25fdjIoZil9O2IucHJvdG90eXBlLnNldExvY2FsRGVzY3JpcHRpb25fdjI9ZnVuY3Rpb24oYSl7dmFyIGY9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLnNldExvY2FsRGVzY3JpcHRpb25fdjIoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGQpe2Yud2FpdFVudGlsQ29ubmVjdGVkKGYudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldExvY2FsRGVzY3JpcHRpb25fdjJcIikudGhlbihmdW5jdGlvbigpe3JldHVybihuZXcgbChmLDAsay5Qcm94eU1vZGUuTG9jYWwse3R5cGU6bC5jb252ZXJ0QzJIKGEudHlwZSksc2RwOmEuc2RwfSkpLnN5bmNCYXJyaWVyKCl9KS50aGVuKGZ1bmN0aW9uKGMpe3ZhciBnPWYucmVnaXN0ZXJDYWxsYmFja3MoITAsITEsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5zZXRMb2NhbERlc2NyaXB0aW9uX3YyKSxyPXt0eXBlOmwuY29udmVydEMySChhLnR5cGUpLHNkcDphLnNkcH07Zi5yZW1vdGVJbnZva2UoITEsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5zZXRMb2NhbERlc2NyaXB0aW9uX3YyLHIsZy5zdWNjZXNzLGcuZmFpbCk7Zy5wcm9tKCkudGhlbihmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhmLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuc2V0TG9jYWxEZXNjcmlwdGlvbl92MigpOiBzdWNjZXNzIGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO2YubG9jYWxEZXNjcmlwdGlvbl89YzttLmxvZ2dlci5sb2coZi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0TG9jYWxEZXNjcmlwdGlvbl92MigpOiB1cGRhdGVkIGxvY2FsRGVzY3JpcHRpb25fXCIpO1Byb21pc2UuYWxsKFtdKS50aGVuKGZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKGYudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldExvY2FsRGVzY3JpcHRpb25fdjIoKSBzdWNjZXNzLlwiKTtiKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9Zi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnByb3Auc2V0TG9jYWxEZXNjcmlwdGlvbl92MigpIGZhaWxlZCFcIik7ZChhKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPWYubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcInNldExvY2FsRGVzY3JpcHRpb25fdjIoKSBlcnJvciBjYWxsYmFjayByZWNlaXZlZCFcIik7ZChhKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPVxyXG5mLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0TG9jYWxEZXNjcmlwdGlvbl92MigpIGZhaWxlZC5cIik7ZChhKX0pfSl9O2IucHJvdG90eXBlLnNldExvY2FsRGVzY3JpcHRpb25fdjE9ZnVuY3Rpb24oYSxmLGIpe3ZhciBkPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldExvY2FsRGVzY3JpcHRpb25fdjEoKSBjYWxsZWQuXCIpO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldExvY2FsRGVzY3JpcHRpb25fdjFcIikudGhlbihmdW5jdGlvbigpe3JldHVybihuZXcgbChkLDAsay5Qcm94eU1vZGUuTG9jYWwse3R5cGU6bC5jb252ZXJ0QzJIKGEudHlwZSksc2RwOmEuc2RwfSkpLnN5bmNCYXJyaWVyKCl9KS50aGVuKGZ1bmN0aW9uKGEpe3ZhciBjPWQucmVnaXN0ZXJDYWxsYmFja3MoITAsITEsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5zZXRMb2NhbERlc2NyaXB0aW9uKTtkLnJlbW90ZUludm9rZUV4KCExLFxyXG50Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LnNldExvY2FsRGVzY3JpcHRpb24sW2FdLGMuc3VjY2VzcyxjLmZhaWwpO2MucHJvbSgpLnRoZW4oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coZC51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0TG9jYWxEZXNjcmlwdGlvbl92MSgpOiBzdWNjZXNzIGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO2QubG9jYWxEZXNjcmlwdGlvbl89YTttLmxvZ2dlci5sb2coZC51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0TG9jYWxEZXNjcmlwdGlvbl92MSgpOiB1cGRhdGVkIGxvY2FsRGVzY3JpcHRpb25fXCIpO1Byb21pc2UuYWxsKFtdKS50aGVuKGZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKGQudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldExvY2FsRGVzY3JpcHRpb25fdjEoKSBzdWNjZXNzLlwiKTtmJiZmKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9ZC5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnByb3Auc2V0TG9jYWxEZXNjcmlwdGlvbl92MSgpIGZhaWxlZC5cIik7XHJcbmImJmIoYS5tZXNzYWdlKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPWQubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRMb2NhbERlc2NyaXB0aW9uX3YxKCkgZXJyb3IgY2FsbGJhY2sgcmVjZWl2ZWQuXCIpO2ImJmIoYS5tZXNzYWdlKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPWQubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRMb2NhbERlc2NyaXB0aW9uX3YxKCkgZmFpbGVkLlwiKTtiJiZiKGEubWVzc2FnZSl9KX07Yi5wcm90b3R5cGUuc2V0UmVtb3RlRGVzY3JpcHRpb249ZnVuY3Rpb24oYSxmLGIpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRSZW1vdGVEZXNjcmlwdGlvbigpIGNhbGxlZC5cIix0aGlzLnNkcFRvU3RyaW5nKGEuc2RwKSk7aWYoYSBpbnN0YW5jZW9mIEYpcmV0dXJuIHRoaXMuc2V0UmVtb3RlRGVzY3JpcHRpb25fdjIoYSk7aWYoYSBpbnN0YW5jZW9mIFJUQ1Nlc3Npb25EZXNjcmlwdGlvbiYmZilyZXR1cm4gdGhpcy5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MShhLFxyXG5mLGIpO2Y9dm9pZCAwO2E/Zj1uZXcgRihhLnR5cGUsYS5zZHApOihtLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0UmVtb3RlRGVzY3JpcHRpb24oKSBlbXB0eSBwYXJhbTEsIHNldHRpbmcgc2RwIHR5cGUgdG8gcm9sbGJhY2tcIiksYT12b2lkIDAsYT1cImhhdmUtcmVtb3RlLW9mZmVyXCI9PXRoaXMuc2lnbmFsaW5nU3RhdGVfP1wiYW5zd2VyXCI6XCJoYXZlLWxvY2FsLXByYW5zd2VyXCI9PXRoaXMuc2lnbmFsaW5nU3RhdGVffHxcImhhdmUtcmVtb3RlLXByYW5zd2VyXCI9PXRoaXMuc2lnbmFsaW5nU3RhdGVfP1wicHJhbnN3ZXJcIjpcIm9mZmVyXCIsZj1uZXcgRihhLFwiXCIpKTtyZXR1cm4gdGhpcy5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MihmKX07Yi5wcm90b3R5cGUuc2V0UmVtb3RlRGVzY3JpcHRpb25fdjI9ZnVuY3Rpb24oYSl7dmFyIGY9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0UmVtb3RlRGVzY3JpcHRpb25fdjIoKSBjYWxsZWQuXCIpO1xyXG5yZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixkKXtmLndhaXRVbnRpbENvbm5lY3RlZChmLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MlwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9bmV3IGwoZiwwLGsuUHJveHlNb2RlLkxvY2FsLHt0eXBlOmwuY29udmVydEMySChhLnR5cGUpLHNkcDphLnNkcH0pLGc9W107Zy5wdXNoKGMuc3luY0JhcnJpZXIoKSk7dmFyIGM9Zi5yZWdpc3RlckNhbGxiYWNrcyghMCwhMSx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LnNldFJlbW90ZURlc2NyaXB0aW9uX3YyKSxyPXt0eXBlOmwuY29udmVydEMySChhLnR5cGUpLHNkcDphLnNkcH07Zi5yZW1vdGVJbnZva2UoITEsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MixyLGMuc3VjY2VzcyxjLmZhaWwpO2cucHVzaChjLnByb20oKSk7UHJvbWlzZS5hbGwoZykudGhlbihmdW5jdGlvbihhKXttLmxvZ2dlci5sb2coZi51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLnNldFJlbW90ZURlc2NyaXB0aW9uX3YyKCk6IHJlbW90ZSBzdWNjZXNzLlwiKTtmLnJlbW90ZURlc2NyaXB0aW9uXz1hWzBdO2c9W107Zi51c2luZ2FzeW5jb25seV98fChmLmlzVW5pZmllZCgpP2cucHVzaChmLmdldFRyYW5zY2VpdmVyc0FzeW5jKCkpOmcucHVzaChmLmdldFNlbmRlcnNBc3luYygpKSk7UHJvbWlzZS5hbGwoZykudGhlbihmdW5jdGlvbihhKXttLmxvZ2dlci5sb2coZi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0UmVtb3RlRGVzY3JpcHRpb25fdjIoKTogZmluYWwgc3VjY2Vzcy5cIik7YigpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPWYubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5wcm9wLnNldFJlbW90ZURlc2NyaXB0aW9uX3YyKCkgZmluYWwgZmFpbGVkLlwiKTtkKGEpfSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9Zi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnByb3Auc2V0UmVtb3RlRGVzY3JpcHRpb25fdjIoKSByZW1vdGUgZmFpbGVkLlwiKTtkKGEpfSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9XHJcbmYubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MigpIGZhaWxlZC5cIik7ZChhKX0pfSl9O2IucHJvdG90eXBlLnNldFJlbW90ZURlc2NyaXB0aW9uX3YxPWZ1bmN0aW9uKGEsZixiKXt2YXIgZD10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MSgpIGNhbGxlZC5cIik7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0UmVtb3RlRGVzY3JpcHRpb25fdjFcIikudGhlbihmdW5jdGlvbigpe3JldHVybihuZXcgbChkLDAsay5Qcm94eU1vZGUuTG9jYWwse3R5cGU6bC5jb252ZXJ0QzJIKGEudHlwZSksc2RwOmEuc2RwfSkpLnN5bmNCYXJyaWVyKCl9KS50aGVuKGZ1bmN0aW9uKGEpe3ZhciBjPWQucmVnaXN0ZXJDYWxsYmFja3MoITAsITEsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5zZXRSZW1vdGVEZXNjcmlwdGlvbik7ZC5yZW1vdGVJbnZva2VFeCghMSxcclxudC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5zZXRSZW1vdGVEZXNjcmlwdGlvbixbYV0sYy5zdWNjZXNzLGMuZmFpbCk7Yy5wcm9tKCkudGhlbihmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhkLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MSgpOiBzdWNjZXNzIGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO2QucmVtb3RlRGVzY3JpcHRpb25fPWE7bS5sb2dnZXIubG9nKGQudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldFJlbW90ZURlc2NyaXB0aW9uX3YxKCk6IHVwZGF0ZWQgcmVtb3RlRGVzY3JpcHRpb25fXCIpO3ZhciBjPVtdO2QudXNpbmdhc3luY29ubHlffHwoZC5pc1VuaWZpZWQoKT9jLnB1c2goZC5nZXRUcmFuc2NlaXZlcnNBc3luYygpKTpjLnB1c2goZC5nZXRTZW5kZXJzQXN5bmMoKSkpO1Byb21pc2UuYWxsKGMpLnRoZW4oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coZC51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0UmVtb3RlRGVzY3JpcHRpb25fdjEoKTogc3VjY2Vzcy5cIik7XHJcbmYmJmYoKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7YT1kLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIucHJvcC5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MSgpIGZhaWxlZC5cIik7YiYmYihhLm1lc3NhZ2UpfSl9KX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7YT1kLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0UmVtb3RlRGVzY3JpcHRpb25fdjEoKSBmYWlsZWQuXCIpO2ImJmIoYS5tZXNzYWdlKX0pfTtiLnByb3RvdHlwZS5nZXRMb2NhbFN0cmVhbXM9ZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coXCJQZWVyQ29ubmVjdGlvbi5nZXRMb2NhbFN0cmVhbXMoKSBjYWxsZWQuIFtvaWQ9XCIrdGhpcy5vYmplY3RfaWQoKStcIl1cIik7Zm9yKHZhciBhPTAsZj10aGlzLmxvY2FsU3RyZWFtczthPGYubGVuZ3RoO2ErKyltLmxvZ2dlci5sb2coSlNPTi5zdHJpbmdpZnkoZlthXSkpO3JldHVybiB0aGlzLmxvY2FsU3RyZWFtc307Yi5wcm90b3R5cGUuZ2V0UmVtb3RlU3RyZWFtcz1mdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuZ2V0UmVtb3RlU3RyZWFtcygpIGNhbGxlZC5cIik7Zm9yKHZhciBhPTAsZj10aGlzLnJlbW90ZVN0cmVhbXM7YTxmLmxlbmd0aDthKyspbS5sb2dnZXIubG9nKEpTT04uc3RyaW5naWZ5KGZbYV0pKTtyZXR1cm4gdGhpcy5yZW1vdGVTdHJlYW1zfTtiLnByb3RvdHlwZS5hZGRUcmFjaz1mdW5jdGlvbihhLGYpe3JldHVybiB0aGlzLmFkZFRyYWNrSW50ZXJuYWwoYSxmLCExKX07Yi5wcm90b3R5cGUuYWRkVHJhY2tBc3luYz1mdW5jdGlvbihhLGYpe3JldHVybiB0aGlzLmFkZFRyYWNrSW50ZXJuYWwoYSxmLCEwKX07Yi5wcm90b3R5cGUuYWRkVHJhY2tJbnRlcm5hbD1mdW5jdGlvbihhLGYsYil7dmFyIGQ9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkVHJhY2tJbnRlcm5hbCgpIGNhbGxlZC4gdHJhY2suaWQgPSBcIithLmlkK1wiLCBzdHJlYW1zID0gXCIrSlNPTi5zdHJpbmdpZnkoZikrXCIsIGlzQXN5bmMgPSBcIitiKTt0aGlzLmluY3JlbWVudFBlbmRpbmdUcmFja0NvdW50KCk7XHJcbnZhciBjPVtdO2lmKGYpaWYoZiBpbnN0YW5jZW9mIHEuUmVtb3RlU3RyZWFtKWMucHVzaChmLmlkKSx0aGlzLmxvY2FsU3RyZWFtcy5wdXNoKGYpO2Vsc2UgZm9yKHZhciBnPTA7ZzxmLmxlbmd0aDtnKyspYy5wdXNoKGZbZ10uaWQpLHRoaXMubG9jYWxTdHJlYW1zLnB1c2goZltnXSk7ZWxzZSBtLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkVHJhY2tJbnRlcm5hbCgpIGVtcHR5IHN0cmVhbXMgcGFzc2VkIGluLCBjb250aW51ZSB3aXRoIGVtcHR5IGFycmF5XCIpO3ZhciByPW5ldyBuLlJ0cFNlbmRlcih0aGlzLDAsay5Qcm94eU1vZGUuUHNldWRvLHRoaXMuaXNVbmlmaWVkKCkpO3RoaXMuc2VuZGVyc18ucHVzaChyKTtmPW5ldyBQcm9taXNlKGZ1bmN0aW9uKGYsYil7ZC53YWl0VW50aWxDb25uZWN0ZWQoZC51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkVHJhY2tJbnRlcm5hbFwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGQucmVtb3RlSW52b2tlRXgoITEsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5hZGRUcmFjayxcclxuW2FdLGMpfSkudGhlbihmdW5jdGlvbihhKXttLmxvZ2dlci5sb2coZC51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkVHJhY2tJbnRlcm5hbCgpIHN1Y2Nlc3Mgd2l0aCBvaWQ6IFwiK2QucGFyYW0wKGEpLm9pZCk7ci5iaW5kKGQsZC5wYXJhbTAoYSkub2lkKTtyLnN5bmNCYXJyaWVyKCkudGhlbihmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhkLnVzZXJfZnJpZW5kbHlfaWQoKStcInNlbmRlci5zeW5jQmFycmllcigpOiBzdWNjZXNzXCIpOyFkLnVzaW5nYXN5bmNvbmx5XyYmZC5pc1VuaWZpZWQoKT9kLmdldFRyYW5zY2VpdmVyc0FzeW5jKCkudGhlbihmdW5jdGlvbigpe2QuZGVjcmVtZW50UGVuZGluZ1RyYWNrQ291bnQoKTtmKHIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtkLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuYWRkVHJhY2tJbnRlcm5hbCgpIGdldFRyYW5zY2VpdmVyc0FzeW5jKCkgZmFpbGVkIVwiKTtkLmRlY3JlbWVudFBlbmRpbmdUcmFja0NvdW50KCk7YigpfSk6KGQuZGVjcmVtZW50UGVuZGluZ1RyYWNrQ291bnQoKSxcclxuZihyKSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2QubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcInNlbmRlci5zeW5jQmFycmllcigpIGZhaWxlZCFcIik7ZC5kZWNyZW1lbnRQZW5kaW5nVHJhY2tDb3VudCgpO2IoKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtkLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCJhZGRUcmFjaygpIGZhaWxlZCFcIik7ZC5kZWNyZW1lbnRQZW5kaW5nVHJhY2tDb3VudCgpO2IoKX0pfSk7aWYoYilyZXR1cm4gZjttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkVHJhY2soKSByZXR1cm5pbmc6IFwiK3IpO3JldHVybiByfTtiLnByb3RvdHlwZS5yZW1vdmVUcmFjaz1mdW5jdGlvbihhKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucmVtb3ZlVHJhY2soKSBjYWxsZWQuXCIpO3RoaXMucmVtb3ZlVHJhY2tBc3luYyhhKX07Yi5wcm90b3R5cGUucmVtb3ZlVHJhY2tBc3luYz1mdW5jdGlvbihhKXt2YXIgZj10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIucmVtb3ZlVHJhY2tBc3luYygpIGNhbGxlZC5cIik7dGhpcy5pbmNyZW1lbnRQZW5kaW5nVHJhY2tDb3VudCgpO2Zvcih2YXIgYj0wO2I8dGhpcy5zZW5kZXJzXy5sZW5ndGg7YisrKXRoaXMuc2VuZGVyc19bYl09PWEmJnRoaXMuc2VuZGVyc18uc3BsaWNlKGIsMSk7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGIsZCl7Zi53YWl0VW50aWxDb25uZWN0ZWQoZi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucmVtb3ZlVHJhY2tBc3luY1wiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGYucmVtb3RlSW52b2tlRXgoITEsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5yZW1vdmVUcmFjayxbYV0pfSkudGhlbihmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhmLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5yZW1vdmVUcmFja0FzeW5jKCkgc3VjY2Vzcy5cIik7IWYudXNpbmdhc3luY29ubHlfJiZmLmlzVW5pZmllZCgpP2YuZ2V0VHJhbnNjZWl2ZXJzQXN5bmMoKS50aGVuKGZ1bmN0aW9uKCl7Zi5kZWNyZW1lbnRQZW5kaW5nVHJhY2tDb3VudCgpO1xyXG5iKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2YubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcInJlbW92ZVRyYWNrQXN5bmMoKSBnZXRUcmFuc2NlaXZlcnNBc3luYygpIGZhaWxlZCFcIik7Zi5kZWNyZW1lbnRQZW5kaW5nVHJhY2tDb3VudCgpO2QoYSl9KTooZi5kZWNyZW1lbnRQZW5kaW5nVHJhY2tDb3VudCgpLGIoKSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2YubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcInJlbW92ZVRyYWNrQXN5bmMoKSBmYWlsZWQhXCIpO2YuZGVjcmVtZW50UGVuZGluZ1RyYWNrQ291bnQoKTtkKGEpfSl9KX07Yi5wcm90b3R5cGUuYWRkU3RyZWFtPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmFkZFN0cmVhbSgpIGNhbGxlZDogXCIrSlNPTi5zdHJpbmdpZnkoYSkpO3RoaXMubG9jYWxTdHJlYW1zLnB1c2goYSk7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkU3RyZWFtXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYi5yZW1vdGVJbnZva2VFeCghMSxcclxudC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5hZGRTdHJlYW0sW2FdLHt9KX0pLnRoZW4oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkU3RyZWFtKCkgc3VjY2Vzcy5cIil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcImFkZFN0cmVhbSgpIGZhaWxlZC5cIil9KX07Yi5wcm90b3R5cGUucmVtb3ZlU3RyZWFtPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnJlbW92ZVN0cmVhbSgpIGNhbGxlZDogXCIrSlNPTi5zdHJpbmdpZnkoYSkpO2Zvcih2YXIgZD0wO2Q8dGhpcy5sb2NhbFN0cmVhbXMubGVuZ3RoO2QrKyl0aGlzLmxvY2FsU3RyZWFtc1tkXT09YSYmdGhpcy5sb2NhbFN0cmVhbXMuc3BsaWNlKGQsMSk7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucmVtb3ZlU3RyZWFtXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYi5yZW1vdGVJbnZva2VFeCghMSxcclxudC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5yZW1vdmVTdHJlYW0sW2FdKX0pLnRoZW4oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucmVtb3ZlU3RyZWFtKCkgc3VjY2Vzcy5cIil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcInJlbW92ZVN0cmVhbSgpIGZhaWxlZC5cIil9KX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25hZGRzdHJlYW1cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub25hZGRzdHJlYW1ffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uYWRkc3RyZWFtKCkgY2FsbGVkLlwiKTt0aGlzLm9uYWRkc3RyZWFtXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uYWRkc3RyZWFtXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgZD1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLFxyXG5iLmlzTnVsbENhbGxiYWNrKGEpLHQubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Qub25hZGRzdHJlYW0pO2QudGhlbihmdW5jdGlvbihhKXsobmV3IHEuUmVtb3RlU3RyZWFtRXZlbnQoYixiLnBhcmFtMChhKS5vaWQpKS5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uYWRkc3RyZWFtIGNhbGxiYWNrIHJlY2VpdmVkIVwiKTt2b2lkIDA9PT1iLnJlbW90ZVN0cmVhbXMuZmluZChmdW5jdGlvbihiKXtyZXR1cm4gdm9pZCAwIT1hLnN0cmVhbSYmYi5vYmplY3RfaWQoKT09PWEuc3RyZWFtLm9iamVjdF9pZCgpfSkmJmIucmVtb3RlU3RyZWFtcy5wdXNoKGEuc3RyZWFtKTtiLm9uYWRkc3RyZWFtXyYmKG0ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmFkZHN0cmVhbSBub3RpZmllZCEhISBcIithLnN0cmVhbS5pZCksYi5vbmFkZHN0cmVhbV8oYSkpfSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsXHJcbnQubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Qub25hZGRzdHJlYW0sZC5zdWNjZXNzKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwic2V0X29uYWRkc3RyZWFtKCkgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9ucmVtb3Zlc3RyZWFtXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9ucmVtb3Zlc3RyZWFtX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbnJlbW92ZXN0cmVhbSgpIGNhbGxlZC5cIik7dGhpcy5vbnJlbW92ZXN0cmVhbV89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbnJlbW92ZXN0cmVhbVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGQ9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLFxyXG50Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90Lm9ucmVtb3Zlc3RyZWFtKTtkLnRoZW4oZnVuY3Rpb24oYSl7KG5ldyBxLlJlbW90ZVN0cmVhbUV2ZW50KGIsYi5wYXJhbTAoYSkub2lkKSkuc3luY0JhcnJpZXIoKS50aGVuKGZ1bmN0aW9uKGEpe20ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbnJlbW92ZXN0cmVhbSBjYWxsYmFjayByZWNlaXZlZCEgXCIrYS5zdHJlYW0uaWQpO3ZhciBkPWIucmVtb3RlU3RyZWFtcy5maW5kSW5kZXgoZnVuY3Rpb24oYil7cmV0dXJuIGIuaWQ9PWEuc3RyZWFtLmlkfSk7MDw9ZCYmYi5yZW1vdGVTdHJlYW1zLnNwbGljZShkLDEpO2lmKGIub25yZW1vdmVzdHJlYW1fKWIub25yZW1vdmVzdHJlYW1fKGEpfSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbnJlbW92ZXN0cmVhbSxkLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXHJcblwic2V0X29ucmVtb3Zlc3RyZWFtKCkgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmdldFN0YXRzPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGQsYyl7Yi5pc1JlZGlyZWN0ZWQoKT9iLndhaXRVbnRpbENvbm5lY3RlZChiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRTdGF0c1wiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMCwhMSx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmdldFN0YXRzKTtjLnRoZW4oZnVuY3Rpb24oYil7dm9pZCAwPT09Yi5wYXJhbXN8fDA9PT1iLnBhcmFtcy5sZW5ndGh8fDA9PT1iLnBhcmFtc1swXS5sZW5ndGg/ZCgpOmE/KGEoRC5TdGF0c1JlcG9ydC5mcm9tSlNPTihKU09OLnBhcnNlKGIucGFyYW1zWzBdKSkpLGQoKSk6ZChELlN0YXRzUmVwb3J0LnRvUlRDU3RhdHNSZXBvcnQoSlNPTi5wYXJzZShiLnBhcmFtc1swXSkpKX0pO1xyXG5yZXR1cm4gYT9iLnJlbW90ZUludm9rZSghMSx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmdldFN0YXRzLGMuc3VjY2Vzcyk6Yi5yZW1vdGVJbnZva2UoITEsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5nZXRTdGF0c192MixjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiJiYoYT1iLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuZ2V0U3RhdHMoKSBmYWlsZWQhXCIpLGMoYSkpfSk6KGEoe30pLGQoKSl9KX07Yi5wcm90b3R5cGUuU2VuZFRlbGVtZXRyeURhdGE9ZnVuY3Rpb24oYSxiLGQpe3cuZ2V0UmVkaXJlY3RvcigpLnRlbGVtZXRyeS5TZW5kVGVsZW1ldHJ5RGF0YSh5LnRlbF9jbWQuRGF0YSxhLGIsZCl9O2IucHJvdG90eXBlLk1pbGxpc2Vjb25kc3RvRGlzcGxheWZvcm1hdF89ZnVuY3Rpb24oYSl7dmFyIGIsZDtkPU1hdGguZmxvb3IoYS8xRTMpO2I9TWF0aC5mbG9vcihkLzYwKTthPU1hdGguZmxvb3IoYi82MCk7bS5sb2dnZXIubG9nKE1hdGguZmxvb3IoYS9cclxuMjQpK1wiOlwiK2ElMjQrXCI6XCIrYiU2MCtcIjpcIitkJTYwKX07Yi5wcm90b3R5cGUuQ2FsY3VsYXRlQ2FsbER1cmF0aW9uYW5kVHlwZV89ZnVuY3Rpb24oKXtpZigxPT10aGlzLnRpbWVlcnN0YXJ0ZWRfKXt0aGlzLnRpbWVlcnN0YXJ0ZWRfPSExO3RoaXMuY2FsbGVuZFRpbWVfPShuZXcgRGF0ZSkuZ2V0VGltZSgpO3ZhciBhPXRoaXMuY2FsbGVuZFRpbWVfLXRoaXMuY2FsbHN0YXJ0VGltZV87dGhpcy5NaWxsaXNlY29uZHN0b0Rpc3BsYXlmb3JtYXRfKGEpO2E9TWF0aC5yb3VuZChhLzFFMyk7bS5sb2dnZXIubG9nKFwiQ2FsbCBEdXJhdGlvbiBcIithKTsxPT10aGlzLmNvbmZlcmVuY2VjYWxsXz90aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHkudGVsX2tleV9Db25mZXJlbmNlQ2FsbER1cmF0aW9uLGEsMSk6KDE9PXRoaXMuYXVkaW9jYWxsXy5hY3RpdmUmJnRoaXMuU2VuZFRlbGVtZXRyeURhdGEoeS50ZWxfa2V5X0F1ZGlvQ2FsbER1cmF0aW9uLGEsMSksMT09dGhpcy52aWRlb2NhbGxfLmFjdGl2ZSYmXHJcbnRoaXMuU2VuZFRlbGVtZXRyeURhdGEoeS50ZWxfa2V5X1ZpZGVvQ2FsbER1cmF0aW9uLGEsMSksMT09dGhpcy5zY3JlZW5zaGFyaW5nY2FsbF8uYWN0aXZlJiZ0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHkudGVsX2tleV9TY3JlZW5zaGFyaW5nQ2FsbER1cmF0aW9uLGEsMSkpO3ZhciBiOzE9PXRoaXMuZmlyc3R0aW1lbG9jYWxvZmZlcl8mJihiPXRoaXMuY2FsbHN0YXJ0VGltZV8tdGhpcy5vdXRnb2luZ2NhbGxzdGFydF8pOzE9PXRoaXMuZmlyc3R0aW1lcmVtb3Rlb2ZmZXJfJiYoYj10aGlzLmNhbGxzdGFydFRpbWVfLXRoaXMuaW5jb21pbmdjYWxsc3RhcnRfKTt0aGlzLk1pbGxpc2Vjb25kc3RvRGlzcGxheWZvcm1hdF8oYik7Yj1NYXRoLnJvdW5kKGIvMUUzKTttLmxvZ2dlci5sb2coXCJDYWxsIEVzdGFibGlzaCBUaW1lIFwiK2IpOzE9PXRoaXMuaW5jb21pbmdjYWxsXz90aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHkudGVsX2tleV9DYWxsRXN0SW5jb21pbmcsYiwxKToxPT10aGlzLm91dGdvaW5nY2FsbF8mJlxyXG50aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHkudGVsX2tleV9DYWxsRXN0T3V0Z29pbmcsYiwxKTt0aGlzLlNlbmRUZWxlbWV0cnlEYXRhKHkudGVsX2tleV9QZXJmQ2FsbFN0YXRlLHkudGVsX0NhbGxTdGF0ZS5pZGxlLDEpfX07Yi5wcm90b3R5cGUuY2xvc2U9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jbG9zZSgpIGNhbGxlZC5cIik7dGhpcy5DYWxjdWxhdGVDYWxsRHVyYXRpb25hbmRUeXBlXygpO3RoaXMudW5yZWdpc3RlclN0YXRlQ2hhbmdlTm90aWZpY2F0aW9uKHRoaXMub25TdGF0ZUNoYW5nZSk7dGhpcy5vbm5lZ290aWF0aW9ubmVlZGVkPXRoaXMub25zaWduYWxpbmdzdGF0ZWNoYW5nZT10aGlzLm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2U9dGhpcy5vbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZT10aGlzLm9uaWNlY2FuZGlkYXRlPXRoaXMub25hZGRzdHJlYW09bnVsbDt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuY2xvc2VcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBhLnJlbW90ZUludm9rZSghMSx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmNsb3NlKX0pLnRoZW4oZnVuY3Rpb24oKXthLmljZVFfPW51bGw7YS5yZWxlYXNlKCk7bS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmNsb3NlKCkgc3VjY2Vzcy5cIil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2EubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5jbG9zZSgpIGZhaWxlZC5cIik7YS5pY2VRXz1udWxsO2EucmVsZWFzZSgpfSl9O2IucHJvdG90eXBlLmNyZWF0ZURUTUZTZW5kZXI9ZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZURUTUZTZW5kZXIoKSBjYWxsZWQuXCIpO3ZhciBiLGQ9dGhpcy5zZW5kZXJzXztpZih2b2lkIDA9PT1kfHwwPT09ZC5sZW5ndGgpZD10aGlzLmdldFNlbmRlcnMoKTt2b2lkIDAhPWQmJihkPWQuZmluZChmdW5jdGlvbihiKXtyZXR1cm4gYi50cmFjay5pZD09PVxyXG5hLmlkfSksdm9pZCAwIT1kJiYobS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiIHJldHVybmluZyBSdHBTZW5kZXIgd2l0aCBvaWQ6XCIrZC5vYmplY3RfaWQoKSksYj1kLmR0bWYpKTtyZXR1cm4gYn07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwidXNpbmdBc3luY09ubHlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudXNpbmdhc3luY29ubHlffSxzZXQ6ZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnVzaW5nQXN5bmNPbmx5KCkgY2FsbGVkIHdpdGggYXN5bmM6XCIrYSk7dm9pZCAwIT1hJiZudWxsIT1hJiYodGhpcy51c2luZ2FzeW5jb25seV89YSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuZ2V0U2VuZGVyc0FzeW5jPWZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFNlbmRlcnNBc3luYygpIGNhbGxlZC5cIik7cmV0dXJuIHRoaXMuZ2V0U2VuZGVyc0FzeW5jSW50ZXJuYWwoKX07XHJcbmIucHJvdG90eXBlLmdldFNlbmRlcnM9ZnVuY3Rpb24oKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0U2VuZGVycygpIGNhbGxlZC4gXCIpO2lmKHRoaXMudXNpbmdhc3luY29ubHlfKXRocm93IG0ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRTZW5kZXJzKCk6IHRocm93aW5nIGV4Y2VwdGlvbjogbm90IGFsbG93ZWQgd2hlbiB1c2luZ0FzeW5jT25seSBpcyB0cnVlISEhXCIpLG5ldyBET01FeGNlcHRpb24oXCIuZ2V0U2VuZGVycygpIG5vdCBhbGxvd2VkIHdoZW4gdXNpbmdBc3luY09ubHkgaXMgdHJ1ZSEhIVwiKTt0aGlzLmdldFNlbmRlcnNBc3luY0ludGVybmFsKCk7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFNlbmRlcnMoKSByZXR1cm5pbmc6XCIrdGhpcy5zZW5kZXJzXy5sZW5ndGgrXCIgaXRlbXNcIik7cmV0dXJuIHRoaXMuc2VuZGVyc199O2IucHJvdG90eXBlLmdldFNlbmRlcnNBc3luY0ludGVybmFsPVxyXG5mdW5jdGlvbigpe3ZhciBhPXRoaXM7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFNlbmRlcnNBc3luY0ludGVybmFsKCkgY2FsbGVkLiBcIit0aGlzLnNlbmRlcnNfKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixkKXthLndhaXRVbnRpbENvbm5lY3RlZChhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRTZW5kZXJzQXN5bmNJbnRlcm5hbFwiKS50aGVuKGZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFNlbmRlcnNBc3luY0ludGVybmFsIGludm9raW5nIHJlbW90ZVwiKTtyZXR1cm4gYS5yZW1vdGVJbnZva2UoITEsdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5nZXRTZW5kZXJzKX0pLnRoZW4oZnVuY3Rpb24oZCl7bS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFNlbmRlcnNBc3luY0ludGVybmFsIHJlbW90ZSBzdWNjZXNzXCIpO3ZhciBjPVtdLGc9W107ZC5wYXJhbXNbMF0uZm9yRWFjaChmdW5jdGlvbihiKXt2YXIgZj1cclxuYS5zZW5kZXJzXy5maW5kKGZ1bmN0aW9uKGEpe3JldHVybiBhLm9iamVjdF9pZCgpPT09Yi5vaWR9KTt2b2lkIDA9PT1mJiYobS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiIGFkZGluZyBhIFJ0cFNlbmRlciB3aXRoIG9pZDpcIitiLm9pZCksZj1uZXcgbi5SdHBTZW5kZXIoYSxiLm9pZCxrLlByb3h5TW9kZS5SZW1vdGUsYS5pc1VuaWZpZWQoKSkpO2cucHVzaChmLnN5bmNCYXJyaWVyKCkpO2MucHVzaChmKX0pO1Byb21pc2UuYWxsKGcpLnRoZW4oZnVuY3Rpb24oKXthLnNlbmRlcnNfPWM7bS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFNlbmRlcnNBc3luY0ludGVybmFsOiByZXR1cm5pbmcgc2VuZGVycyB3aXRoIGlkcyBbXCIrYS5zZW5kZXJzXy5tYXAoZnVuY3Rpb24oYSl7cmV0dXJuIGEub2JqZWN0X2lkKCl9KStcIl1cIik7YihhLnNlbmRlcnNfKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oZCl7YS5sb2dSZW1vdGVJbnZva2VFcnJvcihkLFwiLnByb3AuZ2V0U2VuZGVyc0FzeW5jSW50ZXJuYWwoKSBmYWlsZWQuXCIpO1xyXG5hLnNlbmRlcnNfPVtdO2IoYS5zZW5kZXJzXyl9KX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oZCl7YS5sb2dSZW1vdGVJbnZva2VFcnJvcihkLFwiLmdldFNlbmRlcnNBc3luY0ludGVybmFsKCkgZmFpbGVkLlwiKTthLnNlbmRlcnNfPVtdO2IoYS5zZW5kZXJzXyl9KX0pfTtiLnByb3RvdHlwZS5nZXRSZWNlaXZlcnNBc3luYz1mdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRSZWNlaXZlcnNBc3luYygpIGNhbGxlZC5cIik7cmV0dXJuIHRoaXMuZ2V0UmVjZWl2ZXJzQXN5bmNJbnRlcm5hbCgpfTtiLnByb3RvdHlwZS5nZXRSZWNlaXZlcnM9ZnVuY3Rpb24oKXttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0UmVjZWl2ZXJzKCkgY2FsbGVkLiBcIik7aWYodGhpcy51c2luZ2FzeW5jb25seV8pdGhyb3cgbS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFJlY2VpdmVycygpOiB0aHJvd2luZyBleGNlcHRpb246IG5vdCBhbGxvd2VkIHdoZW4gdXNpbmdBc3luY09ubHkgaXMgdHJ1ZSEhIVwiKSxcclxubmV3IERPTUV4Y2VwdGlvbihcIi5nZXRSZWNlaXZlcnMoKSBub3QgYWxsb3dlZCB3aGVuIHVzaW5nQXN5bmNPbmx5IGlzIHRydWUhISFcIik7dGhpcy5nZXRSZWNlaXZlcnNBc3luY0ludGVybmFsKCk7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFJlY2VpdmVycygpIHJldHVybmluZzpcIit0aGlzLnJlY2VpdmVyc18ubGVuZ3RoK1wiIGl0ZW1zXCIpO3JldHVybiB0aGlzLnJlY2VpdmVyc199O2IucHJvdG90eXBlLmdldFJlY2VpdmVyc0FzeW5jSW50ZXJuYWw9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRSZWNlaXZlcnNBc3luY0ludGVybmFsKCkgY2FsbGVkLiBcIit0aGlzLnJlY2VpdmVyc18pO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGQpe2Eud2FpdFVudGlsQ29ubmVjdGVkKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFJlY2VpdmVyc0FzeW5jSW50ZXJuYWxcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBhLnJlbW90ZUludm9rZSghMSxcclxudC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5nZXRSZWNlaXZlcnMpfSkudGhlbihmdW5jdGlvbihkKXttLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0UmVjZWl2ZXJzQXN5bmNJbnRlcm5hbDogcmVtb3RlIHN1Y2Nlc3MuXCIpO3ZhciBjPVtdLGc9W107ZC5wYXJhbXNbMF0uZm9yRWFjaChmdW5jdGlvbihiKXt2YXIgZj1hLnJlY2VpdmVyc18uZmluZChmdW5jdGlvbihhKXtyZXR1cm4gYS5vYmplY3RfaWQoKT09PWIub2lkfSk7dm9pZCAwPT09ZiYmKG0ubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIiBhZGRpbmcgYSBSdHBSZWNlaXZlciB3aXRoIG9pZDpcIitiLm9pZCksZj1uZXcgbi5SdHBSZWNlaXZlcihhLGIub2lkLGsuUHJveHlNb2RlLlJlbW90ZSxhLmlzVW5pZmllZCgpKSk7Zy5wdXNoKGYuc3luY0JhcnJpZXIoKSk7Yy5wdXNoKGYpfSk7UHJvbWlzZS5hbGwoZykudGhlbihmdW5jdGlvbigpe2EucmVjZWl2ZXJzXz1jO20ubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuZ2V0UmVjZWl2ZXJzQXN5bmNJbnRlcm5hbDogcmV0dXJuaW5nIHJlY2VpdmVyIHdpdGggaWRzIFtcIithLnJlY2VpdmVyc18ubWFwKGZ1bmN0aW9uKGEpe3JldHVybiBhLm9iamVjdF9pZCgpfSkrXCJdXCIpO2IoYS5yZWNlaXZlcnNfKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oZCl7YS5sb2dSZW1vdGVJbnZva2VFcnJvcihkLFwiLnByb3AuZ2V0UmVjZWl2ZXJzQXN5bmNJbnRlcm5hbCgpIGZhaWxlZCFcIik7YS5yZWNlaXZlcnNfPVtdO2IoYS5yZWNlaXZlcnNfKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihkKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGQsXCIuZ2V0UmVjZWl2ZXJzQXN5bmNJbnRlcm5hbCgpIGZhaWxlZCFcIik7YS5yZWNlaXZlcnNfPVtdO2IoYS5yZWNlaXZlcnNfKX0pfSl9O2IucHJvdG90eXBlLmFkZFRyYW5zY2VpdmVyPWZ1bmN0aW9uKGEsYil7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmFkZFRyYW5zY2VpdmVyKCkgY2FsbGVkOiBcIitKU09OLnN0cmluZ2lmeShhKStcclxuXCIgaW5pdD1cIitKU09OLnN0cmluZ2lmeShiKSk7cmV0dXJuIHRoaXMuYWRkVHJhbnNjZWl2ZXJJbnRlcm5hbChhLGIsITEpfTtiLnByb3RvdHlwZS5hZGRUcmFuc2NlaXZlckFzeW5jPWZ1bmN0aW9uKGEsYil7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmFkZFRyYW5zY2VpdmVyQXN5bmMoKSBjYWxsZWQ6IFwiK0pTT04uc3RyaW5naWZ5KGEpK1wiIGluaXQ9XCIrSlNPTi5zdHJpbmdpZnkoYikpO3JldHVybiB0aGlzLmFkZFRyYW5zY2VpdmVySW50ZXJuYWwoYSxiLCEwKX07Yi5wcm90b3R5cGUuYWRkVHJhbnNjZWl2ZXJJbnRlcm5hbD1mdW5jdGlvbihhLGIsZCl7dmFyIGM9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkVHJhbnNjZWl2ZXJJbnRlcm5hbCgpIGNhbGxlZDogXCIrSlNPTi5zdHJpbmdpZnkoYSkrXCIgaW5pdD1cIitKU09OLnN0cmluZ2lmeShiKSk7dGhpcy5pbmNyZW1lbnRQZW5kaW5nVHJhbnNjZWl2ZXJDb3VudCgpO1xyXG52YXIgcj16LlJ0Y1J0cFRyYW5zY2VpdmVyRGlyZWN0aW9uLnNlbmRyZWN2LGU9dm9pZCAwO2ImJihlPXouUnRjUnRwVHJhbnNjZWl2ZXJJbml0LnRvUnRjUnRwVHJhbnNjZWl2ZXJJbml0KGIpLGUuZGlyZWN0aW9uJiYocj1lLmRpcmVjdGlvbikpO3ZhciBDPWI7Zy5SZW1vdGVTZXNzaW9uLmlzRmVhdHVyZUNhbGxDb25zdHJhaW50c1N1cHBvcnRlZCgpJiYoQz1lKTt2YXIgeD1uZXcgei5SdHBUcmFuc2NlaXZlcih0aGlzLDAsay5Qcm94eU1vZGUuUHNldWRvLHRoaXMuaXNVbmlmaWVkKCkscik7dGhpcy50cmFuc2NlaXZlcnNfLnB1c2goeCk7Yj1uZXcgUHJvbWlzZShmdW5jdGlvbihiLGYpe2Mud2FpdFVudGlsQ29ubmVjdGVkKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLmFkZFRyYW5zY2VpdmVySW50ZXJuYWxcIikudGhlbihmdW5jdGlvbigpe3JldHVyblwic3RyaW5nXCI9PT10eXBlb2YgYT9jLnJlbW90ZUludm9rZSghMSx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmFkZFRyYW5zY2VpdmVyV2l0aEtpbmQsXHJcbmEsQyk6Yy5yZW1vdGVJbnZva2VFeCghMSx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmFkZFRyYW5zY2VpdmVyV2l0aFRyYWNrLFthXSxDKX0pLnRoZW4oZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLmFkZFRyYW5zY2VpdmVySW50ZXJuYWwoKSBzdWNjZXNzIHdpdGggb2lkOiBcIitjLnBhcmFtMChhKS5vaWQpO3guYmluZChjLGMucGFyYW0wKGEpLm9pZCk7eC5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkVHJhbnNjZWl2ZXJJbnRlcm5hbCgpOiBzdWNjZXNzXCIpO2MuZGVjcmVtZW50UGVuZGluZ1RyYW5zY2VpdmVyQ291bnQoKTtiKHgpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtjLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIucHJvcC5hZGRUcmFuc2NlaXZlckludGVybmFsKCkgZmFpbGVkIVwiKTtjLmRlY3JlbWVudFBlbmRpbmdUcmFuc2NlaXZlckNvdW50KCk7XHJcbmYoKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtjLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCJhZGRUcmFuc2NlaXZlckludGVybmFsKCkgZmFpbGVkIVwiKTtjLmRlY3JlbWVudFBlbmRpbmdUcmFuc2NlaXZlckNvdW50KCk7ZigpfSl9KTttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkVHJhbnNjZWl2ZXJJbnRlcm5hbCgpIHJldHVybmluZzpcIik7cmV0dXJuIGQ/Yjp4fTtiLnByb3RvdHlwZS5pbmNyZW1lbnRQZW5kaW5nVHJhbnNjZWl2ZXJDb3VudD1mdW5jdGlvbigpeysrdGhpcy5wZW5kaW5ndHJhbnNjZWl2ZXJffTtiLnByb3RvdHlwZS5kZWNyZW1lbnRQZW5kaW5nVHJhbnNjZWl2ZXJDb3VudD1mdW5jdGlvbigpezA8dGhpcy5wZW5kaW5ndHJhbnNjZWl2ZXJfJiYtLXRoaXMucGVuZGluZ3RyYW5zY2VpdmVyX307Yi5wcm90b3R5cGUuaW5jcmVtZW50UGVuZGluZ1RyYWNrQ291bnQ9ZnVuY3Rpb24oKXsrK3RoaXMucGVuZGluZ3RyYWNrX307Yi5wcm90b3R5cGUuZGVjcmVtZW50UGVuZGluZ1RyYWNrQ291bnQ9XHJcbmZ1bmN0aW9uKCl7MDx0aGlzLnBlbmRpbmd0cmFja18mJi0tdGhpcy5wZW5kaW5ndHJhY2tffTtiLnByb3RvdHlwZS53YWl0VHJhbnNjZWl2ZXJBbmRUcmFja1JlYWR5PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGQsYyl7bS5sb2dnZXIudHJhY2UoYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIud2FpdFRyYW5zY2VpdmVyQW5kVHJhY2tSZWFkeSgpOiBwZW5kaW5ndHJhbnNjZWl2ZXJfPVwiK2IucGVuZGluZ3RyYW5zY2VpdmVyXytcIiwgcGVuZGluZ3RyYWNrXz1cIitiLnBlbmRpbmd0cmFja18pO2lmKDA9PWIucGVuZGluZ3RyYW5zY2VpdmVyXyYmMD09Yi5wZW5kaW5ndHJhY2tfKXtmb3IoO2IuZGVmZXJyZWRPZmZlckFuc3dlcnMmJjA8Yi5kZWZlcnJlZE9mZmVyQW5zd2Vycy5sZW5ndGg7KWIuZGVmZXJyZWRPZmZlckFuc3dlcnMuc2hpZnQoKS5wb3N0KCEwKTtkKCl9ZWxzZSBiLmRlZmVycmVkT2ZmZXJBbnN3ZXJzLnB1c2gobmV3IGsuZGVmZXJyZWRfYWN0aW9uKGQsXHJcbmMsYSkpLGIuY2hlY2tUcmFuc2NlaXZlckFuZFRyYWNrKDYwMCwyNSl9KX07Yi5wcm90b3R5cGUuY2hlY2tUcmFuc2NlaXZlckFuZFRyYWNrPWZ1bmN0aW9uKGEsYil7dmFyIGQ9dGhpcztpZigwPj1hKWZvcihtLmxvZ2dlci5sb2coXCIuY2hlY2tUcmFuc2NlaXZlckFuZFRyYWNrKCkgdGltZW91dCB3YWl0aW5nIGZvciB0cmFuc2NlaXZlciByZWFkeSFcIik7dGhpcy5kZWZlcnJlZE9mZmVyQW5zd2VycyYmMDx0aGlzLmRlZmVycmVkT2ZmZXJBbnN3ZXJzLmxlbmd0aDspdGhpcy5kZWZlcnJlZE9mZmVyQW5zd2Vycy5zaGlmdCgpLnBvc3QoITEpO2Vsc2Ugc2V0VGltZW91dChmdW5jdGlvbihhKXtpZigwPT1kLnBlbmRpbmd0cmFuc2NlaXZlcl8mJjA9PWQucGVuZGluZ3RyYWNrXylmb3IoO2QuZGVmZXJyZWRPZmZlckFuc3dlcnMmJjA8ZC5kZWZlcnJlZE9mZmVyQW5zd2Vycy5sZW5ndGg7KWQuZGVmZXJyZWRPZmZlckFuc3dlcnMuc2hpZnQoKS5wb3N0KCEwKTtlbHNlIG0ubG9nZ2VyLmxvZygnLmNoZWNrVHJhbnNjZWl2ZXJBbmRUcmFjaygpOiBjb3VudD0gXCInK1xyXG5hKSxkLmNoZWNrVHJhbnNjZWl2ZXJBbmRUcmFjaygtLWEsYil9LGIsYSl9O2IucHJvdG90eXBlLmdldFRyYW5zY2VpdmVycz1mdW5jdGlvbigpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRUcmFuc2NlaXZlcnMoKSBjYWxsZWQuIFwiKTtpZih0aGlzLnVzaW5nYXN5bmNvbmx5Xyl0aHJvdyBtLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0VHJhbnNjZWl2ZXJzKCk6IHRocm93aW5nIGV4Y2VwdGlvbjogbm90IGFsbG93ZWQgd2hlbiB1c2luZ0FzeW5jT25seSBpcyB0cnVlISEhXCIpLG5ldyBET01FeGNlcHRpb24oXCIuZ2V0VHJhbnNjZWl2ZXJzKCkgbm90IGFsbG93ZWQgd2hlbiB1c2luZ0FzeW5jT25seSBpcyB0cnVlISEhXCIpO3RoaXMuZ2V0VHJhbnNjZWl2ZXJzQXN5bmMoKTttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0VHJhbnNjZWl2ZXJzKCkgcmV0dXJuaW5nOlwiK3RoaXMudHJhbnNjZWl2ZXJzXy5sZW5ndGgrXHJcblwiIGl0ZW1zXCIpO3JldHVybiB0aGlzLnRyYW5zY2VpdmVyc199O2IucHJvdG90eXBlLmdldFRyYW5zY2VpdmVyc0FzeW5jPWZ1bmN0aW9uKCl7dmFyIGE9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0VHJhbnNjZWl2ZXJzQXN5bmMoKSBjYWxsZWQuIFwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixkKXtpZighYS5pc1VuaWZpZWQoKSlyZXR1cm4gbS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFRyYW5zY2VpdmVyc0FzeW5jKCkgY2FsbGVkIGluIG5vbi1VbmlmaWVkLiBcIiksUHJvbWlzZS5yZXNvbHZlKGEudHJhbnNjZWl2ZXJzXyk7YS53YWl0VW50aWxDb25uZWN0ZWQoYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0VHJhbnNjZWl2ZXJzQXN5bmNcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBhLnJlbW90ZUludm9rZSghMSx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmdldFRyYW5zY2VpdmVycyl9KS50aGVuKGZ1bmN0aW9uKGQpe20ubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuZ2V0VHJhbnNjZWl2ZXJzQXN5bmMoKSByZW1vdGUgc3VjY2Vzcy5cIik7dmFyIGM9W10sZz1bXTtkLnBhcmFtc1swXS5mb3JFYWNoKGZ1bmN0aW9uKGIpe3ZhciBmPWEudHJhbnNjZWl2ZXJzXy5maW5kKGZ1bmN0aW9uKGEpe3JldHVybiBhLm9iamVjdF9pZCgpPT09Yi5vaWR9KTt2b2lkIDA9PT1mJiYobS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiIGFkZGluZyBhIFJ0cFRyYW5zY2VpdmVyIHdpdGggb2lkOlwiK2Iub2lkKSxmPW5ldyB6LlJ0cFRyYW5zY2VpdmVyKGEsYi5vaWQsay5Qcm94eU1vZGUuUmVtb3RlLGEuaXNVbmlmaWVkKCkpKTtnLnB1c2goZi5zeW5jQmFycmllcigpKTtjLnB1c2goZil9KTtQcm9taXNlLmFsbChnKS50aGVuKGZ1bmN0aW9uKCl7YS50cmFuc2NlaXZlcnNfPWM7bS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnByb3AuZ2V0VHJhbnNjZWl2ZXJzQXN5bmM6IHJldHVybmluZyB0cmFuc2NlaXZlciB3aXRoIGlkcyBbXCIrYS50cmFuc2NlaXZlcnNfLm1hcChmdW5jdGlvbihhKXtyZXR1cm4gYS5vYmplY3RfaWQoKX0pK1xyXG5cIl1cIik7YihhLnRyYW5zY2VpdmVyc18pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihkKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGQsXCIucHJvcC5nZXRUcmFuc2NlaXZlcnNBc3luYygpIGZhaWxlZCFcIik7YS50cmFuc2NlaXZlcnNfPVtdO2IoYS50cmFuc2NlaXZlcnNfKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihkKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGQsXCIuZ2V0VHJhbnNjZWl2ZXJzQXN5bmMoKSBmYWlsZWQhXCIpO2EudHJhbnNjZWl2ZXJzXz1bXTtiKGEudHJhbnNjZWl2ZXJzXyl9KX0pfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJzY3RwXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNjdHBffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9uZGF0YWNoYW5uZWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub25kYXRhY2hhbm5lbF99LHNldDpmdW5jdGlvbihhKXt2YXIgYj1cclxudGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uZGF0YWNoYW5uZWwoKSBjYWxsZWQuXCIpO3RoaXMub25kYXRhY2hhbm5lbF89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmRhdGFjaGFubmVsXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgZD1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGIuaXNOdWxsQ2FsbGJhY2soYSksdC5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdC5vbmRhdGFjaGFubmVsKTtkLnRoZW4oZnVuY3Rpb24oYSl7bS5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uZGF0YWNoYW5uZWwgY2FsbGJhY2sgcmVjZWl2ZWQhISFcIik7aWYobnVsbD09PWIucmVtb3RlZGF0YWNoYW5uZWxffHxiLnJlbW90ZWRhdGFjaGFubmVsXy5vYmplY3RfaWQoKSE9Yi5wYXJhbTAoYSkub2lkKWIucmVtb3RlZGF0YWNoYW5uZWxfPW5ldyBCLlJ0Y0RhdGFDaGFubmVsKGIsYi5wYXJhbTAoYSkub2lkLFxyXG5rLlByb3h5TW9kZS5SZW1vdGUpLGIucmVtb3RlZGF0YWNoYW5uZWxfLnN5bmNCYXJyaWVyKCkudGhlbihmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcInJlbW90ZWRhdGFjaGFubmVsXy5zeW5jQmFycmllcigpOiBzdWNjZXNzXCIpO3ZhciBhPW5ldyBFdmVudChcIm9uZGF0YWNoYW5uZWxcIik7YS5jaGFubmVsPWIucmVtb3RlZGF0YWNoYW5uZWxfO2lmKGIubG9jYWxkYXRhY2hhbm5lbF8mJiFiLmxvY2FsZGF0YWNoYW5uZWxfLmlzZGVzdHJveWVkKCkpYi5sb2NhbGRhdGFjaGFubmVsXy5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCJvbmRhdGFjaGFubmVsKCk6IG5vdGlmeWluZy4uLlwiKTtpZihiLm9uZGF0YWNoYW5uZWxfKWIub25kYXRhY2hhbm5lbF8oYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wibG9jYWxkYXRhY2hhbm5lbF8uc3luY0JhcnJpZXIoKTogZmFpbGVkIVwiKX0pO1xyXG5lbHNlIGlmKG0ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIm9uZGF0YWNoYW5uZWwoKTogbm90aWZ5aW5nLi4uXCIpLGIub25kYXRhY2hhbm5lbF8pYi5vbmRhdGFjaGFubmVsXyhhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCJyZW1vdGVkYXRhY2hhbm5lbF8uc3luY0JhcnJpZXIoKTogZmFpbGVkIVwiKX0pfSk7cmV0dXJuIGIucmVtb3RlSW52b2tlKCEwLHQubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3Qub25kYXRhY2hhbm5lbCxkLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe20ubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmRhdGFjaGFubmVsKCkgZmFpbGVkLlwiKX0pfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmZpeERhdGFDaGFubmVsQ29uZmlnPWZ1bmN0aW9uKGEpe20ubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5maXhEYXRhQ2hhbm5lbENvbmZpZygpIGNhbGxlZDogXCIrXHJcbmEpO3ZvaWQgMD09YSYmKGE9e30pO3ZvaWQgMD09YS5uZWdvdGlhdGVkJiZ2b2lkIDA9PWEuaWQmJihhLm5lZ290aWF0ZWQ9ITEsYS5pZD0tMSk7cmV0dXJuIGF9O2IucHJvdG90eXBlLmNyZWF0ZURhdGFDaGFubmVsPWZ1bmN0aW9uKGEsYil7dmFyIGQ9dGhpczttLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY3JlYXRlRGF0YUNoYW5uZWwoKSBjYWxsZWQuIGxhYmVsOlwiK2EpO3RoaXMubG9jYWxkYXRhY2hhbm5lbF89bmV3IEIuUnRjRGF0YUNoYW5uZWwodGhpcywwLGsuUHJveHlNb2RlLlBzZXVkbyk7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY3JlYXRlRGF0YUNoYW5uZWxcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBkLnJlbW90ZUludm9rZSghMSx0Lm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90LmNyZWF0ZURhdGFDaGFubmVsLGEsZC5maXhEYXRhQ2hhbm5lbENvbmZpZyhiKSl9KS50aGVuKGZ1bmN0aW9uKGEpe20ubG9nZ2VyLmxvZyhkLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuY3JlYXRlRGF0YUNoYW5uZWwoKSBzdWNjZXNzIHdpdGggb2lkOiBcIitkLnBhcmFtMChhKS5vaWQpO2QubG9jYWxkYXRhY2hhbm5lbF8uYmluZChkLGQucGFyYW0wKGEpLm9pZCk7ZC5sb2NhbGRhdGFjaGFubmVsXy5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oKXttLmxvZ2dlci5sb2coZC51c2VyX2ZyaWVuZGx5X2lkKCkrXCJjaGFubmVsLnN5bmNCYXJyaWVyKCk6IHN1Y2Nlc3NcIil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7bS5sb2dnZXIubG9nKGQudXNlcl9mcmllbmRseV9pZCgpK1wiY2hhbm5lbC5zeW5jQmFycmllcigpOiBmYWlsZWQhXCIpfSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9ZC5wYXJhbTAoYSk7bS5sb2dnZXIubG9nKGQudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZURhdGFDaGFubmVsKCkgZmFpbGVkIHdpdGggZXJyb3I6IFwiK2EpfSk7bS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNyZWF0ZURhdGFDaGFubmVsKCkgcmV0dXJuaW5nOiBcIitcclxudGhpcy5sb2NhbGRhdGFjaGFubmVsXyk7cmV0dXJuIHRoaXMubG9jYWxkYXRhY2hhbm5lbF99O3JldHVybiBifShrLlByb3h5T2JqZWN0KTthLlBlZXJDb25uZWN0aW9uPWJ9LDY1ODpmdW5jdGlvbihiLGEsYyl7dmFyIGU9dGhpcyYmdGhpcy5fX3NwcmVhZEFycmF5c3x8ZnVuY3Rpb24oKXtmb3IodmFyIGE9MCxiPTAsZD1hcmd1bWVudHMubGVuZ3RoO2I8ZDtiKyspYSs9YXJndW1lbnRzW2JdLmxlbmd0aDtmb3IodmFyIGE9QXJyYXkoYSksYz0wLGI9MDtiPGQ7YisrKWZvcih2YXIgZz1hcmd1bWVudHNbYl0scj0wLGU9Zy5sZW5ndGg7cjxlO3IrKyxjKyspYVtjXT1nW3JdO3JldHVybiBhfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTthLlByb3h5T2JqZWN0PWEuUHJveHlNb2RlPWEuUHJveHlSZWFkeVN0YXRlPWEubnVtYmVyX2FsbG9jYXRvcj1hLmNhbGxiYWNrPWEucnBjX2NhbGxiYWNrPWEuZGVmZXJyZWRfYWN0aW9uPXZvaWQgMDt2YXIgdT1cclxuYyg5NDYpLGg9Yyg4NTEpLGQ9Yyg1NDUpLHc9YygyNDcpLHE9Yyg1NTApLG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxjKXt0aGlzLnJlc29sdmU9Yjt0aGlzLnJlamVjdD1kO3RoaXMubmFtZV89Y31PYmplY3QuZGVmaW5lUHJvcGVydHkoYS5wcm90b3R5cGUsXCJuYW1lXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm5hbWVffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO2EucHJvdG90eXBlLnBvc3Q9ZnVuY3Rpb24oYSl7MT09YT8oaC5sb2dnZXIubG9nKCdkZWZlcnJlZF9hY3Rpb24ucG9zdCgpOiByZXNvbHZpbmcgXCInK3RoaXMubmFtZV8rJ1wiJyksdGhpcy5yZXNvbHZlKCkpOihoLmxvZ2dlci5sb2coJ2RlZmVycmVkX2FjdGlvbi5wb3N0KCk6IHJlamVjdGluZyBcIicrdGhpcy5uYW1lXysnXCInKSx0aGlzLnJlamVjdCgpKX07YS5wcm90b3R5cGUucG9zdFdpdGhSZXN1bHQ9ZnVuY3Rpb24oYSxiKXsxPT1hPyhoLmxvZ2dlci5sb2coJ2RlZmVycmVkX2FjdGlvbi5wb3N0KCk6IHJlc29sdmluZyBcIicrXHJcbnRoaXMubmFtZV8rJ1wiJyksdGhpcy5yZXNvbHZlKGIpKTooaC5sb2dnZXIubG9nKCdkZWZlcnJlZF9hY3Rpb24ucG9zdCgpOiByZWplY3RpbmcgXCInK3RoaXMubmFtZV8rJ1wiJyksdGhpcy5yZWplY3QoKSl9O2EucHJvdG90eXBlLnBvc3RSZXNvbHZlPWZ1bmN0aW9uKGEpe3RoaXMucmVzb2x2ZShhKX07YS5wcm90b3R5cGUucG9zdFJlamVjdD1mdW5jdGlvbihhKXt2b2lkIDA9PWE/dGhpcy5yZWplY3QoKTp0aGlzLnJlamVjdChhKX07cmV0dXJuIGF9KCk7YS5kZWZlcnJlZF9hY3Rpb249bjt2YXIgaz1mdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihhLGIpe3RoaXMuaWQ9YTt0aGlzLmlzX251bGw9Yn19KCk7YS5ycGNfY2FsbGJhY2s9azt2YXIgdj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkLGMpe3RoaXMuc3VjY2Vzcz1uZXcgayhiPDwxNixkKTt0aGlzLmZhaWw9bmV3IGsoYjw8MTZ8MSxkKTt0aGlzLmlkPWI7dGhpcy5vbmVTaG90PWN9YS5wcm90b3R5cGUucmVzb2x2ZT1mdW5jdGlvbihhKXtoLmxvZ2dlci50cmFjZShcImNhbGxiYWNrLnJlc29sdmUoKSBjYWxsZWQuIFtpZD1cIitcclxudGhpcy5pZCtcIl1cIik7bnVsbCE9dGhpcy5oYW5kbGVyJiZ0aGlzLmhhbmRsZXIoYSl9O2EucHJvdG90eXBlLnJlamVjdD1mdW5jdGlvbihhKXtudWxsIT10aGlzLmVycl9oYW5kbGVyJiZ0aGlzLmVycl9oYW5kbGVyKGEpfTthLnByb3RvdHlwZS50aGVuPWZ1bmN0aW9uKGEpe3RoaXMuaGFuZGxlcj1hfTthLnByb3RvdHlwZS5wcm9tPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixkKXthLmhhbmRsZXI9YjthLmVycl9oYW5kbGVyPWR9KX07cmV0dXJuIGF9KCk7YS5jYWxsYmFjaz12O3ZhciB6PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsYyl7dGhpcy5taW5fPWI8YS5CT1VORF9MT1d8fGI+YS5CT1VORF9ISUdIP2EuREVGX01JTjpiO3RoaXMubWF4Xz1kPGEuQk9VTkRfTE9XfHxkPmEuQk9VTkRfSElHSD9hLkRFRl9NQVg6ZDt0aGlzLmludGVydmFsXz1jPGEuQk9VTkRfTE9XfHxjPmEuQk9VTkRfSElHSD9hLkRFRl9JTlRFUlZBTDpjO3RoaXMubnVtYmVyc189XHJcbm5ldyBNYXA7dGhpcy5udW1iZXJzXy5zZXQodGhpcy5taW5fLHRoaXMubWF4Xyl9T2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwibWF4XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1heF99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwibWluXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1pbl99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwiaW50ZXJ2YWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJ2YWxffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLnByb3RvdHlwZSxcIm51bWJlcnNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubnVtYmVyc199LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7YS5wcm90b3R5cGUuYWxsb2NhdGU9XHJcbmZ1bmN0aW9uKCl7dmFyIGE9LTE7aWYoMDx0aGlzLm51bWJlcnNfLnNpemUpe3ZhciBiPUFycmF5LmZyb20odGhpcy5udW1iZXJzXy5rZXlzKCkpLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS1ifSlbMF0sZD10aGlzLm51bWJlcnNfLmdldChiKSxhPXRoaXMubWluXysoYi10aGlzLm1pbl8pKnRoaXMuaW50ZXJ2YWxfO3RoaXMubnVtYmVyc19bXCJkZWxldGVcIl0oYik7Yis9MTtiPGQmJnRoaXMubnVtYmVyc18uc2V0KGIsZCl9cmV0dXJuIGF9O2EucHJvdG90eXBlLmRlYWxsb2NhdGU9ZnVuY3Rpb24oYSl7dmFyIGI9QXJyYXkuZnJvbSh0aGlzLm51bWJlcnNfLmtleXMoKSkuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLWJ9KTthPShhLXRoaXMubWluXykvdGhpcy5pbnRlcnZhbF87Zm9yKHZhciBkPSExLGM9MDtjPGIubGVuZ3RoJiYoYltjXT09YSsxPyh0aGlzLm51bWJlcnNfLnNldChhLHRoaXMubnVtYmVyc18uZ2V0KGJbY10pKSx0aGlzLm51bWJlcnNfW1wiZGVsZXRlXCJdKGJbY10pLFxyXG5kPSEwKTp0aGlzLm51bWJlcnNfLmdldChiW2NdKT09YSYmKHRoaXMubnVtYmVyc18uc2V0KGJbY10sYSsxKSxjKzE8Yi5sZW5ndGgmJmJbYysxXT09YSsxJiYodGhpcy5udW1iZXJzXy5zZXQoYltjXSx0aGlzLm51bWJlcnNfLmdldChiW2MrMV0pKSx0aGlzLm51bWJlcnNfW1wiZGVsZXRlXCJdKGJbYysxXSkpLGQ9ITApLCFkKTtjKyspO2R8fHRoaXMubnVtYmVyc18uc2V0KGEsYSsxKX07YS5CT1VORF9MT1c9MDthLkJPVU5EX0hJR0g9NDI5NDk2NzI5NTthLkRFRl9NSU49MDthLkRFRl9NQVg9MTAyNDthLkRFRl9JTlRFUlZBTD0xO3JldHVybiBhfSgpO2EubnVtYmVyX2FsbG9jYXRvcj16O3ZhciBnOyhmdW5jdGlvbihhKXthW2EuTm90Q29uZmlndXJlZD0wXT1cIk5vdENvbmZpZ3VyZWRcIjthW2EuQ29uZmlndXJlZD0xXT1cIkNvbmZpZ3VyZWRcIjthW2EuRXJyb3I9Ml09XCJFcnJvclwiO2FbYS5EZXN0cm95ZWQ9M109XCJEZXN0cm95ZWRcIn0pKGc9YS5Qcm94eVJlYWR5U3RhdGV8fChhLlByb3h5UmVhZHlTdGF0ZT1cclxue30pKTt2YXIgQjsoZnVuY3Rpb24oYSl7YVthLkxvY2FsPTBdPVwiTG9jYWxcIjthW2EuUmVtb3RlPTFdPVwiUmVtb3RlXCI7YVthLlBzZXVkbz0yXT1cIlBzZXVkb1wifSkoQj1hLlByb3h5TW9kZXx8KGEuUHJveHlNb2RlPXt9KSk7Yj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixjLGsseCxyLEEpe3ZhciB6PXRoaXM7dm9pZCAwPT09ciYmKHI9bnVsbCk7dm9pZCAwPT09QSYmKEE9W10pO2Zvcih2YXIgdj1bXSxuPTY7bjxhcmd1bWVudHMubGVuZ3RoO24rKyl2W24tNl09YXJndW1lbnRzW25dO3RoaXMuaGR4bXM9dS5nZXRSZWRpcmVjdG9yKCk7dGhpcy5paWQ9Yzt0aGlzLm9pZD1rO3RoaXMubW9kZT14O3RoaXMucHJveHlzdGF0ZT1nLk5vdENvbmZpZ3VyZWQ7dGhpcy5kZWZlcnJlZEFjdGlvbnM9W107dGhpcy5wZW5kaW5nU3luY0JhcnJpZXJzPVtdO3RoaXMuY2JzPW5ldyBNYXA7aWYoeD09PUIuTG9jYWwpe249ITE7dGhpcy5paWQ9PT1xLmNsYXNzX2lkX3QuRW5naW5lQ29udHJvbCYmKG49XHJcbiEwKTt2YXIgbD10aGlzO3RoaXMuaGR4bXMuc3RhcnRSZWRpcmVjdGlvbihuLHRoaXMudXNlcl9mcmllbmRseV9pZCgpKS50aGVuKGZ1bmN0aW9uKCl7ei5vaWQ9YS5uZXh0SWQrKztoLmxvZ2dlci5sb2coei51c2VyX2ZyaWVuZGx5X2lkKCkrXCIgYXNzaWduZWQgbG9jYWwgb2lkOlwiK3oub2lkKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYSxiKXtsLndhaXRVbnRpbENvbm5lY3RlZEV4KGwudXNlcl9mcmllbmRseV9pZCgpK1wiLmN0b3IoKVwiLEEpLnRoZW4oZnVuY3Rpb24oKXtoLmxvZ2dlci5sb2cobC51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY3RvcigpIGFsbCBwYXJhbWV0ZXIgcnBjIG9iamVjdHMgYXJlIHJlYWR5LlwiKTt2YXIgYT1sLm9pZHNGcm9tUHJveHlPamJlY3RzKEEpLmNvbmNhdCh2KSxiPXEuV2VicnBjQ2xhc3NMaWJJbmZvVXRpbC5nZXRNZXRob2RGZWF0dXJlQnlpZChjLDApO3JldHVybiBsLmhkeG1zLldTU2VuZE9iamVjdFdyYXBwZXIoYixjLDAsZC5Xc0pzb25VdGlsLmNyZWF0ZU1lc3NhZ2VCeWlkLmFwcGx5KGQuV3NKc29uVXRpbCxcclxuZShbITEsITEsZC53c19tc2dfdHlwZV90LnJlcSxjLDAsbC5vaWRdLGEpKSl9KS50aGVuKGZ1bmN0aW9uKGIpe2gubG9nZ2VyLmxvZyhsLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jdG9yKCkgc3VjY2Vzcy5cIik7YShiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtoLmxvZ2dlci5sb2cobC51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY3RvcigpIGZhaWxlZC5cIik7YigpfSl9KX0pLnRoZW4oZnVuY3Rpb24oYSl7aC5sb2dnZXIudHJhY2UoXCJQcm94eU9iamVjdDogc2V0dGluZyBzdGF0ZSB0byBjb25maWd1cmVkLiAoaWlkOiBcIit6LmlpZCtcIiBvaWQ6IFwiK3oub2lkK1wiKVwiKTt2YXIgZD16Lm9pZDtsLnByb3h5c3RhdGU9Zy5Db25maWd1cmVkO2wub2lkPXoucGFyYW0wKGEpO2gubG9nZ2VyLmxvZyh6LnVzZXJfZnJpZW5kbHlfaWQoKStcIiBhc3NpZ25lZCByZW1vdGUgb2lkIGZvciBsb2NhbCBvaWQ6XCIrZCk7bC5vbkNvbm5lY3RlZCgpO3ImJnIoKTt3LmdldEdDKCkudHJhY2tPYmplY3QoeixiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtsLnByb3h5c3RhdGU9XHJcbmcuRXJyb3I7bC5vbkNvbm5lY3RlZCgpfSl9ZWxzZSB4PT09Qi5SZW1vdGUmJih0aGlzLnByb3h5c3RhdGU9Zy5Db25maWd1cmVkLHcuZ2V0R0MoKS50cmFja09iamVjdCh0aGlzLGIpKX1hLnByb3RvdHlwZS5zeW5jQmFycmllckRlZXA9ZnVuY3Rpb24oYSxiKXt2YXIgZD0hMDswPHRoaXMucGVuZGluZ1N5bmNCYXJyaWVycy5sZW5ndGgmJihkPSExKTt0aGlzLnBlbmRpbmdTeW5jQmFycmllcnMucHVzaChuZXcgbihhLGIsdGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXJcIikpO2gubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllckRlZXAoKSBxdWVpbmcgcmVxdWVzdCBmb3I6XCIrdGhpcy5vaWQrXCIsIHJ2OlwiK2QrXCIsIGl0ZW1zOlwiK3RoaXMucGVuZGluZ1N5bmNCYXJyaWVycy5sZW5ndGgpO3JldHVybiBkfTthLnByb3RvdHlwZS5zeW5jQmFycmllclJlc29sdmU9ZnVuY3Rpb24oYSl7Zm9yKGgubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuc3luY0JhcnJpZXJSZXNvbHZlKCkgaXRlbXM6XCIrdGhpcy5wZW5kaW5nU3luY0JhcnJpZXJzLmxlbmd0aCk7dGhpcy5wZW5kaW5nU3luY0JhcnJpZXJzJiYwPHRoaXMucGVuZGluZ1N5bmNCYXJyaWVycy5sZW5ndGg7KWgubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllclJlc29sdmUoKSBpdGVtczpcIit0aGlzLnBlbmRpbmdTeW5jQmFycmllcnMubGVuZ3RoK1wiIHJlc29sdmluZyByZXF1ZXN0IGZvcjpcIit0aGlzLm9pZCksdGhpcy5wZW5kaW5nU3luY0JhcnJpZXJzLnNoaWZ0KCkucG9zdFJlc29sdmUoYSl9O2EucHJvdG90eXBlLnN5bmNCYXJyaWVyUmVqZWN0PWZ1bmN0aW9uKGEpe2ZvcihoLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXJSZWplY3QoKSBpdGVtczpcIit0aGlzLnBlbmRpbmdTeW5jQmFycmllcnMubGVuZ3RoKTt0aGlzLnBlbmRpbmdTeW5jQmFycmllcnMmJjA8dGhpcy5wZW5kaW5nU3luY0JhcnJpZXJzLmxlbmd0aDspaC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5zeW5jQmFycmllclJlamVjdCgpIHJlamVjdGluZyByZXF1ZXN0IGZvcjpcIit0aGlzLm9pZCksdGhpcy5wZW5kaW5nU3luY0JhcnJpZXJzLnNoaWZ0KCkucG9zdFJlamVjdChhKX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwicHJveHlyZWFkeXN0YXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByb3h5c3RhdGV9LHNldDpmdW5jdGlvbihhKXt0aGlzLnByb3h5c3RhdGU9YX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTthLnByb3RvdHlwZS5iaW5kPWZ1bmN0aW9uKGEsYil7aC5sb2dnZXIudHJhY2UoXCJQcm94eU9iamVjdDogYmluZGluZyBvYmplY3QuIChpaWQ6IFwiK3RoaXMuaWlkK1wiIG9pZDogXCIrYitcIiBtb2RlOiBcIit0aGlzLm1vZGUrXCIpXCIpO2lmKHRoaXMubW9kZT09PUIuUHNldWRvKXt0aGlzLnByb3h5c3RhdGU9Zy5Db25maWd1cmVkO3ZhciBkPXRoaXMub2lkO3RoaXMub2lkPWI7aC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIiBhc3NpZ25lZCByZW1vdGUgb2lkIGZvciBsb2NhbCBvaWQ6XCIrZCk7dGhpcy5vbkNvbm5lY3RlZCgpO3cuZ2V0R0MoKS50cmFja09iamVjdCh0aGlzLGEpO3RoaXMubW9kZT1CLlJlbW90ZX1lbHNlIHRoaXMubW9kZT09PUIuUmVtb3RlP2gubG9nZ2VyLmxvZyhcIlByb3h5T2JqZWN0OiBiaW5kaW5nIGFscmVhZHkgY29tcGxldGUuXCIpOmgubG9nZ2VyLmxvZyhcIlByb3h5T2JqZWN0OiBiaW5kaW5nIGZhaWx1cmUuIGluY29ycmVjdCBtb2RlIVwiKX07YS5wcm90b3R5cGUucmVjb25zdHJ1Y3Rvcj1mdW5jdGlvbihhLGIsYyl7Zm9yKHZhciB4PXRoaXMscj1bXSxBPTM7QTxhcmd1bWVudHMubGVuZ3RoO0ErKylyW0EtM109YXJndW1lbnRzW0FdO3RoaXMucHJveHlzdGF0ZT1nLk5vdENvbmZpZ3VyZWQ7dGhpcy5kZWZlcnJlZEFjdGlvbnM9W107QT1xLldlYnJwY0NsYXNzTGliSW5mb1V0aWwuZ2V0TWV0aG9kRmVhdHVyZUJ5aWQoYiwwKTt0aGlzLmhkeG1zLldTU2VuZE9iamVjdFdyYXBwZXIoQSxcclxuYiwwLGQuV3NKc29uVXRpbC5jcmVhdGVNZXNzYWdlQnlpZC5hcHBseShkLldzSnNvblV0aWwsZShbITEsITEsZC53c19tc2dfdHlwZV90LnJlcSxiLDAsdGhpcy5vaWRdLHIpKSkudGhlbihmdW5jdGlvbihiKXtoLmxvZ2dlci50cmFjZShcIlByb3h5T2JqZWN0OiBzZXR0aW5nIHN0YXRlIHRvIGNvbmZpZ3VyZWQuIChpaWQ6IFwiK3guaWlkK1wiIG9pZDogXCIreC5vaWQrXCIpXCIpO3ZhciBkPXgub2lkO3gucHJveHlzdGF0ZT1nLkNvbmZpZ3VyZWQ7eC5vaWQ9eC5wYXJhbTAoYik7aC5sb2dnZXIubG9nKHgudXNlcl9mcmllbmRseV9pZCgpK1wiIGFzc2lnbmVkIHJlbW90ZSBvaWQgZm9yIGxvY2FsIG9pZDpcIitkKTt4Lm9uQ29ubmVjdGVkKCk7dy5nZXRHQygpLnRyYWNrT2JqZWN0KHgsYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7eC5wcm94eXN0YXRlPWcuRXJyb3I7eC5vbkNvbm5lY3RlZCgpfSl9O2EucHJvdG90eXBlLnNldFBhcmVudD1mdW5jdGlvbihhKXt3LmdldEdDKCkuc2V0UGFyZW50KHRoaXMsXHJcbmEpfTthLnByb3RvdHlwZS5yZWxlYXNlPWZ1bmN0aW9uKCl7aC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnJlbGVhc2UoKSBjYWxsZWQuXCIpO3cuZ2V0R0MoKS5yZWxlYXNlT2JqZWN0KHRoaXMpfTthLnByb3RvdHlwZS5kZXN0cm95PWZ1bmN0aW9uKCl7aC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmRlc3Ryb3koKSBjYWxsZWQuXCIpO3RoaXMucHJveHlzdGF0ZT1nLkRlc3Ryb3llZDt2YXIgYT1xLldlYnJwY0NsYXNzTGliSW5mb1V0aWwuZ2V0TWV0aG9kRmVhdHVyZUJ5aWQodGhpcy5paWQsMCk7dGhpcy5oZHhtcy5XU1NlbmRPYmplY3RXcmFwcGVyKGEsdGhpcy5paWQsMCxkLldzSnNvblV0aWwuY3JlYXRlTWVzc2FnZUJ5aWQoITEsITAsZC53c19tc2dfdHlwZV90LnJlcSx0aGlzLmlpZCwwLHRoaXMub2lkKSk7dGhpcy5jbGVhckNhbGxiYWNrcygpfTthLnByb3RvdHlwZS5pc2Rlc3Ryb3llZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnByb3h5c3RhdGU9PVxyXG5nLkRlc3Ryb3llZH07YS5wcm90b3R5cGUub25Db25uZWN0ZWQ9ZnVuY3Rpb24oKXtmb3IoO3RoaXMuZGVmZXJyZWRBY3Rpb25zJiYwPHRoaXMuZGVmZXJyZWRBY3Rpb25zLmxlbmd0aDspdGhpcy5kZWZlcnJlZEFjdGlvbnMuc2hpZnQoKS5wb3N0KHRoaXMucHJveHlzdGF0ZT09Zy5Db25maWd1cmVkKX07YS5wcm90b3R5cGUuaXNQc2V1ZG89ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlPT1CLlBzZXVkb307YS5wcm90b3R5cGUuY2hlY2tTdGF0ZT1mdW5jdGlvbihhLGIsZCl7dmFyIGM9dGhpczswPj1hPyhoLmxvZ2dlci5sb2coXCJQcm94eU9iamVjdC5jaGVja1N0YXRlKCkgdGltZW91dCB3YWl0aW5nIGZvciBjb25uZWN0aW9uIHJlc3BvbnNlISBmYWlsZWQuIChpaWQ6IFwiK2MuaWlkK1wiIG9pZDogXCIrYy5vaWQrXCJuYW1lOiBcIitkK1wiKVwiKSxjLm9uQ29ubmVjdGVkKCkpOnNldFRpbWVvdXQoZnVuY3Rpb24oYSxkKXtpZihjLnByb3h5c3RhdGU9PWcuQ29uZmlndXJlZCljLm9uQ29ubmVjdGVkKCk7XHJcbmVsc2UgaWYoYy5wcm94eXN0YXRlPT1nLkVycm9yKWMub25Db25uZWN0ZWQoKTtlbHNlIGlmKGMucHJveHlzdGF0ZT09Zy5EZXN0cm95ZWQpYy5vbkNvbm5lY3RlZCgpO2Vsc2UgYy5jaGVja1N0YXRlKC0tYSxiLGQpfSxiLGEsZCl9O2EucHJvdG90eXBlLndhaXRVbnRpbENvbm5lY3RlZD1mdW5jdGlvbihhKXt2YXIgYj10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihkLGMpe2I/KGgubG9nZ2VyLnRyYWNlKFwiUHJveHlPYmplY3Qud2FpdFVudGlsQ29ubmVjdGVkKCk6IHJlYWR5U3RhdGU9XCIrYi5wcm94eXN0YXRlK1wiLiAoaWlkOiBcIitiLmlpZCtcIiBvaWQ6IFwiK2Iub2lkK1wiKVwiKSxiLnByb3h5c3RhdGU9PWcuRGVzdHJveWVkPyhiLm9uQ29ubmVjdGVkKCksaC5sb2dnZXIudHJhY2UoXCJyZWplY3RpbmcgYWxyZWFkeSBkZXN0cm95ZWQgT2JqZWN0OlwiK2IudXNlcl9mcmllbmRseV9pZCgpKSxjKFwiT2JqZWN0IGFscmVhZHkgZGVzdHJveWVkIDpcIitiLnVzZXJfZnJpZW5kbHlfaWQoKSkpOlxyXG5iLnByb3h5c3RhdGU9PWcuQ29uZmlndXJlZD8oYi5vbkNvbm5lY3RlZCgpLGQoKSk6Yi5wcm94eXN0YXRlPT1nLkVycm9yPyhoLmxvZ2dlci50cmFjZShcIlByb3h5T2JqZWN0LndhaXRVbnRpbENvbm5lY3RlZCgpOiByZWFkeVN0YXRlPVwiK2IucHJveHlzdGF0ZStcIi4gKGlpZDogXCIrYi5paWQrXCIgb2lkOiBcIitiLm9pZCtcIilcIiksYi5vbkNvbm5lY3RlZCgpLGMoKSk6KGgubG9nZ2VyLmxvZygnUHJveHlPYmplY3Qud2FpdFVudGlsQ29ubmVjdGVkKCk6IGRlZmVycmluZyBhY3Rpb24gXCInK2ErJ1wiLiAoaWlkOiAnK2IuaWlkK1wiIG9pZDogXCIrYi5vaWQrXCIpXCIpLGIuZGVmZXJyZWRBY3Rpb25zLnB1c2gobmV3IG4oZCxjLGEpKSxiLmNoZWNrU3RhdGUoNjAwLDI1LGEpKSk6YyhcIkludmFsaWQgT2JqZWN0XCIpfSl9O2EucHJvdG90eXBlLnJlbW90ZUludm9rZT1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz1bXSxrPTI7azxhcmd1bWVudHMubGVuZ3RoO2srKyljW2stMl09YXJndW1lbnRzW2tdO2lmKHRoaXMucHJveHlzdGF0ZT09XHJcbmcuRGVzdHJveWVkKXJldHVybiBoLmxvZ2dlci50cmFjZShcInJlamVjdGluZyBhbHJlYWR5IGRlc3Ryb3llZCBPYmplY3Q6XCIrdGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkpLFByb21pc2UucmVqZWN0KFwiQ2Fubm90IGludm9rZSBkZXN0cm95ZWQgb2JqZWN0IDpcIit0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKSk7aWYodGhpcy5wcm94eXN0YXRlPT1nLkVycm9yKXJldHVybiBoLmxvZ2dlci50cmFjZShcInJlamVjdGluZyBhbHJlYWR5IGVycm9yIHN0YXRlIE9iamVjdDpcIit0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKSksUHJvbWlzZS5yZWplY3QoXCJDYW5ub3QgaW52b2tlIG9iamVjdCBpbiBFcnJvciBzdGF0ZTpcIit0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKSk7az1xLldlYnJwY0NsYXNzTGliSW5mb1V0aWwuZ2V0TWV0aG9kRmVhdHVyZUJ5aWQodGhpcy5paWQsYik7cmV0dXJuIHRoaXMuaGR4bXMuV1NTZW5kT2JqZWN0V3JhcHBlcihrLHRoaXMuaWlkLGIsZC5Xc0pzb25VdGlsLmNyZWF0ZU1lc3NhZ2VCeWlkLmFwcGx5KGQuV3NKc29uVXRpbCxcclxuZShbYSwhMSxkLndzX21zZ190eXBlX3QucmVxLHRoaXMuaWlkLGIsdGhpcy5vaWRdLGMpKSl9O2EucHJvdG90eXBlLndhaXRVbnRpbENvbm5lY3RlZEV4PWZ1bmN0aW9uKGEsYil7dmFyIGQ9dGhpcztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxnKXtpZihkKXtmb3IodmFyIGU9W10saz0wO2s8Yi5sZW5ndGg7aysrKXt2YXIgej1iW2tdO2lmKHogaW5zdGFuY2VvZiBBcnJheSlmb3IodmFyIHY9MDt2PHoubGVuZ3RoO3YrKyl7dmFyIHQ9elt2XTtlLnB1c2godC53YWl0VW50aWxDb25uZWN0ZWQoYStcIi5cIit0LnVzZXJfZnJpZW5kbHlfaWQoKSkpfWVsc2UgZS5wdXNoKHoud2FpdFVudGlsQ29ubmVjdGVkKGErXCIuXCIrei51c2VyX2ZyaWVuZGx5X2lkKCkpKX1Qcm9taXNlLmFsbChlKS50aGVuKGZ1bmN0aW9uKCl7aC5sb2dnZXIubG9nKGQudXNlcl9mcmllbmRseV9pZCgpK1wiLndhaXRVbnRpbENvbm5lY3RlZEV4KCkgc3VjY2Vzcy5cIik7YygpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtkLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXHJcblwiLndhaXRVbnRpbENvbm5lY3RlZEV4KCk6IGZhaWxlZC5cIik7ZygpfSl9ZWxzZSBnKFwiSW52YWxpZCBPYmplY3RcIil9KX07YS5wcm90b3R5cGUub2lkc0Zyb21Qcm94eU9qYmVjdHM9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVtdLGQ9MDtkPGEubGVuZ3RoO2QrKyl7dmFyIGM9YVtkXTtpZihjIGluc3RhbmNlb2YgQXJyYXkpe2Zvcih2YXIgZz1bXSxlPTA7ZTxjLmxlbmd0aDtlKyspZy5wdXNoKHtvaWQ6Y1tlXS5vYmplY3RfaWQoKX0pO2IucHVzaChnKX1lbHNlIGIucHVzaCh7b2lkOmMub2JqZWN0X2lkKCl9KX1yZXR1cm4gYn07YS5wcm90b3R5cGUucmVtb3RlSW52b2tlRXg9ZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgaz1bXSxyPTM7cjxhcmd1bWVudHMubGVuZ3RoO3IrKylrW3ItM109YXJndW1lbnRzW3JdO2lmKHRoaXMucHJveHlzdGF0ZT09Zy5EZXN0cm95ZWQpcmV0dXJuIGgubG9nZ2VyLnRyYWNlKFwicmVqZWN0aW5nIGFscmVhZHkgZGVzdHJveWVkIE9iamVjdDpcIit0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKSksXHJcblByb21pc2UucmVqZWN0KFwiQ2Fubm90IGludm9rZSBkZXN0cm95ZWQgb2JqZWN0IDpcIit0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKSk7aWYodGhpcy5wcm94eXN0YXRlPT1nLkVycm9yKXJldHVybiBoLmxvZ2dlci50cmFjZShcInJlamVjdGluZyBhbHJlYWR5IGVycm9yIHN0YXRlIE9iamVjdDpcIit0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKSksUHJvbWlzZS5yZWplY3QoXCJDYW5ub3QgaW52b2tlIG9iamVjdCBpbiBFcnJvciBzdGF0ZTpcIit0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKSk7dmFyIEE9dGhpcztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oZyxyKXtBLndhaXRVbnRpbENvbm5lY3RlZEV4KEEudXNlcl9mcmllbmRseV9pZCgpK1wiLnJlbW90ZUludm9rZUV4XCIsYykudGhlbihmdW5jdGlvbigpe2gubG9nZ2VyLmxvZyhBLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5yZW1vdGVJbnZva2VFeCgpIGFsbCBwYXJhbWV0ZXIgcnBjIG9iamVjdHMgYXJlIHJlYWR5LlwiKTt2YXIgZz1BLm9pZHNGcm9tUHJveHlPamJlY3RzKGMpLmNvbmNhdChrKSxcclxucj1xLldlYnJwY0NsYXNzTGliSW5mb1V0aWwuZ2V0TWV0aG9kRmVhdHVyZUJ5aWQoQS5paWQsYik7cmV0dXJuIEEuaGR4bXMuV1NTZW5kT2JqZWN0V3JhcHBlcihyLEEuaWlkLGIsZC5Xc0pzb25VdGlsLmNyZWF0ZU1lc3NhZ2VCeWlkLmFwcGx5KGQuV3NKc29uVXRpbCxlKFthLCExLGQud3NfbXNnX3R5cGVfdC5yZXEsQS5paWQsYixBLm9pZF0sZykpKX0pLnRoZW4oZnVuY3Rpb24oYSl7aC5sb2dnZXIubG9nKEEudXNlcl9mcmllbmRseV9pZCgpK1wiLnJlbW90ZUludm9rZUV4KCkgc3VjY2Vzcy5cIik7ZyhhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtoLmxvZ2dlci5sb2coQS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucmVtb3RlSW52b2tlRXgoKSBmYWlsZWQuXCIpO3IoKX0pfSl9O2EucHJvdG90eXBlLmxvZ1JlbW90ZUludm9rZUVycm9yPWZ1bmN0aW9uKGEsYil7dmFyIGQ9XCJcIixjPWE7Yz9kPWIrXCIgd2l0aCBlcnJvcjogXCIrSlNPTi5zdHJpbmdpZnkoYy5tZXNzYWdlKTooZD10aGlzLnBhcmFtMChhKSxcclxuYz0wIT09T2JqZWN0LmtleXMoZCkubGVuZ3RoP25ldyBET01FeGNlcHRpb24oYitcIiB3aXRoIGVycm9yOiBcIitKU09OLnN0cmluZ2lmeShkKSx0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKSk6bmV3IERPTUV4Y2VwdGlvbihiLHRoaXMudXNlcl9mcmllbmRseV9pZCgpKSxkPWMubWVzc2FnZSk7aC5sb2dnZXIubG9neCh0aGlzLmlzZGVzdHJveWVkKCksdGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrZCk7cmV0dXJuIGN9O2EucHJvdG90eXBlLmFsbG9jYXRlX2NiaWQ9ZnVuY3Rpb24oKXtyZXR1cm4gYS5jYmlkX2FsbG9jYXRvcl8uYWxsb2NhdGUoKX07YS5wcm90b3R5cGUuZGVhbGxvY2F0ZV9jYmlkPWZ1bmN0aW9uKGIpe2EuY2JpZF9hbGxvY2F0b3JfLmRlYWxsb2NhdGUoYil9O2EucHJvdG90eXBlLnJlZ2lzdGVyQ2FsbGJhY2tzPWZ1bmN0aW9uKGEsYixkKXt2YXIgYz10aGlzLGc9dGhpcy5hbGxvY2F0ZV9jYmlkKCk7YT1uZXcgdihnLGIsYSk7MD5nJiZoLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLnJlZ2lzdGVyQ2FsbGJhY2tzKCkuICEhISEgcmFuIG91dCBvZiBjYmlkICEhISFcIik7Ynx8KHRoaXMuY2JzLnNldChnLGQpLGEuY29tcGxldGlvbl9jYj1mdW5jdGlvbihhLGIpe2MudW5yZWdpc3RlckNhbGxiYWNrcyhhKX0sdGhpcy5oZHhtcy5yZWdpc3RlckhhbmRsZXIodGhpcy5paWQsdGhpcy5vaWQsZCxhKSk7cmV0dXJuIGF9O2EucHJvdG90eXBlLnVucmVnaXN0ZXJDYWxsYmFja3M9ZnVuY3Rpb24oYSl7dGhpcy5jYnMuaGFzKGEpPyh0aGlzLmhkeG1zLnVucmVnaXN0ZXJIYW5kbGVyKHRoaXMuaWlkLHRoaXMub2lkLGEpLHRoaXMuZGVhbGxvY2F0ZV9jYmlkKGEpLHRoaXMuY2JzW1wiZGVsZXRlXCJdKGEpKTpoLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIudW5yZWdpc3RlckNhbGxiYWNrcygpLiBtaWQ9XCIrdGhpcy5jYnMuZ2V0KGEpK1wiIGNiaWQ9XCIrYStcIiBDYW50IGZpbmQgY2FsbGJhY2sgaGFuZGxlciByZWdpc3RyYXRpb24hISEhXCIpfTthLnByb3RvdHlwZS5jbGVhckNhbGxiYWNrcz1cclxuZnVuY3Rpb24oKXtoLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY2xlYXJDYWxsYmFja3MoKS5cIik7Zm9yKHZhciBhPTAsYj1BcnJheS5mcm9tKHRoaXMuY2JzLmtleXMoKSk7YTxiLmxlbmd0aDthKyspe3ZhciBkPWJbYV07dGhpcy5oZHhtcy51bnJlZ2lzdGVySGFuZGxlcih0aGlzLmlpZCx0aGlzLm9pZCxkKTt0aGlzLmRlYWxsb2NhdGVfY2JpZChkKX10aGlzLmNicy5jbGVhcigpfTthLnByb3RvdHlwZS5vYmplY3RfaWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vaWR9O2EucHJvdG90eXBlLnBhcmFtMD1mdW5jdGlvbihhKXt2YXIgYj17fTthJiZhLnBhcmFtcyYmKGI9YS5wYXJhbXNbMF0pO3JldHVybiBifTthLnByb3RvdHlwZS5pc051bGxDYWxsYmFjaz1mdW5jdGlvbihhKXtyZXR1cm4gdm9pZCAwPT1hfHxudWxsPT1hfTthLnByb3RvdHlwZS51c2VyX2ZyaWVuZGx5X2lkPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jb25zdHJ1Y3Rvci5uYW1lOzA8PXRoaXMuaWlkJiZcclxuKGE9cS5jbGFzc19pZF90W3RoaXMuaWlkXSk7cmV0dXJuIGErXCJbXCIrdGhpcy5vaWQrXCJdXCJ9O2EucHJvdG90eXBlLmlzUmVkaXJlY3RlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhkeG1zLmlzUmVkaXJlY3RlZCgpfTthLnByb3RvdHlwZS5pc1ZhbGlkPWZ1bmN0aW9uKCl7cmV0dXJuISh0aGlzLnByb3h5c3RhdGU9PT1nLkVycm9yfHx0aGlzLnByb3h5c3RhdGU9PT1nLkRlc3Ryb3llZCl9O2EucHJvdG90eXBlLnJlZ2lzdGVyU3RhdGVDaGFuZ2VOb3RpZmljYXRpb249ZnVuY3Rpb24oYSl7dGhpcy5oZHhtcy5yZWdpc3RlclN0YXRlQ2hhbmdlTm90aWZpY2F0aW9uKGEpfTthLnByb3RvdHlwZS51bnJlZ2lzdGVyU3RhdGVDaGFuZ2VOb3RpZmljYXRpb249ZnVuY3Rpb24oYSl7dGhpcy5oZHhtcy51bnJlZ2lzdGVyU3RhdGVDaGFuZ2VOb3RpZmljYXRpb24oYSl9O2EubmV4dElkPTA7YS5DQklEX01BWD02NTUzNjthLmNiaWRfYWxsb2NhdG9yXz1uZXcgeigwLGEuQ0JJRF9NQVgsMSk7cmV0dXJuIGF9KCk7XHJcbmEuUHJveHlPYmplY3Q9Yn0sMTQ0OmZ1bmN0aW9uKGIsYSxjKXt2YXIgZT10aGlzJiZ0aGlzLl9fZXh0ZW5kc3x8ZnVuY3Rpb24oKXt2YXIgYT1mdW5jdGlvbihiLGQpe2E9T2JqZWN0LnNldFByb3RvdHlwZU9mfHx7X19wcm90b19fOltdfWluc3RhbmNlb2YgQXJyYXkmJmZ1bmN0aW9uKGEsYil7YS5fX3Byb3RvX189Yn18fGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBmIGluIGIpYi5oYXNPd25Qcm9wZXJ0eShmKSYmKGFbZl09YltmXSl9O3JldHVybiBhKGIsZCl9O3JldHVybiBmdW5jdGlvbihiLGQpe2Z1bmN0aW9uIGMoKXt0aGlzLmNvbnN0cnVjdG9yPWJ9YShiLGQpO2IucHJvdG90eXBlPW51bGw9PT1kP09iamVjdC5jcmVhdGUoZCk6KGMucHJvdG90eXBlPWQucHJvdG90eXBlLG5ldyBjKX19KCksdT10aGlzJiZ0aGlzLl9fYXdhaXRlcnx8ZnVuY3Rpb24oYSxiLGQsYyl7ZnVuY3Rpb24gZyhhKXtyZXR1cm4gYSBpbnN0YW5jZW9mIGQ/YTpuZXcgZChmdW5jdGlvbihiKXtiKGEpfSl9cmV0dXJuIG5ldyAoZHx8XHJcbihkPVByb21pc2UpKShmdW5jdGlvbihmLGQpe2Z1bmN0aW9uIHIoYSl7dHJ5e0MoYy5uZXh0KGEpKX1jYXRjaChiKXtkKGIpfX1mdW5jdGlvbiBlKGEpe3RyeXtDKGNbXCJ0aHJvd1wiXShhKSl9Y2F0Y2goYil7ZChiKX19ZnVuY3Rpb24gQyhhKXthLmRvbmU/ZihhLnZhbHVlKTpnKGEudmFsdWUpLnRoZW4ocixlKX1DKChjPWMuYXBwbHkoYSxifHxbXSkpLm5leHQoKSl9KX0saD10aGlzJiZ0aGlzLl9fZ2VuZXJhdG9yfHxmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGQoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBjKFthLGJdKX19ZnVuY3Rpb24gYyhkKXtpZihmKXRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO2Zvcig7ZzspdHJ5e2lmKGY9MSxyJiYoZT1kWzBdJjI/cltcInJldHVyblwiXTpkWzBdP3JbXCJ0aHJvd1wiXXx8KChlPXJbXCJyZXR1cm5cIl0pJiZlLmNhbGwociksMCk6ci5uZXh0KSYmIShlPWUuY2FsbChyLGRbMV0pKS5kb25lKXJldHVybiBlO1xyXG5pZihyPTAsZSlkPVtkWzBdJjIsZS52YWx1ZV07c3dpdGNoKGRbMF0pe2Nhc2UgMDpjYXNlIDE6ZT1kO2JyZWFrO2Nhc2UgNDpyZXR1cm4gZy5sYWJlbCsrLHt2YWx1ZTpkWzFdLGRvbmU6ITF9O2Nhc2UgNTpnLmxhYmVsKys7cj1kWzFdO2Q9WzBdO2NvbnRpbnVlO2Nhc2UgNzpkPWcub3BzLnBvcCgpO2cudHJ5cy5wb3AoKTtjb250aW51ZTtkZWZhdWx0OmlmKCEoZT1nLnRyeXMsZT0wPGUubGVuZ3RoJiZlW2UubGVuZ3RoLTFdKSYmKDY9PT1kWzBdfHwyPT09ZFswXSkpe2c9MDtjb250aW51ZX1pZigzPT09ZFswXSYmKCFlfHxkWzFdPmVbMF0mJmRbMV08ZVszXSkpZy5sYWJlbD1kWzFdO2Vsc2UgaWYoNj09PWRbMF0mJmcubGFiZWw8ZVsxXSlnLmxhYmVsPWVbMV0sZT1kO2Vsc2UgaWYoZSYmZy5sYWJlbDxlWzJdKWcubGFiZWw9ZVsyXSxnLm9wcy5wdXNoKGQpO2Vsc2V7ZVsyXSYmZy5vcHMucG9wKCk7Zy50cnlzLnBvcCgpO2NvbnRpbnVlfX1kPWIuY2FsbChhLGcpfWNhdGNoKEMpe2Q9XHJcbls2LENdLHI9MH1maW5hbGx5e2Y9ZT0wfWlmKGRbMF0mNSl0aHJvdyBkWzFdO3JldHVybnt2YWx1ZTpkWzBdP2RbMV06dm9pZCAwLGRvbmU6ITB9fXZhciBnPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZihlWzBdJjEpdGhyb3cgZVsxXTtyZXR1cm4gZVsxXX0sdHJ5czpbXSxvcHM6W119LGYscixlLGs7JGpzY29tcC5pbml0U3ltYm9sKCk7JGpzY29tcC5pbml0U3ltYm9sKCk7JGpzY29tcC5pbml0U3ltYm9sSXRlcmF0b3IoKTtyZXR1cm4gaz17bmV4dDpkKDApLFwidGhyb3dcIjpkKDEpLFwicmV0dXJuXCI6ZCgyKX0sXCJmdW5jdGlvblwiPT09dHlwZW9mIFN5bWJvbCYmKGtbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSksa307T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7YS5OYXZpZ2F0b3JVc2VyTWVkaWE9YS5SZW1vdGVNZWRpYVN0cmVhbUNvbnN0cmFpbnRzPWEuUmVtb3RlTWVkaWFUcmFja0NvbnN0cmFpbnRzPWEuUmVtb3RlTWVkaWFUcmFja0NvbnN0cmFpbnRTZXQ9XHJcbmEuUmVtb3RlRGV2aWNlcz1hLlJlbW90ZURldmljZUluZm89YS5EZXZpY2VJbmZvPWEuUmVtb3RlU3RyZWFtRXZlbnQ9YS5SZW1vdGVTdHJlYW09YS5SZW1vdGVNZWRpYVRyYWNrPWEuZW51bWVyYXRlZERldmljZXM9dm9pZCAwO3ZhciBkPWMoNTUwKSx3PWMoNjU4KSxxPWMoODUxKSxuPWMoOTQ2KSxrPWMoMzk0KSx2PWMoMjU5KSx6PWMoNjUwKSxnPWMoOTczKSxsO2EuZW51bWVyYXRlZERldmljZXM9bDt2YXIgdD1mdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihhLGIpe3RoaXMudHlwZT1hO3RoaXMudGFyZ2V0PWJ9fSgpLG09ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7dGhpcy5pc19sb2NhbF9jbG9uZT0hMTt0aGlzLmNsb25lX2lkPXRoaXMuY2xvbmVfY291bnQ9MH1hLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3RoaXMuY2xvbmVfY291bnQrKzt2YXIgYj1uZXcgYTtiLmlzX2xvY2FsX2Nsb25lPSEwO2IuY2xvbmVfaWQ9dGhpcy5jbG9uZV9jb3VudDtyZXR1cm4gYn07YS5wcm90b3R5cGUuc3luY2hyb25pemU9XHJcbmZ1bmN0aW9uKGEpe3JldHVybiB1KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbigpe3JldHVybiBoKHRoaXMsZnVuY3Rpb24oYil7cmV0dXJuIHRoaXMuaXNfbG9jYWxfY2xvbmU/WzIsYS5hc3luY0Nsb25lKCldOlsyLFByb21pc2UucmVzb2x2ZShhKV19KX0pfTtyZXR1cm4gYX0oKSxwPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYyxnLHIpe3ZvaWQgMD09PXImJihyPXcuUHJveHlNb2RlLlJlbW90ZSk7Yz1hLmNhbGwodGhpcyxjLGQuY2xhc3NfaWRfdC5NZWRpYVN0cmVhbVRyYWNrLGcscil8fHRoaXM7Yy5yZWZDb3VudF89MDtjLnJlZkNvdW50XysrO2MuY2xvbmVfc3RhdGU9bmV3IG07cmV0dXJuIGN9ZShiLGEpO2IucHJvdG90eXBlLmR1bXBJbmZvPWZ1bmN0aW9uKCl7cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmR1bXBJbmZvKCkgW2lkPVwiK3RoaXMuaWQrXCJdIGtpbmQ9XCIrdGhpcy5raW5kK1wiIGxhYmVsPVwiK3RoaXMubGFiZWwrXCIgcmVmY291bnQ9XCIrXHJcbnRoaXMucmVmY291bnQrXCIgZW5hYmxlZD1cIit0aGlzLmVuYWJsZWQrXCIgcmVhZHlTdGF0ZT1cIit0aGlzLnJlYWR5U3RhdGUpfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJyZWZjb3VudFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZWZDb3VudF99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuYWRkUmVmPWZ1bmN0aW9uKCl7dGhpcy5yZWZDb3VudF8rKztxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkUmVmKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl0gcmVmY291bnQ9XCIrdGhpcy5yZWZDb3VudF8pfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbmVuZGVkXCIse2dldDpmdW5jdGlvbigpe3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfb25lbmRlZCgpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO3JldHVybiB0aGlzLm9uZW5kZWRffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9XHJcbnRoaXM7cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbmVuZGVkKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7dGhpcy5vbmVuZGVkXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiTWVkaWFTdHJlYW1UcmFjay5vbmVuZGVkXCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCExLGIuaXNOdWxsQ2FsbGJhY2soYSksZC5tZXRob2RfaWRfTWVkaWFTdHJlYW1UcmFja190Lm9uZW5kZWQpO2MudGhlbihmdW5jdGlvbihhKXtxLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCJvbmVuZGVkIGV2ZW50IHJlY2VpdmVkISEhXCIpO2E9bmV3IHQoXCJlbmRlZFwiLGIpO2IucmVhZHlTdGF0ZV89XCJlbmRlZFwiO2Iub25lbmRlZF8oYSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsZC5tZXRob2RfaWRfTWVkaWFTdHJlYW1UcmFja190Lm9uZW5kZWQsYy5zdWNjZXNzKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFxyXG5cIi5vbmVuZGVkIGZhaWxlZCFcIil9KX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbm11dGVcIix7Z2V0OmZ1bmN0aW9uKCl7cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9vbm11dGUoKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1wiXVwiKTtyZXR1cm4gdGhpcy5vbm11dGVffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29ubXV0ZSgpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO3RoaXMub25tdXRlXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiTWVkaWFTdHJlYW1UcmFjay5vbm11dGVcIikudGhlbihmdW5jdGlvbigpe3ZhciBjPWIucmVnaXN0ZXJDYWxsYmFja3MoITEsYi5pc051bGxDYWxsYmFjayhhKSxkLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3Qub25tdXRlKTtjLnRoZW4oZnVuY3Rpb24oYSl7cS5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIm9ubXV0ZSBldmVudCByZWNlaXZlZCEhIVwiKTthPW5ldyB0KFwibXV0ZVwiLGIpO2IubXV0ZWQ9ITA7Yi5vbm11dGVfKGEpfSk7cmV0dXJuIGIucmVtb3RlSW52b2tlKCEwLGQubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5vbm11dGUsYy5zdWNjZXNzKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLm9ubXV0ZSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib251bm11dGVcIix7Z2V0OmZ1bmN0aW9uKCl7cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9vbnVubXV0ZSgpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO3JldHVybiB0aGlzLm9udW5tdXRlX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbnVubXV0ZSgpIGNhbGxlZC4gW2lkPVwiK1xyXG50aGlzLmlkK1wiXVwiKTt0aGlzLm9udW5tdXRlXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiTWVkaWFTdHJlYW1UcmFjay5vbnVubXV0ZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLGQubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5vbnVubXV0ZSk7Yy50aGVuKGZ1bmN0aW9uKGEpe3EubG9nZ2VyLmxvZyhcIm9udW5tdXRlIGV2ZW50IHJlY2VpdmVkISEhXCIpO2E9bmV3IHQoXCJ1bm11dGVcIixiKTtiLm11dGVkPSExO2Iub251bm11dGVfKGEpfSk7cmV0dXJuIGIucmVtb3RlSW52b2tlKCEwLGQubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5vbnVubXV0ZSxjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIub251bm11dGUgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcclxuXCJvbnN0b3BcIix7c2V0OmZ1bmN0aW9uKGEpe3RoaXMub25zdG9wXz1hfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImVuYWJsZWRcIix7Z2V0OmZ1bmN0aW9uKCl7cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9lbmFibGVkKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIiwgdmFsdWU9XCIrdGhpcy5lbmFibGVkXytcIl1cIik7cmV0dXJuIHRoaXMuZW5hYmxlZF99LHNldDpmdW5jdGlvbihhKXtxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X2VuYWJsZWQoKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1wiLCB2YWx1ZT1cIithK1wiXVwiKTt0aGlzLmVuYWJsZWRfPWE7dGhpcy5yZW1vdGVJbnZva2UoITAsZC5tZXRob2RfaWRfTWVkaWFTdHJlYW1UcmFja190LmVuYWJsZWQsYSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFxyXG5cInJlYWR5U3RhdGVcIix7Z2V0OmZ1bmN0aW9uKCl7cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9yZWFkeVN0YXRlKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7cmV0dXJuIHRoaXMucmVhZHlTdGF0ZV99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuYXN5bmNDbG9uZT1mdW5jdGlvbigpe3JldHVybiB1KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbigpe3ZhciBhLGMsZztyZXR1cm4gaCh0aGlzLGZ1bmN0aW9uKGYpe3N3aXRjaChmLmxhYmVsKXtjYXNlIDA6cmV0dXJuWzQsdGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJSZW1vdGVNZWRpYVRyYWNrLmFzeW5jQ2xvbmVcIildO2Nhc2UgMTpyZXR1cm4gZi5zZW50KCksWzQsdGhpcy5yZW1vdGVJbnZva2UoITEsZC5tZXRob2RfaWRfTWVkaWFTdHJlYW1UcmFja190LmNsb25lKV07Y2FzZSAyOnJldHVybiBhPWYuc2VudCgpLGM9dGhpcy5wYXJhbTAoYSksZz1uZXcgYih0aGlzLFxyXG5jLm9pZCksWzIsZy5zeW5jQmFycmllcigpXX19KX0pfTtiLnByb3RvdHlwZS5kZWVwQ2xvbmU9ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcztxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZGVlcENsb25lKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7aWYoei5SZW1vdGVTZXNzaW9uLmlzRmVhdHVyZVRyYWNrQ2xvbmVXaXRoSWRTdXBwb3J0ZWQoKSl7dmFyIGc9bmV3IGIobnVsbCwwLHcuUHJveHlNb2RlLlBzZXVkbyksZj1uZXcgbTtnLmlkPWE/YTp0aGlzLmlkK1wiLlwiK2YuY2xvbmVfaWQudG9TdHJpbmcoKTtnLmxhYmVsPXRoaXMubGFiZWw7Zy5raW5kPXRoaXMua2luZDtnLmVuYWJsZWRfPXRoaXMuZW5hYmxlZF87Zy5tdXRlZD10aGlzLm11dGVkO2cucmVhZHlTdGF0ZV89dGhpcy5yZWFkeVN0YXRlXztnLnRyYWNrU2V0dGluZ3NfPXRoaXMudHJhY2tTZXR0aW5nc187Zy5jbG9uZV9zdGF0ZT1mO2cuY29uc3RyYWludHNfPXRoaXMuY29uc3RyYWludHNfO2cuY2FwYWJpbGl0aWVzXz1cclxudGhpcy5jYXBhYmlsaXRpZXNfO2cub25lbmRlZD10aGlzLm9uZW5kZWQ7Zy5vbm11dGU9dGhpcy5vbm11dGU7Zy5vbnVubXV0ZT10aGlzLm9udW5tdXRlO2cub25zdG9wPXRoaXMub25zdG9wO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiUmVtb3RlTWVkaWFUcmFjay5kZWVwQ2xvbmVcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBjLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3QuY2xvbmUsZy5pZCl9KS50aGVuKGZ1bmN0aW9uKGEpe3EubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5kZWVwQ2xvbmUoKSBzdWNjZXNzIHdpdGggb2lkOiBcIitjLnBhcmFtMChhKS5vaWQpO2cuYmluZChudWxsLGMucGFyYW0wKGEpLm9pZCk7Zy5zeW5jQmFycmllcigpLnRoZW4oZnVuY3Rpb24oKXtxLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCJ0cmFjay5zeW5jQmFycmllcigpOiBzdWNjZXNzXCIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtjLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXHJcblwidHJhY2suc3luY0JhcnJpZXIoKSBmYWlsZWQhXCIpfSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2MubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5kZWVwQ2xvbmUoKSBmYWlsZWQhXCIpfSk7cmV0dXJuIGd9cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmRlZXBDbG9uZSgpIGlzIG5vdCBzdXBwb3J0ZWQhXCIpfTtiLnByb3RvdHlwZS5sb2NhbENsb25lPWZ1bmN0aW9uKCl7cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmxvY2FsQ2xvbmUoKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1wiXVwiKTt2YXIgYT10aGlzLmNsb25lX3N0YXRlLmNsb25lKCksZD1uZXcgYih0aGlzLHRoaXMub2JqZWN0X2lkKCkpO2QuaWQ9dGhpcy5pZCtcIi5cIithLmNsb25lX2lkLnRvU3RyaW5nKCk7ZC5sYWJlbD10aGlzLmxhYmVsO2Qua2luZD10aGlzLmtpbmQ7ZC5lbmFibGVkXz10aGlzLmVuYWJsZWRfO2QubXV0ZWQ9dGhpcy5tdXRlZDtkLnJlYWR5U3RhdGVfPXRoaXMucmVhZHlTdGF0ZV87XHJcbmQudHJhY2tTZXR0aW5nc189dGhpcy50cmFja1NldHRpbmdzXztkLmNsb25lX3N0YXRlPWE7ZC5jb25zdHJhaW50c189dGhpcy5jb25zdHJhaW50c187ZC5jYXBhYmlsaXRpZXNfPXRoaXMuY2FwYWJpbGl0aWVzXztyZXR1cm4gZH07Yi5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY2xvbmUoKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1wiXVwiKTtyZXR1cm4gei5SZW1vdGVTZXNzaW9uLmlzRmVhdHVyZVRyYWNrQ2xvbmVXaXRoSWRTdXBwb3J0ZWQoKT90aGlzLmRlZXBDbG9uZSgpOnRoaXMubG9jYWxDbG9uZSgpfTtiLnByb3RvdHlwZS5zdG9wPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3RvcCgpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdIHJlZmNvdW50PVwiK3RoaXMucmVmQ291bnRfKTt0aGlzLnJlYWR5U3RhdGVfPVwiZW5kZWRcIjtpZigwPHRoaXMucmVmQ291bnRfJiZcclxuKHRoaXMucmVmQ291bnRfLS0sMD09PXRoaXMucmVmQ291bnRfJiYocS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnN0b3AoKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1wiXSByZW1vdGUgaW52b2tpbmcuLi5cIiksdGhpcy5yZW1vdGVJbnZva2UoITEsZC5tZXRob2RfaWRfTWVkaWFTdHJlYW1UcmFja190LnN0b3ApW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLnN0b3AgZmFpbGVkIVwiKX0pLFwidmlkZW9cIj09dGhpcy5raW5kJiZcInJlbW90ZWFwcC10cmFja1wiPT10aGlzLmxhYmVsJiZnLlNjcmVlblNoYXJpbmcuc2NyZWVuU2hhcmluZ0luc3RhbmNlKCkuc3RvcEFwcHNoYXJlKCksbnVsbCE9PXRoaXMub25zdG9wXyYmdm9pZCAwIT10aGlzLm9uc3RvcF8pKSl0aGlzLm9uc3RvcF8oKX07Yi5wcm90b3R5cGUuZ2V0Q2FwYWJpbGl0aWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FwYWJpbGl0aWVzX307Yi5wcm90b3R5cGUuZ2V0Q29uc3RyYWludHM9XHJcbmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29uc3RyYWludHNffTtiLnByb3RvdHlwZS5nZXRTZXR0aW5ncz1mdW5jdGlvbigpe3JldHVyblwiYXVkaW9cIj09dGhpcy5raW5kP2Z1bmN0aW9uKGEpe3JldHVybntkZXZpY2VJZDphLmRldmljZUlkLGVjaG9DYW5jZWxsYXRpb246YS5lY2hvQ2FuY2VsbGF0aW9ufX0odGhpcy50cmFja1NldHRpbmdzXyk6ZnVuY3Rpb24oYSl7cmV0dXJue2FzcGVjdFJhdGlvOmEuYXNwZWN0UmF0aW8sZGV2aWNlSWQ6YS5kZXZpY2VJZCxmcmFtZVJhdGU6YS5mcmFtZVJhdGUsaGVpZ2h0OmEuaGVpZ2h0LHdpZHRoOmEud2lkdGh9fSh0aGlzLnRyYWNrU2V0dGluZ3NfKX07Yi5wcm90b3R5cGUuZ2V0Q2hhbm5lbENvdW50PWZ1bmN0aW9uKCl7cmV0dXJuIDJ9O2IucHJvdG90eXBlLmFwcGx5Q29uc3RyYWludHM9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYXBwbHlDb25zdHJhaW50cygpIGNhbGxlZC5cIik7XHJcbnJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihjLGYpe2Iud2FpdFVudGlsQ29ubmVjdGVkKFwiTWVkaWFTdHJlYW1UcmFjay5hcHBseUNvbnN0cmFpbnRzXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5hbGwoW2IucmVtb3RlSW52b2tlKCExLGQubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5hcHBseUNvbnN0cmFpbnRzLGEpLGIuc3luY0JhcnJpZXIoKV0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCJhcHBseUNvbnN0cmFpbnRzIGZhaWxlZCFcIik7Zih7bmFtZTpcIk92ZXJjb25zdHJhaW5lZEVycm9yXCIsbWVzc2FnZTpcIkZhaWxlZCB0byBhcHBseSBjb25zdHJhaW50cy5cIn0pfSkudGhlbihmdW5jdGlvbigpe2IuY29uc3RyYWludHNfPWE7cmV0dXJuIGIucmVtb3RlSW52b2tlKCExLGQubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5nZXRDb25zdHJhaW50cyl9KS50aGVuKGZ1bmN0aW9uKGEpe2IuY29uc3RyYWludHNfPVxyXG5iLnBhcmFtMChhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnN5bmNCYXJyaWVyKCkgcmVtb3RlIGNsaWVudCBkb2VzIG5vdCBzdXBwb3J0IGdldENvbnN0cmFpbnRzIG1ldGhvZC4gSWdub3JlIGl0XCIpfSkudGhlbihmdW5jdGlvbigpe3JldHVybiBjKCl9KX0pfTtiLmNvbnZlcnRSZWFkeVN0YXRlPWZ1bmN0aW9uKGEpe3JldHVybiAwPT1hP1wibGl2ZVwiOlwiZW5kZWRcIn07Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllcigpIGNhbGxlZC5cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsZyl7YS5zeW5jQmFycmllckRlZXAoYyxnKSYmYS53YWl0VW50aWxDb25uZWN0ZWQoXCJNZWRpYVN0cmVhbVRyYWNrLnN5bmNCYXJyaWVyXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gUHJvbWlzZS5hbGwoW2EucmVtb3RlSW52b2tlKCExLFxyXG5kLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3Qua2luZCxcIlwiKSxhLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3QuaWQsXCJcIiksYS5yZW1vdGVJbnZva2UoITEsZC5tZXRob2RfaWRfTWVkaWFTdHJlYW1UcmFja190LmxhYmVsLFwiXCIpLGEucmVtb3RlSW52b2tlKCExLGQubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5lbmFibGVkLCExKSxhLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3QubXV0ZWQsITEpLGEucmVtb3RlSW52b2tlKCExLGQubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5yZWFkeVN0YXRlLDApLGEucmVtb3RlSW52b2tlKCExLGQubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdC5nZXRTZXR0aW5ncyksYS5yZW1vdGVJbnZva2UoITEsZC5tZXRob2RfaWRfTWVkaWFTdHJlYW1UcmFja190LmdldENhcGFiaWxpdGllcyldKX0pLnRoZW4oZnVuY3Rpb24oZil7dmFyIGQ9MDtmPWYubWFwKGZ1bmN0aW9uKGIpe3JldHVybiBhLnBhcmFtMChiKX0pO1xyXG5hLmtpbmQ9ZlswXTthLmlkPWZbMV07YS5sYWJlbD1mWzJdO2EuZW5hYmxlZF89ZlszXTthLm11dGVkPWZbNF07ZD1mWzVdO2EudHJhY2tTZXR0aW5nc189Zls2XTthLmNhcGFiaWxpdGllc189Zls3XTthLnJlYWR5U3RhdGVfPWIuY29udmVydFJlYWR5U3RhdGUoZCk7YS5zeW5jQmFycmllclJlc29sdmUoYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2I9YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLnN5bmNCYXJyaWVyKCkgZmFpbGVkIVwiKTthLnN5bmNCYXJyaWVyUmVqZWN0KGIpfSl9KX07Yi5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5kaXNwb3NlKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7dGhpcy5zdG9wKCk7MD09PXRoaXMucmVmQ291bnRfJiZ0aGlzLnJlbGVhc2UoKX07cmV0dXJuIGJ9KHcuUHJveHlPYmplY3QpO2EuUmVtb3RlTWVkaWFUcmFjaz1wO3ZhciB5PWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7fX0oKSxcclxueD1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKGMsZyxyLGYsZSl7dm9pZCAwPT09ciYmKHI9dy5Qcm94eU1vZGUuTG9jYWwpO3ZvaWQgMD09PWYmJihmPVtdKTt2YXIgaz10aGlzO3EubG9nZ2VyLmxvZyhcIlJlbW90ZVN0cmVhbS5jdG9yKCkgc3RyZWFtaWQ9XCIrZStcIiBudW0gdHJhY2tzPVwiK2YubGVuZ3RoKTtyPT13LlByb3h5TW9kZS5SZW1vdGV8fGV8fChlPWIudXVpZHY0KCkpO2s9ZSYmei5SZW1vdGVTZXNzaW9uLmlzRmVhdHVyZVRyYWNrQ2xvbmVXaXRoSWRTdXBwb3J0ZWQoKT9hLmNhbGwodGhpcyxjLGQuY2xhc3NfaWRfdC5NZWRpYVN0cmVhbSxnLHIsbnVsbCxbZl0sZSl8fHRoaXM6YS5jYWxsKHRoaXMsYyxkLmNsYXNzX2lkX3QuTWVkaWFTdHJlYW0sZyxyLG51bGwsW2ZdKXx8dGhpcztrLmlkPWU7ay50cmFja3NfPWY7ay5jbG9uZV9zdGF0ZT1uZXcgbTtrLmFjdGl2ZV89ITA7ay50cmFja3NfLmZvckVhY2goZnVuY3Rpb24oYSl7YS5zZXRQYXJlbnQoayl9KTtyZXR1cm4ga31lKGIsXHJcbmEpO2IudXVpZHY0PWZ1bmN0aW9uKCl7cmV0dXJuXCIxMDAwMDAwMC0xMDAwLTQwMDAtODAwMC0xMDAwMDAwMDAwMDBcIi5yZXBsYWNlKC9bMDE4XS9nLGZ1bmN0aW9uKGEpe3JldHVybihhXmNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMSkpWzBdJjE1Pj5hLzQpLnRvU3RyaW5nKDE2KX0pfTtiLnByb3RvdHlwZS5kdW1wSW5mbz1mdW5jdGlvbigpe3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5kdW1wSW5mbygpIFtpZD1cIit0aGlzLmlkK1wiXSBhY3RpdmU9XCIrdGhpcy5hY3RpdmVfK1wiIG51bSB0cmFja3M9XCIrdGhpcy50cmFja3NfLmxlbmd0aCk7Zm9yKHZhciBhPTAsYj10aGlzLnRyYWNrc187YTxiLmxlbmd0aDthKyspe3ZhciBkPWJbYV07ZCYmZC5kdW1wSW5mbygpfX07Yi5wcm90b3R5cGUudG9nZ2xlQXVkaW89ZnVuY3Rpb24oYSl7cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnRvZ2dsZUF1ZGlvKCkgY2FsbGVkOiBcIitcclxuYSk7Zm9yKHZhciBiPTAsZD10aGlzLmdldEF1ZGlvVHJhY2tzKCk7YjxkLmxlbmd0aDtiKyspZFtiXS5lbmFibGVkPWF9O2IucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3ZhciBhPW5ldyB5O2EuaWQ9dGhpcy5pZDthLmFjdGl2ZT10aGlzLmFjdGl2ZV87YS5vaWQ9dGhpcy5vYmplY3RfaWQoKTtyZXR1cm5cIlJlbW90ZVN0cmVhbTpcIitKU09OLnN0cmluZ2lmeShhKX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwiYWN0aXZlXCIse2dldDpmdW5jdGlvbigpe3ZhciBhPXRoaXM7cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldCBhY3RpdmUoKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1wiXSBhY3RpdmU9XCIrdGhpcy5hY3RpdmVfKTtuLmdldFJlZGlyZWN0b3IoKS5nZXRGZWF0dXJlVmFsdWUoZC5GRUFUVVJFX21zX3RlYW1zX3N0cmVhbV9hY3RpdmVfc3RhdHVzKT90aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIk1lZGlhU3RyZWFtLmFjdGl2ZVwiKS50aGVuKGZ1bmN0aW9uKCl7cS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5nZXQgYWN0aXZlKCkgcmVtb3RlIGludm9raW5nXCIpO3JldHVybiBhLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9NZWRpYVN0cmVhbV90LmFjdGl2ZSwhMSl9KS50aGVuKGZ1bmN0aW9uKGIpe2EuYWN0aXZlXz1hLnBhcmFtMChiKTtxLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0IGFjdGl2ZSgpIHN1Y2Nlc3MsIGFjdGl2ZT1cIithLmFjdGl2ZV8pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXthLmFjdGl2ZV89ITA7YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLmdldCBhY3RpdmUoKSBmYWlsZWQhIGFjdGl2ZT1cIithLmFjdGl2ZV8pfSk6dGhpcy5hY3RpdmVfPSEwO3JldHVybiB0aGlzLmFjdGl2ZV99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuZ2V0QXVkaW9UcmFja3M9ZnVuY3Rpb24oKXtxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0QXVkaW9UcmFja3MoKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1xyXG5cIl1cIik7Zm9yKHZhciBhPVtdLGI9MCxkPXRoaXMudHJhY2tzXztiPGQubGVuZ3RoO2IrKyl7dmFyIGY9ZFtiXTtcImF1ZGlvXCI9PWYua2luZCYmYS5wdXNoKGYpfXJldHVybiBhfTtiLnByb3RvdHlwZS5nZXRWaWRlb1RyYWNrcz1mdW5jdGlvbigpe3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRWaWRlb1RyYWNrcygpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO2Zvcih2YXIgYT1bXSxiPTAsZD10aGlzLnRyYWNrc187YjxkLmxlbmd0aDtiKyspe3ZhciBmPWRbYl07XCJ2aWRlb1wiPT1mLmtpbmQmJmEucHVzaChmKX1yZXR1cm4gYX07Yi5wcm90b3R5cGUuZ2V0VHJhY2tzPWZ1bmN0aW9uKCl7cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFRyYWNrcygpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO3JldHVybiB0aGlzLnRyYWNrc199O2IucHJvdG90eXBlLmdldFRyYWNrQnlJZD1mdW5jdGlvbihhKXtxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLmdldFRyYWNrQnlJZCgpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO2Zvcih2YXIgYj0wLGQ9dGhpcy50cmFja3NfO2I8ZC5sZW5ndGg7YisrKXt2YXIgZj1kW2JdO2lmKGYuaWQ9PWEpcmV0dXJuIGZ9fTtiLnByb3RvdHlwZS5hZGRUcmFjaz1mdW5jdGlvbihhKXt2YXIgYj10aGlzO3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5hZGRUcmFjaygpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO3RoaXMudHJhY2tzXy5wdXNoKGEpO2EmJmEuZHVtcEluZm8oKTt2YXIgYz10aGlzO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiTWVkaWFTdHJlYW0uYWRkVHJhY2tcIikudGhlbihmdW5jdGlvbigpe3EubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5hZGRUcmFjayByZW1vdGUgaW52b2tpbmdcIik7cmV0dXJuIGMucmVtb3RlSW52b2tlRXgoITEsZC5tZXRob2RfaWRfTWVkaWFTdHJlYW1fdC5hZGRUcmFjayxbYV0pfSkudGhlbihmdW5jdGlvbigpe3EubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuYWRkVHJhY2sgc3VjY2Vzc1wiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLmFkZFRyYWNrIGZhaWxlZCFcIil9KX07Yi5wcm90b3R5cGUucmVtb3ZlVHJhY2s9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucmVtb3ZlVHJhY2soKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1wiXVwiKTt2YXIgYz10aGlzLnRyYWNrc18uaW5kZXhPZihhKTt0aGlzLnRyYWNrc18uc3BsaWNlKGMsMSk7dmFyIGY9dGhpczt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIk1lZGlhU3RyZWFtLnJlbW92ZVRyYWNrXCIpLnRoZW4oZnVuY3Rpb24oKXtxLmxvZ2dlci5sb2coZi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucmVtb3ZlVHJhY2sgcmVtb3RlIGludm9raW5nXCIpO3JldHVybiBmLnJlbW90ZUludm9rZUV4KCExLGQubWV0aG9kX2lkX01lZGlhU3RyZWFtX3QucmVtb3ZlVHJhY2ssW2FdKX0pLnRoZW4oZnVuY3Rpb24oKXtxLmxvZ2dlci5sb2coZi51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLnJlbW92ZVRyYWNrIHN1Y2Nlc3NcIil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5yZW1vdmVUcmFjayBmYWlsZWQhXCIpfSl9O2IucHJvdG90eXBlLmFzeW5jQ2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24oKXt2YXIgYSxjLGc7cmV0dXJuIGgodGhpcyxmdW5jdGlvbihmKXtzd2l0Y2goZi5sYWJlbCl7Y2FzZSAwOnJldHVybiBxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYXN5bmNDbG9uZSgpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpLFs0LHRoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiYXN5bmNDbG9uZVwiKV07Y2FzZSAxOnJldHVybiBmLnNlbnQoKSxbNCx0aGlzLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9NZWRpYVN0cmVhbV90LmNsb25lKV07Y2FzZSAyOnJldHVybiBhPWYuc2VudCgpLHEubG9nZ2VyLmxvZyhhKSxjPXRoaXMucGFyYW0wKGEpLGc9bmV3IGIodGhpcyxcclxuYy5vaWQsdy5Qcm94eU1vZGUuUmVtb3RlKSxbMixnLnN5bmNCYXJyaWVyKCldfX0pfSl9O2IucHJvdG90eXBlLmRlZXBDbG9uZT1mdW5jdGlvbihhKXt2YXIgZD10aGlzO3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5kZWVwQ2xvbmUoKSBjYWxsZWQuIFtpZD1cIit0aGlzLmlkK1wiXVwiKTtpZih6LlJlbW90ZVNlc3Npb24uaXNGZWF0dXJlVHJhY2tDbG9uZVdpdGhJZFN1cHBvcnRlZCgpKXt2YXIgYz1bXTt0aGlzLnRyYWNrc18uZm9yRWFjaChmdW5jdGlvbihhKXtjLnB1c2goYS5kZWVwQ2xvbmUoKSl9KTt2YXIgZj1uZXcgbTthPWE/YTp0aGlzLmlkK1wiLlwiK2YuY2xvbmVfaWQudG9TdHJpbmcoKTt2YXIgZz1uZXcgYihudWxsLDAsdy5Qcm94eU1vZGUuTG9jYWwsYyxhKTtnLmlkPWE7Zy5hY3RpdmVfPXRoaXMuYWN0aXZlXztnLmNsb25lX3N0YXRlPWY7Zy50cmFja3NfPWM7Zy53YWl0VW50aWxDb25uZWN0ZWQoXCJSZW1vdGVTdHJlYW0uZGVlcENsb25lXCIpLnRoZW4oZnVuY3Rpb24oKXtnLnN5bmNCYXJyaWVyKCkudGhlbihmdW5jdGlvbigpe3EubG9nZ2VyLmxvZyhkLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCJzdHJlYW0uc3luY0JhcnJpZXIoKTogc3VjY2Vzc1wiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7ZC5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwic3RyZWFtLnN5bmNCYXJyaWVyKCkgZmFpbGVkIVwiKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtkLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuZGVlcENsb25lKCkgZmFpbGVkIVwiKX0pO3JldHVybiBnfXEubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5kZWVwQ2xvbmUoKSBpcyBub3Qgc3VwcG9ydGVkIVwiKX07Yi5wcm90b3R5cGUubG9jYWxDbG9uZT1mdW5jdGlvbigpe3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5sb2NhbENsb25lKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7dmFyIGE9dGhpcy5jbG9uZV9zdGF0ZS5jbG9uZSgpLGQ9bmV3IGIodGhpcyx0aGlzLm9iamVjdF9pZCgpLHcuUHJveHlNb2RlLlJlbW90ZSk7ZC5pZD10aGlzLmlkK1wiLlwiK2EuY2xvbmVfaWQudG9TdHJpbmcoKTtcclxuZC5hY3RpdmVfPXRoaXMuYWN0aXZlXzt0aGlzLnRyYWNrc18uZm9yRWFjaChmdW5jdGlvbihhKXthLmFkZFJlZigpfSk7ZC50cmFja3NfPXRoaXMudHJhY2tzXztkLmNsb25lX3N0YXRlPWE7cmV0dXJuIGR9O2IucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNsb25lKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7cmV0dXJuIHouUmVtb3RlU2Vzc2lvbi5pc0ZlYXR1cmVUcmFja0Nsb25lV2l0aElkU3VwcG9ydGVkKCk/dGhpcy5kZWVwQ2xvbmUoKTp0aGlzLmxvY2FsQ2xvbmUoKX07Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllcigpIGNhbGxlZC4gW2lkPVwiK3RoaXMuaWQrXCJdXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2Euc3luY0JhcnJpZXJEZWVwKGIsYykmJmEud2FpdFVudGlsQ29ubmVjdGVkKFwiTWVkaWFTdHJlYW0uc3luY0JhcnJpZXJcIikudGhlbihmdW5jdGlvbigpe3ZhciBiPVxyXG5bXTtiLnB1c2goYS5yZW1vdGVJbnZva2UoITEsZC5tZXRob2RfaWRfTWVkaWFTdHJlYW1fdC5pZCxcIlwiKSk7bi5nZXRSZWRpcmVjdG9yKCkuZ2V0RmVhdHVyZVZhbHVlKGQuRkVBVFVSRV9tc190ZWFtc19zdHJlYW1fYWN0aXZlX3N0YXR1cykmJmIucHVzaChhLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9NZWRpYVN0cmVhbV90LmFjdGl2ZSwhMCkpO2IucHVzaChhLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9NZWRpYVN0cmVhbV90LmdldFRyYWNrcykpO3JldHVybiBQcm9taXNlLmFsbChiKX0pLnRoZW4oZnVuY3Rpb24oYil7cS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyKCkgcmVtb3RlIHN1Y2Nlc3NcIik7dmFyIGM7bi5nZXRSZWRpcmVjdG9yKCkuZ2V0RmVhdHVyZVZhbHVlKGQuRkVBVFVSRV9tc190ZWFtc19zdHJlYW1fYWN0aXZlX3N0YXR1cyk/KGI9Yi5tYXAoZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyYW0wKGIpfSksYS5pZD1iWzBdLFxyXG5hLmFjdGl2ZV89YlsxXSxjPWJbMl0pOihiPWIubWFwKGZ1bmN0aW9uKGIpe3JldHVybiBhLnBhcmFtMChiKX0pLGEuaWQ9YlswXSxjPWJbMV0sYS5hY3RpdmVfPSEwKTt2YXIgZz1bXTtiPWZ1bmN0aW9uKGIpe3ZhciBmPWEudHJhY2tzXy5maW5kKGZ1bmN0aW9uKGEpe3JldHVybiBhLm9iamVjdF9pZCgpPT09Yi5vaWR9KTt2b2lkIDA9PT1mJiYocS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiIGFkZGluZyBhIFJlbW90ZU1lZGlhVHJhY2sgd2l0aCBvaWQ6XCIrYi5vaWQpLGY9bmV3IHAoYSxiLm9pZCkpO2cucHVzaChmLnN5bmNCYXJyaWVyKCkpfTtmb3IodmFyIHI9MDtyPGMubGVuZ3RoO3IrKyliKGNbcl0pO3JldHVybiBQcm9taXNlLmFsbChnKX0pLnRoZW4oZnVuY3Rpb24oYil7YS50cmFja3NfPVtdO2IuZm9yRWFjaChmdW5jdGlvbihiKXtkLkJVSUxEX1RZUEVfU0RLfHwoYi5vbnN0b3A9ZnVuY3Rpb24oKXt2YXIgYj0hMDthLnRyYWNrc18uZm9yRWFjaChmdW5jdGlvbihhKXtcImVuZGVkXCIhPVxyXG5hLnJlYWR5U3RhdGUmJihiPSExKX0pO2ImJmEucmVsZWFzZSgpfSk7YS50cmFja3NfLnB1c2goYil9KTthLnN5bmNCYXJyaWVyUmVzb2x2ZShhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLnN5bmNCYXJyaWVyIGZhaWxlZCFcIik7YS5zeW5jQmFycmllclJlamVjdCgpfSl9KX07Yi5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5kaXNwb3NlKCkgY2FsbGVkLiBbaWQ9XCIrdGhpcy5pZCtcIl1cIik7dGhpcy50cmFja3NfLmZvckVhY2goZnVuY3Rpb24oYSl7YS5kaXNwb3NlKCl9KTt0aGlzLnJlbGVhc2UoKX07cmV0dXJuIGJ9KHcuUHJveHlPYmplY3QpO2EuUmVtb3RlU3RyZWFtPXg7Yj1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKGMsZyl7cmV0dXJuIGEuY2FsbCh0aGlzLGMsZC5jbGFzc19pZF90Lk1lZGlhU3RyZWFtRXZlbnQsZyx3LlByb3h5TW9kZS5SZW1vdGUpfHx0aGlzfVxyXG5lKGIsYSk7Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllcigpIGNhbGxlZC5cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGIsYyl7YS5zeW5jQmFycmllckRlZXAoYixjKSYmYS53YWl0VW50aWxDb25uZWN0ZWQoXCJNZWRpYVN0cmVhbUV2ZW50LnN5bmNCYXJyaWVyXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYS5yZW1vdGVJbnZva2UoITEsZC5tZXRob2RfaWRfTWVkaWFTdHJlYW1FdmVudF90LnN0cmVhbSx7b2lkOjB9KX0pLnRoZW4oZnVuY3Rpb24oYil7cmV0dXJuKG5ldyB4KGEsYi5wYXJhbXNbMF0ub2lkLHcuUHJveHlNb2RlLlJlbW90ZSkpLnN5bmNCYXJyaWVyKCl9KS50aGVuKGZ1bmN0aW9uKGIpe2Euc3RyZWFtPWI7YS5zeW5jQmFycmllclJlc29sdmUoYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2I9YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFxyXG5cIi5zeW5jQmFycmllcigpIGZhaWxlZCFcIik7YS5zeW5jQmFycmllclJlamVjdChiKX0pfSl9O3JldHVybiBifSh3LlByb3h5T2JqZWN0KTthLlJlbW90ZVN0cmVhbUV2ZW50PWI7dmFyIHI9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiLGQsYyl7dGhpcy5kZXZpY2VJZD1hO3RoaXMuZ3JvdXBJZD1iO3RoaXMua2luZD1kO3RoaXMubGFiZWw9Y319KCk7YS5EZXZpY2VJbmZvPXI7dmFyIEE9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjKXtyZXR1cm4gYS5jYWxsKHRoaXMsbnVsbCxkLmNsYXNzX2lkX3QuTWVkaWFEZXZpY2VJbmZvLGMsdy5Qcm94eU1vZGUuUmVtb3RlKXx8dGhpc31lKGIsYSk7Yi5jb252ZXJ0S2luZD1mdW5jdGlvbihhKXtyZXR1cm4gMD09YT9cImF1ZGlvaW5wdXRcIjoxPT1hP1wiYXVkaW9vdXRwdXRcIjpcInZpZGVvaW5wdXRcIn07Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuc3luY0JhcnJpZXIoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihjLGcpe2Euc3luY0JhcnJpZXJEZWVwKGMsZykmJmEud2FpdFVudGlsQ29ubmVjdGVkKFwiUmVtb3RlRGV2aWNlSW5mby5zeW5jQmFycmllclwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFthLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9NZWRpYURldmljZUluZm9fdC5kZXZpY2VJZCxcIlwiKSxhLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9NZWRpYURldmljZUluZm9fdC5raW5kLDApLGEucmVtb3RlSW52b2tlKCExLGQubWV0aG9kX2lkX01lZGlhRGV2aWNlSW5mb190LmxhYmVsLFwiXCIpLGEucmVtb3RlSW52b2tlKCExLGQubWV0aG9kX2lkX01lZGlhRGV2aWNlSW5mb190Lmdyb3VwSWQsXCJcIildKX0pLnRoZW4oZnVuY3Rpb24oZil7YS5raW5kPWIuY29udmVydEtpbmQoYS5wYXJhbTAoZi5zcGxpY2UoMSwxKVswXSkpO2Y9Zi5tYXAoZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyYW0wKGIpfSk7XHJcbmEuZGV2aWNlSWQ9ZlswXTthLmxhYmVsPWZbMV07YS5ncm91cElkPWZbMl07YS5zeW5jQmFycmllclJlc29sdmUoYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2I9YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLnN5bmNCYXJyaWVyKCkgZmFpbGVkIVwiKTthLnN5bmNCYXJyaWVyUmVqZWN0KGIpfSl9KX07cmV0dXJuIGJ9KHcuUHJveHlPYmplY3QpO2EuUmVtb3RlRGV2aWNlSW5mbz1BO2I9ZnVuY3Rpb24oYil7ZnVuY3Rpb24gYygpe3ZhciBhPWIuY2FsbCh0aGlzLG51bGwsZC5jbGFzc19pZF90Lk1lZGlhRGV2aWNlcywwLHcuUHJveHlNb2RlLkxvY2FsLGZ1bmN0aW9uKCl7YS5zZXREZXZpY2VDaGFuZ2VDYWxsYmFjaygpfSl8fHRoaXM7YS5kZXZpY2VzXz1bXTthLmVudW1lcmF0ZU1hcmtlcj1cImVudW1lcmF0ZURldmljZXNQcml2YXRlXCI7YS5lbnVtZXJhdGVSZW1vdGVNYXJrZXI9XCJlbnVtZXJhdGVkRGV2aWNlc1ByaXZhdGUtUmVtb3RlXCI7YS5zaGFyZVN5c3RlbUF1ZGlvXz0hMTthLnBlbmRpbmdFbnVtZXJhdGVEZXZpY2VfPVxyXG5bXTthLnBhbmVsaWRfPS0xO3JldHVybiBhfWUoYyxiKTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYy5wcm90b3R5cGUsXCJwYW5lbGlkXCIse3NldDpmdW5jdGlvbihhKXt0aGlzLnBhbmVsaWRfPWF9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yy5wcm90b3R5cGUuY2xlYXJQYW5lbElkPWZ1bmN0aW9uKCl7dGhpcy5wYW5lbGlkXz0tMX07Yy5wcm90b3R5cGUuZW51bWVyYXRlRGV2aWNlcz1mdW5jdGlvbigpe3ZhciBhPXRoaXM7cmV0dXJuIDA8dGhpcy5kZXZpY2VzXy5sZW5ndGgmJjA9PXRoaXMucGVuZGluZ0VudW1lcmF0ZURldmljZV8ubGVuZ3RoP25ldyBQcm9taXNlKGZ1bmN0aW9uKGIsZCl7cS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmVudW1lcmF0ZURldmljZXM6IHJldHVybmluZyBjYWNoZWQgZGV2aWNlc1wiKTtiKGEuZGV2aWNlc18pfSk6dGhpcy5lbnVtZXJhdGVEZXZpY2VzUHJpdmF0ZSghMSl9O2MucHJvdG90eXBlLmVudW1lcmF0ZURldmljZXNQcml2YXRlPVxyXG5mdW5jdGlvbihhKXtyZXR1cm4gbi5nZXRSZWRpcmVjdG9yKCkuZ2V0RmVhdHVyZVZhbHVlKGQuRkVBVFVSRV9tc190ZWFtc19lbnVtZXJhdGVfZGV2aWNlc192Mik/dGhpcy5lbnVtZXJhdGVEZXZpY2VzUHJpdmF0ZVYyKGEpOnRoaXMuZW51bWVyYXRlRGV2aWNlc1ByaXZhdGVWMShhKX07Yy5wcm90b3R5cGUucG9zdEVudW1lcmF0ZURldmljZXNSZXN1bHQ9ZnVuY3Rpb24oKXtmb3IodmFyIGE9ITAsYj0wLGQ9MCxmPXRoaXMucGVuZGluZ0VudW1lcmF0ZURldmljZV87ZDxmLmxlbmd0aDtkKyspe3ZhciBjPWZbZF07aWYoMD09YSYmYy5uYW1lPT10aGlzLmVudW1lcmF0ZVJlbW90ZU1hcmtlcilicmVhaztjLnBvc3RXaXRoUmVzdWx0KCEwLHRoaXMuZGV2aWNlc18pO2IrKzthPSExfTA8YiYmdGhpcy5wZW5kaW5nRW51bWVyYXRlRGV2aWNlXy5zcGxpY2UoMCxiKX07Yy5wcm90b3R5cGUuZW51bWVyYXRlRGV2aWNlc1ByaXZhdGVWMj1mdW5jdGlvbihiKXt2YXIgYz10aGlzO3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuZW51bWVyYXRlRGV2aWNlc1ByaXZhdGVWMigpIGNhbGxlZC4gcmVmcmVzaDpcIitiK1wiIHBlbmRpbmc6XCIrdGhpcy5wZW5kaW5nRW51bWVyYXRlRGV2aWNlXy5sZW5ndGgpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihnLGYpezE9PWJ8fDA9PWMucGVuZGluZ0VudW1lcmF0ZURldmljZV8ubGVuZ3RoPyhjLnBlbmRpbmdFbnVtZXJhdGVEZXZpY2VfLnB1c2gobmV3IHcuZGVmZXJyZWRfYWN0aW9uKGcsZixjLmVudW1lcmF0ZVJlbW90ZU1hcmtlcikpLGMud2FpdFVudGlsQ29ubmVjdGVkKFwiUmVtb3RlRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzUHJpdmF0ZVYyXCIpLnRoZW4oZnVuY3Rpb24oKXtxLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZW51bWVyYXRlRGV2aWNlc1ByaXZhdGVWMigpIHJlbW90ZSBpbnZva2luZy4uLlwiKTtyZXR1cm4gYy5yZW1vdGVJbnZva2UoITEsZC5tZXRob2RfaWRfTWVkaWFEZXZpY2VzX3QuZW51bWVyYXRlRGV2aWNlc1YyKX0pLnRoZW4oZnVuY3Rpb24oYil7dmFyIGY9XHJcbltdO2IucGFyYW1zWzBdLmZvckVhY2goZnVuY3Rpb24oYSl7YT1uZXcgcihhLmRldmljZUlkLGEuZ3JvdXBJZCxBLmNvbnZlcnRLaW5kKGEua2luZCksYS5sYWJlbCk7Zi5wdXNoKGEpfSk7Yy5kZXZpY2VzXz1mO2EuZW51bWVyYXRlZERldmljZXM9bD1mO3EubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5lbnVtZXJhdGVEZXZpY2VzUHJpdmF0ZVYyOiByZXNvbHZpbmcgZW51bWVyYXRlZCBkZXZpY2VzOiBcIitKU09OLnN0cmluZ2lmeShjLmRldmljZXNfKSk7Yy5wb3N0RW51bWVyYXRlRGV2aWNlc1Jlc3VsdCgpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtjLmRldmljZXNfPVtdO2EuZW51bWVyYXRlZERldmljZXM9bD1bXTtjLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuZW51bWVyYXRlRGV2aWNlc1ByaXZhdGVWMigpIGZhaWxlZCwgcmVzb2x2aW5nIHdpdGggZW1wdHkgbGlzdC5cIik7Yy5wb3N0RW51bWVyYXRlRGV2aWNlc1Jlc3VsdCgpfSkpOihjLnBlbmRpbmdFbnVtZXJhdGVEZXZpY2VfLnB1c2gobmV3IHcuZGVmZXJyZWRfYWN0aW9uKGcsXHJcbmYsYy5lbnVtZXJhdGVNYXJrZXIpKSxxLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZW51bWVyYXRlRGV2aWNlc1ByaXZhdGVWMigpIG5vdCByZW1vdGluZyB0aGlzIGNhbGwuLi5cIikpfSl9O2MucHJvdG90eXBlLmVudW1lcmF0ZURldmljZXNQcml2YXRlVjE9ZnVuY3Rpb24oYil7dmFyIGM9dGhpcztxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZW51bWVyYXRlRGV2aWNlc1ByaXZhdGVWMSgpIGNhbGxlZC4gcmVmcmVzaDpcIitiK1wiIHBlbmRpbmc6XCIrdGhpcy5wZW5kaW5nRW51bWVyYXRlRGV2aWNlXy5sZW5ndGgpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihnLGYpezE9PWJ8fDA9PWMucGVuZGluZ0VudW1lcmF0ZURldmljZV8ubGVuZ3RoPyhjLnBlbmRpbmdFbnVtZXJhdGVEZXZpY2VfLnB1c2gobmV3IHcuZGVmZXJyZWRfYWN0aW9uKGcsZixjLmVudW1lcmF0ZVJlbW90ZU1hcmtlcikpLGMud2FpdFVudGlsQ29ubmVjdGVkKFwiUmVtb3RlRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzUHJpdmF0ZVYxXCIpLnRoZW4oZnVuY3Rpb24oKXtxLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLmVudW1lcmF0ZURldmljZXNQcml2YXRlVjEoKSByZW1vdGUgaW52b2tpbmcuLi5cIik7cmV0dXJuIGMucmVtb3RlSW52b2tlKCExLGQubWV0aG9kX2lkX01lZGlhRGV2aWNlc190LmVudW1lcmF0ZURldmljZXMpfSkudGhlbihmdW5jdGlvbihhKXt2YXIgYj1bXTthLnBhcmFtc1swXS5mb3JFYWNoKGZ1bmN0aW9uKGEpe2E9bmV3IEEoYS5vaWQpO2IucHVzaChhLnN5bmNCYXJyaWVyKCkpfSk7cmV0dXJuIFByb21pc2UuYWxsKGIpfSkudGhlbihmdW5jdGlvbihiKXt2YXIgZj1bXTtiLmZvckVhY2goZnVuY3Rpb24oYSl7dmFyIGI9bmV3IHIoYS5kZXZpY2VJZCxhLmdyb3VwSWQsYS5raW5kLGEubGFiZWwpO2YucHVzaChiKTthLnJlbGVhc2UoKX0pO2MuZGV2aWNlc189ZjthLmVudW1lcmF0ZWREZXZpY2VzPWw9ZjtxLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZW51bWVyYXRlRGV2aWNlc1ByaXZhdGVWMTogcmVzb2x2aW5nIGVudW1lcmF0ZWQgZGV2aWNlczogXCIrSlNPTi5zdHJpbmdpZnkoYy5kZXZpY2VzXykpO1xyXG5jLnBvc3RFbnVtZXJhdGVEZXZpY2VzUmVzdWx0KCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2EuZW51bWVyYXRlZERldmljZXM9bD1bXTtjLmRldmljZXNfPVtdO2MubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5lbnVtZXJhdGVEZXZpY2VzUHJpdmF0ZVYxKCkgZmFpbGVkLCByZXNvbHZpbmcgd2l0aCBlbXB0eSBsaXN0LlwiKTtjLnBvc3RFbnVtZXJhdGVEZXZpY2VzUmVzdWx0KCl9KSk6KGMucGVuZGluZ0VudW1lcmF0ZURldmljZV8ucHVzaChuZXcgdy5kZWZlcnJlZF9hY3Rpb24oZyxmLGMuZW51bWVyYXRlTWFya2VyKSkscS5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLmVudW1lcmF0ZURldmljZXNQcml2YXRlVjEoKSBub3QgcmVtb3RpbmcgdGhpcyBjYWxsLi4uXCIpKX0pfTtjLnByb3RvdHlwZS5nZXREaXNwbGF5TWVkaWE9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxmKXtiLndhaXRVbnRpbENvbm5lY3RlZChcIlJlbW90ZURldmljZXMuZ2V0RGlzcGxheU1lZGlhXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gZy5TY3JlZW5TaGFyaW5nLnNjcmVlblNoYXJpbmdJbnN0YW5jZSgpLnNldEFjdGl2ZVNvdXJjZShiLnBhbmVsaWRfLFxyXG56LlJlbW90ZVNlc3Npb24uaXNGZWF0dXJBcHBzaGFyZVN1cHBvcnRlZCgpKX0pLnRoZW4oZnVuY3Rpb24oZil7dm9pZCAwIT09YS52aWRlbyYmbnVsbCE9PWEudmlkZW8mJnZvaWQgMCE9PWYmJihhLnZpZGVvLmRldmljZUlkPWYpO24uZ2V0UmVkaXJlY3RvcigpLmdldEZlYXR1cmVWYWx1ZShkLkZFQVRVUkVfbXNfdGVhbXNfc2hhcmVfc3lzdGVtX2F1ZGlvKSYmKHZvaWQgMCE9PWEuYXVkaW8mJlwiYm9vbGVhblwiIT09dHlwZW9mIGEuYXVkaW8/cS5sb2dnZXIubG9nKFwiTm9uLWJvb2xlYW4gYXVkaW8gY29uc3RyYWludHNcIik6YS5hdWRpbz1hLmF1ZGlvfHxiLnNoYXJlU3lzdGVtQXVkaW9fKTtmPWIucHJlcGFyZURpc3BsYXlDb25zdHJhaW50cyhhKTtmPUoudG9SZW1vdGVNZWRpYVN0cmVhbUNvbnN0cmFpbnRzKGYsITApO3JldHVybiBiLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9NZWRpYURldmljZXNfdC5nZXREaXNwbGF5TWVkaWEsZil9KS50aGVuKGZ1bmN0aW9uKGEpe3JldHVybihuZXcgeChudWxsLFxyXG5hLnBhcmFtc1swXS5vaWQsdy5Qcm94eU1vZGUuUmVtb3RlKSkuc3luY0JhcnJpZXIoKX0pLnRoZW4oZnVuY3Rpb24oYSl7YyhhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Zy5TY3JlZW5TaGFyaW5nLnNjcmVlblNoYXJpbmdJbnN0YW5jZSgpLmlzQXBwc2hhcmVBY3RpdmUoKSYmZy5TY3JlZW5TaGFyaW5nLnNjcmVlblNoYXJpbmdJbnN0YW5jZSgpLnN0b3BBcHBzaGFyZSgpO2E9Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLmdldERpc3BsYXlNZWRpYSgpIGZhaWxlZCFcIik7ZihhKX0pfSl9O2MucHJvdG90eXBlLnNldERldmljZUNoYW5nZUNhbGxiYWNrPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X0RldmljZUNoYW5nZUNhbGxiYWNrKCkgY2FsbGVkLlwiKTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIk1lZGlhRGV2aWNlcy5vbmRldmljZWNoYW5nZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGI9YS5yZWdpc3RlckNhbGxiYWNrcyghMSxcclxuITEsZC5tZXRob2RfaWRfTWVkaWFEZXZpY2VzX3Qub25kZXZpY2VjaGFuZ2UpO2IudGhlbihmdW5jdGlvbigpe3EubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmRldmljZWNoYW5nZSgpOiBjYWxsYmFjayByZWNlaXZlZCEhIVwiKTthLmVudW1lcmF0ZURldmljZXNQcml2YXRlKCEwKS50aGVuKGZ1bmN0aW9uKCl7bmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcImRldmljZWNoYW5nZVwiKSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7bmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcImRldmljZWNoYW5nZVwiKSl9KX0pO3JldHVybiBhLnJlbW90ZUludm9rZSghMCxkLm1ldGhvZF9pZF9NZWRpYURldmljZXNfdC5vbmRldmljZWNoYW5nZSxiLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuc2V0X29uZGV2aWNlY2hhbmdlKCkgZmFpbGVkIVwiKX0pfTtcclxuYy5wcm90b3R5cGUucHJlcGFyZURpc3BsYXlDb25zdHJhaW50cz1mdW5jdGlvbihhKXtpZihuLmdldFJlZGlyZWN0b3IoKS5nZXRGZWF0dXJlVmFsdWUoZC5GRUFUVVJFX21zX3RlYW1zX2NvbW1vbl9tZWRpYV9jb25zdHJhaW50cykpcmV0dXJuIGE7dmFyIGI9e2ZyYW1lUmF0ZToxNSx3aWR0aDp7bWF4OjE5MjB9LGhlaWdodDp7bWF4OjEwODB9fTtpZih2b2lkIDAhPT1hLnZpZGVvJiZudWxsIT09YS52aWRlbyl7dmFyIGM9YS52aWRlbzt2b2lkIDAhPT1jLmZyYW1lUmF0ZSYmdm9pZCAwIT09Yy53aWR0aCYmdm9pZCAwIT09Yy5oZWlnaHQmJihiLmZyYW1lUmF0ZT1jLmZyYW1lUmF0ZSxiLndpZHRoLm1heD1jLndpZHRoLm1heHx8Yy53aWR0aCxiLmhlaWdodC5tYXg9Yy5oZWlnaHQubWF4fHxjLmhlaWdodCl9cmV0dXJuIGEuYXVkaW8/e3ZpZGVvOmIsYXVkaW86YS5hdWRpb306e3ZpZGVvOmJ9fTtyZXR1cm4gY30ody5Qcm94eU9iamVjdCk7YS5SZW1vdGVEZXZpY2VzPWI7dmFyIE09XHJcbmZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe31hLnRvUmVtb3RlTWVkaWFUcmFja0NvbnN0cmFpbnRTZXQ9ZnVuY3Rpb24oYSl7dmFyIGI9dm9pZCAwO3YuVXRpbC5oYXNWYWx1ZShhKSYmKGI9e30sdi5VdGlsLmhhc1ZhbHVlKGEud2lkdGgpJiYoYi53aWR0aD1hLndpZHRoKSx2LlV0aWwuaGFzVmFsdWUoYS5oZWlnaHQpJiYoYi5oZWlnaHQ9YS5oZWlnaHQpLHYuVXRpbC5oYXNWYWx1ZShhLmFzcGVjdFJhdGlvKSYmKGIuYXNwZWN0UmF0aW89YS5hc3BlY3RSYXRpbyksdi5VdGlsLmhhc1ZhbHVlKGEuZnJhbWVSYXRlKSYmKGIuZnJhbWVSYXRlPWEuZnJhbWVSYXRlKSx2LlV0aWwuaGFzVmFsdWUoYS5mYWNpbmdNb2RlKSYmKGIuZmFjaW5nTW9kZT1hLmZhY2luZ01vZGUpLHYuVXRpbC5oYXNWYWx1ZShhLnNhbXBsZVJhdGUpJiYoYi5zYW1wbGVSYXRlPWEuc2FtcGxlUmF0ZSksdi5VdGlsLmhhc1ZhbHVlKGEuc2FtcGxlU2l6ZSkmJihiLnNhbXBsZVNpemU9YS5zYW1wbGVTaXplKSx2LlV0aWwuaGFzVmFsdWUoYS52b2x1bWUpJiZcclxuKGIudm9sdW1lPWEudm9sdW1lKSx2LlV0aWwuaGFzVmFsdWUoYS5lY2hvQ2FuY2VsbGF0aW9uKSYmKGIuZWNob0NhbmNlbGxhdGlvbj1hLmVjaG9DYW5jZWxsYXRpb24pLHYuVXRpbC5oYXNWYWx1ZShhLmF1dG9HYWluQ29udHJvbCkmJihiLmF1dG9HYWluQ29udHJvbD1hLmF1dG9HYWluQ29udHJvbCksdi5VdGlsLmhhc1ZhbHVlKGEubm9pc2VTdXBwcmVzc2lvbikmJihiLm5vaXNlU3VwcHJlc3Npb249YS5ub2lzZVN1cHByZXNzaW9uKSx2LlV0aWwuaGFzVmFsdWUoYS5sYXRlbmN5KSYmKGIubGF0ZW5jeT1hLmxhdGVuY3kpLHYuVXRpbC5oYXNWYWx1ZShhLmNoYW5uZWxDb3VudCkmJihiLmNoYW5uZWxDb3VudD1hLmNoYW5uZWxDb3VudCksdi5VdGlsLmhhc1ZhbHVlKGEuZGV2aWNlSWQpJiYoYi5kZXZpY2VJZD1hLmRldmljZUlkKSx2LlV0aWwuaGFzVmFsdWUoYS5ncm91cElkKSYmKGIuZ3JvdXBJZD1hLmdyb3VwSWQpLHYuVXRpbC5oYXNWYWx1ZShhLm1heEZyYW1lUmF0ZSkmJihiLm1heEZyYW1lUmF0ZT1cclxuYS5tYXhGcmFtZVJhdGUpLHYuVXRpbC5oYXNWYWx1ZShhLm1heEhlaWdodCkmJihiLm1heEhlaWdodD1hLm1heEhlaWdodCksdi5VdGlsLmhhc1ZhbHVlKGEubWF4V2lkdGgpJiYoYi5tYXhXaWR0aD1hLm1heFdpZHRoKSx2LlV0aWwuaGFzVmFsdWUoYS5taW5IZWlnaHQpJiYoYi5taW5IZWlnaHQ9YS5taW5IZWlnaHQpLHYuVXRpbC5oYXNWYWx1ZShhLm1pbldpZHRoKSYmKGIubWluV2lkdGg9YS5taW5XaWR0aCksdi5VdGlsLmhhc1ZhbHVlKGEuc291cmNlSWQpJiYoYi5zb3VyY2VJZD1hLnNvdXJjZUlkKSk7cmV0dXJuIGJ9O3JldHVybiBhfSgpO2EuUmVtb3RlTWVkaWFUcmFja0NvbnN0cmFpbnRTZXQ9TTt2YXIgRj1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7cmV0dXJuIG51bGwhPT1hJiZhLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpc31lKGIsYSk7Yi5kZWZNYW5kYXRvcnk9ZnVuY3Rpb24oYSl7dmFyIGI9YTt2LlV0aWwuaGFzVmFsdWUoYSk/KHYuVXRpbC5oYXNWYWx1ZShhLm1heEZyYW1lUmF0ZSl8fFxyXG4oYi5tYXhGcmFtZVJhdGU9MzApLHYuVXRpbC5oYXNWYWx1ZShhLm1pbldpZHRoKXx8KGIubWluV2lkdGg9MzYwKSx2LlV0aWwuaGFzVmFsdWUoYS5tYXhXaWR0aCl8fChiLm1heFdpZHRoPTE5MjApLHYuVXRpbC5oYXNWYWx1ZShhLm1pbkhlaWdodCl8fChiLm1pbkhlaWdodD0xODApLHYuVXRpbC5oYXNWYWx1ZShhLm1heEhlaWdodCl8fChiLm1heEhlaWdodD0xMDgwKSk6Yj17bWF4RnJhbWVSYXRlOjMwLG1pbldpZHRoOjM2MCxtYXhXaWR0aDoxOTIwLG1pbkhlaWdodDoxODAsbWF4SGVpZ2h0OjEwODB9O3JldHVybiBifTtiLnRvUmVtb3RlTWVkaWFUcmFja0NvbnN0cmFpbnRzPWZ1bmN0aW9uKGEpe3ZhciBiPXZvaWQgMDt2LlV0aWwuaGFzVmFsdWUoYSkmJihiPU0udG9SZW1vdGVNZWRpYVRyYWNrQ29uc3RyYWludFNldChhKSxiLmFkdmFuY2VkPVtdLHYuVXRpbC5oYXNWYWx1ZShhLmFkdmFuY2VkKSYmYS5hZHZhbmNlZC5mb3JFYWNoKGZ1bmN0aW9uKGEpe2E9TS50b1JlbW90ZU1lZGlhVHJhY2tDb25zdHJhaW50U2V0KGEpO1xyXG5iLmFkdmFuY2VkLnB1c2goYSl9KSx2LlV0aWwuaGFzVmFsdWUoYS5tYW5kYXRvcnkpJiYoYi5tYW5kYXRvcnk9XCJib29sZWFuXCIhPXR5cGVvZiBhLm1hbmRhdG9yeT9NLnRvUmVtb3RlTWVkaWFUcmFja0NvbnN0cmFpbnRTZXQoYS5tYW5kYXRvcnkpOmEubWFuZGF0b3J5KSk7cmV0dXJuIGJ9O3JldHVybiBifShNKTthLlJlbW90ZU1lZGlhVHJhY2tDb25zdHJhaW50cz1GO3ZhciBKPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe31hLmdldERlZmF1bHRBdWRpb0RldmljZUlkPWZ1bmN0aW9uKCl7aWYodm9pZCAwIT09bCl7dmFyIGE9bC5maW5kKGZ1bmN0aW9uKGEpe3JldHVyblwiYXVkaW9pbnB1dFwiPT09YS5raW5kJiZcImRlZmF1bHRcIj09PWEuZGV2aWNlSWR9KTtpZih2b2lkIDAhPT1hKXJldHVybiBhLmRldmljZUlkfXJldHVyblwiXCJ9O2EuZ2V0RGVmYXVsdFZpZGVvRGV2aWNlSWQ9ZnVuY3Rpb24oKXtpZih2b2lkIDAhPT1sKXt2YXIgYT1sLmZpbmQoZnVuY3Rpb24oYSl7cmV0dXJuXCJ2aWRlb2lucHV0XCI9PT1cclxuYS5raW5kfSk7aWYodm9pZCAwIT09YSlyZXR1cm4gYS5kZXZpY2VJZH1yZXR1cm5cIlwifTthLnRvUmVtb3RlTWVkaWFTdHJlYW1Db25zdHJhaW50cz1mdW5jdGlvbihiLGMpe3ZvaWQgMD09PWMmJihjPSExKTtxLmxvZ2dlci5sb2coXCJSZW1vdGVNZWRpYVN0cmVhbUNvbnN0cmFpbnRzLnRvUmVtb3RlTWVkaWFTdHJlYW1Db25zdHJhaW50cygpIGluIGNvbnN0cmFpbnRzOlwiK0pTT04uc3RyaW5naWZ5KGIpKTt2YXIgZz17fTt2LlV0aWwuaGFzVmFsdWUoYikmJih2LlV0aWwuaGFzVmFsdWUoYi5hdWRpbykmJihcImJvb2xlYW5cIiE9dHlwZW9mIGIuYXVkaW8/KGcuYXVkaW89Ri50b1JlbW90ZU1lZGlhVHJhY2tDb25zdHJhaW50cyhiLmF1ZGlvKSwwIT1PYmplY3Qua2V5cyhnLmF1ZGlvKS5sZW5ndGgmJnYuVXRpbC5oYXNWYWx1ZShnLmF1ZGlvKXx8KGcuYXVkaW89e2R1bW15OjF9KSxkLkJVSUxEX1RZUEVfU0RLJiYwPT1jJiZhLmlzQ29uc3RyYWludHNBdWRpb0RldmljZUlkRW1wdHkoYikmJlxyXG4oZy5hdWRpby5kZXZpY2VJZD1hLmdldERlZmF1bHRBdWRpb0RldmljZUlkKCkscS5sb2dnZXIubG9nKFwiUmVtb3RlTWVkaWFTdHJlYW1Db25zdHJhaW50cy50b1JlbW90ZU1lZGlhU3RyZWFtQ29uc3RyYWludHMoKSBzZXQgZGVmYXVsdCBhdWRpbyBkZXZpY2VJZDonXCIrZy5hdWRpby5kZXZpY2VJZCtcIidcIikpKTpnLmF1ZGlvPWIuYXVkaW8pLHYuVXRpbC5oYXNWYWx1ZShiLnBlZXJJZGVudGl0eSkmJihnLnBlZXJJZGVudGl0eT1iLnBlZXJJZGVudGl0eSksdi5VdGlsLmhhc1ZhbHVlKGIudmlkZW8pJiYoXCJib29sZWFuXCIhPXR5cGVvZiBiLnZpZGVvPyhnLnZpZGVvPUYudG9SZW1vdGVNZWRpYVRyYWNrQ29uc3RyYWludHMoYi52aWRlbyksMD09YyYmXCJib29sZWFuXCIhPXR5cGVvZiBnLnZpZGVvLm1hbmRhdG9yeSYmKGcudmlkZW8ubWFuZGF0b3J5PUYuZGVmTWFuZGF0b3J5KGcudmlkZW8ubWFuZGF0b3J5KSxkLkJVSUxEX1RZUEVfU0RLJiZhLmlzQ29uc3RyYWludHNWaWRlb1NvdXJjZUlkRW1wdHkoYikmJlxyXG4oZy52aWRlby5tYW5kYXRvcnkuc291cmNlSWQ9YS5nZXREZWZhdWx0VmlkZW9EZXZpY2VJZCgpLHEubG9nZ2VyLmxvZyhcIlJlbW90ZU1lZGlhU3RyZWFtQ29uc3RyYWludHMudG9SZW1vdGVNZWRpYVN0cmVhbUNvbnN0cmFpbnRzKCkgc2V0IGRlZmF1bHQgdmlkZW8gc291cmNlSWQ6J1wiK2cudmlkZW8ubWFuZGF0b3J5LnNvdXJjZUlkK1wiJ1wiKSkpKTooZy52aWRlbz1iLnZpZGVvLDE9PWIudmlkZW8mJjA9PWMmJmQuQlVJTERfVFlQRV9TREsmJmEuaXNDb25zdHJhaW50c1ZpZGVvU291cmNlSWRFbXB0eShiKSYmKGcudmlkZW89e30sZy52aWRlby5tYW5kYXRvcnk9Ri5kZWZNYW5kYXRvcnkodm9pZCAwKSxnLnZpZGVvLm1hbmRhdG9yeS5zb3VyY2VJZD1hLmdldERlZmF1bHRWaWRlb0RldmljZUlkKCkscS5sb2dnZXIubG9nKFwiUmVtb3RlTWVkaWFTdHJlYW1Db25zdHJhaW50cy50b1JlbW90ZU1lZGlhU3RyZWFtQ29uc3RyYWludHMoKSBzZXQgZGVmYXVsdCB2aWRlbyBzb3VyY2VJZDonXCIrXHJcbmcudmlkZW8ubWFuZGF0b3J5LnNvdXJjZUlkK1wiJ1wiKSkpKSk7cS5sb2dnZXIubG9nKFwiUmVtb3RlTWVkaWFTdHJlYW1Db25zdHJhaW50cy50b1JlbW90ZU1lZGlhU3RyZWFtQ29uc3RyYWludHMoKSBvdXQgY29uc3RyYWludHM6XCIrSlNPTi5zdHJpbmdpZnkoZykpO3JldHVybiBnfTthLmlzQ29uc3RyYWludHNBdWRpb0RldmljZUlkRW1wdHk9ZnVuY3Rpb24oYSl7dmFyIGI9ITE7di5VdGlsLmhhc1ZhbHVlKGEpJiZ2LlV0aWwuaGFzVmFsdWUoYS5hdWRpbykmJihcImJvb2xlYW5cIj09dHlwZW9mIGEuYXVkaW8/MT09YS5hdWRpbyYmKGI9ITApOihhPWEuYXVkaW8sIWF8fCExIT09di5VdGlsLmhhc1ZhbHVlKGEuZGV2aWNlSWQpJiZcIlwiIT09YS5kZXZpY2VJZHx8KGI9ITApKSk7cmV0dXJuIGJ9O2EuaXNDb25zdHJhaW50c1ZpZGVvU291cmNlSWRFbXB0eT1mdW5jdGlvbihhKXt2YXIgYj0hMTtpZih2LlV0aWwuaGFzVmFsdWUoYSkmJnYuVXRpbC5oYXNWYWx1ZShhLnZpZGVvKSlpZihcImJvb2xlYW5cIj09XHJcbnR5cGVvZiBhLnZpZGVvKTE9PWEudmlkZW8mJihiPSEwKTtlbHNlIGlmKGE9YS52aWRlbykoYT1hLm1hbmRhdG9yeSkmJiExIT09di5VdGlsLmhhc1ZhbHVlKGEuc291cmNlSWQpJiZcIlwiIT09YS5zb3VyY2VJZHx8KGI9ITApO3JldHVybiBifTtyZXR1cm4gYX0oKTthLlJlbW90ZU1lZGlhU3RyZWFtQ29uc3RyYWludHM9Sjt2YXIgRz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt0aGlzLnZpZGVvPXRoaXMuYXVkaW89YS5FbXB0eUNhcGFiaWxpdGllc31hLkVtcHR5Q2FwYWJpbGl0aWVzPXtjb2RlY3M6W10saGVhZGVyRXh0ZW5zaW9uczpbXX07cmV0dXJuIGF9KCk7Yj1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7cmV0dXJuIGEuY2FsbCh0aGlzLG51bGwsZC5jbGFzc19pZF90Lk5hdmlnYXRvclVzZXJNZWRpYSwwLHcuUHJveHlNb2RlLkxvY2FsKXx8dGhpc31lKGIsYSk7Yi5nZXRDYXBhYmlsaXRpZXM9ZnVuY3Rpb24oYSl7cS5sb2dnZXIubG9nKFwiTmF2aWdhdG9yVXNlck1lZGlhLmdldENhcGFiaWxpdGllcyBmb3IgdHlwZT1cIitcclxuYStcIiBjYXBhYmlsaXRpZXM9XCIrSlNPTi5zdHJpbmdpZnkoYi5jYXBhYmlsaXRpZXNbYV0pKTtyZXR1cm4gYi5jYXBhYmlsaXRpZXNbYV19O2IucmVzZXRDYXBhYmlsaXRpZXM9ZnVuY3Rpb24oKXtiLmNhcGFiaWxpdGllcz1uZXcgR307Yi5wcm90b3R5cGUuZ2V0Q2FwYWJpbGl0aWVzPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0Q2FwYWJpbGl0aWVzLi4uXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihjLGcpe2Eud2FpdFVudGlsQ29ubmVjdGVkKFwiTmF2aWdhdG9yVXNlck1lZGlhLmdldENhcGFiaWxpdGllc1wiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFthLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9OYXZpZ2F0b3JVc2VyTWVkaWFfdC5nZXRDYXBhYmlsaXRpZXMsXCJhdWRpb1wiKSxhLnJlbW90ZUludm9rZSghMSxkLm1ldGhvZF9pZF9OYXZpZ2F0b3JVc2VyTWVkaWFfdC5nZXRDYXBhYmlsaXRpZXMsXHJcblwidmlkZW9cIildKX0pLnRoZW4oZnVuY3Rpb24oZil7Yi5jYXBhYmlsaXRpZXMuYXVkaW89YS5wYXJhbTAoZlswXSk7Yi5jYXBhYmlsaXRpZXMudmlkZW89YS5wYXJhbTAoZlsxXSk7cS5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldENhcGFiaWxpdGllcyBjYXBhYmlsaXRpZXM9XCIrSlNPTi5zdHJpbmdpZnkoYi5jYXBhYmlsaXRpZXMpKTtjKGIuY2FwYWJpbGl0aWVzKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7ZyhhLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuZ2V0Q2FwYWJpbGl0aWVzIGZhaWxlZCFcIikpfSl9KX07Yi5wcm90b3R5cGUuc2V0Q29kZWNDYXBhYmlsaXRpZXM9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztxLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0Q29kZWNDYXBhYmlsaXRpZXMgOiBzZXQgY29kZWNDYXBhYmlsaXRpZXMgdG8gXCIrSlNPTi5zdHJpbmdpZnkoYSkpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihjLGYpe2Iud2FpdFVudGlsQ29ubmVjdGVkKFwiTmF2aWdhdG9yVXNlck1lZGlhLnNldENvZGVjQ2FwYWJpbGl0aWVzXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITEsXHJcbmQubWV0aG9kX2lkX05hdmlnYXRvclVzZXJNZWRpYV90LnNldENvZGVjQ2FwYWJpbGl0aWVzLGEpfSkudGhlbihmdW5jdGlvbigpe3EubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRDb2RlY0NhcGFiaWxpdGllcygpIHN1Y2Nlc3MuXCIpO2MoITApO2IuZ2V0Q2FwYWJpbGl0aWVzKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnNldENvZGVjQ2FwYWJpbGl0aWVzKCkgZmFpbGVkIVwiKTtmKGEpfSl9KX07Yi5wcm90b3R5cGUud2Via2l0R2V0VXNlck1lZGlhPWZ1bmN0aW9uKGEsYixkKXtyZXR1cm4gdGhpcy5nZXRVc2VyTWVkaWEoYSxiLGQpfTtiLnByb3RvdHlwZS5Mb2dUZWxlbWV0cnlEZXZpY2VfPWZ1bmN0aW9uKGEpe3RyeXtpZihcInVuZGVmaW5lZFwiIT09dHlwZW9mIGEuYXVkaW8pe3ZhciBiPWEuYXVkaW8uZGV2aWNlSWQsZDtsLmZvckVhY2goZnVuY3Rpb24oYSl7Yj09YS5kZXZpY2VJZCYmKGQ9YS5sYWJlbCl9KTtcclxucS5sb2dnZXIubG9nKGQpO3RoaXMuU2VuZFRlbGVtZXRyeURhdGEoay50ZWxfa2V5X0F1ZGlvRGV2aWNlVXNlZCxkLDApfWlmKFwidW5kZWZpbmVkXCIhPT10eXBlb2YgYS52aWRlbyl7dmFyIGY9YS52aWRlby5tYW5kYXRvcnksYztmJiZsLmZvckVhY2goZnVuY3Rpb24oYSl7Zi5zb3VyY2VJZD09YS5kZXZpY2VJZCYmKGM9YS5sYWJlbCl9KTtxLmxvZ2dlci5sb2coYyk7dGhpcy5TZW5kVGVsZW1ldHJ5RGF0YShrLnRlbF9rZXlfVmlkZW9EZXZpY2VVc2VkLGMsMCl9fWNhdGNoKGcpe3EubG9nZ2VyLmxvZyhnKX19O2IucHJvdG90eXBlLmdldFVzZXJNZWRpYT1mdW5jdGlvbihhLGIsZCl7cS5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFVzZXJNZWRpYSgpIGNhbGxlZDogXCIrSlNPTi5zdHJpbmdpZnkoYSkpO3JldHVybiBiJiZkP3RoaXMuZ2V0VXNlck1lZGlhX3YxKGEsYixkKTp0aGlzLmdldFVzZXJNZWRpYV92MihhKX07Yi5wcm90b3R5cGUuZ2V0VXNlck1lZGlhX3YyPVxyXG5mdW5jdGlvbihhKXt2YXIgYj10aGlzO3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRVc2VyTWVkaWFfdjIoKSBjYWxsZWQ6IFwiK0pTT04uc3RyaW5naWZ5KGEpKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oZCxmKXtiLmdldFVzZXJNZWRpYVByaXZhdGUoYSxmdW5jdGlvbihhKXtxLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCJnZXRVc2VyTWVkaWFfdjI6IHJlc29sdmluZyBzdHJlYW1cIik7ZChhKX0sZnVuY3Rpb24oYSl7cS5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiZ2V0VXNlck1lZGlhX3YyOiByZWplY3Rpbmcgc3RyZWFtXCIpO2YoYSl9KX0pfTtiLnByb3RvdHlwZS5nZXRVc2VyTWVkaWFfdjE9ZnVuY3Rpb24oYSxiLGQpe3EubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRVc2VyTWVkaWFfdjEoKSBjYWxsZWQ6IFwiK0pTT04uc3RyaW5naWZ5KGEpKTtyZXR1cm4gdGhpcy5nZXRVc2VyTWVkaWFQcml2YXRlKGEsXHJcbmIsZCl9O2IucHJvdG90eXBlLmdldFVzZXJNZWRpYVByaXZhdGU9ZnVuY3Rpb24oYSxiLGMpe3ZhciBmPXRoaXM7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJOYXZpZ2F0b3JVc2VyTWVkaWEuZ2V0VXNlck1lZGlhUHJpdmF0ZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGI9Zi5yZWdpc3RlckNhbGxiYWNrcyghMCwhMSxkLm1ldGhvZF9pZF9OYXZpZ2F0b3JVc2VyTWVkaWFfdC5nZXRVc2VyTWVkaWEpLGM9Si50b1JlbW90ZU1lZGlhU3RyZWFtQ29uc3RyYWludHMoYSk7Zi5yZW1vdGVJbnZva2UoITEsZC5tZXRob2RfaWRfTmF2aWdhdG9yVXNlck1lZGlhX3QuZ2V0VXNlck1lZGlhLGMsYi5zdWNjZXNzLGIuZmFpbCk7cmV0dXJuIGIucHJvbSgpfSkudGhlbihmdW5jdGlvbihhKXtxLmxvZ2dlci5sb2coZi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0VXNlck1lZGlhUHJpdmF0ZTogcmVjZWl2ZWQgc3VjY2VzcyBjYWxsYmFjayFcIik7cmV0dXJuKG5ldyB4KG51bGwsZi5wYXJhbTAoYSkub2lkLFxyXG53LlByb3h5TW9kZS5SZW1vdGUpKS5zeW5jQmFycmllcigpfSkudGhlbihmdW5jdGlvbihkKXtxLmxvZ2dlci5sb2coZi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0VXNlck1lZGlhUHJpdmF0ZTogTWVkaWFTdHJlYW0gcmVhZHkgdG8gZGVsaXZlclwiLEpTT04uc3RyaW5naWZ5KGQpKTswPT1kLmdldFRyYWNrcygpLmxlbmd0aD8ocS5sb2dnZXIubG9nKGYudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFVzZXJNZWRpYVByaXZhdGU6IHJlcG9ydGluZyBubyB0cmFja3MgYXMgZXJyb3IuXCIpLGMoe2NvbnN0cmFpbnROYW1lOlwiXCIsbmFtZTpcIk92ZXJjb25zdHJhaW5lZEVycm9yXCIsbWVzc2FnZTpcIlwifSkpOihmLkxvZ1RlbGVtZXRyeURldmljZV8oYSksYihkKSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2YubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5nZXRVc2VyTWVkaWFQcml2YXRlKCkgZmFpbGVkIVwiKTtuLmdldFJlZGlyZWN0b3IoKS5nZXRGZWF0dXJlVmFsdWUoZC5GRUFUVVJFX21zX3RlYW1zXzE5MTIpP1xyXG5mLnBhcmFtMCYmYT9jKGYucGFyYW0wKGEpKTpjKHtjb25zdHJhaW50TmFtZTpcIlwiLG5hbWU6XCJPdmVyY29uc3RyYWluZWRFcnJvclwiLG1lc3NhZ2U6XCJcIn0pOmMoe2NvbnN0cmFpbnROYW1lOlwiXCIsbmFtZTpcIk92ZXJjb25zdHJhaW5lZEVycm9yXCIsbWVzc2FnZTpcIlwifSl9KX07Yi5wcm90b3R5cGUuU2VuZFRlbGVtZXRyeURhdGE9ZnVuY3Rpb24oYSxiLGQpe24uZ2V0UmVkaXJlY3RvcigpLnRlbGVtZXRyeS5TZW5kVGVsZW1ldHJ5RGF0YShrLnRlbF9jbWQuRGF0YSxhLGIsZCl9O2IuY2FwYWJpbGl0aWVzPW5ldyBHO3JldHVybiBifSh3LlByb3h5T2JqZWN0KTthLk5hdmlnYXRvclVzZXJNZWRpYT1ifSw2NTA6ZnVuY3Rpb24oYixhLGMpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO2EuUmVtb3RlU2Vzc2lvbj1hLlNlc3Npb25JbmZvPWEuUmVtb3RlVHlwZT12b2lkIDA7dmFyIGU9Yyg5NDYpLGw9Yyg1NTApLGg9Yyg5KSxkPWMoODUxKSx3PWMoNTUwKSxcclxucT1jKDM5NCksbjsoZnVuY3Rpb24oYSl7YVthLlVua25vd249MF09XCJVbmtub3duXCI7YVthLldpbmRvd3M9MV09XCJXaW5kb3dzXCI7YVthLkxpbnV4PTJdPVwiTGludXhcIn0pKG49YS5SZW1vdGVUeXBlfHwoYS5SZW1vdGVUeXBlPXt9KSk7dmFyIGs9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oKXt9fSgpO2EuU2Vzc2lvbkluZm89aztiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQpe3ZhciBjPXRoaXM7dGhpcy5pc3JlbW90ZV89ITE7dGhpcy5pc3JlbW90ZV89ITA7dGhpcy50eXBlXz1uLldpbmRvd3M7dGhpcy5hZGRyZXNzXz1cIjAuMC4wLjBcIjt0aGlzLnNlc3Npb25pbmZvXz1udWxsO2UuZ2V0UmVkaXJlY3RvcigpLnNldFJlbW90ZVNlc3Npb25JbmZvQ2IoZnVuY3Rpb24oKXtyZXR1cm4gYy5yZW1vdGVTZXNzaW9uSW5mbygpfSk7dGhpcy5lbmdpbmVjb250cm9sXz1uZXcgaC5FbmdpbmVDb250cm9sKGIrXCI6OlwiK2QpfWEucHJvdG90eXBlLnJlbGVhc2U9ZnVuY3Rpb24oKXtlLmdldFJlZGlyZWN0b3IoKS5zZXRSZW1vdGVTZXNzaW9uSW5mb0NiKG51bGwpfTtcclxuYS5wcm90b3R5cGUudXNlcl9mcmllbmRseV9pZD1mdW5jdGlvbigpe3JldHVyblwiW1JlbW90ZVNlc3Npb25dXCJ9O2EucHJvdG90eXBlLmdldEZlYXR1cmVGbGFncz1mdW5jdGlvbigpe3ZhciBhPXt9O251bGwhPT10aGlzLmVuZ2luZWNvbnRyb2xfJiZudWxsIT09dGhpcy5lbmdpbmVjb250cm9sXy5mZWF0dXJlc18mJnZvaWQgMCE9PXRoaXMuZW5naW5lY29udHJvbF8uZmVhdHVyZXNfJiZ0aGlzLmVuZ2luZWNvbnRyb2xfLmZlYXR1cmVzXy5mb3JFYWNoKGZ1bmN0aW9uKGIpe2FbYi5uYW1lXT1iLnZhbHVlfSk7cmV0dXJuIGF9O2EucHJvdG90eXBlLmlzRmVhdHVyZVN1cHBvcnRlZD1mdW5jdGlvbihhKXtpZihcInZpZGVvXCI9PT1hKXJldHVybiEwO2lmKFwiZ2l2ZWNvbnRyb2xcIj09PWEmJnRoaXMuc2Vzc2lvbmluZm9fLmNsaWVudFBsYXRmb3JtLmluY2x1ZGVzKFwiTGludXhcIil8fCEoYSBpbiB3LmZlYXR1cmVOYW1lTWFwKSlyZXR1cm4hMTtmb3IodmFyIGI9dy5mZWF0dXJlTmFtZU1hcFthXSxcclxuZD10aGlzLmdldEZlYXR1cmVGbGFncygpLGM9MDtjPGIubGVuZ3RoO2MrKylpZighKGJbY11pbiBkKXx8ITAhPT1kW2JbY11dKXJldHVybiExO3JldHVybiBhIGluIHcudmRhRmVhdHVyZU5hbWVNYXA/dy52ZGFGZWF0dXJlTmFtZU1hcFthXS5tYXAoZnVuY3Rpb24oYSl7cmV0dXJuIGUuZ2V0UmVkaXJlY3RvcigpLmdldFZEQUZlYXR1cmVWYWx1ZShhKX0pLnJlZHVjZShmdW5jdGlvbihhLGIpe3JldHVybiBhJiZifSwhMCk6ITB9O2EuaXNGZWF0dXJlUHN0blN1cHBvcnRlZD1mdW5jdGlvbigpe3JldHVybiBhLnBzdG5ffTthLmlzRmVhdHVyZUR0bWZTdXBwb3J0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gYS5kdG1mc3dpdGNoX307YS5pc0ZlYXR1ckFwcHNoYXJlU3VwcG9ydGVkPWZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwc2hhcmVffTthLmlzRmVhdHVyZVdlYnJ0YzFkb3QwU3VwcG9ydGVkPWZ1bmN0aW9uKCl7cmV0dXJuIGEud2VicnRjMWRvdDBffTthLmlzRmVhdHVyZURhdGFDaGFubmVsU3VwcG9ydGVkPVxyXG5mdW5jdGlvbigpe3JldHVybiBhLmRhdGFjaGFubmVsX307YS5pc0ZlYXR1cmVWZE5vQnVmZmVyTGltaXRTdXBwb3J0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gYS52ZG5vYnVmbGltaXRffTthLmlzRmVhdHVyZUNhbGxDb25zdHJhaW50c1N1cHBvcnRlZD1mdW5jdGlvbigpe3JldHVybiBhLmNhbGxjb25zdHJhaW50c199O2EuaXNGZWF0dXJlVHJhY2tDbG9uZVdpdGhJZFN1cHBvcnRlZD1mdW5jdGlvbigpe3JldHVybiBhLnRyYWNrY2xvbmV3aXRoaWRffTthLmlzRmVhdHVyZVNlbmRlclN0YXRzRml4U3VwcG9ydGVkPWZ1bmN0aW9uKCl7cmV0dXJuIGEuc2VuZGVyc3RhdHNmaXhffTthLnByb3RvdHlwZS5nZXRTZXNzaW9uSW5mbz1mdW5jdGlvbigpe2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRTZXNzaW9uSW5mbygpIGNhbGxlZC5cIik7cmV0dXJuIG51bGwhPXRoaXMuc2Vzc2lvbmluZm9fP1Byb21pc2UucmVzb2x2ZSh0aGlzLnNlc3Npb25pbmZvXyk6UHJvbWlzZS5yZWplY3QoKX07XHJcbmEucHJvdG90eXBlLnJlbW90ZVNlc3Npb25JbmZvPWZ1bmN0aW9uKCl7dmFyIGI9dGhpcyxjPXRoaXM7ZC5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLnJlbW90ZVNlc3Npb25JbmZvKCkgY2FsbGVkLlwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24obix0KXtjLmVuZ2luZWNvbnRyb2xfLnN5bmNCYXJyaWVyKCkudGhlbihmdW5jdGlvbihlKXtkLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCJlbmdpbmVjb250cm9sIGluZm8gcmVjZWl2ZWQhXCIpO2Muc2Vzc2lvbmluZm9fPW5ldyBrO2Muc2Vzc2lvbmluZm9fLnR5cGVfc2NyaXB0PWwuSERYTVNfVkVSU0lPTjtjLnNlc3Npb25pbmZvXy53ZWJycGM9ZS52ZXJzaW9uXy5tYWpvci50b1N0cmluZygpK1wiLlwiK2UudmVyc2lvbl8ubWlub3IudG9TdHJpbmcoKStcIi5cIitlLnZlcnNpb25fLnJldmlzaW9uLnRvU3RyaW5nKCkrXCIuXCIrZS52ZXJzaW9uXy5idWlsZC50b1N0cmluZygpO2lmKHZvaWQgMCE9ZS52ZXJzaW9uc18mJlxyXG5udWxsIT1lLnZlcnNpb25zXyl7Yy5TZW5kVGVsZW1ldHJ5RGF0YShxLnRlbF9rZXlfVmVyVHlwZVNjcmlwdCxsLkhEWE1TX1ZFUlNJT04sMCk7Zm9yKHZhciB0PTAseT0wLHg9ZS52ZXJzaW9uc187eTx4Lmxlbmd0aDt5Kyspe3ZhciByPXhbeV0scj1yLm1ham9yLnRvU3RyaW5nKCkrXCIuXCIrci5taW5vci50b1N0cmluZygpK1wiLlwiK3IucmV2aXNpb24udG9TdHJpbmcoKStcIi5cIityLmJ1aWxkLnRvU3RyaW5nKCk7c3dpdGNoKHQpe2Nhc2UgaC5WZXJzaW9uVHlwZS5XZWJycGM6Yy5zZXNzaW9uaW5mb18ud2VicnBjPXI7Yy5TZW5kVGVsZW1ldHJ5RGF0YShxLnRlbF9rZXlfVmVyV2VicnBjLHIsMCk7YnJlYWs7Y2FzZSBoLlZlcnNpb25UeXBlLldlYnJ0Y0NvZGVjczpjLnNlc3Npb25pbmZvXy53ZWJydGNfY29kZWNzPXI7Yy5TZW5kVGVsZW1ldHJ5RGF0YShxLnRlbF9rZXlfVmVyV2VicnRjQ29kZWNzLHIsMCk7YnJlYWs7Y2FzZSBoLlZlcnNpb25UeXBlLlJlY2VpdmVyOmMuc2Vzc2lvbmluZm9fLnJlY2VpdmVyPVxyXG5yO2MuU2VuZFRlbGVtZXRyeURhdGEocS50ZWxfa2V5X1ZlclJlY2VpdmVyLHIsMCk7YnJlYWs7Y2FzZSBoLlZlcnNpb25UeXBlLlZkYTpjLnNlc3Npb25pbmZvXy52ZGE9cjtjLlNlbmRUZWxlbWV0cnlEYXRhKHEudGVsX2tleV9WZXJWZGEsciwwKTticmVhaztjYXNlIGguVmVyc2lvblR5cGUuRW5kcG9pbnQ6Yy5zZXNzaW9uaW5mb18uZW5kcG9pbnQ9cjtjLlNlbmRUZWxlbWV0cnlEYXRhKHEudGVsX2tleV9WZXJFbmRwb2ludCxyLDApO2JyZWFrO2Nhc2UgaC5WZXJzaW9uVHlwZS5IZHhSdGNFbmdpbmU6Yy5zZXNzaW9uaW5mb18uaGR4cnRjZW5naW5lPXI7Yy5TZW5kVGVsZW1ldHJ5RGF0YShxLnRlbF9rZXlfVmVySGR4UnRjRW5naW5lLHIsMCk7YnJlYWs7ZGVmYXVsdDpkLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCJVbmtub3duIHZlcnNpb24gdHlwZSFcIil9dCsrfX12b2lkIDAhPWUub3NpbmZvXyYmbnVsbCE9ZS5vc2luZm9fJiYoYy5zZXNzaW9uaW5mb18ub3NpbmZvPVxyXG5lLm9zaW5mb18sZS5vc2luZm9fLmZhbWlseS5pbmNsdWRlcyhcIkRhcndpblwiKSYmW1wiTWFjIE9TIFhcIixcIm1hY09TXCIsXCJPUyBYXCJdLnNvbWUoZnVuY3Rpb24oYSl7cmV0dXJuIGUub3NpbmZvXy5lZGl0aW9uLnN0YXJ0c1dpdGgoYSl9KT9jLnNlc3Npb25pbmZvXy5jbGllbnRQbGF0Zm9ybT1cIk1hY1wiOmMuc2Vzc2lvbmluZm9fLmNsaWVudFBsYXRmb3JtPWUub3NpbmZvXy5mYW1pbHksYy5TZW5kVGVsZW1ldHJ5RGF0YShxLnRlbF9rZXlfT1NGYW1pbHksZS5vc2luZm9fLmZhbWlseSwwKSxjLlNlbmRUZWxlbWV0cnlEYXRhKHEudGVsX2tleV9PU1ZlcnNpb24sZS5vc2luZm9fLnZlcnNpb24sMCksYy5TZW5kVGVsZW1ldHJ5RGF0YShxLnRlbF9rZXlfT1NBcmNoaXRlY3R1cmUsZS5vc2luZm9fLmFyY2hpdGVjdHVyZSwwKSxjLlNlbmRUZWxlbWV0cnlEYXRhKHEudGVsX2tleV9PU0Rpc3RybyxlLm9zaW5mb18uZGlzdHJvLDApLGMuU2VuZFRlbGVtZXRyeURhdGEocS50ZWxfa2V5X09TRWRpdGlvbixcclxuZS5vc2luZm9fLmVkaXRpb24sMCkpO3ZvaWQgMCE9ZS5lbmRwb2ludGlkXyYmbnVsbCE9ZS5lbmRwb2ludGlkXyYmKGMuc2Vzc2lvbmluZm9fLmVuZHBvaW50SWQ9ZS5lbmRwb2ludGlkXy5tYWNoaW5lX2lkKTt2b2lkIDAhPWUuaGFyZHdhcmVpbmZvXyYmbnVsbCE9ZS5oYXJkd2FyZWluZm9fJiYoYy5zZXNzaW9uaW5mb18uaGFyZHdhcmVfaW5mbz1lLmhhcmR3YXJlaW5mb18sYy5TZW5kVGVsZW1ldHJ5RGF0YShxLnRlbF9rZXlfQ1BVTW9kZWwsZS5oYXJkd2FyZWluZm9fLmNwdV9pbmZvLmNwdW1vZGVsLDApLGMuU2VuZFRlbGVtZXRyeURhdGEocS50ZWxfa2V5X0NQVVByb2Nlc3NvcnMsZS5oYXJkd2FyZWluZm9fLmNwdV9pbmZvLm51bWJlcm9mcHJvY2Vzc29ycywwKSxjLlNlbmRUZWxlbWV0cnlEYXRhKHEudGVsX2tleV9DUFVHcHVpbmZvLEpTT04uc3RyaW5naWZ5KGUuaGFyZHdhcmVpbmZvXy5ncHVfaW5mby5ncHVzKSwwKSxjLlNlbmRUZWxlbWV0cnlEYXRhKHEudGVsX2tleV9DUFVUb3RhbG1lbW9yeSxcclxuZS5oYXJkd2FyZWluZm9fLm1lbW9yeV9pbmZvLnRvdGFsbWVtb3J5LDApKTthLnBzdG5fPWIuaXNGZWF0dXJlU3VwcG9ydGVkKGwuRmVhdHVyZXMuRkVBVFVSRV9wdWJsaWNfcHN0bik7YS5kdG1mc3dpdGNoXz1iLmlzRmVhdHVyZVN1cHBvcnRlZChsLkZlYXR1cmVzLkZFQVRVUkVfcHVibGljX2R0bWYpO2EuYXBwc2hhcmVfPWIuaXNGZWF0dXJlU3VwcG9ydGVkKGwuRmVhdHVyZXMuRkVBVFVSRV9wdWJsaWNfYXBwX3NoYXJpbmcpO2Eud2VicnRjMWRvdDBfPWIuaXNGZWF0dXJlU3VwcG9ydGVkKGwuRmVhdHVyZXMuRkVBVFVSRV9wdWJsaWNfd2VicnRjMWRvdDApO2EuZGF0YWNoYW5uZWxfPWIuaXNGZWF0dXJlU3VwcG9ydGVkKGwuRmVhdHVyZXMuRkVBVFVSRV9wdWJsaWNfZGF0YV9jaGFubmVsKTthLnZkbm9idWZsaW1pdF89Yi5pc0ZlYXR1cmVTdXBwb3J0ZWQobC5GZWF0dXJlcy5GRUFUVVJFX3B1YmxpY192ZG5vYnVmbGltaXQpO2EuY2FsbGNvbnN0cmFpbnRzXz1iLmlzRmVhdHVyZVN1cHBvcnRlZChsLkZlYXR1cmVzLkZFQVRVUkVfcHVibGljX3N0cmVhbV9yZXNvbHV0aW9uKTtcclxuYS50cmFja2Nsb25ld2l0aGlkXz1iLmlzRmVhdHVyZVN1cHBvcnRlZChsLkZlYXR1cmVzLkZFQVRVUkVfcHVibGljX3RyYWNrX2Nsb25lX3dpdGhfaWQpO2Euc2VuZGVyc3RhdHNmaXhfPWIuaXNGZWF0dXJlU3VwcG9ydGVkKGwuRmVhdHVyZXMuRkVBVFVSRV9wdWJsaWNfc2VuZGVyX3N0YXRzX2ZpeCk7bihjLnNlc3Npb25pbmZvXyk7Yy5lbmdpbmVjb250cm9sXy5yZWxlYXNlKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7ZS5nZXRSZWRpcmVjdG9yKCkuaXNQaW5nQWN0aXZlKCk/Yy5yZXRyeVNlc3Npb25JbmZvKCk6KHQoKSxjLmVuZ2luZWNvbnRyb2xfLnJlbGVhc2UoKSxjLmVuZ2luZWNvbnRyb2xfPW51bGwpfSl9KX07YS5wcm90b3R5cGUucmV0cnlTZXNzaW9uSW5mbz1mdW5jdGlvbigpe3ZhciBhPXRoaXM7c2V0VGltZW91dChmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyhcImNoZWNraW5nIGlmIHdlIGFyZSBjb25uZWN0ZWQuLi5cIik7YS5lbmdpbmVjb250cm9sXy5iaW5kKCk7ZS5nZXRSZWRpcmVjdG9yKCkuaGFuZGxlUmVtb3RlU2Vzc2lvbkluZm8oKX0sXHJcbjE1RTMpfTthLnByb3RvdHlwZS5TZW5kVGVsZW1ldHJ5RGF0YT1mdW5jdGlvbihhLGIsZCl7ZS5nZXRSZWRpcmVjdG9yKCkudGVsZW1ldHJ5LlNlbmRUZWxlbWV0cnlEYXRhKHEudGVsX2NtZC5EYXRhLGEsYixkKX07YS5wc3RuXz0hMTthLmR0bWZzd2l0Y2hfPSExO2EuYXBwc2hhcmVfPSExO2Eud2VicnRjMWRvdDBfPSExO2EuZGF0YWNoYW5uZWxfPSExO2EudmRub2J1ZmxpbWl0Xz0hMTthLmNhbGxjb25zdHJhaW50c189ITE7YS50cmFja2Nsb25ld2l0aGlkXz0hMTthLnNlbmRlcnN0YXRzZml4Xz0hMTtyZXR1cm4gYX0oKTthLlJlbW90ZVNlc3Npb249Yn0sMjQ6ZnVuY3Rpb24oYixhLGMpe3ZhciBlPXRoaXMmJnRoaXMuX19leHRlbmRzfHxmdW5jdGlvbigpe3ZhciBhPWZ1bmN0aW9uKGIsZCl7YT1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oYSxiKXthLl9fcHJvdG9fXz1ifXx8ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGQgaW4gYiliLmhhc093blByb3BlcnR5KGQpJiZcclxuKGFbZF09YltkXSl9O3JldHVybiBhKGIsZCl9O3JldHVybiBmdW5jdGlvbihiLGQpe2Z1bmN0aW9uIGMoKXt0aGlzLmNvbnN0cnVjdG9yPWJ9YShiLGQpO2IucHJvdG90eXBlPW51bGw9PT1kP09iamVjdC5jcmVhdGUoZCk6KGMucHJvdG90eXBlPWQucHJvdG90eXBlLG5ldyBjKX19KCk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7YS5SdGNEYXRhQ2hhbm5lbD1hLlJUQ1NjdHBUcmFuc3BvcnQ9dm9pZCAwO3ZhciBsPWMoNjU4KSxoPWMoNTUwKSxkPWMoODUxKSx3PWMoNTg5KSxxOyhmdW5jdGlvbihhKXthW2FbXCJuZXdcIl09MF09XCJuZXdcIjthW2EuY29ubmVjdGluZz0xXT1cImNvbm5lY3RpbmdcIjthW2EuY29ubmVjdGVkPTJdPVwiY29ubmVjdGVkXCI7YVthLmNsb3NlZD0zXT1cImNsb3NlZFwiO2FbYS5tYXg9NF09XCJtYXhcIn0pKHF8fChxPXt9KSk7Yj1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKGMsZyl7dmFyIGU9YS5jYWxsKHRoaXMsYyxoLmNsYXNzX2lkX3QuUlRDU2N0cFRyYW5zcG9ydCxcclxuZyxsLlByb3h5TW9kZS5SZW1vdGUpfHx0aGlzO2QubG9nZ2VyLmxvZyhlLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jb25zdHJ1Y3RvclwiKTtyZXR1cm4gZX1lKGIsYSk7Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllcigpIGNhbGxlZC5cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGIsYyl7YS5zeW5jQmFycmllckRlZXAoYixjKSYmYS53YWl0VW50aWxDb25uZWN0ZWQoXCJSVENTY3RwVHJhbnNwb3J0LnN5bmNCYXJyaWVyXCIpLnRoZW4oZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXJCYXNlIHN1Y2Nlc3MuXCIpO3JldHVybiBQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDU2N0cFRyYW5zcG9ydF90LnRyYW5zcG9ydCx7b2lkOjB9KSxhLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENTY3RwVHJhbnNwb3J0X3Quc3RhdGUsXHJcbjApLGEucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1JUQ1NjdHBUcmFuc3BvcnRfdC5tYXhNZXNzYWdlU2l6ZSwwKSxhLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENTY3RwVHJhbnNwb3J0X3QubWF4Q2hhbm5lbHMsMCldKX0pLnRoZW4oZnVuY3Rpb24oYil7dmFyIGM7Yz1iLm1hcChmdW5jdGlvbihiKXtyZXR1cm4gYS5wYXJhbTAoYil9KTtiPWNbMF07YS5zY3Rwc3RhdGVfPWNbMV07YS5tYXhNZXNzYWdlU2l6ZV89Y1syXTthLm1heENoYW5uZWxzXz1jWzNdO2M9YS50cmFuc3BvcnRfO3ZvaWQgMD09Ynx8ITEhPT1iLmlzX251bGx8fG51bGwhPT1hLnRyYW5zcG9ydF8mJmEudHJhbnNwb3J0Xy5vYmplY3RfaWQoKT09Yi5vaWR8fChjPW5ldyB3LkR0bHNUcmFuc3BvcnQoYSxiLm9pZCkpO2Muc3luY0JhcnJpZXIoKS50aGVuKGZ1bmN0aW9uKGIpe2QubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcInRyYW5zcG9ydC5zeW5jQmFycmllcigpOiBzdWNjZXNzXCIpO1xyXG5hLnRyYW5zcG9ydF89YjthLnN5bmNCYXJyaWVyUmVzb2x2ZShhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCJ0cmFuc3BvcnQuc3luY0JhcnJpZXIoKTogZmFpbGVkIVwiKTthLnRyYW5zcG9ydF89bnVsbDthLnN5bmNCYXJyaWVyUmVzb2x2ZShhKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtiPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5zeW5jQmFycmllcigpIGZhaWxlZCFcIik7YS5zeW5jQmFycmllclJlamVjdChiKX0pfSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInRyYW5zcG9ydFwiLHtnZXQ6ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X3RyYW5zcG9ydCgpIGNhbGxlZDogXCIrdGhpcy50cmFuc3BvcnRfKTtyZXR1cm4gdGhpcy50cmFuc3BvcnRffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcclxuXCJzdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X3N0YXRlKCkgY2FsbGVkOiBcIit0aGlzLnNjdHBzdGF0ZV8pO3JldHVybiB0aGlzLnNjdHBzdGF0ZV99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwibWF4TWVzc2FnZVNpemVcIix7Z2V0OmZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9tYXhNZXNzYWdlU2l6ZSgpIGNhbGxlZDogXCIrdGhpcy5tYXhNZXNzYWdlU2l6ZV8pO3JldHVybiB0aGlzLm1heE1lc3NhZ2VTaXplX30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJtYXhDaGFubmVsc1wiLHtnZXQ6ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X21heENoYW5uZWxzKCkgY2FsbGVkOiBcIitcclxudGhpcy5tYXhDaGFubmVsc18pO3JldHVybiB0aGlzLm1heENoYW5uZWxzX30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbnN0YXRlY2hhbmdlXCIse2dldDpmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfb25zdGF0ZWNoYW5nZSgpIGNhbGxlZDogXCIrdGhpcy5vbnN0YXRlY2hhbmdlXyk7cmV0dXJuIHRoaXMub25zdGF0ZWNoYW5nZV99LHNldDpmdW5jdGlvbihhKXt2YXIgYz10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25zdGF0ZWNoYW5nZSgpIGNhbGxlZC5cIik7dGhpcy5vbnN0YXRlY2hhbmdlXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uc3RhdGVjaGFuZ2VcIikudGhlbihmdW5jdGlvbigpe3ZhciBlPWMucmVnaXN0ZXJDYWxsYmFja3MoITEsYy5pc051bGxDYWxsYmFjayhhKSxcclxuaC5tZXRob2RfaWRfUlRDU2N0cFRyYW5zcG9ydF90Lm9uc3RhdGVjaGFuZ2UpO2UudGhlbihmdW5jdGlvbihhKXtkLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25zdGF0ZWNoYW5nZSBjYWxsYmFjayByZWNlaXZlZCEhIVwiKTtjLnNjdHBzdGF0ZV89Yi5jb252ZXJ0U3RhdGUoYy5wYXJhbTAoYSkpO2QubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcInNjdHBzdGF0ZV86IFwiK2Muc2N0cHN0YXRlXyk7YT1uZXcgRXZlbnQoXCJvbnN0YXRlY2hhbmdlXCIpO2Mub25zdGF0ZWNoYW5nZV8oYSl9KTtyZXR1cm4gYy5yZW1vdGVJbnZva2UoITAsaC5tZXRob2RfaWRfUlRDU2N0cFRyYW5zcG9ydF90Lm9uc3RhdGVjaGFuZ2UsZS5zdWNjZXNzKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25zdGF0ZWNoYW5nZSgpIGZhaWxlZC5cIil9KX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtiLmNvbnZlcnRTdGF0ZT1cclxuZnVuY3Rpb24oYSl7cmV0dXJuIGE9PXFbXCJuZXdcIl0/XCJjbG9zZWRcIjphPT1xLmNvbm5lY3Rpbmc/XCJjb25uZWN0aW5nXCI6YT09cS5jb25uZWN0ZWQ/XCJjb25uZWN0ZWRcIjpcImNsb3NlZFwifTtyZXR1cm4gYn0obC5Qcm94eU9iamVjdCk7YS5SVENTY3RwVHJhbnNwb3J0PWI7dmFyIG47KGZ1bmN0aW9uKGEpe2FbYS5jb25uZWN0aW5nPTBdPVwiY29ubmVjdGluZ1wiO2FbYS5vcGVuPTFdPVwib3BlblwiO2FbYS5jbG9zaW5nPTJdPVwiY2xvc2luZ1wiO2FbYS5jbG9zZWQ9M109XCJjbG9zZWRcIn0pKG58fChuPXt9KSk7Yj1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKGMsZyxlKXtjPWEuY2FsbCh0aGlzLGMsaC5jbGFzc19pZF90LlJUQ0RhdGFDaGFubmVsLGcsZSl8fHRoaXM7Yy5iaW5hcnlUeXBlXz1cImJsb2JcIjtkLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY29uc3RydWN0b3JcIik7cmV0dXJuIGN9ZShiLGEpO2IucHJvdG90eXBlLnN5bmNCYXJyaWVyPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztcclxuZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyKCkgY2FsbGVkLlwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixjKXthLnN5bmNCYXJyaWVyRGVlcChiLGMpJiZhLndhaXRVbnRpbENvbm5lY3RlZChcIlJ0Y0RhdGFDaGFubmVsLnN5bmNCYXJyaWVyXCIpLnRoZW4oZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIgcmVtb3RlIGludm9raW5nLlwiKTtyZXR1cm4gUHJvbWlzZS5hbGwoW2EucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3QubGFiZWwsXCJcIiksYS5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5vcmRlcmVkLCEwKSxhLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90Lm1heFBhY2tldExpZmVUaW1lLDApLGEucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3QubWF4UmV0cmFuc21pdHMsXHJcbjApLGEucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3QucHJvdG9jb2wsXCJcIiksYS5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5uZWdvdGlhdGVkLCExKSxhLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90LmlkLDApLGEucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3QucmVhZHlTdGF0ZSwwKSxhLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90LmJ1ZmZlcmVkQW1vdW50LDApLGEucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3QuYnVmZmVyZWRBbW91bnRMb3dUaHJlc2hvbGQsMCldKX0pLnRoZW4oZnVuY3Rpb24oYil7ZC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyIHN1Y2Nlc3MuXCIpO3ZhciBjO2I9Yi5tYXAoZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyYW0wKGIpfSk7XHJcbmEubGFiZWxfPWJbMF07YS5vcmRlcmVkXz1iWzFdO2EubWF4UGFja2V0TGlmZVRpbWVfPWJbMl07YS5tYXhSZXRyYW5zbWl0c189YlszXTthLnByb3RvY29sXz1iWzRdO2EubmVnb3RpYXRlZF89Yls1XTthLmlkXz1iWzZdO2M9Yls3XTthLmJ1ZmZlcmVkQW1vdW50Xz1iWzhdO2EuYnVmZmVyZWRBbW91bnRMb3dUaHJlc2hvbGRfPWJbOV07YS5yZWFkeVN0YXRlXz1hLnRvUlRDRGF0YUNoYW5uZWxTdGF0ZShjKTthLnN5bmNCYXJyaWVyUmVzb2x2ZShhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7Yj1hLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuc3luY0JhcnJpZXIoKSBmYWlsZWQhXCIpO2Euc3luY0JhcnJpZXJSZWplY3QoYil9KX0pfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJsYWJlbFwiLHtnZXQ6ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X2xhYmVsKCkgY2FsbGVkOiBcIit0aGlzLmxhYmVsXyk7cmV0dXJuIHRoaXMubGFiZWxffSxcclxuZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvcmRlcmVkXCIse2dldDpmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfb3JkZXJlZCgpIGNhbGxlZDogXCIrdGhpcy5vcmRlcmVkXyk7cmV0dXJuIHRoaXMub3JkZXJlZF99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwibWF4UGFja2V0TGlmZVRpbWVcIix7Z2V0OmZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9tYXhQYWNrZXRMaWZlVGltZSgpIGNhbGxlZDogXCIrdGhpcy5tYXhQYWNrZXRMaWZlVGltZV8pO3JldHVybiB0aGlzLm1heFBhY2tldExpZmVUaW1lX30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJtYXhSZXRyYW5zbWl0c1wiLFxyXG57Z2V0OmZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9tYXhSZXRyYW5zbWl0cygpIGNhbGxlZDogXCIrdGhpcy5tYXhSZXRyYW5zbWl0c18pO3JldHVybiB0aGlzLm1heFJldHJhbnNtaXRzX30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJwcm90b2NvbFwiLHtnZXQ6ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X3Byb3RvY29sKCkgY2FsbGVkOiBcIit0aGlzLnByb3RvY29sXyk7cmV0dXJuIHRoaXMucHJvdG9jb2xffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm5lZ290aWF0ZWRcIix7Z2V0OmZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9uZWdvdGlhdGVkKCkgY2FsbGVkOiBcIit0aGlzLm5lZ290aWF0ZWRfKTtcclxucmV0dXJuIHRoaXMubmVnb3RpYXRlZF99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwiaWRcIix7Z2V0OmZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9pZCgpIGNhbGxlZDogXCIrdGhpcy5pZF8pO3JldHVybiB0aGlzLmlkX30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJyZWFkeVN0YXRlXCIse2dldDpmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfcmVhZHlTdGF0ZSgpIGNhbGxlZDogXCIrdGhpcy5yZWFkeVN0YXRlXyk7cmV0dXJuIHRoaXMucmVhZHlTdGF0ZV99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwiYnVmZmVyZWRBbW91bnRcIix7Z2V0OmZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5nZXRfYnVmZmVyZWRBbW91bnQoKSBjYWxsZWQ6IFwiK3RoaXMuYnVmZmVyZWRBbW91bnRfKTtyZXR1cm4gdGhpcy5idWZmZXJlZEFtb3VudF99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwiYnVmZmVyZWRBbW91bnRMb3dUaHJlc2hvbGRcIix7Z2V0OmZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9idWZmZXJlZEFtb3VudExvd1RocmVzaG9sZCgpIGNhbGxlZDogXCIrdGhpcy5idWZmZXJlZEFtb3VudExvd1RocmVzaG9sZF8pO3JldHVybiB0aGlzLmJ1ZmZlcmVkQW1vdW50TG93VGhyZXNob2xkX30sc2V0OmZ1bmN0aW9uKGEpe2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfYnVmZmVyZWRBbW91bnRMb3dUaHJlc2hvbGQoKSBjYWxsZWQ6IFwiK2EpO3RoaXMuYnVmZmVyZWRBbW91bnRMb3dUaHJlc2hvbGRfPWF9LGVudW1lcmFibGU6ITEsXHJcbmNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImJpbmFyeVR5cGVcIix7Z2V0OmZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9iaW5hcnlUeXBlKCkgY2FsbGVkOiBcIit0aGlzLmJpbmFyeVR5cGVfKTtyZXR1cm4gdGhpcy5iaW5hcnlUeXBlX30sc2V0OmZ1bmN0aW9uKGEpe2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfYmluYXJ5VHlwZSgpIGNhbGxlZDogXCIrYSk7dGhpcy5iaW5hcnlUeXBlXz1cImJsb2JcIj09YXx8XCJhcnJheWJ1ZmZlclwiPT1hP2E6XCJibG9iXCJ9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25vcGVuXCIse2dldDpmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfb25vcGVuKCkgY2FsbGVkLlwiKTtyZXR1cm4gdGhpcy5vbm9wZW5ffSxcclxuc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbm9wZW4oKSBjYWxsZWQuXCIpO3RoaXMub25vcGVuXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9ub3BlblwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLGgubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3Qub25vcGVuKTtjLnRoZW4oZnVuY3Rpb24oYSl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9ub3BlbiBjYWxsYmFjayByZWNlaXZlZCEhIVwiKTtiLnN5bmNCYXJyaWVyKCkudGhlbihmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbm9wZW4gbm90aWZ5aW5nLi4uXCIpO3ZhciBhPW5ldyBFdmVudChcIm9wZW5cIix7fSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJ0YXJnZXRcIix7d3JpdGFibGU6ITEsXHJcbnZhbHVlOmJ9KTtiLm9ub3Blbl8oYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyKCk6IGZhaWxlZCFcIil9KX0pO3JldHVybiBiLnJlbW90ZUludm9rZSghMCxoLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90Lm9ub3BlbixjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbm9wZW4oKSBmYWlsZWQuXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25idWZmZXJlZGFtb3VudGxvd1wiLHtnZXQ6ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X29uYnVmZmVyZWRhbW91bnRsb3coKSBjYWxsZWQuXCIpO3JldHVybiB0aGlzLm9uYnVmZmVyZWRhbW91bnRsb3dffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztcclxuZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbmJ1ZmZlcmVkYW1vdW50bG93KCkgY2FsbGVkLlwiKTt0aGlzLm9uYnVmZmVyZWRhbW91bnRsb3dfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25idWZmZXJlZGFtb3VudGxvd1wiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLGgubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3Qub25idWZmZXJlZGFtb3VudGxvdyk7Yy50aGVuKGZ1bmN0aW9uKGEpe2QubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmJ1ZmZlcmVkYW1vdW50bG93IGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO2E9bmV3IEV2ZW50KFwib25idWZmZXJlZGFtb3VudGxvd1wiKTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcInRhcmdldFwiLHt3cml0YWJsZTohMSx2YWx1ZTpifSk7Yi5vbmJ1ZmZlcmVkYW1vdW50bG93XyhhKX0pO1xyXG5yZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsaC5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5vbmJ1ZmZlcmVkYW1vdW50bG93LGMuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uYnVmZmVyZWRhbW91bnRsb3dzKCkgZmFpbGVkLlwiKX0pfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9uZXJyb3JcIix7Z2V0OmZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9vbmVycm9yKCkgY2FsbGVkLlwiKTtyZXR1cm4gdGhpcy5vbmVycm9yX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbmVycm9yKCkgY2FsbGVkLlwiKTt0aGlzLm9uZXJyb3JfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXHJcblwiLm9uZXJyb3JcIikudGhlbihmdW5jdGlvbigpe3ZhciBjPWIucmVnaXN0ZXJDYWxsYmFja3MoITEsYi5pc051bGxDYWxsYmFjayhhKSxoLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90Lm9uZXJyb3IpO2MudGhlbihmdW5jdGlvbihhKXtkLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25lcnJvciBjYWxsYmFjayByZWNlaXZlZCFcIik7YT1iLnBhcmFtMChhKTtkLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCJlcnJvcjogXCIrYSk7YT1uZXcgRXZlbnQoXCJvbmVycm9yXCIpO09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwidGFyZ2V0XCIse3dyaXRhYmxlOiExLHZhbHVlOmJ9KTtiLm9uZXJyb3JfKGEpfSk7cmV0dXJuIGIucmVtb3RlSW52b2tlKCEwLGgubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3Qub25lcnJvcixjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmVycm9yKCkgZmFpbGVkLlwiKX0pfSxcclxuZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbmNsb3NpbmdcIix7Z2V0OmZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9vbmNsb3NpbmcoKSBjYWxsZWQuXCIpO3JldHVybiB0aGlzLm9uY2xvc2luZ199LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25jbG9zaW5nKCkgY2FsbGVkLlwiKTt0aGlzLm9uY2xvc2luZ189YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbmNsb3NpbmdcIikudGhlbihmdW5jdGlvbigpe3ZhciBjPWIucmVnaXN0ZXJDYWxsYmFja3MoITEsYi5pc051bGxDYWxsYmFjayhhKSxoLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90Lm9uY2xvc2luZyk7Yy50aGVuKGZ1bmN0aW9uKGEpe2QubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIub25jbG9zaW5nIGNhbGxiYWNrIHJlY2VpdmVkISEhXCIpO2E9bmV3IEV2ZW50KFwib25jbG9zaW5nXCIpO09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwidGFyZ2V0XCIse3dyaXRhYmxlOiExLHZhbHVlOmJ9KTtiLm9uY2xvc2luZ18oYSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsaC5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5vbmNsb3NpbmcsYy5zdWNjZXNzKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25jbG9zaW5nKCkgZmFpbGVkLlwiKX0pfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9uY2xvc2VcIix7Z2V0OmZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldF9vbmNsb3NlKCkgY2FsbGVkLlwiKTtyZXR1cm4gdGhpcy5vbmNsb3NlX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5zZXRfb25jbG9zZSgpIGNhbGxlZC5cIik7dGhpcy5vbmNsb3NlXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uY2xvc2VcIikudGhlbihmdW5jdGlvbigpe3ZhciBjPWIucmVnaXN0ZXJDYWxsYmFja3MoITEsYi5pc051bGxDYWxsYmFjayhhKSxoLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90Lm9uY2xvc2UpO2MudGhlbihmdW5jdGlvbihhKXtkLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25jbG9zZSBjYWxsYmFjayByZWNlaXZlZCEhIVwiKTthPW5ldyBFdmVudChcIm9uY2xvc2VcIik7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJ0YXJnZXRcIix7d3JpdGFibGU6ITEsdmFsdWU6Yn0pO2Iub25jbG9zZV8oYSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsaC5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5vbmNsb3NlLGMuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5vbmNsb3NlKCkgZmFpbGVkLlwiKX0pfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9ubWVzc2FnZVwiLHtnZXQ6ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X29ubWVzc2FnZSgpIGNhbGxlZC5cIik7cmV0dXJuIHRoaXMub25tZXNzYWdlX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbm1lc3NhZ2UoKSBjYWxsZWQuXCIpO3RoaXMub25tZXNzYWdlXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9ubWVzc2FnZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLGgubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3Qub25tZXNzYWdlKTtjLnRoZW4oZnVuY3Rpb24oYSl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5vbm1lc3NhZ2UgY2FsbGJhY2sgcmVjZWl2ZWQhISFcIik7dmFyIGM9Yi5wYXJhbTAoYSk7YT1uZXcgRXZlbnQoXCJvbm1lc3NhZ2VcIik7Yy5iaW5hcnk/YS5kYXRhPWMuZGF0YV9hYjooYz1hdG9iKGMuZGF0YV9zeiksYS5kYXRhPWMpO2Iub25tZXNzYWdlXyhhKX0pO3JldHVybiBiLnJlbW90ZUludm9rZSghMCxoLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90Lm9ubWVzc2FnZSxjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbm1lc3NhZ2UoKSBmYWlsZWQuXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuY2xvc2U9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jbG9zZSgpIGNhbGxlZC5cIik7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJSVENEYXRhQ2hhbm5lbC5jbG9zZVwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGEucmVtb3RlSW52b2tlKCExLFxyXG5oLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90LmNsb3NlKX0pLnRoZW4oZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY2xvc2U6IHN1Y2Nlc3MuXCIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jbG9zZTogZmFpbGVkLlwiKX0pfTtiLnByb3RvdHlwZS50b0J5dGVBcnJheT1mdW5jdGlvbihhKXt2YXIgYj1bXTthPW5ldyBVaW50OEFycmF5KGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9hOmEuYnVmZmVyKTtmb3IodmFyIGQgaW4gYSliLnB1c2goYVtkXSk7cmV0dXJuIGJ9O2IucHJvdG90eXBlLnNlbmQ9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2VuZCgpIGNhbGxlZC5cIik7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJSVENEYXRhQ2hhbm5lbC5zZW5kXCIpLnRoZW4oZnVuY3Rpb24oKXtpZihcInN0cmluZ1wiPT09dHlwZW9mIGEpcmV0dXJuIGQubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCJkYXRhKHN0cmluZyk6IFwiK2EpLGIucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3Quc2VuZF90ZXh0LGEpO2lmKGEgaW5zdGFuY2VvZiBCbG9iKWEuYXJyYXlCdWZmZXIoKS50aGVuKGZ1bmN0aW9uKGEpe2E9Yi50b0J5dGVBcnJheShhKTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5zZW5kX2JpbmFyeSxhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYXJyYXlCdWZmZXIoKTogZmFpbGVkLlwiKX0pO2Vsc2V7dmFyIGM9Yi50b0J5dGVBcnJheShhKTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdC5zZW5kX2JpbmFyeSxjKX19KS50aGVuKGZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLnNlbmQ6IHN1Y2Nlc3MuXCIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuc2VuZDogZmFpbGVkLlwiKX0pfTtiLnByb3RvdHlwZS50b1JUQ0RhdGFDaGFubmVsU3RhdGU9ZnVuY3Rpb24oYSl7dmFyIGI9XCJjbG9zZWRcIjthPT1uLmNvbm5lY3Rpbmc/Yj1cImNvbm5lY3RpbmdcIjphPT1uLm9wZW4/Yj1cIm9wZW5cIjphPT1uLmNsb3Npbmc/Yj1cImNsb3NpbmdcIjphPT1uLmNsb3NlZCYmKGI9XCJjbG9zZWRcIik7cmV0dXJuIGJ9O3JldHVybiBifShsLlByb3h5T2JqZWN0KTthLlJ0Y0RhdGFDaGFubmVsPWJ9LDQ4NDpmdW5jdGlvbihiLGEsYyl7dmFyIGU9dGhpcyYmdGhpcy5fX2V4dGVuZHN8fGZ1bmN0aW9uKCl7dmFyIGE9ZnVuY3Rpb24oYixkKXthPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihhLGIpe2EuX19wcm90b19fPWJ9fHxmdW5jdGlvbihhLGIpe2Zvcih2YXIgZCBpbiBiKWIuaGFzT3duUHJvcGVydHkoZCkmJihhW2RdPWJbZF0pfTtyZXR1cm4gYShiLGQpfTtyZXR1cm4gZnVuY3Rpb24oYixkKXtmdW5jdGlvbiBjKCl7dGhpcy5jb25zdHJ1Y3Rvcj1cclxuYn1hKGIsZCk7Yi5wcm90b3R5cGU9bnVsbD09PWQ/T2JqZWN0LmNyZWF0ZShkKTooYy5wcm90b3R5cGU9ZC5wcm90b3R5cGUsbmV3IGMpfX0oKTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTthLlJ0Y1J0cFJlY2VpdmVQYXJhbWV0ZXJzPWEuUnRjUnRwU2VuZFBhcmFtZXRlcnM9YS5SdGNSdHBFbmNvZGluZ1BhcmFtZXRlcnM9YS5SdGNSdHBQYXJhbWV0ZXJzPWEuUnRjUnRjcFBhcmFtZXRlcnM9YS5SdGNSdHBIZWFkZXJFeHRlbnNpb25QYXJhbWV0ZXJzPWEuUnRjUnRwQ29kZWNQYXJhbWV0ZXJzPXZvaWQgMDt2YXIgbD1jKDg1MSksaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt9YS5kZWZSdGNSdHBDb2RlY1BhcmFtZXRlcnM9ZnVuY3Rpb24oKXtyZXR1cm57bWltZVR5cGU6XCJcIixwYXlsb2FkVHlwZTowLHNkcEZtdHBMaW5lOlwiXCJ9fTthLmRlZlJUQ1J0cENvZGVjUGFyYW1ldGVycz1mdW5jdGlvbigpe3JldHVybntjbG9ja1JhdGU6MCxtaW1lVHlwZTpcIlwiLFxyXG5wYXlsb2FkVHlwZTowfX07YS50b1J0Y1J0cENvZGVjUGFyYW1ldGVycz1mdW5jdGlvbihiKXt2YXIgZD1hLmRlZlJ0Y1J0cENvZGVjUGFyYW1ldGVycygpO2ImJihiLmNoYW5uZWxzJiYoZC5jaGFubmVscz1iLmNoYW5uZWxzKSxiLmNsb2NrUmF0ZSYmKGQuY2xvY2tSYXRlPWIuY2xvY2tSYXRlKSxiLm1pbWVUeXBlJiYoZC5taW1lVHlwZT1iLm1pbWVUeXBlKSxiLnBheWxvYWRUeXBlJiYoZC5wYXlsb2FkVHlwZT1iLnBheWxvYWRUeXBlKSxiLnNkcEZtdHBMaW5lJiYoZC5zZHBGbXRwTGluZT1iLnNkcEZtdHBMaW5lKSk7cmV0dXJuIGR9O2EudG9SVENSdHBDb2RlY1BhcmFtZXRlcnM9ZnVuY3Rpb24oYil7dmFyIGQ9YS5kZWZSVENSdHBDb2RlY1BhcmFtZXRlcnMoKTtiJiYoYi5jaGFubmVscyYmKGQuY2hhbm5lbHM9Yi5jaGFubmVscyksYi5jbG9ja1JhdGUmJihkLmNsb2NrUmF0ZT1iLmNsb2NrUmF0ZSksYi5taW1lVHlwZSYmKGQubWltZVR5cGU9Yi5taW1lVHlwZSksYi5wYXlsb2FkVHlwZSYmXHJcbihkLnBheWxvYWRUeXBlPWIucGF5bG9hZFR5cGUpLGIuc2RwRm10cExpbmUmJihkLnNkcEZtdHBMaW5lPWIuc2RwRm10cExpbmUpKTtyZXR1cm4gZH07cmV0dXJuIGF9KCk7YS5SdGNSdHBDb2RlY1BhcmFtZXRlcnM9aDt2YXIgZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt9YS5kZWZSdGNSdHBIZWFkZXJFeHRlbnNpb25QYXJhbWV0ZXJzPWZ1bmN0aW9uKCl7cmV0dXJue2VuY3J5cHRlZDohMSxpZDowLHVyaTpcIlwifX07YS5kZWZSVENSdHBIZWFkZXJFeHRlbnNpb25QYXJhbWV0ZXJzPWZ1bmN0aW9uKCl7cmV0dXJue2lkOjAsdXJpOlwiXCJ9fTthLnRvUnRjUnRwSGVhZGVyRXh0ZW5zaW9uUGFyYW1ldGVycz1mdW5jdGlvbihiKXt2YXIgZD1hLmRlZlJ0Y1J0cEhlYWRlckV4dGVuc2lvblBhcmFtZXRlcnMoKTtpZihiKXt2YXIgYz1iLmVuY3J5cHRlZDt2b2lkIDAhPWMmJm51bGwhPWMmJihkLmVuY3J5cHRlZD1jKTtiLmlkJiYoZC5pZD1iLmlkKTtiLnVyaSYmKGQudXJpPWIudXJpKX1yZXR1cm4gZH07XHJcbmEudG9SVENSdHBIZWFkZXJFeHRlbnNpb25QYXJhbWV0ZXJzPWZ1bmN0aW9uKGIpe3ZhciBkPWEuZGVmUlRDUnRwSGVhZGVyRXh0ZW5zaW9uUGFyYW1ldGVycygpO2lmKGIpe3ZhciBjPWIuZW5jcnlwdGVkO3ZvaWQgMCE9YyYmbnVsbCE9YyYmKGQuZW5jcnlwdGVkPWMpO2IuaWQmJihkLmlkPWIuaWQpO2IudXJpJiYoZC51cmk9Yi51cmkpfXJldHVybiBkfTtyZXR1cm4gYX0oKTthLlJ0Y1J0cEhlYWRlckV4dGVuc2lvblBhcmFtZXRlcnM9ZDt2YXIgdz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt9YS5kZWZSdGNSdGNwUGFyYW1ldGVycz1mdW5jdGlvbigpe3JldHVybntjbmFtZTpcIlwiLHJlZHVjZWRTaXplOiExfX07YS5kZWZSVENSdGNwUGFyYW1ldGVycz1mdW5jdGlvbigpe3JldHVybnt9fTthLnRvUnRjUnRjcFBhcmFtZXRlcnM9ZnVuY3Rpb24oYil7dmFyIGQ9YS5kZWZSdGNSdGNwUGFyYW1ldGVycygpO2ImJihiLmNuYW1lJiYoZC5jbmFtZT1iLmNuYW1lKSxiPWIucmVkdWNlZFNpemUsXHJcbnZvaWQgMCE9YiYmbnVsbCE9YiYmKGQucmVkdWNlZFNpemU9YikpO3JldHVybiBkfTthLnRvUlRDUnRjcFBhcmFtZXRlcnM9ZnVuY3Rpb24oYil7dmFyIGQ9YS5kZWZSVENSdGNwUGFyYW1ldGVycygpO2ImJihiLmNuYW1lJiYoZC5jbmFtZT1iLmNuYW1lKSxiPWIucmVkdWNlZFNpemUsdm9pZCAwIT1iJiZudWxsIT1iJiYoZC5yZWR1Y2VkU2l6ZT1iKSk7cmV0dXJuIGR9O3JldHVybiBhfSgpO2EuUnRjUnRjcFBhcmFtZXRlcnM9dzt2YXIgcT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt9YS5kZWZSdGNSdHBQYXJhbWV0ZXJzPWZ1bmN0aW9uKCl7cmV0dXJue2NvZGVjczpbXSxoZWFkZXJFeHRlbnNpb25zOltdLHJ0Y3A6dy5kZWZSdGNSdGNwUGFyYW1ldGVycygpfX07YS5kZWZSVENSdHBQYXJhbWV0ZXJzPWZ1bmN0aW9uKCl7cmV0dXJue2NvZGVjczpbXSxoZWFkZXJFeHRlbnNpb25zOltdLHJ0Y3A6dy5kZWZSVENSdGNwUGFyYW1ldGVycygpfX07YS50b1J0Y1J0cFBhcmFtZXRlcnM9ZnVuY3Rpb24oYil7dmFyIGM9XHJcbmEuZGVmUnRjUnRwUGFyYW1ldGVycygpO2lmKGIpe2lmKGIuY29kZWNzKWZvcih2YXIgZz0wLGU9Yi5jb2RlY3M7ZzxlLmxlbmd0aDtnKyspYy5jb2RlY3MucHVzaChoLnRvUnRjUnRwQ29kZWNQYXJhbWV0ZXJzKGVbZ10pKTtpZihiLmhlYWRlckV4dGVuc2lvbnMpZm9yKGc9MCxlPWIuaGVhZGVyRXh0ZW5zaW9ucztnPGUubGVuZ3RoO2crKyljLmhlYWRlckV4dGVuc2lvbnMucHVzaChkLnRvUnRjUnRwSGVhZGVyRXh0ZW5zaW9uUGFyYW1ldGVycyhlW2ddKSk7Yi5ydGNwJiYoYy5ydGNwPXcudG9SdGNSdGNwUGFyYW1ldGVycyhiLnJ0Y3ApKX1yZXR1cm4gY307YS50b1JUQ1J0cFBhcmFtZXRlcnM9ZnVuY3Rpb24oYil7dmFyIGM9YS5kZWZSVENSdHBQYXJhbWV0ZXJzKCk7aWYoYil7aWYoYi5jb2RlY3MpZm9yKHZhciBlPTAsbj1iLmNvZGVjcztlPG4ubGVuZ3RoO2UrKyljLmNvZGVjcy5wdXNoKGgudG9SVENSdHBDb2RlY1BhcmFtZXRlcnMobltlXSkpO2lmKGIuaGVhZGVyRXh0ZW5zaW9ucylmb3IoZT1cclxuMCxuPWIuaGVhZGVyRXh0ZW5zaW9ucztlPG4ubGVuZ3RoO2UrKyljLmhlYWRlckV4dGVuc2lvbnMucHVzaChkLnRvUlRDUnRwSGVhZGVyRXh0ZW5zaW9uUGFyYW1ldGVycyhuW2VdKSk7Yi5ydGNwJiYoYy5ydGNwPXcudG9SdGNSdGNwUGFyYW1ldGVycyhiLnJ0Y3ApKX1yZXR1cm4gY307cmV0dXJuIGF9KCk7YS5SdGNSdHBQYXJhbWV0ZXJzPXE7dmFyIG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7fWEuZGVmUnRjUnRwRW5jb2RpbmdQYXJhbWV0ZXJzPWZ1bmN0aW9uKCl7cmV0dXJue2FjdGl2ZTohMCxyaWQ6XCJcIn19O2EuZGVmUlRDUnRwRW5jb2RpbmdQYXJhbWV0ZXJzPWZ1bmN0aW9uKCl7cmV0dXJue319O2EudG9SdGNSdHBFbmNvZGluZ1BhcmFtZXRlcnM9ZnVuY3Rpb24oYil7dmFyIGQ9YS5kZWZSdGNSdHBFbmNvZGluZ1BhcmFtZXRlcnMoKTtpZihiKXt2YXIgYz1iLmFjdGl2ZTt2b2lkIDAhPWMmJm51bGwhPWMmJihkLmFjdGl2ZT1jKTtiLm1heEJpdHJhdGUmJihkLm1heEJpdHJhdGU9XHJcbmIubWF4Qml0cmF0ZSk7Yi5tYXhGcmFtZXJhdGUmJihkLm1heEZyYW1lcmF0ZT1iLm1heEZyYW1lcmF0ZSk7Yi5zY2FsZVJlc29sdXRpb25Eb3duQnkmJihkLnNjYWxlUmVzb2x1dGlvbkRvd25CeT1iLnNjYWxlUmVzb2x1dGlvbkRvd25CeSk7Yi5yaWQmJihkLnJpZD1iLnJpZCk7Yi5uZXR3b3JrUHJpb3JpdHkmJihkLm5ldHdvcmtQcmlvcml0eT1iLm5ldHdvcmtQcmlvcml0eSl9cmV0dXJuIGR9O2EudG9SVENSdHBFbmNvZGluZ1BhcmFtZXRlcnM9ZnVuY3Rpb24oYil7dmFyIGQ9YS5kZWZSVENSdHBFbmNvZGluZ1BhcmFtZXRlcnMoKTtpZihiKXt2YXIgYz1iLmFjdGl2ZTt2b2lkIDAhPWMmJm51bGwhPWMmJihkLmFjdGl2ZT1jKTtiLm1heEJpdHJhdGUmJihkLm1heEJpdHJhdGU9Yi5tYXhCaXRyYXRlKTtiLm1heEZyYW1lcmF0ZSYmKGQubWF4RnJhbWVyYXRlPWIubWF4RnJhbWVyYXRlKTtiLnNjYWxlUmVzb2x1dGlvbkRvd25CeSYmKGQuc2NhbGVSZXNvbHV0aW9uRG93bkJ5PWIuc2NhbGVSZXNvbHV0aW9uRG93bkJ5KTtcclxuYi5yaWQmJihkLnJpZD1iLnJpZCk7Yi5uZXR3b3JrUHJpb3JpdHkmJihkLm5ldHdvcmtQcmlvcml0eT1iLm5ldHdvcmtQcmlvcml0eSl9cmV0dXJuIGR9O3JldHVybiBhfSgpO2EuUnRjUnRwRW5jb2RpbmdQYXJhbWV0ZXJzPW47Yj1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7cmV0dXJuIG51bGwhPT1hJiZhLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpc31lKGIsYSk7Yi5kZWZSdGNSdHBTZW5kUGFyYW1ldGVycz1mdW5jdGlvbigpe3ZhciBhPXEuZGVmUnRjUnRwUGFyYW1ldGVycygpO2EuZW5jb2RpbmdzPVtdO2EudHJhbnNhY3Rpb25faWQ9XCJcIjtyZXR1cm4gYX07Yi5kZWZSVENSdHBTZW5kUGFyYW1ldGVycz1mdW5jdGlvbigpe3ZhciBhPXEuZGVmUlRDUnRwUGFyYW1ldGVycygpO2EuZW5jb2RpbmdzPVtdO2EudHJhbnNhY3Rpb25JZD1cIlwiO3JldHVybiBhfTtiLnRvUnRjUnRwU2VuZFBhcmFtZXRlcnM9ZnVuY3Rpb24oYSl7bC5sb2dnZXIubG9nKFwiUnRjUnRwU2VuZFBhcmFtZXRlcnMudG9SdGNSdHBTZW5kUGFyYW1ldGVycygpIGluIHBhcmFtOlwiK1xyXG5KU09OLnN0cmluZ2lmeShhKSk7dmFyIGQ9Yi5kZWZSdGNSdHBTZW5kUGFyYW1ldGVycygpLGM9cS50b1J0Y1J0cFBhcmFtZXRlcnMoYSk7Yy5jb2RlY3MuZm9yRWFjaChmdW5jdGlvbihhKXtyZXR1cm4gZC5jb2RlY3MucHVzaChhKX0pO2MuaGVhZGVyRXh0ZW5zaW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGEpe3JldHVybiBkLmhlYWRlckV4dGVuc2lvbnMucHVzaChhKX0pO2QucnRjcD1jLnJ0Y3A7aWYoYSl7aWYoYS5lbmNvZGluZ3MpZm9yKHZhciBjPTAsZT1hLmVuY29kaW5ncztjPGUubGVuZ3RoO2MrKylkLmVuY29kaW5ncy5wdXNoKG4udG9SdGNSdHBFbmNvZGluZ1BhcmFtZXRlcnMoZVtjXSkpO2EudHJhbnNhY3Rpb25JZCYmKGQudHJhbnNhY3Rpb25faWQ9YS50cmFuc2FjdGlvbklkKX1sLmxvZ2dlci5sb2coXCJSdGNSdHBTZW5kUGFyYW1ldGVycy50b1J0Y1J0cFNlbmRQYXJhbWV0ZXJzKCkgb3V0IHBhcmFtOlwiK0pTT04uc3RyaW5naWZ5KGQpKTtyZXR1cm4gZH07Yi50b1JUQ1J0cFNlbmRQYXJhbWV0ZXJzPVxyXG5mdW5jdGlvbihhKXtsLmxvZ2dlci5sb2coXCJSdGNSdHBTZW5kUGFyYW1ldGVycy50b1JUQ1J0cFNlbmRQYXJhbWV0ZXJzKCkgaW4gcGFyYW06XCIrSlNPTi5zdHJpbmdpZnkoYSkpO3ZhciBkPWIuZGVmUlRDUnRwU2VuZFBhcmFtZXRlcnMoKSxjPXEudG9SVENSdHBQYXJhbWV0ZXJzKGEpO2MuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oYSl7cmV0dXJuIGQuY29kZWNzLnB1c2goYSl9KTtjLmhlYWRlckV4dGVuc2lvbnMuZm9yRWFjaChmdW5jdGlvbihhKXtyZXR1cm4gZC5oZWFkZXJFeHRlbnNpb25zLnB1c2goYSl9KTtkLnJ0Y3A9Yy5ydGNwO2lmKGEpe2lmKGEuZW5jb2RpbmdzKWZvcih2YXIgYz0wLGU9YS5lbmNvZGluZ3M7YzxlLmxlbmd0aDtjKyspZC5lbmNvZGluZ3MucHVzaChuLnRvUlRDUnRwRW5jb2RpbmdQYXJhbWV0ZXJzKGVbY10pKTthLnRyYW5zYWN0aW9uX2lkJiYoZC50cmFuc2FjdGlvbklkPWEudHJhbnNhY3Rpb25faWQpfWwubG9nZ2VyLmxvZyhcIlJ0Y1J0cFNlbmRQYXJhbWV0ZXJzLnRvUlRDUnRwU2VuZFBhcmFtZXRlcnMoKSBvdXQgcGFyYW06XCIrXHJcbkpTT04uc3RyaW5naWZ5KGQpKTtyZXR1cm4gZH07cmV0dXJuIGJ9KHEpO2EuUnRjUnRwU2VuZFBhcmFtZXRlcnM9YjtiPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXtyZXR1cm4gbnVsbCE9PWEmJmEuYXBwbHkodGhpcyxhcmd1bWVudHMpfHx0aGlzfWUoYixhKTtiLmRlZlJ0Y1J0cFJlY2VpdmVQYXJhbWV0ZXJzPWZ1bmN0aW9uKCl7cmV0dXJuIHEuZGVmUnRjUnRwUGFyYW1ldGVycygpfTtiLmRlZlJUQ1J0cFJlY2VpdmVQYXJhbWV0ZXJzPWZ1bmN0aW9uKCl7cmV0dXJuIHEuZGVmUlRDUnRwUGFyYW1ldGVycygpfTtiLnRvUnRjUnRwUmVjZWl2ZVBhcmFtZXRlcnM9ZnVuY3Rpb24oYSl7bC5sb2dnZXIubG9nKFwiUnRjUnRwUmVjZWl2ZVBhcmFtZXRlcnMudG9SdGNSdHBSZWNlaXZlUGFyYW1ldGVycygpIGluIHBhcmFtOlwiK0pTT04uc3RyaW5naWZ5KGEpKTthPXEudG9SdGNSdHBQYXJhbWV0ZXJzKGEpO2wubG9nZ2VyLmxvZyhcIlJ0Y1J0cFJlY2VpdmVQYXJhbWV0ZXJzLnRvUnRjUnRwUmVjZWl2ZVBhcmFtZXRlcnMoKSBvdXQgcGFyYW06XCIrXHJcbkpTT04uc3RyaW5naWZ5KGEpKTtyZXR1cm4gYX07Yi50b1JUQ1J0cFJlY2VpdmVQYXJhbWV0ZXJzPWZ1bmN0aW9uKGEpe2wubG9nZ2VyLmxvZyhcIlJ0Y1J0cFJlY2VpdmVQYXJhbWV0ZXJzLnRvUlRDUnRwUmVjZWl2ZVBhcmFtZXRlcnMoKSBpbiBwYXJhbTpcIitKU09OLnN0cmluZ2lmeShhKSk7YT1xLnRvUlRDUnRwUGFyYW1ldGVycyhhKTtsLmxvZ2dlci5sb2coXCJSdGNSdHBSZWNlaXZlUGFyYW1ldGVycy50b1JUQ1J0cFJlY2VpdmVQYXJhbWV0ZXJzKCkgb3V0IHBhcmFtOlwiK0pTT04uc3RyaW5naWZ5KGEpKTtyZXR1cm4gYX07cmV0dXJuIGJ9KHEpO2EuUnRjUnRwUmVjZWl2ZVBhcmFtZXRlcnM9Yn0sNTg5OmZ1bmN0aW9uKGIsYSxjKXt2YXIgZT10aGlzJiZ0aGlzLl9fZXh0ZW5kc3x8ZnVuY3Rpb24oKXt2YXIgYT1mdW5jdGlvbihiLGQpe2E9T2JqZWN0LnNldFByb3RvdHlwZU9mfHx7X19wcm90b19fOltdfWluc3RhbmNlb2YgQXJyYXkmJmZ1bmN0aW9uKGEsYil7YS5fX3Byb3RvX189XHJcbmJ9fHxmdW5jdGlvbihhLGIpe2Zvcih2YXIgZCBpbiBiKWIuaGFzT3duUHJvcGVydHkoZCkmJihhW2RdPWJbZF0pfTtyZXR1cm4gYShiLGQpfTtyZXR1cm4gZnVuY3Rpb24oYixkKXtmdW5jdGlvbiBjKCl7dGhpcy5jb25zdHJ1Y3Rvcj1ifWEoYixkKTtiLnByb3RvdHlwZT1udWxsPT09ZD9PYmplY3QuY3JlYXRlKGQpOihjLnByb3RvdHlwZT1kLnByb3RvdHlwZSxuZXcgYyl9fSgpO09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO2EuUnRwUmVjZWl2ZXI9YS5SdHBTZW5kZXI9YS5SdHBTZW5kZXJSZWNlaXZlcj1hLkR0bHNUcmFuc3BvcnQ9YS5JY2VUcmFuc3BvcnQ9YS5EdG1mU2VuZGVyPWEuRFRNRlRvbmVDaGFuZ2VFdmVudD12b2lkIDA7dmFyIGw9Yyg2NTgpLGg9Yyg1NTApLGQ9Yyg4NTEpLHc9YygxNDQpLHE9Yyg1MTcpLG49Yyg2NTApLGs9Yyg0ODQpLHY9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjLGUpe3ZhciBnPWEuY2FsbCh0aGlzLGMsXHJcbmguY2xhc3NfaWRfdC5SVENEVE1GVG9uZUNoYW5nZUV2ZW50LGUsbC5Qcm94eU1vZGUuUmVtb3RlKXx8dGhpcztkLmxvZ2dlci5sb2coZy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY29uc3RydWN0b3JcIik7cmV0dXJuIGd9ZShiLGEpO2IucHJvdG90eXBlLnN5bmNCYXJyaWVyPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2Euc3luY0JhcnJpZXJEZWVwKGIsYykmJmEud2FpdFVudGlsQ29ubmVjdGVkKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyXCIpLnRoZW4oZnVuY3Rpb24oKXtQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDRFRNRlRvbmVDaGFuZ2VFdmVudF90LnRvbmUsXCJcIiksYS5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDRFRNRlRvbmVDaGFuZ2VFdmVudF90LnRvbmVfYnVmZmVyLFxyXG5cIlwiKV0pLnRoZW4oZnVuY3Rpb24oYil7ZC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyKCk6IHN1Y2Nlc3MuXCIpO2I9Yi5tYXAoZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyYW0wKGIpfSk7YS50b25lPWJbMF07YS50b25lX2J1ZmZlcl89YlsxXTthLnN5bmNCYXJyaWVyUmVzb2x2ZShhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7Yj1hLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIucHJvcC5zeW5jQmFycmllcigpIGZhaWxlZC5cIik7YS5zeW5jQmFycmllclJlamVjdChiKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtiPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5zeW5jQmFycmllcigpIGZhaWxlZC5cIik7YS5zeW5jQmFycmllclJlamVjdChiKX0pfSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInRvbmVfYnVmZmVyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRvbmVfYnVmZmVyX30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtcclxucmV0dXJuIGJ9KGwuUHJveHlPYmplY3QpO2EuRFRNRlRvbmVDaGFuZ2VFdmVudD12O3ZhciBwPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYyxlKXt2YXIgZz1hLmNhbGwodGhpcyxjLGguY2xhc3NfaWRfdC5SVENEVE1GU2VuZGVyLGUsbC5Qcm94eU1vZGUuUmVtb3RlKXx8dGhpcztkLmxvZ2dlci5sb2coZy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY29uc3RydWN0b3JcIik7Zy5jYW5JbnNlcnREVE1GPSEwO2cudG9uZUJ1ZmZlcl89XCJcIjtyZXR1cm4gZ31lKGIsYSk7Yi5wcm90b3R5cGUuaW5zZXJ0RFRNRj1mdW5jdGlvbihhLGIsYyl7dmFyIGU9dGhpczt2b2lkIDA9PT1iJiYoYj0xMDApO3ZvaWQgMD09PWMmJihjPTcwKTtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuaW5zZXJ0RFRNRigpIGNhbGxlZCwgdG9uZXM6IFwiK2EpO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiRHRtZlNlbmRlci5pbnNlcnREVE1GXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gZS5yZW1vdGVJbnZva2UoITEsXHJcbmgubWV0aG9kX2lkX1JUQ0RUTUZTZW5kZXJfdC5pbnNlcnREVE1GLGEsYixjKX0pLnRoZW4oZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2coZS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuaW5zZXJ0RFRNRigpIHN1Y2Nlc3MsIHRvbmVzOiBcIithKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7ZS5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLmluc2VydERUTUYoKSBmYWlsZWQhXCIpfSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9udG9uZWNoYW5nZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbnRvbmVjaGFuZ2VffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29udG9uZWNoYW5nZSgpIGNhbGxlZC5cIik7dGhpcy5vbnRvbmVjaGFuZ2VfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJEdG1mU2VuZGVyLm9udG9uZWNoYW5nZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxcclxuYi5pc051bGxDYWxsYmFjayhhKSxoLm1ldGhvZF9pZF9SVENEVE1GU2VuZGVyX3Qub250b25lY2hhbmdlKTtjLnRoZW4oZnVuY3Rpb24oYSl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9udG9uZWNoYW5nZSBjYWxsYmFjayByZWNlaXZlZCFcIik7KG5ldyB2KGIsYi5wYXJhbTAoYSkub2lkKSkuc3luY0JhcnJpZXIoKS50aGVuKGZ1bmN0aW9uKGEpe2QubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcInRvbmU6IFwiK2EudG9uZStcIiB0b25lX2J1ZmZlcjogXCIrYS50b25lX2J1ZmZlcik7Yi50b25lQnVmZmVyXz1hLnRvbmVfYnVmZmVyO2Iub250b25lY2hhbmdlXyhhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnRvbmVFdnQuc3luY0JhcnJpZXIoKSBmYWlsZWQhXCIpfSl9KTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsaC5tZXRob2RfaWRfUlRDRFRNRlNlbmRlcl90Lm9udG9uZWNoYW5nZSxjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXHJcblwiLnNldF9vbnRvbmVjaGFuZ2UoKSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwidG9uZUJ1ZmZlclwiLHtnZXQ6ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIudG9uZUJ1ZmZlcigpIGNhbGxlZC5cIik7cmV0dXJuIHRoaXMudG9uZUJ1ZmZlcl99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7cmV0dXJuIGJ9KGwuUHJveHlPYmplY3QpO2EuRHRtZlNlbmRlcj1wO3ZhciBnPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYyxlKXt2YXIgZz1hLmNhbGwodGhpcyxjLGguY2xhc3NfaWRfdC5SVENJY2VUcmFuc3BvcnQsZSxsLlByb3h5TW9kZS5SZW1vdGUpfHx0aGlzO2QubG9nZ2VyLmxvZyhnLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jb25zdHJ1Y3RvclwiKTtnLnNlbGVjdGVkUGFpcj1udWxsO2cubG9jYWxDYW5kaWRhdGVzXz1bXTtnLnJlbW90ZUNhbmRpZGF0ZXNfPVxyXG5bXTtyZXR1cm4gZ31lKGIsYSk7Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllcigpIGNhbGxlZC5cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsZSl7YS5zeW5jQmFycmllckRlZXAoYyxlKSYmYS53YWl0VW50aWxDb25uZWN0ZWQoXCJJY2VUcmFuc3BvcnQuc3luY0JhcnJpZXJcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDSWNlVHJhbnNwb3J0X3Qucm9sZSwwKSxhLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENJY2VUcmFuc3BvcnRfdC5jb21wb25lbnQsMCksYS5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDSWNlVHJhbnNwb3J0X3Quc3RhdGUsMCksYS5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDSWNlVHJhbnNwb3J0X3QuZ2F0aGVyaW5nU3RhdGUsXHJcbjApXSl9KS50aGVuKGZ1bmN0aW9uKGMpe2QubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllciBzdWNjZXNzLlwiKTt2YXIgZT0wLGc9MDtjPWMubWFwKGZ1bmN0aW9uKGIpe3JldHVybiBhLnBhcmFtMChiKX0pO2Eucm9sZV89Y1swXTthLmNvbXBvbmVudF89Y1sxXTtlPWNbMl07Zz1jWzNdO2Euc3RhdGVfPWIuY29udmVydFN0YXRlKGUpO2EuZ2F0aGVyaW5nU3RhdGVfPWIuY29udmVydEdhdGhlcmluZ1N0YXRlKGcpO2Euc3luY0JhcnJpZXJSZXNvbHZlKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtiPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5zeW5jQmFycmllcigpIGZhaWxlZCFcIik7YS5zeW5jQmFycmllclJlamVjdChiKX0pfSl9O2IucHJvdG90eXBlLnN5bmNDYW5kaWRhdGVzPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0NhbmRpZGF0ZXMoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLFxyXG5jKXthLndhaXRVbnRpbENvbm5lY3RlZChcIkljZVRyYW5zcG9ydC5zeW5jQ2FuZGlkYXRlc1wiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFthLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENJY2VUcmFuc3BvcnRfdC5sb2NhbGNhbmRpZGF0ZXMsW10pLGEucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1JUQ0ljZVRyYW5zcG9ydF90LnJlbW90ZWNhbmRpZGF0ZXMsW10pXSl9KS50aGVuKGZ1bmN0aW9uKGMpe2QubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQ2FuZGlkYXRlcyBzdWNjZXNzLlwiKTtjPWMubWFwKGZ1bmN0aW9uKGIpe3JldHVybiBhLnBhcmFtMChiKX0pO2EubG9jYWxDYW5kaWRhdGVzXz1jWzBdO2EucmVtb3RlQ2FuZGlkYXRlc189Y1sxXTtiKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtiPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5zeW5jQ2FuZGlkYXRlcygpIGZhaWxlZCFcIik7YyhiKX0pfSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcclxuXCJyb2xlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJvbGVffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImNvbXBvbmVudFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb21wb25lbnRffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIlN0YXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXRlX30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJnYXRoZXJpbmdTdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nYXRoZXJpbmdTdGF0ZV99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25zdGF0ZWNoYW5nZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbnN0YXRlY2hhbmdlX30sXHJcbnNldDpmdW5jdGlvbihhKXt2YXIgYz10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfb25zdGF0ZWNoYW5nZSgpIGNhbGxlZC5cIik7dGhpcy5vbnN0YXRlY2hhbmdlXz1hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiSWNlVHJhbnNwb3J0Lm9uc3RhdGVjaGFuZ2VcIikudGhlbihmdW5jdGlvbigpe3ZhciBlPWMucmVnaXN0ZXJDYWxsYmFja3MoITEsYy5pc051bGxDYWxsYmFjayhhKSxoLm1ldGhvZF9pZF9SVENJY2VUcmFuc3BvcnRfdC5vbnN0YXRlY2hhbmdlKTtlLnRoZW4oZnVuY3Rpb24oYSl7ZC5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uc3RhdGVjaGFuZ2UgY2FsbGJhY2sgcmVjZWl2ZWQhXCIpO2Muc3luY0NhbmRpZGF0ZXMoKS50aGVuKGZ1bmN0aW9uKGEpe2QubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcInJlY2VpdmVkIHVwZGF0ZWQgaWNlIGNhbmRpZGF0ZXMhXCIpfSk7Yy5zdGF0ZV89Yi5jb252ZXJ0U3RhdGUoYy5wYXJhbTAoYSkpO1xyXG5kLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCJzdGF0ZTogXCIrYy5zdGF0ZV8pO2Mub25zdGF0ZWNoYW5nZV8oKX0pO3JldHVybiBjLnJlbW90ZUludm9rZSghMCxoLm1ldGhvZF9pZF9SVENJY2VUcmFuc3BvcnRfdC5vbnN0YXRlY2hhbmdlLGUuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2MubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfb25zdGF0ZWNoYW5nZSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25nYXRoZXJpbmdzdGF0ZWNoYW5nZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbmdhdGhlcmluZ3N0YXRlY2hhbmdlX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXM7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbmdhdGhlcmluZ3N0YXRlY2hhbmdlKCkgY2FsbGVkLlwiKTt0aGlzLm9uZ2F0aGVyaW5nc3RhdGVjaGFuZ2VfPVxyXG5hO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiSWNlVHJhbnNwb3J0Lm9uZ2F0aGVyaW5nc3RhdGVjaGFuZ2VcIikudGhlbihmdW5jdGlvbigpe3ZhciBlPWMucmVnaXN0ZXJDYWxsYmFja3MoITEsYy5pc051bGxDYWxsYmFjayhhKSxoLm1ldGhvZF9pZF9SVENJY2VUcmFuc3BvcnRfdC5vbmdhdGhlcmluZ3N0YXRlY2hhbmdlKTtlLnRoZW4oZnVuY3Rpb24oYSl7ZC5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uZ2F0aGVyaW5nc3RhdGVjaGFuZ2UgY2FsbGJhY2sgcmVjZWl2ZWQhXCIpO2Muc3luY0NhbmRpZGF0ZXMoKS50aGVuKGZ1bmN0aW9uKGEpe2QubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcInJlY2VpdmVkIHVwZGF0ZWQgaWNlIGNhbmRpZGF0ZXMhXCIpfSk7Yy5nYXRoZXJpbmdTdGF0ZV89Yi5jb252ZXJ0R2F0aGVyaW5nU3RhdGUoYy5wYXJhbTAoYSkpO2QubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcImdhdGhlcmluZ1N0YXRlOiBcIitjLmdhdGhlcmluZ1N0YXRlXyk7XHJcbmMub25nYXRoZXJpbmdzdGF0ZWNoYW5nZV8oKX0pO3JldHVybiBjLnJlbW90ZUludm9rZSghMCxoLm1ldGhvZF9pZF9SVENJY2VUcmFuc3BvcnRfdC5vbmdhdGhlcmluZ3N0YXRlY2hhbmdlLGUuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2MubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfb25nYXRoZXJpbmdzdGF0ZWNoYW5nZSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25zZWxlY3RlZGNhbmRpZGF0ZXBhaXJjaGFuZ2VcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub25zZWxlY3RlZGNhbmRpZGF0ZXBhaXJjaGFuZ2VffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uc2VsZWN0ZWRjYW5kaWRhdGVwYWlyY2hhbmdlKCkgY2FsbGVkLlwiKTt0aGlzLm9uc2VsZWN0ZWRjYW5kaWRhdGVwYWlyY2hhbmdlXz1cclxuYTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIkljZVRyYW5zcG9ydC5vbnNlbGVjdGVkY2FuZGlkYXRlcGFpcmNoYW5nZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9Yi5yZWdpc3RlckNhbGxiYWNrcyghMSxiLmlzTnVsbENhbGxiYWNrKGEpLGgubWV0aG9kX2lkX1JUQ0ljZVRyYW5zcG9ydF90Lm9uc2VsZWN0ZWRjYW5kaWRhdGVwYWlyY2hhbmdlKTtjLnRoZW4oZnVuY3Rpb24oYSl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uc2VsZWN0ZWRjYW5kaWRhdGVwYWlyY2hhbmdlIGNhbGxiYWNrIHJlY2VpdmVkIVwiKTtiLnN5bmNDYW5kaWRhdGVzKCkudGhlbihmdW5jdGlvbihhKXtkLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCJyZWNlaXZlZCB1cGRhdGVkIGljZSBjYW5kaWRhdGVzIVwiKX0pO2Iuc2VsZWN0ZWRQYWlyPWIucGFyYW0wKGEpO2QubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcInNlbGVjdGVkUGFpcjogXCIrYi5zZWxlY3RlZFBhaXIpO1xyXG5iLm9uc2VsZWN0ZWRjYW5kaWRhdGVwYWlyY2hhbmdlXygpfSk7cmV0dXJuIGIucmVtb3RlSW52b2tlKCEwLGgubWV0aG9kX2lkX1JUQ0ljZVRyYW5zcG9ydF90Lm9uc2VsZWN0ZWRjYW5kaWRhdGVwYWlyY2hhbmdlLGMuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfb25zZWxlY3RlZGNhbmRpZGF0ZXBhaXJjaGFuZ2UgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmdldExvY2FsQ2FuZGlkYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxvY2FsQ2FuZGlkYXRlc199O2IucHJvdG90eXBlLmdldFJlbW90ZUNhbmRpZGF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZW1vdGVDYW5kaWRhdGVzX307Yi5wcm90b3R5cGUuZ2V0TG9jYWxQYXJhbWV0ZXJzPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9O2IucHJvdG90eXBlLmdldFJlbW90ZVBhcmFtZXRlcnM9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH07XHJcbmIucHJvdG90eXBlLmdldFNlbGVjdGVkQ2FuZGlkYXRlUGFpcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNlbGVjdGVkUGFpcn07Yi5jb252ZXJ0U3RhdGU9ZnVuY3Rpb24oYSl7cmV0dXJuIDA9PWE/XCJuZXdcIjoxPT1hP1wiY2hlY2tpbmdcIjoyPT1hP1wiY29ubmVjdGVkXCI6Mz09YT9cImNvbXBsZXRlZFwiOjQ9PWE/XCJmYWlsZWRcIjo1PT1hP1wiZGlzY29ubmVjdGVkXCI6XCJjbG9zZWRcIn07Yi5jb252ZXJ0R2F0aGVyaW5nU3RhdGU9ZnVuY3Rpb24oYSl7cmV0dXJuIDA9PWE/XCJuZXdcIjoxPT1hP1wiZ2F0aGVyaW5nXCI6XCJjb21wbGV0ZVwifTtyZXR1cm4gYn0obC5Qcm94eU9iamVjdCk7YS5JY2VUcmFuc3BvcnQ9Zzt2YXIgQjsoZnVuY3Rpb24oYSl7YVthW1wibmV3XCJdPTBdPVwibmV3XCI7YVthLmNvbm5lY3Rpbmc9MV09XCJjb25uZWN0aW5nXCI7YVthLmNvbm5lY3RlZD0yXT1cImNvbm5lY3RlZFwiO2FbYS5jbG9zZWQ9M109XCJjbG9zZWRcIjthW2EuZmFpbGVkPTRdPVwiZmFpbGVkXCI7YVthLm1heD01XT1cIm1heFwifSkoQnx8XHJcbihCPXt9KSk7dmFyIHQ9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjLGUpe3ZhciBnPWEuY2FsbCh0aGlzLGMsaC5jbGFzc19pZF90LlJUQ0R0bHNUcmFuc3BvcnQsZSxsLlByb3h5TW9kZS5SZW1vdGUpfHx0aGlzO2QubG9nZ2VyLmxvZyhnLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jb25zdHJ1Y3RvclwiKTtnLnN0YXRlXz1cIm5ld1wiO2cudHJhbnNwb3J0Xz1udWxsO2cucmVtb3RlQ2VydGlmaWNhdGVzXz1bXTtyZXR1cm4gZ31lKGIsYSk7Yi5wcm90b3R5cGUuZHVtcEluZm89ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2coXCJEdGxzVHJhbnNwb3J0W1wiK3RoaXMub2JqZWN0X2lkKCkrXCJdLmR1bXBJbmZvKCk6XCIpO2QubG9nZ2VyLmxvZyhcIiAgICAtIHN0YXRlOlwiK3RoaXMuc3RhdGVfKTtkLmxvZ2dlci5sb2coXCIgICAgLSB0cmFuc3BvcnQ6XCIrdGhpcy50cmFuc3BvcnRfKX07Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuc3luY0JhcnJpZXIoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihjLGUpe2Euc3luY0JhcnJpZXJEZWVwKGMsZSkmJmEud2FpdFVudGlsQ29ubmVjdGVkKFwiRHRsc1RyYW5zcG9ydC5zeW5jQmFycmllclwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFthLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENEdGxzVHJhbnNwb3J0X3QudHJhbnNwb3J0LHt9KSxhLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENEdGxzVHJhbnNwb3J0X3Quc3RhdGUsMCksYS5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDRHRsc1RyYW5zcG9ydF90LmdldFJlbW90ZUNlcnRpZmljYXRlcyldKX0pLnRoZW4oZnVuY3Rpb24oYyl7dmFyIGU7ZC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyIHJlbW90ZSBzdWNjZXNzLlwiKTt2YXIgaDtlPWMubWFwKGZ1bmN0aW9uKGIpe3JldHVybiBhLnBhcmFtMChiKX0pO1xyXG5jPWVbMF07aD1lWzFdO2EucmVtb3RlQ2VydGlmaWNhdGVzXz1lWzJdO2Euc3RhdGVfPWIuY29udmVydFN0YXRlKGgpO2U9W107aWYodm9pZCAwIT1jJiYwPT1jLmlzX251bGwpe2g9YS50cmFuc3BvcnRfO2lmKG51bGw9PT1hLnRyYW5zcG9ydF98fGEudHJhbnNwb3J0Xy5vYmplY3RfaWQoKSE9Yy5vaWQpaD1uZXcgZyhhLGMub2lkKTtlLnB1c2goaC5zeW5jQmFycmllcigpKX1lbHNlIGUucHVzaChQcm9taXNlLnJlc29sdmUobnVsbCkpO1Byb21pc2UuYWxsKGUpLnRoZW4oZnVuY3Rpb24oYil7ZC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyIHN1Y2Nlc3NcIik7YS50cmFuc3BvcnRfPWJbMF07YS5zeW5jQmFycmllclJlc29sdmUoYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2I9YS5sb2dSZW1vdGVJbnZva2VFcnJvcihiLFwiLnByb3Auc3luY0JhcnJpZXIgZmFpbGVkIVwiKTthLnN5bmNCYXJyaWVyUmVqZWN0KGIpfSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2I9XHJcbmEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5zeW5jQmFycmllciBmYWlsZWQhXCIpO2Euc3luY0JhcnJpZXJSZWplY3QoYil9KX0pfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJ0cmFuc3BvcnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHJhbnNwb3J0X30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJzdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X3N0YXRlKCkgY2FsbGVkOiBcIit0aGlzLnN0YXRlXyk7cmV0dXJuIHRoaXMuc3RhdGVffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLmdldFJlbW90ZUNlcnRpZmljYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlbW90ZUNlcnRpZmljYXRlc199O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9uc3RhdGVjaGFuZ2VcIixcclxue2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9uc3RhdGVjaGFuZ2VffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uc3RhdGVjaGFuZ2UoKSBjYWxsZWQuXCIpO3RoaXMub25zdGF0ZWNoYW5nZV89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIkR0bHNUcmFuc3BvcnQub25zdGF0ZWNoYW5nZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGU9Yy5yZWdpc3RlckNhbGxiYWNrcyghMSxjLmlzTnVsbENhbGxiYWNrKGEpLGgubWV0aG9kX2lkX1JUQ0R0bHNUcmFuc3BvcnRfdC5vbnN0YXRlY2hhbmdlKTtlLnRoZW4oZnVuY3Rpb24oYSl7ZC5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uc3RhdGVjaGFuZ2UgY2FsbGJhY2sgcmVjZWl2ZWQhXCIpO2Muc3RhdGVfPWIuY29udmVydFN0YXRlKGMucGFyYW0wKGEpKTtkLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCJzdGF0ZV86IFwiK2Muc3RhdGVfKTtcclxuYy5vbnN0YXRlY2hhbmdlXygpfSk7cmV0dXJuIGMucmVtb3RlSW52b2tlKCEwLGgubWV0aG9kX2lkX1JUQ0R0bHNUcmFuc3BvcnRfdC5vbnN0YXRlY2hhbmdlLGUuc3VjY2Vzcyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2MubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfb25zdGF0ZWNoYW5nZSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib25lcnJvclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbmVycm9yX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9vbmVycm9yKCkgY2FsbGVkLlwiKTt0aGlzLm9uZXJyb3JfPWE7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJEdGxzVHJhbnNwb3J0Lm9uZXJyb3JcIikudGhlbihmdW5jdGlvbigpe3ZhciBjPWIucmVnaXN0ZXJDYWxsYmFja3MoITEsYi5pc051bGxDYWxsYmFjayhhKSxcclxuaC5tZXRob2RfaWRfUlRDRHRsc1RyYW5zcG9ydF90Lm9uZXJyb3IpO2MudGhlbihmdW5jdGlvbihhKXtkLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25lcnJvciBjYWxsYmFjayByZWNlaXZlZCFcIik7YT1iLnBhcmFtMChhKTtkLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCJlcnJvcjogXCIrYSk7Yi5vbmVycm9yXyhhKX0pO3JldHVybiBiLnJlbW90ZUludm9rZSghMCxoLm1ldGhvZF9pZF9SVENEdGxzVHJhbnNwb3J0X3Qub25lcnJvcixjLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIuc2V0X29uZXJyb3IgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO2IuY29udmVydFN0YXRlPWZ1bmN0aW9uKGEpe3JldHVybiBhPT1CW1wibmV3XCJdP1wibmV3XCI6YT09Qi5jb25uZWN0aW5nP1wiY29ubmVjdGluZ1wiOmE9PUIuY29ubmVjdGVkP1wiY29ubmVjdGVkXCI6YT09Qi5jbG9zZWQ/XHJcblwiY2xvc2VkXCI6XCJmYWlsZWRcIn07cmV0dXJuIGJ9KGwuUHJveHlPYmplY3QpO2EuRHRsc1RyYW5zcG9ydD10O2I9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjLGUsZyxoKXtjPWEuY2FsbCh0aGlzLGMsZSxnLGgpfHx0aGlzO2QubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jb25zdHJ1Y3RvciBiYXNlXCIpO2MudHJhY2tfPW51bGw7Yy50cmFuc3BvcnRfPW51bGw7cmV0dXJuIGN9ZShiLGEpO2IucHJvdG90eXBlLnN5bmNCYXJyaWVyQmFzZT1mdW5jdGlvbigpe2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllckJhc2UoKSBjYWxsZWQuXCIpO3ZhciBhPVtdLGIsYzt0aGlzIGluc3RhbmNlb2YgbT8oYj1oLm1ldGhvZF9pZF9SVENSdHBTZW5kZXJfdC50cmFjayxjPWgubWV0aG9kX2lkX1JUQ1J0cFNlbmRlcl90LnRyYW5zcG9ydCk6dGhpcyBpbnN0YW5jZW9mIEQmJihiPWgubWV0aG9kX2lkX1JUQ1J0cFJlY2VpdmVyX3QudHJhY2ssYz1oLm1ldGhvZF9pZF9SVENSdHBSZWNlaXZlcl90LnRyYW5zcG9ydCk7XHJcbm4uUmVtb3RlU2Vzc2lvbi5pc0ZlYXR1cmVQc3RuU3VwcG9ydGVkKCkmJm4uUmVtb3RlU2Vzc2lvbi5pc0ZlYXR1cmVEdG1mU3VwcG9ydGVkKCk/KGEucHVzaCh0aGlzLnJlbW90ZUludm9rZSghMSxiLHtvaWQ6MH0pKSxhLnB1c2godGhpcy5yZW1vdGVJbnZva2UoITEsYyx7b2lkOjB9KSkpOmEucHVzaCh0aGlzLnJlbW90ZUludm9rZSghMSxiLHtvaWQ6MH0pKTtyZXR1cm4gYX07Yi5wcm90b3R5cGUuc3luY0JhcnJpZXJCYXNlUmVzdWx0cz1mdW5jdGlvbihhKXt2YXIgYixjPXRoaXM7Yj0wO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllckJhc2VSZXN1bHRzXCIpO3ZhciBlO24uUmVtb3RlU2Vzc2lvbi5pc0ZlYXR1cmVQc3RuU3VwcG9ydGVkKCkmJm4uUmVtb3RlU2Vzc2lvbi5pc0ZlYXR1cmVEdG1mU3VwcG9ydGVkKCk/KGI9YS5tYXAoZnVuY3Rpb24oYSl7cmV0dXJuIGMucGFyYW0wKGEpfSksYT1iWzBdLGU9YlsxXSxiPTIpOihhPWEubWFwKGZ1bmN0aW9uKGEpe3JldHVybiBjLnBhcmFtMChhKX0pWzBdLFxyXG5iPTEpO3ZhciBnPVtdO2lmKHZvaWQgMCE9YSYmITE9PT1hLmlzX251bGwpe3ZhciBoPXRoaXMudHJhY2tfO251bGw9PT10aGlzLnRyYWNrX3x8dGhpcy50cmFja18ub2JqZWN0X2lkKCkhPWEub2lkP2g9bmV3IHcuUmVtb3RlTWVkaWFUcmFjayh0aGlzLGEub2lkKTp0aGlzLnRyYWNrXy5iaW5kKHRoaXMsYS5vaWQpO2cucHVzaChoLnN5bmNCYXJyaWVyKCkpfWVsc2UgZy5wdXNoKFByb21pc2UucmVzb2x2ZShudWxsKSk7aWYodm9pZCAwIT1lJiYhMT09PWUuaXNfbnVsbCl7YT10aGlzLnRyYW5zcG9ydF87aWYobnVsbD09PXRoaXMudHJhbnNwb3J0X3x8dGhpcy50cmFuc3BvcnRfLm9iamVjdF9pZCgpIT1lLm9pZClhPW5ldyB0KHRoaXMsZS5vaWQpO2cucHVzaChhLnN5bmNCYXJyaWVyKCkpfWVsc2UgZy5wdXNoKFByb21pc2UucmVzb2x2ZShudWxsKSk7cmV0dXJuW2IsZ119O2IucHJvdG90eXBlLnN5bmNCYXJyaWVyQmFzZVJlc3VsdHNXaXRoQWxsUHJvbWlzZXNGdWxGaWxsZWQ9ZnVuY3Rpb24oYSl7dGhpcy50cmFja189XHJcbmFbMF07dGhpcy50cmFuc3BvcnRfPWFbMV19O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInRyYW5zcG9ydFwiLHtnZXQ6ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0IHRyYW5zcG9ydCgpIGNhbGxlZC5cIik7cmV0dXJuIHRoaXMudHJhbnNwb3J0X30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJydGNwVHJhbnNwb3J0XCIse2dldDpmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXQgcnRjcFRyYW5zcG9ydCgpIGNhbGxlZC5cIik7cmV0dXJuIHRoaXMudHJhbnNwb3J0X30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJ0cmFja1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50cmFja199LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7XHJcbmIucHJvdG90eXBlLnJlaW5pdFRyYWNrPWZ1bmN0aW9uKGEpe3RoaXMudHJhY2tfPWF9O2IucHJvdG90eXBlLmdldFN0YXRzPWZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFN0YXRzKCkgY2FsbGVkLlwiKTt2YXIgYT10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2EuaXNSZWRpcmVjdGVkKCk/YS53YWl0VW50aWxDb25uZWN0ZWQoXCJSdHBSZWNlaXZlci5nZXRTdGF0c1wiKS50aGVuKGZ1bmN0aW9uKCl7aWYobi5SZW1vdGVTZXNzaW9uLmlzRmVhdHVyZVNlbmRlclN0YXRzRml4U3VwcG9ydGVkKCkpe3ZhciBkO2EgaW5zdGFuY2VvZiBtP2Q9aC5tZXRob2RfaWRfUlRDUnRwU2VuZGVyX3QuZ2V0U3RhdHM6YSBpbnN0YW5jZW9mIEQmJihkPWgubWV0aG9kX2lkX1JUQ1J0cFJlY2VpdmVyX3QuZ2V0U3RhdHMpO3ZhciBjPWEucmVnaXN0ZXJDYWxsYmFja3MoITAsITEsZCk7Yy50aGVuKGZ1bmN0aW9uKGEpe3ZvaWQgMD09PWEucGFyYW1zfHxcclxuMD09PWEucGFyYW1zLmxlbmd0aHx8MD09PWEucGFyYW1zWzBdLmxlbmd0aD9iKCk6YihxLlN0YXRzUmVwb3J0LmZyb21KU09OKEpTT04ucGFyc2UoYS5wYXJhbXNbMF0pKSl9KTtyZXR1cm4gYS5yZW1vdGVJbnZva2UoITEsZCxjLnN1Y2Nlc3MpfWIoKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7Yj1hLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuZ2V0U3RhdHMoKSBmYWlsZWQhXCIpO2MoYil9KTooZC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFN0YXRzKCk6IG5vdCBpbiBhY3RpdmUgcmVkaXJlY3Rpb24hXCIpLGIoKSl9KX07cmV0dXJuIGJ9KGwuUHJveHlPYmplY3QpO2EuUnRwU2VuZGVyUmVjZWl2ZXI9Yjt2YXIgbT1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKGMsZSxnLG0pe2M9YS5jYWxsKHRoaXMsYyxoLmNsYXNzX2lkX3QuUlRDUnRwU2VuZGVyLGUsZyl8fHRoaXM7ZC5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNvbnN0cnVjdG9yXCIpO2MuZHRtZl89XHJcbm51bGw7Yy5wYXJhbXNfPWsuUnRjUnRwU2VuZFBhcmFtZXRlcnMuZGVmUnRjUnRwU2VuZFBhcmFtZXRlcnMoKTtjLnVuaWZpZWRfPW07cmV0dXJuIGN9ZShiLGEpO2IucHJvdG90eXBlLmR1bXBJbmZvPWZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKFwiUnRwU2VuZGVyW1wiK3RoaXMub2JqZWN0X2lkKCkrXCJdLmR1bXBJbmZvKCk6XCIpO3RoaXMudHJhY2smJnRoaXMudHJhY2suZHVtcEluZm8oKX07Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYj10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllcigpIGNhbGxlZC5cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsZSl7Yi5zeW5jQmFycmllckRlZXAoYyxlKSYmYi53YWl0VW50aWxDb25uZWN0ZWQoXCJSdHBTZW5kZXIuc3luY0JhcnJpZXJcIikudGhlbihmdW5jdGlvbigpe3ZhciBjPWEucHJvdG90eXBlLnN5bmNCYXJyaWVyQmFzZS5jYWxsKGIpO24uUmVtb3RlU2Vzc2lvbi5pc0ZlYXR1cmVQc3RuU3VwcG9ydGVkKCkmJlxyXG5uLlJlbW90ZVNlc3Npb24uaXNGZWF0dXJlRHRtZlN1cHBvcnRlZCgpJiYoYy5wdXNoKGIucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1JUQ1J0cFNlbmRlcl90LmR0bWYse29pZDowfSkpLGMucHVzaChiLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENSdHBTZW5kZXJfdC5nZXRQYXJhbWV0ZXJzKSkpO3JldHVybiBQcm9taXNlLmFsbChjKX0pLnRoZW4oZnVuY3Rpb24oYSl7dmFyIGMsZTtjPWIuc3luY0JhcnJpZXJCYXNlUmVzdWx0cyhhKTtlPWNbMF07Yz1jWzFdO2E9YS5zbGljZShlKS5tYXAoZnVuY3Rpb24oYSl7cmV0dXJuIGIucGFyYW0wKGEpfSk7ZT1hWzBdO2IucGFyYW1zXz1hWzFdO3ZvaWQgMD09ZXx8ITEhPT1lLmlzX251bGx8fG51bGwhPT1iLmR0bWZfJiZiLmR0bWZfLm9iamVjdF9pZCgpPT1lLm9pZHx8KGIuZHRtZl89bmV3IHAoYixlLm9pZCkpO1Byb21pc2UuYWxsKGMpLnRoZW4oZnVuY3Rpb24oYSl7Yi5zeW5jQmFycmllckJhc2VSZXN1bHRzV2l0aEFsbFByb21pc2VzRnVsRmlsbGVkKGEpO1xyXG5kLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXJCYXNlIHN1Y2Nlc3MuXCIpO2Iuc3luY0JhcnJpZXJSZXNvbHZlKGIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPWIubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zeW5jQmFycmllcigpIHByb21pc2VzX2Jhc2UgZmFpbGVkIVwiKTtiLnN5bmNCYXJyaWVyUmVqZWN0KGEpfSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2E9Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnN5bmNCYXJyaWVyIGZhaWxlZCFcIik7Yi5zeW5jQmFycmllclJlamVjdChhKX0pfSl9O2IuZ2V0Q2FwYWJpbGl0aWVzPWZ1bmN0aW9uKGEpe2QubG9nZ2VyLmxvZyh0aGlzLmNvbnN0cnVjdG9yLm5hbWUrXCIuZ2V0Q2FwYWJpbGl0aWVzKCkgY2FsbGVkLlwiKTtyZXR1cm4gdy5OYXZpZ2F0b3JVc2VyTWVkaWEuZ2V0Q2FwYWJpbGl0aWVzKGEpfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJkdG1mXCIse2dldDpmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuZ2V0IGR0bWYoKSBjYWxsZWQuXCIpO3JldHVybiB0aGlzLmR0bWZffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO2IucHJvdG90eXBlLnNldFBhcmFtZXRlcnM9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuc2V0UGFyYW1ldGVyc0FzeW5jKGEpfTtiLnByb3RvdHlwZS5zZXRQYXJhbWV0ZXJzQXN5bmM9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0UGFyYW1ldGVyc0FzeW5jKCkgY2FsbGVkLlwiKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxlKXtiLndhaXRVbnRpbENvbm5lY3RlZChcIlJ0cFNlbmRlci5zZXRQYXJhbWV0ZXJzQXN5bmNcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLmFsbChbYi5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDUnRwU2VuZGVyX3Quc2V0UGFyYW1ldGVycyxrLlJ0Y1J0cFNlbmRQYXJhbWV0ZXJzLnRvUnRjUnRwU2VuZFBhcmFtZXRlcnMoYSkpXSl9KS50aGVuKGZ1bmN0aW9uKGUpe2QubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuc2V0UGFyYW1ldGVyc0FzeW5jKCk6IHN1Y2Nlc3MuXCIpO2MoKTtiLnBhcmFtc189ay5SdGNSdHBTZW5kUGFyYW1ldGVycy50b1J0Y1J0cFNlbmRQYXJhbWV0ZXJzKGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPWIubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRQYXJhbWV0ZXJzQXN5bmMoKSBmYWlsZWQhXCIpO2UoYSl9KX0pfTtiLnByb3RvdHlwZS5nZXRQYXJhbWV0ZXJzPWZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFBhcmFtZXRlcnMoKSBjYWxsZWQuXCIpO3JldHVybiB0aGlzLmdldFBhcmFtZXRlcnNJbnRlcm5hbCghMSl9O2IucHJvdG90eXBlLmdldFBhcmFtZXRlcnNBc3luYz1mdW5jdGlvbigpe2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRQYXJhbWV0ZXJzQXN5bmMoKSBjYWxsZWQuXCIpO3JldHVybiB0aGlzLmdldFBhcmFtZXRlcnNJbnRlcm5hbCghMCl9O2IucHJvdG90eXBlLmdldFBhcmFtZXRlcnNJbnRlcm5hbD1cclxuZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPW5ldyBQcm9taXNlKGZ1bmN0aW9uKGEsYyl7Yi53YWl0VW50aWxDb25uZWN0ZWQoYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0UGFyYW1ldGVyc0ludGVybmFsXCIpLnRoZW4oZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0UGFyYW1ldGVyc0ludGVybmFsKCkgcmVtb3RlIGludm9raW5nXCIpO3JldHVybiBiLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENSdHBTZW5kZXJfdC5nZXRQYXJhbWV0ZXJzKX0pLnRoZW4oZnVuY3Rpb24oYyl7Yi5wYXJhbXNfPWIucGFyYW0wKGMpO2QubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRQYXJhbWV0ZXJzSW50ZXJuYWwoKSBzdWNjZXNzIHJldHVybmluZzogXCIrYi5wYXJhbXNfKTthKGsuUnRjUnRwU2VuZFBhcmFtZXRlcnMudG9SVENSdHBTZW5kUGFyYW1ldGVycyhiLnBhcmFtc18pKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7YT1iLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXHJcblwiLmdldFBhcmFtZXRlcnNJbnRlcm5hbCgpIGZhaWxlZCFcIik7YyhhKX0pfSk7aWYoYSlyZXR1cm4gYztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0UGFyYW1ldGVyc0ludGVybmFsKCkgcmV0dXJuaW5nOiBcIit0aGlzLnBhcmFtc18pO3JldHVybiBrLlJ0Y1J0cFNlbmRQYXJhbWV0ZXJzLnRvUlRDUnRwU2VuZFBhcmFtZXRlcnModGhpcy5wYXJhbXNfKX07Yi5wcm90b3R5cGUucmVwbGFjZVRyYWNrPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnJlcGxhY2VUcmFjaygpIGNhbGxlZC4gY3VycmVudCB0cmFjazpcIisodGhpcy50cmFja18/dGhpcy50cmFja18ub2JqZWN0X2lkKCk6XCJudWxsXCIpK1wiIHdpdGggdHJhY2s9XCIrKGE/YS5vYmplY3RfaWQoKTpcIm51bGxcIikpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihjLGUpe2Iud2FpdFVudGlsQ29ubmVjdGVkKFwiUnRwU2VuZGVyLnJlcGxhY2VUcmFja1wiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGF8fFxyXG5uLlJlbW90ZVNlc3Npb24uaXNGZWF0dXJlV2VicnRjMWRvdDBTdXBwb3J0ZWQoKT9hP2IucmVtb3RlSW52b2tlRXgoITEsaC5tZXRob2RfaWRfUlRDUnRwU2VuZGVyX3QucmVwbGFjZVRyYWNrLFthXSk6Yi5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDUnRwU2VuZGVyX3QucmVwbGFjZVRyYWNrLHtvaWQ6LTF9KTpQcm9taXNlLnJlamVjdChuZXcgRE9NRXhjZXB0aW9uKFwiRG9lcyBub3Qgc3VwcG9ydCByZXBsYWNlIHRyYWNrIHdpdGggbnVsbCBpbiBub24tVW5pZmllZCBTRFAgc2VtYW50aWMhXCIpKX0pLnRoZW4oZnVuY3Rpb24oZSl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLnJlcGxhY2VUcmFjaygpOiBzdWNjZXNzLlwiKTtjKCk7Yi5yZWluaXRUcmFjayhhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7YT1iLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIucmVwbGFjZVRyYWNrKCkgZmFpbGVkIVwiKTtlKGEpfSl9KX07cmV0dXJuIGJ9KGIpO2EuUnRwU2VuZGVyPVxyXG5tO3ZhciBEPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYyxlLGcsbSx4KXtjPWEuY2FsbCh0aGlzLGMsaC5jbGFzc19pZF90LlJUQ1J0cFJlY2VpdmVyLGUsZyl8fHRoaXM7ZC5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNvbnN0cnVjdG9yXCIpO2MuY29udHJpYnNvdXJjZXNfPVtdO2Muc3luY3NvdXJjZXNfPVtdO2MucGFyYW1zXz1rLlJ0Y1J0cFBhcmFtZXRlcnMuZGVmUnRjUnRwUGFyYW1ldGVycygpO2MudW5pZmllZF89bTt4JiYoYy50cmFja189eCk7cmV0dXJuIGN9ZShiLGEpO2IucHJvdG90eXBlLmR1bXBJbmZvPWZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKFwiUnRwUmVjZWl2ZXJbXCIrdGhpcy5vYmplY3RfaWQoKStcIl0uZHVtcEluZm8oKTpcIik7dGhpcy50cmFjayYmdGhpcy50cmFjay5kdW1wSW5mbygpO3RoaXMudHJhbnNwb3J0JiZ0aGlzLnRyYW5zcG9ydC5kdW1wSW5mbygpfTtiLnByb3RvdHlwZS5zeW5jQmFycmllcj1mdW5jdGlvbigpe3ZhciBiPXRoaXM7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5zeW5jQmFycmllcigpIGNhbGxlZC5cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsZSl7Yi5zeW5jQmFycmllckRlZXAoYyxlKSYmYi53YWl0VW50aWxDb25uZWN0ZWQoXCJSdHBSZWNlaXZlci5zeW5jQmFycmllclwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9YS5wcm90b3R5cGUuc3luY0JhcnJpZXJCYXNlLmNhbGwoYik7bi5SZW1vdGVTZXNzaW9uLmlzRmVhdHVyZVBzdG5TdXBwb3J0ZWQoKSYmbi5SZW1vdGVTZXNzaW9uLmlzRmVhdHVyZUR0bWZTdXBwb3J0ZWQoKT8oYy5wdXNoKGIucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1JUQ1J0cFJlY2VpdmVyX3QuZ2V0Q29udHJpYnV0aW5nU291cmNlcykpLGMucHVzaChiLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENSdHBSZWNlaXZlcl90LmdldFN5bmNocm9uaXphdGlvblNvdXJjZXMpKSxjLnB1c2goYi5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDUnRwUmVjZWl2ZXJfdC5nZXRQYXJhbWV0ZXJzKSkpOlxyXG5jLnB1c2goYi5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDUnRwUmVjZWl2ZXJfdC5nZXRDb250cmlidXRpbmdTb3VyY2VzKSk7cmV0dXJuIFByb21pc2UuYWxsKGMpfSkudGhlbihmdW5jdGlvbihhKXt2YXIgYyxlO2M9Yi5zeW5jQmFycmllckJhc2VSZXN1bHRzKGEpO2U9Y1swXTtjPWNbMV07YT1hLnNsaWNlKGUpLm1hcChmdW5jdGlvbihhKXtyZXR1cm4gYi5wYXJhbTAoYSl9KTtiLmNvbnRyaWJzb3VyY2VzXz1hWzBdO2Iuc3luY3NvdXJjZXNfPWFbMV07Yi5wYXJhbXNfPWFbMl07UHJvbWlzZS5hbGwoYykudGhlbihmdW5jdGlvbihhKXtiLnN5bmNCYXJyaWVyQmFzZVJlc3VsdHNXaXRoQWxsUHJvbWlzZXNGdWxGaWxsZWQoYSk7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyIHN1Y2Nlc3MuXCIpO2Iuc3luY0JhcnJpZXJSZXNvbHZlKGIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPWIubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zeW5jQmFycmllcigpIHByb21pc2VzX2Jhc2UgZmFpbGVkIVwiKTtcclxuYi5zeW5jQmFycmllclJlamVjdChhKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXthPWIubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zeW5jQmFycmllcigpIGZhaWxlZCFcIik7Yi5zeW5jQmFycmllclJlamVjdChhKX0pfSl9O2IuZ2V0Q2FwYWJpbGl0aWVzPWZ1bmN0aW9uKGEpe2QubG9nZ2VyLmxvZyh0aGlzLmNvbnN0cnVjdG9yLm5hbWUrXCIuZ2V0Q2FwYWJpbGl0aWVzKCkgY2FsbGVkLlwiKTtyZXR1cm4gdy5OYXZpZ2F0b3JVc2VyTWVkaWEuZ2V0Q2FwYWJpbGl0aWVzKGEpfTtiLnByb3RvdHlwZS5nZXRDb250cmlidXRpbmdTb3VyY2VzPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0Q29udHJpYnV0aW5nU291cmNlcygpIGNhbGxlZC4gXCIrSlNPTi5zdHJpbmdpZnkodGhpcy5jb250cmlic291cmNlc18pKTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIlJ0cFJlY2VpdmVyLmdldENvbnRyaWJ1dGluZ1NvdXJjZXNcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEsXHJcbmgubWV0aG9kX2lkX1JUQ1J0cFJlY2VpdmVyX3QuZ2V0Q29udHJpYnV0aW5nU291cmNlcyldKX0pLnRoZW4oZnVuY3Rpb24oYil7YS5jb250cmlic291cmNlc189Yi5tYXAoZnVuY3Rpb24oYil7cmV0dXJuIGEucGFyYW0wKGIpfSlbMF07ZC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpLFwiLmdldENvbnRyaWJ1dGluZ1NvdXJjZXMoKSBzdWNjZXNzOiBcIitKU09OLnN0cmluZ2lmeShhLmNvbnRyaWJzb3VyY2VzXykpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuZ2V0Q29udHJpYnV0aW5nU291cmNlcygpIGZhaWxlZCFcIik7YS5jb250cmlic291cmNlc189W119KTtyZXR1cm4gdGhpcy5jb250cmlic291cmNlc199O2IucHJvdG90eXBlLmdldFBhcmFtZXRlcnM9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRQYXJhbWV0ZXJzKCkgY2FsbGVkLlwiKTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuZ2V0UGFyYW1ldGVyc1wiKS50aGVuKGZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFBhcmFtZXRlcnMoKSByZW1vdGUgaW52b2tpbmdcIik7cmV0dXJuIGEucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1JUQ1J0cFJlY2VpdmVyX3QuZ2V0UGFyYW1ldGVycyl9KS50aGVuKGZ1bmN0aW9uKGIpe2QubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRQYXJhbWV0ZXJzKCkgc3VjY2Vzc1wiKTthLnBhcmFtc189YS5wYXJhbTAoYil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2EubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5nZXRQYXJhbWV0ZXJzKCkgZmFpbGVkIVwiKX0pO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRQYXJhbWV0ZXJzKCkgcmV0dXJuaW5nOiBcIit0aGlzLnBhcmFtc18pO3JldHVybiBrLlJ0Y1J0cFJlY2VpdmVQYXJhbWV0ZXJzLnRvUlRDUnRwUmVjZWl2ZVBhcmFtZXRlcnModGhpcy5wYXJhbXNfKX07XHJcbmIucHJvdG90eXBlLmdldFN5bmNocm9uaXphdGlvblNvdXJjZXM9ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0U3luY2hyb25pemF0aW9uU291cmNlcygpIGNhbGxlZC5cIik7cmV0dXJuIHRoaXMuc3luY3NvdXJjZXNffTtyZXR1cm4gYn0oYik7YS5SdHBSZWNlaXZlcj1EfSwzNzc6ZnVuY3Rpb24oYixhLGMpe3ZhciBlPXRoaXMmJnRoaXMuX19leHRlbmRzfHxmdW5jdGlvbigpe3ZhciBhPWZ1bmN0aW9uKGIsYyl7YT1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oYSxiKXthLl9fcHJvdG9fXz1ifXx8ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGMgaW4gYiliLmhhc093blByb3BlcnR5KGMpJiYoYVtjXT1iW2NdKX07cmV0dXJuIGEoYixjKX07cmV0dXJuIGZ1bmN0aW9uKGIsYyl7ZnVuY3Rpb24gZCgpe3RoaXMuY29uc3RydWN0b3I9Yn1hKGIsYyk7Yi5wcm90b3R5cGU9bnVsbD09PVxyXG5jP09iamVjdC5jcmVhdGUoYyk6KGQucHJvdG90eXBlPWMucHJvdG90eXBlLG5ldyBkKX19KCk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7YS5SdHBUcmFuc2NlaXZlcj1hLlJ0Y1J0cFRyYW5zY2VpdmVySW5pdD1hLlJ0Y1J0cFRyYW5zY2VpdmVyRGlyZWN0aW9uPXZvaWQgMDt2YXIgbD1jKDY1OCksaD1jKDU1MCksZD1jKDg1MSksdz1jKDU4OSkscT1jKDQ4NCksbjsoZnVuY3Rpb24oYSl7YVthLnNlbmRyZWN2PTBdPVwic2VuZHJlY3ZcIjthW2Euc2VuZG9ubHk9MV09XCJzZW5kb25seVwiO2FbYS5yZWN2b25seT0yXT1cInJlY3Zvbmx5XCI7YVthLmluYWN0aXZlPTNdPVwiaW5hY3RpdmVcIjthW2Euc3RvcHBlZD00XT1cInN0b3BwZWRcIn0pKG49YS5SdGNSdHBUcmFuc2NlaXZlckRpcmVjdGlvbnx8KGEuUnRjUnRwVHJhbnNjZWl2ZXJEaXJlY3Rpb249e30pKTt2YXIgaz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt9YS50b1J0Y1J0cFRyYW5zY2VpdmVyRGlyZWN0aW9uPVxyXG5mdW5jdGlvbihhKXtzd2l0Y2goYSl7Y2FzZSBcImluYWN0aXZlXCI6YT1uLmluYWN0aXZlO2JyZWFrO2Nhc2UgXCJyZWN2b25seVwiOmE9bi5yZWN2b25seTticmVhaztjYXNlIFwic2VuZG9ubHlcIjphPW4uc2VuZG9ubHk7YnJlYWs7Y2FzZSBcInNlbmRyZWN2XCI6YT1uLnNlbmRyZWN2O2JyZWFrO2Nhc2UgXCJzdG9wcGVkXCI6YT1uLnN0b3BwZWQ7YnJlYWs7ZGVmYXVsdDphPW4uc2VuZHJlY3Z9cmV0dXJuIGF9O2EudG9SVENSdHBUcmFuc2NlaXZlckRpcmVjdGlvbj1mdW5jdGlvbihhKXtzd2l0Y2goYSl7Y2FzZSBuLmluYWN0aXZlOmE9XCJpbmFjdGl2ZVwiO2JyZWFrO2Nhc2Ugbi5yZWN2b25seTphPVwicmVjdm9ubHlcIjticmVhaztjYXNlIG4uc2VuZG9ubHk6YT1cInNlbmRvbmx5XCI7YnJlYWs7Y2FzZSBuLnNlbmRyZWN2OmE9XCJzZW5kcmVjdlwiO2JyZWFrO2Nhc2Ugbi5zdG9wcGVkOmE9XCJzdG9wcGVkXCI7YnJlYWs7ZGVmYXVsdDphPVwic2VuZHJlY3ZcIn1yZXR1cm4gYX07YS50b1J0Y1J0cFRyYW5zY2VpdmVySW5pdD1cclxuZnVuY3Rpb24oYil7ZC5sb2dnZXIubG9nKFwiUnRjUnRwVHJhbnNjZWl2ZXJJbml0LnRvUnRjUnRwVHJhbnNjZWl2ZXJJbml0KCkgaW4gaW5pdDpcIitKU09OLnN0cmluZ2lmeShiKSk7dmFyIGM9e307YiYmKGIuZGlyZWN0aW9uJiYoYy5kaXJlY3Rpb249YS50b1J0Y1J0cFRyYW5zY2VpdmVyRGlyZWN0aW9uKGIuZGlyZWN0aW9uKSksYi5zZW5kRW5jb2RpbmdzJiYoYy5zZW5kRW5jb2RpbmdzPVtdLGIuc2VuZEVuY29kaW5ncy5mb3JFYWNoKGZ1bmN0aW9uKGEpe3JldHVybiBjLnNlbmRFbmNvZGluZ3MucHVzaChxLlJ0Y1J0cEVuY29kaW5nUGFyYW1ldGVycy50b1J0Y1J0cEVuY29kaW5nUGFyYW1ldGVycyhhKSl9KSksYi5zdHJlYW1zJiYoYy5zdHJlYW1zPWIuc3RyZWFtcykpO2QubG9nZ2VyLmxvZyhcIlJ0Y1J0cFRyYW5zY2VpdmVySW5pdC50b1J0Y1J0cFRyYW5zY2VpdmVySW5pdCgpIG91dCBpbml0OlwiK0pTT04uc3RyaW5naWZ5KGMpKTtyZXR1cm4gY307cmV0dXJuIGF9KCk7YS5SdGNSdHBUcmFuc2NlaXZlckluaXQ9XHJcbms7Yj1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKGMsZSxrLG0scSx5KXtjPWEuY2FsbCh0aGlzLGMsaC5jbGFzc19pZF90LlJUQ1J0cFRyYW5zY2VpdmVyLGUsayl8fHRoaXM7ZC5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNvbnN0cnVjdG9yXCIpO2MudW5pZmllZF89bTtjLnNlbmRlcl89bmV3IHcuUnRwU2VuZGVyKGMsMCxsLlByb3h5TW9kZS5Qc2V1ZG8sbSk7Yy5yZWNlaXZlcl89eT95Om5ldyB3LlJ0cFJlY2VpdmVyKGMsMCxsLlByb3h5TW9kZS5Qc2V1ZG8sbSk7cT8oYy5kaXJlY3Rpb25fPXEsYy5jdXJyZW50RGlyZWN0aW9uXz1xKTooYy5kaXJlY3Rpb25fPW4uc2VuZHJlY3YsYy5jdXJyZW50RGlyZWN0aW9uXz1uLnNlbmRyZWN2KTtyZXR1cm4gY31lKGIsYSk7Yi5wcm90b3R5cGUuZHVtcEluZm89ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZHVtcEluZm8oKSBbaWQ9XCIrdGhpcy5taWQrXCJdIGRpcmVjdGlvbj1cIitrLnRvUlRDUnRwVHJhbnNjZWl2ZXJEaXJlY3Rpb24odGhpcy5kaXJlY3Rpb25fKStcclxuXCIgY3VycmVudERpcmVjdGlvbj1cIitrLnRvUlRDUnRwVHJhbnNjZWl2ZXJEaXJlY3Rpb24odGhpcy5jdXJyZW50RGlyZWN0aW9uXykpO3RoaXMuc2VuZGVyJiZ0aGlzLnNlbmRlci5kdW1wSW5mbygpO3RoaXMucmVjZWl2ZXImJnRoaXMucmVjZWl2ZXIuZHVtcEluZm8oKX07Yi5wcm90b3R5cGUuc3luY0JhcnJpZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zeW5jQmFycmllcigpIGNhbGxlZC5cIik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGIsYyl7YS5zeW5jQmFycmllckRlZXAoYixjKSYmYS53YWl0VW50aWxDb25uZWN0ZWQoXCJSdHBUcmFuc2NlaXZlci5zeW5jQmFycmllclwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIFByb21pc2UuYWxsKFthLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENSdHBUcmFuc2NlaXZlcl90Lm1pZCxcIlwiKSxhLnJlbW90ZUludm9rZSghMSxoLm1ldGhvZF9pZF9SVENSdHBUcmFuc2NlaXZlcl90LmRpcmVjdGlvbixcclxuMCksYS5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfUlRDUnRwVHJhbnNjZWl2ZXJfdC5jdXJyZW50RGlyZWN0aW9uLDApLGEucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1JUQ1J0cFRyYW5zY2VpdmVyX3Quc2VuZGVyLHtvaWQ6MH0pLGEucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1JUQ1J0cFRyYW5zY2VpdmVyX3QucmVjZWl2ZXIse29pZDowfSldKX0pLnRoZW4oZnVuY3Rpb24oYil7dmFyIGM7ZC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyIHJlbW90ZSBzdWNjZXNzLlwiKTtjPWIubWFwKGZ1bmN0aW9uKGIpe3JldHVybiBhLnBhcmFtMChiKX0pO2EubWlkXz1jWzBdO2EuZGlyZWN0aW9uXz1jWzFdO2EuY3VycmVudERpcmVjdGlvbl89Y1syXTtiPWNbM107Yz1jWzRdO3ZhciBlPVtdO3ZvaWQgMCE9YiYmITE9PT1iLmlzX251bGwmJihhLnNlbmRlcl8uYmluZChhLGIub2lkKSxlLnB1c2goYS5zZW5kZXJfLnN5bmNCYXJyaWVyKCkpKTtcclxudm9pZCAwIT1jJiYhMT09PWMuaXNfbnVsbCYmKGEucmVjZWl2ZXJfLmJpbmQoYSxjLm9pZCksZS5wdXNoKGEucmVjZWl2ZXJfLnN5bmNCYXJyaWVyKCkpKTtpZigwPT1lLmxlbmd0aClkLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIgc3VjY2Vzc1wiKSxhLnN5bmNCYXJyaWVyUmVzb2x2ZShhKTtlbHNlIHJldHVybiBkLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucHJvcC5zeW5jQmFycmllciBzdGFydFwiKSxQcm9taXNlLmFsbChlKX0pLnRoZW4oZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIgc3VjY2Vzc1wiKTthLnN5bmNCYXJyaWVyUmVzb2x2ZShhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7Yj1hLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuc3luY0JhcnJpZXIoKSBmYWlsZWQhXCIpO2Euc3luY0JhcnJpZXJSZWplY3QoYil9KX0pfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXHJcblwibWlkXCIse2dldDpmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRfbWlkKCkgY2FsbGVkOiBcIit0aGlzLm1pZF8pO3JldHVybiB0aGlzLm1pZF99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwic2VuZGVyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNlbmRlcl99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwicmVjZWl2ZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVjZWl2ZXJffSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcImRpcmVjdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X2RpcmVjdGlvbigpIGNhbGxlZC4gXCIray50b1JUQ1J0cFRyYW5zY2VpdmVyRGlyZWN0aW9uKHRoaXMuZGlyZWN0aW9uXykpO1xyXG5yZXR1cm4gay50b1JUQ1J0cFRyYW5zY2VpdmVyRGlyZWN0aW9uKHRoaXMuZGlyZWN0aW9uXyl9LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRfZGlyZWN0aW9uKCkgY2FsbGVkLiBcIithKTt0aGlzLmRpcmVjdGlvbl89ay50b1J0Y1J0cFRyYW5zY2VpdmVyRGlyZWN0aW9uKGEpO3RoaXMud2FpdFVudGlsQ29ubmVjdGVkKFwiUnRwVHJhbnNjZWl2ZXIuc2V0X2RpcmVjdGlvblwiKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGIucmVtb3RlSW52b2tlKCEwLGgubWV0aG9kX2lkX1JUQ1J0cFRyYW5zY2VpdmVyX3QuZGlyZWN0aW9uLGsudG9SdGNSdHBUcmFuc2NlaXZlckRpcmVjdGlvbihhKSl9KS50aGVuKGZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldF9kaXJlY3Rpb246IHN1Y2Nlc3MuXCIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXHJcblwiLnNldF9kaXJlY3Rpb24oKSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwiY3VycmVudERpcmVjdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0X2N1cnJlbnREaXJlY3Rpb24oKSBjYWxsZWQuIFwiK2sudG9SVENSdHBUcmFuc2NlaXZlckRpcmVjdGlvbih0aGlzLmN1cnJlbnREaXJlY3Rpb25fKSk7cmV0dXJuIGsudG9SVENSdHBUcmFuc2NlaXZlckRpcmVjdGlvbih0aGlzLmN1cnJlbnREaXJlY3Rpb25fKX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtiLnByb3RvdHlwZS5zdG9wPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3RvcCgpIGNhbGxlZC5cIik7dGhpcy53YWl0VW50aWxDb25uZWN0ZWQoXCJSdHBUcmFuc2NlaXZlci5zdG9wXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYS5yZW1vdGVJbnZva2UoITAsXHJcbmgubWV0aG9kX2lkX1JUQ1J0cFRyYW5zY2VpdmVyX3Quc3RvcCl9KS50aGVuKGZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN0b3A6IHN1Y2Nlc3MuXCIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXthLmxvZ1JlbW90ZUludm9rZUVycm9yKGIsXCIuc3RvcCgpIGZhaWxlZCFcIil9KX07Yi5wcm90b3R5cGUuc2V0Q29kZWNQcmVmZXJlbmNlcz1mdW5jdGlvbihhKXt2YXIgYj10aGlzO2QubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zZXRDb2RlY1ByZWZlcmVuY2VzKCkgY2FsbGVkLlwiKTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIlJ0cFRyYW5zY2VpdmVyLnNldENvZGVjUHJlZmVyZW5jZXNcIikudGhlbihmdW5jdGlvbigpe3JldHVybiBiLnJlbW90ZUludm9rZSghMCxoLm1ldGhvZF9pZF9SVENSdHBUcmFuc2NlaXZlcl90LnNldENvZGVjUHJlZmVyZW5jZXMsYSl9KS50aGVuKGZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5zZXRDb2RlY1ByZWZlcmVuY2VzOiBzdWNjZXNzLlwiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnNldENvZGVjUHJlZmVyZW5jZXMoKSBmYWlsZWQhXCIpfSl9O3JldHVybiBifShsLlByb3h5T2JqZWN0KTthLlJ0cFRyYW5zY2VpdmVyPWJ9LDk3MzpmdW5jdGlvbihiLGEsYyl7ZnVuY3Rpb24gZShhLGIpe3JldHVybiB2b2lkIDAhPT1hLmZpbmQoZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT1ifSl9ZnVuY3Rpb24gbChhLGIsYyl7Yi89YS53aWR0aDtjLz1hLmhlaWdodDt2YXIgZD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLGU9ZC5nZXRDb250ZXh0KFwiMmRcIik7ZC53aWR0aD1hLndpZHRoKmI7ZC5oZWlnaHQ9YS5oZWlnaHQqYztlLnB1dEltYWdlRGF0YShhLDAsMCk7aWYoMSE9Ynx8MSE9YyllLnNjYWxlKGIsYyksZS5kcmF3SW1hZ2UoZCwwLDApO3JldHVybiBkfWZ1bmN0aW9uIGgoYSxiLGMpe2E9bChhLGIsYyk7Yj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xyXG5iLnNyYz1hLnRvRGF0YVVSTCgpO3JldHVybiBifWZ1bmN0aW9uIGQoYSxiLGMsZCl7Yz1cInVuZGVmaW5lZFwiIT09dHlwZW9mIGM/YzpELldpZHRoO2Q9XCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBkP2Q6RC5IZWlnaHQ7aWYoITA9PT1iKXJldHVybiBoKGEsYyxkKTtiPW51bGw7Yz09YS53aWR0aCYmZD09PWEuaGVpZ2h0P2I9YTooYT1sKGEsYyxkKSxiPWEuZ2V0Q29udGV4dChcIjJkXCIpLmdldEltYWdlRGF0YSgwLDAsYS53aWR0aCxhLmhlaWdodCkpO3JldHVybiBifXZhciB3PXRoaXMmJnRoaXMuX19leHRlbmRzfHxmdW5jdGlvbigpe3ZhciBhPWZ1bmN0aW9uKGIsYyl7YT1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oYSxiKXthLl9fcHJvdG9fXz1ifXx8ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGMgaW4gYiliLmhhc093blByb3BlcnR5KGMpJiYoYVtjXT1iW2NdKX07cmV0dXJuIGEoYixjKX07cmV0dXJuIGZ1bmN0aW9uKGIsXHJcbmMpe2Z1bmN0aW9uIGQoKXt0aGlzLmNvbnN0cnVjdG9yPWJ9YShiLGMpO2IucHJvdG90eXBlPW51bGw9PT1jP09iamVjdC5jcmVhdGUoYyk6KGQucHJvdG90eXBlPWMucHJvdG90eXBlLG5ldyBkKX19KCk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7YS5TY3JlZW5Tb3VyY2U9YS5TY3JlZW5Tb3VyY2VWZGE9YS5TY3JlZW5TaGFyaW5nVmRhPWEuU2NyZWVuU2hhcmluZ1JlbW90ZT1hLlNjcmVlblNoYXJpbmc9YS5JbWFnZURhdGFSZW1vdGU9dm9pZCAwO3ZhciBxPWMoNjU4KSxuPWMoNTUwKSxrPWMoODUxKSxwPWMoOTQ2KSx6PWMoNjkxKSxnPWMoNjUwKSxCOyhmdW5jdGlvbihhKXthW2EuTGVnYWN5PTBdPVwiTGVnYWN5XCI7YVthLk1vbml0b3JzQW5kQXBwcz0xMF09XCJNb25pdG9yc0FuZEFwcHNcIn0pKEJ8fChCPXt9KSk7Yj1mdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihhLGIsYyl7dGhpcy5kYXRhPWE7dGhpcy5oZWlnaHQ9Yjt0aGlzLndpZHRoPVxyXG5jfX0oKTthLkltYWdlRGF0YVJlbW90ZT1iO2I9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7dGhpcy5sb2NhbF89dGhpcy5yZW1vdGVfPW51bGx9YS5zY3JlZW5TaGFyaW5nSW5zdGFuY2U9ZnVuY3Rpb24oYil7YS5pbnN0YW5jZXx8KGEuaW5zdGFuY2U9bmV3IGEsYiYmKGEuaW5zdGFuY2Uub25zY3JlZW50b3BvbG9neWNoYW5nZWQ9YikpO3JldHVybiBhLmluc3RhbmNlfTthLmRlc3Ryb3lJbnN0YW5jZT1mdW5jdGlvbigpe2EuaW5zdGFuY2UmJmEuaW5zdGFuY2UucmVtb3RlXyYmYS5pbnN0YW5jZS5yZW1vdGVfLnJlbGVhc2UoKTthLmluc3RhbmNlPW51bGx9O2EucHJvdG90eXBlLnVzZXJfZnJpZW5kbHlfaWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5uYW1lK1wiW11cIn07T2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwib25zY3JlZW50b3BvbG9neWNoYW5nZWRcIix7c2V0OmZ1bmN0aW9uKGEpe3RoaXMucmVtb3RlX3x8KHRoaXMucmVtb3RlXz1uZXcgdCk7XHJcbnRoaXMucmVtb3RlXy5vbnNjcmVlbnRvcG9sb2d5Y2hhbmdlZD1hO3RoaXMubG9jYWxffHwodGhpcy5sb2NhbF89bmV3IG0pO3RoaXMubG9jYWxfLm9uc2NyZWVudG9wb2xvZ3ljaGFuZ2VkPWF9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7YS5wcm90b3R5cGUuZ2V0V2luZG93c0FzeW5jPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztrLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0V2luZG93c0FzeW5jKCkgY2FsbGVkLlwiKTtudWxsPT10aGlzLmxvY2FsXyYmKHRoaXMubG9jYWxfPW5ldyBtKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixjKXt2YXIgZD1bXTthLmxvY2FsXy5nZXRXaW5kb3dzQXN5bmMoKS50aGVuKGZ1bmN0aW9uKGMpe2MmJihkPWMpO2subG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRXaW5kb3dzQXN5bmMoKSByZXR1cm5pbmcgc291cmNlc1wiKTtiKGQpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2subG9nZ2VyLmxvZyhcIlNjcmVlblNoYXJpbmcuZ2V0V2luZG93c0FzeW5jKCk6IHJlamVjdGVkXCIpO1xyXG5iKGQpfSl9KX07YS5wcm90b3R5cGUuZ2V0U2NyZWVuc0FzeW5jPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztrLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0U2NyZWVuc0FzeW5jKCkgY2FsbGVkLlwiKTtudWxsPT10aGlzLnJlbW90ZV8mJih0aGlzLnJlbW90ZV89bmV3IHQpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe3ZhciBkPVtdO2EucmVtb3RlXy5nZXRTY3JlZW5zQXN5bmMoKS50aGVuKGZ1bmN0aW9uKGMpe2MmJihkPWMpO2subG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRTY3JlZW5zQXN5bmMoKSByZXR1cm5pbmcgc291cmNlc1wiKTtiKGQpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2subG9nZ2VyLmxvZyhcIlNjcmVlblNoYXJpbmcuZ2V0U2NyZWVuc0FzeW5jKCk6IHJlamVjdGVkXCIpO2IoZCl9KX0pfTthLnByb3RvdHlwZS5zZXRBY3RpdmVTb3VyY2U9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzO2subG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuc2V0QWN0aXZlU291cmNlKCkgY2FsbGVkLiBpZD1cIithK1wiIGFwcHNoYXJlPVwiK2IpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihkLGUpe2MucmVtb3RlXy5jb250YWlucyhhKT9jLnJlbW90ZV8uc2V0QWN0aXZlKGEpLnRoZW4oZnVuY3Rpb24oYSl7ZChhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtrLmxvZ2dlci5sb2coXCJTY3JlZW5TaGFyaW5nLnNldEFjdGl2ZVNvdXJjZSgpOiByZWplY3RlZFwiKTtlKCl9KTpiP2MubG9jYWxfLmNvbnRhaW5zKGEpP2MubG9jYWxfLnNldEFjdGl2ZSghMCxhKS50aGVuKGZ1bmN0aW9uKGEpe2QoYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7ay5sb2dnZXIubG9nKFwiU2NyZWVuU2hhcmluZy5zZXRBY3RpdmVTb3VyY2UoKTogcmVqZWN0ZWRcIik7ZSgpfSk6KGsubG9nZ2VyLmxvZyhcIlNjcmVlblNoYXJpbmcuc2V0QWN0aXZlU291cmNlKCk6IGxlZ2FjeSBzY3JlZW4gc2hhcmluZ1wiKSxkKFwiXCIpKTooay5sb2dnZXIubG9nKFwiU2NyZWVuU2hhcmluZy5zZXRBY3RpdmVTb3VyY2UoKTogbGVnYWN5IHNjcmVlbiBzaGFyaW5nXCIpLFxyXG5kKFwiXCIpKX0pfTthLnByb3RvdHlwZS5pc0FwcHNoYXJlQWN0aXZlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubG9jYWxfJiYtMSE9PXRoaXMubG9jYWxfLmxhc3RBY3RpdmV9O2EucHJvdG90eXBlLnN0b3BBcHBzaGFyZT1mdW5jdGlvbigpe2subG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5zdG9wQXBwc2hhcmUoKSBjYWxsZWQuXCIpO3RoaXMubG9jYWxfJiZ0aGlzLmxvY2FsXy5zZXRBY3RpdmUoITEpLnRoZW4oZnVuY3Rpb24oYSl7ay5sb2dnZXIubG9nKFwiU2NyZWVuU2hhcmluZy5zdG9wQXBwc2hhcmUoKTogc3VjY2VzcywgZGV2aWNlaWQ9XCIsYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7ay5sb2dnZXIubG9nKFwiU2NyZWVuU2hhcmluZy5zdG9wQXBwc2hhcmUoKTogZmFpbHVyZSBvciB0aW1lb3V0IGR1ZSB0byBub25yZXNwb25zaXZlIFdTIEFnZW50XCIpfSl9O2EuaW5zdGFuY2U9bnVsbDtyZXR1cm4gYX0oKTthLlNjcmVlblNoYXJpbmc9Yjt2YXIgdD1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7dmFyIGM9XHJcbmEuY2FsbCh0aGlzLG51bGwsbi5jbGFzc19pZF90LlNjcmVlblNoYXJpbmdSZW1vdGUsMCxxLlByb3h5TW9kZS5Mb2NhbCl8fHRoaXM7ay5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1wiLmNvbnN0cnVjdG9yXCIpO2Muc291cmNlc189W107cmV0dXJuIGN9dyhiLGEpO2IucHJvdG90eXBlLmdldFNvdXJjZUJ5SWQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuc291cmNlc18uZmluZChmdW5jdGlvbihiKXtyZXR1cm4gYi5nZXRJZCgpPT1hfSl9O2IucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKGEpe3JldHVybiB2b2lkIDAhPT10aGlzLmdldFNvdXJjZUJ5SWQoYSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcIm9uc2NyZWVudG9wb2xvZ3ljaGFuZ2VkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9uc2NyZWVudG9wb2xvZ3ljaGFuZ2VkX30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7dGhpcy5vbnNjcmVlbnRvcG9sb2d5Y2hhbmdlZF89YTtcclxudGhpcy53YWl0VW50aWxDb25uZWN0ZWQodGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25zY3JlZW50b3BvbG9neWNoYW5nZWRcIikudGhlbihmdW5jdGlvbigpe3ZhciBhPWIucmVnaXN0ZXJDYWxsYmFja3MoITEsYi5pc051bGxDYWxsYmFjayhiLm9uc2NyZWVudG9wb2xvZ3ljaGFuZ2VkXyksbi5tZXRob2RfaWRfVkRJU2hhcmluZ1JlbW90ZV90Lm9uc2NyZWVudG9wb2xvZ3ljaGFuZ2VkKTthLnRoZW4oZnVuY3Rpb24oKXtrLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCJvbnNjcmVlbnRvcG9sb2d5Y2hhbmdlZCBldmVudCByZWNlaXZlZCEhIVwiKTtiLm9uc2NyZWVudG9wb2xvZ3ljaGFuZ2VkXyYmYi5vbnNjcmVlbnRvcG9sb2d5Y2hhbmdlZF8oKX0pO3JldHVybiBiLnJlbW90ZUludm9rZSghMCxuLm1ldGhvZF9pZF9WRElTaGFyaW5nUmVtb3RlX3Qub25zY3JlZW50b3BvbG9neWNoYW5nZWQsYS5zdWNjZXNzKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFxyXG5cIi5zZXRfb25zY3JlZW50b3BvbG9neWNoYW5nZWQoKSBmYWlsZWQhXCIpfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUuZ2V0U2NyZWVuc0FzeW5jPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztrLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0U2NyZWVuc0FzeW5jKCkgY2FsbGVkLlwiKTt2YXIgYj10aGlzLnNvdXJjZXNfO3RoaXMuc291cmNlc189W107dmFyIGM9cC5nZXRSZWRpcmVjdG9yKCkudmRhYnVmZmVyTm9MaW1pdCgpJiZnLlJlbW90ZVNlc3Npb24uaXNGZWF0dXJlVmROb0J1ZmZlckxpbWl0U3VwcG9ydGVkKCk7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGQsZyl7YS53YWl0VW50aWxDb25uZWN0ZWQoYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0U2NyZWVuc0FzeW5jXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYS5yZW1vdGVJbnZva2UoITEsbi5tZXRob2RfaWRfVkRJU2hhcmluZ1JlbW90ZV90LmdldFNjcmVlbnNBc3luYyxcclxuYyl9KS50aGVuKGZ1bmN0aW9uKGMpe3ZhciBoPVtdO2MucGFyYW1zWzBdLmZvckVhY2goZnVuY3Rpb24oYyl7dmFyIGQ9Yi5maW5kKGZ1bmN0aW9uKGEpe3JldHVybiBhLm9iamVjdF9pZCgpPT09Yy5vaWR9KTt2b2lkIDA9PT1kJiYoay5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiIGNyZWF0ZSBhIFNjcmVlblNvdXJjZSB3aXRoIG9pZDpcIitjLm9pZCksZD1uZXcgeShhLGMub2lkLHEuUHJveHlNb2RlLlJlbW90ZSkpO2gucHVzaChkLnN5bmNCYXJyaWVyKCkpfSk7UHJvbWlzZS5hbGwoaC5tYXAoZnVuY3Rpb24oYSl7cmV0dXJuIGEudGhlbihmdW5jdGlvbihhKXtyZXR1cm57dmFsdWU6YSxzdGF0dXM6XCJmdWxmaWxsZWRcIn19LGZ1bmN0aW9uKGEpe3JldHVybnt2YWx1ZTphLHN0YXR1czpcInJlamVjdGVkXCJ9fSl9KSkudGhlbihmdW5jdGlvbihjKXt2YXIgZz1jLmZpbHRlcihmdW5jdGlvbihhKXtyZXR1cm5cImZ1bGZpbGxlZFwiPT09YS5zdGF0dXN9KS5tYXAoZnVuY3Rpb24oYSl7cmV0dXJuIGEudmFsdWV9KTtcclxuYS5zb3VyY2VzXz1nO2IuZmlsdGVyKGZ1bmN0aW9uKGEpe3JldHVybiFlKGcsYSl9KS5mb3JFYWNoKGZ1bmN0aW9uKGEpe3JldHVybiBhLnJlbGVhc2UoKX0pO2QoZyl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGMpe2M9YS5sb2dSZW1vdGVJbnZva2VFcnJvcihjLFwiLmdldFNjcmVlbnNBc3luYygpIGZhaWxlZCFcIik7Yi5mb3JFYWNoKGZ1bmN0aW9uKGEpe2EucmVsZWFzZSgpfSk7ZyhjKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihjKXtjPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYyxcIi5nZXRTY3JlZW5zQXN5bmMoKSBmYWlsZWQhXCIpO2IuZm9yRWFjaChmdW5jdGlvbihhKXthLnJlbGVhc2UoKX0pO2coYyl9KX0pfTtiLnByb3RvdHlwZS5zZXRBY3RpdmU9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztrLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0QWN0aXZlKCkgY2FsbGVkLiB1bmlxdWVpZD1cIithKTtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxkKXstMSE9YT9cclxuYyhiLmdldFNvdXJjZUJ5SWQoYSkuZ2V0RGV2aWNlSWQoKSk6ZCgpfSl9O3JldHVybiBifShxLlByb3h5T2JqZWN0KTthLlNjcmVlblNoYXJpbmdSZW1vdGU9dDt2YXIgbT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXtrLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY29uc3RydWN0b3JcIik7dGhpcy5zb3VyY2VzXz1bXTt0aGlzLmxhc3RhY3RpdmVfPS0xfWEucHJvdG90eXBlLnVzZXJfZnJpZW5kbHlfaWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5uYW1lK1wiW11cIn07T2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwib25zY3JlZW50b3BvbG9neWNoYW5nZWRcIix7c2V0OmZ1bmN0aW9uKGEpe3AuZ2V0UmVkaXJlY3RvcigpLnNjcmVlbnNoYXJlLnNldFRvcG9sb2d5Q2hhbmdlQ0IoYSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwibGFzdEFjdGl2ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYXN0YWN0aXZlX30sXHJcbmVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7YS5wcm90b3R5cGUuZ2V0U291cmNlQnlJZD1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5zb3VyY2VzXy5maW5kKGZ1bmN0aW9uKGIpe3JldHVybiBiLmdldElkKCk9PWF9KX07YS5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oYSl7cmV0dXJuIHZvaWQgMCE9PXRoaXMuZ2V0U291cmNlQnlJZChhKX07YS5wcm90b3R5cGUuZ2V0V2luZG93c0FzeW5jPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztrLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0V2luZG93c0FzeW5jKCkgY2FsbGVkLlwiKTt2YXIgYj10aGlzLnNvdXJjZXNfO3RoaXMuc291cmNlc189W107cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsZCl7cC5nZXRSZWRpcmVjdG9yKCkuc2NyZWVuc2hhcmUuZ2V0U291cmNlcyhuZXcgei5nZXRTb3VyY2VzUmVxRGF0YSgyKSkudGhlbihmdW5jdGlvbihkKXtkPWQubWFwKGZ1bmN0aW9uKGMpe3ZhciBkPVxyXG5iLmZpbmQoZnVuY3Rpb24oYSl7cmV0dXJuIGEuZXF1aXZhbGVudChjKX0pO3JldHVybiB2b2lkIDAhPT1kPyhkLnNldERlc2NyaXB0aW9uKGMuZ2V0RGVzY3JpcHRpb24oKSksYy5nZXRJY29uKCkudGhlbihmdW5jdGlvbihhKXtkLnNldEljb24oYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7ay5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldFdpbmRvd3NBc3luYygpIGZhaWxlZCB0byByZXRyaWV2ZSBuZXcgaWNvbi5cIil9KSxjLmdldFByZXZpZXdBc3luYygpLnRoZW4oZnVuY3Rpb24oYSl7ZC5zZXRQcmV2aWV3KGEpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2subG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRXaW5kb3dzQXN5bmMoKSBmYWlsZWQgdG8gcmV0cmlldmUgbmV3IHByZXZpZXcuXCIpfSksZCk6Y30pO2lmKC0xIT1hLmxhc3RhY3RpdmVfKXt2YXIgZT1iLmZpbmQoZnVuY3Rpb24oYil7cmV0dXJuIGIuZ2V0SWQoKT09YS5sYXN0YWN0aXZlX30pLFxyXG5nPWQuZmluZChmdW5jdGlvbihiKXtyZXR1cm4gYi5nZXRJZCgpPT1hLmxhc3RhY3RpdmVffSk7dm9pZCAwIT09ZSYmdm9pZCAwPT09ZyYmZC5wdXNoKGUpfWEuc291cmNlc189ZDtjKGEuc291cmNlc18pfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2subG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRXaW5kb3dzQXN5bmMoKTogcmVqZWN0ZWRcIik7ZCgpfSl9KX07YS5wcm90b3R5cGUuYWN0aXZhdGVTb3VyY2U9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihkLGUpe3ZhciBnPWI/XCJhY3RpdmF0ZVwiOlwiZGVhY3RpdmF0ZVwiO2subG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5hY3RpdmF0ZVNvdXJjZSgpIGNhbGxlZC4gYWN0aW9uPVwiK2cpO3ZhciBoPW5ldyB6LnNldEFjdGl2ZVJlcURhdGEoYS5zcmNpZCxhLmh3bmQsYS5vcmlnaW4sYS5waWQsITAsITAsYik7cC5nZXRSZWRpcmVjdG9yKCkuc2NyZWVuc2hhcmUuc2V0QWN0aXZlKGgpLnRoZW4oZnVuY3Rpb24oYil7ay5sb2dnZXIubG9nKGMudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIjogXCIrZytcIiBzdWNjZXNzOiBzcmNpZD1cIitiLnNyY2lkK1wiIGRldmljZWlkPVwiK2IuYnVmZmVyaWQpO2EuZGV2aWNlaWQ9Yi5idWZmZXJpZDtkKGIuYnVmZmVyaWQpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2subG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcImZhaWxlZCB0byBcIitnK1wiOiBzcmNpZD1cIithLnNyY2lkK1wiLCBtYXliZSBXUyBBZ2VudCBpcyB0b28gc2xvdyB0byByZXNwb25kXCIpO2UoKX0pfSl9O2EucHJvdG90eXBlLnNldEFjdGl2ZT1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXM7ay5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldEFjdGl2ZSgpIGNhbGxlZC4gdW5pcXVlaWQ9XCIrYik7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGQsZSl7YXx8KGI9Yy5sYXN0YWN0aXZlXyk7LTEhPWI/KGE/KGIhPWMubGFzdGFjdGl2ZV8mJi0xIT1jLmxhc3RhY3RpdmVfJiZjLmFjdGl2YXRlU291cmNlKGMuZ2V0U291cmNlQnlJZChjLmxhc3RhY3RpdmVfKSxcclxuITEpLGMubGFzdGFjdGl2ZV89Yik6Yy5sYXN0YWN0aXZlXz0tMSxjLmFjdGl2YXRlU291cmNlKGMuZ2V0U291cmNlQnlJZChiKSxhKS50aGVuKGZ1bmN0aW9uKGIpe2QoYT9cIlJlbW90ZUFwcGxpY2F0aW9uLVwiK2I6Yil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7ZSgpfSkpOmUoKX0pfTtyZXR1cm4gYX0oKTthLlNjcmVlblNoYXJpbmdWZGE9bTt2YXIgRD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt9YS5XaWR0aD0xNDA7YS5IZWlnaHQ9OTA7cmV0dXJuIGF9KCk7Yj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixjLGQsZSxnLGgsayxtLG4sbCl7dGhpcy51bmlxdWVpZF89eS5uZXh0SWRfKys7dGhpcy5zcmNpZF89Yjt0aGlzLmRldmljZWlkXz1jO3RoaXMudHlwZV89ZDt0aGlzLmltYWdlZGF0YV89ZTt0aGlzLmljb25fPWc7dGhpcy5uYW1lXz1oO3RoaXMuaHduZF89azt0aGlzLm9yaWdpbl89bTt0aGlzLmNhcHRpb25fPW47dGhpcy5waWRfPWx9YS5wcm90b3R5cGUudXNlcl9mcmllbmRseV9pZD1cclxuZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5uYW1lK1wiW1wiK3RoaXMudW5pcXVlaWRfK1wiXVwifTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYS5wcm90b3R5cGUsXCJzcmNpZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zcmNpZF99LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwiaHduZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5od25kX30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYS5wcm90b3R5cGUsXCJvcmlnaW5cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3JpZ2luX30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYS5wcm90b3R5cGUsXCJwaWRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGlkX30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTthLnByb3RvdHlwZS5nZXRJZD1cclxuZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51bmlxdWVpZF99O2EucHJvdG90eXBlLmdldERldmljZUlkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGV2aWNlaWRffTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYS5wcm90b3R5cGUsXCJkZXZpY2VpZFwiLHtzZXQ6ZnVuY3Rpb24oYSl7dGhpcy5kZXZpY2VpZF89YX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTthLnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKCl7cmV0dXJuIDJ9O2EucHJvdG90eXBlLmdldFByZXZpZXc9ZnVuY3Rpb24oYSxiLGMpe2subG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRQcmV2aWV3KCkgY2FsbGVkLCB3aWR0aDpcIithK1wiIGhlaWdodDpcIitiK1wiIGFzSW1hZ2U6XCIrYyk7cmV0dXJuIFByb21pc2UucmVqZWN0KG51bGwpfTthLnByb3RvdHlwZS5zZXRQcmV2aWV3PWZ1bmN0aW9uKGEpe3RoaXMuaW1hZ2VkYXRhXz1hfTthLnByb3RvdHlwZS5nZXRQcmV2aWV3QXN5bmM9ZnVuY3Rpb24oYSxcclxuYixjKXtrLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0UHJldmlld0FzeW5jKCkgY2FsbGVkLCB3aWR0aDpcIithK1wiIGhlaWdodDpcIitiKTtyZXR1cm4hMD09PWM/KGE9aCh0aGlzLmltYWdlZGF0YV8sRC5XaWR0aCxELkhlaWdodCksUHJvbWlzZS5yZXNvbHZlKHtkYXRhOmEuc3JjLnJlcGxhY2UoL15kYXRhOmltYWdlXFwvKHBuZ3xqcGcpO2Jhc2U2NCwvLFwiXCIpfSkpOlByb21pc2UucmVzb2x2ZSh0aGlzLmltYWdlZGF0YV8pfTthLnByb3RvdHlwZS5nZXRQcmV2aWV3SW1hZ2U9ZnVuY3Rpb24oYSxiLGMpe2subG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRQcmV2aWV3SW1hZ2UoKSBjYWxsZWQsIHdpZHRoOlwiK2IrXCIgaGVpZ2h0OlwiK2MpO3JldHVybiBQcm9taXNlLnJlc29sdmUoZCh0aGlzLmltYWdlZGF0YV8sYSxiLGMpKX07YS5wcm90b3R5cGUuZ2V0RGVzY3JpcHRpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uYW1lX307YS5wcm90b3R5cGUuc2V0RGVzY3JpcHRpb249XHJcbmZ1bmN0aW9uKGEpe3RoaXMubmFtZV89YX07YS5wcm90b3R5cGUuZ2V0SWNvbj1mdW5jdGlvbihhLGIsYyl7cmV0dXJuITA9PT1jPyhhPWgodGhpcy5pY29uXyxELldpZHRoLEQuSGVpZ2h0KSxQcm9taXNlLnJlc29sdmUoe2RhdGE6YS5zcmMucmVwbGFjZSgvXmRhdGE6aW1hZ2VcXC8ocG5nfGpwZyk7YmFzZTY0LC8sXCJcIil9KSk6UHJvbWlzZS5yZXNvbHZlKHRoaXMuaWNvbl8pfTthLnByb3RvdHlwZS5nZXRJY29uSW1hZ2U9ZnVuY3Rpb24oYSxiLGMpe2subG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRJY29uSW1hZ2UoKSBjYWxsZWQsIHdpZHRoOlwiK2IrXCIgaGVpZ2h0OlwiK2MpO3JldHVybiBQcm9taXNlLnJlc29sdmUoZCh0aGlzLmljb25fLGEsXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBiP2I6dGhpcy5pY29uXy53aWR0aCxcInVuZGVmaW5lZFwiIT09dHlwZW9mIGM/Yzp0aGlzLmljb25fLmhlaWdodCkpfTthLnByb3RvdHlwZS5zZXRJY29uPWZ1bmN0aW9uKGEpe3RoaXMuaWNvbl89XHJcbmF9O2EucHJvdG90eXBlLmdldEJvdW5kcz1mdW5jdGlvbigpe3JldHVybnt4OjAseTowLHdpZHRoOjAsaGVpZ2h0OjB9fTthLnByb3RvdHlwZS5lcXVpdmFsZW50PWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnBpZF89PT1hLnBpZF8mJnRoaXMuaHduZF89PT1hLmh3bmRffTtyZXR1cm4gYX0oKTthLlNjcmVlblNvdXJjZVZkYT1iO3ZhciB5PWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYyxkLGUpe2M9YS5jYWxsKHRoaXMsYyxuLmNsYXNzX2lkX3QuU2NyZWVuU291cmNlLGQsZSl8fHRoaXM7Yy5zY3JlZW5zaGFyZV89bmV3IHouU2NyZWVuU2hhcmVVdGlsO2MudW5pcXVlaWRfPWIubmV4dElkXysrO2subG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5jb25zdHJ1Y3RvclwiKTtyZXR1cm4gY313KGIsYSk7Yi5wcm90b3R5cGUudXNlcl9mcmllbmRseV9pZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnN0cnVjdG9yLm5hbWUrXCJbXCIrdGhpcy51bmlxdWVpZF8rXCJdXCJ9O2IucHJvdG90eXBlLnRvSlNJbWFnZURhdGE9XHJcbmZ1bmN0aW9uKGEpe3ZhciBiPWF0b2IoYS5kYXRhLnRvU3RyaW5nKCkpLGI9dGhpcy5zY3JlZW5zaGFyZV8uc3RyMmFiKGIpLGI9bmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGIsMCxiLmJ5dGVMZW5ndGgpO3RoaXMuaW1hZ2VkYXRhXz1uZXcgSW1hZ2VEYXRhKGIsYS53aWR0aCxhLmhlaWdodCl9O2IucHJvdG90eXBlLnN5bmNCYXJyaWVyPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztrLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIoKSBjYWxsZWQuXCIpO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihiLGMpe2Euc3luY0JhcnJpZXJEZWVwKGIsYykmJmEud2FpdFVudGlsQ29ubmVjdGVkKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLnN5bmNCYXJyaWVyXCIpLnRoZW4oZnVuY3Rpb24oKXtQcm9taXNlLmFsbChbYS5yZW1vdGVJbnZva2UoITEsbi5tZXRob2RfaWRfU2NyZWVuU291cmNlX3Quc3JjaWQsMCksYS5yZW1vdGVJbnZva2UoITEsbi5tZXRob2RfaWRfU2NyZWVuU291cmNlX3QuZGV2aWNlaWQsXHJcblwiXCIpLGEucmVtb3RlSW52b2tlKCExLG4ubWV0aG9kX2lkX1NjcmVlblNvdXJjZV90LnR5cGUsMCksYS5yZW1vdGVJbnZva2UoITEsbi5tZXRob2RfaWRfU2NyZWVuU291cmNlX3QubmFtZSxcIlwiKSxhLnJlbW90ZUludm9rZSghMSxuLm1ldGhvZF9pZF9TY3JlZW5Tb3VyY2VfdC5pbWFnZWRhdGEpLGEucmVtb3RlSW52b2tlKCExLG4ubWV0aG9kX2lkX1NjcmVlblNvdXJjZV90Lmh3bmQsXCJcIiksYS5yZW1vdGVJbnZva2UoITEsbi5tZXRob2RfaWRfU2NyZWVuU291cmNlX3Qub3JpZ2luLDApLGEucmVtb3RlSW52b2tlKCExLG4ubWV0aG9kX2lkX1NjcmVlblNvdXJjZV90LmNhcHRpb24sXCJcIiksYS5yZW1vdGVJbnZva2UoITEsbi5tZXRob2RfaWRfU2NyZWVuU291cmNlX3QucGlkLDApXSkudGhlbihmdW5jdGlvbihiKXtrLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc3luY0JhcnJpZXIoKTogc3VjY2Vzcy5cIik7dmFyIGM7Yj1iLm1hcChmdW5jdGlvbihiKXtyZXR1cm4gYS5wYXJhbTAoYil9KTtcclxuYS5zcmNpZF89YlswXTthLmRldmljZWlkXz1iWzFdO2EudHlwZV89YlsyXTthLm5hbWVfPWJbM107Yz1iWzRdO2EuaHduZF89Yls1XTthLm9yaWdpbl89Yls2XTthLmNhcHRpb25fPWJbN107YS5waWRfPWJbOF07YS50b0pTSW1hZ2VEYXRhKGMpO2EucmVtb3RlSW52b2tlKCExLG4ubWV0aG9kX2lkX1NjcmVlblNvdXJjZV90LmJvdW5kcywwKS50aGVuKGZ1bmN0aW9uKGIpe2EuYm91bmRzXz1hLnBhcmFtMChiKTthLnN5bmNCYXJyaWVyUmVzb2x2ZShhKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYil7YS5ib3VuZHNfPXZvaWQgMDtiPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5wcm9wLnN5bmNCYXJyaWVyKCkgZ2V0Qm91bmRzIGZhaWxlZC5cIik7YS5zeW5jQmFycmllclJlamVjdChiKX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbihiKXtiPWEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5wcm9wLnN5bmNCYXJyaWVyKCkgZmFpbGVkLlwiKTthLnN5bmNCYXJyaWVyUmVqZWN0KGIpfSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2I9XHJcbmEubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5zeW5jQmFycmllcigpIGZhaWxlZC5cIik7YS5zeW5jQmFycmllclJlamVjdChiKX0pfSl9O2IucHJvdG90eXBlLmdldElkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudW5pcXVlaWRffTtiLnByb3RvdHlwZS5nZXREZXZpY2VJZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRldmljZWlkX307Yi5wcm90b3R5cGUuZ2V0VHlwZT1mdW5jdGlvbigpe3JldHVybiAxfTtiLnByb3RvdHlwZS5nZXRQcmV2aWV3PWZ1bmN0aW9uKGEsYixjKXtrLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0UHJldmlldygpIGNhbGxlZCwgd2lkdGg6XCIrYStcIiBoZWlnaHQ6XCIrYitcIiBhc0ltYWdlOlwiK2MpO3JldHVybiBQcm9taXNlLnJlamVjdChudWxsKX07Yi5wcm90b3R5cGUuZ2V0UHJldmlld0FzeW5jPWZ1bmN0aW9uKGEsYixjKXtrLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0UHJldmlld0FzeW5jKCkgY2FsbGVkLCB3aWR0aDpcIitcclxuYStcIiBoZWlnaHQ6XCIrYik7cmV0dXJuITA9PT1jPyhhPWgodGhpcy5pbWFnZWRhdGFfLEQuV2lkdGgsRC5IZWlnaHQpLFByb21pc2UucmVzb2x2ZSh7ZGF0YTphLnNyYy5yZXBsYWNlKC9eZGF0YTppbWFnZVxcLyhwbmd8anBnKTtiYXNlNjQsLyxcIlwiKX0pKTpQcm9taXNlLnJlc29sdmUodGhpcy5pbWFnZWRhdGFfKX07Yi5wcm90b3R5cGUuZ2V0UHJldmlld0ltYWdlPWZ1bmN0aW9uKGEsYixjKXtrLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0UHJldmlld0ltYWdlKCkgY2FsbGVkLCB3aWR0aDpcIitiK1wiIGhlaWdodDpcIitjKTtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGQodGhpcy5pbWFnZWRhdGFfLGEsYixjKSl9O2IucHJvdG90eXBlLmdldERlc2NyaXB0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmFtZV99O2IucHJvdG90eXBlLmdldEljb249ZnVuY3Rpb24oYSxiKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuaW1hZ2VkYXRhXyl9O2IucHJvdG90eXBlLmdldEJvdW5kcz1cclxuZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ib3VuZHNffHx7eDowLHk6MCx3aWR0aDowLGhlaWdodDowfX07Yi5uZXh0SWRfPUIuTW9uaXRvcnNBbmRBcHBzO3JldHVybiBifShxLlByb3h5T2JqZWN0KTthLlNjcmVlblNvdXJjZT15fSw2OTE6ZnVuY3Rpb24oYixhLGMpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO2EuU2NyZWVuU2hhcmVVdGlsPWEuQml0bWFwPWEuQml0bWFwSW5mb0hlYWRlcj1hLkJpdG1hcEZpbGVIZWFkZXI9YS5zZXRBY3RpdmVSZXNwRGF0YT1hLnNldEFjdGl2ZVJlcURhdGE9YS5nZXRTb3VyY2VzUmVxRGF0YT1hLnNzaGFyZV9zdGF0ZT1hLnNzaGFyZV9jbWQ9dm9pZCAwO3ZhciBlPWMoOTQ2KSxsPWMoOTczKSxoPWMoODUxKSxkOyhmdW5jdGlvbihhKXthW2EuVW5rbm93bj0wXT1cIlVua25vd25cIjthW2EuQ2FwPTFdPVwiQ2FwXCI7YVthLkdldFNvdXJjZXM9Ml09XCJHZXRTb3VyY2VzXCI7YVthLlNldEFjdGl2ZT0zXT1cIlNldEFjdGl2ZVwiO1xyXG5hW2EuVG9wb2xvZ3lDaGFuZ2VkPTRdPVwiVG9wb2xvZ3lDaGFuZ2VkXCJ9KShkPWEuc3NoYXJlX2NtZHx8KGEuc3NoYXJlX2NtZD17fSkpO3ZhciB3OyhmdW5jdGlvbihhKXthW2EuVW5rbm93bj0wXT1cIlVua25vd25cIjthW2EuSW5pdGlhbGl6ZWQ9MV09XCJJbml0aWFsaXplZFwiO2FbYS5FcnJvcj0yXT1cIkVycm9yXCJ9KSh3PWEuc3NoYXJlX3N0YXRlfHwoYS5zc2hhcmVfc3RhdGU9e30pKTtiPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEpe3RoaXMub3JpZ2luPWF9fSgpO2EuZ2V0U291cmNlc1JlcURhdGE9YjtiPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYixjLGQsZSxoLGspe3RoaXMuc3JjaWQ9YTt0aGlzLmh3bmQ9Yjt0aGlzLm9yaWdpbj1jO3RoaXMucGlkPWQ7dGhpcy5ib3JkZXI9ZTt0aGlzLmN1cnNvcj1oO3RoaXMuYWN0aXZhdGU9a319KCk7YS5zZXRBY3RpdmVSZXFEYXRhPWI7dmFyIHE9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiLGMpe3RoaXMuc3JjaWQ9XHJcbmE7dGhpcy5vcmlnaW49Yjt0aGlzLmJ1ZmZlcmlkPWN9fSgpO2Euc2V0QWN0aXZlUmVzcERhdGE9cTt2YXIgbj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixjLGQsZSxnKXt0aGlzLmlkXz1iO3RoaXMucmVzb2x2ZV89Yzt0aGlzLnJlamVjdF89ZDt0aGlzLmNtZF89ZTt0aGlzLmRhdGFfPWc7dGhpcy5zZW50Xz0hMTt0aGlzLnRpbWVvdXRJZD12b2lkIDB9YS5wcm90b3R5cGUudXNlcl9mcmllbmRseV9pZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnN0cnVjdG9yLm5hbWUrXCJbXCIrdGhpcy5pZF8rXCJdXCJ9O2EucHJvdG90eXBlLmNtZFN0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNtZF89PWQuQ2FwP1wiQ2FwXCI6dGhpcy5jbWRfPT1kLkdldFNvdXJjZXM/XCJHZXRTb3VyY2VzXCI6dGhpcy5jbWRfPT1kLlNldEFjdGl2ZT9cIlNldEFjdGl2ZVwiOlwiVW5rbm93blwifTtyZXR1cm4gYX0oKSxrPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7fX0oKTthLkJpdG1hcEZpbGVIZWFkZXI9aztcclxudmFyIHA9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oKXt9fSgpO2EuQml0bWFwSW5mb0hlYWRlcj1wO3ZhciB6PWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7fX0oKTthLkJpdG1hcD16O2I9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7dGhpcy5jbWRxdWVfPVtdfWEucHJvdG90eXBlLnJlcWlkPWZ1bmN0aW9uKCl7cmV0dXJuIGEubmV4dElkKyt9O2EucHJvdG90eXBlLnVzZXJfZnJpZW5kbHlfaWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5uYW1lK1wiW11cIn07YS5wcm90b3R5cGUuc3RhdGVTdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gYS5zdGF0ZV89PXcuSW5pdGlhbGl6ZWQ/XCJJbml0aWFsaXplZFwiOmEuc3RhdGVfPT13LkVycm9yP1wiRXJyb3JcIjpcIlVua25vd25cIn07YS5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXthLnN0YXRlXz13LlVua25vd247dGhpcy5jbWRxdWVfPVtdfTthLnByb3RvdHlwZS5kaXNwYXRjaENtZHM9ZnVuY3Rpb24oKXt2YXIgYj1cclxudGhpczthLnN0YXRlXz09dy5Jbml0aWFsaXplZD90aGlzLmNtZHF1ZV8uZm9yRWFjaChmdW5jdGlvbihhKXswPT1hLnNlbnRfJiYoYS5jbWRfPT1kLkdldFNvdXJjZXM/KGIuV1NTZW5kR2V0U291cmNlcyhhLmlkXyxhLmRhdGFfKSxhLnNlbnRfPSEwLGEudGltZW91dElkPXNldFRpbWVvdXQoYi5hYm9ydENtZC5iaW5kKGIsYS5pZF8pLDVFMykpOmEuY21kXz09ZC5TZXRBY3RpdmU/KGIuV1NTZW5kU2V0QWN0aXZlKGEuaWRfLGEuZGF0YV8pLGEuc2VudF89ITAsYS50aW1lb3V0SWQ9c2V0VGltZW91dChiLmFib3J0Q21kLmJpbmQoYixhLmlkXyksNUUzKSk6aC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmRpc3BhdGNoQ21kcygpOiBpbnZhbGlkIGNtZDogXCIrYS5jbWRTdHJpbmcoKSkpfSk6YS5zdGF0ZV89PXcuRXJyb3I/KHRoaXMuY21kcXVlXy5mb3JFYWNoKGZ1bmN0aW9uKGEpe2gubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5kaXNwYXRjaENtZHMoKTogcHVyZ2luZyBjbWQ6IFwiK1xyXG5hLmNtZFN0cmluZygpKTthLnJlamVjdF8oKX0pLHRoaXMuY21kcXVlXz1bXSk6aC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLmRpc3BhdGNoQ21kcygpOiBpbnZhbGlkIHN0YXRlOiBcIit0aGlzLnN0YXRlU3RyaW5nKCkpfTthLnByb3RvdHlwZS5hYm9ydENtZD1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmNtZHF1ZV8uZmluZEluZGV4KGZ1bmN0aW9uKGIpe3JldHVybiBiLmlkXz09PWF9KTstMSE9PWI/KGI9dGhpcy5jbWRxdWVfLnNwbGljZShiLDEpWzBdLGgubG9nZ2VyLmxvZyhiLnVzZXJfZnJpZW5kbHlfaWQoKStOYU4rYi5jbWRTdHJpbmcoKStcIl06IGFib3J0ZWQgZHVlIHRvIG5vbnJlc3BvbnNpdmUgV1MgQWdlbnQhXCIpLGIuY21kXz09PWQuU2V0QWN0aXZlJiZiLmRhdGFfLmFjdGl2YXRlJiZsLlNjcmVlblNoYXJpbmcuc2NyZWVuU2hhcmluZ0luc3RhbmNlKCkuc3RvcEFwcHNoYXJlKCksYi5yZWplY3RfKCkpOmgubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcclxuXCIuYWJvcnRDbWQoKTogQ21kIG5vdCBmb3VuZCFcIil9O2EucHJvdG90eXBlLmZpbmFsaXplQ21kPWZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9MDtkPHRoaXMuY21kcXVlXy5sZW5ndGg7ZCsrKXt2YXIgZT10aGlzLmNtZHF1ZV9bZF07aWYodm9pZCAwIT1iJiZiPT1lLmlkXyYmMT09ZS5zZW50X3x8dm9pZCAwPT1iJiYxPT1lLnNlbnRfKXtjbGVhclRpbWVvdXQoZS50aW1lb3V0SWQpO2gubG9nZ2VyLmxvZyhlLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5maW5hbGl6ZUNtZCgpOiBwdXJnaW5nIGNtZDogXCIrZS5jbWRTdHJpbmcoKSk7YT92b2lkIDAhPWM/ZS5yZXNvbHZlXyhjKTplLnJlc29sdmVfKCk6ZS5yZWplY3RfKCk7dGhpcy5jbWRxdWVfLnNwbGljZShkLDEpO2JyZWFrfX19O2EucHJvdG90eXBlLm9uSW5pdGlhbGl6ZWQ9ZnVuY3Rpb24oYil7aC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLm9uSW5pdGlhbGl6ZWQoKTogaW5pdDogXCIrYitcIiBzdGF0ZTpcIit0aGlzLnN0YXRlU3RyaW5nKCkpO1xyXG5hLnN0YXRlXyE9dy5Jbml0aWFsaXplZCYmKGEuc3RhdGVfPWI/dy5Jbml0aWFsaXplZDp3LkVycm9yKTt0aGlzLmRpc3BhdGNoQ21kcygpfTthLnByb3RvdHlwZS5vbkluaXRDb21wbGV0ZT1mdW5jdGlvbigpe2gubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbkluaXRDb21wbGV0ZSgpOiBzdGF0ZTpcIit0aGlzLnN0YXRlU3RyaW5nKCkpO2Euc3RhdGVfPT13LlVua25vd24mJihhLnN0YXRlXz13LkVycm9yLGgubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbkluaXRDb21wbGV0ZSgpOiBpdGVtcyBpbiBxdWV1ZTpcIit0aGlzLmNtZHF1ZV8ubGVuZ3RoKSx0aGlzLmRpc3BhdGNoQ21kcygpKX07YS5wcm90b3R5cGUub25FcnJvcj1mdW5jdGlvbihiKXtoLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub25FcnJvcigpOiBzdGF0ZTogXCIrdGhpcy5zdGF0ZVN0cmluZygpKTthLnN0YXRlXz09dy5Vbmtub3duPyhhLnN0YXRlXz1cclxudy5FcnJvcix0aGlzLmRpc3BhdGNoQ21kcygpKTphLnN0YXRlXz09dy5Jbml0aWFsaXplZCYmdGhpcy5maW5hbGl6ZUNtZCghMSxiKX07YS5wcm90b3R5cGUuYWIyc3RyPWZ1bmN0aW9uKGEpe3JldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsbmV3IFVpbnQ4QXJyYXkoYSkpfTthLnByb3RvdHlwZS5zdHIyYWI9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPW5ldyBBcnJheUJ1ZmZlcihhLmxlbmd0aCksYz1uZXcgVWludDhBcnJheShiKSxkPTAsZT1hLmxlbmd0aDtkPGU7ZCsrKWNbZF09YS5jaGFyQ29kZUF0KGQpO3JldHVybiBifTthLnByb3RvdHlwZS5nZXRCTVA9ZnVuY3Rpb24oYSl7dmFyIGI9bmV3IERhdGFWaWV3KGEpLGM9bmV3IHo7Yy5maWxlaGVhZGVyPW5ldyBrO2MuZmlsZWhlYWRlci5iZlR5cGU9Yi5nZXRVaW50MTYoMCwhMCk7Yy5maWxlaGVhZGVyLmJmU2l6ZT1iLmdldFVpbnQzMigyLCEwKTtjLmZpbGVoZWFkZXIuYmZSZXNlcnZlZDE9Yi5nZXRVaW50MTYoNixcclxuITApO2MuZmlsZWhlYWRlci5iZlJlc2VydmVkMj1iLmdldFVpbnQxNig4LCEwKTtjLmZpbGVoZWFkZXIuYmZPZmZCaXRzPWIuZ2V0VWludDMyKDEwLCEwKTtjLmluZm9oZWFkZXI9bmV3IHA7Yy5pbmZvaGVhZGVyLmJpU2l6ZT1iLmdldFVpbnQzMigxNCwhMCk7Yy5pbmZvaGVhZGVyLmJpV2lkdGg9Yi5nZXRVaW50MzIoMTgsITApO2MuaW5mb2hlYWRlci5iaUhlaWdodD1iLmdldFVpbnQzMigyMiwhMCk7Yy5pbmZvaGVhZGVyLmJpUGxhbmVzPWIuZ2V0VWludDE2KDI2LCEwKTtjLmluZm9oZWFkZXIuYmlCaXRDb3VudD1iLmdldFVpbnQxNigyOCwhMCk7Yy5pbmZvaGVhZGVyLmJpQ29tcHJlc3Npb249Yi5nZXRVaW50MzIoMzAsITApO2MuaW5mb2hlYWRlci5iaVNpemVJbWFnZT1iLmdldFVpbnQzMigzNCwhMCk7Yy5pbmZvaGVhZGVyLmJpWFBlbHNQZXJNZXRlcj1iLmdldFVpbnQzMigzOCwhMCk7Yy5pbmZvaGVhZGVyLmJpWVBlbHNQZXJNZXRlcj1iLmdldFVpbnQzMig0MiwhMCk7Yy5pbmZvaGVhZGVyLmJpQ2xyVXNlZD1cclxuYi5nZXRVaW50MzIoNDYsITApO2MuaW5mb2hlYWRlci5iaUNsckltcG9ydGFudD1iLmdldFVpbnQzMig1MCwhMCk7Yj1jLmZpbGVoZWFkZXIuYmZPZmZCaXRzO2Muc3RyaWRlPTQqTWF0aC5mbG9vcigoYy5pbmZvaGVhZGVyLmJpQml0Q291bnQqYy5pbmZvaGVhZGVyLmJpV2lkdGgrMzEpLzMyKTtjLnBpeGVscz1uZXcgVWludDhBcnJheShhLGIpO3JldHVybiBjfTthLnByb3RvdHlwZS5jb252ZXJ0VG9JbWFnZURhdGE9ZnVuY3Rpb24oYSl7dmFyIGI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKS5nZXRDb250ZXh0KFwiMmRcIiksYz1hLmluZm9oZWFkZXIuYmlXaWR0aCxkPWEuaW5mb2hlYWRlci5iaUhlaWdodCxiPWIuY3JlYXRlSW1hZ2VEYXRhKGMsZCksZT1iLmRhdGEsZz1hLnBpeGVsczthPWEuc3RyaWRlO2Zvcih2YXIgaD0wO2g8ZDsrK2gpZm9yKHZhciBrPTA7azxjOysrayl7dmFyIGw9NCooaytjKihkLWgpKSxuPTQqaythKmg7ZVtsXT1nW24rMl07ZVtsKzFdPWdbbitcclxuMV07ZVtsKzJdPWdbbl07ZVtsKzNdPTI1NX1yZXR1cm4gYn07YS5wcm90b3R5cGUub25HZXRTb3VyY2VzPWZ1bmN0aW9uKGEsYil7dGhpcy5zb3VyY2VzXz1bXTt2YXIgYz10aGlzO2Iuc291cmNlcy5mb3JFYWNoKGZ1bmN0aW9uKGEpe3ZhciBiPWEuaW1hZ2UsZD1hdG9iKGIuZGF0YSksZD1jLnN0cjJhYihkKSxkPW5ldyBVaW50OENsYW1wZWRBcnJheShkLDAsZC5ieXRlTGVuZ3RoKSxiPW5ldyBJbWFnZURhdGEoZCxiLndpZHRoLGIuaGVpZ2h0KSxkPWEuaWNvbixlPWF0b2IoZC5kYXRhKSxlPWMuc3RyMmFiKGUpLGU9bmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGUsMCxlLmJ5dGVMZW5ndGgpLGQ9bmV3IEltYWdlRGF0YShlLGQud2lkdGgsZC5oZWlnaHQpO2E9bmV3IGwuU2NyZWVuU291cmNlVmRhKGEuc3JjaWQsYS5kZXZpY2RpZCxhLnR5cGUsYixkLGEubmFtZSxhLmh3bmQsYS5vcmlnaW4sYS5jYXB0aW9uLGEucGlkKTtjLnNvdXJjZXNfLnB1c2goYSl9KTt0aGlzLmZpbmFsaXplQ21kKCEwLFxyXG5hLHRoaXMuc291cmNlc18pfTthLnByb3RvdHlwZS5nZXRTb3VyY2VzPWZ1bmN0aW9uKGIpe3ZhciBjPXRoaXM7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGUsaCl7aWYoYS5zdGF0ZV8hPXcuRXJyb3Ipe3ZhciBrPW5ldyBuKGMucmVxaWQoKSxlLGgsZC5HZXRTb3VyY2VzLGIpO2MuY21kcXVlXy5wdXNoKGspfWVsc2UgaCgpO2Euc3RhdGVfPT13LkluaXRpYWxpemVkJiZjLmRpc3BhdGNoQ21kcygpfSl9O2EucHJvdG90eXBlLm9uU2V0QWN0aXZlPWZ1bmN0aW9uKGEsYil7dmFyIGM9bmV3IHEoYi5zcmNpZCxiLm9yaWdpbixiLmJ1ZmZlcmlkKTt0aGlzLmZpbmFsaXplQ21kKCEwLGEsYyl9O2EucHJvdG90eXBlLnNldEFjdGl2ZT1mdW5jdGlvbihiKXt2YXIgYz10aGlzO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihlLGgpe2lmKGEuc3RhdGVfIT13LkVycm9yKXt2YXIgaz1uZXcgbihjLnJlcWlkKCksZSxoLGQuU2V0QWN0aXZlLGIpO2MuY21kcXVlXy5wdXNoKGspfWVsc2UgaCgpO1xyXG5hLnN0YXRlXz09dy5Jbml0aWFsaXplZCYmYy5kaXNwYXRjaENtZHMoKX0pfTthLnByb3RvdHlwZS5zZXRUb3BvbG9neUNoYW5nZUNCPWZ1bmN0aW9uKGEpe3RoaXMub253aW5kb3d0b3BvbG9neWNoYW5nZWRfPWF9O2EucHJvdG90eXBlLm9uVG9wbG9neUNoYW5nZWQ9ZnVuY3Rpb24oKXtpZih0aGlzLm9ud2luZG93dG9wb2xvZ3ljaGFuZ2VkXyl0aGlzLm9ud2luZG93dG9wb2xvZ3ljaGFuZ2VkXygpfTthLnByb3RvdHlwZS5XU1NlbmRHZXRTb3VyY2VzPWZ1bmN0aW9uKGEsYil7dHJ5e2UuZ2V0UmVkaXJlY3RvcigpLldTU2VuZE9iamVjdCh7djpcImFwcHNoYXJpbmdcIixoZHI6e2NvbW1hbmQ6ZC5HZXRTb3VyY2VzLGlkOmF9LGRhdGE6e29yaWdpbjpiLm9yaWdpbn19KX1jYXRjaChjKXtoLmxvZ2dlci5sb2coYyl9fTthLnByb3RvdHlwZS5XU1NlbmRTZXRBY3RpdmU9ZnVuY3Rpb24oYSxiKXt0cnl7ZS5nZXRSZWRpcmVjdG9yKCkuV1NTZW5kT2JqZWN0KHt2OlwiYXBwc2hhcmluZ1wiLGhkcjp7Y29tbWFuZDpkLlNldEFjdGl2ZSxcclxuaWQ6YX0sZGF0YTp7c3JjaWQ6Yi5zcmNpZCxod25kOmIuaHduZCxvcmlnaW46Yi5vcmlnaW4scGlkOmIucGlkLGJvcmRlcjpiLmJvcmRlcixjdXJzb3I6Yi5jdXJzb3IsYWN0aXZhdGU6Yi5hY3RpdmF0ZX19KX1jYXRjaChjKXtoLmxvZ2dlci5sb2coYyl9fTthLnN0YXRlXz13LlVua25vd247YS5uZXh0SWQ9MDtyZXR1cm4gYX0oKTthLlNjcmVlblNoYXJlVXRpbD1ifSw1MTc6ZnVuY3Rpb24oYixhKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTthLlN0YXRzPWEuU3RhdHNSZXBvcnQ9dm9pZCAwO3ZhciBjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe3RoaXMuaXRlbXM9W119YS5mcm9tSlNPTj1mdW5jdGlvbihiKXtmb3IodmFyIGM9bmV3IGEsbD0wO2w8Yi5sZW5ndGg7bCsrKXt2YXIgcT1lLmZyb21KU09OKGJbbF0pO2MuaXRlbXMucHVzaChxKX1yZXR1cm4gY307YS50b1JUQ1N0YXRzUmVwb3J0PWZ1bmN0aW9uKGEpe3JldHVybiBhfTthLnByb3RvdHlwZS50b0pTT049XHJcbmZ1bmN0aW9uKCl7cmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMuaXRlbXMpfTthLnByb3RvdHlwZS5yZXN1bHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVtc307cmV0dXJuIGF9KCk7YS5TdGF0c1JlcG9ydD1jO3ZhciBlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe3RoaXMubmFtZXNfPVtdO3RoaXMuc3RhdF89bmV3IE1hcDt0aGlzLmlkPVwiXCI7dGhpcy50aW1lc3RhbXA9MDt0aGlzLnR5cGU9XCJcIn1hLmZyb21KU09OPWZ1bmN0aW9uKGIpe3ZhciBjPW5ldyBhO2MuaWQ9Yi5pZHx8XCJcIjtjLnRpbWVzdGFtcD1iLnRpbWVzdGFtcHx8XCJcIjtjLnR5cGU9Yi50eXBlfHxcIlwiO09iamVjdC5rZXlzKGIpLmZvckVhY2goZnVuY3Rpb24oYSl7XCJpZFwiIT09YSYmXCJ0aW1lc3RhbXBcIiE9PWEmJlwidHlwZVwiIT09YSYmKGMubmFtZXNfLnB1c2goYSksYy5zdGF0Xy5zZXQoYSxiW2FdKSl9KTtyZXR1cm4gY307YS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIEpTT04uc3RyaW5naWZ5KHtpZDp0aGlzLmlkLFxyXG50aW1lc3RhbXA6dGhpcy50aW1lc3RhbXAsdHlwZTp0aGlzLnR5cGUsc3RhdDp0aGlzLnN0YXRffSl9O2EucHJvdG90eXBlLm5hbWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmFtZXNffTthLnByb3RvdHlwZS5zdGF0PWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnN0YXRfLmdldChhKX07cmV0dXJuIGF9KCk7YS5TdGF0cz1lfSw3MDQ6ZnVuY3Rpb24oYixhLGMpe3ZhciBlPXRoaXMmJnRoaXMuX19leHRlbmRzfHxmdW5jdGlvbigpe3ZhciBhPWZ1bmN0aW9uKGIsYyl7YT1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oYSxiKXthLl9fcHJvdG9fXz1ifXx8ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGMgaW4gYiliLmhhc093blByb3BlcnR5KGMpJiYoYVtjXT1iW2NdKX07cmV0dXJuIGEoYixjKX07cmV0dXJuIGZ1bmN0aW9uKGIsYyl7ZnVuY3Rpb24gZCgpe3RoaXMuY29uc3RydWN0b3I9Yn1hKGIsYyk7Yi5wcm90b3R5cGU9XHJcbm51bGw9PT1jP09iamVjdC5jcmVhdGUoYyk6KGQucHJvdG90eXBlPWMucHJvdG90eXBlLG5ldyBkKX19KCk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7YS5TdHJlYW1SZXNvbHV0aW9uPWEuUmVtb3RlQ2FsbENvbnN0cmFpbnRzPXZvaWQgMDt2YXIgbD1jKDU1MCksaD1jKDY1OCksZD1jKDg1MSk7Yj1mdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbigpe319KCk7YS5SZW1vdGVDYWxsQ29uc3RyYWludHM9YjtiPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXt2YXIgYz1hLmNhbGwodGhpcyxudWxsLGwuY2xhc3NfaWRfdC5TdHJlYW1SZXNvbHV0aW9uLDAsaC5Qcm94eU1vZGUuTG9jYWwpfHx0aGlzO2MubGFzdFNlbnRDb25zdHJhaW50c189bnVsbDtyZXR1cm4gY31lKGIsYSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwib251cGRhdGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub251cGRhdGVffSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGM9XHJcbnRoaXM7dGhpcy5vbnVwZGF0ZV89YTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZCh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbnVwZGF0ZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGE9Yy5yZWdpc3RlckNhbGxiYWNrcyghMSxjLmlzTnVsbENhbGxiYWNrKGMub251cGRhdGVfKSxsLm1ldGhvZF9pZF9TdHJlYW1SZXNvbHV0aW9uX3Qub251cGRhdGUpO2EudGhlbihmdW5jdGlvbihhKXthPWEucGFyYW1zO3ZhciBlPWFbMF07YS5zbGljZSgxKTtkLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub251cGRhdGVcIixKU09OLnN0cmluZ2lmeShlKSk7Yy5sYXN0U2VudENvbnN0cmFpbnRzXyYmSlNPTi5zdHJpbmdpZnkoYy5sYXN0U2VudENvbnN0cmFpbnRzXyk9PUpTT04uc3RyaW5naWZ5KGUpP2QubG9nZ2VyLmxvZyhjLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5vbnVwZGF0ZSBjb25zdHJhaW50cyB1bmNoYW5nZWQsIGlnbm9yaW5nXCIpOmMub251cGRhdGVfJiYoYi5pc1ZhbGlkUmVtb3RlQ29uc3RyYWludHMoZSk/XHJcbihjLmxhc3RTZW50Q29uc3RyYWludHNfPWUsYy5vbnVwZGF0ZV8oYy50b0lDYWxsQ29uc3RyYWludHMoYy5sYXN0U2VudENvbnN0cmFpbnRzXykpKTpkLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub251cGRhdGUgaW52YWxpZCBSZW1vdGVDYWxsQ29uc3RyYWludHNcIikpfSk7cmV0dXJuIGMucmVtb3RlSW52b2tlKCEwLGwubWV0aG9kX2lkX1N0cmVhbVJlc29sdXRpb25fdC5vbnVwZGF0ZSxhLnN1Y2Nlc3MpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe3JldHVybiBkLmxvZ2dlci5sb2coYy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIub251cGRhdGUsIGNvdWxkIG5vdCBzZXQgbGlzdGVuZXJcIil9KX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtiLnByb3RvdHlwZS50b0lDYWxsQ29uc3RyYWludHM9ZnVuY3Rpb24oYSl7dmFyIGI9e21heFBhcnRpY2lwYW50UmVzb2x1dGlvbnM6bnVsbH07aWYoYS5tYXhfcGFydGljaXBhbnRfcmVzb2x1dGlvbnNfZHluYW1pYyl7Yi5tYXhQYXJ0aWNpcGFudFJlc29sdXRpb25zPVxyXG57fTtmb3IodmFyIGM9MCxlPWEubWF4X3BhcnRpY2lwYW50X3Jlc29sdXRpb25zX2R5bmFtaWM7YzxlLmxlbmd0aDtjKyspe3ZhciBnPWVbY107Yi5tYXhQYXJ0aWNpcGFudFJlc29sdXRpb25zW2cuY291bnRdPWcucmVzb2x1dGlvbn19ZWxzZSBhLm1heF9wYXJ0aWNpcGFudF9yZXNvbHV0aW9uc19zdGF0aWMmJihiLm1heFBhcnRpY2lwYW50UmVzb2x1dGlvbnM9YS5tYXhfcGFydGljaXBhbnRfcmVzb2x1dGlvbnNfc3RhdGljKTtiLm1heEluY29taW5nU3RyZWFtcz1hLm1heF9pbmNvbWluZ19zdHJlYW1zO2IubWF4T3V0Z29pbmdSZXNvbHV0aW9uPWEubWF4X291dGdvaW5nX3Jlc29sdXRpb247Yi5tYXhTaW11bGNhc3RMYXllcnM9YS5tYXhfc2ltdWxjYXN0X2xheWVycztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIudG9JQ2FsbENvbnN0cmFpbnRzOiBcIitKU09OLnN0cmluZ2lmeShiKSk7cmV0dXJuIGJ9O2IuaXNWYWxpZFJlbW90ZUNvbnN0cmFpbnRzPWZ1bmN0aW9uKGEpe3JldHVybiBudWxsIT1cclxuYSYmKG51bGwhPWEubWF4X3BhcnRpY2lwYW50X3Jlc29sdXRpb25zX2R5bmFtaWN8fG51bGwhPWEubWF4X3BhcnRpY2lwYW50X3Jlc29sdXRpb25zX3N0YXRpYykmJm51bGwhPWEubWF4X2luY29taW5nX3N0cmVhbXMmJm51bGwhPWEubWF4X291dGdvaW5nX3Jlc29sdXRpb24mJm51bGwhPWEubWF4X3NpbXVsY2FzdF9sYXllcnN9O2IucHJvdG90eXBlLmdldENhbGxDb25zdHJhaW50cz1mdW5jdGlvbigpe3ZhciBhPXRoaXM7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGMsZSl7YS53YWl0VW50aWxDb25uZWN0ZWQoYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0Q2FsbENvbnN0cmFpbnRzXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYS5yZW1vdGVJbnZva2UoITEsbC5tZXRob2RfaWRfU3RyZWFtUmVzb2x1dGlvbl90LmdldENhbGxDb25zdHJhaW50cyl9KS50aGVuKGZ1bmN0aW9uKGgpe2g9YS5wYXJhbTAoaCk7ZC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmdldENhbGxDb25zdHJhaW50c1wiLFxyXG5KU09OLnN0cmluZ2lmeShoKSk7Yi5pc1ZhbGlkUmVtb3RlQ29uc3RyYWludHMoaCk/KGEub251cGRhdGVfJiYoYS5sYXN0U2VudENvbnN0cmFpbnRzXz1oKSxjKGEudG9JQ2FsbENvbnN0cmFpbnRzKGgpKSk6KGQubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5nZXRDYWxsQ29uc3RyYWludHMgaW52YWxpZCBSZW1vdGVDYWxsQ29uc3RyYWludHNcIiksZSgpKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtkLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZ2V0Q2FsbENvbnN0cmFpbnRzIHByb21pc2UgcmVqZWN0ZWRcIik7ZSgpfSl9KX07Yi5nZXREZWZhdWx0Q29uc3RyYWludHM9ZnVuY3Rpb24oKXt2YXIgYT17bWF4UGFydGljaXBhbnRSZXNvbHV0aW9uczp7MTo3MjAsMjo3MjAsMzozNjAsbW9yZTozNjB9LG1heEluY29taW5nU3RyZWFtczo0LG1heE91dGdvaW5nUmVzb2x1dGlvbjo3MjAsbWF4U2ltdWxjYXN0TGF5ZXJzOjB9O2QubG9nZ2VyLmxvZyhcIlN0cmVhbVJlc29sdXRpb24uZ2V0RGVmYXVsdENvbnN0cmFpbnRzOiBcIitcclxuSlNPTi5zdHJpbmdpZnkoYSkpO3JldHVybiBhfTtiLnByb3RvdHlwZS51cGRhdGVTdHJlYW1SZXNvbHV0aW9uPWZ1bmN0aW9uKCl7dmFyIGE9dGhpczt0aGlzLmdldENhbGxDb25zdHJhaW50cygpLnRoZW4oZnVuY3Rpb24oYil7cmV0dXJuIGEub251cGRhdGUmJmEub251cGRhdGUoYil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7cmV0dXJuIGQubG9nZ2VyLmxvZyhcIkZhaWxlZCB0byBnZXQgc3RyZWFtIHJlc29sdXRpb24gaW5mb3JtYXRpb24hXCIpfSl9O3JldHVybiBifShoLlByb3h5T2JqZWN0KTthLlN0cmVhbVJlc29sdXRpb249Yn0sMzk0OmZ1bmN0aW9uKGIsYSxjKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTthLlRlbGVtZXRyeT1hLnRlbF9rZXlfQ1BVVG90YWxtZW1vcnk9YS50ZWxfa2V5X0NQVUdwdWluZm89YS50ZWxfa2V5X0NQVU1hY2hpbmVpZD1hLnRlbF9rZXlfQ1BVUHJvY2Vzc29ycz1hLnRlbF9rZXlfQ1BVQ29yZXM9YS50ZWxfa2V5X0NQVU1vZGVsPVxyXG5hLnRlbF9rZXlfQ1BVU3BlZWQ9YS50ZWxfa2V5X09TRWRpdGlvbj1hLnRlbF9rZXlfT1NEaXN0cm89YS50ZWxfa2V5X09TQXJjaGl0ZWN0dXJlPWEudGVsX2tleV9PU1ZlcnNpb249YS50ZWxfa2V5X09TRmFtaWx5PWEudGVsX2tleV9WZXJIZHhSdGNFbmdpbmU9YS50ZWxfa2V5X1ZlclR5cGVTY3JpcHQ9YS50ZWxfa2V5X1ZlckVuZHBvaW50PWEudGVsX2tleV9WZXJWZGE9YS50ZWxfa2V5X1ZlclJlY2VpdmVyPWEudGVsX2tleV9WZXJXZWJydGNDb2RlY3M9YS50ZWxfa2V5X1ZlcldlYnJwYz1hLnRlbF9rZXlfUGVyZkNhbGxUeXBlPWEudGVsX2tleV9QZXJmQ2FsbFN0YXRlPWEudGVsX2tleV9QZXJmQ2FsbERpcmVjdGlvbj1hLnRlbF9rZXlfU3BlYWtlckRldmljZVVzZWQ9YS50ZWxfa2V5X1ZpZGVvRGV2aWNlVXNlZD1hLnRlbF9rZXlfQXVkaW9EZXZpY2VVc2VkPWEudGVsX2tleV9DYWxsRXN0T3V0Z29pbmc9YS50ZWxfa2V5X0NhbGxFc3RJbmNvbWluZz1hLnRlbF9rZXlfU2NyZWVuc2hhcmluZ0NhbGxEdXJhdGlvbj1cclxuYS50ZWxfa2V5X1ZpZGVvQ2FsbER1cmF0aW9uPWEudGVsX2tleV9BdWRpb0NhbGxEdXJhdGlvbj1hLnRlbF9rZXlfQ29uZmVyZW5jZUNhbGxEdXJhdGlvbj1hLnRlbF9jbWQ9YS50ZWxfQ2FsbFR5cGU9YS50ZWxfQ2FsbERpcmVjdGlvbj1hLnRlbF9DYWxsU3RhdGU9dm9pZCAwO3ZhciBlPWMoOTQ2KSxsPWMoODUxKTsoZnVuY3Rpb24oYSl7YVthLnVua25vd249MF09XCJ1bmtub3duXCI7YVthLmFjdGl2ZT0xXT1cImFjdGl2ZVwiO2FbYS5pZGxlPTJdPVwiaWRsZVwifSkoYS50ZWxfQ2FsbFN0YXRlfHwoYS50ZWxfQ2FsbFN0YXRlPXt9KSk7KGZ1bmN0aW9uKGEpe2FbYS51bmtub3duPTBdPVwidW5rbm93blwiO2FbYS5pbmNvbWluZz0xXT1cImluY29taW5nXCI7YVthLm91dGdvaW5nPTJdPVwib3V0Z29pbmdcIn0pKGEudGVsX0NhbGxEaXJlY3Rpb258fChhLnRlbF9DYWxsRGlyZWN0aW9uPXt9KSk7KGZ1bmN0aW9uKGEpe2FbYS51bmtub3duPTBdPVwidW5rbm93blwiO2FbYS5hdWRpbz0xXT1cImF1ZGlvXCI7YVthLnZpZGVvPVxyXG4yXT1cInZpZGVvXCI7YVthLm11bHRpPTNdPVwibXVsdGlcIjthW2EuZHNoYXJlPTRdPVwiZHNoYXJlXCJ9KShhLnRlbF9DYWxsVHlwZXx8KGEudGVsX0NhbGxUeXBlPXt9KSk7dmFyIGg7KGZ1bmN0aW9uKGEpe2FbYS5Vbmtub3duPTBdPVwiVW5rbm93blwiO2FbYS5DYXA9MV09XCJDYXBcIjthW2EuSW5pdD0yXT1cIkluaXRcIjthW2EuRGF0YT0zXT1cIkRhdGFcIn0pKGg9YS50ZWxfY21kfHwoYS50ZWxfY21kPXt9KSk7YS50ZWxfa2V5X0NvbmZlcmVuY2VDYWxsRHVyYXRpb249XCJDb25mZXJlbmNlQ2FsbER1cmF0aW9uXCI7YS50ZWxfa2V5X0F1ZGlvQ2FsbER1cmF0aW9uPVwiQXVkaW9DYWxsRHVyYXRpb25cIjthLnRlbF9rZXlfVmlkZW9DYWxsRHVyYXRpb249XCJWaWRlb0NhbGxEdXJhdGlvblwiO2EudGVsX2tleV9TY3JlZW5zaGFyaW5nQ2FsbER1cmF0aW9uPVwiU2NyZWVuc2hhcmluZ0NhbGxEdXJhdGlvblwiO2EudGVsX2tleV9DYWxsRXN0SW5jb21pbmc9XCJDYWxsRXN0SW5jb21pbmdcIjthLnRlbF9rZXlfQ2FsbEVzdE91dGdvaW5nPVxyXG5cIkNhbGxFc3RPdXRnb2luZ1wiO2EudGVsX2tleV9BdWRpb0RldmljZVVzZWQ9XCJBdWRpb0RldmljZVVzZWRcIjthLnRlbF9rZXlfVmlkZW9EZXZpY2VVc2VkPVwiVmlkZW9EZXZpY2VVc2VkXCI7YS50ZWxfa2V5X1NwZWFrZXJEZXZpY2VVc2VkPVwiU3BlYWtlckRldmljZVVzZWRcIjthLnRlbF9rZXlfUGVyZkNhbGxEaXJlY3Rpb249XCJQZXJmQ2FsbERpcmVjdGlvblwiO2EudGVsX2tleV9QZXJmQ2FsbFN0YXRlPVwiUGVyZkNhbGxTdGF0ZVwiO2EudGVsX2tleV9QZXJmQ2FsbFR5cGU9XCJQZXJmQ2FsbFR5cGVcIjthLnRlbF9rZXlfVmVyV2VicnBjPVwiVmVyV2VicnBjXCI7YS50ZWxfa2V5X1ZlcldlYnJ0Y0NvZGVjcz1cIlZlcldlYnJ0Y0NvZGVjc1wiO2EudGVsX2tleV9WZXJSZWNlaXZlcj1cIlZlclJlY2VpdmVyXCI7YS50ZWxfa2V5X1ZlclZkYT1cIlZlclZkYVwiO2EudGVsX2tleV9WZXJFbmRwb2ludD1cIlZlckVuZHBvaW50XCI7YS50ZWxfa2V5X1ZlclR5cGVTY3JpcHQ9XCJWZXJUeXBlU2NyaXB0XCI7YS50ZWxfa2V5X1ZlckhkeFJ0Y0VuZ2luZT1cclxuXCJWZXJIZHhSdGNFbmdpbmVcIjthLnRlbF9rZXlfT1NGYW1pbHk9XCJPU0ZhbWlseVwiO2EudGVsX2tleV9PU1ZlcnNpb249XCJPU1ZlcnNpb25cIjthLnRlbF9rZXlfT1NBcmNoaXRlY3R1cmU9XCJPU0FyY2hpdGVjdHVyZVwiO2EudGVsX2tleV9PU0Rpc3Rybz1cIk9TRGlzdHJvXCI7YS50ZWxfa2V5X09TRWRpdGlvbj1cIk9TRWRpdGlvblwiO2EudGVsX2tleV9DUFVTcGVlZD1cIkNQVVNwZWVkXCI7YS50ZWxfa2V5X0NQVU1vZGVsPVwiQ1BVTW9kZWxcIjthLnRlbF9rZXlfQ1BVQ29yZXM9XCJDUFVDb3Jlc1wiO2EudGVsX2tleV9DUFVQcm9jZXNzb3JzPVwiQ1BVUHJvY2Vzc29yc1wiO2EudGVsX2tleV9DUFVNYWNoaW5laWQ9XCJDUFVNYWNoaW5laWRcIjthLnRlbF9rZXlfQ1BVR3B1aW5mbz1cIkNQVUdwdWluZm9cIjthLnRlbF9rZXlfQ1BVVG90YWxtZW1vcnk9XCJDUFVUb3RhbG1lbW9yeVwiO3ZhciBkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGMsZCxlKXt0aGlzLmNtZD1iO3RoaXMua2V5PWM7dGhpcy52YWx1ZT1kO3RoaXMuZmxhZ3M9XHJcbmV9YS5wcm90b3R5cGUuU2VuZFRlbGVtZXRyeURhdGE9ZnVuY3Rpb24oYSl7YS5TZW5kVGVsZW1ldHJ5RGF0YSh0aGlzLmNtZCx0aGlzLmtleSx0aGlzLnZhbHVlLHRoaXMuZmxhZ3MpfTtyZXR1cm4gYX0oKTtiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe3RoaXMuaWQ9MDt0aGlzLmRlZmVycmVkRGF0YT1bXX1hLnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbigpe3RoaXMuaWQ9MDt0aGlzLmRlZmVycmVkRGF0YT1bXX07YS5wcm90b3R5cGUub25Jbml0aWFsaXplZD1mdW5jdGlvbihhKXtmb3IodGhpcy5pZD1hO3RoaXMuZGVmZXJyZWREYXRhJiYwPHRoaXMuZGVmZXJyZWREYXRhLmxlbmd0aDspdGhpcy5kZWZlcnJlZERhdGEuc2hpZnQoKS5TZW5kVGVsZW1ldHJ5RGF0YSh0aGlzKX07YS5wcm90b3R5cGUuU2VuZFRlbGVtZXRyeUluaXQ9ZnVuY3Rpb24oKXswPHRoaXMuaWQmJnRoaXMucmVzZXQoKTt0cnl7ZS5nZXRSZWRpcmVjdG9yKCkuV1NTZW5kT2JqZWN0KHt2OlwidGVsZW1ldHJ5XCIsXHJcbmhkcjp7Y29tbWFuZDpoLkluaXQsaWQ6MH0saW5pdDp7ZG9tYWluOlwiSERYTU0gVGVhbXNcIixzdWJkb21haW46XCJUZWFtc1wiLGZlYXR1cmU6XCJtc3RlYW1zXCIsdmVyc2lvbjpcIjEuMS4xLjFcIn19KX1jYXRjaChhKXtsLmxvZ2dlci5sb2coYSl9fTthLnByb3RvdHlwZS5TZW5kVGVsZW1ldHJ5RGF0YT1mdW5jdGlvbihhLGIsYyx3KXtpZihhIT1oLkRhdGEpbC5sb2dnZXIubG9nKFwiaW52YWxpZCB0ZWxlbWV0cnkgY29tbWFuZCFcIik7ZWxzZSBpZigwPT10aGlzLmlkKXRoaXMuZGVmZXJyZWREYXRhLnB1c2gobmV3IGQoYSxiLGMsdykpO2Vsc2UgdHJ5e2UuZ2V0UmVkaXJlY3RvcigpLldTU2VuZE9iamVjdCh7djpcInRlbGVtZXRyeVwiLGhkcjp7Y29tbWFuZDphLGlkOnRoaXMuaWR9LGRhdGE6e2tleTpiLHZhbHVlOmMsZmxhZ3M6d319KX1jYXRjaChwKXtsLmxvZ2dlci5sb2cocCl9fTtyZXR1cm4gYX0oKTthLlRlbGVtZXRyeT1ifSwyNTk6ZnVuY3Rpb24oYixhLGMpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFxyXG5cIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTthLlV0aWw9dm9pZCAwO3ZhciBlPWMoODUxKTtiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe31hLnN0cmluZ2lmeUFycmF5PWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1cIltcIixjPTA7YzxhLmxlbmd0aDsrK2MpMCE9YyYmKGIrPVwiLFwiKSxiKz10aGlzLnN0cmluZ2lmeShhW2NdKTtyZXR1cm4gYitcIl1cIn07YS5zdHJpbmdpZnlPYmplY3Q9ZnVuY3Rpb24oYSl7dmFyIGI9XCJ7XCIsYz0hMCxlO2ZvcihlIGluIGEpYz9jPSExOmIrPVwiLFwiLGI9YisnXCInK2UrJ1wiOicsYj1hW2VdaW5zdGFuY2VvZiBBcnJheT9iK3RoaXMuc3RyaW5naWZ5QXJyYXkoYVtlXSk6XCJvYmplY3RcIj09dHlwZW9mIGFbZV0/Yit0aGlzLnN0cmluZ2lmeU9iamVjdChhW2VdKTpiK0pTT04uc3RyaW5naWZ5KGFbZV0pO3JldHVybiBiK1wifVwifTthLnN0cmluZ2lmeT1mdW5jdGlvbihhKXtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgYT9cIltvYmplY3QgQXJyYXldXCI9PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhKT9cclxudGhpcy5zdHJpbmdpZnlBcnJheShhKTp0aGlzLnN0cmluZ2lmeU9iamVjdChhKTpKU09OLnN0cmluZ2lmeShhKX07YS5HZXRPYmplY3RQcm9wZXJ0eURlc2NyaXB0b3I9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9dm9pZCAwO2EhPU9iamVjdC5wcm90b3R5cGU7KXtjPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYSxiKTtpZih2b2lkIDAhPT1jKWJyZWFrO2E9YS5fX3Byb3RvX199cmV0dXJuIGN9O2Euc2VuZEV2ZW50PWZ1bmN0aW9uKGEsYil7dHJ5e3ZhciBjPWRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiRXZlbnRcIik7Yy5pbml0RXZlbnQoYiwhMCwhMCk7YS5kaXNwYXRjaEV2ZW50KGMpfWNhdGNoKGwpe2UubG9nZ2VyLmxvZygnc2VuZEV2ZW50KCk6IGV4Y2VwdGlvbiBkaXNwYXRjaGluZyBcIicrYisnXCIgZXZlbnQ6ICcrbC5tZXNzYWdlKX19O2EuaGFzVmFsdWU9ZnVuY3Rpb24oYSl7dmFyIGI9ITE7bnVsbCE9PWEmJnZvaWQgMCE9PWEmJihiPSEwKTtyZXR1cm4gYn07cmV0dXJuIGF9KCk7XHJcbmEuVXRpbD1ifSwzMDc6ZnVuY3Rpb24oYixhLGMpe3ZhciBlPXRoaXMmJnRoaXMuX19hd2FpdGVyfHxmdW5jdGlvbihhLGIsYyxkKXtmdW5jdGlvbiBlKGEpe3JldHVybiBhIGluc3RhbmNlb2YgYz9hOm5ldyBjKGZ1bmN0aW9uKGIpe2IoYSl9KX1yZXR1cm4gbmV3IChjfHwoYz1Qcm9taXNlKSkoZnVuY3Rpb24oYyxnKXtmdW5jdGlvbiBoKGEpe3RyeXtsKGQubmV4dChhKSl9Y2F0Y2goYil7ZyhiKX19ZnVuY3Rpb24gayhhKXt0cnl7bChkW1widGhyb3dcIl0oYSkpfWNhdGNoKGIpe2coYil9fWZ1bmN0aW9uIGwoYSl7YS5kb25lP2MoYS52YWx1ZSk6ZShhLnZhbHVlKS50aGVuKGgsayl9bCgoZD1kLmFwcGx5KGEsYnx8W10pKS5uZXh0KCkpfSl9LGw9dGhpcyYmdGhpcy5fX2dlbmVyYXRvcnx8ZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBjKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gZChbYSxiXSl9fWZ1bmN0aW9uIGQoYyl7aWYoZyl0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuZm9yKDtlOyl0cnl7aWYoZz0xLGgmJihrPWNbMF0mMj9oW1wicmV0dXJuXCJdOmNbMF0/aFtcInRocm93XCJdfHwoKGs9aFtcInJldHVyblwiXSkmJmsuY2FsbChoKSwwKTpoLm5leHQpJiYhKGs9ay5jYWxsKGgsY1sxXSkpLmRvbmUpcmV0dXJuIGs7aWYoaD0wLGspYz1bY1swXSYyLGsudmFsdWVdO3N3aXRjaChjWzBdKXtjYXNlIDA6Y2FzZSAxOms9YzticmVhaztjYXNlIDQ6cmV0dXJuIGUubGFiZWwrKyx7dmFsdWU6Y1sxXSxkb25lOiExfTtjYXNlIDU6ZS5sYWJlbCsrO2g9Y1sxXTtjPVswXTtjb250aW51ZTtjYXNlIDc6Yz1lLm9wcy5wb3AoKTtlLnRyeXMucG9wKCk7Y29udGludWU7ZGVmYXVsdDppZighKGs9ZS50cnlzLGs9MDxrLmxlbmd0aCYma1trLmxlbmd0aC0xXSkmJig2PT09Y1swXXx8Mj09PWNbMF0pKXtlPTA7Y29udGludWV9aWYoMz09PWNbMF0mJigha3x8Y1sxXT5rWzBdJiZjWzFdPGtbM10pKWUubGFiZWw9Y1sxXTtlbHNlIGlmKDY9PT1jWzBdJiZlLmxhYmVsPGtbMV0pZS5sYWJlbD1cclxua1sxXSxrPWM7ZWxzZSBpZihrJiZlLmxhYmVsPGtbMl0pZS5sYWJlbD1rWzJdLGUub3BzLnB1c2goYyk7ZWxzZXtrWzJdJiZlLm9wcy5wb3AoKTtlLnRyeXMucG9wKCk7Y29udGludWV9fWM9Yi5jYWxsKGEsZSl9Y2F0Y2gobCl7Yz1bNixsXSxoPTB9ZmluYWxseXtnPWs9MH1pZihjWzBdJjUpdGhyb3cgY1sxXTtyZXR1cm57dmFsdWU6Y1swXT9jWzFdOnZvaWQgMCxkb25lOiEwfX12YXIgZT17bGFiZWw6MCxzZW50OmZ1bmN0aW9uKCl7aWYoa1swXSYxKXRocm93IGtbMV07cmV0dXJuIGtbMV19LHRyeXM6W10sb3BzOltdfSxnLGgsayxsOyRqc2NvbXAuaW5pdFN5bWJvbCgpOyRqc2NvbXAuaW5pdFN5bWJvbCgpOyRqc2NvbXAuaW5pdFN5bWJvbEl0ZXJhdG9yKCk7cmV0dXJuIGw9e25leHQ6YygwKSxcInRocm93XCI6YygxKSxcInJldHVyblwiOmMoMil9LFwiZnVuY3Rpb25cIj09PXR5cGVvZiBTeW1ib2wmJihsW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLGx9LGg9XHJcbmMoMzYwKSxkPWMoMTQ0KTtjKDY3OSk7dmFyIHA9Yyg5NDUpLHE9YygzNjgpLG49Yyg4NTEpLmxvZ2dlcixrPWMoNjUwKSx2PWMoOTczKSx6PWMoMjQ3KS5nZXRHQyxnPWMoOTQ2KSxCPWMoNjEzKS5FOTExU2VydmljZTtiPWMoNTUwKTt2YXIgdD1iLkZlYXR1cmVzLG09Yi5GRUFUVVJFX3ZkYV9kZWxldGVfdmlld3BvcnQsRD1jKDcwNCkuU3RyZWFtUmVzb2x1dGlvbix5PWMoMjM5KS5FOyhmdW5jdGlvbihhLGIpe2EuQ2l0cml4V2ViUlRDPWIoKX0pKFwidW5kZWZpbmVkXCIhPT10eXBlb2Ygc2VsZj9zZWxmOnRoaXMsZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsYyl7bi5sb2coXCJWREkgU2hpbSBjcmVhdGVNZWRpYVN0cmVhbUludGVybmFsXCIpO0coKTt2YXIgZj1uZXcgZC5SZW1vdGVTdHJlYW0obnVsbCwwLDAsYiksZT1uZXcgUHJvbWlzZShmdW5jdGlvbihhLGIpe2Yuc3luY0JhcnJpZXIoKS50aGVuKGZ1bmN0aW9uKGIpe24ubG9nKFwic3RyZWFtLnN5bmNCYXJyaWVyKCk6IHN1Y2Nlc3MuXCIpO1xyXG5hKGIpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtuLmxvZyhcInN0cmVhbS5zeW5jQmFycmllcigpOiBmYWlsZWQgd2l0aCBlcnJvcjogXCIrSlNPTi5zdHJpbmdpZnkoYSkpO2YucmVsZWFzZSgpO2IoKX0pfSk7cmV0dXJuIGM/ZTpmfWZ1bmN0aW9uIGIoYSl7bnVsbD09WSYmKFk9bmV3IHEuRnJhbWVzKCFPLmlzRmVhdHVyZVN1cHBvcnRlZCh0LkZFQVRVUkVfcHVibGljX211bHRpX3dpbmRvdykpKTthKFkpfWZ1bmN0aW9uIGMoYSxkKXtiKGZ1bmN0aW9uKGIpe3ZhciBjPWIuZmluZEZyYW1lKGEpO3ZvaWQgMD09YyYmKGM9Yi5uZXdGcmFtZShhKSk7ZChjKX0pfWZ1bmN0aW9uIE0oYSxjKXtiKGZ1bmN0aW9uKGIpe2I9Yi5maW5kRnJhbWUoYSk7bnVsbCE9YiYmYyhiKX0pfWZ1bmN0aW9uIEYoYSl7Zy5nZXRSZWRpcmVjdG9yKCkuU2VuZFRlbGVtZXRyeURhdGFfU3BlYWtlcihhKX1mdW5jdGlvbiBKKGEsYil7aWYoUyl0cnl7XCJ2ZGlFOTExSW5mb0NoYW5nZWRcIj09PWE/YT1cInZkaUU5MTFEYXRhQ2hhbmdlZFwiOlxyXG5cInZkaUNhbGxDb25zdHJhaW50c0NoYW5nZWRcIj09PWEmJihhPVwidmRpU3RyZWFtQ29uc3RyYWludHNDaGFuZ2VkXCIpO3ZhciBjPU9iamVjdC5hc3NpZ24oe2V2ZW50OmF9LGIpO24ubG9nKFwiRGlzcGF0Y2hpbmcgVk0gZXZlbnQ6XCIrSlNPTi5zdHJpbmdpZnkoYykpO1MoYyl9Y2F0Y2goZCl7bi5sb2coXCJFeGNlcHRpb24gb25WTUV2ZW50KCksIGV2ZW50TmFtZTpcIithK1wiIG1lc3NhZ2U6XCIrZC5tZXNzYWdlKX19ZnVuY3Rpb24gRygpe3ZhciBhPXdpbmRvdy5nZXRDaXRyaXhXZWJydGNSZWRpcjt2b2lkIDAhPT1hP2EoKS50aGVuKGZ1bmN0aW9uKGEpe24ubG9nKFwic3VjZXNzcyBvbiBjb25uZWN0LCBnZXRDaXRyaXhXZWJydGNSZWRpciByZWcgdmFsdWU6XCIrYSk7XCIxXCIhPT1hfHxPfHwobi5sb2coXCJzdXBwb3J0ZWQgY2xpZW50XCIpLFAoVykpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe24ubG9nKFwiRmFpbHVyZSB0byBSZWFkIFdlYnJ0YyByZWRpciBSZWcgS2V5XCIpO2YoKX0pOihuLmxvZyhcIndpbmRvdy5nZXRDaXRyaXhXZWJydGNSZWRpcigpIG1ldGhvZCBpcyBub3QgYXZhaWxhYmxlIHlldFwiKSxcclxuZigpKX1mdW5jdGlvbiBMKGEpe24ubG9nKFwiVkRJIEV2ZW50OiB2ZGlDbGllbnREaXNjb25uZWN0ZWRcIik7YmEoKTtpZighMD09PWEmJiExPT09YWEpe24ubG9nKFwiVkRJIEV2ZW50OiB2ZGlDbGllbnREaXNjb25uZWN0ZWQgd2l0aCBmYWlsdXJlIHJlcG9ydGVkXCIpO2FhPSEwO3RyeXtTKHtldmVudDpcInZkaUNsaWVudERpc2Nvbm5lY3RlZFwiLHJlYXNvbjpcImZhaWx1cmVcIixtc2c6XCJXZWJzb2NrZXQgQ29ubmVjdGlvbiBGYWlsdXJlXCJ9KX1jYXRjaChiKXtuLmxvZyhcIm9uVk1FdmVudCgpOiBleGNlcHRpb246IFwiK2IubWVzc2FnZSl9fWVsc2V7YWE9ITE7dHJ5e1Moe2V2ZW50OlwidmRpQ2xpZW50RGlzY29ubmVjdGVkXCIscmVhc29uOlwiZW5kcG9pbnREaXNjb25uZWN0ZWRcIn0pfWNhdGNoKGIpe24ubG9nKFwib25WTUV2ZW50KCk6IGV4Y2VwdGlvbjogXCIrYi5tZXNzYWdlKX19fWZ1bmN0aW9uIFAoYSl7bi5sb2coXCJpbml0UmVtb3RlU2Vzc2lvbiB3aXRoIHZlbmRvcjpcIithKTtPfHwoTz1uZXcgay5SZW1vdGVTZXNzaW9uKFwiQ2l0cml4V2ViUlRDU0RLXCIsXHJcbmEpKX1mdW5jdGlvbiBDKCl7bi5sb2coXCJWREkgRXZlbnQ6IG9uVmRpQ2xpZW50RGlzY29ubmVjdGVkVGltZXJcIik7UChXKX1mdW5jdGlvbiBSKCl7dmFyIGE9dGhpcztuLmxvZyhcIlZESSBTaGltIG9uVmRpQ2xpZW50Q29ubmVjdGVkLi4uXCIpO08/Ty5nZXRTZXNzaW9uSW5mbygpLnRoZW4oZnVuY3Rpb24oYyl7cmV0dXJuIGUoYSx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7cmV0dXJuIGwodGhpcyxmdW5jdGlvbihhKXtzd2l0Y2goYS5sYWJlbCl7Y2FzZSAwOnJldHVybiBuLmxvZyhcIlZESSBTaGltIG9uVmRpQ2xpZW50Q29ubmVjdGVkLCBjbGllbnQgZW5kcG9pbnQgaW5mbzpcIitKU09OLnN0cmluZ2lmeShjKSksSCYmSC5pc1ZhbGlkKCl8fChIPW5ldyBkLlJlbW90ZURldmljZXMpLEkmJkkuaXNWYWxpZCgpfHwoST1uZXcgZC5OYXZpZ2F0b3JVc2VyTWVkaWEpLGIoZnVuY3Rpb24oYSl7YS5yZWNvbm5lY3QoKX0pLEooXCJ2ZGlDbGllbnRDb25uZWN0ZWRcIix7dmVyc2lvbjpjLGVuZHBvaW50SWQ6Yy5lbmRwb2ludElkfSksXHJcbls0LEkuZ2V0Q2FwYWJpbGl0aWVzKCkudGhlbihmdW5jdGlvbihhKXtuLmxvZyhcIlZESSBTaGltIG9uVmRpQ2xpZW50Q29ubmVjdGVkLCBjYXBzID0gXCIrYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7bi5sb2coXCJWREkgU2hpbSBvblZkaUNsaWVudENvbm5lY3RlZCwgY291bGQgbm90IGdldCBjYXBhYmlsaXRpZXNcIil9KV07Y2FzZSAxOnJldHVybiBhLnNlbnQoKSxUfHwoVD1uZXcgQixULm9udXBkYXRlPWZ1bmN0aW9uKGEpe0ooXCJ2ZGlFOTExSW5mb0NoYW5nZWRcIixhKX0sVC51cGRhdGVFOTExSW5mbygpKSxVfHwoSihcInZkaUNhbGxDb25zdHJhaW50c0NoYW5nZWRcIixELmdldERlZmF1bHRDb25zdHJhaW50cygpKSxudWxsIT09TyYmay5SZW1vdGVTZXNzaW9uLmlzRmVhdHVyZUNhbGxDb25zdHJhaW50c1N1cHBvcnRlZCgpJiYoVT1uZXcgRCxVLm9udXBkYXRlPWZ1bmN0aW9uKGEpe0ooXCJ2ZGlDYWxsQ29uc3RyYWludHNDaGFuZ2VkXCIsYSl9LFUudXBkYXRlU3RyZWFtUmVzb2x1dGlvbigpKSksXHJcbm5hdmlnYXRvci5tZWRpYURldmljZXMuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJkZXZpY2VjaGFuZ2VcIikpLFsyXX19KX0pfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe24ubG9nKFwiVkRJIFNoaW0gb25WZGlDbGllbnRDb25uZWN0ZWQsIGdldFNlc3Npb25JbmZvIGZhaWx1cmUhIFNlc3Npb24gaXMgbm90IGZ1bGx5IGNvbm5lY3RlZCB5ZXQuLi5cIil9KTpuLmxvZyhcIlZESSBTaGltIG9uVmRpQ2xpZW50Q29ubmVjdGVkLCByZW1vdGVTZXNzaW9uIGRvZXMgbm90IGV4aXN0XCIpfWZ1bmN0aW9uIEsoYSl7aWYoXCIxXCI9PT1hKW4ubG9nKFwiU3VwcG9ydGVkIGNsaWVudFwiKSxnLmdldFJlZGlyZWN0b3IoKS5waW5nQ29ubmVjdGlvbkJlZ2luKCEwKTtlbHNlIGlmKFwiMFwiPT09YSl7bi5sb2coXCJWREkgRXZlbnQ6IFVuc3VwcG9ydGVkIGNsaWVudCByZXBvcnRlZFwiKTt0cnl7Uyh7ZXZlbnQ6XCJ2ZGlDbGllbnREaXNjb25uZWN0ZWRcIixyZWFzb246XCJlbmRwb2ludFVuc3VwcG9ydGVkXCIsbXNnOlwiVW5zdXBwb3J0ZWQgZW5kcG9pbnQgY29ubmVjdGVkXCJ9KX1jYXRjaChiKXtuLmxvZyhcIm9uVk1FdmVudCgpOiBleGNlcHRpb246IFwiK1xyXG5iLm1lc3NhZ2UpfX1lbHNlIG4ubG9nKFwiQ2l0cml4IFdlYnJ0YyBSZWRpciBSZWcgS2V5IHZhbHVlIGlzIGluY29ycmVjdFwiKX1mdW5jdGlvbiBmKCl7ITE9PT1aJiYobi5sb2coXCJzdGFydGluZyBNUyBSZWcgcmV0cnkuLi5cIiksWj0hMCxYKDEwKSl9ZnVuY3Rpb24gWChhKXtpZigwPj1hKXtaPSExO24ubG9nKFwiVkRJIEV2ZW50OiBSZWcgS2V5IG5vdCBVcGRhdGVkIGFmdGVyIHRpbWVyIHJlcG9ydGVkLCBGYWxsYmFja1wiKTt0cnl7Uyh7ZXZlbnQ6XCJ2ZGlDbGllbnREaXNjb25uZWN0ZWRcIixyZWFzb246XCJmYWlsdXJlXCIsbXNnOlwiQ2l0cml4IFdlYnJ0YyBSZWRpciBSZWcgS2V5IG5vdCBQcmVzZW50XCJ9KX1jYXRjaChiKXtuLmxvZyhcIm9uVk1FdmVudCgpOiBleGNlcHRpb246IFwiK2IubWVzc2FnZSl9fWVsc2V7dmFyIGM9d2luZG93LmdldENpdHJpeFdlYnJ0Y1JlZGlyO3ZvaWQgMCE9PWM/YygpLnRoZW4oZnVuY3Rpb24oYil7bi5sb2coXCJDaXRyaXhNU1RlYW1zUmVkaXIgcmVnIHZhbHVlOlwiK1xyXG5iKTtcIjBcIj09PWJ8fFwiMVwiPT09Yj8oSyhiKSxaPSExKToobi5sb2coXCJNUyBUZWFtcyBSZWRpciBSZWcga2V5IG5vdCB1cGRhdGVkIC0gU3RhcnQgdGltZXJcIiksc2V0VGltZW91dChmdW5jdGlvbigpe24ubG9nKFwiVGltZXIgd2FpdGluZyBmb3IgcmVnaXN0cnkgdG8gYmUgdXBkYXRlZCBjb3VudCA6XCIrYSk7WCgtLWEpfSwxRTMpKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXtuLmxvZyhcIkZhaWx1cmUgdG8gUmVhZCBNUyBUZWFtcyByZWRpciBSZWcgS2V5IC0gU3RhcnQgdGltZXJcIik7c2V0VGltZW91dChmdW5jdGlvbigpe24ubG9nKFwiVGltZXIgd2FpdGluZyBmb3IgcmVnaXN0cnkgdG8gYmUgdXBkYXRlZCBjb3VudCA6XCIrYSk7WCgtLWEpfSwxRTMpfSk6KG4ubG9nKFwid2luZG93LmdldENpdHJpeFdlYnJ0Y1JlZGlyKCkgbWV0aG9kIGlzIG5vdCBhdmFpbGFibGUgeWV0XCIpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtuLmxvZyhcIlRpbWVyIHdhaXRpbmcgZm9yIHJlZ2lzdHJ5IHRvIGJlIHVwZGF0ZWQgY291bnQgOlwiK1xyXG5hKTtYKC0tYSl9LDFFMykpfX1mdW5jdGlvbiBiYSgpe24ubG9nKFwiVkRJIDogY2xlYW51cFwiKTtnLmdldFJlZGlyZWN0b3IoKS5jbGVhclJlcXMoKTtkLk5hdmlnYXRvclVzZXJNZWRpYS5yZXNldENhcGFiaWxpdGllcygpO1k9SD1JPW51bGw7TiYmTi5yZWxlYXNlKCk7TyYmTy5yZWxlYXNlKCk7Tz1udWxsO3YuU2NyZWVuU2hhcmluZy5kZXN0cm95SW5zdGFuY2UoKTtUJiYoVC5yZWxlYXNlKCksVD1udWxsKTtVJiYoVS5yZWxlYXNlKCksVT1udWxsKTt6KCkucmVzZXQoKTtuLmxvZyhcIlZESSA6IGNsZWFudXAgZG9uZVwiKX1mdW5jdGlvbiBjYSgpe3JldHVybiB2LlNjcmVlblNoYXJpbmcuc2NyZWVuU2hhcmluZ0luc3RhbmNlKGZ1bmN0aW9uKCl7aWYoUyl0cnl7Uyh7ZXZlbnQ6XCJ2ZGlTY3JlZW5Ub3BvbG9neUNoYW5nZWRcIn0pfWNhdGNoKGEpe24ubG9nKFwib25WTUV2ZW50KCd2ZGlTY3JlZW5Ub3BvbG9neUNoYW5nZWQnKTogZXhjZXB0aW9uOiBcIithLm1lc3NhZ2UpfX0pfWZ1bmN0aW9uIEUoYSl7aWYoIVYpdGhyb3cgbi5sb2coXCJWREkgU2hpbSBcIitcclxuYStcIjogdGhyb3dpbmcgZXhjZXB0aW9uOiBub3QgaW5pdGlhbGl6ZWQhIVwiKSxuZXcgRE9NRXhjZXB0aW9uKFwiVUNTREsgaXMgbm90IGluaXRpYWxpemVkISEhXCIpO312YXIgST1udWxsLGRhPWQuTmF2aWdhdG9yVXNlck1lZGlhLmdldENhcGFiaWxpdGllcyxIPW51bGwsWT1udWxsLE49bnVsbCxTPW51bGwsVD1udWxsLFU9bnVsbCxhYT0hMSxPPXZvaWQgMCxaPSExLFY9ITEsVz12b2lkIDA7cmV0dXJue0ZlYXR1cmVzOnQsQ2l0cml4UGVlckNvbm5lY3Rpb246aC5QZWVyQ29ubmVjdGlvbixnZXRVc2VyTWVkaWE6ZnVuY3Rpb24oYSxiLGMpe0UoXCJnZXRVc2VyTWVkaWFcIik7RygpO24ubG9nKFwiVkRJIFNoaW0gZ2V0VXNlck1lZGlhXCIpO251bGwhPT1JJiZJLmlzVmFsaWQoKXx8KEk9bmV3IGQuTmF2aWdhdG9yVXNlck1lZGlhKTt2YXIgZj1kLlJlbW90ZU1lZGlhU3RyZWFtQ29uc3RyYWludHMuaXNDb25zdHJhaW50c0F1ZGlvRGV2aWNlSWRFbXB0eShhKSxlPWQuUmVtb3RlTWVkaWFTdHJlYW1Db25zdHJhaW50cy5pc0NvbnN0cmFpbnRzVmlkZW9Tb3VyY2VJZEVtcHR5KGEpO1xyXG5yZXR1cm4gZnx8ZT9uZXcgUHJvbWlzZShmdW5jdGlvbihkLGYpe0guZW51bWVyYXRlRGV2aWNlcygpLnRoZW4oZnVuY3Rpb24oZCl7cmV0dXJuIEkud2Via2l0R2V0VXNlck1lZGlhKGEsYixjKX0pLnRoZW4oZnVuY3Rpb24oYSl7bi5sb2coXCJ3ZWJraXRHZXRVc2VyTWVkaWEgZm9yIGRlZmF1bHQgd2FzIHJlc29sdmVkXCIpO2QoYSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe24ubG9nKFwiZ2V0VXNlck1lZGlhKCkgZm9yIGRlZmF1bHQgZmFpbGVkIHdpdGggZXJyb3I6XCIrSlNPTi5zdHJpbmdpZnkoYSkpO2YoKX0pfSk6SS53ZWJraXRHZXRVc2VyTWVkaWEoYSxiLGMpfSxnZXREaXNwbGF5TWVkaWE6ZnVuY3Rpb24oYSl7RShcImdldERpc3BsYXlNZWRpYVwiKTtHKCk7bi5sb2coXCJWREkgU2hpbSBnZXREaXNwbGF5TWVkaWFcIik7bnVsbCE9PUgmJkguaXNWYWxpZCgpfHwoSD1uZXcgZC5SZW1vdGVEZXZpY2VzKTtyZXR1cm4gSC5nZXREaXNwbGF5TWVkaWEoYSl9LGVudW1lcmF0ZURldmljZXM6ZnVuY3Rpb24oKXtFKFwiZW51bWVyYXRlRGV2aWNlc1wiKTtcclxuRygpO24ubG9nKFwiVkRJIFNoaW0gZW51bWVyYXRlRGV2aWNlc1wiKTtudWxsIT09SCYmSC5pc1ZhbGlkKCl8fChIPW5ldyBkLlJlbW90ZURldmljZXMpO3JldHVybiBILmVudW1lcmF0ZURldmljZXMoKX0sb25XaW5kb3dDbG9zZTpmdW5jdGlvbihhLGMsZCl7RShcIm9uV2luZG93Q2xvc2VcIik7bi5sb2coXCJWREkgU2hpbSBvbldpbmRvd0Nsb3NlOiAoaGFuZGxlOiBcIithK1wiKVwiKTtnLmdldFJlZGlyZWN0b3IoKS5nZXRWREFGZWF0dXJlVmFsdWUobSkmJmIoZnVuY3Rpb24oYil7Yi5kaXNwb3NlRnJhbWUoYSl9KX0sc2V0Q2xpZW50QXJlYU9mZnNldDpmdW5jdGlvbihhLGIsZCl7RShcInNldENsaWVudEFyZWFPZmZzZXRcIik7bi5sb2coXCJWREkgc2V0Q2xpZW50QXJlYU9mZnNldCB3aXRoIHhPZmZzZXQgPSBcIithK1wiLCB5T2Zmc2V0ID0gXCIrYitcIiwgd2luZG93SGFuZGxlID0gXCIrZCk7RygpO2MoZCxmdW5jdGlvbihjKXtjLnNldENsaWVudEFyZWFPZmZzZXQoYSxiKX0pfSxtYXBWaWRlb0VsZW1lbnQ6ZnVuY3Rpb24oYSxcclxuYil7RShcIm1hcFZpZGVvRWxlbWVudFwiKTtuLmxvZyhcIlZESSBOZXcgVmlkZW8gRWxlbWVudCBDcmVhdGVkLCBDcmVhdGluZyBNYXBwaW5nIHRvIFRoaW4gQ2xpZW50IERPTVwiKTtHKCk7YyhiLGZ1bmN0aW9uKGIpe2IubmV3VmlkZW9FbGVtZW50KGEpfSl9LG1hcEF1ZGlvRWxlbWVudDpmdW5jdGlvbihhKXtFKFwibWFwQXVkaW9FbGVtZW50XCIpO24ubG9nKFwiVkRJIE5ldyBBdWRpbyBFbGVtZW50IENyZWF0ZWQsIENyZWF0aW5nIE1hcHBpbmcgdG8gVkRBXCIpO2lmKHZvaWQgMCE9PWEucmVtb3RlQXVkaW9FbGVtZW50KW4ubG9nKFwiQXVkaW8gZWxlbWVudCBpcyBhbHJlYWR5IGNvbmZpZ3VyZWQhXCIpO2Vsc2V7RygpO2RlbGV0ZSBhLnJlbW90ZUF1ZGlvRWxlbWVudDtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcInJlbW90ZUF1ZGlvRWxlbWVudFwiLHt3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITAsdmFsdWU6bnVsbH0pO2EucmVtb3RlQXVkaW9FbGVtZW50PW5ldyBwLkF1ZGlvRWxlbWVudDtkZWxldGUgYS5zaW5rSWQ7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwic2lua0lkXCIse2NvbmZpZ3VyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gYS5yZW1vdGVBdWRpb0VsZW1lbnQ/YS5yZW1vdGVBdWRpb0VsZW1lbnQuc2lua0lkOnZvaWQgMH0sc2V0OmZ1bmN0aW9uKGIpe24ubG9nKFwiVkRJIFNoaW0gc2V0IGF1ZGlvIGVsZW1lbnQgU2lua0lkIHZhbHVlID0gXCIrYik7YS5zZXRTaW5rSWQoYikudGhlbihmdW5jdGlvbigpe24ubG9nKFwiVkRJIFNoaW0gc2V0IGF1ZGlvIGVsZW1lbnQgU2lua0lkIHN1Y2Nlc3NcIil9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKCl7bi5sb2coXCJWREkgU2hpbSBzZXQgYXVkaW8gZWxlbWVudCBTaW5rSWQgZmFpbHVyZVwiKX0pfX0pO3ZhciBiPWEucmVtb3RlQXVkaW9FbGVtZW50LnBsYXk7YS5wbGF5PWZ1bmN0aW9uKCl7bi5sb2coXCJWREkgU2hpbSByZW1vdGUgYXVkaW8gcGxheVwiKTtyZXR1cm4gYi5hcHBseShhLnJlbW90ZUF1ZGlvRWxlbWVudCxhcmd1bWVudHMpfTt2YXIgYz1hLnJlbW90ZUF1ZGlvRWxlbWVudC5wYXVzZTtcclxuYS5wYXVzZT1mdW5jdGlvbigpe24ubG9nKFwiVkRJIFNoaW0gcmVtb3RlIGF1ZGlvIHBhdXNlXCIpO3JldHVybiBjLmFwcGx5KGEucmVtb3RlQXVkaW9FbGVtZW50LGFyZ3VtZW50cyl9O2Euc2V0U2lua0lkPWZ1bmN0aW9uKGIpe24ubG9nKFwiVkRJIFNoaW0gc2V0IGF1ZGlvIGVsZW1lbnQgU2lua0lkIHZhbHVlID0gXCIrYik7dmFyIGM9YS5yZW1vdGVBdWRpb0VsZW1lbnQuc2V0U2lua0lkKGIpLGY7ZC5lbnVtZXJhdGVkRGV2aWNlcy5mb3JFYWNoKGZ1bmN0aW9uKGEpe2I9PT1hLmRldmljZUlkJiYoZj1hLmxhYmVsKX0pO0YoZik7cmV0dXJuIGN9O2RlbGV0ZSBhLnNyY09iamVjdDtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcInNyY09iamVjdFwiLHtjb25maWd1cmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGEucmVtb3RlQXVkaW9FbGVtZW50P2EucmVtb3RlQXVkaW9FbGVtZW50LnNyY09iamVjdDp2b2lkIDB9LHNldDpmdW5jdGlvbihiKXtuLmxvZyhcIlZESSBTaGltIHNldCBhdWRpbyBlbGVtZW50IHNyY09iamVjdCBcIitcclxuSlNPTi5zdHJpbmdpZnkoYikpO2EucmVtb3RlQXVkaW9FbGVtZW50LnNyY09iamVjdD1ifX0pfX0sZGlzcG9zZVZpZGVvRWxlbWVudDpmdW5jdGlvbihhLGIpe0UoXCJkaXNwb3NlVmlkZW9FbGVtZW50XCIpO24ubG9nKFwiVkRJIFNoaW0gZGlzcG9zZVZpZGVvRWxlbWVudDogXCIpO00oYixmdW5jdGlvbihiKXtiLmRpc3Bvc2VWaWRlb0VsZW1lbnQoYSl9KX0sZGlzcG9zZUF1ZGlvRWxlbWVudDpmdW5jdGlvbihhLGIsYyl7RShcImRpc3Bvc2VBdWRpb0VsZW1lbnRcIik7bi5sb2coXCJWREkgU2hpbSBkaXNwb3NlQXVkaW9FbGVtZW50OiBcIik7YSYmKGI9YS5yZW1vdGVBdWRpb0VsZW1lbnQpJiYoYi5kaXNwb3NlKCksYS5yZW1vdGVBdWRpb0VsZW1lbnQ9dm9pZCAwKX0sc2V0Vk1FdmVudENhbGxiYWNrOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7Uz1hO2cuZ2V0UmVkaXJlY3RvcigpLmlzQ29ubmVjdGVkKCkmJk8uZ2V0U2Vzc2lvbkluZm8oKS50aGVuKGZ1bmN0aW9uKGEpe3JldHVybiBlKGIsdm9pZCAwLFxyXG52b2lkIDAsZnVuY3Rpb24oKXtyZXR1cm4gbCh0aGlzLGZ1bmN0aW9uKGIpe24ubG9nKFwiVkRJIFNoaW0gb25WZGlDbGllbnRDb25uZWN0ZWQsIGNsaWVudCBlbmRwb2ludCBpbmZvOlwiK0pTT04uc3RyaW5naWZ5KGEpKTtKKFwidmRpQ2xpZW50Q29ubmVjdGVkXCIse3ZlcnNpb246YSxlbmRwb2ludElkOmEuZW5kcG9pbnRJZH0pO3JldHVyblsyXX0pfSl9KTtuLmxvZyhcIlZESSBFdmVudCBDYWxsYmFjayBTZXRcIil9LHBsYXlOb3RpZnlBdWRpbzpmdW5jdGlvbihhLGIpe0UoXCJwbGF5Tm90aWZ5QXVkaW9cIik7bi5sb2coXCJWREkgU2hpbSBBdWRpbyBwbGF5Tm90aWZ5QXVkaW8gYXVkaW9JZDpcIithK1wiIHNyYzpcIitiKTtOJiZOLnBsYXlOb3RpZnlBdWRpbyhhLGIpfSxzdG9wTm90aWZ5QXVkaW86ZnVuY3Rpb24oYSxiKXtFKFwic3RvcE5vdGlmeUF1ZGlvXCIpO24ubG9nKFwiVkRJIFNoaW0gQXVkaW8gcGF1c2VOb3RpZnlBdWRpbyBhdWRpb0lkOlwiK2ErXCIgc3JjOlwiK2IpO04mJk4ucGF1c2VOb3RpZnlBdWRpbyhhLFxyXG5iKX0sc2V0U2lua0lkOmZ1bmN0aW9uKGEsYil7RShcInNldFNpbmtJZFwiKTtuLmxvZyhcIlZESSBTaGltIEF1ZGlvIHNldFNpbmtJZCBhdWRpb0lkOlwiK2ErXCIgc2lua0lkOlwiK2IpO04mJk4uc2V0U2lua0lkKGEsYil9LGdldExvb3A6ZnVuY3Rpb24oYSl7RShcImdldExvb3BcIik7dmFyIGI7TiYmKGI9Ti5nZXRMb29wKGEpKTtuLmxvZyhcIlZESSBTaGltIEF1ZGlvIGdldExvb3AgYXVkaW9JZDpcIithK1wiIGxvb3A6IFwiK2IpO3JldHVybiBifSxzZXRMb29wOmZ1bmN0aW9uKGEsYil7RShcInNldExvb3BcIik7bi5sb2coXCJWREkgU2hpbSBBdWRpbyBzZXRMb29wIGF1ZGlvSWQ6XCIrYStcIiBib29sOlwiK2IpO04mJk4uc2V0TG9vcChhLGIpfSxhZGRDbGlwUmVjdDpmdW5jdGlvbihhLGIpe0UoXCJhZGRDbGlwUmVjdFwiKTtuLmxvZyhcIlZESSBBZGRpbmcgT2NjbHVzaW9uIFwiK0pTT04uc3RyaW5naWZ5KGEpKTtjKGIsZnVuY3Rpb24oYil7Yi5hZGRPY2NsdXNpb24oYSl9KX0scmVtb3ZlQ2xpcFJlY3Q6ZnVuY3Rpb24oYSxcclxuYil7RShcInJlbW92ZUNsaXBSZWN0XCIpO24ubG9nKFwiVkRJIFJlbW92aW5nIE9jY2x1c2lvbiBcIitKU09OLnN0cmluZ2lmeShhKSk7YyhiLGZ1bmN0aW9uKGIpe2IucmVtb3ZlT2NjbHVzaW9uKGEpfSl9LGluaXRMb2c6ZnVuY3Rpb24oYSxiKXtuLnNldE1TTG9nZ2VyKGEsYik7bi5sb2coXCJWREkgaW5pdCBsb2dnZXJcIil9LGlzRmVhdHVyZU9uOmZ1bmN0aW9uKGEpe0UoXCJpc0ZlYXR1cmVPblwiKTtyZXR1cm4gTz9PLmlzRmVhdHVyZVN1cHBvcnRlZChhKTohMX0sb25Db25uZWN0aW9uQ2hhbmdlOmZ1bmN0aW9uKGEpe0UoXCJvbkNvbm5lY3Rpb25DaGFuZ2VcIik7bi5sb2coXCJWREkgOiBvbkNvbm5lY3Rpb25DaGFuZ2UgdG8gXCIrYSk7ITE9PT1hP24ubG9nKFwiRGlzY29ubmVjdGluZyBmcm9tIHRoZSBWREFcIik6KG4ubG9nKFwiQ29ubmVjdGluZyB0byB0aGUgVkRBXCIpLGE9d2luZG93LmdldENpdHJpeFdlYnJ0Y1JlZGlyLHZvaWQgMCE9PWE/YSgpLnRoZW4oZnVuY3Rpb24oYSl7bi5sb2coXCJTdWNlc3NzIG9uIGNvbm5lY3QsIENpdHJpeFJlZGlyIHJlZyB2YWx1ZTpcIitcclxuYSk7XCIwXCI9PT1hfHxcIjFcIj09PWE/SyhhKToobi5sb2coXCJNUyBUZWFtcyBSZWRpciBSZWcga2V5IG5vdCB1cGRhdGVkIHlldFwiKSxmKCkpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe24ubG9nKFwiRmFpbHVyZSB0byBSZWFkIE1TIFRlYW1zIHJlZGlyIFJlZyBLZXlcIik7ZigpfSk6KG4ubG9nKFwid2luZG93LmdldENpdHJpeFdlYnJ0Y1JlZGlyKCkgbWV0aG9kIGlzIG5vdCBhdmFpbGFibGUgeWV0XCIpLGYoKSkpfSxnZXRTY3JlZW5zQXN5bmM6ZnVuY3Rpb24oKXtFKFwiZ2V0U2NyZWVuc0FzeW5jXCIpO24ubG9nKFwiVkRJIFNoaW0gZ2V0U2NyZWVuc0FzeW5jXCIpO0coKTt2YXIgYT1jYSgpO3JldHVybiBhLmdldFNjcmVlbnNBc3luYy5hcHBseShhLGFyZ3VtZW50cyl9LGdldFdpbmRvd3NBc3luYzpmdW5jdGlvbigpe0UoXCJnZXRXaW5kb3dzQXN5bmNcIik7bi5sb2coXCJWREkgU2hpbSBnZXRXaW5kb3dzQXN5bmNcIik7RygpO3ZhciBhPWNhKCk7cmV0dXJuIGEuZ2V0V2luZG93c0FzeW5jLmFwcGx5KGEsXHJcbmFyZ3VtZW50cyl9LHNldFNjcmVlblNoYXJlUGFuZWxJZDpmdW5jdGlvbihhKXtFKFwic2V0U2NyZWVuU2hhcmVQYW5lbElkXCIpO24ubG9nKFwiVkRJOiBzZXRTY3JlZW5TaGFyZVBhbmVsSWQgc2V0IHRvIFwiK0pTT04uc3RyaW5naWZ5KGEpKTtHKCk7bnVsbCE9PUgmJkguaXNWYWxpZCgpfHwoSD1uZXcgZC5SZW1vdGVEZXZpY2VzKTtILnBhbmVsaWQ9YX0sc2V0Q29kZWNDYXBhYmlsaXRpZXM6ZnVuY3Rpb24oYSl7RShcInNldENvZGVjQ2FwYWJpbGl0aWVzXCIpO0coKTtuLmxvZyhcIlZESSBTaGltIHNldENvZGVjQ2FwYWJpbGl0aWVzXCIpO251bGwhPT1JJiZJLmlzVmFsaWQoKXx8KEk9bmV3IGQuTmF2aWdhdG9yVXNlck1lZGlhKTtyZXR1cm4gSS5zZXRDb2RlY0NhcGFiaWxpdGllcyhhKX0sZ2V0RTkxMURhdGE6ZnVuY3Rpb24oKXtFKFwiZ2V0RTkxMURhdGFcIik7cmV0dXJuIFQ/VC5nZXRFOTExSW5mbygpOm51bGx9LGNyZWF0ZU1lZGlhU3RyZWFtOmZ1bmN0aW9uKGIpe0UoXCJjcmVhdGVNZWRpYVN0cmVhbVwiKTtcclxubi5sb2coXCJWREkgU2hpbSBjcmVhdGVNZWRpYVN0cmVhbVwiKTtyZXR1cm4gYShiLCExKX0sY3JlYXRlTWVkaWFTdHJlYW1Bc3luYzpmdW5jdGlvbihiKXtFKFwiY3JlYXRlTWVkaWFTdHJlYW1Bc3luY1wiKTtuLmxvZyhcIlZESSBTaGltIGNyZWF0ZU1lZGlhU3RyZWFtQXN5bmNcIik7cmV0dXJuIGEoYiwhMCl9LGRpc3Bvc2VNZWRpYVN0cmVhbTpmdW5jdGlvbihhKXtFKFwiZGlzcG9zZU1lZGlhU3RyZWFtXCIpO24ubG9nKFwiVkRJIFNoaW0gZGlzcG9zZU1lZGlhU3RyZWFtOiBcIik7Zm9yKHZhciBiPTA7YjxhLmxlbmd0aDtiKyspe3ZhciBjPWFbYl07YyYmYy5kaXNwb3NlKCl9fSxnZXRDYXBhYmlsaXRpZXM6ZnVuY3Rpb24oYSl7RShcImdldENhcGFiaWxpdGllc1wiKTtHKCk7bi5sb2coXCJWREkgU2hpbSBnZXRDYXBhYmlsaXRpZXNcIik7bnVsbCE9PUkmJkkuaXNWYWxpZCgpfHwoST1uZXcgZC5OYXZpZ2F0b3JVc2VyTWVkaWEsZGE9ZC5OYXZpZ2F0b3JVc2VyTWVkaWEuZ2V0Q2FwYWJpbGl0aWVzKTtcclxucmV0dXJuIGRhLmFwcGx5KEksYXJndW1lbnRzKX0saW5pdFVDU0RLOmZ1bmN0aW9uKGEpe24ubG9nKFwiVkRJIFNoaW0gaW5pdFVDU0RLIHZlbmRvcjpcIithKTt2YXIgYj0hMDt2b2lkIDA9PWF8fG51bGw9PWF8fFwic3RyaW5nXCIhPT10eXBlb2YgYXx8MD09YS5sZW5ndGg/Yj0hMTowPT1hLnNwbGl0KFwiIFwiKS5qb2luKFwiXCIpLmxlbmd0aCYmKGI9ITEpO2lmKCFiKXRocm93IG4ubG9nKFwiVkRJIFNoaW0gaW5pdFVDU0RLOiB0aHJvd2luZyBleGNlcHRpb246IHZlbmRvciBpbmZvIGNhbm5vdCBiZSBlbXB0eSEhIVwiKSxuZXcgRE9NRXhjZXB0aW9uKFwidmVuZG9yIGluZm8gY2Fubm90IGJlIGVtcHR5LCBwbGVhc2UgcGFzcyB2ZW5kb3IgaW5mbyBzdHJpbmchISFcIik7Vnx8KFc9YSxJPW5ldyBkLk5hdmlnYXRvclVzZXJNZWRpYSxIPW5ldyBkLlJlbW90ZURldmljZXMsTj1uZXcgeSxIPW5ldyBkLlJlbW90ZURldmljZXMsUChXKSx3aW5kb3cub25WZGlDbGllbnREaXNjb25uZWN0ZWQ9TCx3aW5kb3cub25WZGlDbGllbnREaXNjb25uZWN0ZWRUaW1lcj1cclxuQyx3aW5kb3cub25WZGlDbGllbnRDb25uZWN0ZWQ9UixWPSEwKX0sZGVpbml0VUNTREs6ZnVuY3Rpb24oKXtuLmxvZyhcIlZESSBTaGltIGRlaW5pdFVDU0RLXCIpO1YmJihnLmdldFJlZGlyZWN0b3IoKS50ZXJtaW5hdGVPcHRpbWl6YXRpb24oKSxiYSgpLHdpbmRvdy5vblZkaUNsaWVudERpc2Nvbm5lY3RlZD12b2lkIDAsd2luZG93Lm9uVmRpQ2xpZW50RGlzY29ubmVjdGVkVGltZXI9dm9pZCAwLFc9d2luZG93Lm9uVmRpQ2xpZW50Q29ubmVjdGVkPXZvaWQgMCxWPSExKX19fSl9LDY3OTpmdW5jdGlvbihiLGEsYyl7dmFyIGU9dGhpcyYmdGhpcy5fX2V4dGVuZHN8fGZ1bmN0aW9uKCl7dmFyIGE9ZnVuY3Rpb24oYixjKXthPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihhLGIpe2EuX19wcm90b19fPWJ9fHxmdW5jdGlvbihhLGIpe2Zvcih2YXIgYyBpbiBiKWIuaGFzT3duUHJvcGVydHkoYykmJihhW2NdPWJbY10pfTtcclxucmV0dXJuIGEoYixjKX07cmV0dXJuIGZ1bmN0aW9uKGIsYyl7ZnVuY3Rpb24gZCgpe3RoaXMuY29uc3RydWN0b3I9Yn1hKGIsYyk7Yi5wcm90b3R5cGU9bnVsbD09PWM/T2JqZWN0LmNyZWF0ZShjKTooZC5wcm90b3R5cGU9Yy5wcm90b3R5cGUsbmV3IGQpfX0oKTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTthLlZpZGVvRWxlbWVudD1hLlZpZGVvUmVjdD12b2lkIDA7dmFyIGw9Yyg2NTgpLGg9Yyg1NTApLGQ9Yyg4NTEpLHA9Yyg5NDYpLHE9Yyg1NTApLG49ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiKXt0aGlzLng9TWF0aC5yb3VuZChhLngpKmIuZGV2aWNlUGl4ZWxSYXRpbzt0aGlzLnk9TWF0aC5yb3VuZChhLnkpKmIuZGV2aWNlUGl4ZWxSYXRpbzt0aGlzLndpZHRoPU1hdGgucm91bmQoYS53aWR0aCkqYi5kZXZpY2VQaXhlbFJhdGlvO3RoaXMuaGVpZ2h0PU1hdGgucm91bmQoYS5oZWlnaHQpKmIuZGV2aWNlUGl4ZWxSYXRpb319KCk7XHJcbmEuVmlkZW9SZWN0PW47dmFyIGs7KGZ1bmN0aW9uKGEpe2FbYS5waXhlbHM9MF09XCJwaXhlbHNcIjthW2EucGVyY2VudD0xXT1cInBlcmNlbnRcIn0pKGt8fChrPXt9KSk7dmFyIHY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIpe3RoaXMudmFsdWU9cGFyc2VJbnQoYik7dGhpcy51bml0cz10aGlzLmRldGVjdFVuaXRzKGIpfWEucHJvdG90eXBlLmRldGVjdFVuaXRzPWZ1bmN0aW9uKGEpe3JldHVybi0xPT09YS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoXCJweFwiKT9rLnBpeGVsczprLnBlcmNlbnR9O3JldHVybiBhfSgpLHo7KGZ1bmN0aW9uKGEpe2FbYS5maWxsPTBdPVwiZmlsbFwiO2FbYS5jb250YWluPTFdPVwiY29udGFpblwiO2FbYS5jb3Zlcj0yXT1cImNvdmVyXCJ9KSh6fHwoej17fSkpO3ZhciBnPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYil7dGhpcy54PWE7dGhpcy55PWJ9fSgpLEI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsYyxkKXt0aGlzLmZpdD10aGlzLmNvbnZlcnRGaXQoYik7dGhpcy5wb3NpdGlvbj1cclxubmV3IGcoYyxkKX1hLnByb3RvdHlwZS5jb252ZXJ0Rml0PWZ1bmN0aW9uKGEpe3JldHVyblwiZmlsbFwiPT1hP3ouZmlsbDpcImNvbnRhaW5cIj09YT96LmNvbnRhaW46XCJjb3ZlclwiPT1hP3ouY292ZXI6ei5maWxsfTtyZXR1cm4gYX0oKSx0OyhmdW5jdGlvbihhKXthW2EuTm90UmVhZHk9MF09XCJOb3RSZWFkeVwiO2FbYS5SZWFkeT0xXT1cIlJlYWR5XCJ9KSh0fHwodD17fSkpO2I9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihjLGUpe3ZhciBnPWEuY2FsbCh0aGlzLG51bGwsaC5jbGFzc19pZF90LlZpZGVvRWxlbWVudCwwLGwuUHJveHlNb2RlLkxvY2FsKXx8dGhpcztnLnNyY09iamVjdF89bnVsbDtnLnNpbmtJZF89XCJcIjtnLnZpZGVvV2lkdGg9MDtnLnZpZGVvSGVpZ2h0PTA7Zy5pc0xvYWRlZD0hMTtnLmNvbm5lY3Rpb25TdGF0ZT1cImRpc2Nvbm5lY3RlZFwiO2cuc3R5bGVPYnNlcnZlcj1udWxsO2cucmVhZHlTdGF0ZV89dC5Ob3RSZWFkeTtnLmRlZmVycmVkVmlkZW9BY3Rpb25zPVtdO2cucGVuZGluZ1JlbGVhc2VfPVxyXG4hMTtnLmFjdGl2ZUNvbm5lY3Rpb25FdmVudF89bnVsbDtnLmNvbm5lY3Rpb25FdmVudFF1ZXVlXz1bXTtnLndpbmRvd189ZTtnLmVsZW1lbnRJZD1jO2QubG9nZ2VyLmxvZyhcIlZpZGVvRWxlbWVudC5jb25zdHJ1Y3RvciAoZWxlbWVudGlkOiBcIitjK1wiKVwiKTtyZXR1cm4gZ31lKGIsYSk7Yi5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3ZhciBhPXRoaXM7ZC5sb2dnZXIubG9nKFwiVmlkZW9FbGVtZW50LmRpc3Bvc2UgKGVsZW1lbnRJZDogXCIrdGhpcy5lbGVtZW50SWQrXCIgb2lkOiBcIit0aGlzLm9iamVjdF9pZCgpK1wiKVwiKTt0aGlzLnBlbmRpbmdSZWxlYXNlXz0hMDt0aGlzLnNyY09iamVjdD10aGlzLm9udGltZXVwZGF0ZT10aGlzLm9ubG9hZGVkbWV0YWRhdGE9bnVsbDt0aGlzLndhaXRVbnRpbFJlYWR5KFwiVmlkZW9FbGVtZW50LmRpc3Bvc2VcIikudGhlbihmdW5jdGlvbigpe30pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oKXthLnBlbmRpbmdSZWxlYXNlXz0hMTthLnNldFN0YXRlKFwiZGlzY29ubmVjdGVkXCIpO1xyXG5hLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlPW51bGw7YS5yZWxlYXNlKCl9KTt0aGlzLm9uUmVhZHkoKX07Yi5wcm90b3R5cGUuc2V0U3RhdGU9ZnVuY3Rpb24oYSl7dGhpcy5jb25uZWN0aW9uU3RhdGU9YTtpZih0aGlzLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlXyl0aGlzLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlXygpfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJJZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbGVtZW50SWR9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGIucHJvdG90eXBlLFwic2lua0lkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNpbmtJZF99LHNldDpmdW5jdGlvbihhKXt2YXIgYj10aGlzO2QubG9nZ2VyLmxvZyhcIlZpZGVvRWxlbWVudC5zaW5rSWQ6IChpZD1cIithK1wiKVwiKTt0aGlzLndhaXRVbnRpbENvbm5lY3RlZChcIlZpZGVvRWxlbWVudC5zaW5rSWRcIikudGhlbihmdW5jdGlvbigpe3JldHVybiB2b2lkIDAhPVxyXG5hP2IucmVtb3RlSW52b2tlKCEwLGgubWV0aG9kX2lkX1ZpZGVvRWxlbWVudF90LnNpbmtJZCxhKTpuZXcgUHJvbWlzZShmdW5jdGlvbihhKXtyZXR1cm4gYSh2b2lkIDApfSl9KS50aGVuKGZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKFwidmlkZW9FbGVtZW50OiBzZXR0aW5nIHN0YXRlIHRvIHJlYWR5LiAob2lkOiBcIitiLm9iamVjdF9pZCgpK1wiKVwiKTtiLnNpbmtJZF89YTtiLnJlYWR5U3RhdGVfPXQuUmVhZHk7Yi5vblJlYWR5KCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcIi5zZXRfc2lua0lkKCkgZmFpbGVkIVwiKX0pfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eShiLnByb3RvdHlwZSxcInNyY09iamVjdFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zcmNPYmplY3RffSxzZXQ6ZnVuY3Rpb24oYSl7ZC5sb2dnZXIubG9nKHRoaXMudXNlcl9mcmllbmRseV9pZCgpK1wiLnNyY09iamVjdDogc2V0IHNyY09iamVjdC4uLiB0aGlzLnNyY09iamVjdDpcIitcclxudGhpcy5zcmNPYmplY3QrXCIgb2JqOlwiK2EpO2lmKHRoaXMuc3JjT2JqZWN0XyE9PWEpe3ZhciBiPXAuZ2V0UmVkaXJlY3RvcigpLmdldEZlYXR1cmVWYWx1ZShxLkZFQVRVUkVfbXNfdGVhbXNfMTkxMSk7bnVsbCE9PXRoaXMuc3JjT2JqZWN0XyYmKG51bGw9PT1hJiZiJiZ0aGlzLmRpc2Nvbm5lY3QoKSxifHx0aGlzLmRpc2Nvbm5lY3QoKSx0aGlzLmlzTG9hZGVkPSExKTt0aGlzLnNyY09iamVjdF89YTtudWxsIT09dGhpcy5zcmNPYmplY3RfJiZ0aGlzLmNvbm5lY3RUbyh0aGlzLnNyY09iamVjdF8pfX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZV99LHNldDpmdW5jdGlvbihhKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29uY29ubmVjdGlvbnN0YXRlY2hhbmdlKCkgY2FsbGVkLlwiKTtcclxudGhpcy5vbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZV89YX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJvbmxvYWRlZG1ldGFkYXRhXCIse3NldDpmdW5jdGlvbihhKXtkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0X29ubG9hZGVkbWV0YWRhdGEoKSBjYWxsZWQuXCIpO3RoaXMub25sb2FkZWRtZXRhZGF0YV89YX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KTtiLnByb3RvdHlwZS5zZXR1cE9uVmlkZW9GcmFtZUNoYW5nZWQ9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9dGhpcy5yZWdpc3RlckNhbGxiYWNrcyghMSwhMSxoLm1ldGhvZF9pZF9WaWRlb0VsZW1lbnRfdC5vbnZpZGVvZnJhbWVjaGFuZ2VkKTtiLnRoZW4oZnVuY3Rpb24oYil7ZC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLm9udmlkZW9mcmFtZWNoYW5nZWRcIixiLnBhcmFtcyk7YS52aWRlb1dpZHRoPVxyXG5iLnBhcmFtc1swXXx8MDthLnZpZGVvSGVpZ2h0PWIucGFyYW1zWzFdfHwwO2EuaXNMb2FkZWR8fChhLmlzTG9hZGVkPSEwLGEub25sb2FkZWRtZXRhZGF0YV8mJmEub25sb2FkZWRtZXRhZGF0YV8oKSl9KTt0aGlzLnJlbW90ZUludm9rZSghMCxoLm1ldGhvZF9pZF9WaWRlb0VsZW1lbnRfdC5vbnZpZGVvZnJhbWVjaGFuZ2VkLGIuc3VjY2Vzcyl9O2IucHJvdG90eXBlLnByb2Nlc3NDb25uZWN0aW9uRXZlbnQ9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2lmKDAhPT10aGlzLmNvbm5lY3Rpb25FdmVudFF1ZXVlXy5sZW5ndGgmJiF0aGlzLmFjdGl2ZUNvbm5lY3Rpb25FdmVudF8pe3ZhciBiPXRoaXMuY29ubmVjdGlvbkV2ZW50UXVldWVfLnBvcCgpO1wiY29ubmVjdFRvXCI9PWIub3BlcmF0aW9uP3RoaXMuYWN0aXZlQ29ubmVjdGlvbkV2ZW50Xz10aGlzLmNvbm5lY3RUb0FzeW5jKGIucGFyYW0pOlwiZGlzY29ubmVjdFwiPT1iLm9wZXJhdGlvbiYmKHRoaXMuYWN0aXZlQ29ubmVjdGlvbkV2ZW50Xz1cclxudGhpcy5kaXNjb25uZWN0QXN5bmMoKSk7dGhpcy5hY3RpdmVDb25uZWN0aW9uRXZlbnRfLnRoZW4oZnVuY3Rpb24oKXthLmFjdGl2ZUNvbm5lY3Rpb25FdmVudF89dm9pZCAwO2EucHJvY2Vzc0Nvbm5lY3Rpb25FdmVudCgpfSlbXCJjYXRjaFwiXShmdW5jdGlvbigpe2QubG9nZ2VyLmxvZyhhLnVzZXJfZnJpZW5kbHlfaWQoKStcIiA6IEZhaWxlZCB0byBoYW5kbGUgY29ubmVjdGlvbiBldmVudCEgXCIpO2EuYWN0aXZlQ29ubmVjdGlvbkV2ZW50Xz12b2lkIDA7YS5wcm9jZXNzQ29ubmVjdGlvbkV2ZW50KCl9KX19O2IucHJvdG90eXBlLmNvbm5lY3RUbz1mdW5jdGlvbihhKXt0aGlzLmNvbm5lY3Rpb25FdmVudFF1ZXVlXy5wdXNoKHtvcGVyYXRpb246XCJjb25uZWN0VG9cIixwYXJhbTphfSk7dGhpcy5wcm9jZXNzQ29ubmVjdGlvbkV2ZW50KCl9O2IucHJvdG90eXBlLmRpc2Nvbm5lY3Q9ZnVuY3Rpb24oKXt0aGlzLmNvbm5lY3Rpb25FdmVudFF1ZXVlXy5wdXNoKHtvcGVyYXRpb246XCJkaXNjb25uZWN0XCIsXHJcbnBhcmFtOm51bGx9KTt0aGlzLnByb2Nlc3NDb25uZWN0aW9uRXZlbnQoKX07Yi5wcm90b3R5cGUuY29ubmVjdFRvQXN5bmM9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxlKXtkLmxvZ2dlci5sb2coYi51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuY29ubmVjdFRvOiBjb25uZWN0IG1lZGlhIHN0cmVhbSB3aXRoIGlkID0gXCIrYS5pZCtcIiwgY2xvbmVfaWQgPSBcIithLmNsb25lX3N0YXRlLmNsb25lX2lkKTtiLnN0cmVhbUlkXz1hLmlkO2Iud2FpdFVudGlsUmVhZHkoXCJWaWRlb0VsZW1lbnQuY29ubmVjdFRvXCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYS53YWl0VW50aWxDb25uZWN0ZWQoXCJNZWRpYVN0cmVhbS5jb25uZWN0VG9cIil9KS50aGVuKGZ1bmN0aW9uKCl7Yi5zZXR1cE9uVmlkZW9GcmFtZUNoYW5nZWQoKTtyZXR1cm4gYS5jbG9uZV9zdGF0ZS5zeW5jaHJvbml6ZShhKX0pLnRoZW4oZnVuY3Rpb24oYSl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1xyXG5cIi5jb25uZWN0VG86IHJlbW90ZSBpbnZva2luZ1wiKTt2YXIgYz1iLnJlZ2lzdGVyQ2FsbGJhY2tzKCEwLCExLGgubWV0aG9kX2lkX1ZpZGVvRWxlbWVudF90LmNvbm5lY3RUbyk7cmV0dXJuIFByb21pc2UuYWxsKFtiLnJlbW90ZUludm9rZUV4KCExLGgubWV0aG9kX2lkX1ZpZGVvRWxlbWVudF90LmNvbm5lY3RUbyxbYV0sYy5zdWNjZXNzLGMuZmFpbCksYy5wcm9tKCldKX0pLnRoZW4oZnVuY3Rpb24oYSl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLmNvbm5lY3RUbzogcmVtb3RlIG1lZGlhIHN0cmVhbSBpcyBjb25uZWN0ZWQhXCIpO2Iuc2V0U3RhdGUoXCJjb25uZWN0ZWRcIik7Yi53YXRjaCgpO2IudXBkYXRlVGltZXI9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtiLm9udGltZXVwZGF0ZSYmYi5vbnRpbWV1cGRhdGUoKX0sMjUwKTsoYT1iLndpbmRvd18uZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYi5lbGVtZW50SWQpKSYmYi51cGRhdGVTdHlsZShhKTtjKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGEpe2IubG9nUmVtb3RlSW52b2tlRXJyb3IoYSxcclxuXCIuY29ubmVjdFRvOiBmYWlsZWQgdG8gY29ubmVjdCFcIik7ZSgpfSl9KX07Yi5wcm90b3R5cGUuZGlzY29ubmVjdEFzeW5jPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYixjKXtkLmxvZ2dlci5sb2coYS51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuZGlzY29ubmVjdDogZGlzY29ubmVjdGluZyBzdHJlYW0gOiBcIithLnN0cmVhbUlkXyk7YS51bndhdGNoKCk7YS53YWl0VW50aWxSZWFkeShcIlZpZGVvRWxlbWVudC5kaXNjb25uZWN0XCIpLnRoZW4oZnVuY3Rpb24oKXthLnVwZGF0ZVRpbWVyJiZjbGVhckludGVydmFsKGEudXBkYXRlVGltZXIpO3ZhciBiPWEucmVnaXN0ZXJDYWxsYmFja3MoITEsITAsaC5tZXRob2RfaWRfVmlkZW9FbGVtZW50X3Qub252aWRlb2ZyYW1lY2hhbmdlZCk7YS5yZW1vdGVJbnZva2UoITAsaC5tZXRob2RfaWRfVmlkZW9FbGVtZW50X3Qub252aWRlb2ZyYW1lY2hhbmdlZCxiLnN1Y2Nlc3MpO3JldHVybiBhLnJlbW90ZUludm9rZSghMSxcclxuaC5tZXRob2RfaWRfVmlkZW9FbGVtZW50X3QuZGlzY29ubmVjdCl9KS50aGVuKGZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKGEudXNlcl9mcmllbmRseV9pZCgpK1wiLmRpc2Nvbm5lY3Q6IHJlbW90ZSBtZWRpYSBzdHJlYW0gaXMgZGlzY29ubmVjdGVkIVwiKTthLnNldFN0YXRlKFwiZGlzY29ubmVjdGVkXCIpOzE9PWEucGVuZGluZ1JlbGVhc2VfJiYoYS5wZW5kaW5nUmVsZWFzZV89ITEsYS5vbmNvbm5lY3Rpb25zdGF0ZWNoYW5nZT1udWxsLGEucmVsZWFzZSgpKTtiKCl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGIpe2EubG9nUmVtb3RlSW52b2tlRXJyb3IoYixcIi5kaXNjb25uZWN0OiBmYWlsZWQgdG8gY29ubmVjdCFcIik7YygpfSl9KX07Yi5wcm90b3R5cGUuc2V0RnJhbWU9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuc2V0RnJhbWU6IHNldCB2aWRlbyBmcmFtZSB0b1wiLGEueCxhLnksYS53aWR0aCxhLmhlaWdodCk7dGhpcy53YWl0VW50aWxSZWFkeShcIlZpZGVvRWxlbWVudC5zZXRGcmFtZVwiKS50aGVuKGZ1bmN0aW9uKCl7dmFyIGM9XHJcbm5ldyBuKGEsYi53aW5kb3dfKTtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITEsaC5tZXRob2RfaWRfVmlkZW9FbGVtZW50X3Quc2V0RnJhbWUsYyl9KS50aGVuKGZ1bmN0aW9uKCl7ZC5sb2dnZXIubG9nKGIudXNlcl9mcmllbmRseV9pZCgpK1wiLnNldEZyYW1lOiBzdWNjZXNzIVwiKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnNldEZyYW1lOiBmYWlsZWQgdG8gY29ubmVjdCFcIil9KX07Yi5wcm90b3R5cGUuYWRkQ2xpcFJlY3Q9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIuYWRkQ2xpcFJlY3Q6IFwiLEpTT04uc3RyaW5naWZ5KGEpKTt0aGlzLndhaXRVbnRpbFJlYWR5KFwiVmlkZW9FbGVtZW50LmFkZENsaXBSZWN0XCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1uZXcgbihhLGIud2luZG93Xyk7cmV0dXJuIGIucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1ZpZGVvRWxlbWVudF90LmFkZENsaXBSZWN0LFxyXG5jKX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLmFkZENsaXBSZWN0IGZhaWxlZCFcIil9KX07Yi5wcm90b3R5cGUucmVtb3ZlQ2xpcFJlY3Q9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztkLmxvZ2dlci5sb2codGhpcy51c2VyX2ZyaWVuZGx5X2lkKCkrXCIucmVtb3ZlQ2xpcFJlY3Q6IFwiLEpTT04uc3RyaW5naWZ5KGEpKTt0aGlzLndhaXRVbnRpbFJlYWR5KFwiVmlkZW9FbGVtZW50LnJlbW92ZUNsaXBSZWN0XCIpLnRoZW4oZnVuY3Rpb24oKXt2YXIgYz1uZXcgbihhLGIud2luZG93Xyk7cmV0dXJuIGIucmVtb3RlSW52b2tlKCExLGgubWV0aG9kX2lkX1ZpZGVvRWxlbWVudF90LnJlbW92ZUNsaXBSZWN0LGMpfSlbXCJjYXRjaFwiXShmdW5jdGlvbihhKXtiLmxvZ1JlbW90ZUludm9rZUVycm9yKGEsXCIucmVtb3ZlQ2xpcFJlY3QgZmFpbGVkIVwiKX0pfTtiLnByb3RvdHlwZS53YXRjaD1mdW5jdGlvbigpe3ZhciBhPXRoaXM7aWYocC5nZXRSZWRpcmVjdG9yKCkuZ2V0RmVhdHVyZVZhbHVlKHEuRkVBVFVSRV9tc190ZWFtc192aWRlb19wbGFjZW1lbnQpKXt2YXIgYj1cclxudGhpcy53aW5kb3dfLmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuZWxlbWVudElkKTtiJiYodGhpcy51bndhdGNoKCksdGhpcy5zdHlsZU9ic2VydmVyPW5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uKGIpe2IuZm9yRWFjaChmdW5jdGlvbihiKXtcInN0eWxlXCI9PWIuYXR0cmlidXRlTmFtZT9hLnVwZGF0ZVN0eWxlKGIudGFyZ2V0KTphLmVsZW1lbnRJZD1iLnRhcmdldC5pZH0pfSksdGhpcy5zdHlsZU9ic2VydmVyLm9ic2VydmUoYix7YXR0cmlidXRlczohMCxhdHRyaWJ1dGVPbGRWYWx1ZTohMCxhdHRyaWJ1dGVGaWx0ZXI6W1wic3R5bGVcIixcImlkXCJdfSkpfX07Yi5wcm90b3R5cGUudW53YXRjaD1mdW5jdGlvbigpe3RoaXMuc3R5bGVPYnNlcnZlciYmKHRoaXMuc3R5bGVPYnNlcnZlci5kaXNjb25uZWN0KCksdGhpcy5zdHlsZU9ic2VydmVyPW51bGwpfTtiLnByb3RvdHlwZS51cGRhdGVTdHlsZT1mdW5jdGlvbihhKXtpZihcImNvbm5lY3RlZFwiPT10aGlzLmNvbm5lY3Rpb25TdGF0ZSl7dmFyIGI9XHJcbnRoaXMud2luZG93Xy5nZXRDb21wdXRlZFN0eWxlKGEpLmdldFByb3BlcnR5VmFsdWUoXCJvYmplY3QtZml0XCIpLGM9dGhpcy53aW5kb3dfLmdldENvbXB1dGVkU3R5bGUoYSkuZ2V0UHJvcGVydHlWYWx1ZShcIm9iamVjdC1wb3NpdGlvblwiKS5zcGxpdChcIiBcIik7YT1uZXcgdihjWzBdKTtjPW5ldyB2KGNbMV0pO3RoaXMucGxhY2VtZW50PW5ldyBCKGIsYSxjKX1lbHNlIGQubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi51cGRhdGVTdHlsZTogdmlkZW8gZWxlbWVudCBpcyBub3QgY29ubmVjdGVkXCIpfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYi5wcm90b3R5cGUsXCJwbGFjZW1lbnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGxhY2VtZW50X30sc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7cC5nZXRSZWRpcmVjdG9yKCkuZ2V0RmVhdHVyZVZhbHVlKHEuRkVBVFVSRV9tc190ZWFtc192aWRlb19wbGFjZW1lbnQpP3RoaXMud2FpdFVudGlsUmVhZHkoXCJWaWRlb0VsZW1lbnQucGxhY2VtZW50XCIpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gYi5yZW1vdGVJbnZva2UoITAsXHJcbmgubWV0aG9kX2lkX1ZpZGVvRWxlbWVudF90LnBsYWNlbWVudCxhKX0pLnRoZW4oZnVuY3Rpb24oKXtiLnBsYWNlbWVudF89YX0pW1wiY2F0Y2hcIl0oZnVuY3Rpb24oYSl7Yi5sb2dSZW1vdGVJbnZva2VFcnJvcihhLFwiLnBsYWNlbWVudCBzZXR0ZXI6IGZhaWxlZCB0byBjb25uZWN0IVwiKX0pOmQubG9nZ2VyLmxvZyh0aGlzLnVzZXJfZnJpZW5kbHlfaWQoKStcIi5wbGFjZW1lbnQ6IHZpZGVvIHBsYWNlbWVudCBmZWF0dXJlIGlzIG5vdCBzdXBwb3J0ZWQgb24gYSBjbGllbnRcIil9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7Yi5wcm90b3R5cGUud2FpdFVudGlsUmVhZHk9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24oYyxlKXtkLmxvZ2dlci5sb2coXCJWaWRlb0VsZW1lbnQud2FpdFVudGlsUmVhZHkoKTogcmVhZHlTdGF0ZT1cIitiLnJlYWR5U3RhdGVfK1wiLiAob2lkOiBcIitiLm9iamVjdF9pZCgpK1wiKVwiKTtiLnJlYWR5U3RhdGVfPT1cclxudC5SZWFkeT9jKCk6KGQubG9nZ2VyLmxvZygndmlkZW9FbGVtZW50LndhaXRVbnRpbFJlYWR5KCk6IGRlZmVycmluZyBhY3Rpb24gXCInK2ErJ1wiLiAob2lkOiAnK2Iub2JqZWN0X2lkKCkrXCIpXCIpLGIuZGVmZXJyZWRWaWRlb0FjdGlvbnMucHVzaChuZXcgbC5kZWZlcnJlZF9hY3Rpb24oYyxlLGEpKSl9KX07Yi5wcm90b3R5cGUub25SZWFkeT1mdW5jdGlvbigpe2Zvcig7dGhpcy5kZWZlcnJlZFZpZGVvQWN0aW9ucyYmMDx0aGlzLmRlZmVycmVkVmlkZW9BY3Rpb25zLmxlbmd0aDspdGhpcy5kZWZlcnJlZFZpZGVvQWN0aW9ucy5zaGlmdCgpLnBvc3QodGhpcy5yZWFkeVN0YXRlXz09dC5SZWFkeSl9O3JldHVybiBifShsLlByb3h5T2JqZWN0KTthLlZpZGVvRWxlbWVudD1ifSwyNjk6ZnVuY3Rpb24oYixhKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTthLkhhcmR3YXJlSW5mbz1hLk1lbW9yeUluZm89YS5HUFVJbmZvPWEuR1BVPWEuQ1BVSW5mbz1cclxuYS5XZWJycGNDbGFzc0xpYkluZm89YS5XZWJycGNDbGFzc0luZm89YS5XZWJycGNNZXRob2RJbmZvPWEuRW5kcG9pbnRJZD1hLk9TSW5mbz1hLldlYnJwY0ZlYXR1cmVJbmZvPWEuRmVhdHVyZURhdGE9YS5WZXJzaW9uRGF0YT1hLkZFQVRVUkVfdW5zdXBwb3J0ZWQ9YS5GRUFUVVJFX21zX3RlYW1zX3JlZGlyZWN0aW9uPXZvaWQgMDthLkZFQVRVUkVfbXNfdGVhbXNfcmVkaXJlY3Rpb249XCJtc190ZWFtc19yZWRpcmVjdGlvblwiO2EuRkVBVFVSRV91bnN1cHBvcnRlZD1cInVuc3VwcG9ydGVkXCI7dmFyIGM9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiLGMsZCl7dGhpcy5tYWpvcj1hO3RoaXMubWlub3I9Yjt0aGlzLnJldmlzaW9uPWM7dGhpcy5idWlsZD1kfX0oKTthLlZlcnNpb25EYXRhPWM7Yz1mdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbigpe319KCk7YS5GZWF0dXJlRGF0YT1jO2M9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiKXt0aGlzLmZhdHVyZT1hO3RoaXMudmVyc2lvbj1cclxuYn19KCk7YS5XZWJycGNGZWF0dXJlSW5mbz1jO2M9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiLGMsZCxlKXt0aGlzLmZhbWlseT1hO3RoaXMudmVyc2lvbj1iO3RoaXMuYXJjaGl0ZWN0dXJlPWM7dGhpcy5kaXN0cm89ZDt0aGlzLmVkaXRpb249ZX19KCk7YS5PU0luZm89YztjPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYil7dGhpcy5tYWNoaW5lX2lkPWE7dGhpcy51c2VyX2lkPWJ9fSgpO2EuRW5kcG9pbnRJZD1jO2M9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYixjLGUsZCxsKXt2b2lkIDA9PT1sJiYobD1hLkZFQVRVUkVfbXNfdGVhbXNfcmVkaXJlY3Rpb24pO3RoaXMuaWlkPWI7dGhpcy5taWQ9Yzt0aGlzLm5hbWU9ZTt0aGlzLmlzcHJvcD1kO3RoaXMuZmVhdHVyZT1sfX0oKTthLldlYnJwY01ldGhvZEluZm89YztjPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYixjKXt0aGlzLmlkPWE7dGhpcy5uYW1lPWI7dGhpcy5tZXRob2RzPWN9fSgpO2EuV2VicnBjQ2xhc3NJbmZvPVxyXG5jO2M9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiKXt0aGlzLm5hbWU9YTt0aGlzLmNsYXNzZXM9Yn19KCk7YS5XZWJycGNDbGFzc0xpYkluZm89YztjPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYil7dGhpcy5jcHVtb2RlbD1hO3RoaXMubnVtYmVyb2Zwcm9jZXNzb3JzPWJ9fSgpO2EuQ1BVSW5mbz1jO2M9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiKXt0aGlzLm5hbWU9YTt0aGlzLmRyaXZlcj1ifX0oKTthLkdQVT1jO2M9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSl7dGhpcy5ncHVzPWF9fSgpO2EuR1BVSW5mbz1jO2M9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSl7dGhpcy50b3RhbG1lbW9yeT1hfX0oKTthLk1lbW9yeUluZm89YztjPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYixjKXt0aGlzLmNwdV9pbmZvPWE7dGhpcy5ncHVfaW5mbz1iO3RoaXMubWVtb3J5X2luZm89Y319KCk7YS5IYXJkd2FyZUluZm89Y30sNTUwOmZ1bmN0aW9uKGIsXHJcbmEsYyl7dmFyIGU9dGhpcyYmdGhpcy5fX2NyZWF0ZUJpbmRpbmd8fChPYmplY3QuY3JlYXRlP2Z1bmN0aW9uKGEsYixjLGUpe3ZvaWQgMD09PWUmJihlPWMpO09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLGUse2VudW1lcmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGJbY119fSl9OmZ1bmN0aW9uKGEsYixjLGUpe3ZvaWQgMD09PWUmJihlPWMpO2FbZV09YltjXX0pO2I9dGhpcyYmdGhpcy5fX2V4cG9ydFN0YXJ8fGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjIGluIGEpXCJkZWZhdWx0XCI9PT1jfHxiLmhhc093blByb3BlcnR5KGMpfHxlKGIsYSxjKX07T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7YS5XZWJycGNDbGFzc0xpYkluZm9VdGlsPXZvaWQgMDt2YXIgbD1jKDE4Nyk7YihjKDE4NyksYSk7Yz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt9YS5nZXRJbnRlcmZhY2VCeWlkPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wLGM9bC5jbGFzc19saWJfaW5mby5jbGFzc2VzO2I8XHJcbmMubGVuZ3RoO2IrKyl7dmFyIGU9Y1tiXTtpZihlLmlkPT1hKXJldHVybiBlfXJldHVybiBudWxsfTthLmdldE1ldGhvZEJ5aWQ9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldEludGVyZmFjZUJ5aWQoYSk7aWYobnVsbCE9Yylmb3IodmFyIGU9MCxjPWMubWV0aG9kcztlPGMubGVuZ3RoO2UrKyl7dmFyIGs9Y1tlXTtpZihrLm1pZD09YilyZXR1cm4ga31yZXR1cm4gbnVsbH07YS5nZXRNZXRob2RGZWF0dXJlQnlpZD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0SW50ZXJmYWNlQnlpZChhKTtpZihudWxsIT1jKWZvcih2YXIgZT0wLGM9Yy5tZXRob2RzO2U8Yy5sZW5ndGg7ZSsrKXt2YXIgaz1jW2VdO2lmKGsubWlkPT1iKXJldHVybiBrLmZlYXR1cmV9cmV0dXJuIG51bGx9O2EuY29tcG9zZUNsYXNzSW5mb0RhdGE9ZnVuY3Rpb24oYSl7YT1hLmhkcjtpZih2b2lkIDA9PWEpcmV0dXJuXCIqKiogSW52YWxpZCBwYWNrZXQ6IENvdWxkbid0IGZpbmQgaGRyIG9iamVjdCAqKipcIjt2YXIgYj1cclxuYS5wcm9jO2lmKHZvaWQgMD09YilyZXR1cm5cIlwiO2E9Yi5paWQ7Zm9yKHZhciBiPWIubWV0aG9kaWQsYz0wLGU9bC5jbGFzc19saWJfaW5mby5jbGFzc2VzO2M8ZS5sZW5ndGg7YysrKXt2YXIgaz1lW2NdO2lmKGsuaWQ9PWEpZm9yKHZhciBoPTAscD1rLm1ldGhvZHM7aDxwLmxlbmd0aDtoKyspe3ZhciBnPXBbaF07aWYoZy5taWQ9PWIpcmV0dXJuIGsubmFtZStcIjo6XCIrZy5uYW1lfX1yZXR1cm5cIlwifTtyZXR1cm4gYX0oKTthLldlYnJwY0NsYXNzTGliSW5mb1V0aWw9Y30sMTg3OmZ1bmN0aW9uKGIsYSxjKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTthLmNsYXNzX2xpYl9pbmZvPWEubWV0aG9kX2lkX1N0cmVhbVJlc29sdXRpb25fdD1hLm1ldGhvZF9pZF9SVENTY3RwVHJhbnNwb3J0X3Q9YS5tZXRob2RfaWRfUlRDRGF0YUNoYW5uZWxfdD1hLm1ldGhvZF9pZF9FOTExU2VydmljZV90PWEubWV0aG9kX2lkX1NjcmVlblNvdXJjZV90PWEubWV0aG9kX2lkX1ZESVNoYXJpbmdSZW1vdGVfdD1cclxuYS5tZXRob2RfaWRfUlRDUnRwVHJhbnNjZWl2ZXJfdD1hLm1ldGhvZF9pZF9SVENJY2VDYW5kaWRhdGVQYWlyX3Q9YS5tZXRob2RfaWRfUlRDRFRNRlRvbmVDaGFuZ2VFdmVudF90PWEubWV0aG9kX2lkX1JUQ0RUTUZTZW5kZXJfdD1hLm1ldGhvZF9pZF9SVENJY2VUcmFuc3BvcnRfdD1hLm1ldGhvZF9pZF9SVENEdGxzVHJhbnNwb3J0X3Q9YS5tZXRob2RfaWRfUlRDUnRwU2VuZGVyX3Q9YS5tZXRob2RfaWRfUlRDUnRwUmVjZWl2ZXJfdD1hLm1ldGhvZF9pZF9BdWRpb0VsZW1lbnRfdD1hLm1ldGhvZF9pZF9WaWRlb0VsZW1lbnRfdD1hLm1ldGhvZF9pZF9NZWRpYVN0cmVhbUV2ZW50X3Q9YS5tZXRob2RfaWRfUlRDSWNlQ2FuZGlkYXRlRXZlbnRfdD1hLm1ldGhvZF9pZF9SVENJY2VDYW5kaWRhdGVfdD1hLm1ldGhvZF9pZF9OYXZpZ2F0b3JVc2VyTWVkaWFfdD1hLm1ldGhvZF9pZF9NZWRpYVN0cmVhbV90PWEubWV0aG9kX2lkX01lZGlhU3RyZWFtVHJhY2tfdD1hLm1ldGhvZF9pZF9SVENTZXNzaW9uRGVzY3JpcHRpb25fdD1cclxuYS5tZXRob2RfaWRfTWVkaWFEZXZpY2VJbmZvX3Q9YS5tZXRob2RfaWRfTWVkaWFEZXZpY2VzX3Q9YS5tZXRob2RfaWRfUlRDUGVlckNvbm5lY3Rpb25fdD1hLm1ldGhvZF9pZF9FbmdpbmVDb250cm9sX3Q9YS5jbGFzc19pZF90PWEudmRhRmVhdHVyZU5hbWVNYXA9YS5mZWF0dXJlTmFtZU1hcD1hLkZlYXR1cmVzPWEuRkVBVFVSRV9tc190ZWFtc19zZW5kZXJfc3RhdHNfZml4PWEuRkVBVFVSRV9tc190ZWFtc19lbnVtZXJhdGVfZGV2aWNlc192Mj1hLkZFQVRVUkVfbXNfdGVhbXNfdHJhY2tfY2xvbmVfd2l0aF9pZD1hLkZFQVRVUkVfbXNfdGVhbXNfYXVkaW9fbm90aWZpY2F0aW9uc19sb29wPWEuRkVBVFVSRV9tc190ZWFtc19zaGFyZV9zeXN0ZW1fYXVkaW89YS5GRUFUVVJFX21zX3RlYW1zX3N0cmVhbV9hY3RpdmVfc3RhdHVzPWEuRkVBVFVSRV9tc190ZWFtc19oYXJkd2FyZV9pbmZvPWEuRkVBVFVSRV9tc190ZWFtc19zZWNvbmRhcnlfYXVkaW9fbm90aWZpY2F0aW9ucz1hLkZFQVRVUkVfbXNfdGVhbXNfc3RyZWFtX3Jlc29sdXRpb249XHJcbmEuRkVBVFVSRV9tc190ZWFtc19jbGllbnRfaW5mbz1hLkZFQVRVUkVfbXNfdGVhbXNfbm9fdmRfYnVmZmVyX2xpbWl0PWEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWw9YS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MD1hLkZFQVRVUkVfbXNfdGVhbXNfbXVsdGlfd2luZG93PWEuRkVBVFVSRV9tc190ZWFtc19ndGM9YS5GRUFUVVJFX21zX3RlYW1zX2U5MTE9YS5GRUFUVVJFX21zX3RlYW1zX2NvZGVjX2NhcGFiaWxpdHk9YS5GRUFUVVJFX21zX3RlYW1zX2FwcF9zaGFyaW5nPWEuRkVBVFVSRV9tc190ZWFtc19tb25pdG9yX3NoYXJpbmc9YS5GRUFUVVJFX21zX3RlYW1zX3ZpZGVvX3BsYWNlbWVudD1hLkZFQVRVUkVfbXNfdGVhbXNfZHRtZj1hLkZFQVRVUkVfbXNfdGVhbXNfZGV2aWNlX2dyb3VwX2lkPWEuRkVBVFVSRV9tc190ZWFtc19yZW1vdGVfYXVkaW9fbm90aWZpY2F0aW9ucz1hLkZFQVRVUkVfbXNfdGVhbXNfZW5kcG9pbnRfaWQ9YS5GRUFUVVJFX21zX3RlYW1zX29zaW5mbz1cclxuYS5GRUFUVVJFX21zX3RlYW1zX21zdHJhY2tfY29uc3RyYWludHM9YS5GRUFUVVJFX21zX3RlYW1zXzE5MTI9YS5GRUFUVVJFX21zX3RlYW1zX3BzdG49YS5GRUFUVVJFX21zX3RlYW1zXzE5MTE9YS5GRUFUVVJFX21zX3RlYW1zX2NvbW1vbl9tZWRpYV9jb25zdHJhaW50cz1hLkZFQVRVUkVfbXNfdGVhbXNfc3BlYWtpbmdfaW5kaWNhdG9yPWEuRkVBVFVSRV9tc190ZWFtc19kZXNrdG9wX3NoYXJpbmc9YS5GRUFUVVJFX3ZkYV9kZWxldGVfdmlld3BvcnQ9YS5GRUFUVVJFX3ZkYV9tdWx0aV93aW5kb3c9YS5GRUFUVVJFX3ZkYV9hcHBfc2hhcmluZz1hLkZFQVRVUkVfdmRhX3NlcnZpY2Vfbm9fYnVmZmVyX2xpbWl0PWEuSERYTVNfVkVSU0lPTj1hLkJVSUxEX1RZUEVfU0RLPXZvaWQgMDtiPWMoMjY5KTt2YXIgZT1jKDI2OSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJWZXJzaW9uRGF0YVwiLHtlbnVtZXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiBlLlZlcnNpb25EYXRhfX0pO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIkZlYXR1cmVEYXRhXCIse2VudW1lcmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUuRmVhdHVyZURhdGF9fSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJPU0luZm9cIix7ZW51bWVyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5PU0luZm99fSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJFbmRwb2ludElkXCIse2VudW1lcmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUuRW5kcG9pbnRJZH19KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSxcIkhhcmR3YXJlSW5mb1wiLHtlbnVtZXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiBlLkhhcmR3YXJlSW5mb319KTthLkJVSUxEX1RZUEVfU0RLPSEwO2EuSERYTVNfVkVSU0lPTj1cIjMuMS4wXCI7YS5GRUFUVVJFX3ZkYV9zZXJ2aWNlX25vX2J1ZmZlcl9saW1pdD1cIndzc2VydmljZV9ub19idWZmZXJfbGltaXRcIjthLkZFQVRVUkVfdmRhX2FwcF9zaGFyaW5nPVwid2VicnRjX2FwcF9zaGFyaW5nXCI7XHJcbmEuRkVBVFVSRV92ZGFfbXVsdGlfd2luZG93PVwid2VicnRjX211bHRpX3dpbmRvd1wiO2EuRkVBVFVSRV92ZGFfZGVsZXRlX3ZpZXdwb3J0PVwib3ZlcmxheV9kZWxldGVfdmlld3BvcnRcIjthLkZFQVRVUkVfbXNfdGVhbXNfZGVza3RvcF9zaGFyaW5nPVwibXNfdGVhbXNfZGVza3RvcF9zaGFyaW5nXCI7YS5GRUFUVVJFX21zX3RlYW1zX3NwZWFraW5nX2luZGljYXRvcj1cIm1zX3RlYW1zX3NwZWFraW5nX2luZGljYXRvclwiO2EuRkVBVFVSRV9tc190ZWFtc19jb21tb25fbWVkaWFfY29uc3RyYWludHM9XCJtc190ZWFtc19jb21tb25fbWVkaWFfY29uc3RyYWludHNcIjthLkZFQVRVUkVfbXNfdGVhbXNfMTkxMT1cIm1zX3RlYW1zXzE5MTFcIjthLkZFQVRVUkVfbXNfdGVhbXNfcHN0bj1cIm1zX3RlYW1zX3BzdG5cIjthLkZFQVRVUkVfbXNfdGVhbXNfMTkxMj1cIm1zX3RlYW1zXzE5MTJcIjthLkZFQVRVUkVfbXNfdGVhbXNfbXN0cmFja19jb25zdHJhaW50cz1cIm1zX3RlYW1zX21zdHJhY2tfY29uc3RyYWludHNcIjtcclxuYS5GRUFUVVJFX21zX3RlYW1zX29zaW5mbz1cIm1zX3RlYW1zX29zaW5mb1wiO2EuRkVBVFVSRV9tc190ZWFtc19lbmRwb2ludF9pZD1cIm1zX3RlYW1zX2VuZHBvaW50X2lkXCI7YS5GRUFUVVJFX21zX3RlYW1zX3JlbW90ZV9hdWRpb19ub3RpZmljYXRpb25zPVwibXNfdGVhbXNfcmVtb3RlX2F1ZGlvX25vdGlmaWNhdGlvbnNcIjthLkZFQVRVUkVfbXNfdGVhbXNfZGV2aWNlX2dyb3VwX2lkPVwibXNfdGVhbXNfZGV2aWNlX2dyb3VwX2lkXCI7YS5GRUFUVVJFX21zX3RlYW1zX2R0bWY9XCJtc190ZWFtc19kdG1mXCI7YS5GRUFUVVJFX21zX3RlYW1zX3ZpZGVvX3BsYWNlbWVudD1cIm1zX3RlYW1zX3ZpZGVvX3BsYWNlbWVudFwiO2EuRkVBVFVSRV9tc190ZWFtc19tb25pdG9yX3NoYXJpbmc9XCJtc190ZWFtc19tdWx0aV9tb25pdG9yX3NoYXJpbmdcIjthLkZFQVRVUkVfbXNfdGVhbXNfYXBwX3NoYXJpbmc9XCJtc190ZWFtc19hcHBfc2hhcmluZ1wiO2EuRkVBVFVSRV9tc190ZWFtc19jb2RlY19jYXBhYmlsaXR5PVxyXG5cIm1zX3RlYW1zX2NvZGVjX2NhcGFiaWxpdHlcIjthLkZFQVRVUkVfbXNfdGVhbXNfZTkxMT1cIm1zX3RlYW1zX2U5MTFcIjthLkZFQVRVUkVfbXNfdGVhbXNfZ3RjPVwibXNfdGVhbXNfZ3RjXCI7YS5GRUFUVVJFX21zX3RlYW1zX211bHRpX3dpbmRvdz1cIm1zX3RlYW1zX211bHRpX3dpbmRvd3NcIjthLkZFQVRVUkVfbXNfdGVhbXNfd2VicnRjXzFkb3QwPVwibXNfdGVhbXNfd2VicnRjXzEuMFwiO2EuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWw9XCJtc190ZWFtc19kYXRhX2NoYW5uZWxcIjthLkZFQVRVUkVfbXNfdGVhbXNfbm9fdmRfYnVmZmVyX2xpbWl0PVwibXNfdGVhbXNfbm9fdmRfYnVmZmVyX2xpbWl0XCI7YS5GRUFUVVJFX21zX3RlYW1zX2NsaWVudF9pbmZvPVwibXNfdGVhbXNfY2xpZW50X2luZm9cIjthLkZFQVRVUkVfbXNfdGVhbXNfc3RyZWFtX3Jlc29sdXRpb249XCJtc190ZWFtc19zdHJlYW1fcmVzb2x1dGlvblwiO2EuRkVBVFVSRV9tc190ZWFtc19zZWNvbmRhcnlfYXVkaW9fbm90aWZpY2F0aW9ucz1cclxuXCJtc190ZWFtc19zZWNvbmRhcnlfYXVkaW9fbm90aWZpY2F0aW9uc1wiO2EuRkVBVFVSRV9tc190ZWFtc19oYXJkd2FyZV9pbmZvPVwibXNfdGVhbXNfaGFyZHdhcmVfaW5mb1wiO2EuRkVBVFVSRV9tc190ZWFtc19zdHJlYW1fYWN0aXZlX3N0YXR1cz1cIm1zX3RlYW1zX3N0cmVhbV9hY3RpdmVfc3RhdHVzXCI7YS5GRUFUVVJFX21zX3RlYW1zX3NoYXJlX3N5c3RlbV9hdWRpbz1cIm1zX3RlYW1zX3NoYXJlX3N5c3RlbV9hdWRpb1wiO2EuRkVBVFVSRV9tc190ZWFtc19hdWRpb19ub3RpZmljYXRpb25zX2xvb3A9XCJtc190ZWFtc19hdWRpb19ub3RpZmljYXRpb25zX2xvb3BcIjthLkZFQVRVUkVfbXNfdGVhbXNfdHJhY2tfY2xvbmVfd2l0aF9pZD1cIm1zX3RlYW1zX3RyYWNrX2Nsb25lX3dpdGhfaWRcIjthLkZFQVRVUkVfbXNfdGVhbXNfZW51bWVyYXRlX2RldmljZXNfdjI9XCJtc190ZWFtc19lbnVtZXJhdGVfZGV2aWNlc192MlwiO2EuRkVBVFVSRV9tc190ZWFtc19zZW5kZXJfc3RhdHNfZml4PVwibXNfdGVhbXNfc2VuZGVyX3N0YXRzX2ZpeFwiO1xyXG5uZXcgYi5XZWJycGNGZWF0dXJlSW5mbyhiLkZFQVRVUkVfbXNfdGVhbXNfcmVkaXJlY3Rpb24sbmV3IGIuVmVyc2lvbkRhdGEoMSwxLDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19kZXNrdG9wX3NoYXJpbmcsbmV3IGIuVmVyc2lvbkRhdGEoMSwyLDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19zcGVha2luZ19pbmRpY2F0b3IsbmV3IGIuVmVyc2lvbkRhdGEoMSwyLDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19jb21tb25fbWVkaWFfY29uc3RyYWludHMsbmV3IGIuVmVyc2lvbkRhdGEoMSw0LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc18xOTExLG5ldyBiLlZlcnNpb25EYXRhKDEsNCwwLDApKTtuZXcgYi5XZWJycGNGZWF0dXJlSW5mbyhhLkZFQVRVUkVfbXNfdGVhbXNfMTkxMixuZXcgYi5WZXJzaW9uRGF0YSgxLDUsXHJcbjAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19tc3RyYWNrX2NvbnN0cmFpbnRzLG5ldyBiLlZlcnNpb25EYXRhKDEsNiwwLDApKTtuZXcgYi5XZWJycGNGZWF0dXJlSW5mbyhhLkZFQVRVUkVfbXNfdGVhbXNfcHN0bixuZXcgYi5WZXJzaW9uRGF0YSgxLDYsMCwwKSk7bmV3IGIuV2VicnBjRmVhdHVyZUluZm8oYS5GRUFUVVJFX21zX3RlYW1zX29zaW5mbyxuZXcgYi5WZXJzaW9uRGF0YSgxLDcsMCwwKSk7bmV3IGIuV2VicnBjRmVhdHVyZUluZm8oYS5GRUFUVVJFX21zX3RlYW1zX2VuZHBvaW50X2lkLG5ldyBiLlZlcnNpb25EYXRhKDEsNywwLDApKTtuZXcgYi5XZWJycGNGZWF0dXJlSW5mbyhhLkZFQVRVUkVfbXNfdGVhbXNfcmVtb3RlX2F1ZGlvX25vdGlmaWNhdGlvbnMsbmV3IGIuVmVyc2lvbkRhdGEoMSw3LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19kZXZpY2VfZ3JvdXBfaWQsbmV3IGIuVmVyc2lvbkRhdGEoMSxcclxuNywwLDApKTtuZXcgYi5XZWJycGNGZWF0dXJlSW5mbyhhLkZFQVRVUkVfbXNfdGVhbXNfY29kZWNfY2FwYWJpbGl0eSxuZXcgYi5WZXJzaW9uRGF0YSgxLDcsMCwwKSk7bmV3IGIuV2VicnBjRmVhdHVyZUluZm8oYS5GRUFUVVJFX21zX3RlYW1zX2R0bWYsbmV3IGIuVmVyc2lvbkRhdGEoMSw3LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc192aWRlb19wbGFjZW1lbnQsbmV3IGIuVmVyc2lvbkRhdGEoMSw3LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19tb25pdG9yX3NoYXJpbmcsbmV3IGIuVmVyc2lvbkRhdGEoMSw3LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19hcHBfc2hhcmluZyxuZXcgYi5WZXJzaW9uRGF0YSgxLDgsMCwwKSk7bmV3IGIuV2VicnBjRmVhdHVyZUluZm8oYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCxuZXcgYi5WZXJzaW9uRGF0YSgxLFxyXG44LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwsbmV3IGIuVmVyc2lvbkRhdGEoMSw4LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19lOTExLG5ldyBiLlZlcnNpb25EYXRhKDEsMTMsMCwwKSk7bmV3IGIuV2VicnBjRmVhdHVyZUluZm8oYS5GRUFUVVJFX21zX3RlYW1zX211bHRpX3dpbmRvdyxuZXcgYi5WZXJzaW9uRGF0YSgxLDE0LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19jbGllbnRfaW5mbyxuZXcgYi5WZXJzaW9uRGF0YSgxLDE5LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19zdHJlYW1fcmVzb2x1dGlvbixuZXcgYi5WZXJzaW9uRGF0YSgxLDI1LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19zZWNvbmRhcnlfYXVkaW9fbm90aWZpY2F0aW9ucyxcclxubmV3IGIuVmVyc2lvbkRhdGEoMSwyMSwwLDApKTtuZXcgYi5XZWJycGNGZWF0dXJlSW5mbyhhLkZFQVRVUkVfbXNfdGVhbXNfaGFyZHdhcmVfaW5mbyxuZXcgYi5WZXJzaW9uRGF0YSgxLDM1LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19zdHJlYW1fYWN0aXZlX3N0YXR1cyxuZXcgYi5WZXJzaW9uRGF0YSgxLDMyLDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19hdWRpb19ub3RpZmljYXRpb25zX2xvb3AsbmV3IGIuVmVyc2lvbkRhdGEoMSwzMywwLDApKTtuZXcgYi5XZWJycGNGZWF0dXJlSW5mbyhhLkZFQVRVUkVfbXNfdGVhbXNfdHJhY2tfY2xvbmVfd2l0aF9pZCxuZXcgYi5WZXJzaW9uRGF0YSgxLDMzLDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19lbnVtZXJhdGVfZGV2aWNlc192MixuZXcgYi5WZXJzaW9uRGF0YSgxLDM1LDAsMCkpO25ldyBiLldlYnJwY0ZlYXR1cmVJbmZvKGEuRkVBVFVSRV9tc190ZWFtc19zZW5kZXJfc3RhdHNfZml4LFxyXG5uZXcgYi5WZXJzaW9uRGF0YSgxLDM2LDAsMCkpO2M9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKCl7fWEuRkVBVFVSRV9wdWJsaWNfc2NyZWVuc2hhcmU9XCJzY3JlZW5zaGFyZVwiO2EuRkVBVFVSRV9wdWJsaWNfcmVkaXJlY3Rpb249XCJyZWRpcmVjdGlvblwiO2EuRkVBVFVSRV9wdWJsaWNfc3BlYWtpbmdfaW5kaWNhdG9yPVwic3BlYWtpbmdfaW5kaWNhdG9yXCI7YS5GRUFUVVJFX3B1YmxpY19wc3RuPVwicHN0blwiO2EuRkVBVFVSRV9wdWJsaWNfb3NpbmZvPVwib3NpbmZvXCI7YS5GRUFUVVJFX3B1YmxpY19lbmRwb2ludF9pZD1cImVuZHBvaW50aWRcIjthLkZFQVRVUkVfcHVibGljX3JlbW90ZV9hdWRpb19ub3RpZmljYXRpb25zPVwicmVtb3RlYXVkaW9ub3RpZmljYXRpb25zXCI7YS5GRUFUVVJFX3B1YmxpY19kZXZpY2VfZ3JvdXBfaWQ9XCJjb21wb3NpdGVkZXZpY2VzXCI7YS5GRUFUVVJFX3B1YmxpY19kdG1mPVwiZHRtZlwiO2EuRkVBVFVSRV9wdWJsaWNfbW9uaXRvcl9zaGFyaW5nPVwibXVsdGltb25pdG9yc2NyZWVuc2hhcmVcIjtcclxuYS5GRUFUVVJFX3B1YmxpY19hcHBfc2hhcmluZz1cImFwcHNoYXJlXCI7YS5GRUFUVVJFX3B1YmxpY19jb2RlY19jYXBhYmlsaXR5PVwiY29kZWNfY2FwYWJpbGl0eVwiO2EuRkVBVFVSRV9wdWJsaWNfZTkxMT1cImU5MTFcIjthLkZFQVRVUkVfcHVibGljX3dlYnJ0YzFkb3QwPVwid2VicnRjMS4wXCI7YS5GRUFUVVJFX3B1YmxpY19kYXRhX2NoYW5uZWw9XCJkYXRhY2hhbm5lbFwiO2EuRkVBVFVSRV9wdWJsaWNfdmRub2J1ZmxpbWl0PVwidmRub2J1ZmxpbWl0XCI7YS5GRUFUVVJFX3B1YmxpY19tdWx0aV93aW5kb3c9XCJtdWx0aXdpbmRvd1wiO2EuRkVBVFVSRV9wdWJsaWNfc2Vjb25kYXJ5X2F1ZGlvX25vdGlmaWNhdGlvbnM9XCJzZWNvbmRhcnlyaW5nZXJcIjthLkZFQVRVUkVfcHVibGljX3N0cmVhbV9yZXNvbHV0aW9uPVwic3RyZWFtcmVzb2x1dGlvblwiO2EuRkVBVFVSRV9wdWJsaWNfdHJhY2tfY2xvbmVfd2l0aF9pZD1cInRyYWNrX2Nsb25lX3dpdGhfaWRcIjthLkZFQVRVUkVfcHVibGljX3NlbmRlcl9zdGF0c19maXg9XHJcblwic2VuZGVyX3N0YXRzX2ZpeFwiO2EuRkVBVFVSRV9wdWJsaWNfYXVkaW9fbm90aWZpY2F0aW9uX2xvb3A9XCJsb29wXCI7cmV0dXJuIGF9KCk7YS5GZWF0dXJlcz1jO2EuZmVhdHVyZU5hbWVNYXA9e307YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX3NjcmVlbnNoYXJlXT1bYS5GRUFUVVJFX21zX3RlYW1zX2Rlc2t0b3Bfc2hhcmluZ107YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX3JlZGlyZWN0aW9uXT1bYi5GRUFUVVJFX21zX3RlYW1zX3JlZGlyZWN0aW9uXTthLmZlYXR1cmVOYW1lTWFwW2MuRkVBVFVSRV9wdWJsaWNfc3BlYWtpbmdfaW5kaWNhdG9yXT1bYS5GRUFUVVJFX21zX3RlYW1zX3NwZWFraW5nX2luZGljYXRvcl07YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX3BzdG5dPVthLkZFQVRVUkVfbXNfdGVhbXNfcHN0bl07YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX29zaW5mb109W2EuRkVBVFVSRV9tc190ZWFtc19vc2luZm9dO1xyXG5hLmZlYXR1cmVOYW1lTWFwW2MuRkVBVFVSRV9wdWJsaWNfZW5kcG9pbnRfaWRdPVthLkZFQVRVUkVfbXNfdGVhbXNfZW5kcG9pbnRfaWRdO2EuZmVhdHVyZU5hbWVNYXBbYy5GRUFUVVJFX3B1YmxpY19yZW1vdGVfYXVkaW9fbm90aWZpY2F0aW9uc109W2EuRkVBVFVSRV9tc190ZWFtc19yZW1vdGVfYXVkaW9fbm90aWZpY2F0aW9ucyxhLkZFQVRVUkVfbXNfdGVhbXNfc2Vjb25kYXJ5X2F1ZGlvX25vdGlmaWNhdGlvbnNdO2EuZmVhdHVyZU5hbWVNYXBbYy5GRUFUVVJFX3B1YmxpY19kZXZpY2VfZ3JvdXBfaWRdPVthLkZFQVRVUkVfbXNfdGVhbXNfZGV2aWNlX2dyb3VwX2lkXTthLmZlYXR1cmVOYW1lTWFwW2MuRkVBVFVSRV9wdWJsaWNfZHRtZl09W2EuRkVBVFVSRV9tc190ZWFtc19kdG1mXTthLmZlYXR1cmVOYW1lTWFwW2MuRkVBVFVSRV9wdWJsaWNfbW9uaXRvcl9zaGFyaW5nXT1bYS5GRUFUVVJFX21zX3RlYW1zX21vbml0b3Jfc2hhcmluZ107YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX2FwcF9zaGFyaW5nXT1cclxuW2EuRkVBVFVSRV9tc190ZWFtc19hcHBfc2hhcmluZ107YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX2NvZGVjX2NhcGFiaWxpdHldPVthLkZFQVRVUkVfbXNfdGVhbXNfY29kZWNfY2FwYWJpbGl0eV07YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX2U5MTFdPVthLkZFQVRVUkVfbXNfdGVhbXNfZTkxMV07YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX3dlYnJ0YzFkb3QwXT1bYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MF07YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX211bHRpX3dpbmRvd109W2EuRkVBVFVSRV9tc190ZWFtc19tdWx0aV93aW5kb3ddO2EuZmVhdHVyZU5hbWVNYXBbYy5GRUFUVVJFX3B1YmxpY19kYXRhX2NoYW5uZWxdPVthLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsXTthLmZlYXR1cmVOYW1lTWFwW2MuRkVBVFVSRV9wdWJsaWNfdmRub2J1ZmxpbWl0XT1bYS5GRUFUVVJFX21zX3RlYW1zX25vX3ZkX2J1ZmZlcl9saW1pdF07XHJcbmEuZmVhdHVyZU5hbWVNYXBbYy5GRUFUVVJFX3B1YmxpY19zZWNvbmRhcnlfYXVkaW9fbm90aWZpY2F0aW9uc109W2EuRkVBVFVSRV9tc190ZWFtc19yZW1vdGVfYXVkaW9fbm90aWZpY2F0aW9ucyxhLkZFQVRVUkVfbXNfdGVhbXNfc2Vjb25kYXJ5X2F1ZGlvX25vdGlmaWNhdGlvbnNdO2EuZmVhdHVyZU5hbWVNYXBbYy5GRUFUVVJFX3B1YmxpY19zdHJlYW1fcmVzb2x1dGlvbl09W2EuRkVBVFVSRV9tc190ZWFtc19zdHJlYW1fcmVzb2x1dGlvbl07YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX3RyYWNrX2Nsb25lX3dpdGhfaWRdPVthLkZFQVRVUkVfbXNfdGVhbXNfdHJhY2tfY2xvbmVfd2l0aF9pZF07YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX3NlbmRlcl9zdGF0c19maXhdPVthLkZFQVRVUkVfbXNfdGVhbXNfc2VuZGVyX3N0YXRzX2ZpeF07YS5mZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX2F1ZGlvX25vdGlmaWNhdGlvbl9sb29wXT1bYS5GRUFUVVJFX21zX3RlYW1zX2F1ZGlvX25vdGlmaWNhdGlvbnNfbG9vcF07XHJcbmEudmRhRmVhdHVyZU5hbWVNYXA9e307YS52ZGFGZWF0dXJlTmFtZU1hcFtjLkZFQVRVUkVfcHVibGljX211bHRpX3dpbmRvd109W2EuRkVBVFVSRV92ZGFfbXVsdGlfd2luZG93XTthLnZkYUZlYXR1cmVOYW1lTWFwW2MuRkVBVFVSRV9wdWJsaWNfYXBwX3NoYXJpbmddPVthLkZFQVRVUkVfdmRhX2FwcF9zaGFyaW5nXTsoZnVuY3Rpb24oYSl7YVthLkVuZ2luZUNvbnRyb2w9MF09XCJFbmdpbmVDb250cm9sXCI7YVthLlJUQ1BlZXJDb25uZWN0aW9uPTFdPVwiUlRDUGVlckNvbm5lY3Rpb25cIjthW2EuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uPTJdPVwiUlRDU2Vzc2lvbkRlc2NyaXB0aW9uXCI7YVthLlJUQ0ljZUNhbmRpZGF0ZT0zXT1cIlJUQ0ljZUNhbmRpZGF0ZVwiO2FbYS5SVENJY2VDYW5kaWRhdGVFdmVudD00XT1cIlJUQ0ljZUNhbmRpZGF0ZUV2ZW50XCI7YVthLk1lZGlhRGV2aWNlcz01XT1cIk1lZGlhRGV2aWNlc1wiO2FbYS5NZWRpYURldmljZUluZm89Nl09XCJNZWRpYURldmljZUluZm9cIjthW2EuTWVkaWFTdHJlYW1UcmFjaz1cclxuN109XCJNZWRpYVN0cmVhbVRyYWNrXCI7YVthLk1lZGlhU3RyZWFtRXZlbnQ9OF09XCJNZWRpYVN0cmVhbUV2ZW50XCI7YVthLk1lZGlhU3RyZWFtPTldPVwiTWVkaWFTdHJlYW1cIjthW2EuTmF2aWdhdG9yVXNlck1lZGlhPTEwXT1cIk5hdmlnYXRvclVzZXJNZWRpYVwiO2FbYS5WaWRlb0VsZW1lbnQ9MTFdPVwiVmlkZW9FbGVtZW50XCI7YVthLkF1ZGlvRWxlbWVudD0xMl09XCJBdWRpb0VsZW1lbnRcIjthW2EuUlRDUnRwUmVjZWl2ZXI9MTNdPVwiUlRDUnRwUmVjZWl2ZXJcIjthW2EuUlRDUnRwU2VuZGVyPTE0XT1cIlJUQ1J0cFNlbmRlclwiO2FbYS5SVENEdGxzVHJhbnNwb3J0PTE1XT1cIlJUQ0R0bHNUcmFuc3BvcnRcIjthW2EuUlRDSWNlVHJhbnNwb3J0PTE2XT1cIlJUQ0ljZVRyYW5zcG9ydFwiO2FbYS5SVENEVE1GU2VuZGVyPTE3XT1cIlJUQ0RUTUZTZW5kZXJcIjthW2EuUlRDRFRNRlRvbmVDaGFuZ2VFdmVudD0xOF09XCJSVENEVE1GVG9uZUNoYW5nZUV2ZW50XCI7YVthLlJUQ0ljZUNhbmRpZGF0ZVBhaXI9MTldPVxyXG5cIlJUQ0ljZUNhbmRpZGF0ZVBhaXJcIjthW2EuUlRDUnRwVHJhbnNjZWl2ZXI9MjBdPVwiUlRDUnRwVHJhbnNjZWl2ZXJcIjthW2EuU2NyZWVuU2hhcmluZ1JlbW90ZT0yMV09XCJTY3JlZW5TaGFyaW5nUmVtb3RlXCI7YVthLlNjcmVlblNvdXJjZT0yMl09XCJTY3JlZW5Tb3VyY2VcIjthW2EuRTkxMVNlcnZpY2U9MjNdPVwiRTkxMVNlcnZpY2VcIjthW2EucmVzZXJ2ZWQyPTI0XT1cInJlc2VydmVkMlwiO2FbYS5SVENEYXRhQ2hhbm5lbD0yNV09XCJSVENEYXRhQ2hhbm5lbFwiO2FbYS5SVENTY3RwVHJhbnNwb3J0PTI2XT1cIlJUQ1NjdHBUcmFuc3BvcnRcIjthW2EuU3RyZWFtUmVzb2x1dGlvbj0yN109XCJTdHJlYW1SZXNvbHV0aW9uXCI7YVthLlZpZGVvRWZmZWN0PTI4XT1cIlZpZGVvRWZmZWN0XCI7YVthLnJlc2VydmVkNj0yOV09XCJyZXNlcnZlZDZcIjthW2EucmVzZXJ2ZWQ3PTMwXT1cInJlc2VydmVkN1wiO2FbYS5yZXNlcnZlZDg9MzFdPVwicmVzZXJ2ZWQ4XCJ9KShjPWEuY2xhc3NfaWRfdHx8KGEuY2xhc3NfaWRfdD1cclxue30pKTt2YXIgbDsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLnZlcnNpb249MV09XCJ2ZXJzaW9uXCI7YVthLmZlYXR1cmVfZmxhZ3M9Ml09XCJmZWF0dXJlX2ZsYWdzXCI7YVthLnZlcnNpb25faW5mbz0zXT1cInZlcnNpb25faW5mb1wiO2FbYS5vc2luZm89NF09XCJvc2luZm9cIjthW2EuZW5kcG9pbnRfaWQ9NV09XCJlbmRwb2ludF9pZFwiO2FbYS5zZXRfY2xpZW50X2luZm89Nl09XCJzZXRfY2xpZW50X2luZm9cIjthW2EuaGFyZHdhcmVfaW5mbz03XT1cImhhcmR3YXJlX2luZm9cIn0pKGw9YS5tZXRob2RfaWRfRW5naW5lQ29udHJvbF90fHwoYS5tZXRob2RfaWRfRW5naW5lQ29udHJvbF90PXt9KSk7dmFyIGg7KGZ1bmN0aW9uKGEpe2FbYS5jdG9yPTBdPVwiY3RvclwiO2FbYS5sb2NhbERlc2NyaXB0aW9uPTFdPVwibG9jYWxEZXNjcmlwdGlvblwiO2FbYS5yZW1vdGVEZXNjcmlwdGlvbj0yXT1cInJlbW90ZURlc2NyaXB0aW9uXCI7YVthLnJlYWR5U3RhdGU9M109XCJyZWFkeVN0YXRlXCI7YVthLmljZVN0YXRlPVxyXG40XT1cImljZVN0YXRlXCI7YVthLmxvY2FsU3RyZWFtcz01XT1cImxvY2FsU3RyZWFtc1wiO2FbYS5yZW1vdGVTdHJlYW1zPTZdPVwicmVtb3RlU3RyZWFtc1wiO2FbYS5jcmVhdGVPZmZlcj03XT1cImNyZWF0ZU9mZmVyXCI7YVthLmNyZWF0ZUFuc3dlcj04XT1cImNyZWF0ZUFuc3dlclwiO2FbYS5zZXRMb2NhbERlc2NyaXB0aW9uPTldPVwic2V0TG9jYWxEZXNjcmlwdGlvblwiO2FbYS5zZXRSZW1vdGVEZXNjcmlwdGlvbj0xMF09XCJzZXRSZW1vdGVEZXNjcmlwdGlvblwiO2FbYS51cGRhdGVJY2U9MTFdPVwidXBkYXRlSWNlXCI7YVthLmFkZEljZUNhbmRpZGF0ZT0xMl09XCJhZGRJY2VDYW5kaWRhdGVcIjthW2EuYWRkU3RyZWFtPTEzXT1cImFkZFN0cmVhbVwiO2FbYS5yZW1vdmVTdHJlYW09MTRdPVwicmVtb3ZlU3RyZWFtXCI7YVthLmNsb3NlPTE1XT1cImNsb3NlXCI7YVthLmljZUNvbm5lY3Rpb25TdGF0ZT0xNl09XCJpY2VDb25uZWN0aW9uU3RhdGVcIjthW2EuaWNlR2F0aGVyaW5nU3RhdGU9MTddPVwiaWNlR2F0aGVyaW5nU3RhdGVcIjtcclxuYVthLnNpZ25hbGluZ1N0YXRlPTE4XT1cInNpZ25hbGluZ1N0YXRlXCI7YVthLm9uYWRkc3RyZWFtPTE5XT1cIm9uYWRkc3RyZWFtXCI7YVthLm9uaWNlY2FuZGlkYXRlPTIwXT1cIm9uaWNlY2FuZGlkYXRlXCI7YVthLm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlPTIxXT1cIm9uaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlXCI7YVthLm9uaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2U9MjJdPVwib25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZVwiO2FbYS5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlPTIzXT1cIm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2VcIjthW2Eub25uZWdvdGlhdGlvbm5lZWRlZD0yNF09XCJvbm5lZ290aWF0aW9ubmVlZGVkXCI7YVthLm9ucmVtb3Zlc3RyZWFtPTI1XT1cIm9ucmVtb3Zlc3RyZWFtXCI7YVthLmdldFN0YXRzPTI2XT1cImdldFN0YXRzXCI7YVthLmdldFJlY2VpdmVycz0yN109XCJnZXRSZWNlaXZlcnNcIjthW2EuZ2V0U2VuZGVycz0yOF09XCJnZXRTZW5kZXJzXCI7YVthLmFkZFRyYWNrPTI5XT1cImFkZFRyYWNrXCI7XHJcbmFbYS5yZW1vdmVUcmFjaz0zMF09XCJyZW1vdmVUcmFja1wiO2FbYS5vbnRyYWNrPTMxXT1cIm9udHJhY2tcIjthW2Euc2V0TG9jYWxEZXNjcmlwdGlvbl92Mj0zMl09XCJzZXRMb2NhbERlc2NyaXB0aW9uX3YyXCI7YVthLnNldFJlbW90ZURlc2NyaXB0aW9uX3YyPTMzXT1cInNldFJlbW90ZURlc2NyaXB0aW9uX3YyXCI7YVthLmFkZFRyYW5zY2VpdmVyV2l0aFRyYWNrPTM0XT1cImFkZFRyYW5zY2VpdmVyV2l0aFRyYWNrXCI7YVthLmFkZFRyYW5zY2VpdmVyV2l0aEtpbmQ9MzVdPVwiYWRkVHJhbnNjZWl2ZXJXaXRoS2luZFwiO2FbYS5nZXRUcmFuc2NlaXZlcnM9MzZdPVwiZ2V0VHJhbnNjZWl2ZXJzXCI7YVthLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlPTM3XT1cIm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlXCI7YVthLnNjdHA9MzhdPVwic2N0cFwiO2FbYS5vbmRhdGFjaGFubmVsPTM5XT1cIm9uZGF0YWNoYW5uZWxcIjthW2EuY3JlYXRlRGF0YUNoYW5uZWw9NDBdPVwiY3JlYXRlRGF0YUNoYW5uZWxcIjthW2EuZ2V0U3RhdHNfdjI9XHJcbjQxXT1cImdldFN0YXRzX3YyXCJ9KShoPWEubWV0aG9kX2lkX1JUQ1BlZXJDb25uZWN0aW9uX3R8fChhLm1ldGhvZF9pZF9SVENQZWVyQ29ubmVjdGlvbl90PXt9KSk7dmFyIGQ7KGZ1bmN0aW9uKGEpe2FbYS5jdG9yPTBdPVwiY3RvclwiO2FbYS5lbnVtZXJhdGVEZXZpY2VzPTFdPVwiZW51bWVyYXRlRGV2aWNlc1wiO2FbYS5nZXREaXNwbGF5TWVkaWE9Ml09XCJnZXREaXNwbGF5TWVkaWFcIjthW2Eub25kZXZpY2VjaGFuZ2U9M109XCJvbmRldmljZWNoYW5nZVwiO2FbYS5lbnVtZXJhdGVEZXZpY2VzVjI9NF09XCJlbnVtZXJhdGVEZXZpY2VzVjJcIn0pKGQ9YS5tZXRob2RfaWRfTWVkaWFEZXZpY2VzX3R8fChhLm1ldGhvZF9pZF9NZWRpYURldmljZXNfdD17fSkpO3ZhciBwOyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2EuZGV2aWNlSWQ9MV09XCJkZXZpY2VJZFwiO2FbYS5raW5kPTJdPVwia2luZFwiO2FbYS5sYWJlbD0zXT1cImxhYmVsXCI7YVthLmdyb3VwSWQ9NF09XCJncm91cElkXCJ9KShwPWEubWV0aG9kX2lkX01lZGlhRGV2aWNlSW5mb190fHxcclxuKGEubWV0aG9kX2lkX01lZGlhRGV2aWNlSW5mb190PXt9KSk7dmFyIHE7KGZ1bmN0aW9uKGEpe2FbYS5jdG9yPTBdPVwiY3RvclwiO2FbYS50eXBlPTFdPVwidHlwZVwiO2FbYS5zZHA9Ml09XCJzZHBcIn0pKHE9YS5tZXRob2RfaWRfUlRDU2Vzc2lvbkRlc2NyaXB0aW9uX3R8fChhLm1ldGhvZF9pZF9SVENTZXNzaW9uRGVzY3JpcHRpb25fdD17fSkpO3ZhciBuOyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2Eua2luZD0xXT1cImtpbmRcIjthW2EuaWQ9Ml09XCJpZFwiO2FbYS5sYWJlbD0zXT1cImxhYmVsXCI7YVthLmVuYWJsZWQ9NF09XCJlbmFibGVkXCI7YVthLm11dGVkPTVdPVwibXV0ZWRcIjthW2EucmVhZHlTdGF0ZT02XT1cInJlYWR5U3RhdGVcIjthW2Eub25lbmRlZD03XT1cIm9uZW5kZWRcIjthW2Eub25tdXRlPThdPVwib25tdXRlXCI7YVthLm9udW5tdXRlPTldPVwib251bm11dGVcIjthW2EuY2xvbmU9MTBdPVwiY2xvbmVcIjthW2Euc3RvcD0xMV09XCJzdG9wXCI7YVthLmdldENhcGFiaWxpdGllcz0xMl09XHJcblwiZ2V0Q2FwYWJpbGl0aWVzXCI7YVthLmdldFNldHRpbmdzPTEzXT1cImdldFNldHRpbmdzXCI7YVthLmFwcGx5Q29uc3RyYWludHM9MTRdPVwiYXBwbHlDb25zdHJhaW50c1wiO2FbYS5nZXRDb25zdHJhaW50cz0xNV09XCJnZXRDb25zdHJhaW50c1wifSkobj1hLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3R8fChhLm1ldGhvZF9pZF9NZWRpYVN0cmVhbVRyYWNrX3Q9e30pKTt2YXIgazsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLmlkPTFdPVwiaWRcIjthW2EuZ2V0QXVkaW9UcmFja3M9Ml09XCJnZXRBdWRpb1RyYWNrc1wiO2FbYS5nZXRWaWRlb1RyYWNrcz0zXT1cImdldFZpZGVvVHJhY2tzXCI7YVthLmdldFRyYWNrcz00XT1cImdldFRyYWNrc1wiO2FbYS5nZXRUcmFja0J5SWQ9NV09XCJnZXRUcmFja0J5SWRcIjthW2EuYWRkVHJhY2s9Nl09XCJhZGRUcmFja1wiO2FbYS5yZW1vdmVUcmFjaz03XT1cInJlbW92ZVRyYWNrXCI7YVthLmNsb25lPThdPVwiY2xvbmVcIjthW2EuYWN0aXZlPTldPVwiYWN0aXZlXCJ9KShrPVxyXG5hLm1ldGhvZF9pZF9NZWRpYVN0cmVhbV90fHwoYS5tZXRob2RfaWRfTWVkaWFTdHJlYW1fdD17fSkpO3ZhciB2OyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2EuZ2V0VXNlck1lZGlhPTFdPVwiZ2V0VXNlck1lZGlhXCI7YVthLnNldENvZGVjQ2FwYWJpbGl0aWVzPTJdPVwic2V0Q29kZWNDYXBhYmlsaXRpZXNcIjthW2EuZ2V0Q2FwYWJpbGl0aWVzPTNdPVwiZ2V0Q2FwYWJpbGl0aWVzXCJ9KSh2PWEubWV0aG9kX2lkX05hdmlnYXRvclVzZXJNZWRpYV90fHwoYS5tZXRob2RfaWRfTmF2aWdhdG9yVXNlck1lZGlhX3Q9e30pKTt2YXIgejsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLmNhbmRpZGF0ZT0xXT1cImNhbmRpZGF0ZVwiO2FbYS5zZHBNaWQ9Ml09XCJzZHBNaWRcIjthW2Euc2RwTUxpbmVJbmRleD0zXT1cInNkcE1MaW5lSW5kZXhcIn0pKHo9YS5tZXRob2RfaWRfUlRDSWNlQ2FuZGlkYXRlX3R8fChhLm1ldGhvZF9pZF9SVENJY2VDYW5kaWRhdGVfdD17fSkpO3ZhciBnO1xyXG4oZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLmNhbmRpZGF0ZT0xXT1cImNhbmRpZGF0ZVwifSkoZz1hLm1ldGhvZF9pZF9SVENJY2VDYW5kaWRhdGVFdmVudF90fHwoYS5tZXRob2RfaWRfUlRDSWNlQ2FuZGlkYXRlRXZlbnRfdD17fSkpO3ZhciBCOyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2Euc3RyZWFtPTFdPVwic3RyZWFtXCJ9KShCPWEubWV0aG9kX2lkX01lZGlhU3RyZWFtRXZlbnRfdHx8KGEubWV0aG9kX2lkX01lZGlhU3RyZWFtRXZlbnRfdD17fSkpO3ZhciB0OyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2Euc2lua0lkPTFdPVwic2lua0lkXCI7YVthLmNvbm5lY3RUbz0yXT1cImNvbm5lY3RUb1wiO2FbYS5kaXNjb25uZWN0PTNdPVwiZGlzY29ubmVjdFwiO2FbYS5zZXRGcmFtZT00XT1cInNldEZyYW1lXCI7YVthLmFkZENsaXBSZWN0PTVdPVwiYWRkQ2xpcFJlY3RcIjthW2EucmVtb3ZlQ2xpcFJlY3Q9Nl09XCJyZW1vdmVDbGlwUmVjdFwiO2FbYS5vbmVycm9yPVxyXG43XT1cIm9uZXJyb3JcIjthW2Eub252aWRlb2ZyYW1lY2hhbmdlZD04XT1cIm9udmlkZW9mcmFtZWNoYW5nZWRcIjthW2EucGxhY2VtZW50PTldPVwicGxhY2VtZW50XCJ9KSh0PWEubWV0aG9kX2lkX1ZpZGVvRWxlbWVudF90fHwoYS5tZXRob2RfaWRfVmlkZW9FbGVtZW50X3Q9e30pKTt2YXIgbTsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLnNpbmtJZD0xXT1cInNpbmtJZFwiO2FbYS5zcmNPYmplY3Q9Ml09XCJzcmNPYmplY3RcIjthW2Euc3JjPTNdPVwic3JjXCI7YVthLnBsYXk9NF09XCJwbGF5XCI7YVthLnBhdXNlPTVdPVwicGF1c2VcIjthW2EubG9vcD02XT1cImxvb3BcIn0pKG09YS5tZXRob2RfaWRfQXVkaW9FbGVtZW50X3R8fChhLm1ldGhvZF9pZF9BdWRpb0VsZW1lbnRfdD17fSkpO3ZhciBEOyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2EudHJhY2s9MV09XCJ0cmFja1wiO2FbYS5nZXRDb250cmlidXRpbmdTb3VyY2VzPTJdPVwiZ2V0Q29udHJpYnV0aW5nU291cmNlc1wiO1xyXG5hW2EuZ2V0U3luY2hyb25pemF0aW9uU291cmNlcz0zXT1cImdldFN5bmNocm9uaXphdGlvblNvdXJjZXNcIjthW2EudHJhbnNwb3J0PTRdPVwidHJhbnNwb3J0XCI7YVthLnJ0Y3BUcmFuc3BvcnQ9NV09XCJydGNwVHJhbnNwb3J0XCI7YVthLmdldENhcGFiaWxpdGllcz02XT1cImdldENhcGFiaWxpdGllc1wiO2FbYS5nZXRQYXJhbWV0ZXJzPTddPVwiZ2V0UGFyYW1ldGVyc1wiO2FbYS5nZXRTdGF0cz04XT1cImdldFN0YXRzXCI7YVthLmdldENhcGFiaWxpdGllc192Mj05XT1cImdldENhcGFiaWxpdGllc192MlwifSkoRD1hLm1ldGhvZF9pZF9SVENSdHBSZWNlaXZlcl90fHwoYS5tZXRob2RfaWRfUlRDUnRwUmVjZWl2ZXJfdD17fSkpO3ZhciB5OyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2EudHJhY2s9MV09XCJ0cmFja1wiO2FbYS50cmFuc3BvcnQ9Ml09XCJ0cmFuc3BvcnRcIjthW2EucnRjcFRyYW5zcG9ydD0zXT1cInJ0Y3BUcmFuc3BvcnRcIjthW2EuZHRtZj00XT1cImR0bWZcIjthW2EuZ2V0Q2FwYWJpbGl0aWVzPVxyXG41XT1cImdldENhcGFiaWxpdGllc1wiO2FbYS5nZXRQYXJhbWV0ZXJzPTZdPVwiZ2V0UGFyYW1ldGVyc1wiO2FbYS5zZXRQYXJhbWV0ZXJzPTddPVwic2V0UGFyYW1ldGVyc1wiO2FbYS5yZXBsYWNlVHJhY2s9OF09XCJyZXBsYWNlVHJhY2tcIjthW2EuZ2V0U3RhdHM9OV09XCJnZXRTdGF0c1wiO2FbYS5zZXRTdHJlYW1zPTEwXT1cInNldFN0cmVhbXNcIjthW2EuZ2V0Q2FwYWJpbGl0aWVzX3YyPTExXT1cImdldENhcGFiaWxpdGllc192MlwifSkoeT1hLm1ldGhvZF9pZF9SVENSdHBTZW5kZXJfdHx8KGEubWV0aG9kX2lkX1JUQ1J0cFNlbmRlcl90PXt9KSk7dmFyIHg7KGZ1bmN0aW9uKGEpe2FbYS5jdG9yPTBdPVwiY3RvclwiO2FbYS50cmFuc3BvcnQ9MV09XCJ0cmFuc3BvcnRcIjthW2Euc3RhdGU9Ml09XCJzdGF0ZVwiO2FbYS5nZXRSZW1vdGVDZXJ0aWZpY2F0ZXM9M109XCJnZXRSZW1vdGVDZXJ0aWZpY2F0ZXNcIjthW2Eub25zdGF0ZWNoYW5nZT00XT1cIm9uc3RhdGVjaGFuZ2VcIjthW2Eub25lcnJvcj01XT1cIm9uZXJyb3JcIn0pKHg9XHJcbmEubWV0aG9kX2lkX1JUQ0R0bHNUcmFuc3BvcnRfdHx8KGEubWV0aG9kX2lkX1JUQ0R0bHNUcmFuc3BvcnRfdD17fSkpO3ZhciByOyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2Eucm9sZT0xXT1cInJvbGVcIjthW2EuY29tcG9uZW50PTJdPVwiY29tcG9uZW50XCI7YVthLnN0YXRlPTNdPVwic3RhdGVcIjthW2EuZ2F0aGVyaW5nU3RhdGU9NF09XCJnYXRoZXJpbmdTdGF0ZVwiO2FbYS5sb2NhbGNhbmRpZGF0ZXM9NV09XCJsb2NhbGNhbmRpZGF0ZXNcIjthW2EucmVtb3RlY2FuZGlkYXRlcz02XT1cInJlbW90ZWNhbmRpZGF0ZXNcIjthW2Eub25zdGF0ZWNoYW5nZT03XT1cIm9uc3RhdGVjaGFuZ2VcIjthW2Eub25nYXRoZXJpbmdzdGF0ZWNoYW5nZT04XT1cIm9uZ2F0aGVyaW5nc3RhdGVjaGFuZ2VcIjthW2Eub25zZWxlY3RlZGNhbmRpZGF0ZXBhaXJjaGFuZ2U9OV09XCJvbnNlbGVjdGVkY2FuZGlkYXRlcGFpcmNoYW5nZVwifSkocj1hLm1ldGhvZF9pZF9SVENJY2VUcmFuc3BvcnRfdHx8KGEubWV0aG9kX2lkX1JUQ0ljZVRyYW5zcG9ydF90PVxyXG57fSkpO3ZhciBBOyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2EuaW5zZXJ0RFRNRj0xXT1cImluc2VydERUTUZcIjthW2Eub250b25lY2hhbmdlPTJdPVwib250b25lY2hhbmdlXCI7YVthLmNhbkluc2VydERUTUY9M109XCJjYW5JbnNlcnREVE1GXCI7YVthLnRvbmVCdWZmZXI9NF09XCJ0b25lQnVmZmVyXCJ9KShBPWEubWV0aG9kX2lkX1JUQ0RUTUZTZW5kZXJfdHx8KGEubWV0aG9kX2lkX1JUQ0RUTUZTZW5kZXJfdD17fSkpO3ZhciBNOyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2EudG9uZT0xXT1cInRvbmVcIjthW2EudG9uZV9idWZmZXI9Ml09XCJ0b25lX2J1ZmZlclwifSkoTT1hLm1ldGhvZF9pZF9SVENEVE1GVG9uZUNoYW5nZUV2ZW50X3R8fChhLm1ldGhvZF9pZF9SVENEVE1GVG9uZUNoYW5nZUV2ZW50X3Q9e30pKTt2YXIgRjsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLmxvY2FsPTFdPVwibG9jYWxcIjthW2EucmVtb3RlPTJdPVwicmVtb3RlXCJ9KShGPVxyXG5hLm1ldGhvZF9pZF9SVENJY2VDYW5kaWRhdGVQYWlyX3R8fChhLm1ldGhvZF9pZF9SVENJY2VDYW5kaWRhdGVQYWlyX3Q9e30pKTt2YXIgSjsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLm1pZD0xXT1cIm1pZFwiO2FbYS5zZW5kZXI9Ml09XCJzZW5kZXJcIjthW2EucmVjZWl2ZXI9M109XCJyZWNlaXZlclwiO2FbYS5kaXJlY3Rpb249NF09XCJkaXJlY3Rpb25cIjthW2EuY3VycmVudERpcmVjdGlvbj01XT1cImN1cnJlbnREaXJlY3Rpb25cIjthW2Euc3RvcD02XT1cInN0b3BcIjthW2Euc2V0Q29kZWNQcmVmZXJlbmNlcz03XT1cInNldENvZGVjUHJlZmVyZW5jZXNcIn0pKEo9YS5tZXRob2RfaWRfUlRDUnRwVHJhbnNjZWl2ZXJfdHx8KGEubWV0aG9kX2lkX1JUQ1J0cFRyYW5zY2VpdmVyX3Q9e30pKTt2YXIgRzsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLmdldFNjcmVlbnNBc3luYz0xXT1cImdldFNjcmVlbnNBc3luY1wiO2FbYS5vbnNjcmVlbnRvcG9sb2d5Y2hhbmdlZD1cclxuMl09XCJvbnNjcmVlbnRvcG9sb2d5Y2hhbmdlZFwifSkoRz1hLm1ldGhvZF9pZF9WRElTaGFyaW5nUmVtb3RlX3R8fChhLm1ldGhvZF9pZF9WRElTaGFyaW5nUmVtb3RlX3Q9e30pKTt2YXIgTDsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLnNyY2lkPTFdPVwic3JjaWRcIjthW2EuZGV2aWNlaWQ9Ml09XCJkZXZpY2VpZFwiO2FbYS50eXBlPTNdPVwidHlwZVwiO2FbYS5uYW1lPTRdPVwibmFtZVwiO2FbYS5pbWFnZWRhdGE9NV09XCJpbWFnZWRhdGFcIjthW2EuaHduZD02XT1cImh3bmRcIjthW2Eub3JpZ2luPTddPVwib3JpZ2luXCI7YVthLmNhcHRpb249OF09XCJjYXB0aW9uXCI7YVthLnBpZD05XT1cInBpZFwiO2FbYS5ib3VuZHM9MTBdPVwiYm91bmRzXCJ9KShMPWEubWV0aG9kX2lkX1NjcmVlblNvdXJjZV90fHwoYS5tZXRob2RfaWRfU2NyZWVuU291cmNlX3Q9e30pKTt2YXIgUDsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLmdldEU5MTFJbmZvPTFdPVwiZ2V0RTkxMUluZm9cIjthW2Eub251cGRhdGU9XHJcbjJdPVwib251cGRhdGVcIn0pKFA9YS5tZXRob2RfaWRfRTkxMVNlcnZpY2VfdHx8KGEubWV0aG9kX2lkX0U5MTFTZXJ2aWNlX3Q9e30pKTt2YXIgQzsoZnVuY3Rpb24oYSl7YVthLmN0b3I9MF09XCJjdG9yXCI7YVthLmxhYmVsPTFdPVwibGFiZWxcIjthW2Eub3JkZXJlZD0yXT1cIm9yZGVyZWRcIjthW2EubWF4UGFja2V0TGlmZVRpbWU9M109XCJtYXhQYWNrZXRMaWZlVGltZVwiO2FbYS5tYXhSZXRyYW5zbWl0cz00XT1cIm1heFJldHJhbnNtaXRzXCI7YVthLnByb3RvY29sPTVdPVwicHJvdG9jb2xcIjthW2EubmVnb3RpYXRlZD02XT1cIm5lZ290aWF0ZWRcIjthW2EuaWQ9N109XCJpZFwiO2FbYS5yZWFkeVN0YXRlPThdPVwicmVhZHlTdGF0ZVwiO2FbYS5idWZmZXJlZEFtb3VudD05XT1cImJ1ZmZlcmVkQW1vdW50XCI7YVthLmJ1ZmZlcmVkQW1vdW50TG93VGhyZXNob2xkPTEwXT1cImJ1ZmZlcmVkQW1vdW50TG93VGhyZXNob2xkXCI7YVthLm9ub3Blbj0xMV09XCJvbm9wZW5cIjthW2Eub25idWZmZXJlZGFtb3VudGxvdz0xMl09XHJcblwib25idWZmZXJlZGFtb3VudGxvd1wiO2FbYS5vbmVycm9yPTEzXT1cIm9uZXJyb3JcIjthW2Eub25jbG9zaW5nPTE0XT1cIm9uY2xvc2luZ1wiO2FbYS5vbmNsb3NlPTE1XT1cIm9uY2xvc2VcIjthW2Eub25tZXNzYWdlPTE2XT1cIm9ubWVzc2FnZVwiO2FbYS5jbG9zZT0xN109XCJjbG9zZVwiO2FbYS5zZW5kX3RleHQ9MThdPVwic2VuZF90ZXh0XCI7YVthLnNlbmRfYmluYXJ5PTE5XT1cInNlbmRfYmluYXJ5XCJ9KShDPWEubWV0aG9kX2lkX1JUQ0RhdGFDaGFubmVsX3R8fChhLm1ldGhvZF9pZF9SVENEYXRhQ2hhbm5lbF90PXt9KSk7dmFyIFI7KGZ1bmN0aW9uKGEpe2FbYS5jdG9yPTBdPVwiY3RvclwiO2FbYS50cmFuc3BvcnQ9MV09XCJ0cmFuc3BvcnRcIjthW2Euc3RhdGU9Ml09XCJzdGF0ZVwiO2FbYS5tYXhNZXNzYWdlU2l6ZT0zXT1cIm1heE1lc3NhZ2VTaXplXCI7YVthLm1heENoYW5uZWxzPTRdPVwibWF4Q2hhbm5lbHNcIjthW2Eub25zdGF0ZWNoYW5nZT01XT1cIm9uc3RhdGVjaGFuZ2VcIn0pKFI9YS5tZXRob2RfaWRfUlRDU2N0cFRyYW5zcG9ydF90fHxcclxuKGEubWV0aG9kX2lkX1JUQ1NjdHBUcmFuc3BvcnRfdD17fSkpO3ZhciBLOyhmdW5jdGlvbihhKXthW2EuY3Rvcj0wXT1cImN0b3JcIjthW2EuZ2V0Q2FsbENvbnN0cmFpbnRzPTFdPVwiZ2V0Q2FsbENvbnN0cmFpbnRzXCI7YVthLm9udXBkYXRlPTJdPVwib251cGRhdGVcIn0pKEs9YS5tZXRob2RfaWRfU3RyZWFtUmVzb2x1dGlvbl90fHwoYS5tZXRob2RfaWRfU3RyZWFtUmVzb2x1dGlvbl90PXt9KSk7YS5jbGFzc19saWJfaW5mbz1uZXcgYi5XZWJycGNDbGFzc0xpYkluZm8oXCJ3ZWJycGNfY2xhc3NfbGlicmFyeVwiLFtuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5FbmdpbmVDb250cm9sLFwiRW5naW5lQ29udHJvbFwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuRW5naW5lQ29udHJvbCxsLmN0b3IsXCJjdG9yXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5FbmdpbmVDb250cm9sLGwudmVyc2lvbixcInZlcnNpb25cIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkVuZ2luZUNvbnRyb2wsXHJcbmwuZmVhdHVyZV9mbGFncyxcImZlYXR1cmVfZmxhZ3NcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkVuZ2luZUNvbnRyb2wsbC52ZXJzaW9uX2luZm8sXCJ2ZXJzaW9uX2luZm9cIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGVza3RvcF9zaGFyaW5nKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuRW5naW5lQ29udHJvbCxsLm9zaW5mbyxcIm9zaW5mb1wiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19vc2luZm8pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5FbmdpbmVDb250cm9sLGwuZW5kcG9pbnRfaWQsXCJlbmRwb2ludF9pZFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19lbmRwb2ludF9pZCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkVuZ2luZUNvbnRyb2wsbC5zZXRfY2xpZW50X2luZm8sXCJzZXRfY2xpZW50X2luZm9cIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfY2xpZW50X2luZm8pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5FbmdpbmVDb250cm9sLGwuaGFyZHdhcmVfaW5mbyxcImhhcmR3YXJlX2luZm9cIixcclxuITAsYS5GRUFUVVJFX21zX3RlYW1zX2hhcmR3YXJlX2luZm8pXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24sXCJSVENQZWVyQ29ubmVjdGlvblwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5jdG9yLFwiY3RvclwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5sb2NhbERlc2NyaXB0aW9uLFwibG9jYWxEZXNjcmlwdGlvblwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5yZW1vdGVEZXNjcmlwdGlvbixcInJlbW90ZURlc2NyaXB0aW9uXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixoLnJlYWR5U3RhdGUsXCJyZWFkeVN0YXRlXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixoLmljZVN0YXRlLFwiaWNlU3RhdGVcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLFxyXG5oLmxvY2FsU3RyZWFtcyxcImxvY2FsU3RyZWFtc1wiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5yZW1vdGVTdHJlYW1zLFwicmVtb3RlU3RyZWFtc1wiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5jcmVhdGVPZmZlcixcImNyZWF0ZU9mZmVyXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixoLmNyZWF0ZUFuc3dlcixcImNyZWF0ZUFuc3dlclwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5zZXRMb2NhbERlc2NyaXB0aW9uLFwic2V0TG9jYWxEZXNjcmlwdGlvblwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5zZXRSZW1vdGVEZXNjcmlwdGlvbixcInNldFJlbW90ZURlc2NyaXB0aW9uXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixoLnVwZGF0ZUljZSxcclxuXCJ1cGRhdGVJY2VcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGguYWRkSWNlQ2FuZGlkYXRlLFwiYWRkSWNlQ2FuZGlkYXRlXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixoLmFkZFN0cmVhbSxcImFkZFN0cmVhbVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5yZW1vdmVTdHJlYW0sXCJyZW1vdmVTdHJlYW1cIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGguY2xvc2UsXCJjbG9zZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5pY2VDb25uZWN0aW9uU3RhdGUsXCJpY2VDb25uZWN0aW9uU3RhdGVcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGguaWNlR2F0aGVyaW5nU3RhdGUsXCJpY2VHYXRoZXJpbmdTdGF0ZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24sXHJcbmguc2lnbmFsaW5nU3RhdGUsXCJzaWduYWxpbmdTdGF0ZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5vbmFkZHN0cmVhbSxcIm9uYWRkc3RyZWFtXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixoLm9uaWNlY2FuZGlkYXRlLFwib25pY2VjYW5kaWRhdGVcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGgub25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2UsXCJvbmljZWNvbm5lY3Rpb25zdGF0ZWNoYW5nZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5vbmljZWdhdGhlcmluZ3N0YXRlY2hhbmdlLFwib25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5vbnNpZ25hbGluZ3N0YXRlY2hhbmdlLFwib25zaWduYWxpbmdzdGF0ZWNoYW5nZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24sXHJcbmgub25uZWdvdGlhdGlvbm5lZWRlZCxcIm9ubmVnb3RpYXRpb25uZWVkZWRcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGgub25yZW1vdmVzdHJlYW0sXCJvbnJlbW92ZXN0cmVhbVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5nZXRTdGF0cyxcImdldFN0YXRzXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixoLmdldFJlY2VpdmVycyxcImdldFJlY2VpdmVyc1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc19zcGVha2luZ19pbmRpY2F0b3IpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixoLmdldFNlbmRlcnMsXCJnZXRTZW5kZXJzXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixoLmFkZFRyYWNrLFwiYWRkVHJhY2tcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksXHJcbm5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixoLnJlbW92ZVRyYWNrLFwicmVtb3ZlVHJhY2tcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGgub250cmFjayxcIm9udHJhY2tcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGguc2V0TG9jYWxEZXNjcmlwdGlvbl92MixcInNldExvY2FsRGVzY3JpcHRpb25fdjJcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfd2VicnRjXzFkb3QwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5zZXRSZW1vdGVEZXNjcmlwdGlvbl92MixcInNldFJlbW90ZURlc2NyaXB0aW9uX3YyXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1BlZXJDb25uZWN0aW9uLGguYWRkVHJhbnNjZWl2ZXJXaXRoVHJhY2ssXHJcblwiYWRkVHJhbnNjZWl2ZXJXaXRoVHJhY2tcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfd2VicnRjXzFkb3QwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5hZGRUcmFuc2NlaXZlcldpdGhLaW5kLFwiYWRkVHJhbnNjZWl2ZXJXaXRoS2luZFwiLCExLGEuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixoLmdldFRyYW5zY2VpdmVycyxcImdldFRyYW5zY2VpdmVyc1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixoLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlLFwib25jb25uZWN0aW9uc3RhdGVjaGFuZ2VcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfd2VicnRjXzFkb3QwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5zY3RwLFwic2N0cFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLFxyXG5uZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5vbmRhdGFjaGFubmVsLFwib25kYXRhY2hhbm5lbFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENQZWVyQ29ubmVjdGlvbixoLmNyZWF0ZURhdGFDaGFubmVsLFwiY3JlYXRlRGF0YUNoYW5uZWxcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUGVlckNvbm5lY3Rpb24saC5nZXRTdGF0c192MixcImdldFN0YXRzX3YyXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCldKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5SVENTZXNzaW9uRGVzY3JpcHRpb24sXCJSVENTZXNzaW9uRGVzY3JpcHRpb25cIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1Nlc3Npb25EZXNjcmlwdGlvbixxLmN0b3IsXCJjdG9yXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENTZXNzaW9uRGVzY3JpcHRpb24sXHJcbnEudHlwZSxcInR5cGVcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1Nlc3Npb25EZXNjcmlwdGlvbixxLnNkcCxcInNkcFwiLCEwKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLlJUQ0ljZUNhbmRpZGF0ZSxcIlJUQ0ljZUNhbmRpZGF0ZVwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDSWNlQ2FuZGlkYXRlLHouY3RvcixcImN0b3JcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZUNhbmRpZGF0ZSx6LmNhbmRpZGF0ZSxcImNhbmRpZGF0ZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDSWNlQ2FuZGlkYXRlLHouc2RwTWlkLFwic2RwTWlkXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VDYW5kaWRhdGUsei5zZHBNTGluZUluZGV4LFwic2RwTUxpbmVJbmRleFwiLCEwKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLlJUQ0ljZUNhbmRpZGF0ZUV2ZW50LFwiUlRDSWNlQ2FuZGlkYXRlRXZlbnRcIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZUNhbmRpZGF0ZUV2ZW50LFxyXG5nLmN0b3IsXCJjdG9yXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VDYW5kaWRhdGVFdmVudCxnLmNhbmRpZGF0ZSxcImNhbmRpZGF0ZVwiLCEwKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLk1lZGlhRGV2aWNlcyxcIk1lZGlhRGV2aWNlc1wiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFEZXZpY2VzLGQuY3RvcixcImN0b3JcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhRGV2aWNlcyxkLmVudW1lcmF0ZURldmljZXMsXCJlbnVtZXJhdGVEZXZpY2VzXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYURldmljZXMsZC5nZXREaXNwbGF5TWVkaWEsXCJnZXREaXNwbGF5TWVkaWFcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfZGVza3RvcF9zaGFyaW5nKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFEZXZpY2VzLGQub25kZXZpY2VjaGFuZ2UsXCJvbmRldmljZWNoYW5nZVwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19zcGVha2luZ19pbmRpY2F0b3IpLFxyXG5uZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFEZXZpY2VzLGQuZW51bWVyYXRlRGV2aWNlc1YyLFwiZW51ZXJhdGVEZXZpY2VzVjJcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfZW51bWVyYXRlX2RldmljZXNfdjIpXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuTWVkaWFEZXZpY2VJbmZvLFwiTWVkaWFEZXZpY2VJbmZvXCIsW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYURldmljZUluZm8scC5jdG9yLFwiY3RvclwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFEZXZpY2VJbmZvLHAuZGV2aWNlSWQsXCJkZXZpY2VJZFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFEZXZpY2VJbmZvLHAua2luZCxcImtpbmRcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhRGV2aWNlSW5mbyxwLmxhYmVsLFwibGFiZWxcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhRGV2aWNlSW5mbyxwLmdyb3VwSWQsXCJncm91cElkXCIsITApXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuTWVkaWFTdHJlYW1UcmFjayxcclxuXCJNZWRpYVN0cmVhbVRyYWNrXCIsW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbVRyYWNrLG4uY3RvcixcImN0b3JcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbi5jbG9uZSxcImNsb25lXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbVRyYWNrLG4uc3RvcCxcInN0b3BcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbi5nZXRDYXBhYmlsaXRpZXMsXCJnZXRDYXBhYmlsaXRpZXNcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbi5nZXRTZXR0aW5ncyxcImdldFNldHRpbmdzXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbVRyYWNrLG4uYXBwbHlDb25zdHJhaW50cyxcImFwcGx5Q29uc3RyYWludHNcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfZGVza3RvcF9zaGFyaW5nKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW1UcmFjayxcclxubi5raW5kLFwia2luZFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW1UcmFjayxuLmlkLFwiaWRcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbi5sYWJlbCxcImxhYmVsXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbVRyYWNrLG4uZW5hYmxlZCxcImVuYWJsZWRcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbi5tdXRlZCxcIm11dGVkXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbVRyYWNrLG4ucmVhZHlTdGF0ZSxcInJlYWR5U3RhdGVcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtVHJhY2ssbi5vbmVuZGVkLFwib25lbmRlZFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW1UcmFjayxuLm9ubXV0ZSxcIm9ubXV0ZVwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW1UcmFjayxcclxubi5vbnVubXV0ZSxcIm9udW5tdXRlXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbVRyYWNrLG4uZ2V0Q29uc3RyYWludHMsXCJnZXRDb25zdHJhaW50c1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc19tc3RyYWNrX2NvbnN0cmFpbnRzKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLk1lZGlhU3RyZWFtLFwiTWVkaWFTdHJlYW1cIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtLGsuY3RvcixcImN0b3JcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtLGsuaWQsXCJpZFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW0say5nZXRBdWRpb1RyYWNrcyxcImdldEF1ZGlvVHJhY2tzXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbSxrLmdldFZpZGVvVHJhY2tzLFwiZ2V0VmlkZW9UcmFja3NcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtLGsuZ2V0VHJhY2tzLFxyXG5cImdldFRyYWNrc1wiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW0say5nZXRUcmFja0J5SWQsXCJnZXRUcmFja0J5SWRcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtLGsuYWRkVHJhY2ssXCJhZGRUcmFja1wiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW0say5yZW1vdmVUcmFjayxcInJlbW92ZVRyYWNrXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbSxrLmNsb25lLFwiY2xvbmVcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLk1lZGlhU3RyZWFtLGsuYWN0aXZlLFwiYWN0aXZlXCIsITApXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuTmF2aWdhdG9yVXNlck1lZGlhLFwiTmF2aWdhdG9yVXNlck1lZGlhXCIsW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5OYXZpZ2F0b3JVc2VyTWVkaWEsdi5jdG9yLFwiY3RvclwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTmF2aWdhdG9yVXNlck1lZGlhLFxyXG52LmdldFVzZXJNZWRpYSxcImdldFVzZXJNZWRpYVwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTmF2aWdhdG9yVXNlck1lZGlhLHYuc2V0Q29kZWNDYXBhYmlsaXRpZXMsXCJzZXRDb2RlY0NhcGFiaWxpdGllc1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc19jb2RlY19jYXBhYmlsaXR5KSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTmF2aWdhdG9yVXNlck1lZGlhLHYuZ2V0Q2FwYWJpbGl0aWVzLFwiZ2V0UnRwQ2FwYWJpbGl0aWVzXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCldKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5NZWRpYVN0cmVhbUV2ZW50LFwiTWVkaWFTdHJlYW1FdmVudFwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuTWVkaWFTdHJlYW1FdmVudCxCLmN0b3IsXCJjdG9yXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5NZWRpYVN0cmVhbUV2ZW50LEIuc3RyZWFtLFwic3RyZWFtXCIsITApXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuVmlkZW9FbGVtZW50LFxyXG5cIlZpZGVvRWxlbWVudFwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuVmlkZW9FbGVtZW50LHQuY3RvcixcImN0b3JcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlZpZGVvRWxlbWVudCx0LnNpbmtJZCxcInNpbmtJZFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuVmlkZW9FbGVtZW50LHQuY29ubmVjdFRvLFwiY29ubmVjdFRvXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5WaWRlb0VsZW1lbnQsdC5kaXNjb25uZWN0LFwiZGlzY29ubmVjdFwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuVmlkZW9FbGVtZW50LHQuc2V0RnJhbWUsXCJzZXRGcmFtZVwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuVmlkZW9FbGVtZW50LHQuYWRkQ2xpcFJlY3QsXCJhZGRDbGlwUmVjdFwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuVmlkZW9FbGVtZW50LHQucmVtb3ZlQ2xpcFJlY3QsXCJyZW1vdmVDbGlwUmVjdFwiLCExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuVmlkZW9FbGVtZW50LFxyXG50Lm9uZXJyb3IsXCJvbmVycm9yXCIsITApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5WaWRlb0VsZW1lbnQsdC5vbnZpZGVvZnJhbWVjaGFuZ2VkLFwib252aWRlb2ZyYW1lY2hhbmdlZFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuVmlkZW9FbGVtZW50LHQucGxhY2VtZW50LFwicGxhY2VtZW50XCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3ZpZGVvX3BsYWNlbWVudCldKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5BdWRpb0VsZW1lbnQsXCJBdWRpb0VsZW1lbnRcIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkF1ZGlvRWxlbWVudCxtLmN0b3IsXCJjdG9yXCIsITEpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5BdWRpb0VsZW1lbnQsbS5zaW5rSWQsXCJzaW5rSWRcIiwhMCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkF1ZGlvRWxlbWVudCxtLnNyY09iamVjdCxcInNyY09iamVjdFwiLCEwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuQXVkaW9FbGVtZW50LG0uc3JjLFwic3JjXCIsITApLFxyXG5uZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuQXVkaW9FbGVtZW50LG0ucGxheSxcInBsYXlcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkF1ZGlvRWxlbWVudCxtLnBhdXNlLFwicGF1c2VcIiwhMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkF1ZGlvRWxlbWVudCxtLmxvb3AsXCJsb29wXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2F1ZGlvX25vdGlmaWNhdGlvbnNfbG9vcCldKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5SVENSdHBSZWNlaXZlcixcIlJUQ1J0cFJlY2VpdmVyXCIsW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBSZWNlaXZlcixELmN0b3IsXCJjdG9yXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3NwZWFraW5nX2luZGljYXRvciksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFJlY2VpdmVyLEQudHJhY2ssXCJ0cmFja1wiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19zcGVha2luZ19pbmRpY2F0b3IpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBSZWNlaXZlcixcclxuRC5nZXRDb250cmlidXRpbmdTb3VyY2VzLFwiZ2V0Q29udHJpYnV0aW5nU291cmNlc1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc19zcGVha2luZ19pbmRpY2F0b3IpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBSZWNlaXZlcixELmdldFN5bmNocm9uaXphdGlvblNvdXJjZXMsXCJnZXRTeW5jaHJvbml6YXRpb25Tb3VyY2VzXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBSZWNlaXZlcixELnRyYW5zcG9ydCxcInRyYW5zcG9ydFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwUmVjZWl2ZXIsRC5ydGNwVHJhbnNwb3J0LFwicnRjcHRyYW5zcG9ydFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwUmVjZWl2ZXIsRC5nZXRDYXBhYmlsaXRpZXMsXCJnZXRDYXBhYmlsaXRpZXNcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksXHJcbm5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBSZWNlaXZlcixELmdldFBhcmFtZXRlcnMsXCJnZXRQYXJhbWV0ZXJzXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBSZWNlaXZlcixELmdldFN0YXRzLFwiZ2V0U3RhdHNcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFJlY2VpdmVyLEQuZ2V0Q2FwYWJpbGl0aWVzX3YyLFwiZ2V0Q2FwYWJpbGl0aWVzX3YyXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCldKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5SVENSdHBTZW5kZXIsXCJSVENSdHBTZW5kZXJcIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFNlbmRlcix5LmN0b3IsXCJjdG9yXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBTZW5kZXIseS50cmFjayxcInRyYWNrXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLFxyXG5uZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwU2VuZGVyLHkudHJhbnNwb3J0LFwidHJhbnNwb3J0XCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBTZW5kZXIseS5ydGNwVHJhbnNwb3J0LFwicnRjcFRyYW5zcG9ydFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwU2VuZGVyLHkuZHRtZixcImR0bWZcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFNlbmRlcix5LmdldENhcGFiaWxpdGllcyxcImdldENhcGFiaWxpdGllc1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwU2VuZGVyLHkuZ2V0UGFyYW1ldGVycyxcImdldFBhcmFtZXRlcnNcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFNlbmRlcixcclxueS5zZXRQYXJhbWV0ZXJzLFwic2V0UGFyYW1ldGVyc1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwU2VuZGVyLHkucmVwbGFjZVRyYWNrLFwicmVwbGFjZVRyYWNrXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBTZW5kZXIseS5nZXRTdGF0cyxcImdldFN0YXRzXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBTZW5kZXIseS5zZXRTdHJlYW1zLFwic2V0U3RyZWFtc1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwU2VuZGVyLHkuZ2V0Q2FwYWJpbGl0aWVzX3YyLFwiZ2V0Q2FwYWJpbGl0aWVzX3YyXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCldKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5SVENEdGxzVHJhbnNwb3J0LFwiUlRDRHRsc1RyYW5zcG9ydFwiLFxyXG5bbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0R0bHNUcmFuc3BvcnQseC5jdG9yLFwiY3RvclwiLCExLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRHRsc1RyYW5zcG9ydCx4LnRyYW5zcG9ydCxcInRyYW5zcG9ydFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRHRsc1RyYW5zcG9ydCx4LnN0YXRlLFwic3RhdGVcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0R0bHNUcmFuc3BvcnQseC5nZXRSZW1vdGVDZXJ0aWZpY2F0ZXMsXCJnZXRSZW1vdGVDZXJ0aWZpY2F0ZXNcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0R0bHNUcmFuc3BvcnQseC5vbnN0YXRlY2hhbmdlLFwib25zdGF0ZWNoYW5nZVwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRHRsc1RyYW5zcG9ydCxcclxueC5vbmVycm9yLFwib25lcnJvclwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLlJUQ0ljZVRyYW5zcG9ydCxcIlJUQ0ljZVRyYW5zcG9ydFwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDSWNlVHJhbnNwb3J0LHIuY3RvcixcImN0b3JcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZVRyYW5zcG9ydCxyLnJvbGUsXCJyb2xlXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VUcmFuc3BvcnQsci5jb21wb25lbnQsXCJjb21wb25lbnRcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZVRyYW5zcG9ydCxyLnN0YXRlLFwic3RhdGVcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZVRyYW5zcG9ydCxyLmdhdGhlcmluZ1N0YXRlLFxyXG5cImdhdGhlcmluZ1N0YXRlXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VUcmFuc3BvcnQsci5sb2NhbGNhbmRpZGF0ZXMsXCJsb2NhbGNhbmRpZGF0ZXNcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZVRyYW5zcG9ydCxyLnJlbW90ZWNhbmRpZGF0ZXMsXCJyZW1vdGVjYW5kaWRhdGVzXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VUcmFuc3BvcnQsci5vbnN0YXRlY2hhbmdlLFwib25zdGF0ZWNoYW5nZVwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDSWNlVHJhbnNwb3J0LHIub25nYXRoZXJpbmdzdGF0ZWNoYW5nZSxcIm9uZ2F0aGVyaW5nc3RhdGVjaGFuZ2VcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZVRyYW5zcG9ydCxcclxuci5vbnNlbGVjdGVkY2FuZGlkYXRlcGFpcmNoYW5nZSxcIm9uc2VsZWN0ZWRjYW5kaWRhdGVwYWlyY2hhbmdlXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuUlRDRFRNRlNlbmRlcixcIlJUQ0RUTUZTZW5kZXJcIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RUTUZTZW5kZXIsQS5jdG9yLFwiY3RvclwiLCExLGEuRkVBVFVSRV9tc190ZWFtc19wc3RuKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRFRNRlNlbmRlcixBLmluc2VydERUTUYsXCJpbnNlcnREVE1GXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEVE1GU2VuZGVyLEEub250b25lY2hhbmdlLFwib250b25lY2hhbmdlXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEVE1GU2VuZGVyLEEuY2FuSW5zZXJ0RFRNRixcImNhbkluc2VydERUTUZcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksXHJcbm5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEVE1GU2VuZGVyLEEudG9uZUJ1ZmZlcixcInRvbmVCdWZmZXJcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0bildKSxuZXcgYi5XZWJycGNDbGFzc0luZm8oYy5SVENEVE1GVG9uZUNoYW5nZUV2ZW50LFwiUlRDRFRNRlRvbmVDaGFuZ2VFdmVudFwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRFRNRlRvbmVDaGFuZ2VFdmVudCxNLmN0b3IsXCJjdG9yXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEVE1GVG9uZUNoYW5nZUV2ZW50LE0udG9uZSxcInRvbmVcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RUTUZUb25lQ2hhbmdlRXZlbnQsTS50b25lX2J1ZmZlcixcInRvbmVfYnVmZmVyXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuUlRDSWNlQ2FuZGlkYXRlUGFpcixcIlJUQ0ljZUNhbmRpZGF0ZVBhaXJcIixcclxuW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VDYW5kaWRhdGVQYWlyLEYuY3RvcixcImN0b3JcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfcHN0biksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0ljZUNhbmRpZGF0ZVBhaXIsRi5sb2NhbCxcImxvY2FsXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENJY2VDYW5kaWRhdGVQYWlyLEYucmVtb3RlLFwicmVtb3RlXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3BzdG4pXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuUlRDUnRwVHJhbnNjZWl2ZXIsXCJSVENSdHBUcmFuc2NlaXZlclwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwVHJhbnNjZWl2ZXIsSi5jdG9yLFwiY3RvclwiLCExLGEuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDApLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENSdHBUcmFuc2NlaXZlcixKLm1pZCxcIm1pZFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDApLFxyXG5uZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwVHJhbnNjZWl2ZXIsSi5zZW5kZXIsXCJzZW5kZXJcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfd2VicnRjXzFkb3QwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwVHJhbnNjZWl2ZXIsSi5yZWNlaXZlcixcInJlY2VpdmVyXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFRyYW5zY2VpdmVyLEouZGlyZWN0aW9uLFwiZGlyZWN0aW9uXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX3dlYnJ0Y18xZG90MCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1J0cFRyYW5zY2VpdmVyLEouY3VycmVudERpcmVjdGlvbixcImN1cnJlbnREaXJlY3Rpb25cIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfd2VicnRjXzFkb3QwKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwVHJhbnNjZWl2ZXIsSi5zdG9wLFwic3RvcFwiLCExLGEuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDApLFxyXG5uZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDUnRwVHJhbnNjZWl2ZXIsSi5zZXRDb2RlY1ByZWZlcmVuY2VzLFwic2V0Q29kZWNQcmVmZXJlbmNlc1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc193ZWJydGNfMWRvdDApXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuU2NyZWVuU2hhcmluZ1JlbW90ZSxcIlNjcmVlblNoYXJpbmdSZW1vdGVcIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlNjcmVlblNoYXJpbmdSZW1vdGUsRy5jdG9yLFwiY3RvclwiLCExLGEuRkVBVFVSRV9tc190ZWFtc19tb25pdG9yX3NoYXJpbmcpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5TY3JlZW5TaGFyaW5nUmVtb3RlLEcuZ2V0U2NyZWVuc0FzeW5jLFwiZ2V0U2NyZWVuc0FzeW5jXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX21vbml0b3Jfc2hhcmluZyksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlNjcmVlblNoYXJpbmdSZW1vdGUsRy5vbnNjcmVlbnRvcG9sb2d5Y2hhbmdlZCxcIm9uc2NyZWVudG9wb2xvZ3ljaGFuZ2VkXCIsXHJcbiEwLGEuRkVBVFVSRV9tc190ZWFtc19tb25pdG9yX3NoYXJpbmcpXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuU2NyZWVuU291cmNlLFwiU2NyZWVuU291cmNlXCIsW25ldyBiLldlYnJwY01ldGhvZEluZm8oYy5TY3JlZW5Tb3VyY2UsTC5jdG9yLFwiY3RvclwiLCExLGEuRkVBVFVSRV9tc190ZWFtc19tb25pdG9yX3NoYXJpbmcpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5TY3JlZW5Tb3VyY2UsTC5zcmNpZCxcInNyY2lkXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX21vbml0b3Jfc2hhcmluZyksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlNjcmVlblNvdXJjZSxMLmRldmljZWlkLFwiZGV2aWNlaWRcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfbW9uaXRvcl9zaGFyaW5nKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuU2NyZWVuU291cmNlLEwudHlwZSxcInR5cGVcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfbW9uaXRvcl9zaGFyaW5nKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuU2NyZWVuU291cmNlLFxyXG5MLm5hbWUsXCJuYW1lXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX21vbml0b3Jfc2hhcmluZyksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlNjcmVlblNvdXJjZSxMLmltYWdlZGF0YSxcImltYWdlZGF0YVwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19tb25pdG9yX3NoYXJpbmcpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5TY3JlZW5Tb3VyY2UsTC5od25kLFwiaHduZFwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19tb25pdG9yX3NoYXJpbmcpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5TY3JlZW5Tb3VyY2UsTC5vcmlnaW4sXCJvcmlnaW5cIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfbW9uaXRvcl9zaGFyaW5nKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuU2NyZWVuU291cmNlLEwuY2FwdGlvbixcImNhcHRpb25cIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfbW9uaXRvcl9zaGFyaW5nKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuU2NyZWVuU291cmNlLEwucGlkLFwicGlkXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX21vbml0b3Jfc2hhcmluZyksXHJcbm5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5TY3JlZW5Tb3VyY2UsTC5ib3VuZHMsXCJib3VuZHNcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZ3RjKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLkU5MTFTZXJ2aWNlLFwiRTkxMVNlcnZpY2VcIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkU5MTFTZXJ2aWNlLFAuY3RvcixcImN0b3JcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfZTkxMSksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLkU5MTFTZXJ2aWNlLFAuZ2V0RTkxMUluZm8sXCJnZXRFOTExSW5mb1wiLCExLGEuRkVBVFVSRV9tc190ZWFtc19lOTExKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuRTkxMVNlcnZpY2UsUC5vbnVwZGF0ZSxcIm9udXBkYXRlXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2U5MTEpXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuUlRDRGF0YUNoYW5uZWwsXCJSVENEYXRhQ2hhbm5lbFwiLFtuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwsQy5jdG9yLFxyXG5cImN0b3JcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwsQy5sYWJlbCxcImxhYmVsXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLEMub3JkZXJlZCxcIm9yZGVyZWRcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwsQy5tYXhQYWNrZXRMaWZlVGltZSxcIm1heFBhY2tldExpZmVUaW1lXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLEMubWF4UmV0cmFuc21pdHMsXCJtYXhSZXRyYW5zbWl0c1wiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEYXRhQ2hhbm5lbCxDLnByb3RvY29sLFxyXG5cInByb3RvY29sXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLEMubmVnb3RpYXRlZCxcIm5lZ290aWF0ZWRcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwsQy5pZCxcImlkXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLEMucmVhZHlTdGF0ZSxcInJlYWR5U3RhdGVcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwsQy5idWZmZXJlZEFtb3VudCxcImJ1ZmZlcmVkQW1vdW50XCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLEMuYnVmZmVyZWRBbW91bnRMb3dUaHJlc2hvbGQsXHJcblwiYnVmZmVyZWRBbW91bnRMb3dUaHJlc2hvbGRcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwsQy5vbm9wZW4sXCJvbm9wZW5cIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDRGF0YUNoYW5uZWwsQy5vbmJ1ZmZlcmVkYW1vdW50bG93LFwib25idWZmZXJlZGFtb3VudGxvd1wiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEYXRhQ2hhbm5lbCxDLm9uZXJyb3IsXCJvbmVycm9yXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLEMub25jbG9zaW5nLFwib25jbG9zaW5nXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLFxyXG5DLm9uY2xvc2UsXCJvbmNsb3NlXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLEMub25tZXNzYWdlLFwib25tZXNzYWdlXCIsITAsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ0RhdGFDaGFubmVsLEMuY2xvc2UsXCJjbG9zZVwiLCExLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEYXRhQ2hhbm5lbCxDLnNlbmRfdGV4dCxcInNlbmRfdGV4dFwiLCExLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5SVENEYXRhQ2hhbm5lbCxDLnNlbmRfYmluYXJ5LFwic2VuZF9iaW5hcnlcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKV0pLG5ldyBiLldlYnJwY0NsYXNzSW5mbyhjLlJUQ1NjdHBUcmFuc3BvcnQsXCJSVENTY3RwVHJhbnNwb3J0XCIsXHJcbltuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDU2N0cFRyYW5zcG9ydCxSLmN0b3IsXCJjdG9yXCIsITEsYS5GRUFUVVJFX21zX3RlYW1zX2RhdGFfY2hhbm5lbCksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1NjdHBUcmFuc3BvcnQsUi50cmFuc3BvcnQsXCJ0cmFuc3BvcnRcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDU2N0cFRyYW5zcG9ydCxSLnN0YXRlLFwic3RhdGVcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDU2N0cFRyYW5zcG9ydCxSLm1heE1lc3NhZ2VTaXplLFwibWF4TWVzc2FnZVNpemVcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxuZXcgYi5XZWJycGNNZXRob2RJbmZvKGMuUlRDU2N0cFRyYW5zcG9ydCxSLm1heENoYW5uZWxzLFwibWF4Q2hhbm5lbHNcIiwhMCxhLkZFQVRVUkVfbXNfdGVhbXNfZGF0YV9jaGFubmVsKSxcclxubmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlJUQ1NjdHBUcmFuc3BvcnQsUi5vbnN0YXRlY2hhbmdlLFwib25zdGF0ZWNoYW5nZVwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19kYXRhX2NoYW5uZWwpXSksbmV3IGIuV2VicnBjQ2xhc3NJbmZvKGMuU3RyZWFtUmVzb2x1dGlvbixcIlN0cmVhbVJlc29sdXRpb25cIixbbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlN0cmVhbVJlc29sdXRpb24sSy5jdG9yLFwiY3RvclwiLCExLGEuRkVBVFVSRV9tc190ZWFtc19zdHJlYW1fcmVzb2x1dGlvbiksbmV3IGIuV2VicnBjTWV0aG9kSW5mbyhjLlN0cmVhbVJlc29sdXRpb24sSy5nZXRDYWxsQ29uc3RyYWludHMsXCJnZXRDYWxsQ29uc3RyYWludHNcIiwhMSxhLkZFQVRVUkVfbXNfdGVhbXNfc3RyZWFtX3Jlc29sdXRpb24pLG5ldyBiLldlYnJwY01ldGhvZEluZm8oYy5TdHJlYW1SZXNvbHV0aW9uLEsub251cGRhdGUsXCJvbnVwZGF0ZVwiLCEwLGEuRkVBVFVSRV9tc190ZWFtc19zdHJlYW1fcmVzb2x1dGlvbildKV0pfSxcclxuNTQ1OmZ1bmN0aW9uKGIsYSxjKXt2YXIgZT10aGlzJiZ0aGlzLl9fc3ByZWFkQXJyYXlzfHxmdW5jdGlvbigpe2Zvcih2YXIgYT0wLGI9MCxjPWFyZ3VtZW50cy5sZW5ndGg7YjxjO2IrKylhKz1hcmd1bWVudHNbYl0ubGVuZ3RoO2Zvcih2YXIgYT1BcnJheShhKSxlPTAsYj0wO2I8YztiKyspZm9yKHZhciBrPWFyZ3VtZW50c1tiXSxoPTAsbD1rLmxlbmd0aDtoPGw7aCsrLGUrKylhW2VdPWtbaF07cmV0dXJuIGF9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO2EuV3NKc29uVXRpbD1hLndzX21zZ190eXBlX3Q9dm9pZCAwO3ZhciBsPWMoNTUwKSxoOyhmdW5jdGlvbihhKXthW2EucmVxPTBdPVwicmVxXCI7YVthLnJlcGx5PTFdPVwicmVwbHlcIjthW2EuZXZlbnRfcmVxPTJdPVwiZXZlbnRfcmVxXCI7YVthLmV2ZW50X3JlcGx5PTNdPVwiZXZlbnRfcmVwbHlcIn0pKGg9YS53c19tc2dfdHlwZV90fHwoYS53c19tc2dfdHlwZV90PXt9KSk7Yj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoKXt9XHJcbmEuY3JlYXRlTWVzc2FnZUJ5aWQ9ZnVuY3Rpb24oYSxiLGMsZCxoLHApe2Zvcih2YXIgZz1bXSxCPTY7Qjxhcmd1bWVudHMubGVuZ3RoO0IrKylnW0ItNl09YXJndW1lbnRzW0JdOyhCPWwuV2VicnBjQ2xhc3NMaWJJbmZvVXRpbC5nZXRNZXRob2RCeWlkKGQsaCkpJiZCLmlzcHJvcHx8KGE9ITEpO3JldHVybiB0aGlzLmNyZWF0ZU1lc3NhZ2UuYXBwbHkodGhpcyxlKFtjLGEsYixkLGgscF0sZykpfTthLmNyZWF0ZU1lc3NhZ2U9ZnVuY3Rpb24oYSxiLGMsZCxoLGwpe2Zvcih2YXIgZz1bXSxwPTY7cDxhcmd1bWVudHMubGVuZ3RoO3ArKylnW3AtNl09YXJndW1lbnRzW3BdO3JldHVybnt2Olwid2VicnRjXCIsaGRyOnt2ZXJzaW9uOnRoaXMuX3ZlcnNpb24sbXNnX3R5cGU6dGhpcy5nZXRNc2dUeXBlKGEpLG1vZGlmaWVyOmIsZGVzdHJveTpjLHByb2M6e2lpZDpkLG1ldGhvZGlkOmh9fSxvYmpyZWY6e29pZDpsfSxwYXJhbXM6ZShnKX19O2EuZ2V0TXNnVHlwZT1mdW5jdGlvbihhKXt2YXIgYj1cclxuXCJcIjtzd2l0Y2goYSl7ZGVmYXVsdDpiPVwicmVxXCI7YnJlYWs7Y2FzZSBoLnJlcGx5OmI9XCJyZXBseVwiO2JyZWFrO2Nhc2UgaC5ldmVudF9yZXE6Yj1cImV2ZW50LXJlcVwiO2JyZWFrO2Nhc2UgaC5ldmVudF9yZXBseTpiPVwiZXZlbnQtcmVwbHlcIn1yZXR1cm4gYn07YS5fdmVyc2lvbj0xO3JldHVybiBhfSgpO2EuV3NKc29uVXRpbD1ifX0scD17fTtyZXR1cm4gZSgzMDcpfSgpfSk7XHJcbiIsIm1vZHVsZS5leHBvcnRzID0geyBcImRlZmF1bHRcIjogcmVxdWlyZShcImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvY3JlYXRlXCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07IiwibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9kZWZpbmUtcHJvcGVydHlcIiksIF9fZXNNb2R1bGU6IHRydWUgfTsiLCJtb2R1bGUuZXhwb3J0cyA9IHsgXCJkZWZhdWx0XCI6IHJlcXVpcmUoXCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvclwiKSwgX19lc01vZHVsZTogdHJ1ZSB9OyIsIm1vZHVsZS5leHBvcnRzID0geyBcImRlZmF1bHRcIjogcmVxdWlyZShcImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZlwiKSwgX19lc01vZHVsZTogdHJ1ZSB9OyIsIm1vZHVsZS5leHBvcnRzID0geyBcImRlZmF1bHRcIjogcmVxdWlyZShcImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZlwiKSwgX19lc01vZHVsZTogdHJ1ZSB9OyIsIm1vZHVsZS5leHBvcnRzID0geyBcImRlZmF1bHRcIjogcmVxdWlyZShcImNvcmUtanMvbGlicmFyeS9mbi9wcm9taXNlXCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07IiwibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL3N5bWJvbFwiKSwgX19lc01vZHVsZTogdHJ1ZSB9OyIsIm1vZHVsZS5leHBvcnRzID0geyBcImRlZmF1bHRcIjogcmVxdWlyZShcImNvcmUtanMvbGlicmFyeS9mbi9zeW1ib2wvaXRlcmF0b3JcIiksIF9fZXNNb2R1bGU6IHRydWUgfTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxudmFyIF9wcm9taXNlID0gcmVxdWlyZShcIi4uL2NvcmUtanMvcHJvbWlzZVwiKTtcblxudmFyIF9wcm9taXNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Byb21pc2UpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5leHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoZm4pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZ2VuID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICByZXR1cm4gbmV3IF9wcm9taXNlMi5kZWZhdWx0KGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIGZ1bmN0aW9uIHN0ZXAoa2V5LCBhcmcpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7XG4gICAgICAgICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpbmZvLmRvbmUpIHtcbiAgICAgICAgICByZXNvbHZlKHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gX3Byb21pc2UyLmRlZmF1bHQucmVzb2x2ZSh2YWx1ZSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHN0ZXAoXCJuZXh0XCIsIHZhbHVlKTtcbiAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICBzdGVwKFwidGhyb3dcIiwgZXJyKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gc3RlcChcIm5leHRcIik7XG4gICAgfSk7XG4gIH07XG59OyIsIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7XG4gIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTtcbiAgfVxufTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxudmFyIF9kZWZpbmVQcm9wZXJ0eSA9IHJlcXVpcmUoXCIuLi9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHlcIik7XG5cbnZhciBfZGVmaW5lUHJvcGVydHkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGVmaW5lUHJvcGVydHkpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5leHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07XG4gICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7XG4gICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG4gICAgICBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlO1xuICAgICAgKDAsIF9kZWZpbmVQcm9wZXJ0eTIuZGVmYXVsdCkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHtcbiAgICBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpO1xuICAgIGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpO1xuICAgIHJldHVybiBDb25zdHJ1Y3RvcjtcbiAgfTtcbn0oKTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxudmFyIF9nZXRQcm90b3R5cGVPZiA9IHJlcXVpcmUoXCIuLi9jb3JlLWpzL29iamVjdC9nZXQtcHJvdG90eXBlLW9mXCIpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldFByb3RvdHlwZU9mKTtcblxudmFyIF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSByZXF1aXJlKFwiLi4vY29yZS1qcy9vYmplY3QvZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yXCIpO1xuXG52YXIgX2dldE93blByb3BlcnR5RGVzY3JpcHRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5leHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHtcbiAgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlO1xuICB2YXIgZGVzYyA9ICgwLCBfZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yMi5kZWZhdWx0KShvYmplY3QsIHByb3BlcnR5KTtcblxuICBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdmFyIHBhcmVudCA9ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKG9iamVjdCk7XG5cbiAgICBpZiAocGFyZW50ID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHtcbiAgICByZXR1cm4gZGVzYy52YWx1ZTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7XG5cbiAgICBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTtcbiAgfVxufTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxudmFyIF9zZXRQcm90b3R5cGVPZiA9IHJlcXVpcmUoXCIuLi9jb3JlLWpzL29iamVjdC9zZXQtcHJvdG90eXBlLW9mXCIpO1xuXG52YXIgX3NldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NldFByb3RvdHlwZU9mKTtcblxudmFyIF9jcmVhdGUgPSByZXF1aXJlKFwiLi4vY29yZS1qcy9vYmplY3QvY3JlYXRlXCIpO1xuXG52YXIgX2NyZWF0ZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jcmVhdGUpO1xuXG52YXIgX3R5cGVvZjIgPSByZXF1aXJlKFwiLi4vaGVscGVycy90eXBlb2ZcIik7XG5cbnZhciBfdHlwZW9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3R5cGVvZjIpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5leHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHtcbiAgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgKHR5cGVvZiBzdXBlckNsYXNzID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6ICgwLCBfdHlwZW9mMy5kZWZhdWx0KShzdXBlckNsYXNzKSkpO1xuICB9XG5cbiAgc3ViQ2xhc3MucHJvdG90eXBlID0gKDAsIF9jcmVhdGUyLmRlZmF1bHQpKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHtcbiAgICBjb25zdHJ1Y3Rvcjoge1xuICAgICAgdmFsdWU6IHN1YkNsYXNzLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH1cbiAgfSk7XG4gIGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2YyLmRlZmF1bHQgPyAoMCwgX3NldFByb3RvdHlwZU9mMi5kZWZhdWx0KShzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzO1xufTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxudmFyIF90eXBlb2YyID0gcmVxdWlyZShcIi4uL2hlbHBlcnMvdHlwZW9mXCIpO1xuXG52YXIgX3R5cGVvZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90eXBlb2YyKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZXhwb3J0cy5kZWZhdWx0ID0gZnVuY3Rpb24gKHNlbGYsIGNhbGwpIHtcbiAgaWYgKCFzZWxmKSB7XG4gICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpO1xuICB9XG5cbiAgcmV0dXJuIGNhbGwgJiYgKCh0eXBlb2YgY2FsbCA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiAoMCwgX3R5cGVvZjMuZGVmYXVsdCkoY2FsbCkpID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7XG59OyIsIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXG52YXIgX2l0ZXJhdG9yID0gcmVxdWlyZShcIi4uL2NvcmUtanMvc3ltYm9sL2l0ZXJhdG9yXCIpO1xuXG52YXIgX2l0ZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2l0ZXJhdG9yKTtcblxudmFyIF9zeW1ib2wgPSByZXF1aXJlKFwiLi4vY29yZS1qcy9zeW1ib2xcIik7XG5cbnZhciBfc3ltYm9sMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N5bWJvbCk7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIF9zeW1ib2wyLmRlZmF1bHQgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgX2l0ZXJhdG9yMi5kZWZhdWx0ID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgX3N5bWJvbDIuZGVmYXVsdCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gX3N5bWJvbDIuZGVmYXVsdCAmJiBvYmogIT09IF9zeW1ib2wyLmRlZmF1bHQucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmV4cG9ydHMuZGVmYXVsdCA9IHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSBcImZ1bmN0aW9uXCIgJiYgX3R5cGVvZihfaXRlcmF0b3IyLmRlZmF1bHQpID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikge1xuICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKG9iaik7XG59IDogZnVuY3Rpb24gKG9iaikge1xuICByZXR1cm4gb2JqICYmIHR5cGVvZiBfc3ltYm9sMi5kZWZhdWx0ID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBfc3ltYm9sMi5kZWZhdWx0ICYmIG9iaiAhPT0gX3N5bWJvbDIuZGVmYXVsdC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKG9iaik7XG59OyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInJlZ2VuZXJhdG9yLXJ1bnRpbWVcIik7XG4iLCJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuY3JlYXRlJyk7XG52YXIgJE9iamVjdCA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvX2NvcmUnKS5PYmplY3Q7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNyZWF0ZShQLCBEKSB7XG4gIHJldHVybiAkT2JqZWN0LmNyZWF0ZShQLCBEKTtcbn07XG4iLCJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuZGVmaW5lLXByb3BlcnR5Jyk7XG52YXIgJE9iamVjdCA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvX2NvcmUnKS5PYmplY3Q7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KGl0LCBrZXksIGRlc2MpIHtcbiAgcmV0dXJuICRPYmplY3QuZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYyk7XG59O1xuIiwicmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcicpO1xudmFyICRPYmplY3QgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzL19jb3JlJykuT2JqZWN0O1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSkge1xuICByZXR1cm4gJE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSk7XG59O1xuIiwicmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1wcm90b3R5cGUtb2YnKTtcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9fY29yZScpLk9iamVjdC5nZXRQcm90b3R5cGVPZjtcbiIsInJlcXVpcmUoJy4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5zZXQtcHJvdG90eXBlLW9mJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvX2NvcmUnKS5PYmplY3Quc2V0UHJvdG90eXBlT2Y7XG4iLCJyZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3InKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZScpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYucHJvbWlzZScpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczcucHJvbWlzZS5maW5hbGx5Jyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNy5wcm9taXNlLnRyeScpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi9tb2R1bGVzL19jb3JlJykuUHJvbWlzZTtcbiIsInJlcXVpcmUoJy4uLy4uL21vZHVsZXMvZXM2LnN5bWJvbCcpO1xucmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZycpO1xucmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczcuc3ltYm9sLmFzeW5jLWl0ZXJhdG9yJyk7XG5yZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNy5zeW1ib2wub2JzZXJ2YWJsZScpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzL19jb3JlJykuU3ltYm9sO1xuIiwicmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczYuc3RyaW5nLml0ZXJhdG9yJyk7XG5yZXF1aXJlKCcuLi8uLi9tb2R1bGVzL3dlYi5kb20uaXRlcmFibGUnKTtcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9fd2tzLWV4dCcpLmYoJ2l0ZXJhdG9yJyk7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAodHlwZW9mIGl0ICE9ICdmdW5jdGlvbicpIHRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGEgZnVuY3Rpb24hJyk7XG4gIHJldHVybiBpdDtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsgLyogZW1wdHkgKi8gfTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0LCBDb25zdHJ1Y3RvciwgbmFtZSwgZm9yYmlkZGVuRmllbGQpIHtcbiAgaWYgKCEoaXQgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikgfHwgKGZvcmJpZGRlbkZpZWxkICE9PSB1bmRlZmluZWQgJiYgZm9yYmlkZGVuRmllbGQgaW4gaXQpKSB7XG4gICAgdGhyb3cgVHlwZUVycm9yKG5hbWUgKyAnOiBpbmNvcnJlY3QgaW52b2NhdGlvbiEnKTtcbiAgfSByZXR1cm4gaXQ7XG59O1xuIiwidmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAoIWlzT2JqZWN0KGl0KSkgdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYW4gb2JqZWN0IScpO1xuICByZXR1cm4gaXQ7XG59O1xuIiwiLy8gZmFsc2UgLT4gQXJyYXkjaW5kZXhPZlxuLy8gdHJ1ZSAgLT4gQXJyYXkjaW5jbHVkZXNcbnZhciB0b0lPYmplY3QgPSByZXF1aXJlKCcuL190by1pb2JqZWN0Jyk7XG52YXIgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKTtcbnZhciB0b0Fic29sdXRlSW5kZXggPSByZXF1aXJlKCcuL190by1hYnNvbHV0ZS1pbmRleCcpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoSVNfSU5DTFVERVMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgkdGhpcywgZWwsIGZyb21JbmRleCkge1xuICAgIHZhciBPID0gdG9JT2JqZWN0KCR0aGlzKTtcbiAgICB2YXIgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpO1xuICAgIHZhciBpbmRleCA9IHRvQWJzb2x1dGVJbmRleChmcm9tSW5kZXgsIGxlbmd0aCk7XG4gICAgdmFyIHZhbHVlO1xuICAgIC8vIEFycmF5I2luY2x1ZGVzIHVzZXMgU2FtZVZhbHVlWmVybyBlcXVhbGl0eSBhbGdvcml0aG1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2VsZi1jb21wYXJlXG4gICAgaWYgKElTX0lOQ0xVREVTICYmIGVsICE9IGVsKSB3aGlsZSAobGVuZ3RoID4gaW5kZXgpIHtcbiAgICAgIHZhbHVlID0gT1tpbmRleCsrXTtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1zZWxmLWNvbXBhcmVcbiAgICAgIGlmICh2YWx1ZSAhPSB2YWx1ZSkgcmV0dXJuIHRydWU7XG4gICAgLy8gQXJyYXkjaW5kZXhPZiBpZ25vcmVzIGhvbGVzLCBBcnJheSNpbmNsdWRlcyAtIG5vdFxuICAgIH0gZWxzZSBmb3IgKDtsZW5ndGggPiBpbmRleDsgaW5kZXgrKykgaWYgKElTX0lOQ0xVREVTIHx8IGluZGV4IGluIE8pIHtcbiAgICAgIGlmIChPW2luZGV4XSA9PT0gZWwpIHJldHVybiBJU19JTkNMVURFUyB8fCBpbmRleCB8fCAwO1xuICAgIH0gcmV0dXJuICFJU19JTkNMVURFUyAmJiAtMTtcbiAgfTtcbn07XG4iLCIvLyBnZXR0aW5nIHRhZyBmcm9tIDE5LjEuMy42IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcoKVxudmFyIGNvZiA9IHJlcXVpcmUoJy4vX2NvZicpO1xudmFyIFRBRyA9IHJlcXVpcmUoJy4vX3drcycpKCd0b1N0cmluZ1RhZycpO1xuLy8gRVMzIHdyb25nIGhlcmVcbnZhciBBUkcgPSBjb2YoZnVuY3Rpb24gKCkgeyByZXR1cm4gYXJndW1lbnRzOyB9KCkpID09ICdBcmd1bWVudHMnO1xuXG4vLyBmYWxsYmFjayBmb3IgSUUxMSBTY3JpcHQgQWNjZXNzIERlbmllZCBlcnJvclxudmFyIHRyeUdldCA9IGZ1bmN0aW9uIChpdCwga2V5KSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGl0W2tleV07XG4gIH0gY2F0Y2ggKGUpIHsgLyogZW1wdHkgKi8gfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgdmFyIE8sIFQsIEI7XG4gIHJldHVybiBpdCA9PT0gdW5kZWZpbmVkID8gJ1VuZGVmaW5lZCcgOiBpdCA9PT0gbnVsbCA/ICdOdWxsJ1xuICAgIC8vIEBAdG9TdHJpbmdUYWcgY2FzZVxuICAgIDogdHlwZW9mIChUID0gdHJ5R2V0KE8gPSBPYmplY3QoaXQpLCBUQUcpKSA9PSAnc3RyaW5nJyA/IFRcbiAgICAvLyBidWlsdGluVGFnIGNhc2VcbiAgICA6IEFSRyA/IGNvZihPKVxuICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2tcbiAgICA6IChCID0gY29mKE8pKSA9PSAnT2JqZWN0JyAmJiB0eXBlb2YgTy5jYWxsZWUgPT0gJ2Z1bmN0aW9uJyA/ICdBcmd1bWVudHMnIDogQjtcbn07XG4iLCJ2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwoaXQpLnNsaWNlKDgsIC0xKTtcbn07XG4iLCJ2YXIgY29yZSA9IG1vZHVsZS5leHBvcnRzID0geyB2ZXJzaW9uOiAnMi42LjEyJyB9O1xuaWYgKHR5cGVvZiBfX2UgPT0gJ251bWJlcicpIF9fZSA9IGNvcmU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcbiIsIi8vIG9wdGlvbmFsIC8gc2ltcGxlIGNvbnRleHQgYmluZGluZ1xudmFyIGFGdW5jdGlvbiA9IHJlcXVpcmUoJy4vX2EtZnVuY3Rpb24nKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGZuLCB0aGF0LCBsZW5ndGgpIHtcbiAgYUZ1bmN0aW9uKGZuKTtcbiAgaWYgKHRoYXQgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGZuO1xuICBzd2l0Y2ggKGxlbmd0aCkge1xuICAgIGNhc2UgMTogcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhKTtcbiAgICB9O1xuICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiKTtcbiAgICB9O1xuICAgIGNhc2UgMzogcmV0dXJuIGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiLCBjKTtcbiAgICB9O1xuICB9XG4gIHJldHVybiBmdW5jdGlvbiAoLyogLi4uYXJncyAqLykge1xuICAgIHJldHVybiBmbi5hcHBseSh0aGF0LCBhcmd1bWVudHMpO1xuICB9O1xufTtcbiIsIi8vIDcuMi4xIFJlcXVpcmVPYmplY3RDb2VyY2libGUoYXJndW1lbnQpXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAoaXQgPT0gdW5kZWZpbmVkKSB0aHJvdyBUeXBlRXJyb3IoXCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgXCIgKyBpdCk7XG4gIHJldHVybiBpdDtcbn07XG4iLCIvLyBUaGFuaydzIElFOCBmb3IgaGlzIGZ1bm55IGRlZmluZVByb3BlcnR5XG5tb2R1bGUuZXhwb3J0cyA9ICFyZXF1aXJlKCcuL19mYWlscycpKGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ2EnLCB7IGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gNzsgfSB9KS5hICE9IDc7XG59KTtcbiIsInZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xudmFyIGRvY3VtZW50ID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykuZG9jdW1lbnQ7XG4vLyB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCBpcyAnb2JqZWN0JyBpbiBvbGQgSUVcbnZhciBpcyA9IGlzT2JqZWN0KGRvY3VtZW50KSAmJiBpc09iamVjdChkb2N1bWVudC5jcmVhdGVFbGVtZW50KTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBpcyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307XG59O1xuIiwiLy8gSUUgOC0gZG9uJ3QgZW51bSBidWcga2V5c1xubW9kdWxlLmV4cG9ydHMgPSAoXG4gICdjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2YnXG4pLnNwbGl0KCcsJyk7XG4iLCIvLyBhbGwgZW51bWVyYWJsZSBvYmplY3Qga2V5cywgaW5jbHVkZXMgc3ltYm9sc1xudmFyIGdldEtleXMgPSByZXF1aXJlKCcuL19vYmplY3Qta2V5cycpO1xudmFyIGdPUFMgPSByZXF1aXJlKCcuL19vYmplY3QtZ29wcycpO1xudmFyIHBJRSA9IHJlcXVpcmUoJy4vX29iamVjdC1waWUnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIHZhciByZXN1bHQgPSBnZXRLZXlzKGl0KTtcbiAgdmFyIGdldFN5bWJvbHMgPSBnT1BTLmY7XG4gIGlmIChnZXRTeW1ib2xzKSB7XG4gICAgdmFyIHN5bWJvbHMgPSBnZXRTeW1ib2xzKGl0KTtcbiAgICB2YXIgaXNFbnVtID0gcElFLmY7XG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciBrZXk7XG4gICAgd2hpbGUgKHN5bWJvbHMubGVuZ3RoID4gaSkgaWYgKGlzRW51bS5jYWxsKGl0LCBrZXkgPSBzeW1ib2xzW2krK10pKSByZXN1bHQucHVzaChrZXkpO1xuICB9IHJldHVybiByZXN1bHQ7XG59O1xuIiwidmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIGNvcmUgPSByZXF1aXJlKCcuL19jb3JlJyk7XG52YXIgY3R4ID0gcmVxdWlyZSgnLi9fY3R4Jyk7XG52YXIgaGlkZSA9IHJlcXVpcmUoJy4vX2hpZGUnKTtcbnZhciBoYXMgPSByZXF1aXJlKCcuL19oYXMnKTtcbnZhciBQUk9UT1RZUEUgPSAncHJvdG90eXBlJztcblxudmFyICRleHBvcnQgPSBmdW5jdGlvbiAodHlwZSwgbmFtZSwgc291cmNlKSB7XG4gIHZhciBJU19GT1JDRUQgPSB0eXBlICYgJGV4cG9ydC5GO1xuICB2YXIgSVNfR0xPQkFMID0gdHlwZSAmICRleHBvcnQuRztcbiAgdmFyIElTX1NUQVRJQyA9IHR5cGUgJiAkZXhwb3J0LlM7XG4gIHZhciBJU19QUk9UTyA9IHR5cGUgJiAkZXhwb3J0LlA7XG4gIHZhciBJU19CSU5EID0gdHlwZSAmICRleHBvcnQuQjtcbiAgdmFyIElTX1dSQVAgPSB0eXBlICYgJGV4cG9ydC5XO1xuICB2YXIgZXhwb3J0cyA9IElTX0dMT0JBTCA/IGNvcmUgOiBjb3JlW25hbWVdIHx8IChjb3JlW25hbWVdID0ge30pO1xuICB2YXIgZXhwUHJvdG8gPSBleHBvcnRzW1BST1RPVFlQRV07XG4gIHZhciB0YXJnZXQgPSBJU19HTE9CQUwgPyBnbG9iYWwgOiBJU19TVEFUSUMgPyBnbG9iYWxbbmFtZV0gOiAoZ2xvYmFsW25hbWVdIHx8IHt9KVtQUk9UT1RZUEVdO1xuICB2YXIga2V5LCBvd24sIG91dDtcbiAgaWYgKElTX0dMT0JBTCkgc291cmNlID0gbmFtZTtcbiAgZm9yIChrZXkgaW4gc291cmNlKSB7XG4gICAgLy8gY29udGFpbnMgaW4gbmF0aXZlXG4gICAgb3duID0gIUlTX0ZPUkNFRCAmJiB0YXJnZXQgJiYgdGFyZ2V0W2tleV0gIT09IHVuZGVmaW5lZDtcbiAgICBpZiAob3duICYmIGhhcyhleHBvcnRzLCBrZXkpKSBjb250aW51ZTtcbiAgICAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZFxuICAgIG91dCA9IG93biA/IHRhcmdldFtrZXldIDogc291cmNlW2tleV07XG4gICAgLy8gcHJldmVudCBnbG9iYWwgcG9sbHV0aW9uIGZvciBuYW1lc3BhY2VzXG4gICAgZXhwb3J0c1trZXldID0gSVNfR0xPQkFMICYmIHR5cGVvZiB0YXJnZXRba2V5XSAhPSAnZnVuY3Rpb24nID8gc291cmNlW2tleV1cbiAgICAvLyBiaW5kIHRpbWVycyB0byBnbG9iYWwgZm9yIGNhbGwgZnJvbSBleHBvcnQgY29udGV4dFxuICAgIDogSVNfQklORCAmJiBvd24gPyBjdHgob3V0LCBnbG9iYWwpXG4gICAgLy8gd3JhcCBnbG9iYWwgY29uc3RydWN0b3JzIGZvciBwcmV2ZW50IGNoYW5nZSB0aGVtIGluIGxpYnJhcnlcbiAgICA6IElTX1dSQVAgJiYgdGFyZ2V0W2tleV0gPT0gb3V0ID8gKGZ1bmN0aW9uIChDKSB7XG4gICAgICB2YXIgRiA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgICAgIGlmICh0aGlzIGluc3RhbmNlb2YgQykge1xuICAgICAgICAgIHN3aXRjaCAoYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gbmV3IEMoKTtcbiAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIG5ldyBDKGEpO1xuICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gbmV3IEMoYSwgYik7XG4gICAgICAgICAgfSByZXR1cm4gbmV3IEMoYSwgYiwgYyk7XG4gICAgICAgIH0gcmV0dXJuIEMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgICBGW1BST1RPVFlQRV0gPSBDW1BST1RPVFlQRV07XG4gICAgICByZXR1cm4gRjtcbiAgICAvLyBtYWtlIHN0YXRpYyB2ZXJzaW9ucyBmb3IgcHJvdG90eXBlIG1ldGhvZHNcbiAgICB9KShvdXQpIDogSVNfUFJPVE8gJiYgdHlwZW9mIG91dCA9PSAnZnVuY3Rpb24nID8gY3R4KEZ1bmN0aW9uLmNhbGwsIG91dCkgOiBvdXQ7XG4gICAgLy8gZXhwb3J0IHByb3RvIG1ldGhvZHMgdG8gY29yZS4lQ09OU1RSVUNUT1IlLm1ldGhvZHMuJU5BTUUlXG4gICAgaWYgKElTX1BST1RPKSB7XG4gICAgICAoZXhwb3J0cy52aXJ0dWFsIHx8IChleHBvcnRzLnZpcnR1YWwgPSB7fSkpW2tleV0gPSBvdXQ7XG4gICAgICAvLyBleHBvcnQgcHJvdG8gbWV0aG9kcyB0byBjb3JlLiVDT05TVFJVQ1RPUiUucHJvdG90eXBlLiVOQU1FJVxuICAgICAgaWYgKHR5cGUgJiAkZXhwb3J0LlIgJiYgZXhwUHJvdG8gJiYgIWV4cFByb3RvW2tleV0pIGhpZGUoZXhwUHJvdG8sIGtleSwgb3V0KTtcbiAgICB9XG4gIH1cbn07XG4vLyB0eXBlIGJpdG1hcFxuJGV4cG9ydC5GID0gMTsgICAvLyBmb3JjZWRcbiRleHBvcnQuRyA9IDI7ICAgLy8gZ2xvYmFsXG4kZXhwb3J0LlMgPSA0OyAgIC8vIHN0YXRpY1xuJGV4cG9ydC5QID0gODsgICAvLyBwcm90b1xuJGV4cG9ydC5CID0gMTY7ICAvLyBiaW5kXG4kZXhwb3J0LlcgPSAzMjsgIC8vIHdyYXBcbiRleHBvcnQuVSA9IDY0OyAgLy8gc2FmZVxuJGV4cG9ydC5SID0gMTI4OyAvLyByZWFsIHByb3RvIG1ldGhvZCBmb3IgYGxpYnJhcnlgXG5tb2R1bGUuZXhwb3J0cyA9ICRleHBvcnQ7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChleGVjKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuICEhZXhlYygpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn07XG4iLCJ2YXIgY3R4ID0gcmVxdWlyZSgnLi9fY3R4Jyk7XG52YXIgY2FsbCA9IHJlcXVpcmUoJy4vX2l0ZXItY2FsbCcpO1xudmFyIGlzQXJyYXlJdGVyID0gcmVxdWlyZSgnLi9faXMtYXJyYXktaXRlcicpO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKTtcbnZhciBnZXRJdGVyRm4gPSByZXF1aXJlKCcuL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZCcpO1xudmFyIEJSRUFLID0ge307XG52YXIgUkVUVVJOID0ge307XG52YXIgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0ZXJhYmxlLCBlbnRyaWVzLCBmbiwgdGhhdCwgSVRFUkFUT1IpIHtcbiAgdmFyIGl0ZXJGbiA9IElURVJBVE9SID8gZnVuY3Rpb24gKCkgeyByZXR1cm4gaXRlcmFibGU7IH0gOiBnZXRJdGVyRm4oaXRlcmFibGUpO1xuICB2YXIgZiA9IGN0eChmbiwgdGhhdCwgZW50cmllcyA/IDIgOiAxKTtcbiAgdmFyIGluZGV4ID0gMDtcbiAgdmFyIGxlbmd0aCwgc3RlcCwgaXRlcmF0b3IsIHJlc3VsdDtcbiAgaWYgKHR5cGVvZiBpdGVyRm4gIT0gJ2Z1bmN0aW9uJykgdGhyb3cgVHlwZUVycm9yKGl0ZXJhYmxlICsgJyBpcyBub3QgaXRlcmFibGUhJyk7XG4gIC8vIGZhc3QgY2FzZSBmb3IgYXJyYXlzIHdpdGggZGVmYXVsdCBpdGVyYXRvclxuICBpZiAoaXNBcnJheUl0ZXIoaXRlckZuKSkgZm9yIChsZW5ndGggPSB0b0xlbmd0aChpdGVyYWJsZS5sZW5ndGgpOyBsZW5ndGggPiBpbmRleDsgaW5kZXgrKykge1xuICAgIHJlc3VsdCA9IGVudHJpZXMgPyBmKGFuT2JqZWN0KHN0ZXAgPSBpdGVyYWJsZVtpbmRleF0pWzBdLCBzdGVwWzFdKSA6IGYoaXRlcmFibGVbaW5kZXhdKTtcbiAgICBpZiAocmVzdWx0ID09PSBCUkVBSyB8fCByZXN1bHQgPT09IFJFVFVSTikgcmV0dXJuIHJlc3VsdDtcbiAgfSBlbHNlIGZvciAoaXRlcmF0b3IgPSBpdGVyRm4uY2FsbChpdGVyYWJsZSk7ICEoc3RlcCA9IGl0ZXJhdG9yLm5leHQoKSkuZG9uZTspIHtcbiAgICByZXN1bHQgPSBjYWxsKGl0ZXJhdG9yLCBmLCBzdGVwLnZhbHVlLCBlbnRyaWVzKTtcbiAgICBpZiAocmVzdWx0ID09PSBCUkVBSyB8fCByZXN1bHQgPT09IFJFVFVSTikgcmV0dXJuIHJlc3VsdDtcbiAgfVxufTtcbmV4cG9ydHMuQlJFQUsgPSBCUkVBSztcbmV4cG9ydHMuUkVUVVJOID0gUkVUVVJOO1xuIiwiLy8gaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvaXNzdWVzLzg2I2lzc3VlY29tbWVudC0xMTU3NTkwMjhcbnZhciBnbG9iYWwgPSBtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk1hdGggPT0gTWF0aFxuICA/IHdpbmRvdyA6IHR5cGVvZiBzZWxmICE9ICd1bmRlZmluZWQnICYmIHNlbGYuTWF0aCA9PSBNYXRoID8gc2VsZlxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tbmV3LWZ1bmNcbiAgOiBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuaWYgKHR5cGVvZiBfX2cgPT0gJ251bWJlcicpIF9fZyA9IGdsb2JhbDsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZlxuIiwidmFyIGhhc093blByb3BlcnR5ID0ge30uaGFzT3duUHJvcGVydHk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCwga2V5KSB7XG4gIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGl0LCBrZXkpO1xufTtcbiIsInZhciBkUCA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpO1xudmFyIGNyZWF0ZURlc2MgPSByZXF1aXJlKCcuL19wcm9wZXJ0eS1kZXNjJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykgPyBmdW5jdGlvbiAob2JqZWN0LCBrZXksIHZhbHVlKSB7XG4gIHJldHVybiBkUC5mKG9iamVjdCwga2V5LCBjcmVhdGVEZXNjKDEsIHZhbHVlKSk7XG59IDogZnVuY3Rpb24gKG9iamVjdCwga2V5LCB2YWx1ZSkge1xuICBvYmplY3Rba2V5XSA9IHZhbHVlO1xuICByZXR1cm4gb2JqZWN0O1xufTtcbiIsInZhciBkb2N1bWVudCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpLmRvY3VtZW50O1xubW9kdWxlLmV4cG9ydHMgPSBkb2N1bWVudCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4iLCJtb2R1bGUuZXhwb3J0cyA9ICFyZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpICYmICFyZXF1aXJlKCcuL19mYWlscycpKGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZXF1aXJlKCcuL19kb20tY3JlYXRlJykoJ2RpdicpLCAnYScsIHsgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiA3OyB9IH0pLmEgIT0gNztcbn0pO1xuIiwiLy8gZmFzdCBhcHBseSwgaHR0cDovL2pzcGVyZi5sbmtpdC5jb20vZmFzdC1hcHBseS81XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChmbiwgYXJncywgdGhhdCkge1xuICB2YXIgdW4gPSB0aGF0ID09PSB1bmRlZmluZWQ7XG4gIHN3aXRjaCAoYXJncy5sZW5ndGgpIHtcbiAgICBjYXNlIDA6IHJldHVybiB1biA/IGZuKClcbiAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCk7XG4gICAgY2FzZSAxOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdKVxuICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdKTtcbiAgICBjYXNlIDI6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0sIGFyZ3NbMV0pXG4gICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0pO1xuICAgIGNhc2UgMzogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSlcbiAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCwgYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSk7XG4gICAgY2FzZSA0OiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKVxuICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdKTtcbiAgfSByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJncyk7XG59O1xuIiwiLy8gZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBhbmQgbm9uLWVudW1lcmFibGUgb2xkIFY4IHN0cmluZ3NcbnZhciBjb2YgPSByZXF1aXJlKCcuL19jb2YnKTtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wcm90b3R5cGUtYnVpbHRpbnNcbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0KCd6JykucHJvcGVydHlJc0VudW1lcmFibGUoMCkgPyBPYmplY3QgOiBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGNvZihpdCkgPT0gJ1N0cmluZycgPyBpdC5zcGxpdCgnJykgOiBPYmplY3QoaXQpO1xufTtcbiIsIi8vIGNoZWNrIG9uIGRlZmF1bHQgQXJyYXkgaXRlcmF0b3JcbnZhciBJdGVyYXRvcnMgPSByZXF1aXJlKCcuL19pdGVyYXRvcnMnKTtcbnZhciBJVEVSQVRPUiA9IHJlcXVpcmUoJy4vX3drcycpKCdpdGVyYXRvcicpO1xudmFyIEFycmF5UHJvdG8gPSBBcnJheS5wcm90b3R5cGU7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBpdCAhPT0gdW5kZWZpbmVkICYmIChJdGVyYXRvcnMuQXJyYXkgPT09IGl0IHx8IEFycmF5UHJvdG9bSVRFUkFUT1JdID09PSBpdCk7XG59O1xuIiwiLy8gNy4yLjIgSXNBcnJheShhcmd1bWVudClcbnZhciBjb2YgPSByZXF1aXJlKCcuL19jb2YnKTtcbm1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiBpc0FycmF5KGFyZykge1xuICByZXR1cm4gY29mKGFyZykgPT0gJ0FycmF5Jztcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gdHlwZW9mIGl0ID09PSAnb2JqZWN0JyA/IGl0ICE9PSBudWxsIDogdHlwZW9mIGl0ID09PSAnZnVuY3Rpb24nO1xufTtcbiIsIi8vIGNhbGwgc29tZXRoaW5nIG9uIGl0ZXJhdG9yIHN0ZXAgd2l0aCBzYWZlIGNsb3Npbmcgb24gZXJyb3JcbnZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXRlcmF0b3IsIGZuLCB2YWx1ZSwgZW50cmllcykge1xuICB0cnkge1xuICAgIHJldHVybiBlbnRyaWVzID8gZm4oYW5PYmplY3QodmFsdWUpWzBdLCB2YWx1ZVsxXSkgOiBmbih2YWx1ZSk7XG4gIC8vIDcuNC42IEl0ZXJhdG9yQ2xvc2UoaXRlcmF0b3IsIGNvbXBsZXRpb24pXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB2YXIgcmV0ID0gaXRlcmF0b3JbJ3JldHVybiddO1xuICAgIGlmIChyZXQgIT09IHVuZGVmaW5lZCkgYW5PYmplY3QocmV0LmNhbGwoaXRlcmF0b3IpKTtcbiAgICB0aHJvdyBlO1xuICB9XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNyZWF0ZSA9IHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKTtcbnZhciBkZXNjcmlwdG9yID0gcmVxdWlyZSgnLi9fcHJvcGVydHktZGVzYycpO1xudmFyIHNldFRvU3RyaW5nVGFnID0gcmVxdWlyZSgnLi9fc2V0LXRvLXN0cmluZy10YWcnKTtcbnZhciBJdGVyYXRvclByb3RvdHlwZSA9IHt9O1xuXG4vLyAyNS4xLjIuMS4xICVJdGVyYXRvclByb3RvdHlwZSVbQEBpdGVyYXRvcl0oKVxucmVxdWlyZSgnLi9faGlkZScpKEl0ZXJhdG9yUHJvdG90eXBlLCByZXF1aXJlKCcuL193a3MnKSgnaXRlcmF0b3InKSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBOQU1FLCBuZXh0KSB7XG4gIENvbnN0cnVjdG9yLnByb3RvdHlwZSA9IGNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSwgeyBuZXh0OiBkZXNjcmlwdG9yKDEsIG5leHQpIH0pO1xuICBzZXRUb1N0cmluZ1RhZyhDb25zdHJ1Y3RvciwgTkFNRSArICcgSXRlcmF0b3InKTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG52YXIgTElCUkFSWSA9IHJlcXVpcmUoJy4vX2xpYnJhcnknKTtcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgcmVkZWZpbmUgPSByZXF1aXJlKCcuL19yZWRlZmluZScpO1xudmFyIGhpZGUgPSByZXF1aXJlKCcuL19oaWRlJyk7XG52YXIgSXRlcmF0b3JzID0gcmVxdWlyZSgnLi9faXRlcmF0b3JzJyk7XG52YXIgJGl0ZXJDcmVhdGUgPSByZXF1aXJlKCcuL19pdGVyLWNyZWF0ZScpO1xudmFyIHNldFRvU3RyaW5nVGFnID0gcmVxdWlyZSgnLi9fc2V0LXRvLXN0cmluZy10YWcnKTtcbnZhciBnZXRQcm90b3R5cGVPZiA9IHJlcXVpcmUoJy4vX29iamVjdC1ncG8nKTtcbnZhciBJVEVSQVRPUiA9IHJlcXVpcmUoJy4vX3drcycpKCdpdGVyYXRvcicpO1xudmFyIEJVR0dZID0gIShbXS5rZXlzICYmICduZXh0JyBpbiBbXS5rZXlzKCkpOyAvLyBTYWZhcmkgaGFzIGJ1Z2d5IGl0ZXJhdG9ycyB3L28gYG5leHRgXG52YXIgRkZfSVRFUkFUT1IgPSAnQEBpdGVyYXRvcic7XG52YXIgS0VZUyA9ICdrZXlzJztcbnZhciBWQUxVRVMgPSAndmFsdWVzJztcblxudmFyIHJldHVyblRoaXMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChCYXNlLCBOQU1FLCBDb25zdHJ1Y3RvciwgbmV4dCwgREVGQVVMVCwgSVNfU0VULCBGT1JDRUQpIHtcbiAgJGl0ZXJDcmVhdGUoQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpO1xuICB2YXIgZ2V0TWV0aG9kID0gZnVuY3Rpb24gKGtpbmQpIHtcbiAgICBpZiAoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pIHJldHVybiBwcm90b1traW5kXTtcbiAgICBzd2l0Y2ggKGtpbmQpIHtcbiAgICAgIGNhc2UgS0VZUzogcmV0dXJuIGZ1bmN0aW9uIGtleXMoKSB7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07XG4gICAgICBjYXNlIFZBTFVFUzogcmV0dXJuIGZ1bmN0aW9uIHZhbHVlcygpIHsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTtcbiAgICB9IHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCkgeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9O1xuICB9O1xuICB2YXIgVEFHID0gTkFNRSArICcgSXRlcmF0b3InO1xuICB2YXIgREVGX1ZBTFVFUyA9IERFRkFVTFQgPT0gVkFMVUVTO1xuICB2YXIgVkFMVUVTX0JVRyA9IGZhbHNlO1xuICB2YXIgcHJvdG8gPSBCYXNlLnByb3RvdHlwZTtcbiAgdmFyICRuYXRpdmUgPSBwcm90b1tJVEVSQVRPUl0gfHwgcHJvdG9bRkZfSVRFUkFUT1JdIHx8IERFRkFVTFQgJiYgcHJvdG9bREVGQVVMVF07XG4gIHZhciAkZGVmYXVsdCA9ICRuYXRpdmUgfHwgZ2V0TWV0aG9kKERFRkFVTFQpO1xuICB2YXIgJGVudHJpZXMgPSBERUZBVUxUID8gIURFRl9WQUxVRVMgPyAkZGVmYXVsdCA6IGdldE1ldGhvZCgnZW50cmllcycpIDogdW5kZWZpbmVkO1xuICB2YXIgJGFueU5hdGl2ZSA9IE5BTUUgPT0gJ0FycmF5JyA/IHByb3RvLmVudHJpZXMgfHwgJG5hdGl2ZSA6ICRuYXRpdmU7XG4gIHZhciBtZXRob2RzLCBrZXksIEl0ZXJhdG9yUHJvdG90eXBlO1xuICAvLyBGaXggbmF0aXZlXG4gIGlmICgkYW55TmF0aXZlKSB7XG4gICAgSXRlcmF0b3JQcm90b3R5cGUgPSBnZXRQcm90b3R5cGVPZigkYW55TmF0aXZlLmNhbGwobmV3IEJhc2UoKSkpO1xuICAgIGlmIChJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSAmJiBJdGVyYXRvclByb3RvdHlwZS5uZXh0KSB7XG4gICAgICAvLyBTZXQgQEB0b1N0cmluZ1RhZyB0byBuYXRpdmUgaXRlcmF0b3JzXG4gICAgICBzZXRUb1N0cmluZ1RhZyhJdGVyYXRvclByb3RvdHlwZSwgVEFHLCB0cnVlKTtcbiAgICAgIC8vIGZpeCBmb3Igc29tZSBvbGQgZW5naW5lc1xuICAgICAgaWYgKCFMSUJSQVJZICYmIHR5cGVvZiBJdGVyYXRvclByb3RvdHlwZVtJVEVSQVRPUl0gIT0gJ2Z1bmN0aW9uJykgaGlkZShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpO1xuICAgIH1cbiAgfVxuICAvLyBmaXggQXJyYXkje3ZhbHVlcywgQEBpdGVyYXRvcn0ubmFtZSBpbiBWOCAvIEZGXG4gIGlmIChERUZfVkFMVUVTICYmICRuYXRpdmUgJiYgJG5hdGl2ZS5uYW1lICE9PSBWQUxVRVMpIHtcbiAgICBWQUxVRVNfQlVHID0gdHJ1ZTtcbiAgICAkZGVmYXVsdCA9IGZ1bmN0aW9uIHZhbHVlcygpIHsgcmV0dXJuICRuYXRpdmUuY2FsbCh0aGlzKTsgfTtcbiAgfVxuICAvLyBEZWZpbmUgaXRlcmF0b3JcbiAgaWYgKCghTElCUkFSWSB8fCBGT1JDRUQpICYmIChCVUdHWSB8fCBWQUxVRVNfQlVHIHx8ICFwcm90b1tJVEVSQVRPUl0pKSB7XG4gICAgaGlkZShwcm90bywgSVRFUkFUT1IsICRkZWZhdWx0KTtcbiAgfVxuICAvLyBQbHVnIGZvciBsaWJyYXJ5XG4gIEl0ZXJhdG9yc1tOQU1FXSA9ICRkZWZhdWx0O1xuICBJdGVyYXRvcnNbVEFHXSA9IHJldHVyblRoaXM7XG4gIGlmIChERUZBVUxUKSB7XG4gICAgbWV0aG9kcyA9IHtcbiAgICAgIHZhbHVlczogREVGX1ZBTFVFUyA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKFZBTFVFUyksXG4gICAgICBrZXlzOiBJU19TRVQgPyAkZGVmYXVsdCA6IGdldE1ldGhvZChLRVlTKSxcbiAgICAgIGVudHJpZXM6ICRlbnRyaWVzXG4gICAgfTtcbiAgICBpZiAoRk9SQ0VEKSBmb3IgKGtleSBpbiBtZXRob2RzKSB7XG4gICAgICBpZiAoIShrZXkgaW4gcHJvdG8pKSByZWRlZmluZShwcm90bywga2V5LCBtZXRob2RzW2tleV0pO1xuICAgIH0gZWxzZSAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChCVUdHWSB8fCBWQUxVRVNfQlVHKSwgTkFNRSwgbWV0aG9kcyk7XG4gIH1cbiAgcmV0dXJuIG1ldGhvZHM7XG59O1xuIiwidmFyIElURVJBVE9SID0gcmVxdWlyZSgnLi9fd2tzJykoJ2l0ZXJhdG9yJyk7XG52YXIgU0FGRV9DTE9TSU5HID0gZmFsc2U7XG5cbnRyeSB7XG4gIHZhciByaXRlciA9IFs3XVtJVEVSQVRPUl0oKTtcbiAgcml0ZXJbJ3JldHVybiddID0gZnVuY3Rpb24gKCkgeyBTQUZFX0NMT1NJTkcgPSB0cnVlOyB9O1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdGhyb3ctbGl0ZXJhbFxuICBBcnJheS5mcm9tKHJpdGVyLCBmdW5jdGlvbiAoKSB7IHRocm93IDI7IH0pO1xufSBjYXRjaCAoZSkgeyAvKiBlbXB0eSAqLyB9XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGV4ZWMsIHNraXBDbG9zaW5nKSB7XG4gIGlmICghc2tpcENsb3NpbmcgJiYgIVNBRkVfQ0xPU0lORykgcmV0dXJuIGZhbHNlO1xuICB2YXIgc2FmZSA9IGZhbHNlO1xuICB0cnkge1xuICAgIHZhciBhcnIgPSBbN107XG4gICAgdmFyIGl0ZXIgPSBhcnJbSVRFUkFUT1JdKCk7XG4gICAgaXRlci5uZXh0ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4geyBkb25lOiBzYWZlID0gdHJ1ZSB9OyB9O1xuICAgIGFycltJVEVSQVRPUl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBpdGVyOyB9O1xuICAgIGV4ZWMoYXJyKTtcbiAgfSBjYXRjaCAoZSkgeyAvKiBlbXB0eSAqLyB9XG4gIHJldHVybiBzYWZlO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGRvbmUsIHZhbHVlKSB7XG4gIHJldHVybiB7IHZhbHVlOiB2YWx1ZSwgZG9uZTogISFkb25lIH07XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSB7fTtcbiIsIm1vZHVsZS5leHBvcnRzID0gdHJ1ZTtcbiIsInZhciBNRVRBID0gcmVxdWlyZSgnLi9fdWlkJykoJ21ldGEnKTtcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xudmFyIGhhcyA9IHJlcXVpcmUoJy4vX2hhcycpO1xudmFyIHNldERlc2MgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mO1xudmFyIGlkID0gMDtcbnZhciBpc0V4dGVuc2libGUgPSBPYmplY3QuaXNFeHRlbnNpYmxlIHx8IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRydWU7XG59O1xudmFyIEZSRUVaRSA9ICFyZXF1aXJlKCcuL19mYWlscycpKGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGlzRXh0ZW5zaWJsZShPYmplY3QucHJldmVudEV4dGVuc2lvbnMoe30pKTtcbn0pO1xudmFyIHNldE1ldGEgPSBmdW5jdGlvbiAoaXQpIHtcbiAgc2V0RGVzYyhpdCwgTUVUQSwgeyB2YWx1ZToge1xuICAgIGk6ICdPJyArICsraWQsIC8vIG9iamVjdCBJRFxuICAgIHc6IHt9ICAgICAgICAgIC8vIHdlYWsgY29sbGVjdGlvbnMgSURzXG4gIH0gfSk7XG59O1xudmFyIGZhc3RLZXkgPSBmdW5jdGlvbiAoaXQsIGNyZWF0ZSkge1xuICAvLyByZXR1cm4gcHJpbWl0aXZlIHdpdGggcHJlZml4XG4gIGlmICghaXNPYmplY3QoaXQpKSByZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnID8gaXQgOiAodHlwZW9mIGl0ID09ICdzdHJpbmcnID8gJ1MnIDogJ1AnKSArIGl0O1xuICBpZiAoIWhhcyhpdCwgTUVUQSkpIHtcbiAgICAvLyBjYW4ndCBzZXQgbWV0YWRhdGEgdG8gdW5jYXVnaHQgZnJvemVuIG9iamVjdFxuICAgIGlmICghaXNFeHRlbnNpYmxlKGl0KSkgcmV0dXJuICdGJztcbiAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YVxuICAgIGlmICghY3JlYXRlKSByZXR1cm4gJ0UnO1xuICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhXG4gICAgc2V0TWV0YShpdCk7XG4gIC8vIHJldHVybiBvYmplY3QgSURcbiAgfSByZXR1cm4gaXRbTUVUQV0uaTtcbn07XG52YXIgZ2V0V2VhayA9IGZ1bmN0aW9uIChpdCwgY3JlYXRlKSB7XG4gIGlmICghaGFzKGl0LCBNRVRBKSkge1xuICAgIC8vIGNhbid0IHNldCBtZXRhZGF0YSB0byB1bmNhdWdodCBmcm96ZW4gb2JqZWN0XG4gICAgaWYgKCFpc0V4dGVuc2libGUoaXQpKSByZXR1cm4gdHJ1ZTtcbiAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YVxuICAgIGlmICghY3JlYXRlKSByZXR1cm4gZmFsc2U7XG4gICAgLy8gYWRkIG1pc3NpbmcgbWV0YWRhdGFcbiAgICBzZXRNZXRhKGl0KTtcbiAgLy8gcmV0dXJuIGhhc2ggd2VhayBjb2xsZWN0aW9ucyBJRHNcbiAgfSByZXR1cm4gaXRbTUVUQV0udztcbn07XG4vLyBhZGQgbWV0YWRhdGEgb24gZnJlZXplLWZhbWlseSBtZXRob2RzIGNhbGxpbmdcbnZhciBvbkZyZWV6ZSA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAoRlJFRVpFICYmIG1ldGEuTkVFRCAmJiBpc0V4dGVuc2libGUoaXQpICYmICFoYXMoaXQsIE1FVEEpKSBzZXRNZXRhKGl0KTtcbiAgcmV0dXJuIGl0O1xufTtcbnZhciBtZXRhID0gbW9kdWxlLmV4cG9ydHMgPSB7XG4gIEtFWTogTUVUQSxcbiAgTkVFRDogZmFsc2UsXG4gIGZhc3RLZXk6IGZhc3RLZXksXG4gIGdldFdlYWs6IGdldFdlYWssXG4gIG9uRnJlZXplOiBvbkZyZWV6ZVxufTtcbiIsInZhciBnbG9iYWwgPSByZXF1aXJlKCcuL19nbG9iYWwnKTtcbnZhciBtYWNyb3Rhc2sgPSByZXF1aXJlKCcuL190YXNrJykuc2V0O1xudmFyIE9ic2VydmVyID0gZ2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgZ2xvYmFsLldlYktpdE11dGF0aW9uT2JzZXJ2ZXI7XG52YXIgcHJvY2VzcyA9IGdsb2JhbC5wcm9jZXNzO1xudmFyIFByb21pc2UgPSBnbG9iYWwuUHJvbWlzZTtcbnZhciBpc05vZGUgPSByZXF1aXJlKCcuL19jb2YnKShwcm9jZXNzKSA9PSAncHJvY2Vzcyc7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKCkge1xuICB2YXIgaGVhZCwgbGFzdCwgbm90aWZ5O1xuXG4gIHZhciBmbHVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcGFyZW50LCBmbjtcbiAgICBpZiAoaXNOb2RlICYmIChwYXJlbnQgPSBwcm9jZXNzLmRvbWFpbikpIHBhcmVudC5leGl0KCk7XG4gICAgd2hpbGUgKGhlYWQpIHtcbiAgICAgIGZuID0gaGVhZC5mbjtcbiAgICAgIGhlYWQgPSBoZWFkLm5leHQ7XG4gICAgICB0cnkge1xuICAgICAgICBmbigpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBpZiAoaGVhZCkgbm90aWZ5KCk7XG4gICAgICAgIGVsc2UgbGFzdCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH1cbiAgICB9IGxhc3QgPSB1bmRlZmluZWQ7XG4gICAgaWYgKHBhcmVudCkgcGFyZW50LmVudGVyKCk7XG4gIH07XG5cbiAgLy8gTm9kZS5qc1xuICBpZiAoaXNOb2RlKSB7XG4gICAgbm90aWZ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcHJvY2Vzcy5uZXh0VGljayhmbHVzaCk7XG4gICAgfTtcbiAgLy8gYnJvd3NlcnMgd2l0aCBNdXRhdGlvbk9ic2VydmVyLCBleGNlcHQgaU9TIFNhZmFyaSAtIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy8zMzlcbiAgfSBlbHNlIGlmIChPYnNlcnZlciAmJiAhKGdsb2JhbC5uYXZpZ2F0b3IgJiYgZ2xvYmFsLm5hdmlnYXRvci5zdGFuZGFsb25lKSkge1xuICAgIHZhciB0b2dnbGUgPSB0cnVlO1xuICAgIHZhciBub2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpO1xuICAgIG5ldyBPYnNlcnZlcihmbHVzaCkub2JzZXJ2ZShub2RlLCB7IGNoYXJhY3RlckRhdGE6IHRydWUgfSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3XG4gICAgbm90aWZ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgbm9kZS5kYXRhID0gdG9nZ2xlID0gIXRvZ2dsZTtcbiAgICB9O1xuICAvLyBlbnZpcm9ubWVudHMgd2l0aCBtYXliZSBub24tY29tcGxldGVseSBjb3JyZWN0LCBidXQgZXhpc3RlbnQgUHJvbWlzZVxuICB9IGVsc2UgaWYgKFByb21pc2UgJiYgUHJvbWlzZS5yZXNvbHZlKSB7XG4gICAgLy8gUHJvbWlzZS5yZXNvbHZlIHdpdGhvdXQgYW4gYXJndW1lbnQgdGhyb3dzIGFuIGVycm9yIGluIExHIFdlYk9TIDJcbiAgICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSh1bmRlZmluZWQpO1xuICAgIG5vdGlmeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHByb21pc2UudGhlbihmbHVzaCk7XG4gICAgfTtcbiAgLy8gZm9yIG90aGVyIGVudmlyb25tZW50cyAtIG1hY3JvdGFzayBiYXNlZCBvbjpcbiAgLy8gLSBzZXRJbW1lZGlhdGVcbiAgLy8gLSBNZXNzYWdlQ2hhbm5lbFxuICAvLyAtIHdpbmRvdy5wb3N0TWVzc2FnXG4gIC8vIC0gb25yZWFkeXN0YXRlY2hhbmdlXG4gIC8vIC0gc2V0VGltZW91dFxuICB9IGVsc2Uge1xuICAgIG5vdGlmeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIHN0cmFuZ2UgSUUgKyB3ZWJwYWNrIGRldiBzZXJ2ZXIgYnVnIC0gdXNlIC5jYWxsKGdsb2JhbClcbiAgICAgIG1hY3JvdGFzay5jYWxsKGdsb2JhbCwgZmx1c2gpO1xuICAgIH07XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gKGZuKSB7XG4gICAgdmFyIHRhc2sgPSB7IGZuOiBmbiwgbmV4dDogdW5kZWZpbmVkIH07XG4gICAgaWYgKGxhc3QpIGxhc3QubmV4dCA9IHRhc2s7XG4gICAgaWYgKCFoZWFkKSB7XG4gICAgICBoZWFkID0gdGFzaztcbiAgICAgIG5vdGlmeSgpO1xuICAgIH0gbGFzdCA9IHRhc2s7XG4gIH07XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuLy8gMjUuNC4xLjUgTmV3UHJvbWlzZUNhcGFiaWxpdHkoQylcbnZhciBhRnVuY3Rpb24gPSByZXF1aXJlKCcuL19hLWZ1bmN0aW9uJyk7XG5cbmZ1bmN0aW9uIFByb21pc2VDYXBhYmlsaXR5KEMpIHtcbiAgdmFyIHJlc29sdmUsIHJlamVjdDtcbiAgdGhpcy5wcm9taXNlID0gbmV3IEMoZnVuY3Rpb24gKCQkcmVzb2x2ZSwgJCRyZWplY3QpIHtcbiAgICBpZiAocmVzb2x2ZSAhPT0gdW5kZWZpbmVkIHx8IHJlamVjdCAhPT0gdW5kZWZpbmVkKSB0aHJvdyBUeXBlRXJyb3IoJ0JhZCBQcm9taXNlIGNvbnN0cnVjdG9yJyk7XG4gICAgcmVzb2x2ZSA9ICQkcmVzb2x2ZTtcbiAgICByZWplY3QgPSAkJHJlamVjdDtcbiAgfSk7XG4gIHRoaXMucmVzb2x2ZSA9IGFGdW5jdGlvbihyZXNvbHZlKTtcbiAgdGhpcy5yZWplY3QgPSBhRnVuY3Rpb24ocmVqZWN0KTtcbn1cblxubW9kdWxlLmV4cG9ydHMuZiA9IGZ1bmN0aW9uIChDKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZUNhcGFiaWxpdHkoQyk7XG59O1xuIiwiLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pXG52YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciBkUHMgPSByZXF1aXJlKCcuL19vYmplY3QtZHBzJyk7XG52YXIgZW51bUJ1Z0tleXMgPSByZXF1aXJlKCcuL19lbnVtLWJ1Zy1rZXlzJyk7XG52YXIgSUVfUFJPVE8gPSByZXF1aXJlKCcuL19zaGFyZWQta2V5JykoJ0lFX1BST1RPJyk7XG52YXIgRW1wdHkgPSBmdW5jdGlvbiAoKSB7IC8qIGVtcHR5ICovIH07XG52YXIgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7XG5cbi8vIENyZWF0ZSBvYmplY3Qgd2l0aCBmYWtlIGBudWxsYCBwcm90b3R5cGU6IHVzZSBpZnJhbWUgT2JqZWN0IHdpdGggY2xlYXJlZCBwcm90b3R5cGVcbnZhciBjcmVhdGVEaWN0ID0gZnVuY3Rpb24gKCkge1xuICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1Z1xuICB2YXIgaWZyYW1lID0gcmVxdWlyZSgnLi9fZG9tLWNyZWF0ZScpKCdpZnJhbWUnKTtcbiAgdmFyIGkgPSBlbnVtQnVnS2V5cy5sZW5ndGg7XG4gIHZhciBsdCA9ICc8JztcbiAgdmFyIGd0ID0gJz4nO1xuICB2YXIgaWZyYW1lRG9jdW1lbnQ7XG4gIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICByZXF1aXJlKCcuL19odG1sJykuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcbiAgaWZyYW1lLnNyYyA9ICdqYXZhc2NyaXB0Oic7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2NyaXB0LXVybFxuICAvLyBjcmVhdGVEaWN0ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuT2JqZWN0O1xuICAvLyBodG1sLnJlbW92ZUNoaWxkKGlmcmFtZSk7XG4gIGlmcmFtZURvY3VtZW50ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7XG4gIGlmcmFtZURvY3VtZW50Lm9wZW4oKTtcbiAgaWZyYW1lRG9jdW1lbnQud3JpdGUobHQgKyAnc2NyaXB0JyArIGd0ICsgJ2RvY3VtZW50LkY9T2JqZWN0JyArIGx0ICsgJy9zY3JpcHQnICsgZ3QpO1xuICBpZnJhbWVEb2N1bWVudC5jbG9zZSgpO1xuICBjcmVhdGVEaWN0ID0gaWZyYW1lRG9jdW1lbnQuRjtcbiAgd2hpbGUgKGktLSkgZGVsZXRlIGNyZWF0ZURpY3RbUFJPVE9UWVBFXVtlbnVtQnVnS2V5c1tpXV07XG4gIHJldHVybiBjcmVhdGVEaWN0KCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpIHtcbiAgdmFyIHJlc3VsdDtcbiAgaWYgKE8gIT09IG51bGwpIHtcbiAgICBFbXB0eVtQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7XG4gICAgcmVzdWx0ID0gbmV3IEVtcHR5KCk7XG4gICAgRW1wdHlbUFJPVE9UWVBFXSA9IG51bGw7XG4gICAgLy8gYWRkIFwiX19wcm90b19fXCIgZm9yIE9iamVjdC5nZXRQcm90b3R5cGVPZiBwb2x5ZmlsbFxuICAgIHJlc3VsdFtJRV9QUk9UT10gPSBPO1xuICB9IGVsc2UgcmVzdWx0ID0gY3JlYXRlRGljdCgpO1xuICByZXR1cm4gUHJvcGVydGllcyA9PT0gdW5kZWZpbmVkID8gcmVzdWx0IDogZFBzKHJlc3VsdCwgUHJvcGVydGllcyk7XG59O1xuIiwidmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgSUU4X0RPTV9ERUZJTkUgPSByZXF1aXJlKCcuL19pZTgtZG9tLWRlZmluZScpO1xudmFyIHRvUHJpbWl0aXZlID0gcmVxdWlyZSgnLi9fdG8tcHJpbWl0aXZlJyk7XG52YXIgZFAgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG5cbmV4cG9ydHMuZiA9IHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykgPyBPYmplY3QuZGVmaW5lUHJvcGVydHkgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKSB7XG4gIGFuT2JqZWN0KE8pO1xuICBQID0gdG9QcmltaXRpdmUoUCwgdHJ1ZSk7XG4gIGFuT2JqZWN0KEF0dHJpYnV0ZXMpO1xuICBpZiAoSUU4X0RPTV9ERUZJTkUpIHRyeSB7XG4gICAgcmV0dXJuIGRQKE8sIFAsIEF0dHJpYnV0ZXMpO1xuICB9IGNhdGNoIChlKSB7IC8qIGVtcHR5ICovIH1cbiAgaWYgKCdnZXQnIGluIEF0dHJpYnV0ZXMgfHwgJ3NldCcgaW4gQXR0cmlidXRlcykgdGhyb3cgVHlwZUVycm9yKCdBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCEnKTtcbiAgaWYgKCd2YWx1ZScgaW4gQXR0cmlidXRlcykgT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7XG4gIHJldHVybiBPO1xufTtcbiIsInZhciBkUCA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgZ2V0S2V5cyA9IHJlcXVpcmUoJy4vX29iamVjdC1rZXlzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzIDogZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKSB7XG4gIGFuT2JqZWN0KE8pO1xuICB2YXIga2V5cyA9IGdldEtleXMoUHJvcGVydGllcyk7XG4gIHZhciBsZW5ndGggPSBrZXlzLmxlbmd0aDtcbiAgdmFyIGkgPSAwO1xuICB2YXIgUDtcbiAgd2hpbGUgKGxlbmd0aCA+IGkpIGRQLmYoTywgUCA9IGtleXNbaSsrXSwgUHJvcGVydGllc1tQXSk7XG4gIHJldHVybiBPO1xufTtcbiIsInZhciBwSUUgPSByZXF1aXJlKCcuL19vYmplY3QtcGllJyk7XG52YXIgY3JlYXRlRGVzYyA9IHJlcXVpcmUoJy4vX3Byb3BlcnR5LWRlc2MnKTtcbnZhciB0b0lPYmplY3QgPSByZXF1aXJlKCcuL190by1pb2JqZWN0Jyk7XG52YXIgdG9QcmltaXRpdmUgPSByZXF1aXJlKCcuL190by1wcmltaXRpdmUnKTtcbnZhciBoYXMgPSByZXF1aXJlKCcuL19oYXMnKTtcbnZhciBJRThfRE9NX0RFRklORSA9IHJlcXVpcmUoJy4vX2llOC1kb20tZGVmaW5lJyk7XG52YXIgZ09QRCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7XG5cbmV4cG9ydHMuZiA9IHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykgPyBnT1BEIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApIHtcbiAgTyA9IHRvSU9iamVjdChPKTtcbiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpO1xuICBpZiAoSUU4X0RPTV9ERUZJTkUpIHRyeSB7XG4gICAgcmV0dXJuIGdPUEQoTywgUCk7XG4gIH0gY2F0Y2ggKGUpIHsgLyogZW1wdHkgKi8gfVxuICBpZiAoaGFzKE8sIFApKSByZXR1cm4gY3JlYXRlRGVzYyghcElFLmYuY2FsbChPLCBQKSwgT1tQXSk7XG59O1xuIiwiLy8gZmFsbGJhY2sgZm9yIElFMTEgYnVnZ3kgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgd2l0aCBpZnJhbWUgYW5kIHdpbmRvd1xudmFyIHRvSU9iamVjdCA9IHJlcXVpcmUoJy4vX3RvLWlvYmplY3QnKTtcbnZhciBnT1BOID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcG4nKS5mO1xudmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7XG5cbnZhciB3aW5kb3dOYW1lcyA9IHR5cGVvZiB3aW5kb3cgPT0gJ29iamVjdCcgJiYgd2luZG93ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzXG4gID8gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMod2luZG93KSA6IFtdO1xuXG52YXIgZ2V0V2luZG93TmFtZXMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZ09QTihpdCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gd2luZG93TmFtZXMuc2xpY2UoKTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMuZiA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpIHtcbiAgcmV0dXJuIHdpbmRvd05hbWVzICYmIHRvU3RyaW5nLmNhbGwoaXQpID09ICdbb2JqZWN0IFdpbmRvd10nID8gZ2V0V2luZG93TmFtZXMoaXQpIDogZ09QTih0b0lPYmplY3QoaXQpKTtcbn07XG4iLCIvLyAxOS4xLjIuNyAvIDE1LjIuMy40IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKE8pXG52YXIgJGtleXMgPSByZXF1aXJlKCcuL19vYmplY3Qta2V5cy1pbnRlcm5hbCcpO1xudmFyIGhpZGRlbktleXMgPSByZXF1aXJlKCcuL19lbnVtLWJ1Zy1rZXlzJykuY29uY2F0KCdsZW5ndGgnLCAncHJvdG90eXBlJyk7XG5cbmV4cG9ydHMuZiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIHx8IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoTykge1xuICByZXR1cm4gJGtleXMoTywgaGlkZGVuS2V5cyk7XG59O1xuIiwiZXhwb3J0cy5mID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scztcbiIsIi8vIDE5LjEuMi45IC8gMTUuMi4zLjIgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pXG52YXIgaGFzID0gcmVxdWlyZSgnLi9faGFzJyk7XG52YXIgdG9PYmplY3QgPSByZXF1aXJlKCcuL190by1vYmplY3QnKTtcbnZhciBJRV9QUk9UTyA9IHJlcXVpcmUoJy4vX3NoYXJlZC1rZXknKSgnSUVfUFJPVE8nKTtcbnZhciBPYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7XG5cbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmdldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIChPKSB7XG4gIE8gPSB0b09iamVjdChPKTtcbiAgaWYgKGhhcyhPLCBJRV9QUk9UTykpIHJldHVybiBPW0lFX1BST1RPXTtcbiAgaWYgKHR5cGVvZiBPLmNvbnN0cnVjdG9yID09ICdmdW5jdGlvbicgJiYgTyBpbnN0YW5jZW9mIE8uY29uc3RydWN0b3IpIHtcbiAgICByZXR1cm4gTy5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7XG4gIH0gcmV0dXJuIE8gaW5zdGFuY2VvZiBPYmplY3QgPyBPYmplY3RQcm90byA6IG51bGw7XG59O1xuIiwidmFyIGhhcyA9IHJlcXVpcmUoJy4vX2hhcycpO1xudmFyIHRvSU9iamVjdCA9IHJlcXVpcmUoJy4vX3RvLWlvYmplY3QnKTtcbnZhciBhcnJheUluZGV4T2YgPSByZXF1aXJlKCcuL19hcnJheS1pbmNsdWRlcycpKGZhbHNlKTtcbnZhciBJRV9QUk9UTyA9IHJlcXVpcmUoJy4vX3NoYXJlZC1rZXknKSgnSUVfUFJPVE8nKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAob2JqZWN0LCBuYW1lcykge1xuICB2YXIgTyA9IHRvSU9iamVjdChvYmplY3QpO1xuICB2YXIgaSA9IDA7XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgdmFyIGtleTtcbiAgZm9yIChrZXkgaW4gTykgaWYgKGtleSAhPSBJRV9QUk9UTykgaGFzKE8sIGtleSkgJiYgcmVzdWx0LnB1c2goa2V5KTtcbiAgLy8gRG9uJ3QgZW51bSBidWcgJiBoaWRkZW4ga2V5c1xuICB3aGlsZSAobmFtZXMubGVuZ3RoID4gaSkgaWYgKGhhcyhPLCBrZXkgPSBuYW1lc1tpKytdKSkge1xuICAgIH5hcnJheUluZGV4T2YocmVzdWx0LCBrZXkpIHx8IHJlc3VsdC5wdXNoKGtleSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG4iLCIvLyAxOS4xLjIuMTQgLyAxNS4yLjMuMTQgT2JqZWN0LmtleXMoTylcbnZhciAka2V5cyA9IHJlcXVpcmUoJy4vX29iamVjdC1rZXlzLWludGVybmFsJyk7XG52YXIgZW51bUJ1Z0tleXMgPSByZXF1aXJlKCcuL19lbnVtLWJ1Zy1rZXlzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24ga2V5cyhPKSB7XG4gIHJldHVybiAka2V5cyhPLCBlbnVtQnVnS2V5cyk7XG59O1xuIiwiZXhwb3J0cy5mID0ge30ucHJvcGVydHlJc0VudW1lcmFibGU7XG4iLCIvLyBtb3N0IE9iamVjdCBtZXRob2RzIGJ5IEVTNiBzaG91bGQgYWNjZXB0IHByaW1pdGl2ZXNcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG52YXIgY29yZSA9IHJlcXVpcmUoJy4vX2NvcmUnKTtcbnZhciBmYWlscyA9IHJlcXVpcmUoJy4vX2ZhaWxzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChLRVksIGV4ZWMpIHtcbiAgdmFyIGZuID0gKGNvcmUuT2JqZWN0IHx8IHt9KVtLRVldIHx8IE9iamVjdFtLRVldO1xuICB2YXIgZXhwID0ge307XG4gIGV4cFtLRVldID0gZXhlYyhmbik7XG4gICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogZmFpbHMoZnVuY3Rpb24gKCkgeyBmbigxKTsgfSksICdPYmplY3QnLCBleHApO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGV4ZWMpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4geyBlOiBmYWxzZSwgdjogZXhlYygpIH07XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4geyBlOiB0cnVlLCB2OiBlIH07XG4gIH1cbn07XG4iLCJ2YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTtcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xudmFyIG5ld1Byb21pc2VDYXBhYmlsaXR5ID0gcmVxdWlyZSgnLi9fbmV3LXByb21pc2UtY2FwYWJpbGl0eScpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChDLCB4KSB7XG4gIGFuT2JqZWN0KEMpO1xuICBpZiAoaXNPYmplY3QoeCkgJiYgeC5jb25zdHJ1Y3RvciA9PT0gQykgcmV0dXJuIHg7XG4gIHZhciBwcm9taXNlQ2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5LmYoQyk7XG4gIHZhciByZXNvbHZlID0gcHJvbWlzZUNhcGFiaWxpdHkucmVzb2x2ZTtcbiAgcmVzb2x2ZSh4KTtcbiAgcmV0dXJuIHByb21pc2VDYXBhYmlsaXR5LnByb21pc2U7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYml0bWFwLCB2YWx1ZSkge1xuICByZXR1cm4ge1xuICAgIGVudW1lcmFibGU6ICEoYml0bWFwICYgMSksXG4gICAgY29uZmlndXJhYmxlOiAhKGJpdG1hcCAmIDIpLFxuICAgIHdyaXRhYmxlOiAhKGJpdG1hcCAmIDQpLFxuICAgIHZhbHVlOiB2YWx1ZVxuICB9O1xufTtcbiIsInZhciBoaWRlID0gcmVxdWlyZSgnLi9faGlkZScpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodGFyZ2V0LCBzcmMsIHNhZmUpIHtcbiAgZm9yICh2YXIga2V5IGluIHNyYykge1xuICAgIGlmIChzYWZlICYmIHRhcmdldFtrZXldKSB0YXJnZXRba2V5XSA9IHNyY1trZXldO1xuICAgIGVsc2UgaGlkZSh0YXJnZXQsIGtleSwgc3JjW2tleV0pO1xuICB9IHJldHVybiB0YXJnZXQ7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL19oaWRlJyk7XG4iLCIvLyBXb3JrcyB3aXRoIF9fcHJvdG9fXyBvbmx5LiBPbGQgdjggY2FuJ3Qgd29yayB3aXRoIG51bGwgcHJvdG8gb2JqZWN0cy5cbi8qIGVzbGludC1kaXNhYmxlIG5vLXByb3RvICovXG52YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKTtcbnZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpO1xudmFyIGNoZWNrID0gZnVuY3Rpb24gKE8sIHByb3RvKSB7XG4gIGFuT2JqZWN0KE8pO1xuICBpZiAoIWlzT2JqZWN0KHByb3RvKSAmJiBwcm90byAhPT0gbnVsbCkgdGhyb3cgVHlwZUVycm9yKHByb3RvICsgXCI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhXCIpO1xufTtcbm1vZHVsZS5leHBvcnRzID0ge1xuICBzZXQ6IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoJ19fcHJvdG9fXycgaW4ge30gPyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgZnVuY3Rpb24gKHRlc3QsIGJ1Z2d5LCBzZXQpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHNldCA9IHJlcXVpcmUoJy4vX2N0eCcpKEZ1bmN0aW9uLmNhbGwsIHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJykuZihPYmplY3QucHJvdG90eXBlLCAnX19wcm90b19fJykuc2V0LCAyKTtcbiAgICAgICAgc2V0KHRlc3QsIFtdKTtcbiAgICAgICAgYnVnZ3kgPSAhKHRlc3QgaW5zdGFuY2VvZiBBcnJheSk7XG4gICAgICB9IGNhdGNoIChlKSB7IGJ1Z2d5ID0gdHJ1ZTsgfVxuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHNldFByb3RvdHlwZU9mKE8sIHByb3RvKSB7XG4gICAgICAgIGNoZWNrKE8sIHByb3RvKTtcbiAgICAgICAgaWYgKGJ1Z2d5KSBPLl9fcHJvdG9fXyA9IHByb3RvO1xuICAgICAgICBlbHNlIHNldChPLCBwcm90byk7XG4gICAgICAgIHJldHVybiBPO1xuICAgICAgfTtcbiAgICB9KHt9LCBmYWxzZSkgOiB1bmRlZmluZWQpLFxuICBjaGVjazogY2hlY2tcbn07XG4iLCIndXNlIHN0cmljdCc7XG52YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJyk7XG52YXIgY29yZSA9IHJlcXVpcmUoJy4vX2NvcmUnKTtcbnZhciBkUCA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpO1xudmFyIERFU0NSSVBUT1JTID0gcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKTtcbnZhciBTUEVDSUVTID0gcmVxdWlyZSgnLi9fd2tzJykoJ3NwZWNpZXMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoS0VZKSB7XG4gIHZhciBDID0gdHlwZW9mIGNvcmVbS0VZXSA9PSAnZnVuY3Rpb24nID8gY29yZVtLRVldIDogZ2xvYmFsW0tFWV07XG4gIGlmIChERVNDUklQVE9SUyAmJiBDICYmICFDW1NQRUNJRVNdKSBkUC5mKEMsIFNQRUNJRVMsIHtcbiAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9XG4gIH0pO1xufTtcbiIsInZhciBkZWYgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mO1xudmFyIGhhcyA9IHJlcXVpcmUoJy4vX2hhcycpO1xudmFyIFRBRyA9IHJlcXVpcmUoJy4vX3drcycpKCd0b1N0cmluZ1RhZycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCwgdGFnLCBzdGF0KSB7XG4gIGlmIChpdCAmJiAhaGFzKGl0ID0gc3RhdCA/IGl0IDogaXQucHJvdG90eXBlLCBUQUcpKSBkZWYoaXQsIFRBRywgeyBjb25maWd1cmFibGU6IHRydWUsIHZhbHVlOiB0YWcgfSk7XG59O1xuIiwidmFyIHNoYXJlZCA9IHJlcXVpcmUoJy4vX3NoYXJlZCcpKCdrZXlzJyk7XG52YXIgdWlkID0gcmVxdWlyZSgnLi9fdWlkJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgcmV0dXJuIHNoYXJlZFtrZXldIHx8IChzaGFyZWRba2V5XSA9IHVpZChrZXkpKTtcbn07XG4iLCJ2YXIgY29yZSA9IHJlcXVpcmUoJy4vX2NvcmUnKTtcbnZhciBnbG9iYWwgPSByZXF1aXJlKCcuL19nbG9iYWwnKTtcbnZhciBTSEFSRUQgPSAnX19jb3JlLWpzX3NoYXJlZF9fJztcbnZhciBzdG9yZSA9IGdsb2JhbFtTSEFSRURdIHx8IChnbG9iYWxbU0hBUkVEXSA9IHt9KTtcblxuKG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgcmV0dXJuIHN0b3JlW2tleV0gfHwgKHN0b3JlW2tleV0gPSB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiB7fSk7XG59KSgndmVyc2lvbnMnLCBbXSkucHVzaCh7XG4gIHZlcnNpb246IGNvcmUudmVyc2lvbixcbiAgbW9kZTogcmVxdWlyZSgnLi9fbGlicmFyeScpID8gJ3B1cmUnIDogJ2dsb2JhbCcsXG4gIGNvcHlyaWdodDogJ8KpIDIwMjAgRGVuaXMgUHVzaGthcmV2ICh6bG9pcm9jay5ydSknXG59KTtcbiIsIi8vIDcuMy4yMCBTcGVjaWVzQ29uc3RydWN0b3IoTywgZGVmYXVsdENvbnN0cnVjdG9yKVxudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgYUZ1bmN0aW9uID0gcmVxdWlyZSgnLi9fYS1mdW5jdGlvbicpO1xudmFyIFNQRUNJRVMgPSByZXF1aXJlKCcuL193a3MnKSgnc3BlY2llcycpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoTywgRCkge1xuICB2YXIgQyA9IGFuT2JqZWN0KE8pLmNvbnN0cnVjdG9yO1xuICB2YXIgUztcbiAgcmV0dXJuIEMgPT09IHVuZGVmaW5lZCB8fCAoUyA9IGFuT2JqZWN0KEMpW1NQRUNJRVNdKSA9PSB1bmRlZmluZWQgPyBEIDogYUZ1bmN0aW9uKFMpO1xufTtcbiIsInZhciB0b0ludGVnZXIgPSByZXF1aXJlKCcuL190by1pbnRlZ2VyJyk7XG52YXIgZGVmaW5lZCA9IHJlcXVpcmUoJy4vX2RlZmluZWQnKTtcbi8vIHRydWUgIC0+IFN0cmluZyNhdFxuLy8gZmFsc2UgLT4gU3RyaW5nI2NvZGVQb2ludEF0XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChUT19TVFJJTkcpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0aGF0LCBwb3MpIHtcbiAgICB2YXIgcyA9IFN0cmluZyhkZWZpbmVkKHRoYXQpKTtcbiAgICB2YXIgaSA9IHRvSW50ZWdlcihwb3MpO1xuICAgIHZhciBsID0gcy5sZW5ndGg7XG4gICAgdmFyIGEsIGI7XG4gICAgaWYgKGkgPCAwIHx8IGkgPj0gbCkgcmV0dXJuIFRPX1NUUklORyA/ICcnIDogdW5kZWZpbmVkO1xuICAgIGEgPSBzLmNoYXJDb2RlQXQoaSk7XG4gICAgcmV0dXJuIGEgPCAweGQ4MDAgfHwgYSA+IDB4ZGJmZiB8fCBpICsgMSA9PT0gbCB8fCAoYiA9IHMuY2hhckNvZGVBdChpICsgMSkpIDwgMHhkYzAwIHx8IGIgPiAweGRmZmZcbiAgICAgID8gVE9fU1RSSU5HID8gcy5jaGFyQXQoaSkgOiBhXG4gICAgICA6IFRPX1NUUklORyA/IHMuc2xpY2UoaSwgaSArIDIpIDogKGEgLSAweGQ4MDAgPDwgMTApICsgKGIgLSAweGRjMDApICsgMHgxMDAwMDtcbiAgfTtcbn07XG4iLCJ2YXIgY3R4ID0gcmVxdWlyZSgnLi9fY3R4Jyk7XG52YXIgaW52b2tlID0gcmVxdWlyZSgnLi9faW52b2tlJyk7XG52YXIgaHRtbCA9IHJlcXVpcmUoJy4vX2h0bWwnKTtcbnZhciBjZWwgPSByZXF1aXJlKCcuL19kb20tY3JlYXRlJyk7XG52YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJyk7XG52YXIgcHJvY2VzcyA9IGdsb2JhbC5wcm9jZXNzO1xudmFyIHNldFRhc2sgPSBnbG9iYWwuc2V0SW1tZWRpYXRlO1xudmFyIGNsZWFyVGFzayA9IGdsb2JhbC5jbGVhckltbWVkaWF0ZTtcbnZhciBNZXNzYWdlQ2hhbm5lbCA9IGdsb2JhbC5NZXNzYWdlQ2hhbm5lbDtcbnZhciBEaXNwYXRjaCA9IGdsb2JhbC5EaXNwYXRjaDtcbnZhciBjb3VudGVyID0gMDtcbnZhciBxdWV1ZSA9IHt9O1xudmFyIE9OUkVBRFlTVEFURUNIQU5HRSA9ICdvbnJlYWR5c3RhdGVjaGFuZ2UnO1xudmFyIGRlZmVyLCBjaGFubmVsLCBwb3J0O1xudmFyIHJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGlkID0gK3RoaXM7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wcm90b3R5cGUtYnVpbHRpbnNcbiAgaWYgKHF1ZXVlLmhhc093blByb3BlcnR5KGlkKSkge1xuICAgIHZhciBmbiA9IHF1ZXVlW2lkXTtcbiAgICBkZWxldGUgcXVldWVbaWRdO1xuICAgIGZuKCk7XG4gIH1cbn07XG52YXIgbGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgcnVuLmNhbGwoZXZlbnQuZGF0YSk7XG59O1xuLy8gTm9kZS5qcyAwLjkrICYgSUUxMCsgaGFzIHNldEltbWVkaWF0ZSwgb3RoZXJ3aXNlOlxuaWYgKCFzZXRUYXNrIHx8ICFjbGVhclRhc2spIHtcbiAgc2V0VGFzayA9IGZ1bmN0aW9uIHNldEltbWVkaWF0ZShmbikge1xuICAgIHZhciBhcmdzID0gW107XG4gICAgdmFyIGkgPSAxO1xuICAgIHdoaWxlIChhcmd1bWVudHMubGVuZ3RoID4gaSkgYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTtcbiAgICBxdWV1ZVsrK2NvdW50ZXJdID0gZnVuY3Rpb24gKCkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLW5ldy1mdW5jXG4gICAgICBpbnZva2UodHlwZW9mIGZuID09ICdmdW5jdGlvbicgPyBmbiA6IEZ1bmN0aW9uKGZuKSwgYXJncyk7XG4gICAgfTtcbiAgICBkZWZlcihjb3VudGVyKTtcbiAgICByZXR1cm4gY291bnRlcjtcbiAgfTtcbiAgY2xlYXJUYXNrID0gZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaWQpIHtcbiAgICBkZWxldGUgcXVldWVbaWRdO1xuICB9O1xuICAvLyBOb2RlLmpzIDAuOC1cbiAgaWYgKHJlcXVpcmUoJy4vX2NvZicpKHByb2Nlc3MpID09ICdwcm9jZXNzJykge1xuICAgIGRlZmVyID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICBwcm9jZXNzLm5leHRUaWNrKGN0eChydW4sIGlkLCAxKSk7XG4gICAgfTtcbiAgLy8gU3BoZXJlIChKUyBnYW1lIGVuZ2luZSkgRGlzcGF0Y2ggQVBJXG4gIH0gZWxzZSBpZiAoRGlzcGF0Y2ggJiYgRGlzcGF0Y2gubm93KSB7XG4gICAgZGVmZXIgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgIERpc3BhdGNoLm5vdyhjdHgocnVuLCBpZCwgMSkpO1xuICAgIH07XG4gIC8vIEJyb3dzZXJzIHdpdGggTWVzc2FnZUNoYW5uZWwsIGluY2x1ZGVzIFdlYldvcmtlcnNcbiAgfSBlbHNlIGlmIChNZXNzYWdlQ2hhbm5lbCkge1xuICAgIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKTtcbiAgICBwb3J0ID0gY2hhbm5lbC5wb3J0MjtcbiAgICBjaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGxpc3RlbmVyO1xuICAgIGRlZmVyID0gY3R4KHBvcnQucG9zdE1lc3NhZ2UsIHBvcnQsIDEpO1xuICAvLyBCcm93c2VycyB3aXRoIHBvc3RNZXNzYWdlLCBza2lwIFdlYldvcmtlcnNcbiAgLy8gSUU4IGhhcyBwb3N0TWVzc2FnZSwgYnV0IGl0J3Mgc3luYyAmIHR5cGVvZiBpdHMgcG9zdE1lc3NhZ2UgaXMgJ29iamVjdCdcbiAgfSBlbHNlIGlmIChnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lciAmJiB0eXBlb2YgcG9zdE1lc3NhZ2UgPT0gJ2Z1bmN0aW9uJyAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpIHtcbiAgICBkZWZlciA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgZ2xvYmFsLnBvc3RNZXNzYWdlKGlkICsgJycsICcqJyk7XG4gICAgfTtcbiAgICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGxpc3RlbmVyLCBmYWxzZSk7XG4gIC8vIElFOC1cbiAgfSBlbHNlIGlmIChPTlJFQURZU1RBVEVDSEFOR0UgaW4gY2VsKCdzY3JpcHQnKSkge1xuICAgIGRlZmVyID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICBodG1sLmFwcGVuZENoaWxkKGNlbCgnc2NyaXB0JykpW09OUkVBRFlTVEFURUNIQU5HRV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQodGhpcyk7XG4gICAgICAgIHJ1bi5jYWxsKGlkKTtcbiAgICAgIH07XG4gICAgfTtcbiAgLy8gUmVzdCBvbGQgYnJvd3NlcnNcbiAgfSBlbHNlIHtcbiAgICBkZWZlciA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgc2V0VGltZW91dChjdHgocnVuLCBpZCwgMSksIDApO1xuICAgIH07XG4gIH1cbn1cbm1vZHVsZS5leHBvcnRzID0ge1xuICBzZXQ6IHNldFRhc2ssXG4gIGNsZWFyOiBjbGVhclRhc2tcbn07XG4iLCJ2YXIgdG9JbnRlZ2VyID0gcmVxdWlyZSgnLi9fdG8taW50ZWdlcicpO1xudmFyIG1heCA9IE1hdGgubWF4O1xudmFyIG1pbiA9IE1hdGgubWluO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaW5kZXgsIGxlbmd0aCkge1xuICBpbmRleCA9IHRvSW50ZWdlcihpbmRleCk7XG4gIHJldHVybiBpbmRleCA8IDAgPyBtYXgoaW5kZXggKyBsZW5ndGgsIDApIDogbWluKGluZGV4LCBsZW5ndGgpO1xufTtcbiIsIi8vIDcuMS40IFRvSW50ZWdlclxudmFyIGNlaWwgPSBNYXRoLmNlaWw7XG52YXIgZmxvb3IgPSBNYXRoLmZsb29yO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGlzTmFOKGl0ID0gK2l0KSA/IDAgOiAoaXQgPiAwID8gZmxvb3IgOiBjZWlsKShpdCk7XG59O1xuIiwiLy8gdG8gaW5kZXhlZCBvYmplY3QsIHRvT2JqZWN0IHdpdGggZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBzdHJpbmdzXG52YXIgSU9iamVjdCA9IHJlcXVpcmUoJy4vX2lvYmplY3QnKTtcbnZhciBkZWZpbmVkID0gcmVxdWlyZSgnLi9fZGVmaW5lZCcpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIElPYmplY3QoZGVmaW5lZChpdCkpO1xufTtcbiIsIi8vIDcuMS4xNSBUb0xlbmd0aFxudmFyIHRvSW50ZWdlciA9IHJlcXVpcmUoJy4vX3RvLWludGVnZXInKTtcbnZhciBtaW4gPSBNYXRoLm1pbjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBpdCA+IDAgPyBtaW4odG9JbnRlZ2VyKGl0KSwgMHgxZmZmZmZmZmZmZmZmZikgOiAwOyAvLyBwb3coMiwgNTMpIC0gMSA9PSA5MDA3MTk5MjU0NzQwOTkxXG59O1xuIiwiLy8gNy4xLjEzIFRvT2JqZWN0KGFyZ3VtZW50KVxudmFyIGRlZmluZWQgPSByZXF1aXJlKCcuL19kZWZpbmVkJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gT2JqZWN0KGRlZmluZWQoaXQpKTtcbn07XG4iLCIvLyA3LjEuMSBUb1ByaW1pdGl2ZShpbnB1dCBbLCBQcmVmZXJyZWRUeXBlXSlcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpO1xuLy8gaW5zdGVhZCBvZiB0aGUgRVM2IHNwZWMgdmVyc2lvbiwgd2UgZGlkbid0IGltcGxlbWVudCBAQHRvUHJpbWl0aXZlIGNhc2Vcbi8vIGFuZCB0aGUgc2Vjb25kIGFyZ3VtZW50IC0gZmxhZyAtIHByZWZlcnJlZCB0eXBlIGlzIGEgc3RyaW5nXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCwgUykge1xuICBpZiAoIWlzT2JqZWN0KGl0KSkgcmV0dXJuIGl0O1xuICB2YXIgZm4sIHZhbDtcbiAgaWYgKFMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpIHJldHVybiB2YWw7XG4gIGlmICh0eXBlb2YgKGZuID0gaXQudmFsdWVPZikgPT0gJ2Z1bmN0aW9uJyAmJiAhaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKSByZXR1cm4gdmFsO1xuICBpZiAoIVMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpIHJldHVybiB2YWw7XG4gIHRocm93IFR5cGVFcnJvcihcIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZVwiKTtcbn07XG4iLCJ2YXIgaWQgPSAwO1xudmFyIHB4ID0gTWF0aC5yYW5kb20oKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGtleSkge1xuICByZXR1cm4gJ1N5bWJvbCgnLmNvbmNhdChrZXkgPT09IHVuZGVmaW5lZCA/ICcnIDoga2V5LCAnKV8nLCAoKytpZCArIHB4KS50b1N0cmluZygzNikpO1xufTtcbiIsInZhciBnbG9iYWwgPSByZXF1aXJlKCcuL19nbG9iYWwnKTtcbnZhciBuYXZpZ2F0b3IgPSBnbG9iYWwubmF2aWdhdG9yO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5hdmlnYXRvciAmJiBuYXZpZ2F0b3IudXNlckFnZW50IHx8ICcnO1xuIiwidmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIGNvcmUgPSByZXF1aXJlKCcuL19jb3JlJyk7XG52YXIgTElCUkFSWSA9IHJlcXVpcmUoJy4vX2xpYnJhcnknKTtcbnZhciB3a3NFeHQgPSByZXF1aXJlKCcuL193a3MtZXh0Jyk7XG52YXIgZGVmaW5lUHJvcGVydHkgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobmFtZSkge1xuICB2YXIgJFN5bWJvbCA9IGNvcmUuU3ltYm9sIHx8IChjb3JlLlN5bWJvbCA9IExJQlJBUlkgPyB7fSA6IGdsb2JhbC5TeW1ib2wgfHwge30pO1xuICBpZiAobmFtZS5jaGFyQXQoMCkgIT0gJ18nICYmICEobmFtZSBpbiAkU3ltYm9sKSkgZGVmaW5lUHJvcGVydHkoJFN5bWJvbCwgbmFtZSwgeyB2YWx1ZTogd2tzRXh0LmYobmFtZSkgfSk7XG59O1xuIiwiZXhwb3J0cy5mID0gcmVxdWlyZSgnLi9fd2tzJyk7XG4iLCJ2YXIgc3RvcmUgPSByZXF1aXJlKCcuL19zaGFyZWQnKSgnd2tzJyk7XG52YXIgdWlkID0gcmVxdWlyZSgnLi9fdWlkJyk7XG52YXIgU3ltYm9sID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykuU3ltYm9sO1xudmFyIFVTRV9TWU1CT0wgPSB0eXBlb2YgU3ltYm9sID09ICdmdW5jdGlvbic7XG5cbnZhciAkZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgcmV0dXJuIHN0b3JlW25hbWVdIHx8IChzdG9yZVtuYW1lXSA9XG4gICAgVVNFX1NZTUJPTCAmJiBTeW1ib2xbbmFtZV0gfHwgKFVTRV9TWU1CT0wgPyBTeW1ib2wgOiB1aWQpKCdTeW1ib2wuJyArIG5hbWUpKTtcbn07XG5cbiRleHBvcnRzLnN0b3JlID0gc3RvcmU7XG4iLCJ2YXIgY2xhc3NvZiA9IHJlcXVpcmUoJy4vX2NsYXNzb2YnKTtcbnZhciBJVEVSQVRPUiA9IHJlcXVpcmUoJy4vX3drcycpKCdpdGVyYXRvcicpO1xudmFyIEl0ZXJhdG9ycyA9IHJlcXVpcmUoJy4vX2l0ZXJhdG9ycycpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL19jb3JlJykuZ2V0SXRlcmF0b3JNZXRob2QgPSBmdW5jdGlvbiAoaXQpIHtcbiAgaWYgKGl0ICE9IHVuZGVmaW5lZCkgcmV0dXJuIGl0W0lURVJBVE9SXVxuICAgIHx8IGl0WydAQGl0ZXJhdG9yJ11cbiAgICB8fCBJdGVyYXRvcnNbY2xhc3NvZihpdCldO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBhZGRUb1Vuc2NvcGFibGVzID0gcmVxdWlyZSgnLi9fYWRkLXRvLXVuc2NvcGFibGVzJyk7XG52YXIgc3RlcCA9IHJlcXVpcmUoJy4vX2l0ZXItc3RlcCcpO1xudmFyIEl0ZXJhdG9ycyA9IHJlcXVpcmUoJy4vX2l0ZXJhdG9ycycpO1xudmFyIHRvSU9iamVjdCA9IHJlcXVpcmUoJy4vX3RvLWlvYmplY3QnKTtcblxuLy8gMjIuMS4zLjQgQXJyYXkucHJvdG90eXBlLmVudHJpZXMoKVxuLy8gMjIuMS4zLjEzIEFycmF5LnByb3RvdHlwZS5rZXlzKClcbi8vIDIyLjEuMy4yOSBBcnJheS5wcm90b3R5cGUudmFsdWVzKClcbi8vIDIyLjEuMy4zMCBBcnJheS5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKVxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL19pdGVyLWRlZmluZScpKEFycmF5LCAnQXJyYXknLCBmdW5jdGlvbiAoaXRlcmF0ZWQsIGtpbmQpIHtcbiAgdGhpcy5fdCA9IHRvSU9iamVjdChpdGVyYXRlZCk7IC8vIHRhcmdldFxuICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleFxuICB0aGlzLl9rID0ga2luZDsgICAgICAgICAgICAgICAgLy8ga2luZFxuLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpXG59LCBmdW5jdGlvbiAoKSB7XG4gIHZhciBPID0gdGhpcy5fdDtcbiAgdmFyIGtpbmQgPSB0aGlzLl9rO1xuICB2YXIgaW5kZXggPSB0aGlzLl9pKys7XG4gIGlmICghTyB8fCBpbmRleCA+PSBPLmxlbmd0aCkge1xuICAgIHRoaXMuX3QgPSB1bmRlZmluZWQ7XG4gICAgcmV0dXJuIHN0ZXAoMSk7XG4gIH1cbiAgaWYgKGtpbmQgPT0gJ2tleXMnKSByZXR1cm4gc3RlcCgwLCBpbmRleCk7XG4gIGlmIChraW5kID09ICd2YWx1ZXMnKSByZXR1cm4gc3RlcCgwLCBPW2luZGV4XSk7XG4gIHJldHVybiBzdGVwKDAsIFtpbmRleCwgT1tpbmRleF1dKTtcbn0sICd2YWx1ZXMnKTtcblxuLy8gYXJndW1lbnRzTGlzdFtAQGl0ZXJhdG9yXSBpcyAlQXJyYXlQcm90b192YWx1ZXMlICg5LjQuNC42LCA5LjQuNC43KVxuSXRlcmF0b3JzLkFyZ3VtZW50cyA9IEl0ZXJhdG9ycy5BcnJheTtcblxuYWRkVG9VbnNjb3BhYmxlcygna2V5cycpO1xuYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7XG5hZGRUb1Vuc2NvcGFibGVzKCdlbnRyaWVzJyk7XG4iLCJ2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xuLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pXG4kZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHsgY3JlYXRlOiByZXF1aXJlKCcuL19vYmplY3QtY3JlYXRlJykgfSk7XG4iLCJ2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xuLy8gMTkuMS4yLjQgLyAxNS4yLjMuNiBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcylcbiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIXJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJyksICdPYmplY3QnLCB7IGRlZmluZVByb3BlcnR5OiByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mIH0pO1xuIiwiLy8gMTkuMS4yLjYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKVxudmFyIHRvSU9iamVjdCA9IHJlcXVpcmUoJy4vX3RvLWlvYmplY3QnKTtcbnZhciAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcGQnKS5mO1xuXG5yZXF1aXJlKCcuL19vYmplY3Qtc2FwJykoJ2dldE93blByb3BlcnR5RGVzY3JpcHRvcicsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KSB7XG4gICAgcmV0dXJuICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodG9JT2JqZWN0KGl0KSwga2V5KTtcbiAgfTtcbn0pO1xuIiwiLy8gMTkuMS4yLjkgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pXG52YXIgdG9PYmplY3QgPSByZXF1aXJlKCcuL190by1vYmplY3QnKTtcbnZhciAkZ2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKCcuL19vYmplY3QtZ3BvJyk7XG5cbnJlcXVpcmUoJy4vX29iamVjdC1zYXAnKSgnZ2V0UHJvdG90eXBlT2YnLCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBmdW5jdGlvbiBnZXRQcm90b3R5cGVPZihpdCkge1xuICAgIHJldHVybiAkZ2V0UHJvdG90eXBlT2YodG9PYmplY3QoaXQpKTtcbiAgfTtcbn0pO1xuIiwiLy8gMTkuMS4zLjE5IE9iamVjdC5zZXRQcm90b3R5cGVPZihPLCBwcm90bylcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7XG4kZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHsgc2V0UHJvdG90eXBlT2Y6IHJlcXVpcmUoJy4vX3NldC1wcm90bycpLnNldCB9KTtcbiIsIiIsIid1c2Ugc3RyaWN0JztcbnZhciBMSUJSQVJZID0gcmVxdWlyZSgnLi9fbGlicmFyeScpO1xudmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIGN0eCA9IHJlcXVpcmUoJy4vX2N0eCcpO1xudmFyIGNsYXNzb2YgPSByZXF1aXJlKCcuL19jbGFzc29mJyk7XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7XG52YXIgYUZ1bmN0aW9uID0gcmVxdWlyZSgnLi9fYS1mdW5jdGlvbicpO1xudmFyIGFuSW5zdGFuY2UgPSByZXF1aXJlKCcuL19hbi1pbnN0YW5jZScpO1xudmFyIGZvck9mID0gcmVxdWlyZSgnLi9fZm9yLW9mJyk7XG52YXIgc3BlY2llc0NvbnN0cnVjdG9yID0gcmVxdWlyZSgnLi9fc3BlY2llcy1jb25zdHJ1Y3RvcicpO1xudmFyIHRhc2sgPSByZXF1aXJlKCcuL190YXNrJykuc2V0O1xudmFyIG1pY3JvdGFzayA9IHJlcXVpcmUoJy4vX21pY3JvdGFzaycpKCk7XG52YXIgbmV3UHJvbWlzZUNhcGFiaWxpdHlNb2R1bGUgPSByZXF1aXJlKCcuL19uZXctcHJvbWlzZS1jYXBhYmlsaXR5Jyk7XG52YXIgcGVyZm9ybSA9IHJlcXVpcmUoJy4vX3BlcmZvcm0nKTtcbnZhciB1c2VyQWdlbnQgPSByZXF1aXJlKCcuL191c2VyLWFnZW50Jyk7XG52YXIgcHJvbWlzZVJlc29sdmUgPSByZXF1aXJlKCcuL19wcm9taXNlLXJlc29sdmUnKTtcbnZhciBQUk9NSVNFID0gJ1Byb21pc2UnO1xudmFyIFR5cGVFcnJvciA9IGdsb2JhbC5UeXBlRXJyb3I7XG52YXIgcHJvY2VzcyA9IGdsb2JhbC5wcm9jZXNzO1xudmFyIHZlcnNpb25zID0gcHJvY2VzcyAmJiBwcm9jZXNzLnZlcnNpb25zO1xudmFyIHY4ID0gdmVyc2lvbnMgJiYgdmVyc2lvbnMudjggfHwgJyc7XG52YXIgJFByb21pc2UgPSBnbG9iYWxbUFJPTUlTRV07XG52YXIgaXNOb2RlID0gY2xhc3NvZihwcm9jZXNzKSA9PSAncHJvY2Vzcyc7XG52YXIgZW1wdHkgPSBmdW5jdGlvbiAoKSB7IC8qIGVtcHR5ICovIH07XG52YXIgSW50ZXJuYWwsIG5ld0dlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSwgT3duUHJvbWlzZUNhcGFiaWxpdHksIFdyYXBwZXI7XG52YXIgbmV3UHJvbWlzZUNhcGFiaWxpdHkgPSBuZXdHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eU1vZHVsZS5mO1xuXG52YXIgVVNFX05BVElWRSA9ICEhZnVuY3Rpb24gKCkge1xuICB0cnkge1xuICAgIC8vIGNvcnJlY3Qgc3ViY2xhc3Npbmcgd2l0aCBAQHNwZWNpZXMgc3VwcG9ydFxuICAgIHZhciBwcm9taXNlID0gJFByb21pc2UucmVzb2x2ZSgxKTtcbiAgICB2YXIgRmFrZVByb21pc2UgPSAocHJvbWlzZS5jb25zdHJ1Y3RvciA9IHt9KVtyZXF1aXJlKCcuL193a3MnKSgnc3BlY2llcycpXSA9IGZ1bmN0aW9uIChleGVjKSB7XG4gICAgICBleGVjKGVtcHR5LCBlbXB0eSk7XG4gICAgfTtcbiAgICAvLyB1bmhhbmRsZWQgcmVqZWN0aW9ucyB0cmFja2luZyBzdXBwb3J0LCBOb2RlSlMgUHJvbWlzZSB3aXRob3V0IGl0IGZhaWxzIEBAc3BlY2llcyB0ZXN0XG4gICAgcmV0dXJuIChpc05vZGUgfHwgdHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCA9PSAnZnVuY3Rpb24nKVxuICAgICAgJiYgcHJvbWlzZS50aGVuKGVtcHR5KSBpbnN0YW5jZW9mIEZha2VQcm9taXNlXG4gICAgICAvLyB2OCA2LjYgKE5vZGUgMTAgYW5kIENocm9tZSA2NikgaGF2ZSBhIGJ1ZyB3aXRoIHJlc29sdmluZyBjdXN0b20gdGhlbmFibGVzXG4gICAgICAvLyBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD04MzA1NjVcbiAgICAgIC8vIHdlIGNhbid0IGRldGVjdCBpdCBzeW5jaHJvbm91c2x5LCBzbyBqdXN0IGNoZWNrIHZlcnNpb25zXG4gICAgICAmJiB2OC5pbmRleE9mKCc2LjYnKSAhPT0gMFxuICAgICAgJiYgdXNlckFnZW50LmluZGV4T2YoJ0Nocm9tZS82NicpID09PSAtMTtcbiAgfSBjYXRjaCAoZSkgeyAvKiBlbXB0eSAqLyB9XG59KCk7XG5cbi8vIGhlbHBlcnNcbnZhciBpc1RoZW5hYmxlID0gZnVuY3Rpb24gKGl0KSB7XG4gIHZhciB0aGVuO1xuICByZXR1cm4gaXNPYmplY3QoaXQpICYmIHR5cGVvZiAodGhlbiA9IGl0LnRoZW4pID09ICdmdW5jdGlvbicgPyB0aGVuIDogZmFsc2U7XG59O1xudmFyIG5vdGlmeSA9IGZ1bmN0aW9uIChwcm9taXNlLCBpc1JlamVjdCkge1xuICBpZiAocHJvbWlzZS5fbikgcmV0dXJuO1xuICBwcm9taXNlLl9uID0gdHJ1ZTtcbiAgdmFyIGNoYWluID0gcHJvbWlzZS5fYztcbiAgbWljcm90YXNrKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmFsdWUgPSBwcm9taXNlLl92O1xuICAgIHZhciBvayA9IHByb21pc2UuX3MgPT0gMTtcbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIHJ1biA9IGZ1bmN0aW9uIChyZWFjdGlvbikge1xuICAgICAgdmFyIGhhbmRsZXIgPSBvayA/IHJlYWN0aW9uLm9rIDogcmVhY3Rpb24uZmFpbDtcbiAgICAgIHZhciByZXNvbHZlID0gcmVhY3Rpb24ucmVzb2x2ZTtcbiAgICAgIHZhciByZWplY3QgPSByZWFjdGlvbi5yZWplY3Q7XG4gICAgICB2YXIgZG9tYWluID0gcmVhY3Rpb24uZG9tYWluO1xuICAgICAgdmFyIHJlc3VsdCwgdGhlbiwgZXhpdGVkO1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgICAgICBpZiAoIW9rKSB7XG4gICAgICAgICAgICBpZiAocHJvbWlzZS5faCA9PSAyKSBvbkhhbmRsZVVuaGFuZGxlZChwcm9taXNlKTtcbiAgICAgICAgICAgIHByb21pc2UuX2ggPSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaGFuZGxlciA9PT0gdHJ1ZSkgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoZG9tYWluKSBkb21haW4uZW50ZXIoKTtcbiAgICAgICAgICAgIHJlc3VsdCA9IGhhbmRsZXIodmFsdWUpOyAvLyBtYXkgdGhyb3dcbiAgICAgICAgICAgIGlmIChkb21haW4pIHtcbiAgICAgICAgICAgICAgZG9tYWluLmV4aXQoKTtcbiAgICAgICAgICAgICAgZXhpdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHJlc3VsdCA9PT0gcmVhY3Rpb24ucHJvbWlzZSkge1xuICAgICAgICAgICAgcmVqZWN0KFR5cGVFcnJvcignUHJvbWlzZS1jaGFpbiBjeWNsZScpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHRoZW4gPSBpc1RoZW5hYmxlKHJlc3VsdCkpIHtcbiAgICAgICAgICAgIHRoZW4uY2FsbChyZXN1bHQsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSBlbHNlIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgfSBlbHNlIHJlamVjdCh2YWx1ZSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGlmIChkb21haW4gJiYgIWV4aXRlZCkgZG9tYWluLmV4aXQoKTtcbiAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgfVxuICAgIH07XG4gICAgd2hpbGUgKGNoYWluLmxlbmd0aCA+IGkpIHJ1bihjaGFpbltpKytdKTsgLy8gdmFyaWFibGUgbGVuZ3RoIC0gY2FuJ3QgdXNlIGZvckVhY2hcbiAgICBwcm9taXNlLl9jID0gW107XG4gICAgcHJvbWlzZS5fbiA9IGZhbHNlO1xuICAgIGlmIChpc1JlamVjdCAmJiAhcHJvbWlzZS5faCkgb25VbmhhbmRsZWQocHJvbWlzZSk7XG4gIH0pO1xufTtcbnZhciBvblVuaGFuZGxlZCA9IGZ1bmN0aW9uIChwcm9taXNlKSB7XG4gIHRhc2suY2FsbChnbG9iYWwsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmFsdWUgPSBwcm9taXNlLl92O1xuICAgIHZhciB1bmhhbmRsZWQgPSBpc1VuaGFuZGxlZChwcm9taXNlKTtcbiAgICB2YXIgcmVzdWx0LCBoYW5kbGVyLCBjb25zb2xlO1xuICAgIGlmICh1bmhhbmRsZWQpIHtcbiAgICAgIHJlc3VsdCA9IHBlcmZvcm0oZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoaXNOb2RlKSB7XG4gICAgICAgICAgcHJvY2Vzcy5lbWl0KCd1bmhhbmRsZWRSZWplY3Rpb24nLCB2YWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoaGFuZGxlciA9IGdsb2JhbC5vbnVuaGFuZGxlZHJlamVjdGlvbikge1xuICAgICAgICAgIGhhbmRsZXIoeyBwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHZhbHVlIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKChjb25zb2xlID0gZ2xvYmFsLmNvbnNvbGUpICYmIGNvbnNvbGUuZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdVbmhhbmRsZWQgcHJvbWlzZSByZWplY3Rpb24nLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgLy8gQnJvd3NlcnMgc2hvdWxkIG5vdCB0cmlnZ2VyIGByZWplY3Rpb25IYW5kbGVkYCBldmVudCBpZiBpdCB3YXMgaGFuZGxlZCBoZXJlLCBOb2RlSlMgLSBzaG91bGRcbiAgICAgIHByb21pc2UuX2ggPSBpc05vZGUgfHwgaXNVbmhhbmRsZWQocHJvbWlzZSkgPyAyIDogMTtcbiAgICB9IHByb21pc2UuX2EgPSB1bmRlZmluZWQ7XG4gICAgaWYgKHVuaGFuZGxlZCAmJiByZXN1bHQuZSkgdGhyb3cgcmVzdWx0LnY7XG4gIH0pO1xufTtcbnZhciBpc1VuaGFuZGxlZCA9IGZ1bmN0aW9uIChwcm9taXNlKSB7XG4gIHJldHVybiBwcm9taXNlLl9oICE9PSAxICYmIChwcm9taXNlLl9hIHx8IHByb21pc2UuX2MpLmxlbmd0aCA9PT0gMDtcbn07XG52YXIgb25IYW5kbGVVbmhhbmRsZWQgPSBmdW5jdGlvbiAocHJvbWlzZSkge1xuICB0YXNrLmNhbGwoZ2xvYmFsLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGhhbmRsZXI7XG4gICAgaWYgKGlzTm9kZSkge1xuICAgICAgcHJvY2Vzcy5lbWl0KCdyZWplY3Rpb25IYW5kbGVkJywgcHJvbWlzZSk7XG4gICAgfSBlbHNlIGlmIChoYW5kbGVyID0gZ2xvYmFsLm9ucmVqZWN0aW9uaGFuZGxlZCkge1xuICAgICAgaGFuZGxlcih7IHByb21pc2U6IHByb21pc2UsIHJlYXNvbjogcHJvbWlzZS5fdiB9KTtcbiAgICB9XG4gIH0pO1xufTtcbnZhciAkcmVqZWN0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gIHZhciBwcm9taXNlID0gdGhpcztcbiAgaWYgKHByb21pc2UuX2QpIHJldHVybjtcbiAgcHJvbWlzZS5fZCA9IHRydWU7XG4gIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcFxuICBwcm9taXNlLl92ID0gdmFsdWU7XG4gIHByb21pc2UuX3MgPSAyO1xuICBpZiAoIXByb21pc2UuX2EpIHByb21pc2UuX2EgPSBwcm9taXNlLl9jLnNsaWNlKCk7XG4gIG5vdGlmeShwcm9taXNlLCB0cnVlKTtcbn07XG52YXIgJHJlc29sdmUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgdmFyIHByb21pc2UgPSB0aGlzO1xuICB2YXIgdGhlbjtcbiAgaWYgKHByb21pc2UuX2QpIHJldHVybjtcbiAgcHJvbWlzZS5fZCA9IHRydWU7XG4gIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcFxuICB0cnkge1xuICAgIGlmIChwcm9taXNlID09PSB2YWx1ZSkgdGhyb3cgVHlwZUVycm9yKFwiUHJvbWlzZSBjYW4ndCBiZSByZXNvbHZlZCBpdHNlbGZcIik7XG4gICAgaWYgKHRoZW4gPSBpc1RoZW5hYmxlKHZhbHVlKSkge1xuICAgICAgbWljcm90YXNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHdyYXBwZXIgPSB7IF93OiBwcm9taXNlLCBfZDogZmFsc2UgfTsgLy8gd3JhcFxuICAgICAgICB0cnkge1xuICAgICAgICAgIHRoZW4uY2FsbCh2YWx1ZSwgY3R4KCRyZXNvbHZlLCB3cmFwcGVyLCAxKSwgY3R4KCRyZWplY3QsIHdyYXBwZXIsIDEpKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICRyZWplY3QuY2FsbCh3cmFwcGVyLCBlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByb21pc2UuX3YgPSB2YWx1ZTtcbiAgICAgIHByb21pc2UuX3MgPSAxO1xuICAgICAgbm90aWZ5KHByb21pc2UsIGZhbHNlKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAkcmVqZWN0LmNhbGwoeyBfdzogcHJvbWlzZSwgX2Q6IGZhbHNlIH0sIGUpOyAvLyB3cmFwXG4gIH1cbn07XG5cbi8vIGNvbnN0cnVjdG9yIHBvbHlmaWxsXG5pZiAoIVVTRV9OQVRJVkUpIHtcbiAgLy8gMjUuNC4zLjEgUHJvbWlzZShleGVjdXRvcilcbiAgJFByb21pc2UgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKSB7XG4gICAgYW5JbnN0YW5jZSh0aGlzLCAkUHJvbWlzZSwgUFJPTUlTRSwgJ19oJyk7XG4gICAgYUZ1bmN0aW9uKGV4ZWN1dG9yKTtcbiAgICBJbnRlcm5hbC5jYWxsKHRoaXMpO1xuICAgIHRyeSB7XG4gICAgICBleGVjdXRvcihjdHgoJHJlc29sdmUsIHRoaXMsIDEpLCBjdHgoJHJlamVjdCwgdGhpcywgMSkpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgJHJlamVjdC5jYWxsKHRoaXMsIGVycik7XG4gICAgfVxuICB9O1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgSW50ZXJuYWwgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKSB7XG4gICAgdGhpcy5fYyA9IFtdOyAgICAgICAgICAgICAvLyA8LSBhd2FpdGluZyByZWFjdGlvbnNcbiAgICB0aGlzLl9hID0gdW5kZWZpbmVkOyAgICAgIC8vIDwtIGNoZWNrZWQgaW4gaXNVbmhhbmRsZWQgcmVhY3Rpb25zXG4gICAgdGhpcy5fcyA9IDA7ICAgICAgICAgICAgICAvLyA8LSBzdGF0ZVxuICAgIHRoaXMuX2QgPSBmYWxzZTsgICAgICAgICAgLy8gPC0gZG9uZVxuICAgIHRoaXMuX3YgPSB1bmRlZmluZWQ7ICAgICAgLy8gPC0gdmFsdWVcbiAgICB0aGlzLl9oID0gMDsgICAgICAgICAgICAgIC8vIDwtIHJlamVjdGlvbiBzdGF0ZSwgMCAtIGRlZmF1bHQsIDEgLSBoYW5kbGVkLCAyIC0gdW5oYW5kbGVkXG4gICAgdGhpcy5fbiA9IGZhbHNlOyAgICAgICAgICAvLyA8LSBub3RpZnlcbiAgfTtcbiAgSW50ZXJuYWwucHJvdG90eXBlID0gcmVxdWlyZSgnLi9fcmVkZWZpbmUtYWxsJykoJFByb21pc2UucHJvdG90eXBlLCB7XG4gICAgLy8gMjUuNC41LjMgUHJvbWlzZS5wcm90b3R5cGUudGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZClcbiAgICB0aGVuOiBmdW5jdGlvbiB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7XG4gICAgICB2YXIgcmVhY3Rpb24gPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShzcGVjaWVzQ29uc3RydWN0b3IodGhpcywgJFByb21pc2UpKTtcbiAgICAgIHJlYWN0aW9uLm9rID0gdHlwZW9mIG9uRnVsZmlsbGVkID09ICdmdW5jdGlvbicgPyBvbkZ1bGZpbGxlZCA6IHRydWU7XG4gICAgICByZWFjdGlvbi5mYWlsID0gdHlwZW9mIG9uUmVqZWN0ZWQgPT0gJ2Z1bmN0aW9uJyAmJiBvblJlamVjdGVkO1xuICAgICAgcmVhY3Rpb24uZG9tYWluID0gaXNOb2RlID8gcHJvY2Vzcy5kb21haW4gOiB1bmRlZmluZWQ7XG4gICAgICB0aGlzLl9jLnB1c2gocmVhY3Rpb24pO1xuICAgICAgaWYgKHRoaXMuX2EpIHRoaXMuX2EucHVzaChyZWFjdGlvbik7XG4gICAgICBpZiAodGhpcy5fcykgbm90aWZ5KHRoaXMsIGZhbHNlKTtcbiAgICAgIHJldHVybiByZWFjdGlvbi5wcm9taXNlO1xuICAgIH0sXG4gICAgLy8gMjUuNC41LjEgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2gob25SZWplY3RlZClcbiAgICAnY2F0Y2gnOiBmdW5jdGlvbiAob25SZWplY3RlZCkge1xuICAgICAgcmV0dXJuIHRoaXMudGhlbih1bmRlZmluZWQsIG9uUmVqZWN0ZWQpO1xuICAgIH1cbiAgfSk7XG4gIE93blByb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBwcm9taXNlID0gbmV3IEludGVybmFsKCk7XG4gICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTtcbiAgICB0aGlzLnJlc29sdmUgPSBjdHgoJHJlc29sdmUsIHByb21pc2UsIDEpO1xuICAgIHRoaXMucmVqZWN0ID0gY3R4KCRyZWplY3QsIHByb21pc2UsIDEpO1xuICB9O1xuICBuZXdQcm9taXNlQ2FwYWJpbGl0eU1vZHVsZS5mID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbiAoQykge1xuICAgIHJldHVybiBDID09PSAkUHJvbWlzZSB8fCBDID09PSBXcmFwcGVyXG4gICAgICA/IG5ldyBPd25Qcm9taXNlQ2FwYWJpbGl0eShDKVxuICAgICAgOiBuZXdHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkoQyk7XG4gIH07XG59XG5cbiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHsgUHJvbWlzZTogJFByb21pc2UgfSk7XG5yZXF1aXJlKCcuL19zZXQtdG8tc3RyaW5nLXRhZycpKCRQcm9taXNlLCBQUk9NSVNFKTtcbnJlcXVpcmUoJy4vX3NldC1zcGVjaWVzJykoUFJPTUlTRSk7XG5XcmFwcGVyID0gcmVxdWlyZSgnLi9fY29yZScpW1BST01JU0VdO1xuXG4vLyBzdGF0aWNzXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCBQUk9NSVNFLCB7XG4gIC8vIDI1LjQuNC41IFByb21pc2UucmVqZWN0KHIpXG4gIHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KHIpIHtcbiAgICB2YXIgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KHRoaXMpO1xuICAgIHZhciAkJHJlamVjdCA9IGNhcGFiaWxpdHkucmVqZWN0O1xuICAgICQkcmVqZWN0KHIpO1xuICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7XG4gIH1cbn0pO1xuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoTElCUkFSWSB8fCAhVVNFX05BVElWRSksIFBST01JU0UsIHtcbiAgLy8gMjUuNC40LjYgUHJvbWlzZS5yZXNvbHZlKHgpXG4gIHJlc29sdmU6IGZ1bmN0aW9uIHJlc29sdmUoeCkge1xuICAgIHJldHVybiBwcm9taXNlUmVzb2x2ZShMSUJSQVJZICYmIHRoaXMgPT09IFdyYXBwZXIgPyAkUHJvbWlzZSA6IHRoaXMsIHgpO1xuICB9XG59KTtcbiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIShVU0VfTkFUSVZFICYmIHJlcXVpcmUoJy4vX2l0ZXItZGV0ZWN0JykoZnVuY3Rpb24gKGl0ZXIpIHtcbiAgJFByb21pc2UuYWxsKGl0ZXIpWydjYXRjaCddKGVtcHR5KTtcbn0pKSwgUFJPTUlTRSwge1xuICAvLyAyNS40LjQuMSBQcm9taXNlLmFsbChpdGVyYWJsZSlcbiAgYWxsOiBmdW5jdGlvbiBhbGwoaXRlcmFibGUpIHtcbiAgICB2YXIgQyA9IHRoaXM7XG4gICAgdmFyIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKTtcbiAgICB2YXIgcmVzb2x2ZSA9IGNhcGFiaWxpdHkucmVzb2x2ZTtcbiAgICB2YXIgcmVqZWN0ID0gY2FwYWJpbGl0eS5yZWplY3Q7XG4gICAgdmFyIHJlc3VsdCA9IHBlcmZvcm0oZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHZhbHVlcyA9IFtdO1xuICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgIHZhciByZW1haW5pbmcgPSAxO1xuICAgICAgZm9yT2YoaXRlcmFibGUsIGZhbHNlLCBmdW5jdGlvbiAocHJvbWlzZSkge1xuICAgICAgICB2YXIgJGluZGV4ID0gaW5kZXgrKztcbiAgICAgICAgdmFyIGFscmVhZHlDYWxsZWQgPSBmYWxzZTtcbiAgICAgICAgdmFsdWVzLnB1c2godW5kZWZpbmVkKTtcbiAgICAgICAgcmVtYWluaW5nKys7XG4gICAgICAgIEMucmVzb2x2ZShwcm9taXNlKS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgIGlmIChhbHJlYWR5Q2FsbGVkKSByZXR1cm47XG4gICAgICAgICAgYWxyZWFkeUNhbGxlZCA9IHRydWU7XG4gICAgICAgICAgdmFsdWVzWyRpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgICAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7XG4gICAgICAgIH0sIHJlamVjdCk7XG4gICAgICB9KTtcbiAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTtcbiAgICB9KTtcbiAgICBpZiAocmVzdWx0LmUpIHJlamVjdChyZXN1bHQudik7XG4gICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTtcbiAgfSxcbiAgLy8gMjUuNC40LjQgUHJvbWlzZS5yYWNlKGl0ZXJhYmxlKVxuICByYWNlOiBmdW5jdGlvbiByYWNlKGl0ZXJhYmxlKSB7XG4gICAgdmFyIEMgPSB0aGlzO1xuICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQyk7XG4gICAgdmFyIHJlamVjdCA9IGNhcGFiaWxpdHkucmVqZWN0O1xuICAgIHZhciByZXN1bHQgPSBwZXJmb3JtKGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24gKHByb21pc2UpIHtcbiAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oY2FwYWJpbGl0eS5yZXNvbHZlLCByZWplY3QpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgaWYgKHJlc3VsdC5lKSByZWplY3QocmVzdWx0LnYpO1xuICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7XG4gIH1cbn0pO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyICRhdCA9IHJlcXVpcmUoJy4vX3N0cmluZy1hdCcpKHRydWUpO1xuXG4vLyAyMS4xLjMuMjcgU3RyaW5nLnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpXG5yZXF1aXJlKCcuL19pdGVyLWRlZmluZScpKFN0cmluZywgJ1N0cmluZycsIGZ1bmN0aW9uIChpdGVyYXRlZCkge1xuICB0aGlzLl90ID0gU3RyaW5nKGl0ZXJhdGVkKTsgLy8gdGFyZ2V0XG4gIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4XG4vLyAyMS4xLjUuMi4xICVTdHJpbmdJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpXG59LCBmdW5jdGlvbiAoKSB7XG4gIHZhciBPID0gdGhpcy5fdDtcbiAgdmFyIGluZGV4ID0gdGhpcy5faTtcbiAgdmFyIHBvaW50O1xuICBpZiAoaW5kZXggPj0gTy5sZW5ndGgpIHJldHVybiB7IHZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWUgfTtcbiAgcG9pbnQgPSAkYXQoTywgaW5kZXgpO1xuICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDtcbiAgcmV0dXJuIHsgdmFsdWU6IHBvaW50LCBkb25lOiBmYWxzZSB9O1xufSk7XG4iLCIndXNlIHN0cmljdCc7XG4vLyBFQ01BU2NyaXB0IDYgc3ltYm9scyBzaGltXG52YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJyk7XG52YXIgaGFzID0gcmVxdWlyZSgnLi9faGFzJyk7XG52YXIgREVTQ1JJUFRPUlMgPSByZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciByZWRlZmluZSA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lJyk7XG52YXIgTUVUQSA9IHJlcXVpcmUoJy4vX21ldGEnKS5LRVk7XG52YXIgJGZhaWxzID0gcmVxdWlyZSgnLi9fZmFpbHMnKTtcbnZhciBzaGFyZWQgPSByZXF1aXJlKCcuL19zaGFyZWQnKTtcbnZhciBzZXRUb1N0cmluZ1RhZyA9IHJlcXVpcmUoJy4vX3NldC10by1zdHJpbmctdGFnJyk7XG52YXIgdWlkID0gcmVxdWlyZSgnLi9fdWlkJyk7XG52YXIgd2tzID0gcmVxdWlyZSgnLi9fd2tzJyk7XG52YXIgd2tzRXh0ID0gcmVxdWlyZSgnLi9fd2tzLWV4dCcpO1xudmFyIHdrc0RlZmluZSA9IHJlcXVpcmUoJy4vX3drcy1kZWZpbmUnKTtcbnZhciBlbnVtS2V5cyA9IHJlcXVpcmUoJy4vX2VudW0ta2V5cycpO1xudmFyIGlzQXJyYXkgPSByZXF1aXJlKCcuL19pcy1hcnJheScpO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7XG52YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKTtcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpO1xudmFyIHRvSU9iamVjdCA9IHJlcXVpcmUoJy4vX3RvLWlvYmplY3QnKTtcbnZhciB0b1ByaW1pdGl2ZSA9IHJlcXVpcmUoJy4vX3RvLXByaW1pdGl2ZScpO1xudmFyIGNyZWF0ZURlc2MgPSByZXF1aXJlKCcuL19wcm9wZXJ0eS1kZXNjJyk7XG52YXIgX2NyZWF0ZSA9IHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKTtcbnZhciBnT1BORXh0ID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcG4tZXh0Jyk7XG52YXIgJEdPUEQgPSByZXF1aXJlKCcuL19vYmplY3QtZ29wZCcpO1xudmFyICRHT1BTID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcHMnKTtcbnZhciAkRFAgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKTtcbnZhciAka2V5cyA9IHJlcXVpcmUoJy4vX29iamVjdC1rZXlzJyk7XG52YXIgZ09QRCA9ICRHT1BELmY7XG52YXIgZFAgPSAkRFAuZjtcbnZhciBnT1BOID0gZ09QTkV4dC5mO1xudmFyICRTeW1ib2wgPSBnbG9iYWwuU3ltYm9sO1xudmFyICRKU09OID0gZ2xvYmFsLkpTT047XG52YXIgX3N0cmluZ2lmeSA9ICRKU09OICYmICRKU09OLnN0cmluZ2lmeTtcbnZhciBQUk9UT1RZUEUgPSAncHJvdG90eXBlJztcbnZhciBISURERU4gPSB3a3MoJ19oaWRkZW4nKTtcbnZhciBUT19QUklNSVRJVkUgPSB3a3MoJ3RvUHJpbWl0aXZlJyk7XG52YXIgaXNFbnVtID0ge30ucHJvcGVydHlJc0VudW1lcmFibGU7XG52YXIgU3ltYm9sUmVnaXN0cnkgPSBzaGFyZWQoJ3N5bWJvbC1yZWdpc3RyeScpO1xudmFyIEFsbFN5bWJvbHMgPSBzaGFyZWQoJ3N5bWJvbHMnKTtcbnZhciBPUFN5bWJvbHMgPSBzaGFyZWQoJ29wLXN5bWJvbHMnKTtcbnZhciBPYmplY3RQcm90byA9IE9iamVjdFtQUk9UT1RZUEVdO1xudmFyIFVTRV9OQVRJVkUgPSB0eXBlb2YgJFN5bWJvbCA9PSAnZnVuY3Rpb24nICYmICEhJEdPUFMuZjtcbnZhciBRT2JqZWN0ID0gZ2xvYmFsLlFPYmplY3Q7XG4vLyBEb24ndCB1c2Ugc2V0dGVycyBpbiBRdCBTY3JpcHQsIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy8xNzNcbnZhciBzZXR0ZXIgPSAhUU9iamVjdCB8fCAhUU9iamVjdFtQUk9UT1RZUEVdIHx8ICFRT2JqZWN0W1BST1RPVFlQRV0uZmluZENoaWxkO1xuXG4vLyBmYWxsYmFjayBmb3Igb2xkIEFuZHJvaWQsIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD02ODdcbnZhciBzZXRTeW1ib2xEZXNjID0gREVTQ1JJUFRPUlMgJiYgJGZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIF9jcmVhdGUoZFAoe30sICdhJywge1xuICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gZFAodGhpcywgJ2EnLCB7IHZhbHVlOiA3IH0pLmE7IH1cbiAgfSkpLmEgIT0gNztcbn0pID8gZnVuY3Rpb24gKGl0LCBrZXksIEQpIHtcbiAgdmFyIHByb3RvRGVzYyA9IGdPUEQoT2JqZWN0UHJvdG8sIGtleSk7XG4gIGlmIChwcm90b0Rlc2MpIGRlbGV0ZSBPYmplY3RQcm90b1trZXldO1xuICBkUChpdCwga2V5LCBEKTtcbiAgaWYgKHByb3RvRGVzYyAmJiBpdCAhPT0gT2JqZWN0UHJvdG8pIGRQKE9iamVjdFByb3RvLCBrZXksIHByb3RvRGVzYyk7XG59IDogZFA7XG5cbnZhciB3cmFwID0gZnVuY3Rpb24gKHRhZykge1xuICB2YXIgc3ltID0gQWxsU3ltYm9sc1t0YWddID0gX2NyZWF0ZSgkU3ltYm9sW1BST1RPVFlQRV0pO1xuICBzeW0uX2sgPSB0YWc7XG4gIHJldHVybiBzeW07XG59O1xuXG52YXIgaXNTeW1ib2wgPSBVU0VfTkFUSVZFICYmIHR5cGVvZiAkU3ltYm9sLml0ZXJhdG9yID09ICdzeW1ib2wnID8gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCc7XG59IDogZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBpdCBpbnN0YW5jZW9mICRTeW1ib2w7XG59O1xuXG52YXIgJGRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgRCkge1xuICBpZiAoaXQgPT09IE9iamVjdFByb3RvKSAkZGVmaW5lUHJvcGVydHkoT1BTeW1ib2xzLCBrZXksIEQpO1xuICBhbk9iamVjdChpdCk7XG4gIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7XG4gIGFuT2JqZWN0KEQpO1xuICBpZiAoaGFzKEFsbFN5bWJvbHMsIGtleSkpIHtcbiAgICBpZiAoIUQuZW51bWVyYWJsZSkge1xuICAgICAgaWYgKCFoYXMoaXQsIEhJRERFTikpIGRQKGl0LCBISURERU4sIGNyZWF0ZURlc2MoMSwge30pKTtcbiAgICAgIGl0W0hJRERFTl1ba2V5XSA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChoYXMoaXQsIEhJRERFTikgJiYgaXRbSElEREVOXVtrZXldKSBpdFtISURERU5dW2tleV0gPSBmYWxzZTtcbiAgICAgIEQgPSBfY3JlYXRlKEQsIHsgZW51bWVyYWJsZTogY3JlYXRlRGVzYygwLCBmYWxzZSkgfSk7XG4gICAgfSByZXR1cm4gc2V0U3ltYm9sRGVzYyhpdCwga2V5LCBEKTtcbiAgfSByZXR1cm4gZFAoaXQsIGtleSwgRCk7XG59O1xudmFyICRkZWZpbmVQcm9wZXJ0aWVzID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyhpdCwgUCkge1xuICBhbk9iamVjdChpdCk7XG4gIHZhciBrZXlzID0gZW51bUtleXMoUCA9IHRvSU9iamVjdChQKSk7XG4gIHZhciBpID0gMDtcbiAgdmFyIGwgPSBrZXlzLmxlbmd0aDtcbiAgdmFyIGtleTtcbiAgd2hpbGUgKGwgPiBpKSAkZGVmaW5lUHJvcGVydHkoaXQsIGtleSA9IGtleXNbaSsrXSwgUFtrZXldKTtcbiAgcmV0dXJuIGl0O1xufTtcbnZhciAkY3JlYXRlID0gZnVuY3Rpb24gY3JlYXRlKGl0LCBQKSB7XG4gIHJldHVybiBQID09PSB1bmRlZmluZWQgPyBfY3JlYXRlKGl0KSA6ICRkZWZpbmVQcm9wZXJ0aWVzKF9jcmVhdGUoaXQpLCBQKTtcbn07XG52YXIgJHByb3BlcnR5SXNFbnVtZXJhYmxlID0gZnVuY3Rpb24gcHJvcGVydHlJc0VudW1lcmFibGUoa2V5KSB7XG4gIHZhciBFID0gaXNFbnVtLmNhbGwodGhpcywga2V5ID0gdG9QcmltaXRpdmUoa2V5LCB0cnVlKSk7XG4gIGlmICh0aGlzID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSkgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gRSB8fCAhaGFzKHRoaXMsIGtleSkgfHwgIWhhcyhBbGxTeW1ib2xzLCBrZXkpIHx8IGhhcyh0aGlzLCBISURERU4pICYmIHRoaXNbSElEREVOXVtrZXldID8gRSA6IHRydWU7XG59O1xudmFyICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSkge1xuICBpdCA9IHRvSU9iamVjdChpdCk7XG4gIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7XG4gIGlmIChpdCA9PT0gT2JqZWN0UHJvdG8gJiYgaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIWhhcyhPUFN5bWJvbHMsIGtleSkpIHJldHVybjtcbiAgdmFyIEQgPSBnT1BEKGl0LCBrZXkpO1xuICBpZiAoRCAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pKSBELmVudW1lcmFibGUgPSB0cnVlO1xuICByZXR1cm4gRDtcbn07XG52YXIgJGdldE93blByb3BlcnR5TmFtZXMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKGl0KSB7XG4gIHZhciBuYW1lcyA9IGdPUE4odG9JT2JqZWN0KGl0KSk7XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgdmFyIGkgPSAwO1xuICB2YXIga2V5O1xuICB3aGlsZSAobmFtZXMubGVuZ3RoID4gaSkge1xuICAgIGlmICghaGFzKEFsbFN5bWJvbHMsIGtleSA9IG5hbWVzW2krK10pICYmIGtleSAhPSBISURERU4gJiYga2V5ICE9IE1FVEEpIHJlc3VsdC5wdXNoKGtleSk7XG4gIH0gcmV0dXJuIHJlc3VsdDtcbn07XG52YXIgJGdldE93blByb3BlcnR5U3ltYm9scyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5U3ltYm9scyhpdCkge1xuICB2YXIgSVNfT1AgPSBpdCA9PT0gT2JqZWN0UHJvdG87XG4gIHZhciBuYW1lcyA9IGdPUE4oSVNfT1AgPyBPUFN5bWJvbHMgOiB0b0lPYmplY3QoaXQpKTtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICB2YXIgaSA9IDA7XG4gIHZhciBrZXk7XG4gIHdoaWxlIChuYW1lcy5sZW5ndGggPiBpKSB7XG4gICAgaWYgKGhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiAoSVNfT1AgPyBoYXMoT2JqZWN0UHJvdG8sIGtleSkgOiB0cnVlKSkgcmVzdWx0LnB1c2goQWxsU3ltYm9sc1trZXldKTtcbiAgfSByZXR1cm4gcmVzdWx0O1xufTtcblxuLy8gMTkuNC4xLjEgU3ltYm9sKFtkZXNjcmlwdGlvbl0pXG5pZiAoIVVTRV9OQVRJVkUpIHtcbiAgJFN5bWJvbCA9IGZ1bmN0aW9uIFN5bWJvbCgpIHtcbiAgICBpZiAodGhpcyBpbnN0YW5jZW9mICRTeW1ib2wpIHRocm93IFR5cGVFcnJvcignU3ltYm9sIGlzIG5vdCBhIGNvbnN0cnVjdG9yIScpO1xuICAgIHZhciB0YWcgPSB1aWQoYXJndW1lbnRzLmxlbmd0aCA+IDAgPyBhcmd1bWVudHNbMF0gOiB1bmRlZmluZWQpO1xuICAgIHZhciAkc2V0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICBpZiAodGhpcyA9PT0gT2JqZWN0UHJvdG8pICRzZXQuY2FsbChPUFN5bWJvbHMsIHZhbHVlKTtcbiAgICAgIGlmIChoYXModGhpcywgSElEREVOKSAmJiBoYXModGhpc1tISURERU5dLCB0YWcpKSB0aGlzW0hJRERFTl1bdGFnXSA9IGZhbHNlO1xuICAgICAgc2V0U3ltYm9sRGVzYyh0aGlzLCB0YWcsIGNyZWF0ZURlc2MoMSwgdmFsdWUpKTtcbiAgICB9O1xuICAgIGlmIChERVNDUklQVE9SUyAmJiBzZXR0ZXIpIHNldFN5bWJvbERlc2MoT2JqZWN0UHJvdG8sIHRhZywgeyBjb25maWd1cmFibGU6IHRydWUsIHNldDogJHNldCB9KTtcbiAgICByZXR1cm4gd3JhcCh0YWcpO1xuICB9O1xuICByZWRlZmluZSgkU3ltYm9sW1BST1RPVFlQRV0sICd0b1N0cmluZycsIGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiB0aGlzLl9rO1xuICB9KTtcblxuICAkR09QRC5mID0gJGdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcbiAgJERQLmYgPSAkZGVmaW5lUHJvcGVydHk7XG4gIHJlcXVpcmUoJy4vX29iamVjdC1nb3BuJykuZiA9IGdPUE5FeHQuZiA9ICRnZXRPd25Qcm9wZXJ0eU5hbWVzO1xuICByZXF1aXJlKCcuL19vYmplY3QtcGllJykuZiA9ICRwcm9wZXJ0eUlzRW51bWVyYWJsZTtcbiAgJEdPUFMuZiA9ICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG5cbiAgaWYgKERFU0NSSVBUT1JTICYmICFyZXF1aXJlKCcuL19saWJyYXJ5JykpIHtcbiAgICByZWRlZmluZShPYmplY3RQcm90bywgJ3Byb3BlcnR5SXNFbnVtZXJhYmxlJywgJHByb3BlcnR5SXNFbnVtZXJhYmxlLCB0cnVlKTtcbiAgfVxuXG4gIHdrc0V4dC5mID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICByZXR1cm4gd3JhcCh3a3MobmFtZSkpO1xuICB9O1xufVxuXG4kZXhwb3J0KCRleHBvcnQuRyArICRleHBvcnQuVyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCB7IFN5bWJvbDogJFN5bWJvbCB9KTtcblxuZm9yICh2YXIgZXM2U3ltYm9scyA9IChcbiAgLy8gMTkuNC4yLjIsIDE5LjQuMi4zLCAxOS40LjIuNCwgMTkuNC4yLjYsIDE5LjQuMi44LCAxOS40LjIuOSwgMTkuNC4yLjEwLCAxOS40LjIuMTEsIDE5LjQuMi4xMiwgMTkuNC4yLjEzLCAxOS40LjIuMTRcbiAgJ2hhc0luc3RhbmNlLGlzQ29uY2F0U3ByZWFkYWJsZSxpdGVyYXRvcixtYXRjaCxyZXBsYWNlLHNlYXJjaCxzcGVjaWVzLHNwbGl0LHRvUHJpbWl0aXZlLHRvU3RyaW5nVGFnLHVuc2NvcGFibGVzJ1xuKS5zcGxpdCgnLCcpLCBqID0gMDsgZXM2U3ltYm9scy5sZW5ndGggPiBqOyl3a3MoZXM2U3ltYm9sc1tqKytdKTtcblxuZm9yICh2YXIgd2VsbEtub3duU3ltYm9scyA9ICRrZXlzKHdrcy5zdG9yZSksIGsgPSAwOyB3ZWxsS25vd25TeW1ib2xzLmxlbmd0aCA+IGs7KSB3a3NEZWZpbmUod2VsbEtub3duU3ltYm9sc1trKytdKTtcblxuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwgJ1N5bWJvbCcsIHtcbiAgLy8gMTkuNC4yLjEgU3ltYm9sLmZvcihrZXkpXG4gICdmb3InOiBmdW5jdGlvbiAoa2V5KSB7XG4gICAgcmV0dXJuIGhhcyhTeW1ib2xSZWdpc3RyeSwga2V5ICs9ICcnKVxuICAgICAgPyBTeW1ib2xSZWdpc3RyeVtrZXldXG4gICAgICA6IFN5bWJvbFJlZ2lzdHJ5W2tleV0gPSAkU3ltYm9sKGtleSk7XG4gIH0sXG4gIC8vIDE5LjQuMi41IFN5bWJvbC5rZXlGb3Ioc3ltKVxuICBrZXlGb3I6IGZ1bmN0aW9uIGtleUZvcihzeW0pIHtcbiAgICBpZiAoIWlzU3ltYm9sKHN5bSkpIHRocm93IFR5cGVFcnJvcihzeW0gKyAnIGlzIG5vdCBhIHN5bWJvbCEnKTtcbiAgICBmb3IgKHZhciBrZXkgaW4gU3ltYm9sUmVnaXN0cnkpIGlmIChTeW1ib2xSZWdpc3RyeVtrZXldID09PSBzeW0pIHJldHVybiBrZXk7XG4gIH0sXG4gIHVzZVNldHRlcjogZnVuY3Rpb24gKCkgeyBzZXR0ZXIgPSB0cnVlOyB9LFxuICB1c2VTaW1wbGU6IGZ1bmN0aW9uICgpIHsgc2V0dGVyID0gZmFsc2U7IH1cbn0pO1xuXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCAnT2JqZWN0Jywge1xuICAvLyAxOS4xLjIuMiBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pXG4gIGNyZWF0ZTogJGNyZWF0ZSxcbiAgLy8gMTkuMS4yLjQgT2JqZWN0LmRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpXG4gIGRlZmluZVByb3BlcnR5OiAkZGVmaW5lUHJvcGVydHksXG4gIC8vIDE5LjEuMi4zIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpXG4gIGRlZmluZVByb3BlcnRpZXM6ICRkZWZpbmVQcm9wZXJ0aWVzLFxuICAvLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApXG4gIGdldE93blByb3BlcnR5RGVzY3JpcHRvcjogJGdldE93blByb3BlcnR5RGVzY3JpcHRvcixcbiAgLy8gMTkuMS4yLjcgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTylcbiAgZ2V0T3duUHJvcGVydHlOYW1lczogJGdldE93blByb3BlcnR5TmFtZXMsXG4gIC8vIDE5LjEuMi44IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoTylcbiAgZ2V0T3duUHJvcGVydHlTeW1ib2xzOiAkZ2V0T3duUHJvcGVydHlTeW1ib2xzXG59KTtcblxuLy8gQ2hyb21lIDM4IGFuZCAzOSBgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sc2AgZmFpbHMgb24gcHJpbWl0aXZlc1xuLy8gaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9MzQ0M1xudmFyIEZBSUxTX09OX1BSSU1JVElWRVMgPSAkZmFpbHMoZnVuY3Rpb24gKCkgeyAkR09QUy5mKDEpOyB9KTtcblxuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiBGQUlMU19PTl9QUklNSVRJVkVTLCAnT2JqZWN0Jywge1xuICBnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6IGZ1bmN0aW9uIGdldE93blByb3BlcnR5U3ltYm9scyhpdCkge1xuICAgIHJldHVybiAkR09QUy5mKHRvT2JqZWN0KGl0KSk7XG4gIH1cbn0pO1xuXG4vLyAyNC4zLjIgSlNPTi5zdHJpbmdpZnkodmFsdWUgWywgcmVwbGFjZXIgWywgc3BhY2VdXSlcbiRKU09OICYmICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKCFVU0VfTkFUSVZFIHx8ICRmYWlscyhmdW5jdGlvbiAoKSB7XG4gIHZhciBTID0gJFN5bWJvbCgpO1xuICAvLyBNUyBFZGdlIGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyB7fVxuICAvLyBXZWJLaXQgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIG51bGxcbiAgLy8gVjggdGhyb3dzIG9uIGJveGVkIHN5bWJvbHNcbiAgcmV0dXJuIF9zdHJpbmdpZnkoW1NdKSAhPSAnW251bGxdJyB8fCBfc3RyaW5naWZ5KHsgYTogUyB9KSAhPSAne30nIHx8IF9zdHJpbmdpZnkoT2JqZWN0KFMpKSAhPSAne30nO1xufSkpLCAnSlNPTicsIHtcbiAgc3RyaW5naWZ5OiBmdW5jdGlvbiBzdHJpbmdpZnkoaXQpIHtcbiAgICB2YXIgYXJncyA9IFtpdF07XG4gICAgdmFyIGkgPSAxO1xuICAgIHZhciByZXBsYWNlciwgJHJlcGxhY2VyO1xuICAgIHdoaWxlIChhcmd1bWVudHMubGVuZ3RoID4gaSkgYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTtcbiAgICAkcmVwbGFjZXIgPSByZXBsYWNlciA9IGFyZ3NbMV07XG4gICAgaWYgKCFpc09iamVjdChyZXBsYWNlcikgJiYgaXQgPT09IHVuZGVmaW5lZCB8fCBpc1N5bWJvbChpdCkpIHJldHVybjsgLy8gSUU4IHJldHVybnMgc3RyaW5nIG9uIHVuZGVmaW5lZFxuICAgIGlmICghaXNBcnJheShyZXBsYWNlcikpIHJlcGxhY2VyID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgIGlmICh0eXBlb2YgJHJlcGxhY2VyID09ICdmdW5jdGlvbicpIHZhbHVlID0gJHJlcGxhY2VyLmNhbGwodGhpcywga2V5LCB2YWx1ZSk7XG4gICAgICBpZiAoIWlzU3ltYm9sKHZhbHVlKSkgcmV0dXJuIHZhbHVlO1xuICAgIH07XG4gICAgYXJnc1sxXSA9IHJlcGxhY2VyO1xuICAgIHJldHVybiBfc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmdzKTtcbiAgfVxufSk7XG5cbi8vIDE5LjQuMy40IFN5bWJvbC5wcm90b3R5cGVbQEB0b1ByaW1pdGl2ZV0oaGludClcbiRTeW1ib2xbUFJPVE9UWVBFXVtUT19QUklNSVRJVkVdIHx8IHJlcXVpcmUoJy4vX2hpZGUnKSgkU3ltYm9sW1BST1RPVFlQRV0sIFRPX1BSSU1JVElWRSwgJFN5bWJvbFtQUk9UT1RZUEVdLnZhbHVlT2YpO1xuLy8gMTkuNC4zLjUgU3ltYm9sLnByb3RvdHlwZVtAQHRvU3RyaW5nVGFnXVxuc2V0VG9TdHJpbmdUYWcoJFN5bWJvbCwgJ1N5bWJvbCcpO1xuLy8gMjAuMi4xLjkgTWF0aFtAQHRvU3RyaW5nVGFnXVxuc2V0VG9TdHJpbmdUYWcoTWF0aCwgJ01hdGgnLCB0cnVlKTtcbi8vIDI0LjMuMyBKU09OW0BAdG9TdHJpbmdUYWddXG5zZXRUb1N0cmluZ1RhZyhnbG9iYWwuSlNPTiwgJ0pTT04nLCB0cnVlKTtcbiIsIi8vIGh0dHBzOi8vZ2l0aHViLmNvbS90YzM5L3Byb3Bvc2FsLXByb21pc2UtZmluYWxseVxuJ3VzZSBzdHJpY3QnO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciBjb3JlID0gcmVxdWlyZSgnLi9fY29yZScpO1xudmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIHNwZWNpZXNDb25zdHJ1Y3RvciA9IHJlcXVpcmUoJy4vX3NwZWNpZXMtY29uc3RydWN0b3InKTtcbnZhciBwcm9taXNlUmVzb2x2ZSA9IHJlcXVpcmUoJy4vX3Byb21pc2UtcmVzb2x2ZScpO1xuXG4kZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuUiwgJ1Byb21pc2UnLCB7ICdmaW5hbGx5JzogZnVuY3Rpb24gKG9uRmluYWxseSkge1xuICB2YXIgQyA9IHNwZWNpZXNDb25zdHJ1Y3Rvcih0aGlzLCBjb3JlLlByb21pc2UgfHwgZ2xvYmFsLlByb21pc2UpO1xuICB2YXIgaXNGdW5jdGlvbiA9IHR5cGVvZiBvbkZpbmFsbHkgPT0gJ2Z1bmN0aW9uJztcbiAgcmV0dXJuIHRoaXMudGhlbihcbiAgICBpc0Z1bmN0aW9uID8gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHJldHVybiBwcm9taXNlUmVzb2x2ZShDLCBvbkZpbmFsbHkoKSkudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiB4OyB9KTtcbiAgICB9IDogb25GaW5hbGx5LFxuICAgIGlzRnVuY3Rpb24gPyBmdW5jdGlvbiAoZSkge1xuICAgICAgcmV0dXJuIHByb21pc2VSZXNvbHZlKEMsIG9uRmluYWxseSgpKS50aGVuKGZ1bmN0aW9uICgpIHsgdGhyb3cgZTsgfSk7XG4gICAgfSA6IG9uRmluYWxseVxuICApO1xufSB9KTtcbiIsIid1c2Ugc3RyaWN0Jztcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS90YzM5L3Byb3Bvc2FsLXByb21pc2UtdHJ5XG52YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpO1xudmFyIG5ld1Byb21pc2VDYXBhYmlsaXR5ID0gcmVxdWlyZSgnLi9fbmV3LXByb21pc2UtY2FwYWJpbGl0eScpO1xudmFyIHBlcmZvcm0gPSByZXF1aXJlKCcuL19wZXJmb3JtJyk7XG5cbiRleHBvcnQoJGV4cG9ydC5TLCAnUHJvbWlzZScsIHsgJ3RyeSc6IGZ1bmN0aW9uIChjYWxsYmFja2ZuKSB7XG4gIHZhciBwcm9taXNlQ2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5LmYodGhpcyk7XG4gIHZhciByZXN1bHQgPSBwZXJmb3JtKGNhbGxiYWNrZm4pO1xuICAocmVzdWx0LmUgPyBwcm9taXNlQ2FwYWJpbGl0eS5yZWplY3QgOiBwcm9taXNlQ2FwYWJpbGl0eS5yZXNvbHZlKShyZXN1bHQudik7XG4gIHJldHVybiBwcm9taXNlQ2FwYWJpbGl0eS5wcm9taXNlO1xufSB9KTtcbiIsInJlcXVpcmUoJy4vX3drcy1kZWZpbmUnKSgnYXN5bmNJdGVyYXRvcicpO1xuIiwicmVxdWlyZSgnLi9fd2tzLWRlZmluZScpKCdvYnNlcnZhYmxlJyk7XG4iLCJyZXF1aXJlKCcuL2VzNi5hcnJheS5pdGVyYXRvcicpO1xudmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpO1xudmFyIGhpZGUgPSByZXF1aXJlKCcuL19oaWRlJyk7XG52YXIgSXRlcmF0b3JzID0gcmVxdWlyZSgnLi9faXRlcmF0b3JzJyk7XG52YXIgVE9fU1RSSU5HX1RBRyA9IHJlcXVpcmUoJy4vX3drcycpKCd0b1N0cmluZ1RhZycpO1xuXG52YXIgRE9NSXRlcmFibGVzID0gKCdDU1NSdWxlTGlzdCxDU1NTdHlsZURlY2xhcmF0aW9uLENTU1ZhbHVlTGlzdCxDbGllbnRSZWN0TGlzdCxET01SZWN0TGlzdCxET01TdHJpbmdMaXN0LCcgK1xuICAnRE9NVG9rZW5MaXN0LERhdGFUcmFuc2Zlckl0ZW1MaXN0LEZpbGVMaXN0LEhUTUxBbGxDb2xsZWN0aW9uLEhUTUxDb2xsZWN0aW9uLEhUTUxGb3JtRWxlbWVudCxIVE1MU2VsZWN0RWxlbWVudCwnICtcbiAgJ01lZGlhTGlzdCxNaW1lVHlwZUFycmF5LE5hbWVkTm9kZU1hcCxOb2RlTGlzdCxQYWludFJlcXVlc3RMaXN0LFBsdWdpbixQbHVnaW5BcnJheSxTVkdMZW5ndGhMaXN0LFNWR051bWJlckxpc3QsJyArXG4gICdTVkdQYXRoU2VnTGlzdCxTVkdQb2ludExpc3QsU1ZHU3RyaW5nTGlzdCxTVkdUcmFuc2Zvcm1MaXN0LFNvdXJjZUJ1ZmZlckxpc3QsU3R5bGVTaGVldExpc3QsVGV4dFRyYWNrQ3VlTGlzdCwnICtcbiAgJ1RleHRUcmFja0xpc3QsVG91Y2hMaXN0Jykuc3BsaXQoJywnKTtcblxuZm9yICh2YXIgaSA9IDA7IGkgPCBET01JdGVyYWJsZXMubGVuZ3RoOyBpKyspIHtcbiAgdmFyIE5BTUUgPSBET01JdGVyYWJsZXNbaV07XG4gIHZhciBDb2xsZWN0aW9uID0gZ2xvYmFsW05BTUVdO1xuICB2YXIgcHJvdG8gPSBDb2xsZWN0aW9uICYmIENvbGxlY3Rpb24ucHJvdG90eXBlO1xuICBpZiAocHJvdG8gJiYgIXByb3RvW1RPX1NUUklOR19UQUddKSBoaWRlKHByb3RvLCBUT19TVFJJTkdfVEFHLCBOQU1FKTtcbiAgSXRlcmF0b3JzW05BTUVdID0gSXRlcmF0b3JzLkFycmF5O1xufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuXG4vLyBUaGlzIG1ldGhvZCBvZiBvYnRhaW5pbmcgYSByZWZlcmVuY2UgdG8gdGhlIGdsb2JhbCBvYmplY3QgbmVlZHMgdG8gYmVcbi8vIGtlcHQgaWRlbnRpY2FsIHRvIHRoZSB3YXkgaXQgaXMgb2J0YWluZWQgaW4gcnVudGltZS5qc1xudmFyIGcgPSAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzIH0pKCkgfHwgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpO1xuXG4vLyBVc2UgYGdldE93blByb3BlcnR5TmFtZXNgIGJlY2F1c2Ugbm90IGFsbCBicm93c2VycyBzdXBwb3J0IGNhbGxpbmdcbi8vIGBoYXNPd25Qcm9wZXJ0eWAgb24gdGhlIGdsb2JhbCBgc2VsZmAgb2JqZWN0IGluIGEgd29ya2VyLiBTZWUgIzE4My5cbnZhciBoYWRSdW50aW1lID0gZy5yZWdlbmVyYXRvclJ1bnRpbWUgJiZcbiAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoZykuaW5kZXhPZihcInJlZ2VuZXJhdG9yUnVudGltZVwiKSA+PSAwO1xuXG4vLyBTYXZlIHRoZSBvbGQgcmVnZW5lcmF0b3JSdW50aW1lIGluIGNhc2UgaXQgbmVlZHMgdG8gYmUgcmVzdG9yZWQgbGF0ZXIuXG52YXIgb2xkUnVudGltZSA9IGhhZFJ1bnRpbWUgJiYgZy5yZWdlbmVyYXRvclJ1bnRpbWU7XG5cbi8vIEZvcmNlIHJlZXZhbHV0YXRpb24gb2YgcnVudGltZS5qcy5cbmcucmVnZW5lcmF0b3JSdW50aW1lID0gdW5kZWZpbmVkO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuL3J1bnRpbWVcIik7XG5cbmlmIChoYWRSdW50aW1lKSB7XG4gIC8vIFJlc3RvcmUgdGhlIG9yaWdpbmFsIHJ1bnRpbWUuXG4gIGcucmVnZW5lcmF0b3JSdW50aW1lID0gb2xkUnVudGltZTtcbn0gZWxzZSB7XG4gIC8vIFJlbW92ZSB0aGUgZ2xvYmFsIHByb3BlcnR5IGFkZGVkIGJ5IHJ1bnRpbWUuanMuXG4gIHRyeSB7XG4gICAgZGVsZXRlIGcucmVnZW5lcmF0b3JSdW50aW1lO1xuICB9IGNhdGNoKGUpIHtcbiAgICBnLnJlZ2VuZXJhdG9yUnVudGltZSA9IHVuZGVmaW5lZDtcbiAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuXG4hKGZ1bmN0aW9uKGdsb2JhbCkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgT3AgPSBPYmplY3QucHJvdG90eXBlO1xuICB2YXIgaGFzT3duID0gT3AuaGFzT3duUHJvcGVydHk7XG4gIHZhciB1bmRlZmluZWQ7IC8vIE1vcmUgY29tcHJlc3NpYmxlIHRoYW4gdm9pZCAwLlxuICB2YXIgJFN5bWJvbCA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiA/IFN5bWJvbCA6IHt9O1xuICB2YXIgaXRlcmF0b3JTeW1ib2wgPSAkU3ltYm9sLml0ZXJhdG9yIHx8IFwiQEBpdGVyYXRvclwiO1xuICB2YXIgYXN5bmNJdGVyYXRvclN5bWJvbCA9ICRTeW1ib2wuYXN5bmNJdGVyYXRvciB8fCBcIkBAYXN5bmNJdGVyYXRvclwiO1xuICB2YXIgdG9TdHJpbmdUYWdTeW1ib2wgPSAkU3ltYm9sLnRvU3RyaW5nVGFnIHx8IFwiQEB0b1N0cmluZ1RhZ1wiO1xuXG4gIHZhciBpbk1vZHVsZSA9IHR5cGVvZiBtb2R1bGUgPT09IFwib2JqZWN0XCI7XG4gIHZhciBydW50aW1lID0gZ2xvYmFsLnJlZ2VuZXJhdG9yUnVudGltZTtcbiAgaWYgKHJ1bnRpbWUpIHtcbiAgICBpZiAoaW5Nb2R1bGUpIHtcbiAgICAgIC8vIElmIHJlZ2VuZXJhdG9yUnVudGltZSBpcyBkZWZpbmVkIGdsb2JhbGx5IGFuZCB3ZSdyZSBpbiBhIG1vZHVsZSxcbiAgICAgIC8vIG1ha2UgdGhlIGV4cG9ydHMgb2JqZWN0IGlkZW50aWNhbCB0byByZWdlbmVyYXRvclJ1bnRpbWUuXG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IHJ1bnRpbWU7XG4gICAgfVxuICAgIC8vIERvbid0IGJvdGhlciBldmFsdWF0aW5nIHRoZSByZXN0IG9mIHRoaXMgZmlsZSBpZiB0aGUgcnVudGltZSB3YXNcbiAgICAvLyBhbHJlYWR5IGRlZmluZWQgZ2xvYmFsbHkuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gRGVmaW5lIHRoZSBydW50aW1lIGdsb2JhbGx5IChhcyBleHBlY3RlZCBieSBnZW5lcmF0ZWQgY29kZSkgYXMgZWl0aGVyXG4gIC8vIG1vZHVsZS5leHBvcnRzIChpZiB3ZSdyZSBpbiBhIG1vZHVsZSkgb3IgYSBuZXcsIGVtcHR5IG9iamVjdC5cbiAgcnVudGltZSA9IGdsb2JhbC5yZWdlbmVyYXRvclJ1bnRpbWUgPSBpbk1vZHVsZSA/IG1vZHVsZS5leHBvcnRzIDoge307XG5cbiAgZnVuY3Rpb24gd3JhcChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCkge1xuICAgIC8vIElmIG91dGVyRm4gcHJvdmlkZWQgYW5kIG91dGVyRm4ucHJvdG90eXBlIGlzIGEgR2VuZXJhdG9yLCB0aGVuIG91dGVyRm4ucHJvdG90eXBlIGluc3RhbmNlb2YgR2VuZXJhdG9yLlxuICAgIHZhciBwcm90b0dlbmVyYXRvciA9IG91dGVyRm4gJiYgb3V0ZXJGbi5wcm90b3R5cGUgaW5zdGFuY2VvZiBHZW5lcmF0b3IgPyBvdXRlckZuIDogR2VuZXJhdG9yO1xuICAgIHZhciBnZW5lcmF0b3IgPSBPYmplY3QuY3JlYXRlKHByb3RvR2VuZXJhdG9yLnByb3RvdHlwZSk7XG4gICAgdmFyIGNvbnRleHQgPSBuZXcgQ29udGV4dCh0cnlMb2NzTGlzdCB8fCBbXSk7XG5cbiAgICAvLyBUaGUgLl9pbnZva2UgbWV0aG9kIHVuaWZpZXMgdGhlIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgLm5leHQsXG4gICAgLy8gLnRocm93LCBhbmQgLnJldHVybiBtZXRob2RzLlxuICAgIGdlbmVyYXRvci5faW52b2tlID0gbWFrZUludm9rZU1ldGhvZChpbm5lckZuLCBzZWxmLCBjb250ZXh0KTtcblxuICAgIHJldHVybiBnZW5lcmF0b3I7XG4gIH1cbiAgcnVudGltZS53cmFwID0gd3JhcDtcblxuICAvLyBUcnkvY2F0Y2ggaGVscGVyIHRvIG1pbmltaXplIGRlb3B0aW1pemF0aW9ucy4gUmV0dXJucyBhIGNvbXBsZXRpb25cbiAgLy8gcmVjb3JkIGxpa2UgY29udGV4dC50cnlFbnRyaWVzW2ldLmNvbXBsZXRpb24uIFRoaXMgaW50ZXJmYWNlIGNvdWxkXG4gIC8vIGhhdmUgYmVlbiAoYW5kIHdhcyBwcmV2aW91c2x5KSBkZXNpZ25lZCB0byB0YWtlIGEgY2xvc3VyZSB0byBiZVxuICAvLyBpbnZva2VkIHdpdGhvdXQgYXJndW1lbnRzLCBidXQgaW4gYWxsIHRoZSBjYXNlcyB3ZSBjYXJlIGFib3V0IHdlXG4gIC8vIGFscmVhZHkgaGF2ZSBhbiBleGlzdGluZyBtZXRob2Qgd2Ugd2FudCB0byBjYWxsLCBzbyB0aGVyZSdzIG5vIG5lZWRcbiAgLy8gdG8gY3JlYXRlIGEgbmV3IGZ1bmN0aW9uIG9iamVjdC4gV2UgY2FuIGV2ZW4gZ2V0IGF3YXkgd2l0aCBhc3N1bWluZ1xuICAvLyB0aGUgbWV0aG9kIHRha2VzIGV4YWN0bHkgb25lIGFyZ3VtZW50LCBzaW5jZSB0aGF0IGhhcHBlbnMgdG8gYmUgdHJ1ZVxuICAvLyBpbiBldmVyeSBjYXNlLCBzbyB3ZSBkb24ndCBoYXZlIHRvIHRvdWNoIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBUaGVcbiAgLy8gb25seSBhZGRpdGlvbmFsIGFsbG9jYXRpb24gcmVxdWlyZWQgaXMgdGhlIGNvbXBsZXRpb24gcmVjb3JkLCB3aGljaFxuICAvLyBoYXMgYSBzdGFibGUgc2hhcGUgYW5kIHNvIGhvcGVmdWxseSBzaG91bGQgYmUgY2hlYXAgdG8gYWxsb2NhdGUuXG4gIGZ1bmN0aW9uIHRyeUNhdGNoKGZuLCBvYmosIGFyZykge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4geyB0eXBlOiBcIm5vcm1hbFwiLCBhcmc6IGZuLmNhbGwob2JqLCBhcmcpIH07XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4geyB0eXBlOiBcInRocm93XCIsIGFyZzogZXJyIH07XG4gICAgfVxuICB9XG5cbiAgdmFyIEdlblN0YXRlU3VzcGVuZGVkU3RhcnQgPSBcInN1c3BlbmRlZFN0YXJ0XCI7XG4gIHZhciBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkID0gXCJzdXNwZW5kZWRZaWVsZFwiO1xuICB2YXIgR2VuU3RhdGVFeGVjdXRpbmcgPSBcImV4ZWN1dGluZ1wiO1xuICB2YXIgR2VuU3RhdGVDb21wbGV0ZWQgPSBcImNvbXBsZXRlZFwiO1xuXG4gIC8vIFJldHVybmluZyB0aGlzIG9iamVjdCBmcm9tIHRoZSBpbm5lckZuIGhhcyB0aGUgc2FtZSBlZmZlY3QgYXNcbiAgLy8gYnJlYWtpbmcgb3V0IG9mIHRoZSBkaXNwYXRjaCBzd2l0Y2ggc3RhdGVtZW50LlxuICB2YXIgQ29udGludWVTZW50aW5lbCA9IHt9O1xuXG4gIC8vIER1bW15IGNvbnN0cnVjdG9yIGZ1bmN0aW9ucyB0aGF0IHdlIHVzZSBhcyB0aGUgLmNvbnN0cnVjdG9yIGFuZFxuICAvLyAuY29uc3RydWN0b3IucHJvdG90eXBlIHByb3BlcnRpZXMgZm9yIGZ1bmN0aW9ucyB0aGF0IHJldHVybiBHZW5lcmF0b3JcbiAgLy8gb2JqZWN0cy4gRm9yIGZ1bGwgc3BlYyBjb21wbGlhbmNlLCB5b3UgbWF5IHdpc2ggdG8gY29uZmlndXJlIHlvdXJcbiAgLy8gbWluaWZpZXIgbm90IHRvIG1hbmdsZSB0aGUgbmFtZXMgb2YgdGhlc2UgdHdvIGZ1bmN0aW9ucy5cbiAgZnVuY3Rpb24gR2VuZXJhdG9yKCkge31cbiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb24oKSB7fVxuICBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSgpIHt9XG5cbiAgLy8gVGhpcyBpcyBhIHBvbHlmaWxsIGZvciAlSXRlcmF0b3JQcm90b3R5cGUlIGZvciBlbnZpcm9ubWVudHMgdGhhdFxuICAvLyBkb24ndCBuYXRpdmVseSBzdXBwb3J0IGl0LlxuICB2YXIgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTtcbiAgSXRlcmF0b3JQcm90b3R5cGVbaXRlcmF0b3JTeW1ib2xdID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIHZhciBnZXRQcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZjtcbiAgdmFyIE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG8gJiYgZ2V0UHJvdG8oZ2V0UHJvdG8odmFsdWVzKFtdKSkpO1xuICBpZiAoTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUgJiZcbiAgICAgIE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlICE9PSBPcCAmJlxuICAgICAgaGFzT3duLmNhbGwoTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUsIGl0ZXJhdG9yU3ltYm9sKSkge1xuICAgIC8vIFRoaXMgZW52aXJvbm1lbnQgaGFzIGEgbmF0aXZlICVJdGVyYXRvclByb3RvdHlwZSU7IHVzZSBpdCBpbnN0ZWFkXG4gICAgLy8gb2YgdGhlIHBvbHlmaWxsLlxuICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gTmF0aXZlSXRlcmF0b3JQcm90b3R5cGU7XG4gIH1cblxuICB2YXIgR3AgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZS5wcm90b3R5cGUgPVxuICAgIEdlbmVyYXRvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEl0ZXJhdG9yUHJvdG90eXBlKTtcbiAgR2VuZXJhdG9yRnVuY3Rpb24ucHJvdG90eXBlID0gR3AuY29uc3RydWN0b3IgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZTtcbiAgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUuY29uc3RydWN0b3IgPSBHZW5lcmF0b3JGdW5jdGlvbjtcbiAgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGVbdG9TdHJpbmdUYWdTeW1ib2xdID1cbiAgICBHZW5lcmF0b3JGdW5jdGlvbi5kaXNwbGF5TmFtZSA9IFwiR2VuZXJhdG9yRnVuY3Rpb25cIjtcblxuICAvLyBIZWxwZXIgZm9yIGRlZmluaW5nIHRoZSAubmV4dCwgLnRocm93LCBhbmQgLnJldHVybiBtZXRob2RzIG9mIHRoZVxuICAvLyBJdGVyYXRvciBpbnRlcmZhY2UgaW4gdGVybXMgb2YgYSBzaW5nbGUgLl9pbnZva2UgbWV0aG9kLlxuICBmdW5jdGlvbiBkZWZpbmVJdGVyYXRvck1ldGhvZHMocHJvdG90eXBlKSB7XG4gICAgW1wibmV4dFwiLCBcInRocm93XCIsIFwicmV0dXJuXCJdLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgICBwcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKGFyZykge1xuICAgICAgICByZXR1cm4gdGhpcy5faW52b2tlKG1ldGhvZCwgYXJnKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBydW50aW1lLmlzR2VuZXJhdG9yRnVuY3Rpb24gPSBmdW5jdGlvbihnZW5GdW4pIHtcbiAgICB2YXIgY3RvciA9IHR5cGVvZiBnZW5GdW4gPT09IFwiZnVuY3Rpb25cIiAmJiBnZW5GdW4uY29uc3RydWN0b3I7XG4gICAgcmV0dXJuIGN0b3JcbiAgICAgID8gY3RvciA9PT0gR2VuZXJhdG9yRnVuY3Rpb24gfHxcbiAgICAgICAgLy8gRm9yIHRoZSBuYXRpdmUgR2VuZXJhdG9yRnVuY3Rpb24gY29uc3RydWN0b3IsIHRoZSBiZXN0IHdlIGNhblxuICAgICAgICAvLyBkbyBpcyB0byBjaGVjayBpdHMgLm5hbWUgcHJvcGVydHkuXG4gICAgICAgIChjdG9yLmRpc3BsYXlOYW1lIHx8IGN0b3IubmFtZSkgPT09IFwiR2VuZXJhdG9yRnVuY3Rpb25cIlxuICAgICAgOiBmYWxzZTtcbiAgfTtcblxuICBydW50aW1lLm1hcmsgPSBmdW5jdGlvbihnZW5GdW4pIHtcbiAgICBpZiAoT2JqZWN0LnNldFByb3RvdHlwZU9mKSB7XG4gICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoZ2VuRnVuLCBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGdlbkZ1bi5fX3Byb3RvX18gPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZTtcbiAgICAgIGlmICghKHRvU3RyaW5nVGFnU3ltYm9sIGluIGdlbkZ1bikpIHtcbiAgICAgICAgZ2VuRnVuW3RvU3RyaW5nVGFnU3ltYm9sXSA9IFwiR2VuZXJhdG9yRnVuY3Rpb25cIjtcbiAgICAgIH1cbiAgICB9XG4gICAgZ2VuRnVuLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoR3ApO1xuICAgIHJldHVybiBnZW5GdW47XG4gIH07XG5cbiAgLy8gV2l0aGluIHRoZSBib2R5IG9mIGFueSBhc3luYyBmdW5jdGlvbiwgYGF3YWl0IHhgIGlzIHRyYW5zZm9ybWVkIHRvXG4gIC8vIGB5aWVsZCByZWdlbmVyYXRvclJ1bnRpbWUuYXdyYXAoeClgLCBzbyB0aGF0IHRoZSBydW50aW1lIGNhbiB0ZXN0XG4gIC8vIGBoYXNPd24uY2FsbCh2YWx1ZSwgXCJfX2F3YWl0XCIpYCB0byBkZXRlcm1pbmUgaWYgdGhlIHlpZWxkZWQgdmFsdWUgaXNcbiAgLy8gbWVhbnQgdG8gYmUgYXdhaXRlZC5cbiAgcnVudGltZS5hd3JhcCA9IGZ1bmN0aW9uKGFyZykge1xuICAgIHJldHVybiB7IF9fYXdhaXQ6IGFyZyB9O1xuICB9O1xuXG4gIGZ1bmN0aW9uIEFzeW5jSXRlcmF0b3IoZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChnZW5lcmF0b3JbbWV0aG9kXSwgZ2VuZXJhdG9yLCBhcmcpO1xuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgcmVqZWN0KHJlY29yZC5hcmcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHJlY29yZC5hcmc7XG4gICAgICAgIHZhciB2YWx1ZSA9IHJlc3VsdC52YWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlICYmXG4gICAgICAgICAgICB0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIgJiZcbiAgICAgICAgICAgIGhhc093bi5jYWxsKHZhbHVlLCBcIl9fYXdhaXRcIikpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZhbHVlLl9fYXdhaXQpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIGludm9rZShcIm5leHRcIiwgdmFsdWUsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICBpbnZva2UoXCJ0aHJvd1wiLCBlcnIsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKGZ1bmN0aW9uKHVud3JhcHBlZCkge1xuICAgICAgICAgIC8vIFdoZW4gYSB5aWVsZGVkIFByb21pc2UgaXMgcmVzb2x2ZWQsIGl0cyBmaW5hbCB2YWx1ZSBiZWNvbWVzXG4gICAgICAgICAgLy8gdGhlIC52YWx1ZSBvZiB0aGUgUHJvbWlzZTx7dmFsdWUsZG9uZX0+IHJlc3VsdCBmb3IgdGhlXG4gICAgICAgICAgLy8gY3VycmVudCBpdGVyYXRpb24uIElmIHRoZSBQcm9taXNlIGlzIHJlamVjdGVkLCBob3dldmVyLCB0aGVcbiAgICAgICAgICAvLyByZXN1bHQgZm9yIHRoaXMgaXRlcmF0aW9uIHdpbGwgYmUgcmVqZWN0ZWQgd2l0aCB0aGUgc2FtZVxuICAgICAgICAgIC8vIHJlYXNvbi4gTm90ZSB0aGF0IHJlamVjdGlvbnMgb2YgeWllbGRlZCBQcm9taXNlcyBhcmUgbm90XG4gICAgICAgICAgLy8gdGhyb3duIGJhY2sgaW50byB0aGUgZ2VuZXJhdG9yIGZ1bmN0aW9uLCBhcyBpcyB0aGUgY2FzZVxuICAgICAgICAgIC8vIHdoZW4gYW4gYXdhaXRlZCBQcm9taXNlIGlzIHJlamVjdGVkLiBUaGlzIGRpZmZlcmVuY2UgaW5cbiAgICAgICAgICAvLyBiZWhhdmlvciBiZXR3ZWVuIHlpZWxkIGFuZCBhd2FpdCBpcyBpbXBvcnRhbnQsIGJlY2F1c2UgaXRcbiAgICAgICAgICAvLyBhbGxvd3MgdGhlIGNvbnN1bWVyIHRvIGRlY2lkZSB3aGF0IHRvIGRvIHdpdGggdGhlIHlpZWxkZWRcbiAgICAgICAgICAvLyByZWplY3Rpb24gKHN3YWxsb3cgaXQgYW5kIGNvbnRpbnVlLCBtYW51YWxseSAudGhyb3cgaXQgYmFja1xuICAgICAgICAgIC8vIGludG8gdGhlIGdlbmVyYXRvciwgYWJhbmRvbiBpdGVyYXRpb24sIHdoYXRldmVyKS4gV2l0aFxuICAgICAgICAgIC8vIGF3YWl0LCBieSBjb250cmFzdCwgdGhlcmUgaXMgbm8gb3Bwb3J0dW5pdHkgdG8gZXhhbWluZSB0aGVcbiAgICAgICAgICAvLyByZWplY3Rpb24gcmVhc29uIG91dHNpZGUgdGhlIGdlbmVyYXRvciBmdW5jdGlvbiwgc28gdGhlXG4gICAgICAgICAgLy8gb25seSBvcHRpb24gaXMgdG8gdGhyb3cgaXQgZnJvbSB0aGUgYXdhaXQgZXhwcmVzc2lvbiwgYW5kXG4gICAgICAgICAgLy8gbGV0IHRoZSBnZW5lcmF0b3IgZnVuY3Rpb24gaGFuZGxlIHRoZSBleGNlcHRpb24uXG4gICAgICAgICAgcmVzdWx0LnZhbHVlID0gdW53cmFwcGVkO1xuICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgfSwgcmVqZWN0KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgcHJldmlvdXNQcm9taXNlO1xuXG4gICAgZnVuY3Rpb24gZW5xdWV1ZShtZXRob2QsIGFyZykge1xuICAgICAgZnVuY3Rpb24gY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICBpbnZva2UobWV0aG9kLCBhcmcsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcHJldmlvdXNQcm9taXNlID1cbiAgICAgICAgLy8gSWYgZW5xdWV1ZSBoYXMgYmVlbiBjYWxsZWQgYmVmb3JlLCB0aGVuIHdlIHdhbnQgdG8gd2FpdCB1bnRpbFxuICAgICAgICAvLyBhbGwgcHJldmlvdXMgUHJvbWlzZXMgaGF2ZSBiZWVuIHJlc29sdmVkIGJlZm9yZSBjYWxsaW5nIGludm9rZSxcbiAgICAgICAgLy8gc28gdGhhdCByZXN1bHRzIGFyZSBhbHdheXMgZGVsaXZlcmVkIGluIHRoZSBjb3JyZWN0IG9yZGVyLiBJZlxuICAgICAgICAvLyBlbnF1ZXVlIGhhcyBub3QgYmVlbiBjYWxsZWQgYmVmb3JlLCB0aGVuIGl0IGlzIGltcG9ydGFudCB0b1xuICAgICAgICAvLyBjYWxsIGludm9rZSBpbW1lZGlhdGVseSwgd2l0aG91dCB3YWl0aW5nIG9uIGEgY2FsbGJhY2sgdG8gZmlyZSxcbiAgICAgICAgLy8gc28gdGhhdCB0aGUgYXN5bmMgZ2VuZXJhdG9yIGZ1bmN0aW9uIGhhcyB0aGUgb3Bwb3J0dW5pdHkgdG8gZG9cbiAgICAgICAgLy8gYW55IG5lY2Vzc2FyeSBzZXR1cCBpbiBhIHByZWRpY3RhYmxlIHdheS4gVGhpcyBwcmVkaWN0YWJpbGl0eVxuICAgICAgICAvLyBpcyB3aHkgdGhlIFByb21pc2UgY29uc3RydWN0b3Igc3luY2hyb25vdXNseSBpbnZva2VzIGl0c1xuICAgICAgICAvLyBleGVjdXRvciBjYWxsYmFjaywgYW5kIHdoeSBhc3luYyBmdW5jdGlvbnMgc3luY2hyb25vdXNseVxuICAgICAgICAvLyBleGVjdXRlIGNvZGUgYmVmb3JlIHRoZSBmaXJzdCBhd2FpdC4gU2luY2Ugd2UgaW1wbGVtZW50IHNpbXBsZVxuICAgICAgICAvLyBhc3luYyBmdW5jdGlvbnMgaW4gdGVybXMgb2YgYXN5bmMgZ2VuZXJhdG9ycywgaXQgaXMgZXNwZWNpYWxseVxuICAgICAgICAvLyBpbXBvcnRhbnQgdG8gZ2V0IHRoaXMgcmlnaHQsIGV2ZW4gdGhvdWdoIGl0IHJlcXVpcmVzIGNhcmUuXG4gICAgICAgIHByZXZpb3VzUHJvbWlzZSA/IHByZXZpb3VzUHJvbWlzZS50aGVuKFxuICAgICAgICAgIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnLFxuICAgICAgICAgIC8vIEF2b2lkIHByb3BhZ2F0aW5nIGZhaWx1cmVzIHRvIFByb21pc2VzIHJldHVybmVkIGJ5IGxhdGVyXG4gICAgICAgICAgLy8gaW52b2NhdGlvbnMgb2YgdGhlIGl0ZXJhdG9yLlxuICAgICAgICAgIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnXG4gICAgICAgICkgOiBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZygpO1xuICAgIH1cblxuICAgIC8vIERlZmluZSB0aGUgdW5pZmllZCBoZWxwZXIgbWV0aG9kIHRoYXQgaXMgdXNlZCB0byBpbXBsZW1lbnQgLm5leHQsXG4gICAgLy8gLnRocm93LCBhbmQgLnJldHVybiAoc2VlIGRlZmluZUl0ZXJhdG9yTWV0aG9kcykuXG4gICAgdGhpcy5faW52b2tlID0gZW5xdWV1ZTtcbiAgfVxuXG4gIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhBc3luY0l0ZXJhdG9yLnByb3RvdHlwZSk7XG4gIEFzeW5jSXRlcmF0b3IucHJvdG90eXBlW2FzeW5jSXRlcmF0b3JTeW1ib2xdID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICBydW50aW1lLkFzeW5jSXRlcmF0b3IgPSBBc3luY0l0ZXJhdG9yO1xuXG4gIC8vIE5vdGUgdGhhdCBzaW1wbGUgYXN5bmMgZnVuY3Rpb25zIGFyZSBpbXBsZW1lbnRlZCBvbiB0b3Agb2ZcbiAgLy8gQXN5bmNJdGVyYXRvciBvYmplY3RzOyB0aGV5IGp1c3QgcmV0dXJuIGEgUHJvbWlzZSBmb3IgdGhlIHZhbHVlIG9mXG4gIC8vIHRoZSBmaW5hbCByZXN1bHQgcHJvZHVjZWQgYnkgdGhlIGl0ZXJhdG9yLlxuICBydW50aW1lLmFzeW5jID0gZnVuY3Rpb24oaW5uZXJGbiwgb3V0ZXJGbiwgc2VsZiwgdHJ5TG9jc0xpc3QpIHtcbiAgICB2YXIgaXRlciA9IG5ldyBBc3luY0l0ZXJhdG9yKFxuICAgICAgd3JhcChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdClcbiAgICApO1xuXG4gICAgcmV0dXJuIHJ1bnRpbWUuaXNHZW5lcmF0b3JGdW5jdGlvbihvdXRlckZuKVxuICAgICAgPyBpdGVyIC8vIElmIG91dGVyRm4gaXMgYSBnZW5lcmF0b3IsIHJldHVybiB0aGUgZnVsbCBpdGVyYXRvci5cbiAgICAgIDogaXRlci5uZXh0KCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICByZXR1cm4gcmVzdWx0LmRvbmUgPyByZXN1bHQudmFsdWUgOiBpdGVyLm5leHQoKTtcbiAgICAgICAgfSk7XG4gIH07XG5cbiAgZnVuY3Rpb24gbWFrZUludm9rZU1ldGhvZChpbm5lckZuLCBzZWxmLCBjb250ZXh0KSB7XG4gICAgdmFyIHN0YXRlID0gR2VuU3RhdGVTdXNwZW5kZWRTdGFydDtcblxuICAgIHJldHVybiBmdW5jdGlvbiBpbnZva2UobWV0aG9kLCBhcmcpIHtcbiAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVFeGVjdXRpbmcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgcnVubmluZ1wiKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHN0YXRlID09PSBHZW5TdGF0ZUNvbXBsZXRlZCkge1xuICAgICAgICBpZiAobWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICB0aHJvdyBhcmc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCZSBmb3JnaXZpbmcsIHBlciAyNS4zLjMuMy4zIG9mIHRoZSBzcGVjOlxuICAgICAgICAvLyBodHRwczovL3Blb3BsZS5tb3ppbGxhLm9yZy9+am9yZW5kb3JmZi9lczYtZHJhZnQuaHRtbCNzZWMtZ2VuZXJhdG9ycmVzdW1lXG4gICAgICAgIHJldHVybiBkb25lUmVzdWx0KCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnRleHQubWV0aG9kID0gbWV0aG9kO1xuICAgICAgY29udGV4dC5hcmcgPSBhcmc7XG5cbiAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHZhciBkZWxlZ2F0ZSA9IGNvbnRleHQuZGVsZWdhdGU7XG4gICAgICAgIGlmIChkZWxlZ2F0ZSkge1xuICAgICAgICAgIHZhciBkZWxlZ2F0ZVJlc3VsdCA9IG1heWJlSW52b2tlRGVsZWdhdGUoZGVsZWdhdGUsIGNvbnRleHQpO1xuICAgICAgICAgIGlmIChkZWxlZ2F0ZVJlc3VsdCkge1xuICAgICAgICAgICAgaWYgKGRlbGVnYXRlUmVzdWx0ID09PSBDb250aW51ZVNlbnRpbmVsKSBjb250aW51ZTtcbiAgICAgICAgICAgIHJldHVybiBkZWxlZ2F0ZVJlc3VsdDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29udGV4dC5tZXRob2QgPT09IFwibmV4dFwiKSB7XG4gICAgICAgICAgLy8gU2V0dGluZyBjb250ZXh0Ll9zZW50IGZvciBsZWdhY3kgc3VwcG9ydCBvZiBCYWJlbCdzXG4gICAgICAgICAgLy8gZnVuY3Rpb24uc2VudCBpbXBsZW1lbnRhdGlvbi5cbiAgICAgICAgICBjb250ZXh0LnNlbnQgPSBjb250ZXh0Ll9zZW50ID0gY29udGV4dC5hcmc7XG5cbiAgICAgICAgfSBlbHNlIGlmIChjb250ZXh0Lm1ldGhvZCA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgaWYgKHN0YXRlID09PSBHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0KSB7XG4gICAgICAgICAgICBzdGF0ZSA9IEdlblN0YXRlQ29tcGxldGVkO1xuICAgICAgICAgICAgdGhyb3cgY29udGV4dC5hcmc7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29udGV4dC5kaXNwYXRjaEV4Y2VwdGlvbihjb250ZXh0LmFyZyk7XG5cbiAgICAgICAgfSBlbHNlIGlmIChjb250ZXh0Lm1ldGhvZCA9PT0gXCJyZXR1cm5cIikge1xuICAgICAgICAgIGNvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIGNvbnRleHQuYXJnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN0YXRlID0gR2VuU3RhdGVFeGVjdXRpbmc7XG5cbiAgICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpO1xuICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwibm9ybWFsXCIpIHtcbiAgICAgICAgICAvLyBJZiBhbiBleGNlcHRpb24gaXMgdGhyb3duIGZyb20gaW5uZXJGbiwgd2UgbGVhdmUgc3RhdGUgPT09XG4gICAgICAgICAgLy8gR2VuU3RhdGVFeGVjdXRpbmcgYW5kIGxvb3AgYmFjayBmb3IgYW5vdGhlciBpbnZvY2F0aW9uLlxuICAgICAgICAgIHN0YXRlID0gY29udGV4dC5kb25lXG4gICAgICAgICAgICA/IEdlblN0YXRlQ29tcGxldGVkXG4gICAgICAgICAgICA6IEdlblN0YXRlU3VzcGVuZGVkWWllbGQ7XG5cbiAgICAgICAgICBpZiAocmVjb3JkLmFyZyA9PT0gQ29udGludWVTZW50aW5lbCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiByZWNvcmQuYXJnLFxuICAgICAgICAgICAgZG9uZTogY29udGV4dC5kb25lXG4gICAgICAgICAgfTtcblxuICAgICAgICB9IGVsc2UgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICBzdGF0ZSA9IEdlblN0YXRlQ29tcGxldGVkO1xuICAgICAgICAgIC8vIERpc3BhdGNoIHRoZSBleGNlcHRpb24gYnkgbG9vcGluZyBiYWNrIGFyb3VuZCB0byB0aGVcbiAgICAgICAgICAvLyBjb250ZXh0LmRpc3BhdGNoRXhjZXB0aW9uKGNvbnRleHQuYXJnKSBjYWxsIGFib3ZlLlxuICAgICAgICAgIGNvbnRleHQubWV0aG9kID0gXCJ0aHJvd1wiO1xuICAgICAgICAgIGNvbnRleHQuYXJnID0gcmVjb3JkLmFyZztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvLyBDYWxsIGRlbGVnYXRlLml0ZXJhdG9yW2NvbnRleHQubWV0aG9kXShjb250ZXh0LmFyZykgYW5kIGhhbmRsZSB0aGVcbiAgLy8gcmVzdWx0LCBlaXRoZXIgYnkgcmV0dXJuaW5nIGEgeyB2YWx1ZSwgZG9uZSB9IHJlc3VsdCBmcm9tIHRoZVxuICAvLyBkZWxlZ2F0ZSBpdGVyYXRvciwgb3IgYnkgbW9kaWZ5aW5nIGNvbnRleHQubWV0aG9kIGFuZCBjb250ZXh0LmFyZyxcbiAgLy8gc2V0dGluZyBjb250ZXh0LmRlbGVnYXRlIHRvIG51bGwsIGFuZCByZXR1cm5pbmcgdGhlIENvbnRpbnVlU2VudGluZWwuXG4gIGZ1bmN0aW9uIG1heWJlSW52b2tlRGVsZWdhdGUoZGVsZWdhdGUsIGNvbnRleHQpIHtcbiAgICB2YXIgbWV0aG9kID0gZGVsZWdhdGUuaXRlcmF0b3JbY29udGV4dC5tZXRob2RdO1xuICAgIGlmIChtZXRob2QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgLy8gQSAudGhyb3cgb3IgLnJldHVybiB3aGVuIHRoZSBkZWxlZ2F0ZSBpdGVyYXRvciBoYXMgbm8gLnRocm93XG4gICAgICAvLyBtZXRob2QgYWx3YXlzIHRlcm1pbmF0ZXMgdGhlIHlpZWxkKiBsb29wLlxuICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgIGlmIChjb250ZXh0Lm1ldGhvZCA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIGlmIChkZWxlZ2F0ZS5pdGVyYXRvci5yZXR1cm4pIHtcbiAgICAgICAgICAvLyBJZiB0aGUgZGVsZWdhdGUgaXRlcmF0b3IgaGFzIGEgcmV0dXJuIG1ldGhvZCwgZ2l2ZSBpdCBhXG4gICAgICAgICAgLy8gY2hhbmNlIHRvIGNsZWFuIHVwLlxuICAgICAgICAgIGNvbnRleHQubWV0aG9kID0gXCJyZXR1cm5cIjtcbiAgICAgICAgICBjb250ZXh0LmFyZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICBtYXliZUludm9rZURlbGVnYXRlKGRlbGVnYXRlLCBjb250ZXh0KTtcblxuICAgICAgICAgIGlmIChjb250ZXh0Lm1ldGhvZCA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgICAvLyBJZiBtYXliZUludm9rZURlbGVnYXRlKGNvbnRleHQpIGNoYW5nZWQgY29udGV4dC5tZXRob2QgZnJvbVxuICAgICAgICAgICAgLy8gXCJyZXR1cm5cIiB0byBcInRocm93XCIsIGxldCB0aGF0IG92ZXJyaWRlIHRoZSBUeXBlRXJyb3IgYmVsb3cuXG4gICAgICAgICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb250ZXh0Lm1ldGhvZCA9IFwidGhyb3dcIjtcbiAgICAgICAgY29udGV4dC5hcmcgPSBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgIFwiVGhlIGl0ZXJhdG9yIGRvZXMgbm90IHByb3ZpZGUgYSAndGhyb3cnIG1ldGhvZFwiKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgfVxuXG4gICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKG1ldGhvZCwgZGVsZWdhdGUuaXRlcmF0b3IsIGNvbnRleHQuYXJnKTtcblxuICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICBjb250ZXh0Lm1ldGhvZCA9IFwidGhyb3dcIjtcbiAgICAgIGNvbnRleHQuYXJnID0gcmVjb3JkLmFyZztcbiAgICAgIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsO1xuICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgfVxuXG4gICAgdmFyIGluZm8gPSByZWNvcmQuYXJnO1xuXG4gICAgaWYgKCEgaW5mbykge1xuICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCI7XG4gICAgICBjb250ZXh0LmFyZyA9IG5ldyBUeXBlRXJyb3IoXCJpdGVyYXRvciByZXN1bHQgaXMgbm90IGFuIG9iamVjdFwiKTtcbiAgICAgIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsO1xuICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgfVxuXG4gICAgaWYgKGluZm8uZG9uZSkge1xuICAgICAgLy8gQXNzaWduIHRoZSByZXN1bHQgb2YgdGhlIGZpbmlzaGVkIGRlbGVnYXRlIHRvIHRoZSB0ZW1wb3JhcnlcbiAgICAgIC8vIHZhcmlhYmxlIHNwZWNpZmllZCBieSBkZWxlZ2F0ZS5yZXN1bHROYW1lIChzZWUgZGVsZWdhdGVZaWVsZCkuXG4gICAgICBjb250ZXh0W2RlbGVnYXRlLnJlc3VsdE5hbWVdID0gaW5mby52YWx1ZTtcblxuICAgICAgLy8gUmVzdW1lIGV4ZWN1dGlvbiBhdCB0aGUgZGVzaXJlZCBsb2NhdGlvbiAoc2VlIGRlbGVnYXRlWWllbGQpLlxuICAgICAgY29udGV4dC5uZXh0ID0gZGVsZWdhdGUubmV4dExvYztcblxuICAgICAgLy8gSWYgY29udGV4dC5tZXRob2Qgd2FzIFwidGhyb3dcIiBidXQgdGhlIGRlbGVnYXRlIGhhbmRsZWQgdGhlXG4gICAgICAvLyBleGNlcHRpb24sIGxldCB0aGUgb3V0ZXIgZ2VuZXJhdG9yIHByb2NlZWQgbm9ybWFsbHkuIElmXG4gICAgICAvLyBjb250ZXh0Lm1ldGhvZCB3YXMgXCJuZXh0XCIsIGZvcmdldCBjb250ZXh0LmFyZyBzaW5jZSBpdCBoYXMgYmVlblxuICAgICAgLy8gXCJjb25zdW1lZFwiIGJ5IHRoZSBkZWxlZ2F0ZSBpdGVyYXRvci4gSWYgY29udGV4dC5tZXRob2Qgd2FzXG4gICAgICAvLyBcInJldHVyblwiLCBhbGxvdyB0aGUgb3JpZ2luYWwgLnJldHVybiBjYWxsIHRvIGNvbnRpbnVlIGluIHRoZVxuICAgICAgLy8gb3V0ZXIgZ2VuZXJhdG9yLlxuICAgICAgaWYgKGNvbnRleHQubWV0aG9kICE9PSBcInJldHVyblwiKSB7XG4gICAgICAgIGNvbnRleHQubWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICAgIGNvbnRleHQuYXJnID0gdW5kZWZpbmVkO1xuICAgICAgfVxuXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFJlLXlpZWxkIHRoZSByZXN1bHQgcmV0dXJuZWQgYnkgdGhlIGRlbGVnYXRlIG1ldGhvZC5cbiAgICAgIHJldHVybiBpbmZvO1xuICAgIH1cblxuICAgIC8vIFRoZSBkZWxlZ2F0ZSBpdGVyYXRvciBpcyBmaW5pc2hlZCwgc28gZm9yZ2V0IGl0IGFuZCBjb250aW51ZSB3aXRoXG4gICAgLy8gdGhlIG91dGVyIGdlbmVyYXRvci5cbiAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcbiAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgfVxuXG4gIC8vIERlZmluZSBHZW5lcmF0b3IucHJvdG90eXBlLntuZXh0LHRocm93LHJldHVybn0gaW4gdGVybXMgb2YgdGhlXG4gIC8vIHVuaWZpZWQgLl9pbnZva2UgaGVscGVyIG1ldGhvZC5cbiAgZGVmaW5lSXRlcmF0b3JNZXRob2RzKEdwKTtcblxuICBHcFt0b1N0cmluZ1RhZ1N5bWJvbF0gPSBcIkdlbmVyYXRvclwiO1xuXG4gIC8vIEEgR2VuZXJhdG9yIHNob3VsZCBhbHdheXMgcmV0dXJuIGl0c2VsZiBhcyB0aGUgaXRlcmF0b3Igb2JqZWN0IHdoZW4gdGhlXG4gIC8vIEBAaXRlcmF0b3IgZnVuY3Rpb24gaXMgY2FsbGVkIG9uIGl0LiBTb21lIGJyb3dzZXJzJyBpbXBsZW1lbnRhdGlvbnMgb2YgdGhlXG4gIC8vIGl0ZXJhdG9yIHByb3RvdHlwZSBjaGFpbiBpbmNvcnJlY3RseSBpbXBsZW1lbnQgdGhpcywgY2F1c2luZyB0aGUgR2VuZXJhdG9yXG4gIC8vIG9iamVjdCB0byBub3QgYmUgcmV0dXJuZWQgZnJvbSB0aGlzIGNhbGwuIFRoaXMgZW5zdXJlcyB0aGF0IGRvZXNuJ3QgaGFwcGVuLlxuICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlZ2VuZXJhdG9yL2lzc3Vlcy8yNzQgZm9yIG1vcmUgZGV0YWlscy5cbiAgR3BbaXRlcmF0b3JTeW1ib2xdID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgR3AudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gXCJbb2JqZWN0IEdlbmVyYXRvcl1cIjtcbiAgfTtcblxuICBmdW5jdGlvbiBwdXNoVHJ5RW50cnkobG9jcykge1xuICAgIHZhciBlbnRyeSA9IHsgdHJ5TG9jOiBsb2NzWzBdIH07XG5cbiAgICBpZiAoMSBpbiBsb2NzKSB7XG4gICAgICBlbnRyeS5jYXRjaExvYyA9IGxvY3NbMV07XG4gICAgfVxuXG4gICAgaWYgKDIgaW4gbG9jcykge1xuICAgICAgZW50cnkuZmluYWxseUxvYyA9IGxvY3NbMl07XG4gICAgICBlbnRyeS5hZnRlckxvYyA9IGxvY3NbM107XG4gICAgfVxuXG4gICAgdGhpcy50cnlFbnRyaWVzLnB1c2goZW50cnkpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVzZXRUcnlFbnRyeShlbnRyeSkge1xuICAgIHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uIHx8IHt9O1xuICAgIHJlY29yZC50eXBlID0gXCJub3JtYWxcIjtcbiAgICBkZWxldGUgcmVjb3JkLmFyZztcbiAgICBlbnRyeS5jb21wbGV0aW9uID0gcmVjb3JkO1xuICB9XG5cbiAgZnVuY3Rpb24gQ29udGV4dCh0cnlMb2NzTGlzdCkge1xuICAgIC8vIFRoZSByb290IGVudHJ5IG9iamVjdCAoZWZmZWN0aXZlbHkgYSB0cnkgc3RhdGVtZW50IHdpdGhvdXQgYSBjYXRjaFxuICAgIC8vIG9yIGEgZmluYWxseSBibG9jaykgZ2l2ZXMgdXMgYSBwbGFjZSB0byBzdG9yZSB2YWx1ZXMgdGhyb3duIGZyb21cbiAgICAvLyBsb2NhdGlvbnMgd2hlcmUgdGhlcmUgaXMgbm8gZW5jbG9zaW5nIHRyeSBzdGF0ZW1lbnQuXG4gICAgdGhpcy50cnlFbnRyaWVzID0gW3sgdHJ5TG9jOiBcInJvb3RcIiB9XTtcbiAgICB0cnlMb2NzTGlzdC5mb3JFYWNoKHB1c2hUcnlFbnRyeSwgdGhpcyk7XG4gICAgdGhpcy5yZXNldCh0cnVlKTtcbiAgfVxuXG4gIHJ1bnRpbWUua2V5cyA9IGZ1bmN0aW9uKG9iamVjdCkge1xuICAgIHZhciBrZXlzID0gW107XG4gICAgZm9yICh2YXIga2V5IGluIG9iamVjdCkge1xuICAgICAga2V5cy5wdXNoKGtleSk7XG4gICAgfVxuICAgIGtleXMucmV2ZXJzZSgpO1xuXG4gICAgLy8gUmF0aGVyIHRoYW4gcmV0dXJuaW5nIGFuIG9iamVjdCB3aXRoIGEgbmV4dCBtZXRob2QsIHdlIGtlZXBcbiAgICAvLyB0aGluZ3Mgc2ltcGxlIGFuZCByZXR1cm4gdGhlIG5leHQgZnVuY3Rpb24gaXRzZWxmLlxuICAgIHJldHVybiBmdW5jdGlvbiBuZXh0KCkge1xuICAgICAgd2hpbGUgKGtleXMubGVuZ3RoKSB7XG4gICAgICAgIHZhciBrZXkgPSBrZXlzLnBvcCgpO1xuICAgICAgICBpZiAoa2V5IGluIG9iamVjdCkge1xuICAgICAgICAgIG5leHQudmFsdWUgPSBrZXk7XG4gICAgICAgICAgbmV4dC5kb25lID0gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gVG8gYXZvaWQgY3JlYXRpbmcgYW4gYWRkaXRpb25hbCBvYmplY3QsIHdlIGp1c3QgaGFuZyB0aGUgLnZhbHVlXG4gICAgICAvLyBhbmQgLmRvbmUgcHJvcGVydGllcyBvZmYgdGhlIG5leHQgZnVuY3Rpb24gb2JqZWN0IGl0c2VsZi4gVGhpc1xuICAgICAgLy8gYWxzbyBlbnN1cmVzIHRoYXQgdGhlIG1pbmlmaWVyIHdpbGwgbm90IGFub255bWl6ZSB0aGUgZnVuY3Rpb24uXG4gICAgICBuZXh0LmRvbmUgPSB0cnVlO1xuICAgICAgcmV0dXJuIG5leHQ7XG4gICAgfTtcbiAgfTtcblxuICBmdW5jdGlvbiB2YWx1ZXMoaXRlcmFibGUpIHtcbiAgICBpZiAoaXRlcmFibGUpIHtcbiAgICAgIHZhciBpdGVyYXRvck1ldGhvZCA9IGl0ZXJhYmxlW2l0ZXJhdG9yU3ltYm9sXTtcbiAgICAgIGlmIChpdGVyYXRvck1ldGhvZCkge1xuICAgICAgICByZXR1cm4gaXRlcmF0b3JNZXRob2QuY2FsbChpdGVyYWJsZSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgaXRlcmFibGUubmV4dCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJldHVybiBpdGVyYWJsZTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFpc05hTihpdGVyYWJsZS5sZW5ndGgpKSB7XG4gICAgICAgIHZhciBpID0gLTEsIG5leHQgPSBmdW5jdGlvbiBuZXh0KCkge1xuICAgICAgICAgIHdoaWxlICgrK2kgPCBpdGVyYWJsZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChoYXNPd24uY2FsbChpdGVyYWJsZSwgaSkpIHtcbiAgICAgICAgICAgICAgbmV4dC52YWx1ZSA9IGl0ZXJhYmxlW2ldO1xuICAgICAgICAgICAgICBuZXh0LmRvbmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbmV4dC52YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICBuZXh0LmRvbmUgPSB0cnVlO1xuXG4gICAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIG5leHQubmV4dCA9IG5leHQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIGFuIGl0ZXJhdG9yIHdpdGggbm8gdmFsdWVzLlxuICAgIHJldHVybiB7IG5leHQ6IGRvbmVSZXN1bHQgfTtcbiAgfVxuICBydW50aW1lLnZhbHVlcyA9IHZhbHVlcztcblxuICBmdW5jdGlvbiBkb25lUmVzdWx0KCkge1xuICAgIHJldHVybiB7IHZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWUgfTtcbiAgfVxuXG4gIENvbnRleHQucHJvdG90eXBlID0ge1xuICAgIGNvbnN0cnVjdG9yOiBDb250ZXh0LFxuXG4gICAgcmVzZXQ6IGZ1bmN0aW9uKHNraXBUZW1wUmVzZXQpIHtcbiAgICAgIHRoaXMucHJldiA9IDA7XG4gICAgICB0aGlzLm5leHQgPSAwO1xuICAgICAgLy8gUmVzZXR0aW5nIGNvbnRleHQuX3NlbnQgZm9yIGxlZ2FjeSBzdXBwb3J0IG9mIEJhYmVsJ3NcbiAgICAgIC8vIGZ1bmN0aW9uLnNlbnQgaW1wbGVtZW50YXRpb24uXG4gICAgICB0aGlzLnNlbnQgPSB0aGlzLl9zZW50ID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG4gICAgICB0aGlzLmRlbGVnYXRlID0gbnVsbDtcblxuICAgICAgdGhpcy5tZXRob2QgPSBcIm5leHRcIjtcbiAgICAgIHRoaXMuYXJnID0gdW5kZWZpbmVkO1xuXG4gICAgICB0aGlzLnRyeUVudHJpZXMuZm9yRWFjaChyZXNldFRyeUVudHJ5KTtcblxuICAgICAgaWYgKCFza2lwVGVtcFJlc2V0KSB7XG4gICAgICAgIGZvciAodmFyIG5hbWUgaW4gdGhpcykge1xuICAgICAgICAgIC8vIE5vdCBzdXJlIGFib3V0IHRoZSBvcHRpbWFsIG9yZGVyIG9mIHRoZXNlIGNvbmRpdGlvbnM6XG4gICAgICAgICAgaWYgKG5hbWUuY2hhckF0KDApID09PSBcInRcIiAmJlxuICAgICAgICAgICAgICBoYXNPd24uY2FsbCh0aGlzLCBuYW1lKSAmJlxuICAgICAgICAgICAgICAhaXNOYU4oK25hbWUuc2xpY2UoMSkpKSB7XG4gICAgICAgICAgICB0aGlzW25hbWVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBzdG9wOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG5cbiAgICAgIHZhciByb290RW50cnkgPSB0aGlzLnRyeUVudHJpZXNbMF07XG4gICAgICB2YXIgcm9vdFJlY29yZCA9IHJvb3RFbnRyeS5jb21wbGV0aW9uO1xuICAgICAgaWYgKHJvb3RSZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIHRocm93IHJvb3RSZWNvcmQuYXJnO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5ydmFsO1xuICAgIH0sXG5cbiAgICBkaXNwYXRjaEV4Y2VwdGlvbjogZnVuY3Rpb24oZXhjZXB0aW9uKSB7XG4gICAgICBpZiAodGhpcy5kb25lKSB7XG4gICAgICAgIHRocm93IGV4Y2VwdGlvbjtcbiAgICAgIH1cblxuICAgICAgdmFyIGNvbnRleHQgPSB0aGlzO1xuICAgICAgZnVuY3Rpb24gaGFuZGxlKGxvYywgY2F1Z2h0KSB7XG4gICAgICAgIHJlY29yZC50eXBlID0gXCJ0aHJvd1wiO1xuICAgICAgICByZWNvcmQuYXJnID0gZXhjZXB0aW9uO1xuICAgICAgICBjb250ZXh0Lm5leHQgPSBsb2M7XG5cbiAgICAgICAgaWYgKGNhdWdodCkge1xuICAgICAgICAgIC8vIElmIHRoZSBkaXNwYXRjaGVkIGV4Y2VwdGlvbiB3YXMgY2F1Z2h0IGJ5IGEgY2F0Y2ggYmxvY2ssXG4gICAgICAgICAgLy8gdGhlbiBsZXQgdGhhdCBjYXRjaCBibG9jayBoYW5kbGUgdGhlIGV4Y2VwdGlvbiBub3JtYWxseS5cbiAgICAgICAgICBjb250ZXh0Lm1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgICAgIGNvbnRleHQuYXJnID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuICEhIGNhdWdodDtcbiAgICAgIH1cblxuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uO1xuXG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPT09IFwicm9vdFwiKSB7XG4gICAgICAgICAgLy8gRXhjZXB0aW9uIHRocm93biBvdXRzaWRlIG9mIGFueSB0cnkgYmxvY2sgdGhhdCBjb3VsZCBoYW5kbGVcbiAgICAgICAgICAvLyBpdCwgc28gc2V0IHRoZSBjb21wbGV0aW9uIHZhbHVlIG9mIHRoZSBlbnRpcmUgZnVuY3Rpb24gdG9cbiAgICAgICAgICAvLyB0aHJvdyB0aGUgZXhjZXB0aW9uLlxuICAgICAgICAgIHJldHVybiBoYW5kbGUoXCJlbmRcIik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZW50cnkudHJ5TG9jIDw9IHRoaXMucHJldikge1xuICAgICAgICAgIHZhciBoYXNDYXRjaCA9IGhhc093bi5jYWxsKGVudHJ5LCBcImNhdGNoTG9jXCIpO1xuICAgICAgICAgIHZhciBoYXNGaW5hbGx5ID0gaGFzT3duLmNhbGwoZW50cnksIFwiZmluYWxseUxvY1wiKTtcblxuICAgICAgICAgIGlmIChoYXNDYXRjaCAmJiBoYXNGaW5hbGx5KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuY2F0Y2hMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5jYXRjaExvYywgdHJ1ZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5maW5hbGx5TG9jKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0gZWxzZSBpZiAoaGFzQ2F0Y2gpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5jYXRjaExvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmNhdGNoTG9jLCB0cnVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0gZWxzZSBpZiAoaGFzRmluYWxseSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5maW5hbGx5TG9jKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ0cnkgc3RhdGVtZW50IHdpdGhvdXQgY2F0Y2ggb3IgZmluYWxseVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgYWJydXB0OiBmdW5jdGlvbih0eXBlLCBhcmcpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkudHJ5TG9jIDw9IHRoaXMucHJldiAmJlxuICAgICAgICAgICAgaGFzT3duLmNhbGwoZW50cnksIFwiZmluYWxseUxvY1wiKSAmJlxuICAgICAgICAgICAgdGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAgIHZhciBmaW5hbGx5RW50cnkgPSBlbnRyeTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoZmluYWxseUVudHJ5ICYmXG4gICAgICAgICAgKHR5cGUgPT09IFwiYnJlYWtcIiB8fFxuICAgICAgICAgICB0eXBlID09PSBcImNvbnRpbnVlXCIpICYmXG4gICAgICAgICAgZmluYWxseUVudHJ5LnRyeUxvYyA8PSBhcmcgJiZcbiAgICAgICAgICBhcmcgPD0gZmluYWxseUVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgLy8gSWdub3JlIHRoZSBmaW5hbGx5IGVudHJ5IGlmIGNvbnRyb2wgaXMgbm90IGp1bXBpbmcgdG8gYVxuICAgICAgICAvLyBsb2NhdGlvbiBvdXRzaWRlIHRoZSB0cnkvY2F0Y2ggYmxvY2suXG4gICAgICAgIGZpbmFsbHlFbnRyeSA9IG51bGw7XG4gICAgICB9XG5cbiAgICAgIHZhciByZWNvcmQgPSBmaW5hbGx5RW50cnkgPyBmaW5hbGx5RW50cnkuY29tcGxldGlvbiA6IHt9O1xuICAgICAgcmVjb3JkLnR5cGUgPSB0eXBlO1xuICAgICAgcmVjb3JkLmFyZyA9IGFyZztcblxuICAgICAgaWYgKGZpbmFsbHlFbnRyeSkge1xuICAgICAgICB0aGlzLm1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgICB0aGlzLm5leHQgPSBmaW5hbGx5RW50cnkuZmluYWxseUxvYztcbiAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmNvbXBsZXRlKHJlY29yZCk7XG4gICAgfSxcblxuICAgIGNvbXBsZXRlOiBmdW5jdGlvbihyZWNvcmQsIGFmdGVyTG9jKSB7XG4gICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICB0aHJvdyByZWNvcmQuYXJnO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwiYnJlYWtcIiB8fFxuICAgICAgICAgIHJlY29yZC50eXBlID09PSBcImNvbnRpbnVlXCIpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gcmVjb3JkLmFyZztcbiAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgdGhpcy5ydmFsID0gdGhpcy5hcmcgPSByZWNvcmQuYXJnO1xuICAgICAgICB0aGlzLm1ldGhvZCA9IFwicmV0dXJuXCI7XG4gICAgICAgIHRoaXMubmV4dCA9IFwiZW5kXCI7XG4gICAgICB9IGVsc2UgaWYgKHJlY29yZC50eXBlID09PSBcIm5vcm1hbFwiICYmIGFmdGVyTG9jKSB7XG4gICAgICAgIHRoaXMubmV4dCA9IGFmdGVyTG9jO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9LFxuXG4gICAgZmluaXNoOiBmdW5jdGlvbihmaW5hbGx5TG9jKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgaWYgKGVudHJ5LmZpbmFsbHlMb2MgPT09IGZpbmFsbHlMb2MpIHtcbiAgICAgICAgICB0aGlzLmNvbXBsZXRlKGVudHJ5LmNvbXBsZXRpb24sIGVudHJ5LmFmdGVyTG9jKTtcbiAgICAgICAgICByZXNldFRyeUVudHJ5KGVudHJ5KTtcbiAgICAgICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBcImNhdGNoXCI6IGZ1bmN0aW9uKHRyeUxvYykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPT09IHRyeUxvYykge1xuICAgICAgICAgIHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uO1xuICAgICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgICB2YXIgdGhyb3duID0gcmVjb3JkLmFyZztcbiAgICAgICAgICAgIHJlc2V0VHJ5RW50cnkoZW50cnkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdGhyb3duO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFRoZSBjb250ZXh0LmNhdGNoIG1ldGhvZCBtdXN0IG9ubHkgYmUgY2FsbGVkIHdpdGggYSBsb2NhdGlvblxuICAgICAgLy8gYXJndW1lbnQgdGhhdCBjb3JyZXNwb25kcyB0byBhIGtub3duIGNhdGNoIGJsb2NrLlxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaWxsZWdhbCBjYXRjaCBhdHRlbXB0XCIpO1xuICAgIH0sXG5cbiAgICBkZWxlZ2F0ZVlpZWxkOiBmdW5jdGlvbihpdGVyYWJsZSwgcmVzdWx0TmFtZSwgbmV4dExvYykge1xuICAgICAgdGhpcy5kZWxlZ2F0ZSA9IHtcbiAgICAgICAgaXRlcmF0b3I6IHZhbHVlcyhpdGVyYWJsZSksXG4gICAgICAgIHJlc3VsdE5hbWU6IHJlc3VsdE5hbWUsXG4gICAgICAgIG5leHRMb2M6IG5leHRMb2NcbiAgICAgIH07XG5cbiAgICAgIGlmICh0aGlzLm1ldGhvZCA9PT0gXCJuZXh0XCIpIHtcbiAgICAgICAgLy8gRGVsaWJlcmF0ZWx5IGZvcmdldCB0aGUgbGFzdCBzZW50IHZhbHVlIHNvIHRoYXQgd2UgZG9uJ3RcbiAgICAgICAgLy8gYWNjaWRlbnRhbGx5IHBhc3MgaXQgb24gdG8gdGhlIGRlbGVnYXRlLlxuICAgICAgICB0aGlzLmFyZyA9IHVuZGVmaW5lZDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgfVxuICB9O1xufSkoXG4gIC8vIEluIHNsb3BweSBtb2RlLCB1bmJvdW5kIGB0aGlzYCByZWZlcnMgdG8gdGhlIGdsb2JhbCBvYmplY3QsIGZhbGxiYWNrIHRvXG4gIC8vIEZ1bmN0aW9uIGNvbnN0cnVjdG9yIGlmIHdlJ3JlIGluIGdsb2JhbCBzdHJpY3QgbW9kZS4gVGhhdCBpcyBzYWRseSBhIGZvcm1cbiAgLy8gb2YgaW5kaXJlY3QgZXZhbCB3aGljaCB2aW9sYXRlcyBDb250ZW50IFNlY3VyaXR5IFBvbGljeS5cbiAgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcyB9KSgpIHx8IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKVxuKTtcbiIsIi8qXG4gKiAgQ29weXJpZ2h0IChjKSAyMDE3IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlXG4gKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlXG4gKiAgdHJlZS5cbiAqL1xuIC8qIGVzbGludC1lbnYgbm9kZSAqL1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgU0RQVXRpbHMgPSByZXF1aXJlKCdzZHAnKTtcblxuZnVuY3Rpb24gZml4U3RhdHNUeXBlKHN0YXQpIHtcbiAgcmV0dXJuIHtcbiAgICBpbmJvdW5kcnRwOiAnaW5ib3VuZC1ydHAnLFxuICAgIG91dGJvdW5kcnRwOiAnb3V0Ym91bmQtcnRwJyxcbiAgICBjYW5kaWRhdGVwYWlyOiAnY2FuZGlkYXRlLXBhaXInLFxuICAgIGxvY2FsY2FuZGlkYXRlOiAnbG9jYWwtY2FuZGlkYXRlJyxcbiAgICByZW1vdGVjYW5kaWRhdGU6ICdyZW1vdGUtY2FuZGlkYXRlJ1xuICB9W3N0YXQudHlwZV0gfHwgc3RhdC50eXBlO1xufVxuXG5mdW5jdGlvbiB3cml0ZU1lZGlhU2VjdGlvbih0cmFuc2NlaXZlciwgY2FwcywgdHlwZSwgc3RyZWFtLCBkdGxzUm9sZSkge1xuICB2YXIgc2RwID0gU0RQVXRpbHMud3JpdGVSdHBEZXNjcmlwdGlvbih0cmFuc2NlaXZlci5raW5kLCBjYXBzKTtcblxuICAvLyBNYXAgSUNFIHBhcmFtZXRlcnMgKHVmcmFnLCBwd2QpIHRvIFNEUC5cbiAgc2RwICs9IFNEUFV0aWxzLndyaXRlSWNlUGFyYW1ldGVycyhcbiAgICAgIHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLmdldExvY2FsUGFyYW1ldGVycygpKTtcblxuICAvLyBNYXAgRFRMUyBwYXJhbWV0ZXJzIHRvIFNEUC5cbiAgc2RwICs9IFNEUFV0aWxzLndyaXRlRHRsc1BhcmFtZXRlcnMoXG4gICAgICB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0LmdldExvY2FsUGFyYW1ldGVycygpLFxuICAgICAgdHlwZSA9PT0gJ29mZmVyJyA/ICdhY3RwYXNzJyA6IGR0bHNSb2xlIHx8ICdhY3RpdmUnKTtcblxuICBzZHAgKz0gJ2E9bWlkOicgKyB0cmFuc2NlaXZlci5taWQgKyAnXFxyXFxuJztcblxuICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyICYmIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyKSB7XG4gICAgc2RwICs9ICdhPXNlbmRyZWN2XFxyXFxuJztcbiAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5ydHBTZW5kZXIpIHtcbiAgICBzZHAgKz0gJ2E9c2VuZG9ubHlcXHJcXG4nO1xuICB9IGVsc2UgaWYgKHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyKSB7XG4gICAgc2RwICs9ICdhPXJlY3Zvbmx5XFxyXFxuJztcbiAgfSBlbHNlIHtcbiAgICBzZHAgKz0gJ2E9aW5hY3RpdmVcXHJcXG4nO1xuICB9XG5cbiAgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlcikge1xuICAgIHZhciB0cmFja0lkID0gdHJhbnNjZWl2ZXIucnRwU2VuZGVyLl9pbml0aWFsVHJhY2tJZCB8fFxuICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIudHJhY2suaWQ7XG4gICAgdHJhbnNjZWl2ZXIucnRwU2VuZGVyLl9pbml0aWFsVHJhY2tJZCA9IHRyYWNrSWQ7XG4gICAgLy8gc3BlYy5cbiAgICB2YXIgbXNpZCA9ICdtc2lkOicgKyAoc3RyZWFtID8gc3RyZWFtLmlkIDogJy0nKSArICcgJyArXG4gICAgICAgIHRyYWNrSWQgKyAnXFxyXFxuJztcbiAgICBzZHAgKz0gJ2E9JyArIG1zaWQ7XG4gICAgLy8gZm9yIENocm9tZS4gTGVnYWN5IHNob3VsZCBubyBsb25nZXIgYmUgcmVxdWlyZWQuXG4gICAgc2RwICs9ICdhPXNzcmM6JyArIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0uc3NyYyArXG4gICAgICAgICcgJyArIG1zaWQ7XG5cbiAgICAvLyBSVFhcbiAgICBpZiAodHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHgpIHtcbiAgICAgIHNkcCArPSAnYT1zc3JjOicgKyB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICtcbiAgICAgICAgICAnICcgKyBtc2lkO1xuICAgICAgc2RwICs9ICdhPXNzcmMtZ3JvdXA6RklEICcgK1xuICAgICAgICAgIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0uc3NyYyArICcgJyArXG4gICAgICAgICAgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHguc3NyYyArXG4gICAgICAgICAgJ1xcclxcbic7XG4gICAgfVxuICB9XG4gIC8vIEZJWE1FOiB0aGlzIHNob3VsZCBiZSB3cml0dGVuIGJ5IHdyaXRlUnRwRGVzY3JpcHRpb24uXG4gIHNkcCArPSAnYT1zc3JjOicgKyB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnNzcmMgK1xuICAgICAgJyBjbmFtZTonICsgU0RQVXRpbHMubG9jYWxDTmFtZSArICdcXHJcXG4nO1xuICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyICYmIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7XG4gICAgc2RwICs9ICdhPXNzcmM6JyArIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4LnNzcmMgK1xuICAgICAgICAnIGNuYW1lOicgKyBTRFBVdGlscy5sb2NhbENOYW1lICsgJ1xcclxcbic7XG4gIH1cbiAgcmV0dXJuIHNkcDtcbn1cblxuLy8gRWRnZSBkb2VzIG5vdCBsaWtlXG4vLyAxKSBzdHVuOiBmaWx0ZXJlZCBhZnRlciAxNDM5MyB1bmxlc3MgP3RyYW5zcG9ydD11ZHAgaXMgcHJlc2VudFxuLy8gMikgdHVybjogdGhhdCBkb2VzIG5vdCBoYXZlIGFsbCBvZiB0dXJuOmhvc3Q6cG9ydD90cmFuc3BvcnQ9dWRwXG4vLyAzKSB0dXJuOiB3aXRoIGlwdjYgYWRkcmVzc2VzXG4vLyA0KSB0dXJuOiBvY2N1cnJpbmcgbXVsaXBsZSB0aW1lc1xuZnVuY3Rpb24gZmlsdGVySWNlU2VydmVycyhpY2VTZXJ2ZXJzLCBlZGdlVmVyc2lvbikge1xuICB2YXIgaGFzVHVybiA9IGZhbHNlO1xuICBpY2VTZXJ2ZXJzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShpY2VTZXJ2ZXJzKSk7XG4gIHJldHVybiBpY2VTZXJ2ZXJzLmZpbHRlcihmdW5jdGlvbihzZXJ2ZXIpIHtcbiAgICBpZiAoc2VydmVyICYmIChzZXJ2ZXIudXJscyB8fCBzZXJ2ZXIudXJsKSkge1xuICAgICAgdmFyIHVybHMgPSBzZXJ2ZXIudXJscyB8fCBzZXJ2ZXIudXJsO1xuICAgICAgaWYgKHNlcnZlci51cmwgJiYgIXNlcnZlci51cmxzKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignUlRDSWNlU2VydmVyLnVybCBpcyBkZXByZWNhdGVkISBVc2UgdXJscyBpbnN0ZWFkLicpO1xuICAgICAgfVxuICAgICAgdmFyIGlzU3RyaW5nID0gdHlwZW9mIHVybHMgPT09ICdzdHJpbmcnO1xuICAgICAgaWYgKGlzU3RyaW5nKSB7XG4gICAgICAgIHVybHMgPSBbdXJsc107XG4gICAgICB9XG4gICAgICB1cmxzID0gdXJscy5maWx0ZXIoZnVuY3Rpb24odXJsKSB7XG4gICAgICAgIHZhciB2YWxpZFR1cm4gPSB1cmwuaW5kZXhPZigndHVybjonKSA9PT0gMCAmJlxuICAgICAgICAgICAgdXJsLmluZGV4T2YoJ3RyYW5zcG9ydD11ZHAnKSAhPT0gLTEgJiZcbiAgICAgICAgICAgIHVybC5pbmRleE9mKCd0dXJuOlsnKSA9PT0gLTEgJiZcbiAgICAgICAgICAgICFoYXNUdXJuO1xuXG4gICAgICAgIGlmICh2YWxpZFR1cm4pIHtcbiAgICAgICAgICBoYXNUdXJuID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdXJsLmluZGV4T2YoJ3N0dW46JykgPT09IDAgJiYgZWRnZVZlcnNpb24gPj0gMTQzOTMgJiZcbiAgICAgICAgICAgIHVybC5pbmRleE9mKCc/dHJhbnNwb3J0PXVkcCcpID09PSAtMTtcbiAgICAgIH0pO1xuXG4gICAgICBkZWxldGUgc2VydmVyLnVybDtcbiAgICAgIHNlcnZlci51cmxzID0gaXNTdHJpbmcgPyB1cmxzWzBdIDogdXJscztcbiAgICAgIHJldHVybiAhIXVybHMubGVuZ3RoO1xuICAgIH1cbiAgfSk7XG59XG5cbi8vIERldGVybWluZXMgdGhlIGludGVyc2VjdGlvbiBvZiBsb2NhbCBhbmQgcmVtb3RlIGNhcGFiaWxpdGllcy5cbmZ1bmN0aW9uIGdldENvbW1vbkNhcGFiaWxpdGllcyhsb2NhbENhcGFiaWxpdGllcywgcmVtb3RlQ2FwYWJpbGl0aWVzKSB7XG4gIHZhciBjb21tb25DYXBhYmlsaXRpZXMgPSB7XG4gICAgY29kZWNzOiBbXSxcbiAgICBoZWFkZXJFeHRlbnNpb25zOiBbXSxcbiAgICBmZWNNZWNoYW5pc21zOiBbXVxuICB9O1xuXG4gIHZhciBmaW5kQ29kZWNCeVBheWxvYWRUeXBlID0gZnVuY3Rpb24ocHQsIGNvZGVjcykge1xuICAgIHB0ID0gcGFyc2VJbnQocHQsIDEwKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvZGVjcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGNvZGVjc1tpXS5wYXlsb2FkVHlwZSA9PT0gcHQgfHxcbiAgICAgICAgICBjb2RlY3NbaV0ucHJlZmVycmVkUGF5bG9hZFR5cGUgPT09IHB0KSB7XG4gICAgICAgIHJldHVybiBjb2RlY3NbaV07XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHZhciBydHhDYXBhYmlsaXR5TWF0Y2hlcyA9IGZ1bmN0aW9uKGxSdHgsIHJSdHgsIGxDb2RlY3MsIHJDb2RlY3MpIHtcbiAgICB2YXIgbENvZGVjID0gZmluZENvZGVjQnlQYXlsb2FkVHlwZShsUnR4LnBhcmFtZXRlcnMuYXB0LCBsQ29kZWNzKTtcbiAgICB2YXIgckNvZGVjID0gZmluZENvZGVjQnlQYXlsb2FkVHlwZShyUnR4LnBhcmFtZXRlcnMuYXB0LCByQ29kZWNzKTtcbiAgICByZXR1cm4gbENvZGVjICYmIHJDb2RlYyAmJlxuICAgICAgICBsQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpID09PSByQ29kZWMubmFtZS50b0xvd2VyQ2FzZSgpO1xuICB9O1xuXG4gIGxvY2FsQ2FwYWJpbGl0aWVzLmNvZGVjcy5mb3JFYWNoKGZ1bmN0aW9uKGxDb2RlYykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVtb3RlQ2FwYWJpbGl0aWVzLmNvZGVjcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHJDb2RlYyA9IHJlbW90ZUNhcGFiaWxpdGllcy5jb2RlY3NbaV07XG4gICAgICBpZiAobENvZGVjLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gckNvZGVjLm5hbWUudG9Mb3dlckNhc2UoKSAmJlxuICAgICAgICAgIGxDb2RlYy5jbG9ja1JhdGUgPT09IHJDb2RlYy5jbG9ja1JhdGUpIHtcbiAgICAgICAgaWYgKGxDb2RlYy5uYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdydHgnICYmXG4gICAgICAgICAgICBsQ29kZWMucGFyYW1ldGVycyAmJiByQ29kZWMucGFyYW1ldGVycy5hcHQpIHtcbiAgICAgICAgICAvLyBmb3IgUlRYIHdlIG5lZWQgdG8gZmluZCB0aGUgbG9jYWwgcnR4IHRoYXQgaGFzIGEgYXB0XG4gICAgICAgICAgLy8gd2hpY2ggcG9pbnRzIHRvIHRoZSBzYW1lIGxvY2FsIGNvZGVjIGFzIHRoZSByZW1vdGUgb25lLlxuICAgICAgICAgIGlmICghcnR4Q2FwYWJpbGl0eU1hdGNoZXMobENvZGVjLCByQ29kZWMsXG4gICAgICAgICAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzLmNvZGVjcywgcmVtb3RlQ2FwYWJpbGl0aWVzLmNvZGVjcykpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByQ29kZWMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJDb2RlYykpOyAvLyBkZWVwY29weVxuICAgICAgICAvLyBudW1iZXIgb2YgY2hhbm5lbHMgaXMgdGhlIGhpZ2hlc3QgY29tbW9uIG51bWJlciBvZiBjaGFubmVsc1xuICAgICAgICByQ29kZWMubnVtQ2hhbm5lbHMgPSBNYXRoLm1pbihsQ29kZWMubnVtQ2hhbm5lbHMsXG4gICAgICAgICAgICByQ29kZWMubnVtQ2hhbm5lbHMpO1xuICAgICAgICAvLyBwdXNoIHJDb2RlYyBzbyB3ZSByZXBseSB3aXRoIG9mZmVyZXIgcGF5bG9hZCB0eXBlXG4gICAgICAgIGNvbW1vbkNhcGFiaWxpdGllcy5jb2RlY3MucHVzaChyQ29kZWMpO1xuXG4gICAgICAgIC8vIGRldGVybWluZSBjb21tb24gZmVlZGJhY2sgbWVjaGFuaXNtc1xuICAgICAgICByQ29kZWMucnRjcEZlZWRiYWNrID0gckNvZGVjLnJ0Y3BGZWVkYmFjay5maWx0ZXIoZnVuY3Rpb24oZmIpIHtcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGxDb2RlYy5ydGNwRmVlZGJhY2subGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIGlmIChsQ29kZWMucnRjcEZlZWRiYWNrW2pdLnR5cGUgPT09IGZiLnR5cGUgJiZcbiAgICAgICAgICAgICAgICBsQ29kZWMucnRjcEZlZWRiYWNrW2pdLnBhcmFtZXRlciA9PT0gZmIucGFyYW1ldGVyKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBGSVhNRTogYWxzbyBuZWVkIHRvIGRldGVybWluZSAucGFyYW1ldGVyc1xuICAgICAgICAvLyAgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVucGVlci9vcnRjL2lzc3Vlcy81NjlcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICBsb2NhbENhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zLmZvckVhY2goZnVuY3Rpb24obEhlYWRlckV4dGVuc2lvbikge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVtb3RlQ2FwYWJpbGl0aWVzLmhlYWRlckV4dGVuc2lvbnMubGVuZ3RoO1xuICAgICAgICAgaSsrKSB7XG4gICAgICB2YXIgckhlYWRlckV4dGVuc2lvbiA9IHJlbW90ZUNhcGFiaWxpdGllcy5oZWFkZXJFeHRlbnNpb25zW2ldO1xuICAgICAgaWYgKGxIZWFkZXJFeHRlbnNpb24udXJpID09PSBySGVhZGVyRXh0ZW5zaW9uLnVyaSkge1xuICAgICAgICBjb21tb25DYXBhYmlsaXRpZXMuaGVhZGVyRXh0ZW5zaW9ucy5wdXNoKHJIZWFkZXJFeHRlbnNpb24pO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIC8vIEZJWE1FOiBmZWNNZWNoYW5pc21zXG4gIHJldHVybiBjb21tb25DYXBhYmlsaXRpZXM7XG59XG5cbi8vIGlzIGFjdGlvbj1zZXRMb2NhbERlc2NyaXB0aW9uIHdpdGggdHlwZSBhbGxvd2VkIGluIHNpZ25hbGluZ1N0YXRlXG5mdW5jdGlvbiBpc0FjdGlvbkFsbG93ZWRJblNpZ25hbGluZ1N0YXRlKGFjdGlvbiwgdHlwZSwgc2lnbmFsaW5nU3RhdGUpIHtcbiAgcmV0dXJuIHtcbiAgICBvZmZlcjoge1xuICAgICAgc2V0TG9jYWxEZXNjcmlwdGlvbjogWydzdGFibGUnLCAnaGF2ZS1sb2NhbC1vZmZlciddLFxuICAgICAgc2V0UmVtb3RlRGVzY3JpcHRpb246IFsnc3RhYmxlJywgJ2hhdmUtcmVtb3RlLW9mZmVyJ11cbiAgICB9LFxuICAgIGFuc3dlcjoge1xuICAgICAgc2V0TG9jYWxEZXNjcmlwdGlvbjogWydoYXZlLXJlbW90ZS1vZmZlcicsICdoYXZlLWxvY2FsLXByYW5zd2VyJ10sXG4gICAgICBzZXRSZW1vdGVEZXNjcmlwdGlvbjogWydoYXZlLWxvY2FsLW9mZmVyJywgJ2hhdmUtcmVtb3RlLXByYW5zd2VyJ11cbiAgICB9XG4gIH1bdHlwZV1bYWN0aW9uXS5pbmRleE9mKHNpZ25hbGluZ1N0YXRlKSAhPT0gLTE7XG59XG5cbmZ1bmN0aW9uIG1heWJlQWRkQ2FuZGlkYXRlKGljZVRyYW5zcG9ydCwgY2FuZGlkYXRlKSB7XG4gIC8vIEVkZ2UncyBpbnRlcm5hbCByZXByZXNlbnRhdGlvbiBhZGRzIHNvbWUgZmllbGRzIHRoZXJlZm9yZVxuICAvLyBub3QgYWxsIGZpZWxk0ZUgYXJlIHRha2VuIGludG8gYWNjb3VudC5cbiAgdmFyIGFscmVhZHlBZGRlZCA9IGljZVRyYW5zcG9ydC5nZXRSZW1vdGVDYW5kaWRhdGVzKClcbiAgICAgIC5maW5kKGZ1bmN0aW9uKHJlbW90ZUNhbmRpZGF0ZSkge1xuICAgICAgICByZXR1cm4gY2FuZGlkYXRlLmZvdW5kYXRpb24gPT09IHJlbW90ZUNhbmRpZGF0ZS5mb3VuZGF0aW9uICYmXG4gICAgICAgICAgICBjYW5kaWRhdGUuaXAgPT09IHJlbW90ZUNhbmRpZGF0ZS5pcCAmJlxuICAgICAgICAgICAgY2FuZGlkYXRlLnBvcnQgPT09IHJlbW90ZUNhbmRpZGF0ZS5wb3J0ICYmXG4gICAgICAgICAgICBjYW5kaWRhdGUucHJpb3JpdHkgPT09IHJlbW90ZUNhbmRpZGF0ZS5wcmlvcml0eSAmJlxuICAgICAgICAgICAgY2FuZGlkYXRlLnByb3RvY29sID09PSByZW1vdGVDYW5kaWRhdGUucHJvdG9jb2wgJiZcbiAgICAgICAgICAgIGNhbmRpZGF0ZS50eXBlID09PSByZW1vdGVDYW5kaWRhdGUudHlwZTtcbiAgICAgIH0pO1xuICBpZiAoIWFscmVhZHlBZGRlZCkge1xuICAgIGljZVRyYW5zcG9ydC5hZGRSZW1vdGVDYW5kaWRhdGUoY2FuZGlkYXRlKTtcbiAgfVxuICByZXR1cm4gIWFscmVhZHlBZGRlZDtcbn1cblxuXG5mdW5jdGlvbiBtYWtlRXJyb3IobmFtZSwgZGVzY3JpcHRpb24pIHtcbiAgdmFyIGUgPSBuZXcgRXJyb3IoZGVzY3JpcHRpb24pO1xuICBlLm5hbWUgPSBuYW1lO1xuICAvLyBsZWdhY3kgZXJyb3IgY29kZXMgZnJvbSBodHRwczovL2hleWNhbS5naXRodWIuaW8vd2ViaWRsLyNpZGwtRE9NRXhjZXB0aW9uLWVycm9yLW5hbWVzXG4gIGUuY29kZSA9IHtcbiAgICBOb3RTdXBwb3J0ZWRFcnJvcjogOSxcbiAgICBJbnZhbGlkU3RhdGVFcnJvcjogMTEsXG4gICAgSW52YWxpZEFjY2Vzc0Vycm9yOiAxNSxcbiAgICBUeXBlRXJyb3I6IHVuZGVmaW5lZCxcbiAgICBPcGVyYXRpb25FcnJvcjogdW5kZWZpbmVkXG4gIH1bbmFtZV07XG4gIHJldHVybiBlO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHdpbmRvdywgZWRnZVZlcnNpb24pIHtcbiAgLy8gaHR0cHM6Ly93M2MuZ2l0aHViLmlvL21lZGlhY2FwdHVyZS1tYWluLyNtZWRpYXN0cmVhbVxuICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gYWRkIHRoZSB0cmFjayB0byB0aGUgc3RyZWFtIGFuZFxuICAvLyBkaXNwYXRjaCB0aGUgZXZlbnQgb3Vyc2VsdmVzLlxuICBmdW5jdGlvbiBhZGRUcmFja1RvU3RyZWFtQW5kRmlyZUV2ZW50KHRyYWNrLCBzdHJlYW0pIHtcbiAgICBzdHJlYW0uYWRkVHJhY2sodHJhY2spO1xuICAgIHN0cmVhbS5kaXNwYXRjaEV2ZW50KG5ldyB3aW5kb3cuTWVkaWFTdHJlYW1UcmFja0V2ZW50KCdhZGR0cmFjaycsXG4gICAgICAgIHt0cmFjazogdHJhY2t9KSk7XG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmVUcmFja0Zyb21TdHJlYW1BbmRGaXJlRXZlbnQodHJhY2ssIHN0cmVhbSkge1xuICAgIHN0cmVhbS5yZW1vdmVUcmFjayh0cmFjayk7XG4gICAgc3RyZWFtLmRpc3BhdGNoRXZlbnQobmV3IHdpbmRvdy5NZWRpYVN0cmVhbVRyYWNrRXZlbnQoJ3JlbW92ZXRyYWNrJyxcbiAgICAgICAge3RyYWNrOiB0cmFja30pKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGZpcmVBZGRUcmFjayhwYywgdHJhY2ssIHJlY2VpdmVyLCBzdHJlYW1zKSB7XG4gICAgdmFyIHRyYWNrRXZlbnQgPSBuZXcgRXZlbnQoJ3RyYWNrJyk7XG4gICAgdHJhY2tFdmVudC50cmFjayA9IHRyYWNrO1xuICAgIHRyYWNrRXZlbnQucmVjZWl2ZXIgPSByZWNlaXZlcjtcbiAgICB0cmFja0V2ZW50LnRyYW5zY2VpdmVyID0ge3JlY2VpdmVyOiByZWNlaXZlcn07XG4gICAgdHJhY2tFdmVudC5zdHJlYW1zID0gc3RyZWFtcztcbiAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIHBjLl9kaXNwYXRjaEV2ZW50KCd0cmFjaycsIHRyYWNrRXZlbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgdmFyIFJUQ1BlZXJDb25uZWN0aW9uID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgdmFyIHBjID0gdGhpcztcblxuICAgIHZhciBfZXZlbnRUYXJnZXQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgWydhZGRFdmVudExpc3RlbmVyJywgJ3JlbW92ZUV2ZW50TGlzdGVuZXInLCAnZGlzcGF0Y2hFdmVudCddXG4gICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgICAgICAgIHBjW21ldGhvZF0gPSBfZXZlbnRUYXJnZXRbbWV0aG9kXS5iaW5kKF9ldmVudFRhcmdldCk7XG4gICAgICAgIH0pO1xuXG4gICAgdGhpcy5jYW5Ucmlja2xlSWNlQ2FuZGlkYXRlcyA9IG51bGw7XG5cbiAgICB0aGlzLm5lZWROZWdvdGlhdGlvbiA9IGZhbHNlO1xuXG4gICAgdGhpcy5sb2NhbFN0cmVhbXMgPSBbXTtcbiAgICB0aGlzLnJlbW90ZVN0cmVhbXMgPSBbXTtcblxuICAgIHRoaXMuX2xvY2FsRGVzY3JpcHRpb24gPSBudWxsO1xuICAgIHRoaXMuX3JlbW90ZURlc2NyaXB0aW9uID0gbnVsbDtcblxuICAgIHRoaXMuc2lnbmFsaW5nU3RhdGUgPSAnc3RhYmxlJztcbiAgICB0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSA9ICduZXcnO1xuICAgIHRoaXMuY29ubmVjdGlvblN0YXRlID0gJ25ldyc7XG4gICAgdGhpcy5pY2VHYXRoZXJpbmdTdGF0ZSA9ICduZXcnO1xuXG4gICAgY29uZmlnID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb25maWcgfHwge30pKTtcblxuICAgIHRoaXMudXNpbmdCdW5kbGUgPSBjb25maWcuYnVuZGxlUG9saWN5ID09PSAnbWF4LWJ1bmRsZSc7XG4gICAgaWYgKGNvbmZpZy5ydGNwTXV4UG9saWN5ID09PSAnbmVnb3RpYXRlJykge1xuICAgICAgdGhyb3cobWFrZUVycm9yKCdOb3RTdXBwb3J0ZWRFcnJvcicsXG4gICAgICAgICAgJ3J0Y3BNdXhQb2xpY3kgXFwnbmVnb3RpYXRlXFwnIGlzIG5vdCBzdXBwb3J0ZWQnKSk7XG4gICAgfSBlbHNlIGlmICghY29uZmlnLnJ0Y3BNdXhQb2xpY3kpIHtcbiAgICAgIGNvbmZpZy5ydGNwTXV4UG9saWN5ID0gJ3JlcXVpcmUnO1xuICAgIH1cblxuICAgIHN3aXRjaCAoY29uZmlnLmljZVRyYW5zcG9ydFBvbGljeSkge1xuICAgICAgY2FzZSAnYWxsJzpcbiAgICAgIGNhc2UgJ3JlbGF5JzpcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjb25maWcuaWNlVHJhbnNwb3J0UG9saWN5ID0gJ2FsbCc7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHN3aXRjaCAoY29uZmlnLmJ1bmRsZVBvbGljeSkge1xuICAgICAgY2FzZSAnYmFsYW5jZWQnOlxuICAgICAgY2FzZSAnbWF4LWNvbXBhdCc6XG4gICAgICBjYXNlICdtYXgtYnVuZGxlJzpcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjb25maWcuYnVuZGxlUG9saWN5ID0gJ2JhbGFuY2VkJztcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgY29uZmlnLmljZVNlcnZlcnMgPSBmaWx0ZXJJY2VTZXJ2ZXJzKGNvbmZpZy5pY2VTZXJ2ZXJzIHx8IFtdLCBlZGdlVmVyc2lvbik7XG5cbiAgICB0aGlzLl9pY2VHYXRoZXJlcnMgPSBbXTtcbiAgICBpZiAoY29uZmlnLmljZUNhbmRpZGF0ZVBvb2xTaXplKSB7XG4gICAgICBmb3IgKHZhciBpID0gY29uZmlnLmljZUNhbmRpZGF0ZVBvb2xTaXplOyBpID4gMDsgaS0tKSB7XG4gICAgICAgIHRoaXMuX2ljZUdhdGhlcmVycy5wdXNoKG5ldyB3aW5kb3cuUlRDSWNlR2F0aGVyZXIoe1xuICAgICAgICAgIGljZVNlcnZlcnM6IGNvbmZpZy5pY2VTZXJ2ZXJzLFxuICAgICAgICAgIGdhdGhlclBvbGljeTogY29uZmlnLmljZVRyYW5zcG9ydFBvbGljeVxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbmZpZy5pY2VDYW5kaWRhdGVQb29sU2l6ZSA9IDA7XG4gICAgfVxuXG4gICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuXG4gICAgLy8gcGVyLXRyYWNrIGljZUdhdGhlcnMsIGljZVRyYW5zcG9ydHMsIGR0bHNUcmFuc3BvcnRzLCBydHBTZW5kZXJzLCAuLi5cbiAgICAvLyBldmVyeXRoaW5nIHRoYXQgaXMgbmVlZGVkIHRvIGRlc2NyaWJlIGEgU0RQIG0tbGluZS5cbiAgICB0aGlzLnRyYW5zY2VpdmVycyA9IFtdO1xuXG4gICAgdGhpcy5fc2RwU2Vzc2lvbklkID0gU0RQVXRpbHMuZ2VuZXJhdGVTZXNzaW9uSWQoKTtcbiAgICB0aGlzLl9zZHBTZXNzaW9uVmVyc2lvbiA9IDA7XG5cbiAgICB0aGlzLl9kdGxzUm9sZSA9IHVuZGVmaW5lZDsgLy8gcm9sZSBmb3IgYT1zZXR1cCB0byB1c2UgaW4gYW5zd2Vycy5cblxuICAgIHRoaXMuX2lzQ2xvc2VkID0gZmFsc2U7XG4gIH07XG5cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSwgJ2xvY2FsRGVzY3JpcHRpb24nLCB7XG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbG9jYWxEZXNjcmlwdGlvbjtcbiAgICB9XG4gIH0pO1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLCAncmVtb3RlRGVzY3JpcHRpb24nLCB7XG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcmVtb3RlRGVzY3JpcHRpb247XG4gICAgfVxuICB9KTtcblxuICAvLyBzZXQgdXAgZXZlbnQgaGFuZGxlcnMgb24gcHJvdG90eXBlXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5vbmljZWNhbmRpZGF0ZSA9IG51bGw7XG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5vbmFkZHN0cmVhbSA9IG51bGw7XG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5vbnRyYWNrID0gbnVsbDtcbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLm9ucmVtb3Zlc3RyZWFtID0gbnVsbDtcbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLm9uc2lnbmFsaW5nc3RhdGVjaGFuZ2UgPSBudWxsO1xuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUub25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2UgPSBudWxsO1xuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUub25jb25uZWN0aW9uc3RhdGVjaGFuZ2UgPSBudWxsO1xuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUub25pY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZSA9IG51bGw7XG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5vbm5lZ290aWF0aW9ubmVlZGVkID0gbnVsbDtcbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLm9uZGF0YWNoYW5uZWwgPSBudWxsO1xuXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fZGlzcGF0Y2hFdmVudCA9IGZ1bmN0aW9uKG5hbWUsIGV2ZW50KSB7XG4gICAgaWYgKHRoaXMuX2lzQ2xvc2VkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgaWYgKHR5cGVvZiB0aGlzWydvbicgKyBuYW1lXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhpc1snb24nICsgbmFtZV0oZXZlbnQpO1xuICAgIH1cbiAgfTtcblxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX2VtaXRHYXRoZXJpbmdTdGF0ZUNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnaWNlZ2F0aGVyaW5nc3RhdGVjaGFuZ2UnKTtcbiAgICB0aGlzLl9kaXNwYXRjaEV2ZW50KCdpY2VnYXRoZXJpbmdzdGF0ZWNoYW5nZScsIGV2ZW50KTtcbiAgfTtcblxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0Q29uZmlndXJhdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLl9jb25maWc7XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldExvY2FsU3RyZWFtcyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmxvY2FsU3RyZWFtcztcbiAgfTtcblxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0UmVtb3RlU3RyZWFtcyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnJlbW90ZVN0cmVhbXM7XG4gIH07XG5cbiAgLy8gaW50ZXJuYWwgaGVscGVyIHRvIGNyZWF0ZSBhIHRyYW5zY2VpdmVyIG9iamVjdC5cbiAgLy8gKHdoaWNoIGlzIG5vdCB5ZXQgdGhlIHNhbWUgYXMgdGhlIFdlYlJUQyAxLjAgdHJhbnNjZWl2ZXIpXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fY3JlYXRlVHJhbnNjZWl2ZXIgPSBmdW5jdGlvbihraW5kLCBkb05vdEFkZCkge1xuICAgIHZhciBoYXNCdW5kbGVUcmFuc3BvcnQgPSB0aGlzLnRyYW5zY2VpdmVycy5sZW5ndGggPiAwO1xuICAgIHZhciB0cmFuc2NlaXZlciA9IHtcbiAgICAgIHRyYWNrOiBudWxsLFxuICAgICAgaWNlR2F0aGVyZXI6IG51bGwsXG4gICAgICBpY2VUcmFuc3BvcnQ6IG51bGwsXG4gICAgICBkdGxzVHJhbnNwb3J0OiBudWxsLFxuICAgICAgbG9jYWxDYXBhYmlsaXRpZXM6IG51bGwsXG4gICAgICByZW1vdGVDYXBhYmlsaXRpZXM6IG51bGwsXG4gICAgICBydHBTZW5kZXI6IG51bGwsXG4gICAgICBydHBSZWNlaXZlcjogbnVsbCxcbiAgICAgIGtpbmQ6IGtpbmQsXG4gICAgICBtaWQ6IG51bGwsXG4gICAgICBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzOiBudWxsLFxuICAgICAgcmVjdkVuY29kaW5nUGFyYW1ldGVyczogbnVsbCxcbiAgICAgIHN0cmVhbTogbnVsbCxcbiAgICAgIGFzc29jaWF0ZWRSZW1vdGVNZWRpYVN0cmVhbXM6IFtdLFxuICAgICAgd2FudFJlY2VpdmU6IHRydWVcbiAgICB9O1xuICAgIGlmICh0aGlzLnVzaW5nQnVuZGxlICYmIGhhc0J1bmRsZVRyYW5zcG9ydCkge1xuICAgICAgdHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0ID0gdGhpcy50cmFuc2NlaXZlcnNbMF0uaWNlVHJhbnNwb3J0O1xuICAgICAgdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydCA9IHRoaXMudHJhbnNjZWl2ZXJzWzBdLmR0bHNUcmFuc3BvcnQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciB0cmFuc3BvcnRzID0gdGhpcy5fY3JlYXRlSWNlQW5kRHRsc1RyYW5zcG9ydHMoKTtcbiAgICAgIHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCA9IHRyYW5zcG9ydHMuaWNlVHJhbnNwb3J0O1xuICAgICAgdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydCA9IHRyYW5zcG9ydHMuZHRsc1RyYW5zcG9ydDtcbiAgICB9XG4gICAgaWYgKCFkb05vdEFkZCkge1xuICAgICAgdGhpcy50cmFuc2NlaXZlcnMucHVzaCh0cmFuc2NlaXZlcik7XG4gICAgfVxuICAgIHJldHVybiB0cmFuc2NlaXZlcjtcbiAgfTtcblxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkVHJhY2sgPSBmdW5jdGlvbih0cmFjaywgc3RyZWFtKSB7XG4gICAgaWYgKHRoaXMuX2lzQ2xvc2VkKSB7XG4gICAgICB0aHJvdyBtYWtlRXJyb3IoJ0ludmFsaWRTdGF0ZUVycm9yJyxcbiAgICAgICAgICAnQXR0ZW1wdGVkIHRvIGNhbGwgYWRkVHJhY2sgb24gYSBjbG9zZWQgcGVlcmNvbm5lY3Rpb24uJyk7XG4gICAgfVxuXG4gICAgdmFyIGFscmVhZHlFeGlzdHMgPSB0aGlzLnRyYW5zY2VpdmVycy5maW5kKGZ1bmN0aW9uKHMpIHtcbiAgICAgIHJldHVybiBzLnRyYWNrID09PSB0cmFjaztcbiAgICB9KTtcblxuICAgIGlmIChhbHJlYWR5RXhpc3RzKSB7XG4gICAgICB0aHJvdyBtYWtlRXJyb3IoJ0ludmFsaWRBY2Nlc3NFcnJvcicsICdUcmFjayBhbHJlYWR5IGV4aXN0cy4nKTtcbiAgICB9XG5cbiAgICB2YXIgdHJhbnNjZWl2ZXI7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnRyYW5zY2VpdmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKCF0aGlzLnRyYW5zY2VpdmVyc1tpXS50cmFjayAmJlxuICAgICAgICAgIHRoaXMudHJhbnNjZWl2ZXJzW2ldLmtpbmQgPT09IHRyYWNrLmtpbmQpIHtcbiAgICAgICAgdHJhbnNjZWl2ZXIgPSB0aGlzLnRyYW5zY2VpdmVyc1tpXTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCF0cmFuc2NlaXZlcikge1xuICAgICAgdHJhbnNjZWl2ZXIgPSB0aGlzLl9jcmVhdGVUcmFuc2NlaXZlcih0cmFjay5raW5kKTtcbiAgICB9XG5cbiAgICB0aGlzLl9tYXliZUZpcmVOZWdvdGlhdGlvbk5lZWRlZCgpO1xuXG4gICAgaWYgKHRoaXMubG9jYWxTdHJlYW1zLmluZGV4T2Yoc3RyZWFtKSA9PT0gLTEpIHtcbiAgICAgIHRoaXMubG9jYWxTdHJlYW1zLnB1c2goc3RyZWFtKTtcbiAgICB9XG5cbiAgICB0cmFuc2NlaXZlci50cmFjayA9IHRyYWNrO1xuICAgIHRyYW5zY2VpdmVyLnN0cmVhbSA9IHN0cmVhbTtcbiAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIgPSBuZXcgd2luZG93LlJUQ1J0cFNlbmRlcih0cmFjayxcbiAgICAgICAgdHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydCk7XG4gICAgcmV0dXJuIHRyYW5zY2VpdmVyLnJ0cFNlbmRlcjtcbiAgfTtcblxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkU3RyZWFtID0gZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgdmFyIHBjID0gdGhpcztcbiAgICBpZiAoZWRnZVZlcnNpb24gPj0gMTUwMjUpIHtcbiAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7XG4gICAgICAgIHBjLmFkZFRyYWNrKHRyYWNrLCBzdHJlYW0pO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIENsb25lIGlzIG5lY2Vzc2FyeSBmb3IgbG9jYWwgZGVtb3MgbW9zdGx5LCBhdHRhY2hpbmcgZGlyZWN0bHlcbiAgICAgIC8vIHRvIHR3byBkaWZmZXJlbnQgc2VuZGVycyBkb2VzIG5vdCB3b3JrIChidWlsZCAxMDU0NykuXG4gICAgICAvLyBGaXhlZCBpbiAxNTAyNSAob3IgZWFybGllcilcbiAgICAgIHZhciBjbG9uZWRTdHJlYW0gPSBzdHJlYW0uY2xvbmUoKTtcbiAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrLCBpZHgpIHtcbiAgICAgICAgdmFyIGNsb25lZFRyYWNrID0gY2xvbmVkU3RyZWFtLmdldFRyYWNrcygpW2lkeF07XG4gICAgICAgIHRyYWNrLmFkZEV2ZW50TGlzdGVuZXIoJ2VuYWJsZWQnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgIGNsb25lZFRyYWNrLmVuYWJsZWQgPSBldmVudC5lbmFibGVkO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgY2xvbmVkU3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHtcbiAgICAgICAgcGMuYWRkVHJhY2sodHJhY2ssIGNsb25lZFN0cmVhbSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVRyYWNrID0gZnVuY3Rpb24oc2VuZGVyKSB7XG4gICAgaWYgKHRoaXMuX2lzQ2xvc2VkKSB7XG4gICAgICB0aHJvdyBtYWtlRXJyb3IoJ0ludmFsaWRTdGF0ZUVycm9yJyxcbiAgICAgICAgICAnQXR0ZW1wdGVkIHRvIGNhbGwgcmVtb3ZlVHJhY2sgb24gYSBjbG9zZWQgcGVlcmNvbm5lY3Rpb24uJyk7XG4gICAgfVxuXG4gICAgaWYgKCEoc2VuZGVyIGluc3RhbmNlb2Ygd2luZG93LlJUQ1J0cFNlbmRlcikpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IDEgb2YgUlRDUGVlckNvbm5lY3Rpb24ucmVtb3ZlVHJhY2sgJyArXG4gICAgICAgICAgJ2RvZXMgbm90IGltcGxlbWVudCBpbnRlcmZhY2UgUlRDUnRwU2VuZGVyLicpO1xuICAgIH1cblxuICAgIHZhciB0cmFuc2NlaXZlciA9IHRoaXMudHJhbnNjZWl2ZXJzLmZpbmQoZnVuY3Rpb24odCkge1xuICAgICAgcmV0dXJuIHQucnRwU2VuZGVyID09PSBzZW5kZXI7XG4gICAgfSk7XG5cbiAgICBpZiAoIXRyYW5zY2VpdmVyKSB7XG4gICAgICB0aHJvdyBtYWtlRXJyb3IoJ0ludmFsaWRBY2Nlc3NFcnJvcicsXG4gICAgICAgICAgJ1NlbmRlciB3YXMgbm90IGNyZWF0ZWQgYnkgdGhpcyBjb25uZWN0aW9uLicpO1xuICAgIH1cbiAgICB2YXIgc3RyZWFtID0gdHJhbnNjZWl2ZXIuc3RyZWFtO1xuXG4gICAgdHJhbnNjZWl2ZXIucnRwU2VuZGVyLnN0b3AoKTtcbiAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIgPSBudWxsO1xuICAgIHRyYW5zY2VpdmVyLnRyYWNrID0gbnVsbDtcbiAgICB0cmFuc2NlaXZlci5zdHJlYW0gPSBudWxsO1xuXG4gICAgLy8gcmVtb3ZlIHRoZSBzdHJlYW0gZnJvbSB0aGUgc2V0IG9mIGxvY2FsIHN0cmVhbXNcbiAgICB2YXIgbG9jYWxTdHJlYW1zID0gdGhpcy50cmFuc2NlaXZlcnMubWFwKGZ1bmN0aW9uKHQpIHtcbiAgICAgIHJldHVybiB0LnN0cmVhbTtcbiAgICB9KTtcbiAgICBpZiAobG9jYWxTdHJlYW1zLmluZGV4T2Yoc3RyZWFtKSA9PT0gLTEgJiZcbiAgICAgICAgdGhpcy5sb2NhbFN0cmVhbXMuaW5kZXhPZihzdHJlYW0pID4gLTEpIHtcbiAgICAgIHRoaXMubG9jYWxTdHJlYW1zLnNwbGljZSh0aGlzLmxvY2FsU3RyZWFtcy5pbmRleE9mKHN0cmVhbSksIDEpO1xuICAgIH1cblxuICAgIHRoaXMuX21heWJlRmlyZU5lZ290aWF0aW9uTmVlZGVkKCk7XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgIHZhciBwYyA9IHRoaXM7XG4gICAgc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHtcbiAgICAgIHZhciBzZW5kZXIgPSBwYy5nZXRTZW5kZXJzKCkuZmluZChmdW5jdGlvbihzKSB7XG4gICAgICAgIHJldHVybiBzLnRyYWNrID09PSB0cmFjaztcbiAgICAgIH0pO1xuICAgICAgaWYgKHNlbmRlcikge1xuICAgICAgICBwYy5yZW1vdmVUcmFjayhzZW5kZXIpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTZW5kZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMudHJhbnNjZWl2ZXJzLmZpbHRlcihmdW5jdGlvbih0cmFuc2NlaXZlcikge1xuICAgICAgcmV0dXJuICEhdHJhbnNjZWl2ZXIucnRwU2VuZGVyO1xuICAgIH0pXG4gICAgLm1hcChmdW5jdGlvbih0cmFuc2NlaXZlcikge1xuICAgICAgcmV0dXJuIHRyYW5zY2VpdmVyLnJ0cFNlbmRlcjtcbiAgICB9KTtcbiAgfTtcblxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0UmVjZWl2ZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMudHJhbnNjZWl2ZXJzLmZpbHRlcihmdW5jdGlvbih0cmFuc2NlaXZlcikge1xuICAgICAgcmV0dXJuICEhdHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXI7XG4gICAgfSlcbiAgICAubWFwKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7XG4gICAgICByZXR1cm4gdHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXI7XG4gICAgfSk7XG4gIH07XG5cblxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX2NyZWF0ZUljZUdhdGhlcmVyID0gZnVuY3Rpb24oc2RwTUxpbmVJbmRleCxcbiAgICAgIHVzaW5nQnVuZGxlKSB7XG4gICAgdmFyIHBjID0gdGhpcztcbiAgICBpZiAodXNpbmdCdW5kbGUgJiYgc2RwTUxpbmVJbmRleCA+IDApIHtcbiAgICAgIHJldHVybiB0aGlzLnRyYW5zY2VpdmVyc1swXS5pY2VHYXRoZXJlcjtcbiAgICB9IGVsc2UgaWYgKHRoaXMuX2ljZUdhdGhlcmVycy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9pY2VHYXRoZXJlcnMuc2hpZnQoKTtcbiAgICB9XG4gICAgdmFyIGljZUdhdGhlcmVyID0gbmV3IHdpbmRvdy5SVENJY2VHYXRoZXJlcih7XG4gICAgICBpY2VTZXJ2ZXJzOiB0aGlzLl9jb25maWcuaWNlU2VydmVycyxcbiAgICAgIGdhdGhlclBvbGljeTogdGhpcy5fY29uZmlnLmljZVRyYW5zcG9ydFBvbGljeVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpY2VHYXRoZXJlciwgJ3N0YXRlJyxcbiAgICAgICAge3ZhbHVlOiAnbmV3Jywgd3JpdGFibGU6IHRydWV9XG4gICAgKTtcblxuICAgIHRoaXMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLmJ1ZmZlcmVkQ2FuZGlkYXRlRXZlbnRzID0gW107XG4gICAgdGhpcy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uYnVmZmVyQ2FuZGlkYXRlcyA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICB2YXIgZW5kID0gIWV2ZW50LmNhbmRpZGF0ZSB8fCBPYmplY3Qua2V5cyhldmVudC5jYW5kaWRhdGUpLmxlbmd0aCA9PT0gMDtcbiAgICAgIC8vIHBvbHlmaWxsIHNpbmNlIFJUQ0ljZUdhdGhlcmVyLnN0YXRlIGlzIG5vdCBpbXBsZW1lbnRlZCBpblxuICAgICAgLy8gRWRnZSAxMDU0NyB5ZXQuXG4gICAgICBpY2VHYXRoZXJlci5zdGF0ZSA9IGVuZCA/ICdjb21wbGV0ZWQnIDogJ2dhdGhlcmluZyc7XG4gICAgICBpZiAocGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLmJ1ZmZlcmVkQ2FuZGlkYXRlRXZlbnRzICE9PSBudWxsKSB7XG4gICAgICAgIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5idWZmZXJlZENhbmRpZGF0ZUV2ZW50cy5wdXNoKGV2ZW50KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGljZUdhdGhlcmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvY2FsY2FuZGlkYXRlJyxcbiAgICAgIHRoaXMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLmJ1ZmZlckNhbmRpZGF0ZXMpO1xuICAgIHJldHVybiBpY2VHYXRoZXJlcjtcbiAgfTtcblxuICAvLyBzdGFydCBnYXRoZXJpbmcgZnJvbSBhbiBSVENJY2VHYXRoZXJlci5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl9nYXRoZXIgPSBmdW5jdGlvbihtaWQsIHNkcE1MaW5lSW5kZXgpIHtcbiAgICB2YXIgcGMgPSB0aGlzO1xuICAgIHZhciBpY2VHYXRoZXJlciA9IHRoaXMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLmljZUdhdGhlcmVyO1xuICAgIGlmIChpY2VHYXRoZXJlci5vbmxvY2FsY2FuZGlkYXRlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBidWZmZXJlZENhbmRpZGF0ZUV2ZW50cyA9XG4gICAgICB0aGlzLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5idWZmZXJlZENhbmRpZGF0ZUV2ZW50cztcbiAgICB0aGlzLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5idWZmZXJlZENhbmRpZGF0ZUV2ZW50cyA9IG51bGw7XG4gICAgaWNlR2F0aGVyZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignbG9jYWxjYW5kaWRhdGUnLFxuICAgICAgdGhpcy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uYnVmZmVyQ2FuZGlkYXRlcyk7XG4gICAgaWNlR2F0aGVyZXIub25sb2NhbGNhbmRpZGF0ZSA9IGZ1bmN0aW9uKGV2dCkge1xuICAgICAgaWYgKHBjLnVzaW5nQnVuZGxlICYmIHNkcE1MaW5lSW5kZXggPiAwKSB7XG4gICAgICAgIC8vIGlmIHdlIGtub3cgdGhhdCB3ZSB1c2UgYnVuZGxlIHdlIGNhbiBkcm9wIGNhbmRpZGF0ZXMgd2l0aFxuICAgICAgICAvLyDRlWRwTUxpbmVJbmRleCA+IDAuIElmIHdlIGRvbid0IGRvIHRoaXMgdGhlbiBvdXIgc3RhdGUgZ2V0c1xuICAgICAgICAvLyBjb25mdXNlZCBzaW5jZSB3ZSBkaXNwb3NlIHRoZSBleHRyYSBpY2UgZ2F0aGVyZXIuXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnaWNlY2FuZGlkYXRlJyk7XG4gICAgICBldmVudC5jYW5kaWRhdGUgPSB7c2RwTWlkOiBtaWQsIHNkcE1MaW5lSW5kZXg6IHNkcE1MaW5lSW5kZXh9O1xuXG4gICAgICB2YXIgY2FuZCA9IGV2dC5jYW5kaWRhdGU7XG4gICAgICAvLyBFZGdlIGVtaXRzIGFuIGVtcHR5IG9iamVjdCBmb3IgUlRDSWNlQ2FuZGlkYXRlQ29tcGxldGXigKVcbiAgICAgIHZhciBlbmQgPSAhY2FuZCB8fCBPYmplY3Qua2V5cyhjYW5kKS5sZW5ndGggPT09IDA7XG4gICAgICBpZiAoZW5kKSB7XG4gICAgICAgIC8vIHBvbHlmaWxsIHNpbmNlIFJUQ0ljZUdhdGhlcmVyLnN0YXRlIGlzIG5vdCBpbXBsZW1lbnRlZCBpblxuICAgICAgICAvLyBFZGdlIDEwNTQ3IHlldC5cbiAgICAgICAgaWYgKGljZUdhdGhlcmVyLnN0YXRlID09PSAnbmV3JyB8fCBpY2VHYXRoZXJlci5zdGF0ZSA9PT0gJ2dhdGhlcmluZycpIHtcbiAgICAgICAgICBpY2VHYXRoZXJlci5zdGF0ZSA9ICdjb21wbGV0ZWQnO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoaWNlR2F0aGVyZXIuc3RhdGUgPT09ICduZXcnKSB7XG4gICAgICAgICAgaWNlR2F0aGVyZXIuc3RhdGUgPSAnZ2F0aGVyaW5nJztcbiAgICAgICAgfVxuICAgICAgICAvLyBSVENJY2VDYW5kaWRhdGUgZG9lc24ndCBoYXZlIGEgY29tcG9uZW50LCBuZWVkcyB0byBiZSBhZGRlZFxuICAgICAgICBjYW5kLmNvbXBvbmVudCA9IDE7XG4gICAgICAgIC8vIGFsc28gdGhlIHVzZXJuYW1lRnJhZ21lbnQuIFRPRE86IHVwZGF0ZSBTRFAgdG8gdGFrZSBib3RoIHZhcmlhbnRzLlxuICAgICAgICBjYW5kLnVmcmFnID0gaWNlR2F0aGVyZXIuZ2V0TG9jYWxQYXJhbWV0ZXJzKCkudXNlcm5hbWVGcmFnbWVudDtcblxuICAgICAgICB2YXIgc2VyaWFsaXplZENhbmRpZGF0ZSA9IFNEUFV0aWxzLndyaXRlQ2FuZGlkYXRlKGNhbmQpO1xuICAgICAgICBldmVudC5jYW5kaWRhdGUgPSBPYmplY3QuYXNzaWduKGV2ZW50LmNhbmRpZGF0ZSxcbiAgICAgICAgICAgIFNEUFV0aWxzLnBhcnNlQ2FuZGlkYXRlKHNlcmlhbGl6ZWRDYW5kaWRhdGUpKTtcblxuICAgICAgICBldmVudC5jYW5kaWRhdGUuY2FuZGlkYXRlID0gc2VyaWFsaXplZENhbmRpZGF0ZTtcbiAgICAgICAgZXZlbnQuY2FuZGlkYXRlLnRvSlNPTiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjYW5kaWRhdGU6IGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUsXG4gICAgICAgICAgICBzZHBNaWQ6IGV2ZW50LmNhbmRpZGF0ZS5zZHBNaWQsXG4gICAgICAgICAgICBzZHBNTGluZUluZGV4OiBldmVudC5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleCxcbiAgICAgICAgICAgIHVzZXJuYW1lRnJhZ21lbnQ6IGV2ZW50LmNhbmRpZGF0ZS51c2VybmFtZUZyYWdtZW50XG4gICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gdXBkYXRlIGxvY2FsIGRlc2NyaXB0aW9uLlxuICAgICAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuZ2V0TWVkaWFTZWN0aW9ucyhwYy5fbG9jYWxEZXNjcmlwdGlvbi5zZHApO1xuICAgICAgaWYgKCFlbmQpIHtcbiAgICAgICAgc2VjdGlvbnNbZXZlbnQuY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXhdICs9XG4gICAgICAgICAgICAnYT0nICsgZXZlbnQuY2FuZGlkYXRlLmNhbmRpZGF0ZSArICdcXHJcXG4nO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VjdGlvbnNbZXZlbnQuY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXhdICs9XG4gICAgICAgICAgICAnYT1lbmQtb2YtY2FuZGlkYXRlc1xcclxcbic7XG4gICAgICB9XG4gICAgICBwYy5fbG9jYWxEZXNjcmlwdGlvbi5zZHAgPVxuICAgICAgICAgIFNEUFV0aWxzLmdldERlc2NyaXB0aW9uKHBjLl9sb2NhbERlc2NyaXB0aW9uLnNkcCkgK1xuICAgICAgICAgIHNlY3Rpb25zLmpvaW4oJycpO1xuICAgICAgdmFyIGNvbXBsZXRlID0gcGMudHJhbnNjZWl2ZXJzLmV2ZXJ5KGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7XG4gICAgICAgIHJldHVybiB0cmFuc2NlaXZlci5pY2VHYXRoZXJlciAmJlxuICAgICAgICAgICAgdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIuc3RhdGUgPT09ICdjb21wbGV0ZWQnO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChwYy5pY2VHYXRoZXJpbmdTdGF0ZSAhPT0gJ2dhdGhlcmluZycpIHtcbiAgICAgICAgcGMuaWNlR2F0aGVyaW5nU3RhdGUgPSAnZ2F0aGVyaW5nJztcbiAgICAgICAgcGMuX2VtaXRHYXRoZXJpbmdTdGF0ZUNoYW5nZSgpO1xuICAgICAgfVxuXG4gICAgICAvLyBFbWl0IGNhbmRpZGF0ZS4gQWxzbyBlbWl0IG51bGwgY2FuZGlkYXRlIHdoZW4gYWxsIGdhdGhlcmVycyBhcmVcbiAgICAgIC8vIGNvbXBsZXRlLlxuICAgICAgaWYgKCFlbmQpIHtcbiAgICAgICAgcGMuX2Rpc3BhdGNoRXZlbnQoJ2ljZWNhbmRpZGF0ZScsIGV2ZW50KTtcbiAgICAgIH1cbiAgICAgIGlmIChjb21wbGV0ZSkge1xuICAgICAgICBwYy5fZGlzcGF0Y2hFdmVudCgnaWNlY2FuZGlkYXRlJywgbmV3IEV2ZW50KCdpY2VjYW5kaWRhdGUnKSk7XG4gICAgICAgIHBjLmljZUdhdGhlcmluZ1N0YXRlID0gJ2NvbXBsZXRlJztcbiAgICAgICAgcGMuX2VtaXRHYXRoZXJpbmdTdGF0ZUNoYW5nZSgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBlbWl0IGFscmVhZHkgZ2F0aGVyZWQgY2FuZGlkYXRlcy5cbiAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIGJ1ZmZlcmVkQ2FuZGlkYXRlRXZlbnRzLmZvckVhY2goZnVuY3Rpb24oZSkge1xuICAgICAgICBpY2VHYXRoZXJlci5vbmxvY2FsY2FuZGlkYXRlKGUpO1xuICAgICAgfSk7XG4gICAgfSwgMCk7XG4gIH07XG5cbiAgLy8gQ3JlYXRlIElDRSB0cmFuc3BvcnQgYW5kIERUTFMgdHJhbnNwb3J0LlxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX2NyZWF0ZUljZUFuZER0bHNUcmFuc3BvcnRzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHBjID0gdGhpcztcbiAgICB2YXIgaWNlVHJhbnNwb3J0ID0gbmV3IHdpbmRvdy5SVENJY2VUcmFuc3BvcnQobnVsbCk7XG4gICAgaWNlVHJhbnNwb3J0Lm9uaWNlc3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICAgIHBjLl91cGRhdGVJY2VDb25uZWN0aW9uU3RhdGUoKTtcbiAgICAgIHBjLl91cGRhdGVDb25uZWN0aW9uU3RhdGUoKTtcbiAgICB9O1xuXG4gICAgdmFyIGR0bHNUcmFuc3BvcnQgPSBuZXcgd2luZG93LlJUQ0R0bHNUcmFuc3BvcnQoaWNlVHJhbnNwb3J0KTtcbiAgICBkdGxzVHJhbnNwb3J0Lm9uZHRsc3N0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICBwYy5fdXBkYXRlQ29ubmVjdGlvblN0YXRlKCk7XG4gICAgfTtcbiAgICBkdGxzVHJhbnNwb3J0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgIC8vIG9uZXJyb3IgZG9lcyBub3Qgc2V0IHN0YXRlIHRvIGZhaWxlZCBieSBpdHNlbGYuXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZHRsc1RyYW5zcG9ydCwgJ3N0YXRlJyxcbiAgICAgICAgICB7dmFsdWU6ICdmYWlsZWQnLCB3cml0YWJsZTogdHJ1ZX0pO1xuICAgICAgcGMuX3VwZGF0ZUNvbm5lY3Rpb25TdGF0ZSgpO1xuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgaWNlVHJhbnNwb3J0OiBpY2VUcmFuc3BvcnQsXG4gICAgICBkdGxzVHJhbnNwb3J0OiBkdGxzVHJhbnNwb3J0XG4gICAgfTtcbiAgfTtcblxuICAvLyBEZXN0cm95IElDRSBnYXRoZXJlciwgSUNFIHRyYW5zcG9ydCBhbmQgRFRMUyB0cmFuc3BvcnQuXG4gIC8vIFdpdGhvdXQgdHJpZ2dlcmluZyB0aGUgY2FsbGJhY2tzLlxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX2Rpc3Bvc2VJY2VBbmREdGxzVHJhbnNwb3J0cyA9IGZ1bmN0aW9uKFxuICAgICAgc2RwTUxpbmVJbmRleCkge1xuICAgIHZhciBpY2VHYXRoZXJlciA9IHRoaXMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLmljZUdhdGhlcmVyO1xuICAgIGlmIChpY2VHYXRoZXJlcikge1xuICAgICAgZGVsZXRlIGljZUdhdGhlcmVyLm9ubG9jYWxjYW5kaWRhdGU7XG4gICAgICBkZWxldGUgdGhpcy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uaWNlR2F0aGVyZXI7XG4gICAgfVxuICAgIHZhciBpY2VUcmFuc3BvcnQgPSB0aGlzLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5pY2VUcmFuc3BvcnQ7XG4gICAgaWYgKGljZVRyYW5zcG9ydCkge1xuICAgICAgZGVsZXRlIGljZVRyYW5zcG9ydC5vbmljZXN0YXRlY2hhbmdlO1xuICAgICAgZGVsZXRlIHRoaXMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLmljZVRyYW5zcG9ydDtcbiAgICB9XG4gICAgdmFyIGR0bHNUcmFuc3BvcnQgPSB0aGlzLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5kdGxzVHJhbnNwb3J0O1xuICAgIGlmIChkdGxzVHJhbnNwb3J0KSB7XG4gICAgICBkZWxldGUgZHRsc1RyYW5zcG9ydC5vbmR0bHNzdGF0ZWNoYW5nZTtcbiAgICAgIGRlbGV0ZSBkdGxzVHJhbnNwb3J0Lm9uZXJyb3I7XG4gICAgICBkZWxldGUgdGhpcy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0uZHRsc1RyYW5zcG9ydDtcbiAgICB9XG4gIH07XG5cbiAgLy8gU3RhcnQgdGhlIFJUUCBTZW5kZXIgYW5kIFJlY2VpdmVyIGZvciBhIHRyYW5zY2VpdmVyLlxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX3RyYW5zY2VpdmUgPSBmdW5jdGlvbih0cmFuc2NlaXZlcixcbiAgICAgIHNlbmQsIHJlY3YpIHtcbiAgICB2YXIgcGFyYW1zID0gZ2V0Q29tbW9uQ2FwYWJpbGl0aWVzKHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzLFxuICAgICAgICB0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXMpO1xuICAgIGlmIChzZW5kICYmIHRyYW5zY2VpdmVyLnJ0cFNlbmRlcikge1xuICAgICAgcGFyYW1zLmVuY29kaW5ncyA9IHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7XG4gICAgICBwYXJhbXMucnRjcCA9IHtcbiAgICAgICAgY25hbWU6IFNEUFV0aWxzLmxvY2FsQ05hbWUsXG4gICAgICAgIGNvbXBvdW5kOiB0cmFuc2NlaXZlci5ydGNwUGFyYW1ldGVycy5jb21wb3VuZFxuICAgICAgfTtcbiAgICAgIGlmICh0cmFuc2NlaXZlci5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzLmxlbmd0aCkge1xuICAgICAgICBwYXJhbXMucnRjcC5zc3JjID0gdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjO1xuICAgICAgfVxuICAgICAgdHJhbnNjZWl2ZXIucnRwU2VuZGVyLnNlbmQocGFyYW1zKTtcbiAgICB9XG4gICAgaWYgKHJlY3YgJiYgdHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIgJiYgcGFyYW1zLmNvZGVjcy5sZW5ndGggPiAwKSB7XG4gICAgICAvLyByZW1vdmUgUlRYIGZpZWxkIGluIEVkZ2UgMTQ5NDJcbiAgICAgIGlmICh0cmFuc2NlaXZlci5raW5kID09PSAndmlkZW8nXG4gICAgICAgICAgJiYgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVyc1xuICAgICAgICAgICYmIGVkZ2VWZXJzaW9uIDwgMTUwMTkpIHtcbiAgICAgICAgdHJhbnNjZWl2ZXIucmVjdkVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHApIHtcbiAgICAgICAgICBkZWxldGUgcC5ydHg7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHRyYW5zY2VpdmVyLnJlY3ZFbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoKSB7XG4gICAgICAgIHBhcmFtcy5lbmNvZGluZ3MgPSB0cmFuc2NlaXZlci5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFyYW1zLmVuY29kaW5ncyA9IFt7fV07XG4gICAgICB9XG4gICAgICBwYXJhbXMucnRjcCA9IHtcbiAgICAgICAgY29tcG91bmQ6IHRyYW5zY2VpdmVyLnJ0Y3BQYXJhbWV0ZXJzLmNvbXBvdW5kXG4gICAgICB9O1xuICAgICAgaWYgKHRyYW5zY2VpdmVyLnJ0Y3BQYXJhbWV0ZXJzLmNuYW1lKSB7XG4gICAgICAgIHBhcmFtcy5ydGNwLmNuYW1lID0gdHJhbnNjZWl2ZXIucnRjcFBhcmFtZXRlcnMuY25hbWU7XG4gICAgICB9XG4gICAgICBpZiAodHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVycy5sZW5ndGgpIHtcbiAgICAgICAgcGFyYW1zLnJ0Y3Auc3NyYyA9IHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0uc3NyYztcbiAgICAgIH1cbiAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyLnJlY2VpdmUocGFyYW1zKTtcbiAgICB9XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldExvY2FsRGVzY3JpcHRpb24gPSBmdW5jdGlvbihkZXNjcmlwdGlvbikge1xuICAgIHZhciBwYyA9IHRoaXM7XG5cbiAgICAvLyBOb3RlOiBwcmFuc3dlciBpcyBub3Qgc3VwcG9ydGVkLlxuICAgIGlmIChbJ29mZmVyJywgJ2Fuc3dlciddLmluZGV4T2YoZGVzY3JpcHRpb24udHlwZSkgPT09IC0xKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobWFrZUVycm9yKCdUeXBlRXJyb3InLFxuICAgICAgICAgICdVbnN1cHBvcnRlZCB0eXBlIFwiJyArIGRlc2NyaXB0aW9uLnR5cGUgKyAnXCInKSk7XG4gICAgfVxuXG4gICAgaWYgKCFpc0FjdGlvbkFsbG93ZWRJblNpZ25hbGluZ1N0YXRlKCdzZXRMb2NhbERlc2NyaXB0aW9uJyxcbiAgICAgICAgZGVzY3JpcHRpb24udHlwZSwgcGMuc2lnbmFsaW5nU3RhdGUpIHx8IHBjLl9pc0Nsb3NlZCkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG1ha2VFcnJvcignSW52YWxpZFN0YXRlRXJyb3InLFxuICAgICAgICAgICdDYW4gbm90IHNldCBsb2NhbCAnICsgZGVzY3JpcHRpb24udHlwZSArXG4gICAgICAgICAgJyBpbiBzdGF0ZSAnICsgcGMuc2lnbmFsaW5nU3RhdGUpKTtcbiAgICB9XG5cbiAgICB2YXIgc2VjdGlvbnM7XG4gICAgdmFyIHNlc3Npb25wYXJ0O1xuICAgIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnb2ZmZXInKSB7XG4gICAgICAvLyBWRVJZIGxpbWl0ZWQgc3VwcG9ydCBmb3IgU0RQIG11bmdpbmcuIExpbWl0ZWQgdG86XG4gICAgICAvLyAqIGNoYW5naW5nIHRoZSBvcmRlciBvZiBjb2RlY3NcbiAgICAgIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhkZXNjcmlwdGlvbi5zZHApO1xuICAgICAgc2Vzc2lvbnBhcnQgPSBzZWN0aW9ucy5zaGlmdCgpO1xuICAgICAgc2VjdGlvbnMuZm9yRWFjaChmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNkcE1MaW5lSW5kZXgpIHtcbiAgICAgICAgdmFyIGNhcHMgPSBTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMobWVkaWFTZWN0aW9uKTtcbiAgICAgICAgcGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLmxvY2FsQ2FwYWJpbGl0aWVzID0gY2FwcztcbiAgICAgIH0pO1xuXG4gICAgICBwYy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlciwgc2RwTUxpbmVJbmRleCkge1xuICAgICAgICBwYy5fZ2F0aGVyKHRyYW5zY2VpdmVyLm1pZCwgc2RwTUxpbmVJbmRleCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKGRlc2NyaXB0aW9uLnR5cGUgPT09ICdhbnN3ZXInKSB7XG4gICAgICBzZWN0aW9ucyA9IFNEUFV0aWxzLnNwbGl0U2VjdGlvbnMocGMuX3JlbW90ZURlc2NyaXB0aW9uLnNkcCk7XG4gICAgICBzZXNzaW9ucGFydCA9IHNlY3Rpb25zLnNoaWZ0KCk7XG4gICAgICB2YXIgaXNJY2VMaXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgoc2Vzc2lvbnBhcnQsXG4gICAgICAgICAgJ2E9aWNlLWxpdGUnKS5sZW5ndGggPiAwO1xuICAgICAgc2VjdGlvbnMuZm9yRWFjaChmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNkcE1MaW5lSW5kZXgpIHtcbiAgICAgICAgdmFyIHRyYW5zY2VpdmVyID0gcGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdO1xuICAgICAgICB2YXIgaWNlR2F0aGVyZXIgPSB0cmFuc2NlaXZlci5pY2VHYXRoZXJlcjtcbiAgICAgICAgdmFyIGljZVRyYW5zcG9ydCA9IHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydDtcbiAgICAgICAgdmFyIGR0bHNUcmFuc3BvcnQgPSB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0O1xuICAgICAgICB2YXIgbG9jYWxDYXBhYmlsaXRpZXMgPSB0cmFuc2NlaXZlci5sb2NhbENhcGFiaWxpdGllcztcbiAgICAgICAgdmFyIHJlbW90ZUNhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLnJlbW90ZUNhcGFiaWxpdGllcztcblxuICAgICAgICAvLyB0cmVhdCBidW5kbGUtb25seSBhcyBub3QtcmVqZWN0ZWQuXG4gICAgICAgIHZhciByZWplY3RlZCA9IFNEUFV0aWxzLmlzUmVqZWN0ZWQobWVkaWFTZWN0aW9uKSAmJlxuICAgICAgICAgICAgU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1idW5kbGUtb25seScpLmxlbmd0aCA9PT0gMDtcblxuICAgICAgICBpZiAoIXJlamVjdGVkICYmICF0cmFuc2NlaXZlci5yZWplY3RlZCkge1xuICAgICAgICAgIHZhciByZW1vdGVJY2VQYXJhbWV0ZXJzID0gU0RQVXRpbHMuZ2V0SWNlUGFyYW1ldGVycyhcbiAgICAgICAgICAgICAgbWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCk7XG4gICAgICAgICAgdmFyIHJlbW90ZUR0bHNQYXJhbWV0ZXJzID0gU0RQVXRpbHMuZ2V0RHRsc1BhcmFtZXRlcnMoXG4gICAgICAgICAgICAgIG1lZGlhU2VjdGlvbiwgc2Vzc2lvbnBhcnQpO1xuICAgICAgICAgIGlmIChpc0ljZUxpdGUpIHtcbiAgICAgICAgICAgIHJlbW90ZUR0bHNQYXJhbWV0ZXJzLnJvbGUgPSAnc2VydmVyJztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoIXBjLnVzaW5nQnVuZGxlIHx8IHNkcE1MaW5lSW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIHBjLl9nYXRoZXIodHJhbnNjZWl2ZXIubWlkLCBzZHBNTGluZUluZGV4KTtcbiAgICAgICAgICAgIGlmIChpY2VUcmFuc3BvcnQuc3RhdGUgPT09ICduZXcnKSB7XG4gICAgICAgICAgICAgIGljZVRyYW5zcG9ydC5zdGFydChpY2VHYXRoZXJlciwgcmVtb3RlSWNlUGFyYW1ldGVycyxcbiAgICAgICAgICAgICAgICAgIGlzSWNlTGl0ZSA/ICdjb250cm9sbGluZycgOiAnY29udHJvbGxlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGR0bHNUcmFuc3BvcnQuc3RhdGUgPT09ICduZXcnKSB7XG4gICAgICAgICAgICAgIGR0bHNUcmFuc3BvcnQuc3RhcnQocmVtb3RlRHRsc1BhcmFtZXRlcnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIENhbGN1bGF0ZSBpbnRlcnNlY3Rpb24gb2YgY2FwYWJpbGl0aWVzLlxuICAgICAgICAgIHZhciBwYXJhbXMgPSBnZXRDb21tb25DYXBhYmlsaXRpZXMobG9jYWxDYXBhYmlsaXRpZXMsXG4gICAgICAgICAgICAgIHJlbW90ZUNhcGFiaWxpdGllcyk7XG5cbiAgICAgICAgICAvLyBTdGFydCB0aGUgUlRDUnRwU2VuZGVyLiBUaGUgUlRDUnRwUmVjZWl2ZXIgZm9yIHRoaXNcbiAgICAgICAgICAvLyB0cmFuc2NlaXZlciBoYXMgYWxyZWFkeSBiZWVuIHN0YXJ0ZWQgaW4gc2V0UmVtb3RlRGVzY3JpcHRpb24uXG4gICAgICAgICAgcGMuX3RyYW5zY2VpdmUodHJhbnNjZWl2ZXIsXG4gICAgICAgICAgICAgIHBhcmFtcy5jb2RlY3MubGVuZ3RoID4gMCxcbiAgICAgICAgICAgICAgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBwYy5fbG9jYWxEZXNjcmlwdGlvbiA9IHtcbiAgICAgIHR5cGU6IGRlc2NyaXB0aW9uLnR5cGUsXG4gICAgICBzZHA6IGRlc2NyaXB0aW9uLnNkcFxuICAgIH07XG4gICAgaWYgKGRlc2NyaXB0aW9uLnR5cGUgPT09ICdvZmZlcicpIHtcbiAgICAgIHBjLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnaGF2ZS1sb2NhbC1vZmZlcicpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwYy5fdXBkYXRlU2lnbmFsaW5nU3RhdGUoJ3N0YWJsZScpO1xuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfTtcblxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuc2V0UmVtb3RlRGVzY3JpcHRpb24gPSBmdW5jdGlvbihkZXNjcmlwdGlvbikge1xuICAgIHZhciBwYyA9IHRoaXM7XG5cbiAgICAvLyBOb3RlOiBwcmFuc3dlciBpcyBub3Qgc3VwcG9ydGVkLlxuICAgIGlmIChbJ29mZmVyJywgJ2Fuc3dlciddLmluZGV4T2YoZGVzY3JpcHRpb24udHlwZSkgPT09IC0xKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobWFrZUVycm9yKCdUeXBlRXJyb3InLFxuICAgICAgICAgICdVbnN1cHBvcnRlZCB0eXBlIFwiJyArIGRlc2NyaXB0aW9uLnR5cGUgKyAnXCInKSk7XG4gICAgfVxuXG4gICAgaWYgKCFpc0FjdGlvbkFsbG93ZWRJblNpZ25hbGluZ1N0YXRlKCdzZXRSZW1vdGVEZXNjcmlwdGlvbicsXG4gICAgICAgIGRlc2NyaXB0aW9uLnR5cGUsIHBjLnNpZ25hbGluZ1N0YXRlKSB8fCBwYy5faXNDbG9zZWQpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChtYWtlRXJyb3IoJ0ludmFsaWRTdGF0ZUVycm9yJyxcbiAgICAgICAgICAnQ2FuIG5vdCBzZXQgcmVtb3RlICcgKyBkZXNjcmlwdGlvbi50eXBlICtcbiAgICAgICAgICAnIGluIHN0YXRlICcgKyBwYy5zaWduYWxpbmdTdGF0ZSkpO1xuICAgIH1cblxuICAgIHZhciBzdHJlYW1zID0ge307XG4gICAgcGMucmVtb3RlU3RyZWFtcy5mb3JFYWNoKGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgc3RyZWFtc1tzdHJlYW0uaWRdID0gc3RyZWFtO1xuICAgIH0pO1xuICAgIHZhciByZWNlaXZlckxpc3QgPSBbXTtcbiAgICB2YXIgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKGRlc2NyaXB0aW9uLnNkcCk7XG4gICAgdmFyIHNlc3Npb25wYXJ0ID0gc2VjdGlvbnMuc2hpZnQoKTtcbiAgICB2YXIgaXNJY2VMaXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgoc2Vzc2lvbnBhcnQsXG4gICAgICAgICdhPWljZS1saXRlJykubGVuZ3RoID4gMDtcbiAgICB2YXIgdXNpbmdCdW5kbGUgPSBTRFBVdGlscy5tYXRjaFByZWZpeChzZXNzaW9ucGFydCxcbiAgICAgICAgJ2E9Z3JvdXA6QlVORExFICcpLmxlbmd0aCA+IDA7XG4gICAgcGMudXNpbmdCdW5kbGUgPSB1c2luZ0J1bmRsZTtcbiAgICB2YXIgaWNlT3B0aW9ucyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KHNlc3Npb25wYXJ0LFxuICAgICAgICAnYT1pY2Utb3B0aW9uczonKVswXTtcbiAgICBpZiAoaWNlT3B0aW9ucykge1xuICAgICAgcGMuY2FuVHJpY2tsZUljZUNhbmRpZGF0ZXMgPSBpY2VPcHRpb25zLnN1YnN0cigxNCkuc3BsaXQoJyAnKVxuICAgICAgICAgIC5pbmRleE9mKCd0cmlja2xlJykgPj0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgcGMuY2FuVHJpY2tsZUljZUNhbmRpZGF0ZXMgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBzZWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKG1lZGlhU2VjdGlvbiwgc2RwTUxpbmVJbmRleCkge1xuICAgICAgdmFyIGxpbmVzID0gU0RQVXRpbHMuc3BsaXRMaW5lcyhtZWRpYVNlY3Rpb24pO1xuICAgICAgdmFyIGtpbmQgPSBTRFBVdGlscy5nZXRLaW5kKG1lZGlhU2VjdGlvbik7XG4gICAgICAvLyB0cmVhdCBidW5kbGUtb25seSBhcyBub3QtcmVqZWN0ZWQuXG4gICAgICB2YXIgcmVqZWN0ZWQgPSBTRFBVdGlscy5pc1JlamVjdGVkKG1lZGlhU2VjdGlvbikgJiZcbiAgICAgICAgICBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPWJ1bmRsZS1vbmx5JykubGVuZ3RoID09PSAwO1xuICAgICAgdmFyIHByb3RvY29sID0gbGluZXNbMF0uc3Vic3RyKDIpLnNwbGl0KCcgJylbMl07XG5cbiAgICAgIHZhciBkaXJlY3Rpb24gPSBTRFBVdGlscy5nZXREaXJlY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCk7XG4gICAgICB2YXIgcmVtb3RlTXNpZCA9IFNEUFV0aWxzLnBhcnNlTXNpZChtZWRpYVNlY3Rpb24pO1xuXG4gICAgICB2YXIgbWlkID0gU0RQVXRpbHMuZ2V0TWlkKG1lZGlhU2VjdGlvbikgfHwgU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyKCk7XG5cbiAgICAgIC8vIFJlamVjdCBkYXRhY2hhbm5lbHMgd2hpY2ggYXJlIG5vdCBpbXBsZW1lbnRlZCB5ZXQuXG4gICAgICBpZiAocmVqZWN0ZWQgfHwgKGtpbmQgPT09ICdhcHBsaWNhdGlvbicgJiYgKHByb3RvY29sID09PSAnRFRMUy9TQ1RQJyB8fFxuICAgICAgICAgIHByb3RvY29sID09PSAnVURQL0RUTFMvU0NUUCcpKSkge1xuICAgICAgICAvLyBUT0RPOiB0aGlzIGlzIGRhbmdlcm91cyBpbiB0aGUgY2FzZSB3aGVyZSBhIG5vbi1yZWplY3RlZCBtLWxpbmVcbiAgICAgICAgLy8gICAgIGJlY29tZXMgcmVqZWN0ZWQuXG4gICAgICAgIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XSA9IHtcbiAgICAgICAgICBtaWQ6IG1pZCxcbiAgICAgICAgICBraW5kOiBraW5kLFxuICAgICAgICAgIHByb3RvY29sOiBwcm90b2NvbCxcbiAgICAgICAgICByZWplY3RlZDogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICghcmVqZWN0ZWQgJiYgcGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdICYmXG4gICAgICAgICAgcGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLnJlamVjdGVkKSB7XG4gICAgICAgIC8vIHJlY3ljbGUgYSByZWplY3RlZCB0cmFuc2NlaXZlci5cbiAgICAgICAgcGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdID0gcGMuX2NyZWF0ZVRyYW5zY2VpdmVyKGtpbmQsIHRydWUpO1xuICAgICAgfVxuXG4gICAgICB2YXIgdHJhbnNjZWl2ZXI7XG4gICAgICB2YXIgaWNlR2F0aGVyZXI7XG4gICAgICB2YXIgaWNlVHJhbnNwb3J0O1xuICAgICAgdmFyIGR0bHNUcmFuc3BvcnQ7XG4gICAgICB2YXIgcnRwUmVjZWl2ZXI7XG4gICAgICB2YXIgc2VuZEVuY29kaW5nUGFyYW1ldGVycztcbiAgICAgIHZhciByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzO1xuICAgICAgdmFyIGxvY2FsQ2FwYWJpbGl0aWVzO1xuXG4gICAgICB2YXIgdHJhY2s7XG4gICAgICAvLyBGSVhNRTogZW5zdXJlIHRoZSBtZWRpYVNlY3Rpb24gaGFzIHJ0Y3AtbXV4IHNldC5cbiAgICAgIHZhciByZW1vdGVDYXBhYmlsaXRpZXMgPSBTRFBVdGlscy5wYXJzZVJ0cFBhcmFtZXRlcnMobWVkaWFTZWN0aW9uKTtcbiAgICAgIHZhciByZW1vdGVJY2VQYXJhbWV0ZXJzO1xuICAgICAgdmFyIHJlbW90ZUR0bHNQYXJhbWV0ZXJzO1xuICAgICAgaWYgKCFyZWplY3RlZCkge1xuICAgICAgICByZW1vdGVJY2VQYXJhbWV0ZXJzID0gU0RQVXRpbHMuZ2V0SWNlUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24sXG4gICAgICAgICAgICBzZXNzaW9ucGFydCk7XG4gICAgICAgIHJlbW90ZUR0bHNQYXJhbWV0ZXJzID0gU0RQVXRpbHMuZ2V0RHRsc1BhcmFtZXRlcnMobWVkaWFTZWN0aW9uLFxuICAgICAgICAgICAgc2Vzc2lvbnBhcnQpO1xuICAgICAgICByZW1vdGVEdGxzUGFyYW1ldGVycy5yb2xlID0gJ2NsaWVudCc7XG4gICAgICB9XG4gICAgICByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID1cbiAgICAgICAgICBTRFBVdGlscy5wYXJzZVJ0cEVuY29kaW5nUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24pO1xuXG4gICAgICB2YXIgcnRjcFBhcmFtZXRlcnMgPSBTRFBVdGlscy5wYXJzZVJ0Y3BQYXJhbWV0ZXJzKG1lZGlhU2VjdGlvbik7XG5cbiAgICAgIHZhciBpc0NvbXBsZXRlID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLFxuICAgICAgICAgICdhPWVuZC1vZi1jYW5kaWRhdGVzJywgc2Vzc2lvbnBhcnQpLmxlbmd0aCA+IDA7XG4gICAgICB2YXIgY2FuZHMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPWNhbmRpZGF0ZTonKVxuICAgICAgICAgIC5tYXAoZnVuY3Rpb24oY2FuZCkge1xuICAgICAgICAgICAgcmV0dXJuIFNEUFV0aWxzLnBhcnNlQ2FuZGlkYXRlKGNhbmQpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmZpbHRlcihmdW5jdGlvbihjYW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FuZC5jb21wb25lbnQgPT09IDE7XG4gICAgICAgICAgfSk7XG5cbiAgICAgIC8vIENoZWNrIGlmIHdlIGNhbiB1c2UgQlVORExFIGFuZCBkaXNwb3NlIHRyYW5zcG9ydHMuXG4gICAgICBpZiAoKGRlc2NyaXB0aW9uLnR5cGUgPT09ICdvZmZlcicgfHwgZGVzY3JpcHRpb24udHlwZSA9PT0gJ2Fuc3dlcicpICYmXG4gICAgICAgICAgIXJlamVjdGVkICYmIHVzaW5nQnVuZGxlICYmIHNkcE1MaW5lSW5kZXggPiAwICYmXG4gICAgICAgICAgcGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdKSB7XG4gICAgICAgIHBjLl9kaXNwb3NlSWNlQW5kRHRsc1RyYW5zcG9ydHMoc2RwTUxpbmVJbmRleCk7XG4gICAgICAgIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5pY2VHYXRoZXJlciA9XG4gICAgICAgICAgICBwYy50cmFuc2NlaXZlcnNbMF0uaWNlR2F0aGVyZXI7XG4gICAgICAgIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5pY2VUcmFuc3BvcnQgPVxuICAgICAgICAgICAgcGMudHJhbnNjZWl2ZXJzWzBdLmljZVRyYW5zcG9ydDtcbiAgICAgICAgcGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLmR0bHNUcmFuc3BvcnQgPVxuICAgICAgICAgICAgcGMudHJhbnNjZWl2ZXJzWzBdLmR0bHNUcmFuc3BvcnQ7XG4gICAgICAgIGlmIChwYy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0ucnRwU2VuZGVyKSB7XG4gICAgICAgICAgcGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLnJ0cFNlbmRlci5zZXRUcmFuc3BvcnQoXG4gICAgICAgICAgICAgIHBjLnRyYW5zY2VpdmVyc1swXS5kdGxzVHJhbnNwb3J0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLnJ0cFJlY2VpdmVyKSB7XG4gICAgICAgICAgcGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdLnJ0cFJlY2VpdmVyLnNldFRyYW5zcG9ydChcbiAgICAgICAgICAgICAgcGMudHJhbnNjZWl2ZXJzWzBdLmR0bHNUcmFuc3BvcnQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoZGVzY3JpcHRpb24udHlwZSA9PT0gJ29mZmVyJyAmJiAhcmVqZWN0ZWQpIHtcbiAgICAgICAgdHJhbnNjZWl2ZXIgPSBwYy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0gfHxcbiAgICAgICAgICAgIHBjLl9jcmVhdGVUcmFuc2NlaXZlcihraW5kKTtcbiAgICAgICAgdHJhbnNjZWl2ZXIubWlkID0gbWlkO1xuXG4gICAgICAgIGlmICghdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIpIHtcbiAgICAgICAgICB0cmFuc2NlaXZlci5pY2VHYXRoZXJlciA9IHBjLl9jcmVhdGVJY2VHYXRoZXJlcihzZHBNTGluZUluZGV4LFxuICAgICAgICAgICAgICB1c2luZ0J1bmRsZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2FuZHMubGVuZ3RoICYmIHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydC5zdGF0ZSA9PT0gJ25ldycpIHtcbiAgICAgICAgICBpZiAoaXNDb21wbGV0ZSAmJiAoIXVzaW5nQnVuZGxlIHx8IHNkcE1MaW5lSW5kZXggPT09IDApKSB7XG4gICAgICAgICAgICB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQuc2V0UmVtb3RlQ2FuZGlkYXRlcyhjYW5kcyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhbmRzLmZvckVhY2goZnVuY3Rpb24oY2FuZGlkYXRlKSB7XG4gICAgICAgICAgICAgIG1heWJlQWRkQ2FuZGlkYXRlKHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCwgY2FuZGlkYXRlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzID0gd2luZG93LlJUQ1J0cFJlY2VpdmVyLmdldENhcGFiaWxpdGllcyhraW5kKTtcblxuICAgICAgICAvLyBmaWx0ZXIgUlRYIHVudGlsIGFkZGl0aW9uYWwgc3R1ZmYgbmVlZGVkIGZvciBSVFggaXMgaW1wbGVtZW50ZWRcbiAgICAgICAgLy8gaW4gYWRhcHRlci5qc1xuICAgICAgICBpZiAoZWRnZVZlcnNpb24gPCAxNTAxOSkge1xuICAgICAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzLmNvZGVjcyA9IGxvY2FsQ2FwYWJpbGl0aWVzLmNvZGVjcy5maWx0ZXIoXG4gICAgICAgICAgICAgIGZ1bmN0aW9uKGNvZGVjKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvZGVjLm5hbWUgIT09ICdydHgnO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMgPSB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzIHx8IFt7XG4gICAgICAgICAgc3NyYzogKDIgKiBzZHBNTGluZUluZGV4ICsgMikgKiAxMDAxXG4gICAgICAgIH1dO1xuXG4gICAgICAgIC8vIFRPRE86IHJld3JpdGUgdG8gdXNlIGh0dHA6Ly93M2MuZ2l0aHViLmlvL3dlYnJ0Yy1wYy8jc2V0LWFzc29jaWF0ZWQtcmVtb3RlLXN0cmVhbXNcbiAgICAgICAgdmFyIGlzTmV3VHJhY2sgPSBmYWxzZTtcbiAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpIHtcbiAgICAgICAgICBpc05ld1RyYWNrID0gIXRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyO1xuICAgICAgICAgIHJ0cFJlY2VpdmVyID0gdHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIgfHxcbiAgICAgICAgICAgICAgbmV3IHdpbmRvdy5SVENSdHBSZWNlaXZlcih0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0LCBraW5kKTtcblxuICAgICAgICAgIGlmIChpc05ld1RyYWNrKSB7XG4gICAgICAgICAgICB2YXIgc3RyZWFtO1xuICAgICAgICAgICAgdHJhY2sgPSBydHBSZWNlaXZlci50cmFjaztcbiAgICAgICAgICAgIC8vIEZJWE1FOiBkb2VzIG5vdCB3b3JrIHdpdGggUGxhbiBCLlxuICAgICAgICAgICAgaWYgKHJlbW90ZU1zaWQgJiYgcmVtb3RlTXNpZC5zdHJlYW0gPT09ICctJykge1xuICAgICAgICAgICAgICAvLyBuby1vcC4gYSBzdHJlYW0gaWQgb2YgJy0nIG1lYW5zOiBubyBhc3NvY2lhdGVkIHN0cmVhbS5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVtb3RlTXNpZCkge1xuICAgICAgICAgICAgICBpZiAoIXN0cmVhbXNbcmVtb3RlTXNpZC5zdHJlYW1dKSB7XG4gICAgICAgICAgICAgICAgc3RyZWFtc1tyZW1vdGVNc2lkLnN0cmVhbV0gPSBuZXcgd2luZG93Lk1lZGlhU3RyZWFtKCk7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHN0cmVhbXNbcmVtb3RlTXNpZC5zdHJlYW1dLCAnaWQnLCB7XG4gICAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVtb3RlTXNpZC5zdHJlYW07XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRyYWNrLCAnaWQnLCB7XG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZW1vdGVNc2lkLnRyYWNrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHN0cmVhbSA9IHN0cmVhbXNbcmVtb3RlTXNpZC5zdHJlYW1dO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaWYgKCFzdHJlYW1zLmRlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICBzdHJlYW1zLmRlZmF1bHQgPSBuZXcgd2luZG93Lk1lZGlhU3RyZWFtKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgc3RyZWFtID0gc3RyZWFtcy5kZWZhdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN0cmVhbSkge1xuICAgICAgICAgICAgICBhZGRUcmFja1RvU3RyZWFtQW5kRmlyZUV2ZW50KHRyYWNrLCBzdHJlYW0pO1xuICAgICAgICAgICAgICB0cmFuc2NlaXZlci5hc3NvY2lhdGVkUmVtb3RlTWVkaWFTdHJlYW1zLnB1c2goc3RyZWFtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlY2VpdmVyTGlzdC5wdXNoKFt0cmFjaywgcnRwUmVjZWl2ZXIsIHN0cmVhbV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5ydHBSZWNlaXZlciAmJiB0cmFuc2NlaXZlci5ydHBSZWNlaXZlci50cmFjaykge1xuICAgICAgICAgIHRyYW5zY2VpdmVyLmFzc29jaWF0ZWRSZW1vdGVNZWRpYVN0cmVhbXMuZm9yRWFjaChmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICB2YXIgbmF0aXZlVHJhY2sgPSBzLmdldFRyYWNrcygpLmZpbmQoZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICByZXR1cm4gdC5pZCA9PT0gdHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIudHJhY2suaWQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChuYXRpdmVUcmFjaykge1xuICAgICAgICAgICAgICByZW1vdmVUcmFja0Zyb21TdHJlYW1BbmRGaXJlRXZlbnQobmF0aXZlVHJhY2ssIHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRyYW5zY2VpdmVyLmFzc29jaWF0ZWRSZW1vdGVNZWRpYVN0cmVhbXMgPSBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzID0gbG9jYWxDYXBhYmlsaXRpZXM7XG4gICAgICAgIHRyYW5zY2VpdmVyLnJlbW90ZUNhcGFiaWxpdGllcyA9IHJlbW90ZUNhcGFiaWxpdGllcztcbiAgICAgICAgdHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIgPSBydHBSZWNlaXZlcjtcbiAgICAgICAgdHJhbnNjZWl2ZXIucnRjcFBhcmFtZXRlcnMgPSBydGNwUGFyYW1ldGVycztcbiAgICAgICAgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVycyA9IHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7XG4gICAgICAgIHRyYW5zY2VpdmVyLnJlY3ZFbmNvZGluZ1BhcmFtZXRlcnMgPSByZWN2RW5jb2RpbmdQYXJhbWV0ZXJzO1xuXG4gICAgICAgIC8vIFN0YXJ0IHRoZSBSVENSdHBSZWNlaXZlciBub3cuIFRoZSBSVFBTZW5kZXIgaXMgc3RhcnRlZCBpblxuICAgICAgICAvLyBzZXRMb2NhbERlc2NyaXB0aW9uLlxuICAgICAgICBwYy5fdHJhbnNjZWl2ZShwYy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0sXG4gICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgIGlzTmV3VHJhY2spO1xuICAgICAgfSBlbHNlIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnYW5zd2VyJyAmJiAhcmVqZWN0ZWQpIHtcbiAgICAgICAgdHJhbnNjZWl2ZXIgPSBwYy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF07XG4gICAgICAgIGljZUdhdGhlcmVyID0gdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXI7XG4gICAgICAgIGljZVRyYW5zcG9ydCA9IHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydDtcbiAgICAgICAgZHRsc1RyYW5zcG9ydCA9IHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQ7XG4gICAgICAgIHJ0cFJlY2VpdmVyID0gdHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXI7XG4gICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMgPSB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzO1xuICAgICAgICBsb2NhbENhcGFiaWxpdGllcyA9IHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzO1xuXG4gICAgICAgIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZWN2RW5jb2RpbmdQYXJhbWV0ZXJzID1cbiAgICAgICAgICAgIHJlY3ZFbmNvZGluZ1BhcmFtZXRlcnM7XG4gICAgICAgIHBjLnRyYW5zY2VpdmVyc1tzZHBNTGluZUluZGV4XS5yZW1vdGVDYXBhYmlsaXRpZXMgPVxuICAgICAgICAgICAgcmVtb3RlQ2FwYWJpbGl0aWVzO1xuICAgICAgICBwYy50cmFuc2NlaXZlcnNbc2RwTUxpbmVJbmRleF0ucnRjcFBhcmFtZXRlcnMgPSBydGNwUGFyYW1ldGVycztcblxuICAgICAgICBpZiAoY2FuZHMubGVuZ3RoICYmIGljZVRyYW5zcG9ydC5zdGF0ZSA9PT0gJ25ldycpIHtcbiAgICAgICAgICBpZiAoKGlzSWNlTGl0ZSB8fCBpc0NvbXBsZXRlKSAmJlxuICAgICAgICAgICAgICAoIXVzaW5nQnVuZGxlIHx8IHNkcE1MaW5lSW5kZXggPT09IDApKSB7XG4gICAgICAgICAgICBpY2VUcmFuc3BvcnQuc2V0UmVtb3RlQ2FuZGlkYXRlcyhjYW5kcyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhbmRzLmZvckVhY2goZnVuY3Rpb24oY2FuZGlkYXRlKSB7XG4gICAgICAgICAgICAgIG1heWJlQWRkQ2FuZGlkYXRlKHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCwgY2FuZGlkYXRlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdXNpbmdCdW5kbGUgfHwgc2RwTUxpbmVJbmRleCA9PT0gMCkge1xuICAgICAgICAgIGlmIChpY2VUcmFuc3BvcnQuc3RhdGUgPT09ICduZXcnKSB7XG4gICAgICAgICAgICBpY2VUcmFuc3BvcnQuc3RhcnQoaWNlR2F0aGVyZXIsIHJlbW90ZUljZVBhcmFtZXRlcnMsXG4gICAgICAgICAgICAgICAgJ2NvbnRyb2xsaW5nJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChkdGxzVHJhbnNwb3J0LnN0YXRlID09PSAnbmV3Jykge1xuICAgICAgICAgICAgZHRsc1RyYW5zcG9ydC5zdGFydChyZW1vdGVEdGxzUGFyYW1ldGVycyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgdGhlIG9mZmVyIGNvbnRhaW5lZCBSVFggYnV0IHRoZSBhbnN3ZXIgZGlkIG5vdCxcbiAgICAgICAgLy8gcmVtb3ZlIFJUWCBmcm9tIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnMuXG4gICAgICAgIHZhciBjb21tb25DYXBhYmlsaXRpZXMgPSBnZXRDb21tb25DYXBhYmlsaXRpZXMoXG4gICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsXG4gICAgICAgICAgdHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzKTtcblxuICAgICAgICB2YXIgaGFzUnR4ID0gY29tbW9uQ2FwYWJpbGl0aWVzLmNvZGVjcy5maWx0ZXIoZnVuY3Rpb24oYykge1xuICAgICAgICAgIHJldHVybiBjLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ3J0eCc7XG4gICAgICAgIH0pLmxlbmd0aDtcbiAgICAgICAgaWYgKCFoYXNSdHggJiYgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHgpIHtcbiAgICAgICAgICBkZWxldGUgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHg7XG4gICAgICAgIH1cblxuICAgICAgICBwYy5fdHJhbnNjZWl2ZSh0cmFuc2NlaXZlcixcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdyZWN2b25seScsXG4gICAgICAgICAgICBkaXJlY3Rpb24gPT09ICdzZW5kcmVjdicgfHwgZGlyZWN0aW9uID09PSAnc2VuZG9ubHknKTtcblxuICAgICAgICAvLyBUT0RPOiByZXdyaXRlIHRvIHVzZSBodHRwOi8vdzNjLmdpdGh1Yi5pby93ZWJydGMtcGMvI3NldC1hc3NvY2lhdGVkLXJlbW90ZS1zdHJlYW1zXG4gICAgICAgIGlmIChydHBSZWNlaXZlciAmJlxuICAgICAgICAgICAgKGRpcmVjdGlvbiA9PT0gJ3NlbmRyZWN2JyB8fCBkaXJlY3Rpb24gPT09ICdzZW5kb25seScpKSB7XG4gICAgICAgICAgdHJhY2sgPSBydHBSZWNlaXZlci50cmFjaztcbiAgICAgICAgICBpZiAocmVtb3RlTXNpZCkge1xuICAgICAgICAgICAgaWYgKCFzdHJlYW1zW3JlbW90ZU1zaWQuc3RyZWFtXSkge1xuICAgICAgICAgICAgICBzdHJlYW1zW3JlbW90ZU1zaWQuc3RyZWFtXSA9IG5ldyB3aW5kb3cuTWVkaWFTdHJlYW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFkZFRyYWNrVG9TdHJlYW1BbmRGaXJlRXZlbnQodHJhY2ssIHN0cmVhbXNbcmVtb3RlTXNpZC5zdHJlYW1dKTtcbiAgICAgICAgICAgIHJlY2VpdmVyTGlzdC5wdXNoKFt0cmFjaywgcnRwUmVjZWl2ZXIsIHN0cmVhbXNbcmVtb3RlTXNpZC5zdHJlYW1dXSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICghc3RyZWFtcy5kZWZhdWx0KSB7XG4gICAgICAgICAgICAgIHN0cmVhbXMuZGVmYXVsdCA9IG5ldyB3aW5kb3cuTWVkaWFTdHJlYW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFkZFRyYWNrVG9TdHJlYW1BbmRGaXJlRXZlbnQodHJhY2ssIHN0cmVhbXMuZGVmYXVsdCk7XG4gICAgICAgICAgICByZWNlaXZlckxpc3QucHVzaChbdHJhY2ssIHJ0cFJlY2VpdmVyLCBzdHJlYW1zLmRlZmF1bHRdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gRklYTUU6IGFjdHVhbGx5IHRoZSByZWNlaXZlciBzaG91bGQgYmUgY3JlYXRlZCBsYXRlci5cbiAgICAgICAgICBkZWxldGUgdHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChwYy5fZHRsc1JvbGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcGMuX2R0bHNSb2xlID0gZGVzY3JpcHRpb24udHlwZSA9PT0gJ29mZmVyJyA/ICdhY3RpdmUnIDogJ3Bhc3NpdmUnO1xuICAgIH1cblxuICAgIHBjLl9yZW1vdGVEZXNjcmlwdGlvbiA9IHtcbiAgICAgIHR5cGU6IGRlc2NyaXB0aW9uLnR5cGUsXG4gICAgICBzZHA6IGRlc2NyaXB0aW9uLnNkcFxuICAgIH07XG4gICAgaWYgKGRlc2NyaXB0aW9uLnR5cGUgPT09ICdvZmZlcicpIHtcbiAgICAgIHBjLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnaGF2ZS1yZW1vdGUtb2ZmZXInKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGMuX3VwZGF0ZVNpZ25hbGluZ1N0YXRlKCdzdGFibGUnKTtcbiAgICB9XG4gICAgT2JqZWN0LmtleXMoc3RyZWFtcykuZm9yRWFjaChmdW5jdGlvbihzaWQpIHtcbiAgICAgIHZhciBzdHJlYW0gPSBzdHJlYW1zW3NpZF07XG4gICAgICBpZiAoc3RyZWFtLmdldFRyYWNrcygpLmxlbmd0aCkge1xuICAgICAgICBpZiAocGMucmVtb3RlU3RyZWFtcy5pbmRleE9mKHN0cmVhbSkgPT09IC0xKSB7XG4gICAgICAgICAgcGMucmVtb3RlU3RyZWFtcy5wdXNoKHN0cmVhbSk7XG4gICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCdhZGRzdHJlYW0nKTtcbiAgICAgICAgICBldmVudC5zdHJlYW0gPSBzdHJlYW07XG4gICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBwYy5fZGlzcGF0Y2hFdmVudCgnYWRkc3RyZWFtJywgZXZlbnQpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVjZWl2ZXJMaXN0LmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgIHZhciB0cmFjayA9IGl0ZW1bMF07XG4gICAgICAgICAgdmFyIHJlY2VpdmVyID0gaXRlbVsxXTtcbiAgICAgICAgICBpZiAoc3RyZWFtLmlkICE9PSBpdGVtWzJdLmlkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGZpcmVBZGRUcmFjayhwYywgdHJhY2ssIHJlY2VpdmVyLCBbc3RyZWFtXSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJlY2VpdmVyTGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIGlmIChpdGVtWzJdKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGZpcmVBZGRUcmFjayhwYywgaXRlbVswXSwgaXRlbVsxXSwgW10pO1xuICAgIH0pO1xuXG4gICAgLy8gY2hlY2sgd2hldGhlciBhZGRJY2VDYW5kaWRhdGUoe30pIHdhcyBjYWxsZWQgd2l0aGluIGZvdXIgc2Vjb25kcyBhZnRlclxuICAgIC8vIHNldFJlbW90ZURlc2NyaXB0aW9uLlxuICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCEocGMgJiYgcGMudHJhbnNjZWl2ZXJzKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBwYy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikge1xuICAgICAgICBpZiAodHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0ICYmXG4gICAgICAgICAgICB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQuc3RhdGUgPT09ICduZXcnICYmXG4gICAgICAgICAgICB0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQuZ2V0UmVtb3RlQ2FuZGlkYXRlcygpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ1RpbWVvdXQgZm9yIGFkZFJlbW90ZUNhbmRpZGF0ZS4gQ29uc2lkZXIgc2VuZGluZyAnICtcbiAgICAgICAgICAgICAgJ2FuIGVuZC1vZi1jYW5kaWRhdGVzIG5vdGlmaWNhdGlvbicpO1xuICAgICAgICAgIHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydC5hZGRSZW1vdGVDYW5kaWRhdGUoe30pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LCA0MDAwKTtcblxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfTtcblxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnRyYW5zY2VpdmVycy5mb3JFYWNoKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7XG4gICAgICAvKiBub3QgeWV0XG4gICAgICBpZiAodHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIpIHtcbiAgICAgICAgdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIuY2xvc2UoKTtcbiAgICAgIH1cbiAgICAgICovXG4gICAgICBpZiAodHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0KSB7XG4gICAgICAgIHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydC5zdG9wKCk7XG4gICAgICB9XG4gICAgICBpZiAodHJhbnNjZWl2ZXIuZHRsc1RyYW5zcG9ydCkge1xuICAgICAgICB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0LnN0b3AoKTtcbiAgICAgIH1cbiAgICAgIGlmICh0cmFuc2NlaXZlci5ydHBTZW5kZXIpIHtcbiAgICAgICAgdHJhbnNjZWl2ZXIucnRwU2VuZGVyLnN0b3AoKTtcbiAgICAgIH1cbiAgICAgIGlmICh0cmFuc2NlaXZlci5ydHBSZWNlaXZlcikge1xuICAgICAgICB0cmFuc2NlaXZlci5ydHBSZWNlaXZlci5zdG9wKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgLy8gRklYTUU6IGNsZWFuIHVwIHRyYWNrcywgbG9jYWwgc3RyZWFtcywgcmVtb3RlIHN0cmVhbXMsIGV0Y1xuICAgIHRoaXMuX2lzQ2xvc2VkID0gdHJ1ZTtcbiAgICB0aGlzLl91cGRhdGVTaWduYWxpbmdTdGF0ZSgnY2xvc2VkJyk7XG4gIH07XG5cbiAgLy8gVXBkYXRlIHRoZSBzaWduYWxpbmcgc3RhdGUuXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fdXBkYXRlU2lnbmFsaW5nU3RhdGUgPSBmdW5jdGlvbihuZXdTdGF0ZSkge1xuICAgIHRoaXMuc2lnbmFsaW5nU3RhdGUgPSBuZXdTdGF0ZTtcbiAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ3NpZ25hbGluZ3N0YXRlY2hhbmdlJyk7XG4gICAgdGhpcy5fZGlzcGF0Y2hFdmVudCgnc2lnbmFsaW5nc3RhdGVjaGFuZ2UnLCBldmVudCk7XG4gIH07XG5cbiAgLy8gRGV0ZXJtaW5lIHdoZXRoZXIgdG8gZmlyZSB0aGUgbmVnb3RpYXRpb25uZWVkZWQgZXZlbnQuXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5fbWF5YmVGaXJlTmVnb3RpYXRpb25OZWVkZWQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgcGMgPSB0aGlzO1xuICAgIGlmICh0aGlzLnNpZ25hbGluZ1N0YXRlICE9PSAnc3RhYmxlJyB8fCB0aGlzLm5lZWROZWdvdGlhdGlvbiA9PT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLm5lZWROZWdvdGlhdGlvbiA9IHRydWU7XG4gICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBpZiAocGMubmVlZE5lZ290aWF0aW9uKSB7XG4gICAgICAgIHBjLm5lZWROZWdvdGlhdGlvbiA9IGZhbHNlO1xuICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ25lZ290aWF0aW9ubmVlZGVkJyk7XG4gICAgICAgIHBjLl9kaXNwYXRjaEV2ZW50KCduZWdvdGlhdGlvbm5lZWRlZCcsIGV2ZW50KTtcbiAgICAgIH1cbiAgICB9LCAwKTtcbiAgfTtcblxuICAvLyBVcGRhdGUgdGhlIGljZSBjb25uZWN0aW9uIHN0YXRlLlxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuX3VwZGF0ZUljZUNvbm5lY3Rpb25TdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBuZXdTdGF0ZTtcbiAgICB2YXIgc3RhdGVzID0ge1xuICAgICAgJ25ldyc6IDAsXG4gICAgICBjbG9zZWQ6IDAsXG4gICAgICBjaGVja2luZzogMCxcbiAgICAgIGNvbm5lY3RlZDogMCxcbiAgICAgIGNvbXBsZXRlZDogMCxcbiAgICAgIGRpc2Nvbm5lY3RlZDogMCxcbiAgICAgIGZhaWxlZDogMFxuICAgIH07XG4gICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikge1xuICAgICAgaWYgKHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCAmJiAhdHJhbnNjZWl2ZXIucmVqZWN0ZWQpIHtcbiAgICAgICAgc3RhdGVzW3RyYW5zY2VpdmVyLmljZVRyYW5zcG9ydC5zdGF0ZV0rKztcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIG5ld1N0YXRlID0gJ25ldyc7XG4gICAgaWYgKHN0YXRlcy5mYWlsZWQgPiAwKSB7XG4gICAgICBuZXdTdGF0ZSA9ICdmYWlsZWQnO1xuICAgIH0gZWxzZSBpZiAoc3RhdGVzLmNoZWNraW5nID4gMCkge1xuICAgICAgbmV3U3RhdGUgPSAnY2hlY2tpbmcnO1xuICAgIH0gZWxzZSBpZiAoc3RhdGVzLmRpc2Nvbm5lY3RlZCA+IDApIHtcbiAgICAgIG5ld1N0YXRlID0gJ2Rpc2Nvbm5lY3RlZCc7XG4gICAgfSBlbHNlIGlmIChzdGF0ZXMubmV3ID4gMCkge1xuICAgICAgbmV3U3RhdGUgPSAnbmV3JztcbiAgICB9IGVsc2UgaWYgKHN0YXRlcy5jb25uZWN0ZWQgPiAwKSB7XG4gICAgICBuZXdTdGF0ZSA9ICdjb25uZWN0ZWQnO1xuICAgIH0gZWxzZSBpZiAoc3RhdGVzLmNvbXBsZXRlZCA+IDApIHtcbiAgICAgIG5ld1N0YXRlID0gJ2NvbXBsZXRlZCc7XG4gICAgfVxuXG4gICAgaWYgKG5ld1N0YXRlICE9PSB0aGlzLmljZUNvbm5lY3Rpb25TdGF0ZSkge1xuICAgICAgdGhpcy5pY2VDb25uZWN0aW9uU3RhdGUgPSBuZXdTdGF0ZTtcbiAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnaWNlY29ubmVjdGlvbnN0YXRlY2hhbmdlJyk7XG4gICAgICB0aGlzLl9kaXNwYXRjaEV2ZW50KCdpY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2UnLCBldmVudCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIFVwZGF0ZSB0aGUgY29ubmVjdGlvbiBzdGF0ZS5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLl91cGRhdGVDb25uZWN0aW9uU3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbmV3U3RhdGU7XG4gICAgdmFyIHN0YXRlcyA9IHtcbiAgICAgICduZXcnOiAwLFxuICAgICAgY2xvc2VkOiAwLFxuICAgICAgY29ubmVjdGluZzogMCxcbiAgICAgIGNvbm5lY3RlZDogMCxcbiAgICAgIGNvbXBsZXRlZDogMCxcbiAgICAgIGRpc2Nvbm5lY3RlZDogMCxcbiAgICAgIGZhaWxlZDogMFxuICAgIH07XG4gICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikge1xuICAgICAgaWYgKHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCAmJiB0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0ICYmXG4gICAgICAgICAgIXRyYW5zY2VpdmVyLnJlamVjdGVkKSB7XG4gICAgICAgIHN0YXRlc1t0cmFuc2NlaXZlci5pY2VUcmFuc3BvcnQuc3RhdGVdKys7XG4gICAgICAgIHN0YXRlc1t0cmFuc2NlaXZlci5kdGxzVHJhbnNwb3J0LnN0YXRlXSsrO1xuICAgICAgfVxuICAgIH0pO1xuICAgIC8vIElDRVRyYW5zcG9ydC5jb21wbGV0ZWQgYW5kIGNvbm5lY3RlZCBhcmUgdGhlIHNhbWUgZm9yIHRoaXMgcHVycG9zZS5cbiAgICBzdGF0ZXMuY29ubmVjdGVkICs9IHN0YXRlcy5jb21wbGV0ZWQ7XG5cbiAgICBuZXdTdGF0ZSA9ICduZXcnO1xuICAgIGlmIChzdGF0ZXMuZmFpbGVkID4gMCkge1xuICAgICAgbmV3U3RhdGUgPSAnZmFpbGVkJztcbiAgICB9IGVsc2UgaWYgKHN0YXRlcy5jb25uZWN0aW5nID4gMCkge1xuICAgICAgbmV3U3RhdGUgPSAnY29ubmVjdGluZyc7XG4gICAgfSBlbHNlIGlmIChzdGF0ZXMuZGlzY29ubmVjdGVkID4gMCkge1xuICAgICAgbmV3U3RhdGUgPSAnZGlzY29ubmVjdGVkJztcbiAgICB9IGVsc2UgaWYgKHN0YXRlcy5uZXcgPiAwKSB7XG4gICAgICBuZXdTdGF0ZSA9ICduZXcnO1xuICAgIH0gZWxzZSBpZiAoc3RhdGVzLmNvbm5lY3RlZCA+IDApIHtcbiAgICAgIG5ld1N0YXRlID0gJ2Nvbm5lY3RlZCc7XG4gICAgfVxuXG4gICAgaWYgKG5ld1N0YXRlICE9PSB0aGlzLmNvbm5lY3Rpb25TdGF0ZSkge1xuICAgICAgdGhpcy5jb25uZWN0aW9uU3RhdGUgPSBuZXdTdGF0ZTtcbiAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnY29ubmVjdGlvbnN0YXRlY2hhbmdlJyk7XG4gICAgICB0aGlzLl9kaXNwYXRjaEV2ZW50KCdjb25uZWN0aW9uc3RhdGVjaGFuZ2UnLCBldmVudCk7XG4gICAgfVxuICB9O1xuXG4gIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVPZmZlciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwYyA9IHRoaXM7XG5cbiAgICBpZiAocGMuX2lzQ2xvc2VkKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobWFrZUVycm9yKCdJbnZhbGlkU3RhdGVFcnJvcicsXG4gICAgICAgICAgJ0NhbiBub3QgY2FsbCBjcmVhdGVPZmZlciBhZnRlciBjbG9zZScpKTtcbiAgICB9XG5cbiAgICB2YXIgbnVtQXVkaW9UcmFja3MgPSBwYy50cmFuc2NlaXZlcnMuZmlsdGVyKGZ1bmN0aW9uKHQpIHtcbiAgICAgIHJldHVybiB0LmtpbmQgPT09ICdhdWRpbyc7XG4gICAgfSkubGVuZ3RoO1xuICAgIHZhciBudW1WaWRlb1RyYWNrcyA9IHBjLnRyYW5zY2VpdmVycy5maWx0ZXIoZnVuY3Rpb24odCkge1xuICAgICAgcmV0dXJuIHQua2luZCA9PT0gJ3ZpZGVvJztcbiAgICB9KS5sZW5ndGg7XG5cbiAgICAvLyBEZXRlcm1pbmUgbnVtYmVyIG9mIGF1ZGlvIGFuZCB2aWRlbyB0cmFja3Mgd2UgbmVlZCB0byBzZW5kL3JlY3YuXG4gICAgdmFyIG9mZmVyT3B0aW9ucyA9IGFyZ3VtZW50c1swXTtcbiAgICBpZiAob2ZmZXJPcHRpb25zKSB7XG4gICAgICAvLyBSZWplY3QgQ2hyb21lIGxlZ2FjeSBjb25zdHJhaW50cy5cbiAgICAgIGlmIChvZmZlck9wdGlvbnMubWFuZGF0b3J5IHx8IG9mZmVyT3B0aW9ucy5vcHRpb25hbCkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgICAgJ0xlZ2FjeSBtYW5kYXRvcnkvb3B0aW9uYWwgY29uc3RyYWludHMgbm90IHN1cHBvcnRlZC4nKTtcbiAgICAgIH1cbiAgICAgIGlmIChvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVBdWRpbyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmIChvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVBdWRpbyA9PT0gdHJ1ZSkge1xuICAgICAgICAgIG51bUF1ZGlvVHJhY2tzID0gMTtcbiAgICAgICAgfSBlbHNlIGlmIChvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVBdWRpbyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICBudW1BdWRpb1RyYWNrcyA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbnVtQXVkaW9UcmFja3MgPSBvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVBdWRpbztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvID09PSB0cnVlKSB7XG4gICAgICAgICAgbnVtVmlkZW9UcmFja3MgPSAxO1xuICAgICAgICB9IGVsc2UgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvID09PSBmYWxzZSkge1xuICAgICAgICAgIG51bVZpZGVvVHJhY2tzID0gMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBudW1WaWRlb1RyYWNrcyA9IG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcGMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHtcbiAgICAgIGlmICh0cmFuc2NlaXZlci5raW5kID09PSAnYXVkaW8nKSB7XG4gICAgICAgIG51bUF1ZGlvVHJhY2tzLS07XG4gICAgICAgIGlmIChudW1BdWRpb1RyYWNrcyA8IDApIHtcbiAgICAgICAgICB0cmFuc2NlaXZlci53YW50UmVjZWl2ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHRyYW5zY2VpdmVyLmtpbmQgPT09ICd2aWRlbycpIHtcbiAgICAgICAgbnVtVmlkZW9UcmFja3MtLTtcbiAgICAgICAgaWYgKG51bVZpZGVvVHJhY2tzIDwgMCkge1xuICAgICAgICAgIHRyYW5zY2VpdmVyLndhbnRSZWNlaXZlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIENyZWF0ZSBNLWxpbmVzIGZvciByZWN2b25seSBzdHJlYW1zLlxuICAgIHdoaWxlIChudW1BdWRpb1RyYWNrcyA+IDAgfHwgbnVtVmlkZW9UcmFja3MgPiAwKSB7XG4gICAgICBpZiAobnVtQXVkaW9UcmFja3MgPiAwKSB7XG4gICAgICAgIHBjLl9jcmVhdGVUcmFuc2NlaXZlcignYXVkaW8nKTtcbiAgICAgICAgbnVtQXVkaW9UcmFja3MtLTtcbiAgICAgIH1cbiAgICAgIGlmIChudW1WaWRlb1RyYWNrcyA+IDApIHtcbiAgICAgICAgcGMuX2NyZWF0ZVRyYW5zY2VpdmVyKCd2aWRlbycpO1xuICAgICAgICBudW1WaWRlb1RyYWNrcy0tO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBzZHAgPSBTRFBVdGlscy53cml0ZVNlc3Npb25Cb2lsZXJwbGF0ZShwYy5fc2RwU2Vzc2lvbklkLFxuICAgICAgICBwYy5fc2RwU2Vzc2lvblZlcnNpb24rKyk7XG4gICAgcGMudHJhbnNjZWl2ZXJzLmZvckVhY2goZnVuY3Rpb24odHJhbnNjZWl2ZXIsIHNkcE1MaW5lSW5kZXgpIHtcbiAgICAgIC8vIEZvciBlYWNoIHRyYWNrLCBjcmVhdGUgYW4gaWNlIGdhdGhlcmVyLCBpY2UgdHJhbnNwb3J0LFxuICAgICAgLy8gZHRscyB0cmFuc3BvcnQsIHBvdGVudGlhbGx5IHJ0cHNlbmRlciBhbmQgcnRwcmVjZWl2ZXIuXG4gICAgICB2YXIgdHJhY2sgPSB0cmFuc2NlaXZlci50cmFjaztcbiAgICAgIHZhciBraW5kID0gdHJhbnNjZWl2ZXIua2luZDtcbiAgICAgIHZhciBtaWQgPSB0cmFuc2NlaXZlci5taWQgfHwgU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyKCk7XG4gICAgICB0cmFuc2NlaXZlci5taWQgPSBtaWQ7XG5cbiAgICAgIGlmICghdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIpIHtcbiAgICAgICAgdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIgPSBwYy5fY3JlYXRlSWNlR2F0aGVyZXIoc2RwTUxpbmVJbmRleCxcbiAgICAgICAgICAgIHBjLnVzaW5nQnVuZGxlKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGxvY2FsQ2FwYWJpbGl0aWVzID0gd2luZG93LlJUQ1J0cFNlbmRlci5nZXRDYXBhYmlsaXRpZXMoa2luZCk7XG4gICAgICAvLyBmaWx0ZXIgUlRYIHVudGlsIGFkZGl0aW9uYWwgc3R1ZmYgbmVlZGVkIGZvciBSVFggaXMgaW1wbGVtZW50ZWRcbiAgICAgIC8vIGluIGFkYXB0ZXIuanNcbiAgICAgIGlmIChlZGdlVmVyc2lvbiA8IDE1MDE5KSB7XG4gICAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzLmNvZGVjcyA9IGxvY2FsQ2FwYWJpbGl0aWVzLmNvZGVjcy5maWx0ZXIoXG4gICAgICAgICAgICBmdW5jdGlvbihjb2RlYykge1xuICAgICAgICAgICAgICByZXR1cm4gY29kZWMubmFtZSAhPT0gJ3J0eCc7XG4gICAgICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGxvY2FsQ2FwYWJpbGl0aWVzLmNvZGVjcy5mb3JFYWNoKGZ1bmN0aW9uKGNvZGVjKSB7XG4gICAgICAgIC8vIHdvcmsgYXJvdW5kIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC93ZWJydGMvaXNzdWVzL2RldGFpbD9pZD02NTUyXG4gICAgICAgIC8vIGJ5IGFkZGluZyBsZXZlbC1hc3ltbWV0cnktYWxsb3dlZD0xXG4gICAgICAgIGlmIChjb2RlYy5uYW1lID09PSAnSDI2NCcgJiZcbiAgICAgICAgICAgIGNvZGVjLnBhcmFtZXRlcnNbJ2xldmVsLWFzeW1tZXRyeS1hbGxvd2VkJ10gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGNvZGVjLnBhcmFtZXRlcnNbJ2xldmVsLWFzeW1tZXRyeS1hbGxvd2VkJ10gPSAnMSc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBmb3Igc3Vic2VxdWVudCBvZmZlcnMsIHdlIG1pZ2h0IGhhdmUgdG8gcmUtdXNlIHRoZSBwYXlsb2FkXG4gICAgICAgIC8vIHR5cGUgb2YgdGhlIGxhc3Qgb2ZmZXIuXG4gICAgICAgIGlmICh0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXMgJiZcbiAgICAgICAgICAgIHRyYW5zY2VpdmVyLnJlbW90ZUNhcGFiaWxpdGllcy5jb2RlY3MpIHtcbiAgICAgICAgICB0cmFuc2NlaXZlci5yZW1vdGVDYXBhYmlsaXRpZXMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24ocmVtb3RlQ29kZWMpIHtcbiAgICAgICAgICAgIGlmIChjb2RlYy5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IHJlbW90ZUNvZGVjLm5hbWUudG9Mb3dlckNhc2UoKSAmJlxuICAgICAgICAgICAgICAgIGNvZGVjLmNsb2NrUmF0ZSA9PT0gcmVtb3RlQ29kZWMuY2xvY2tSYXRlKSB7XG4gICAgICAgICAgICAgIGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlID0gcmVtb3RlQ29kZWMucGF5bG9hZFR5cGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgbG9jYWxDYXBhYmlsaXRpZXMuaGVhZGVyRXh0ZW5zaW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGhkckV4dCkge1xuICAgICAgICB2YXIgcmVtb3RlRXh0ZW5zaW9ucyA9IHRyYW5zY2VpdmVyLnJlbW90ZUNhcGFiaWxpdGllcyAmJlxuICAgICAgICAgICAgdHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzLmhlYWRlckV4dGVuc2lvbnMgfHwgW107XG4gICAgICAgIHJlbW90ZUV4dGVuc2lvbnMuZm9yRWFjaChmdW5jdGlvbihySGRyRXh0KSB7XG4gICAgICAgICAgaWYgKGhkckV4dC51cmkgPT09IHJIZHJFeHQudXJpKSB7XG4gICAgICAgICAgICBoZHJFeHQuaWQgPSBySGRyRXh0LmlkO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gZ2VuZXJhdGUgYW4gc3NyYyBub3csIHRvIGJlIHVzZWQgbGF0ZXIgaW4gcnRwU2VuZGVyLnNlbmRcbiAgICAgIHZhciBzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzID0gdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVycyB8fCBbe1xuICAgICAgICBzc3JjOiAoMiAqIHNkcE1MaW5lSW5kZXggKyAxKSAqIDEwMDFcbiAgICAgIH1dO1xuICAgICAgaWYgKHRyYWNrKSB7XG4gICAgICAgIC8vIGFkZCBSVFhcbiAgICAgICAgaWYgKGVkZ2VWZXJzaW9uID49IDE1MDE5ICYmIGtpbmQgPT09ICd2aWRlbycgJiZcbiAgICAgICAgICAgICFzZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eCkge1xuICAgICAgICAgIHNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4ID0ge1xuICAgICAgICAgICAgc3NyYzogc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsgMVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHRyYW5zY2VpdmVyLndhbnRSZWNlaXZlKSB7XG4gICAgICAgIHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyID0gbmV3IHdpbmRvdy5SVENSdHBSZWNlaXZlcihcbiAgICAgICAgICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQsIGtpbmQpO1xuICAgICAgfVxuXG4gICAgICB0cmFuc2NlaXZlci5sb2NhbENhcGFiaWxpdGllcyA9IGxvY2FsQ2FwYWJpbGl0aWVzO1xuICAgICAgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVycyA9IHNlbmRFbmNvZGluZ1BhcmFtZXRlcnM7XG4gICAgfSk7XG5cbiAgICAvLyBhbHdheXMgb2ZmZXIgQlVORExFIGFuZCBkaXNwb3NlIG9uIHJldHVybiBpZiBub3Qgc3VwcG9ydGVkLlxuICAgIGlmIChwYy5fY29uZmlnLmJ1bmRsZVBvbGljeSAhPT0gJ21heC1jb21wYXQnKSB7XG4gICAgICBzZHAgKz0gJ2E9Z3JvdXA6QlVORExFICcgKyBwYy50cmFuc2NlaXZlcnMubWFwKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIHQubWlkO1xuICAgICAgfSkuam9pbignICcpICsgJ1xcclxcbic7XG4gICAgfVxuICAgIHNkcCArPSAnYT1pY2Utb3B0aW9uczp0cmlja2xlXFxyXFxuJztcblxuICAgIHBjLnRyYW5zY2VpdmVycy5mb3JFYWNoKGZ1bmN0aW9uKHRyYW5zY2VpdmVyLCBzZHBNTGluZUluZGV4KSB7XG4gICAgICBzZHAgKz0gd3JpdGVNZWRpYVNlY3Rpb24odHJhbnNjZWl2ZXIsIHRyYW5zY2VpdmVyLmxvY2FsQ2FwYWJpbGl0aWVzLFxuICAgICAgICAgICdvZmZlcicsIHRyYW5zY2VpdmVyLnN0cmVhbSwgcGMuX2R0bHNSb2xlKTtcbiAgICAgIHNkcCArPSAnYT1ydGNwLXJzaXplXFxyXFxuJztcblxuICAgICAgaWYgKHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyICYmIHBjLmljZUdhdGhlcmluZ1N0YXRlICE9PSAnbmV3JyAmJlxuICAgICAgICAgIChzZHBNTGluZUluZGV4ID09PSAwIHx8ICFwYy51c2luZ0J1bmRsZSkpIHtcbiAgICAgICAgdHJhbnNjZWl2ZXIuaWNlR2F0aGVyZXIuZ2V0TG9jYWxDYW5kaWRhdGVzKCkuZm9yRWFjaChmdW5jdGlvbihjYW5kKSB7XG4gICAgICAgICAgY2FuZC5jb21wb25lbnQgPSAxO1xuICAgICAgICAgIHNkcCArPSAnYT0nICsgU0RQVXRpbHMud3JpdGVDYW5kaWRhdGUoY2FuZCkgKyAnXFxyXFxuJztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmljZUdhdGhlcmVyLnN0YXRlID09PSAnY29tcGxldGVkJykge1xuICAgICAgICAgIHNkcCArPSAnYT1lbmQtb2YtY2FuZGlkYXRlc1xcclxcbic7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHZhciBkZXNjID0gbmV3IHdpbmRvdy5SVENTZXNzaW9uRGVzY3JpcHRpb24oe1xuICAgICAgdHlwZTogJ29mZmVyJyxcbiAgICAgIHNkcDogc2RwXG4gICAgfSk7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZXNjKTtcbiAgfTtcblxuICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY3JlYXRlQW5zd2VyID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHBjID0gdGhpcztcblxuICAgIGlmIChwYy5faXNDbG9zZWQpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChtYWtlRXJyb3IoJ0ludmFsaWRTdGF0ZUVycm9yJyxcbiAgICAgICAgICAnQ2FuIG5vdCBjYWxsIGNyZWF0ZUFuc3dlciBhZnRlciBjbG9zZScpKTtcbiAgICB9XG5cbiAgICBpZiAoIShwYy5zaWduYWxpbmdTdGF0ZSA9PT0gJ2hhdmUtcmVtb3RlLW9mZmVyJyB8fFxuICAgICAgICBwYy5zaWduYWxpbmdTdGF0ZSA9PT0gJ2hhdmUtbG9jYWwtcHJhbnN3ZXInKSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG1ha2VFcnJvcignSW52YWxpZFN0YXRlRXJyb3InLFxuICAgICAgICAgICdDYW4gbm90IGNhbGwgY3JlYXRlQW5zd2VyIGluIHNpZ25hbGluZ1N0YXRlICcgKyBwYy5zaWduYWxpbmdTdGF0ZSkpO1xuICAgIH1cblxuICAgIHZhciBzZHAgPSBTRFBVdGlscy53cml0ZVNlc3Npb25Cb2lsZXJwbGF0ZShwYy5fc2RwU2Vzc2lvbklkLFxuICAgICAgICBwYy5fc2RwU2Vzc2lvblZlcnNpb24rKyk7XG4gICAgaWYgKHBjLnVzaW5nQnVuZGxlKSB7XG4gICAgICBzZHAgKz0gJ2E9Z3JvdXA6QlVORExFICcgKyBwYy50cmFuc2NlaXZlcnMubWFwKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIHQubWlkO1xuICAgICAgfSkuam9pbignICcpICsgJ1xcclxcbic7XG4gICAgfVxuICAgIHNkcCArPSAnYT1pY2Utb3B0aW9uczp0cmlja2xlXFxyXFxuJztcblxuICAgIHZhciBtZWRpYVNlY3Rpb25zSW5PZmZlciA9IFNEUFV0aWxzLmdldE1lZGlhU2VjdGlvbnMoXG4gICAgICAgIHBjLl9yZW1vdGVEZXNjcmlwdGlvbi5zZHApLmxlbmd0aDtcbiAgICBwYy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlciwgc2RwTUxpbmVJbmRleCkge1xuICAgICAgaWYgKHNkcE1MaW5lSW5kZXggKyAxID4gbWVkaWFTZWN0aW9uc0luT2ZmZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHRyYW5zY2VpdmVyLnJlamVjdGVkKSB7XG4gICAgICAgIGlmICh0cmFuc2NlaXZlci5raW5kID09PSAnYXBwbGljYXRpb24nKSB7XG4gICAgICAgICAgaWYgKHRyYW5zY2VpdmVyLnByb3RvY29sID09PSAnRFRMUy9TQ1RQJykgeyAvLyBsZWdhY3kgZm10XG4gICAgICAgICAgICBzZHAgKz0gJ209YXBwbGljYXRpb24gMCBEVExTL1NDVFAgNTAwMFxcclxcbic7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNkcCArPSAnbT1hcHBsaWNhdGlvbiAwICcgKyB0cmFuc2NlaXZlci5wcm90b2NvbCArXG4gICAgICAgICAgICAgICAgJyB3ZWJydGMtZGF0YWNoYW5uZWxcXHJcXG4nO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5raW5kID09PSAnYXVkaW8nKSB7XG4gICAgICAgICAgc2RwICs9ICdtPWF1ZGlvIDAgVURQL1RMUy9SVFAvU0FWUEYgMFxcclxcbicgK1xuICAgICAgICAgICAgICAnYT1ydHBtYXA6MCBQQ01VLzgwMDBcXHJcXG4nO1xuICAgICAgICB9IGVsc2UgaWYgKHRyYW5zY2VpdmVyLmtpbmQgPT09ICd2aWRlbycpIHtcbiAgICAgICAgICBzZHAgKz0gJ209dmlkZW8gMCBVRFAvVExTL1JUUC9TQVZQRiAxMjBcXHJcXG4nICtcbiAgICAgICAgICAgICAgJ2E9cnRwbWFwOjEyMCBWUDgvOTAwMDBcXHJcXG4nO1xuICAgICAgICB9XG4gICAgICAgIHNkcCArPSAnYz1JTiBJUDQgMC4wLjAuMFxcclxcbicgK1xuICAgICAgICAgICAgJ2E9aW5hY3RpdmVcXHJcXG4nICtcbiAgICAgICAgICAgICdhPW1pZDonICsgdHJhbnNjZWl2ZXIubWlkICsgJ1xcclxcbic7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gRklYTUU6IGxvb2sgYXQgZGlyZWN0aW9uLlxuICAgICAgaWYgKHRyYW5zY2VpdmVyLnN0cmVhbSkge1xuICAgICAgICB2YXIgbG9jYWxUcmFjaztcbiAgICAgICAgaWYgKHRyYW5zY2VpdmVyLmtpbmQgPT09ICdhdWRpbycpIHtcbiAgICAgICAgICBsb2NhbFRyYWNrID0gdHJhbnNjZWl2ZXIuc3RyZWFtLmdldEF1ZGlvVHJhY2tzKClbMF07XG4gICAgICAgIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIua2luZCA9PT0gJ3ZpZGVvJykge1xuICAgICAgICAgIGxvY2FsVHJhY2sgPSB0cmFuc2NlaXZlci5zdHJlYW0uZ2V0VmlkZW9UcmFja3MoKVswXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobG9jYWxUcmFjaykge1xuICAgICAgICAgIC8vIGFkZCBSVFhcbiAgICAgICAgICBpZiAoZWRnZVZlcnNpb24gPj0gMTUwMTkgJiYgdHJhbnNjZWl2ZXIua2luZCA9PT0gJ3ZpZGVvJyAmJlxuICAgICAgICAgICAgICAhdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHgpIHtcbiAgICAgICAgICAgIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4ID0ge1xuICAgICAgICAgICAgICBzc3JjOiB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnNzcmMgKyAxXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBDYWxjdWxhdGUgaW50ZXJzZWN0aW9uIG9mIGNhcGFiaWxpdGllcy5cbiAgICAgIHZhciBjb21tb25DYXBhYmlsaXRpZXMgPSBnZXRDb21tb25DYXBhYmlsaXRpZXMoXG4gICAgICAgICAgdHJhbnNjZWl2ZXIubG9jYWxDYXBhYmlsaXRpZXMsXG4gICAgICAgICAgdHJhbnNjZWl2ZXIucmVtb3RlQ2FwYWJpbGl0aWVzKTtcblxuICAgICAgdmFyIGhhc1J0eCA9IGNvbW1vbkNhcGFiaWxpdGllcy5jb2RlY3MuZmlsdGVyKGZ1bmN0aW9uKGMpIHtcbiAgICAgICAgcmV0dXJuIGMubmFtZS50b0xvd2VyQ2FzZSgpID09PSAncnR4JztcbiAgICAgIH0pLmxlbmd0aDtcbiAgICAgIGlmICghaGFzUnR4ICYmIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4KSB7XG4gICAgICAgIGRlbGV0ZSB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eDtcbiAgICAgIH1cblxuICAgICAgc2RwICs9IHdyaXRlTWVkaWFTZWN0aW9uKHRyYW5zY2VpdmVyLCBjb21tb25DYXBhYmlsaXRpZXMsXG4gICAgICAgICAgJ2Fuc3dlcicsIHRyYW5zY2VpdmVyLnN0cmVhbSwgcGMuX2R0bHNSb2xlKTtcbiAgICAgIGlmICh0cmFuc2NlaXZlci5ydGNwUGFyYW1ldGVycyAmJlxuICAgICAgICAgIHRyYW5zY2VpdmVyLnJ0Y3BQYXJhbWV0ZXJzLnJlZHVjZWRTaXplKSB7XG4gICAgICAgIHNkcCArPSAnYT1ydGNwLXJzaXplXFxyXFxuJztcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHZhciBkZXNjID0gbmV3IHdpbmRvdy5SVENTZXNzaW9uRGVzY3JpcHRpb24oe1xuICAgICAgdHlwZTogJ2Fuc3dlcicsXG4gICAgICBzZHA6IHNkcFxuICAgIH0pO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGVzYyk7XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKGNhbmRpZGF0ZSkge1xuICAgIHZhciBwYyA9IHRoaXM7XG4gICAgdmFyIHNlY3Rpb25zO1xuICAgIGlmIChjYW5kaWRhdGUgJiYgIShjYW5kaWRhdGUuc2RwTUxpbmVJbmRleCAhPT0gdW5kZWZpbmVkIHx8XG4gICAgICAgIGNhbmRpZGF0ZS5zZHBNaWQpKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcignc2RwTUxpbmVJbmRleCBvciBzZHBNaWQgcmVxdWlyZWQnKSk7XG4gICAgfVxuXG4gICAgLy8gVE9ETzogbmVlZHMgdG8gZ28gaW50byBvcHMgcXVldWUuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgaWYgKCFwYy5fcmVtb3RlRGVzY3JpcHRpb24pIHtcbiAgICAgICAgcmV0dXJuIHJlamVjdChtYWtlRXJyb3IoJ0ludmFsaWRTdGF0ZUVycm9yJyxcbiAgICAgICAgICAgICdDYW4gbm90IGFkZCBJQ0UgY2FuZGlkYXRlIHdpdGhvdXQgYSByZW1vdGUgZGVzY3JpcHRpb24nKSk7XG4gICAgICB9IGVsc2UgaWYgKCFjYW5kaWRhdGUgfHwgY2FuZGlkYXRlLmNhbmRpZGF0ZSA9PT0gJycpIHtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBwYy50cmFuc2NlaXZlcnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICBpZiAocGMudHJhbnNjZWl2ZXJzW2pdLnJlamVjdGVkKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcGMudHJhbnNjZWl2ZXJzW2pdLmljZVRyYW5zcG9ydC5hZGRSZW1vdGVDYW5kaWRhdGUoe30pO1xuICAgICAgICAgIHNlY3Rpb25zID0gU0RQVXRpbHMuZ2V0TWVkaWFTZWN0aW9ucyhwYy5fcmVtb3RlRGVzY3JpcHRpb24uc2RwKTtcbiAgICAgICAgICBzZWN0aW9uc1tqXSArPSAnYT1lbmQtb2YtY2FuZGlkYXRlc1xcclxcbic7XG4gICAgICAgICAgcGMuX3JlbW90ZURlc2NyaXB0aW9uLnNkcCA9XG4gICAgICAgICAgICAgIFNEUFV0aWxzLmdldERlc2NyaXB0aW9uKHBjLl9yZW1vdGVEZXNjcmlwdGlvbi5zZHApICtcbiAgICAgICAgICAgICAgc2VjdGlvbnMuam9pbignJyk7XG4gICAgICAgICAgaWYgKHBjLnVzaW5nQnVuZGxlKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBzZHBNTGluZUluZGV4ID0gY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXg7XG4gICAgICAgIGlmIChjYW5kaWRhdGUuc2RwTWlkKSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYy50cmFuc2NlaXZlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwYy50cmFuc2NlaXZlcnNbaV0ubWlkID09PSBjYW5kaWRhdGUuc2RwTWlkKSB7XG4gICAgICAgICAgICAgIHNkcE1MaW5lSW5kZXggPSBpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRyYW5zY2VpdmVyID0gcGMudHJhbnNjZWl2ZXJzW3NkcE1MaW5lSW5kZXhdO1xuICAgICAgICBpZiAodHJhbnNjZWl2ZXIpIHtcbiAgICAgICAgICBpZiAodHJhbnNjZWl2ZXIucmVqZWN0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBjYW5kID0gT2JqZWN0LmtleXMoY2FuZGlkYXRlLmNhbmRpZGF0ZSkubGVuZ3RoID4gMCA/XG4gICAgICAgICAgICAgIFNEUFV0aWxzLnBhcnNlQ2FuZGlkYXRlKGNhbmRpZGF0ZS5jYW5kaWRhdGUpIDoge307XG4gICAgICAgICAgLy8gSWdub3JlIENocm9tZSdzIGludmFsaWQgY2FuZGlkYXRlcyBzaW5jZSBFZGdlIGRvZXMgbm90IGxpa2UgdGhlbS5cbiAgICAgICAgICBpZiAoY2FuZC5wcm90b2NvbCA9PT0gJ3RjcCcgJiYgKGNhbmQucG9ydCA9PT0gMCB8fCBjYW5kLnBvcnQgPT09IDkpKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBJZ25vcmUgUlRDUCBjYW5kaWRhdGVzLCB3ZSBhc3N1bWUgUlRDUC1NVVguXG4gICAgICAgICAgaWYgKGNhbmQuY29tcG9uZW50ICYmIGNhbmQuY29tcG9uZW50ICE9PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyB3aGVuIHVzaW5nIGJ1bmRsZSwgYXZvaWQgYWRkaW5nIGNhbmRpZGF0ZXMgdG8gdGhlIHdyb25nXG4gICAgICAgICAgLy8gaWNlIHRyYW5zcG9ydC4gQW5kIGF2b2lkIGFkZGluZyBjYW5kaWRhdGVzIGFkZGVkIGluIHRoZSBTRFAuXG4gICAgICAgICAgaWYgKHNkcE1MaW5lSW5kZXggPT09IDAgfHwgKHNkcE1MaW5lSW5kZXggPiAwICYmXG4gICAgICAgICAgICAgIHRyYW5zY2VpdmVyLmljZVRyYW5zcG9ydCAhPT0gcGMudHJhbnNjZWl2ZXJzWzBdLmljZVRyYW5zcG9ydCkpIHtcbiAgICAgICAgICAgIGlmICghbWF5YmVBZGRDYW5kaWRhdGUodHJhbnNjZWl2ZXIuaWNlVHJhbnNwb3J0LCBjYW5kKSkge1xuICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KG1ha2VFcnJvcignT3BlcmF0aW9uRXJyb3InLFxuICAgICAgICAgICAgICAgICAgJ0NhbiBub3QgYWRkIElDRSBjYW5kaWRhdGUnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gdXBkYXRlIHRoZSByZW1vdGVEZXNjcmlwdGlvbi5cbiAgICAgICAgICB2YXIgY2FuZGlkYXRlU3RyaW5nID0gY2FuZGlkYXRlLmNhbmRpZGF0ZS50cmltKCk7XG4gICAgICAgICAgaWYgKGNhbmRpZGF0ZVN0cmluZy5pbmRleE9mKCdhPScpID09PSAwKSB7XG4gICAgICAgICAgICBjYW5kaWRhdGVTdHJpbmcgPSBjYW5kaWRhdGVTdHJpbmcuc3Vic3RyKDIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzZWN0aW9ucyA9IFNEUFV0aWxzLmdldE1lZGlhU2VjdGlvbnMocGMuX3JlbW90ZURlc2NyaXB0aW9uLnNkcCk7XG4gICAgICAgICAgc2VjdGlvbnNbc2RwTUxpbmVJbmRleF0gKz0gJ2E9JyArXG4gICAgICAgICAgICAgIChjYW5kLnR5cGUgPyBjYW5kaWRhdGVTdHJpbmcgOiAnZW5kLW9mLWNhbmRpZGF0ZXMnKVxuICAgICAgICAgICAgICArICdcXHJcXG4nO1xuICAgICAgICAgIHBjLl9yZW1vdGVEZXNjcmlwdGlvbi5zZHAgPVxuICAgICAgICAgICAgICBTRFBVdGlscy5nZXREZXNjcmlwdGlvbihwYy5fcmVtb3RlRGVzY3JpcHRpb24uc2RwKSArXG4gICAgICAgICAgICAgIHNlY3Rpb25zLmpvaW4oJycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiByZWplY3QobWFrZUVycm9yKCdPcGVyYXRpb25FcnJvcicsXG4gICAgICAgICAgICAgICdDYW4gbm90IGFkZCBJQ0UgY2FuZGlkYXRlJykpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXNvbHZlKCk7XG4gICAgfSk7XG4gIH07XG5cbiAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFN0YXRzID0gZnVuY3Rpb24oc2VsZWN0b3IpIHtcbiAgICBpZiAoc2VsZWN0b3IgJiYgc2VsZWN0b3IgaW5zdGFuY2VvZiB3aW5kb3cuTWVkaWFTdHJlYW1UcmFjaykge1xuICAgICAgdmFyIHNlbmRlck9yUmVjZWl2ZXIgPSBudWxsO1xuICAgICAgdGhpcy50cmFuc2NlaXZlcnMuZm9yRWFjaChmdW5jdGlvbih0cmFuc2NlaXZlcikge1xuICAgICAgICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyICYmXG4gICAgICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIudHJhY2sgPT09IHNlbGVjdG9yKSB7XG4gICAgICAgICAgc2VuZGVyT3JSZWNlaXZlciA9IHRyYW5zY2VpdmVyLnJ0cFNlbmRlcjtcbiAgICAgICAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5ydHBSZWNlaXZlciAmJlxuICAgICAgICAgICAgdHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIudHJhY2sgPT09IHNlbGVjdG9yKSB7XG4gICAgICAgICAgc2VuZGVyT3JSZWNlaXZlciA9IHRyYW5zY2VpdmVyLnJ0cFJlY2VpdmVyO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmICghc2VuZGVyT3JSZWNlaXZlcikge1xuICAgICAgICB0aHJvdyBtYWtlRXJyb3IoJ0ludmFsaWRBY2Nlc3NFcnJvcicsICdJbnZhbGlkIHNlbGVjdG9yLicpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNlbmRlck9yUmVjZWl2ZXIuZ2V0U3RhdHMoKTtcbiAgICB9XG5cbiAgICB2YXIgcHJvbWlzZXMgPSBbXTtcbiAgICB0aGlzLnRyYW5zY2VpdmVycy5mb3JFYWNoKGZ1bmN0aW9uKHRyYW5zY2VpdmVyKSB7XG4gICAgICBbJ3J0cFNlbmRlcicsICdydHBSZWNlaXZlcicsICdpY2VHYXRoZXJlcicsICdpY2VUcmFuc3BvcnQnLFxuICAgICAgICAgICdkdGxzVHJhbnNwb3J0J10uZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHtcbiAgICAgICAgICAgIGlmICh0cmFuc2NlaXZlclttZXRob2RdKSB7XG4gICAgICAgICAgICAgIHByb21pc2VzLnB1c2godHJhbnNjZWl2ZXJbbWV0aG9kXS5nZXRTdGF0cygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24oYWxsU3RhdHMpIHtcbiAgICAgIHZhciByZXN1bHRzID0gbmV3IE1hcCgpO1xuICAgICAgYWxsU3RhdHMuZm9yRWFjaChmdW5jdGlvbihzdGF0cykge1xuICAgICAgICBzdGF0cy5mb3JFYWNoKGZ1bmN0aW9uKHN0YXQpIHtcbiAgICAgICAgICByZXN1bHRzLnNldChzdGF0LmlkLCBzdGF0KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIGZpeCBsb3ctbGV2ZWwgc3RhdCBuYW1lcyBhbmQgcmV0dXJuIE1hcCBpbnN0ZWFkIG9mIG9iamVjdC5cbiAgdmFyIG9ydGNPYmplY3RzID0gWydSVENSdHBTZW5kZXInLCAnUlRDUnRwUmVjZWl2ZXInLCAnUlRDSWNlR2F0aGVyZXInLFxuICAgICdSVENJY2VUcmFuc3BvcnQnLCAnUlRDRHRsc1RyYW5zcG9ydCddO1xuICBvcnRjT2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uKG9ydGNPYmplY3ROYW1lKSB7XG4gICAgdmFyIG9iaiA9IHdpbmRvd1tvcnRjT2JqZWN0TmFtZV07XG4gICAgaWYgKG9iaiAmJiBvYmoucHJvdG90eXBlICYmIG9iai5wcm90b3R5cGUuZ2V0U3RhdHMpIHtcbiAgICAgIHZhciBuYXRpdmVHZXRzdGF0cyA9IG9iai5wcm90b3R5cGUuZ2V0U3RhdHM7XG4gICAgICBvYmoucHJvdG90eXBlLmdldFN0YXRzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuYXRpdmVHZXRzdGF0cy5hcHBseSh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbihuYXRpdmVTdGF0cykge1xuICAgICAgICAgIHZhciBtYXBTdGF0cyA9IG5ldyBNYXAoKTtcbiAgICAgICAgICBPYmplY3Qua2V5cyhuYXRpdmVTdGF0cykuZm9yRWFjaChmdW5jdGlvbihpZCkge1xuICAgICAgICAgICAgbmF0aXZlU3RhdHNbaWRdLnR5cGUgPSBmaXhTdGF0c1R5cGUobmF0aXZlU3RhdHNbaWRdKTtcbiAgICAgICAgICAgIG1hcFN0YXRzLnNldChpZCwgbmF0aXZlU3RhdHNbaWRdKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gbWFwU3RhdHM7XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9XG4gIH0pO1xuXG4gIC8vIGxlZ2FjeSBjYWxsYmFjayBzaGltcy4gU2hvdWxkIGJlIG1vdmVkIHRvIGFkYXB0ZXIuanMgc29tZSBkYXlzLlxuICB2YXIgbWV0aG9kcyA9IFsnY3JlYXRlT2ZmZXInLCAnY3JlYXRlQW5zd2VyJ107XG4gIG1ldGhvZHMuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHtcbiAgICB2YXIgbmF0aXZlTWV0aG9kID0gUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlW21ldGhvZF07XG4gICAgUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgaWYgKHR5cGVvZiBhcmdzWzBdID09PSAnZnVuY3Rpb24nIHx8XG4gICAgICAgICAgdHlwZW9mIGFyZ3NbMV0gPT09ICdmdW5jdGlvbicpIHsgLy8gbGVnYWN5XG4gICAgICAgIHJldHVybiBuYXRpdmVNZXRob2QuYXBwbHkodGhpcywgW2FyZ3VtZW50c1syXV0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGRlc2NyaXB0aW9uKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBhcmdzWzBdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBhcmdzWzBdLmFwcGx5KG51bGwsIFtkZXNjcmlwdGlvbl0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGFyZ3NbMV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGFyZ3NbMV0uYXBwbHkobnVsbCwgW2Vycm9yXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuYXRpdmVNZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9KTtcblxuICBtZXRob2RzID0gWydzZXRMb2NhbERlc2NyaXB0aW9uJywgJ3NldFJlbW90ZURlc2NyaXB0aW9uJywgJ2FkZEljZUNhbmRpZGF0ZSddO1xuICBtZXRob2RzLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgdmFyIG5hdGl2ZU1ldGhvZCA9IFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdO1xuICAgIFJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIGlmICh0eXBlb2YgYXJnc1sxXSA9PT0gJ2Z1bmN0aW9uJyB8fFxuICAgICAgICAgIHR5cGVvZiBhcmdzWzJdID09PSAnZnVuY3Rpb24nKSB7IC8vIGxlZ2FjeVxuICAgICAgICByZXR1cm4gbmF0aXZlTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBhcmdzWzFdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBhcmdzWzFdLmFwcGx5KG51bGwpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGFyZ3NbMl0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGFyZ3NbMl0uYXBwbHkobnVsbCwgW2Vycm9yXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuYXRpdmVNZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9KTtcblxuICAvLyBnZXRTdGF0cyBpcyBzcGVjaWFsLiBJdCBkb2Vzbid0IGhhdmUgYSBzcGVjIGxlZ2FjeSBtZXRob2QgeWV0IHdlIHN1cHBvcnRcbiAgLy8gZ2V0U3RhdHMoc29tZXRoaW5nLCBjYikgd2l0aG91dCBlcnJvciBjYWxsYmFja3MuXG4gIFsnZ2V0U3RhdHMnXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgIHZhciBuYXRpdmVNZXRob2QgPSBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTtcbiAgICBSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICBpZiAodHlwZW9mIGFyZ3NbMV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmICh0eXBlb2YgYXJnc1sxXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgYXJnc1sxXS5hcHBseShudWxsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH07XG4gIH0pO1xuXG4gIHJldHVybiBSVENQZWVyQ29ubmVjdGlvbjtcbn07XG4iLCIvKiBlc2xpbnQtZW52IG5vZGUgKi9cbid1c2Ugc3RyaWN0JztcblxuLy8gU0RQIGhlbHBlcnMuXG52YXIgU0RQVXRpbHMgPSB7fTtcblxuLy8gR2VuZXJhdGUgYW4gYWxwaGFudW1lcmljIGlkZW50aWZpZXIgZm9yIGNuYW1lIG9yIG1pZHMuXG4vLyBUT0RPOiB1c2UgVVVJRHMgaW5zdGVhZD8gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vamVkLzk4Mjg4M1xuU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgMTApO1xufTtcblxuLy8gVGhlIFJUQ1AgQ05BTUUgdXNlZCBieSBhbGwgcGVlcmNvbm5lY3Rpb25zIGZyb20gdGhlIHNhbWUgSlMuXG5TRFBVdGlscy5sb2NhbENOYW1lID0gU0RQVXRpbHMuZ2VuZXJhdGVJZGVudGlmaWVyKCk7XG5cbi8vIFNwbGl0cyBTRFAgaW50byBsaW5lcywgZGVhbGluZyB3aXRoIGJvdGggQ1JMRiBhbmQgTEYuXG5TRFBVdGlscy5zcGxpdExpbmVzID0gZnVuY3Rpb24oYmxvYikge1xuICByZXR1cm4gYmxvYi50cmltKCkuc3BsaXQoJ1xcbicpLm1hcChmdW5jdGlvbihsaW5lKSB7XG4gICAgcmV0dXJuIGxpbmUudHJpbSgpO1xuICB9KTtcbn07XG4vLyBTcGxpdHMgU0RQIGludG8gc2Vzc2lvbnBhcnQgYW5kIG1lZGlhc2VjdGlvbnMuIEVuc3VyZXMgQ1JMRi5cblNEUFV0aWxzLnNwbGl0U2VjdGlvbnMgPSBmdW5jdGlvbihibG9iKSB7XG4gIHZhciBwYXJ0cyA9IGJsb2Iuc3BsaXQoJ1xcbm09Jyk7XG4gIHJldHVybiBwYXJ0cy5tYXAoZnVuY3Rpb24ocGFydCwgaW5kZXgpIHtcbiAgICByZXR1cm4gKGluZGV4ID4gMCA/ICdtPScgKyBwYXJ0IDogcGFydCkudHJpbSgpICsgJ1xcclxcbic7XG4gIH0pO1xufTtcblxuLy8gcmV0dXJucyB0aGUgc2Vzc2lvbiBkZXNjcmlwdGlvbi5cblNEUFV0aWxzLmdldERlc2NyaXB0aW9uID0gZnVuY3Rpb24oYmxvYikge1xuICB2YXIgc2VjdGlvbnMgPSBTRFBVdGlscy5zcGxpdFNlY3Rpb25zKGJsb2IpO1xuICByZXR1cm4gc2VjdGlvbnMgJiYgc2VjdGlvbnNbMF07XG59O1xuXG4vLyByZXR1cm5zIHRoZSBpbmRpdmlkdWFsIG1lZGlhIHNlY3Rpb25zLlxuU0RQVXRpbHMuZ2V0TWVkaWFTZWN0aW9ucyA9IGZ1bmN0aW9uKGJsb2IpIHtcbiAgdmFyIHNlY3Rpb25zID0gU0RQVXRpbHMuc3BsaXRTZWN0aW9ucyhibG9iKTtcbiAgc2VjdGlvbnMuc2hpZnQoKTtcbiAgcmV0dXJuIHNlY3Rpb25zO1xufTtcblxuLy8gUmV0dXJucyBsaW5lcyB0aGF0IHN0YXJ0IHdpdGggYSBjZXJ0YWluIHByZWZpeC5cblNEUFV0aWxzLm1hdGNoUHJlZml4ID0gZnVuY3Rpb24oYmxvYiwgcHJlZml4KSB7XG4gIHJldHVybiBTRFBVdGlscy5zcGxpdExpbmVzKGJsb2IpLmZpbHRlcihmdW5jdGlvbihsaW5lKSB7XG4gICAgcmV0dXJuIGxpbmUuaW5kZXhPZihwcmVmaXgpID09PSAwO1xuICB9KTtcbn07XG5cbi8vIFBhcnNlcyBhbiBJQ0UgY2FuZGlkYXRlIGxpbmUuIFNhbXBsZSBpbnB1dDpcbi8vIGNhbmRpZGF0ZTo3MDI3ODYzNTAgMiB1ZHAgNDE4MTk5MDIgOC44LjguOCA2MDc2OSB0eXAgcmVsYXkgcmFkZHIgOC44LjguOFxuLy8gcnBvcnQgNTU5OTZcIlxuU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUgPSBmdW5jdGlvbihsaW5lKSB7XG4gIHZhciBwYXJ0cztcbiAgLy8gUGFyc2UgYm90aCB2YXJpYW50cy5cbiAgaWYgKGxpbmUuaW5kZXhPZignYT1jYW5kaWRhdGU6JykgPT09IDApIHtcbiAgICBwYXJ0cyA9IGxpbmUuc3Vic3RyaW5nKDEyKS5zcGxpdCgnICcpO1xuICB9IGVsc2Uge1xuICAgIHBhcnRzID0gbGluZS5zdWJzdHJpbmcoMTApLnNwbGl0KCcgJyk7XG4gIH1cblxuICB2YXIgY2FuZGlkYXRlID0ge1xuICAgIGZvdW5kYXRpb246IHBhcnRzWzBdLFxuICAgIGNvbXBvbmVudDogcGFyc2VJbnQocGFydHNbMV0sIDEwKSxcbiAgICBwcm90b2NvbDogcGFydHNbMl0udG9Mb3dlckNhc2UoKSxcbiAgICBwcmlvcml0eTogcGFyc2VJbnQocGFydHNbM10sIDEwKSxcbiAgICBpcDogcGFydHNbNF0sXG4gICAgYWRkcmVzczogcGFydHNbNF0sIC8vIGFkZHJlc3MgaXMgYW4gYWxpYXMgZm9yIGlwLlxuICAgIHBvcnQ6IHBhcnNlSW50KHBhcnRzWzVdLCAxMCksXG4gICAgLy8gc2tpcCBwYXJ0c1s2XSA9PSAndHlwJ1xuICAgIHR5cGU6IHBhcnRzWzddXG4gIH07XG5cbiAgZm9yICh2YXIgaSA9IDg7IGkgPCBwYXJ0cy5sZW5ndGg7IGkgKz0gMikge1xuICAgIHN3aXRjaCAocGFydHNbaV0pIHtcbiAgICAgIGNhc2UgJ3JhZGRyJzpcbiAgICAgICAgY2FuZGlkYXRlLnJlbGF0ZWRBZGRyZXNzID0gcGFydHNbaSArIDFdO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3Jwb3J0JzpcbiAgICAgICAgY2FuZGlkYXRlLnJlbGF0ZWRQb3J0ID0gcGFyc2VJbnQocGFydHNbaSArIDFdLCAxMCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndGNwdHlwZSc6XG4gICAgICAgIGNhbmRpZGF0ZS50Y3BUeXBlID0gcGFydHNbaSArIDFdO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3VmcmFnJzpcbiAgICAgICAgY2FuZGlkYXRlLnVmcmFnID0gcGFydHNbaSArIDFdOyAvLyBmb3IgYmFja3dhcmQgY29tcGFiaWxpdHkuXG4gICAgICAgIGNhbmRpZGF0ZS51c2VybmFtZUZyYWdtZW50ID0gcGFydHNbaSArIDFdO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6IC8vIGV4dGVuc2lvbiBoYW5kbGluZywgaW4gcGFydGljdWxhciB1ZnJhZ1xuICAgICAgICBjYW5kaWRhdGVbcGFydHNbaV1dID0gcGFydHNbaSArIDFdO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGNhbmRpZGF0ZTtcbn07XG5cbi8vIFRyYW5zbGF0ZXMgYSBjYW5kaWRhdGUgb2JqZWN0IGludG8gU0RQIGNhbmRpZGF0ZSBhdHRyaWJ1dGUuXG5TRFBVdGlscy53cml0ZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKGNhbmRpZGF0ZSkge1xuICB2YXIgc2RwID0gW107XG4gIHNkcC5wdXNoKGNhbmRpZGF0ZS5mb3VuZGF0aW9uKTtcbiAgc2RwLnB1c2goY2FuZGlkYXRlLmNvbXBvbmVudCk7XG4gIHNkcC5wdXNoKGNhbmRpZGF0ZS5wcm90b2NvbC50b1VwcGVyQ2FzZSgpKTtcbiAgc2RwLnB1c2goY2FuZGlkYXRlLnByaW9yaXR5KTtcbiAgc2RwLnB1c2goY2FuZGlkYXRlLmFkZHJlc3MgfHwgY2FuZGlkYXRlLmlwKTtcbiAgc2RwLnB1c2goY2FuZGlkYXRlLnBvcnQpO1xuXG4gIHZhciB0eXBlID0gY2FuZGlkYXRlLnR5cGU7XG4gIHNkcC5wdXNoKCd0eXAnKTtcbiAgc2RwLnB1c2godHlwZSk7XG4gIGlmICh0eXBlICE9PSAnaG9zdCcgJiYgY2FuZGlkYXRlLnJlbGF0ZWRBZGRyZXNzICYmXG4gICAgICBjYW5kaWRhdGUucmVsYXRlZFBvcnQpIHtcbiAgICBzZHAucHVzaCgncmFkZHInKTtcbiAgICBzZHAucHVzaChjYW5kaWRhdGUucmVsYXRlZEFkZHJlc3MpO1xuICAgIHNkcC5wdXNoKCdycG9ydCcpO1xuICAgIHNkcC5wdXNoKGNhbmRpZGF0ZS5yZWxhdGVkUG9ydCk7XG4gIH1cbiAgaWYgKGNhbmRpZGF0ZS50Y3BUeXBlICYmIGNhbmRpZGF0ZS5wcm90b2NvbC50b0xvd2VyQ2FzZSgpID09PSAndGNwJykge1xuICAgIHNkcC5wdXNoKCd0Y3B0eXBlJyk7XG4gICAgc2RwLnB1c2goY2FuZGlkYXRlLnRjcFR5cGUpO1xuICB9XG4gIGlmIChjYW5kaWRhdGUudXNlcm5hbWVGcmFnbWVudCB8fCBjYW5kaWRhdGUudWZyYWcpIHtcbiAgICBzZHAucHVzaCgndWZyYWcnKTtcbiAgICBzZHAucHVzaChjYW5kaWRhdGUudXNlcm5hbWVGcmFnbWVudCB8fCBjYW5kaWRhdGUudWZyYWcpO1xuICB9XG4gIHJldHVybiAnY2FuZGlkYXRlOicgKyBzZHAuam9pbignICcpO1xufTtcblxuLy8gUGFyc2VzIGFuIGljZS1vcHRpb25zIGxpbmUsIHJldHVybnMgYW4gYXJyYXkgb2Ygb3B0aW9uIHRhZ3MuXG4vLyBhPWljZS1vcHRpb25zOmZvbyBiYXJcblNEUFV0aWxzLnBhcnNlSWNlT3B0aW9ucyA9IGZ1bmN0aW9uKGxpbmUpIHtcbiAgcmV0dXJuIGxpbmUuc3Vic3RyKDE0KS5zcGxpdCgnICcpO1xufTtcblxuLy8gUGFyc2VzIGFuIHJ0cG1hcCBsaW5lLCByZXR1cm5zIFJUQ1J0cENvZGRlY1BhcmFtZXRlcnMuIFNhbXBsZSBpbnB1dDpcbi8vIGE9cnRwbWFwOjExMSBvcHVzLzQ4MDAwLzJcblNEUFV0aWxzLnBhcnNlUnRwTWFwID0gZnVuY3Rpb24obGluZSkge1xuICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cig5KS5zcGxpdCgnICcpO1xuICB2YXIgcGFyc2VkID0ge1xuICAgIHBheWxvYWRUeXBlOiBwYXJzZUludChwYXJ0cy5zaGlmdCgpLCAxMCkgLy8gd2FzOiBpZFxuICB9O1xuXG4gIHBhcnRzID0gcGFydHNbMF0uc3BsaXQoJy8nKTtcblxuICBwYXJzZWQubmFtZSA9IHBhcnRzWzBdO1xuICBwYXJzZWQuY2xvY2tSYXRlID0gcGFyc2VJbnQocGFydHNbMV0sIDEwKTsgLy8gd2FzOiBjbG9ja3JhdGVcbiAgcGFyc2VkLmNoYW5uZWxzID0gcGFydHMubGVuZ3RoID09PSAzID8gcGFyc2VJbnQocGFydHNbMl0sIDEwKSA6IDE7XG4gIC8vIGxlZ2FjeSBhbGlhcywgZ290IHJlbmFtZWQgYmFjayB0byBjaGFubmVscyBpbiBPUlRDLlxuICBwYXJzZWQubnVtQ2hhbm5lbHMgPSBwYXJzZWQuY2hhbm5lbHM7XG4gIHJldHVybiBwYXJzZWQ7XG59O1xuXG4vLyBHZW5lcmF0ZSBhbiBhPXJ0cG1hcCBsaW5lIGZyb20gUlRDUnRwQ29kZWNDYXBhYmlsaXR5IG9yXG4vLyBSVENSdHBDb2RlY1BhcmFtZXRlcnMuXG5TRFBVdGlscy53cml0ZVJ0cE1hcCA9IGZ1bmN0aW9uKGNvZGVjKSB7XG4gIHZhciBwdCA9IGNvZGVjLnBheWxvYWRUeXBlO1xuICBpZiAoY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGUgIT09IHVuZGVmaW5lZCkge1xuICAgIHB0ID0gY29kZWMucHJlZmVycmVkUGF5bG9hZFR5cGU7XG4gIH1cbiAgdmFyIGNoYW5uZWxzID0gY29kZWMuY2hhbm5lbHMgfHwgY29kZWMubnVtQ2hhbm5lbHMgfHwgMTtcbiAgcmV0dXJuICdhPXJ0cG1hcDonICsgcHQgKyAnICcgKyBjb2RlYy5uYW1lICsgJy8nICsgY29kZWMuY2xvY2tSYXRlICtcbiAgICAgIChjaGFubmVscyAhPT0gMSA/ICcvJyArIGNoYW5uZWxzIDogJycpICsgJ1xcclxcbic7XG59O1xuXG4vLyBQYXJzZXMgYW4gYT1leHRtYXAgbGluZSAoaGVhZGVyZXh0ZW5zaW9uIGZyb20gUkZDIDUyODUpLiBTYW1wbGUgaW5wdXQ6XG4vLyBhPWV4dG1hcDoyIHVybjppZXRmOnBhcmFtczpydHAtaGRyZXh0OnRvZmZzZXRcbi8vIGE9ZXh0bWFwOjIvc2VuZG9ubHkgdXJuOmlldGY6cGFyYW1zOnJ0cC1oZHJleHQ6dG9mZnNldFxuU0RQVXRpbHMucGFyc2VFeHRtYXAgPSBmdW5jdGlvbihsaW5lKSB7XG4gIHZhciBwYXJ0cyA9IGxpbmUuc3Vic3RyKDkpLnNwbGl0KCcgJyk7XG4gIHJldHVybiB7XG4gICAgaWQ6IHBhcnNlSW50KHBhcnRzWzBdLCAxMCksXG4gICAgZGlyZWN0aW9uOiBwYXJ0c1swXS5pbmRleE9mKCcvJykgPiAwID8gcGFydHNbMF0uc3BsaXQoJy8nKVsxXSA6ICdzZW5kcmVjdicsXG4gICAgdXJpOiBwYXJ0c1sxXVxuICB9O1xufTtcblxuLy8gR2VuZXJhdGVzIGE9ZXh0bWFwIGxpbmUgZnJvbSBSVENSdHBIZWFkZXJFeHRlbnNpb25QYXJhbWV0ZXJzIG9yXG4vLyBSVENSdHBIZWFkZXJFeHRlbnNpb24uXG5TRFBVdGlscy53cml0ZUV4dG1hcCA9IGZ1bmN0aW9uKGhlYWRlckV4dGVuc2lvbikge1xuICByZXR1cm4gJ2E9ZXh0bWFwOicgKyAoaGVhZGVyRXh0ZW5zaW9uLmlkIHx8IGhlYWRlckV4dGVuc2lvbi5wcmVmZXJyZWRJZCkgK1xuICAgICAgKGhlYWRlckV4dGVuc2lvbi5kaXJlY3Rpb24gJiYgaGVhZGVyRXh0ZW5zaW9uLmRpcmVjdGlvbiAhPT0gJ3NlbmRyZWN2J1xuICAgICAgICA/ICcvJyArIGhlYWRlckV4dGVuc2lvbi5kaXJlY3Rpb25cbiAgICAgICAgOiAnJykgK1xuICAgICAgJyAnICsgaGVhZGVyRXh0ZW5zaW9uLnVyaSArICdcXHJcXG4nO1xufTtcblxuLy8gUGFyc2VzIGFuIGZ0bXAgbGluZSwgcmV0dXJucyBkaWN0aW9uYXJ5LiBTYW1wbGUgaW5wdXQ6XG4vLyBhPWZtdHA6OTYgdmJyPW9uO2NuZz1vblxuLy8gQWxzbyBkZWFscyB3aXRoIHZicj1vbjsgY25nPW9uXG5TRFBVdGlscy5wYXJzZUZtdHAgPSBmdW5jdGlvbihsaW5lKSB7XG4gIHZhciBwYXJzZWQgPSB7fTtcbiAgdmFyIGt2O1xuICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cihsaW5lLmluZGV4T2YoJyAnKSArIDEpLnNwbGl0KCc7Jyk7XG4gIGZvciAodmFyIGogPSAwOyBqIDwgcGFydHMubGVuZ3RoOyBqKyspIHtcbiAgICBrdiA9IHBhcnRzW2pdLnRyaW0oKS5zcGxpdCgnPScpO1xuICAgIHBhcnNlZFtrdlswXS50cmltKCldID0ga3ZbMV07XG4gIH1cbiAgcmV0dXJuIHBhcnNlZDtcbn07XG5cbi8vIEdlbmVyYXRlcyBhbiBhPWZ0bXAgbGluZSBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvciBSVENSdHBDb2RlY1BhcmFtZXRlcnMuXG5TRFBVdGlscy53cml0ZUZtdHAgPSBmdW5jdGlvbihjb2RlYykge1xuICB2YXIgbGluZSA9ICcnO1xuICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTtcbiAgaWYgKGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlICE9PSB1bmRlZmluZWQpIHtcbiAgICBwdCA9IGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlO1xuICB9XG4gIGlmIChjb2RlYy5wYXJhbWV0ZXJzICYmIE9iamVjdC5rZXlzKGNvZGVjLnBhcmFtZXRlcnMpLmxlbmd0aCkge1xuICAgIHZhciBwYXJhbXMgPSBbXTtcbiAgICBPYmplY3Qua2V5cyhjb2RlYy5wYXJhbWV0ZXJzKS5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtKSB7XG4gICAgICBpZiAoY29kZWMucGFyYW1ldGVyc1twYXJhbV0pIHtcbiAgICAgICAgcGFyYW1zLnB1c2gocGFyYW0gKyAnPScgKyBjb2RlYy5wYXJhbWV0ZXJzW3BhcmFtXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYXJhbXMucHVzaChwYXJhbSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgbGluZSArPSAnYT1mbXRwOicgKyBwdCArICcgJyArIHBhcmFtcy5qb2luKCc7JykgKyAnXFxyXFxuJztcbiAgfVxuICByZXR1cm4gbGluZTtcbn07XG5cbi8vIFBhcnNlcyBhbiBydGNwLWZiIGxpbmUsIHJldHVybnMgUlRDUFJ0Y3BGZWVkYmFjayBvYmplY3QuIFNhbXBsZSBpbnB1dDpcbi8vIGE9cnRjcC1mYjo5OCBuYWNrIHJwc2lcblNEUFV0aWxzLnBhcnNlUnRjcEZiID0gZnVuY3Rpb24obGluZSkge1xuICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cihsaW5lLmluZGV4T2YoJyAnKSArIDEpLnNwbGl0KCcgJyk7XG4gIHJldHVybiB7XG4gICAgdHlwZTogcGFydHMuc2hpZnQoKSxcbiAgICBwYXJhbWV0ZXI6IHBhcnRzLmpvaW4oJyAnKVxuICB9O1xufTtcbi8vIEdlbmVyYXRlIGE9cnRjcC1mYiBsaW5lcyBmcm9tIFJUQ1J0cENvZGVjQ2FwYWJpbGl0eSBvciBSVENSdHBDb2RlY1BhcmFtZXRlcnMuXG5TRFBVdGlscy53cml0ZVJ0Y3BGYiA9IGZ1bmN0aW9uKGNvZGVjKSB7XG4gIHZhciBsaW5lcyA9ICcnO1xuICB2YXIgcHQgPSBjb2RlYy5wYXlsb2FkVHlwZTtcbiAgaWYgKGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlICE9PSB1bmRlZmluZWQpIHtcbiAgICBwdCA9IGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlO1xuICB9XG4gIGlmIChjb2RlYy5ydGNwRmVlZGJhY2sgJiYgY29kZWMucnRjcEZlZWRiYWNrLmxlbmd0aCkge1xuICAgIC8vIEZJWE1FOiBzcGVjaWFsIGhhbmRsaW5nIGZvciB0cnItaW50P1xuICAgIGNvZGVjLnJ0Y3BGZWVkYmFjay5mb3JFYWNoKGZ1bmN0aW9uKGZiKSB7XG4gICAgICBsaW5lcyArPSAnYT1ydGNwLWZiOicgKyBwdCArICcgJyArIGZiLnR5cGUgK1xuICAgICAgKGZiLnBhcmFtZXRlciAmJiBmYi5wYXJhbWV0ZXIubGVuZ3RoID8gJyAnICsgZmIucGFyYW1ldGVyIDogJycpICtcbiAgICAgICAgICAnXFxyXFxuJztcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gbGluZXM7XG59O1xuXG4vLyBQYXJzZXMgYW4gUkZDIDU1NzYgc3NyYyBtZWRpYSBhdHRyaWJ1dGUuIFNhbXBsZSBpbnB1dDpcbi8vIGE9c3NyYzozNzM1OTI4NTU5IGNuYW1lOnNvbWV0aGluZ1xuU0RQVXRpbHMucGFyc2VTc3JjTWVkaWEgPSBmdW5jdGlvbihsaW5lKSB7XG4gIHZhciBzcCA9IGxpbmUuaW5kZXhPZignICcpO1xuICB2YXIgcGFydHMgPSB7XG4gICAgc3NyYzogcGFyc2VJbnQobGluZS5zdWJzdHIoNywgc3AgLSA3KSwgMTApXG4gIH07XG4gIHZhciBjb2xvbiA9IGxpbmUuaW5kZXhPZignOicsIHNwKTtcbiAgaWYgKGNvbG9uID4gLTEpIHtcbiAgICBwYXJ0cy5hdHRyaWJ1dGUgPSBsaW5lLnN1YnN0cihzcCArIDEsIGNvbG9uIC0gc3AgLSAxKTtcbiAgICBwYXJ0cy52YWx1ZSA9IGxpbmUuc3Vic3RyKGNvbG9uICsgMSk7XG4gIH0gZWxzZSB7XG4gICAgcGFydHMuYXR0cmlidXRlID0gbGluZS5zdWJzdHIoc3AgKyAxKTtcbiAgfVxuICByZXR1cm4gcGFydHM7XG59O1xuXG5TRFBVdGlscy5wYXJzZVNzcmNHcm91cCA9IGZ1bmN0aW9uKGxpbmUpIHtcbiAgdmFyIHBhcnRzID0gbGluZS5zdWJzdHIoMTMpLnNwbGl0KCcgJyk7XG4gIHJldHVybiB7XG4gICAgc2VtYW50aWNzOiBwYXJ0cy5zaGlmdCgpLFxuICAgIHNzcmNzOiBwYXJ0cy5tYXAoZnVuY3Rpb24oc3NyYykge1xuICAgICAgcmV0dXJuIHBhcnNlSW50KHNzcmMsIDEwKTtcbiAgICB9KVxuICB9O1xufTtcblxuLy8gRXh0cmFjdHMgdGhlIE1JRCAoUkZDIDU4ODgpIGZyb20gYSBtZWRpYSBzZWN0aW9uLlxuLy8gcmV0dXJucyB0aGUgTUlEIG9yIHVuZGVmaW5lZCBpZiBubyBtaWQgbGluZSB3YXMgZm91bmQuXG5TRFBVdGlscy5nZXRNaWQgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHtcbiAgdmFyIG1pZCA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiwgJ2E9bWlkOicpWzBdO1xuICBpZiAobWlkKSB7XG4gICAgcmV0dXJuIG1pZC5zdWJzdHIoNik7XG4gIH1cbn07XG5cblNEUFV0aWxzLnBhcnNlRmluZ2VycHJpbnQgPSBmdW5jdGlvbihsaW5lKSB7XG4gIHZhciBwYXJ0cyA9IGxpbmUuc3Vic3RyKDE0KS5zcGxpdCgnICcpO1xuICByZXR1cm4ge1xuICAgIGFsZ29yaXRobTogcGFydHNbMF0udG9Mb3dlckNhc2UoKSwgLy8gYWxnb3JpdGhtIGlzIGNhc2Utc2Vuc2l0aXZlIGluIEVkZ2UuXG4gICAgdmFsdWU6IHBhcnRzWzFdXG4gIH07XG59O1xuXG4vLyBFeHRyYWN0cyBEVExTIHBhcmFtZXRlcnMgZnJvbSBTRFAgbWVkaWEgc2VjdGlvbiBvciBzZXNzaW9ucGFydC5cbi8vIEZJWE1FOiBmb3IgY29uc2lzdGVuY3kgd2l0aCBvdGhlciBmdW5jdGlvbnMgdGhpcyBzaG91bGQgb25seVxuLy8gICBnZXQgdGhlIGZpbmdlcnByaW50IGxpbmUgYXMgaW5wdXQuIFNlZSBhbHNvIGdldEljZVBhcmFtZXRlcnMuXG5TRFBVdGlscy5nZXREdGxzUGFyYW1ldGVycyA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbiwgc2Vzc2lvbnBhcnQpIHtcbiAgdmFyIGxpbmVzID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uICsgc2Vzc2lvbnBhcnQsXG4gICAgJ2E9ZmluZ2VycHJpbnQ6Jyk7XG4gIC8vIE5vdGU6IGE9c2V0dXAgbGluZSBpcyBpZ25vcmVkIHNpbmNlIHdlIHVzZSB0aGUgJ2F1dG8nIHJvbGUuXG4gIC8vIE5vdGUyOiAnYWxnb3JpdGhtJyBpcyBub3QgY2FzZSBzZW5zaXRpdmUgZXhjZXB0IGluIEVkZ2UuXG4gIHJldHVybiB7XG4gICAgcm9sZTogJ2F1dG8nLFxuICAgIGZpbmdlcnByaW50czogbGluZXMubWFwKFNEUFV0aWxzLnBhcnNlRmluZ2VycHJpbnQpXG4gIH07XG59O1xuXG4vLyBTZXJpYWxpemVzIERUTFMgcGFyYW1ldGVycyB0byBTRFAuXG5TRFBVdGlscy53cml0ZUR0bHNQYXJhbWV0ZXJzID0gZnVuY3Rpb24ocGFyYW1zLCBzZXR1cFR5cGUpIHtcbiAgdmFyIHNkcCA9ICdhPXNldHVwOicgKyBzZXR1cFR5cGUgKyAnXFxyXFxuJztcbiAgcGFyYW1zLmZpbmdlcnByaW50cy5mb3JFYWNoKGZ1bmN0aW9uKGZwKSB7XG4gICAgc2RwICs9ICdhPWZpbmdlcnByaW50OicgKyBmcC5hbGdvcml0aG0gKyAnICcgKyBmcC52YWx1ZSArICdcXHJcXG4nO1xuICB9KTtcbiAgcmV0dXJuIHNkcDtcbn07XG5cbi8vIFBhcnNlcyBhPWNyeXB0byBsaW5lcyBpbnRvXG4vLyAgIGh0dHBzOi8vcmF3Z2l0LmNvbS9hYm9iYS9lZGdlcnRjL21hc3Rlci9tc29ydGMtcnM0Lmh0bWwjZGljdGlvbmFyeS1ydGNzcnRwc2Rlc3BhcmFtZXRlcnMtbWVtYmVyc1xuU0RQVXRpbHMucGFyc2VDcnlwdG9MaW5lID0gZnVuY3Rpb24obGluZSkge1xuICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cig5KS5zcGxpdCgnICcpO1xuICByZXR1cm4ge1xuICAgIHRhZzogcGFyc2VJbnQocGFydHNbMF0sIDEwKSxcbiAgICBjcnlwdG9TdWl0ZTogcGFydHNbMV0sXG4gICAga2V5UGFyYW1zOiBwYXJ0c1syXSxcbiAgICBzZXNzaW9uUGFyYW1zOiBwYXJ0cy5zbGljZSgzKSxcbiAgfTtcbn07XG5cblNEUFV0aWxzLndyaXRlQ3J5cHRvTGluZSA9IGZ1bmN0aW9uKHBhcmFtZXRlcnMpIHtcbiAgcmV0dXJuICdhPWNyeXB0bzonICsgcGFyYW1ldGVycy50YWcgKyAnICcgK1xuICAgIHBhcmFtZXRlcnMuY3J5cHRvU3VpdGUgKyAnICcgK1xuICAgICh0eXBlb2YgcGFyYW1ldGVycy5rZXlQYXJhbXMgPT09ICdvYmplY3QnXG4gICAgICA/IFNEUFV0aWxzLndyaXRlQ3J5cHRvS2V5UGFyYW1zKHBhcmFtZXRlcnMua2V5UGFyYW1zKVxuICAgICAgOiBwYXJhbWV0ZXJzLmtleVBhcmFtcykgK1xuICAgIChwYXJhbWV0ZXJzLnNlc3Npb25QYXJhbXMgPyAnICcgKyBwYXJhbWV0ZXJzLnNlc3Npb25QYXJhbXMuam9pbignICcpIDogJycpICtcbiAgICAnXFxyXFxuJztcbn07XG5cbi8vIFBhcnNlcyB0aGUgY3J5cHRvIGtleSBwYXJhbWV0ZXJzIGludG9cbi8vICAgaHR0cHM6Ly9yYXdnaXQuY29tL2Fib2JhL2VkZ2VydGMvbWFzdGVyL21zb3J0Yy1yczQuaHRtbCNydGNzcnRwa2V5cGFyYW0qXG5TRFBVdGlscy5wYXJzZUNyeXB0b0tleVBhcmFtcyA9IGZ1bmN0aW9uKGtleVBhcmFtcykge1xuICBpZiAoa2V5UGFyYW1zLmluZGV4T2YoJ2lubGluZTonKSAhPT0gMCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHZhciBwYXJ0cyA9IGtleVBhcmFtcy5zdWJzdHIoNykuc3BsaXQoJ3wnKTtcbiAgcmV0dXJuIHtcbiAgICBrZXlNZXRob2Q6ICdpbmxpbmUnLFxuICAgIGtleVNhbHQ6IHBhcnRzWzBdLFxuICAgIGxpZmVUaW1lOiBwYXJ0c1sxXSxcbiAgICBta2lWYWx1ZTogcGFydHNbMl0gPyBwYXJ0c1syXS5zcGxpdCgnOicpWzBdIDogdW5kZWZpbmVkLFxuICAgIG1raUxlbmd0aDogcGFydHNbMl0gPyBwYXJ0c1syXS5zcGxpdCgnOicpWzFdIDogdW5kZWZpbmVkLFxuICB9O1xufTtcblxuU0RQVXRpbHMud3JpdGVDcnlwdG9LZXlQYXJhbXMgPSBmdW5jdGlvbihrZXlQYXJhbXMpIHtcbiAgcmV0dXJuIGtleVBhcmFtcy5rZXlNZXRob2QgKyAnOidcbiAgICArIGtleVBhcmFtcy5rZXlTYWx0ICtcbiAgICAoa2V5UGFyYW1zLmxpZmVUaW1lID8gJ3wnICsga2V5UGFyYW1zLmxpZmVUaW1lIDogJycpICtcbiAgICAoa2V5UGFyYW1zLm1raVZhbHVlICYmIGtleVBhcmFtcy5ta2lMZW5ndGhcbiAgICAgID8gJ3wnICsga2V5UGFyYW1zLm1raVZhbHVlICsgJzonICsga2V5UGFyYW1zLm1raUxlbmd0aFxuICAgICAgOiAnJyk7XG59O1xuXG4vLyBFeHRyYWN0cyBhbGwgU0RFUyBwYXJhbXRlcnMuXG5TRFBVdGlscy5nZXRDcnlwdG9QYXJhbWV0ZXJzID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uLCBzZXNzaW9ucGFydCkge1xuICB2YXIgbGluZXMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24gKyBzZXNzaW9ucGFydCxcbiAgICAnYT1jcnlwdG86Jyk7XG4gIHJldHVybiBsaW5lcy5tYXAoU0RQVXRpbHMucGFyc2VDcnlwdG9MaW5lKTtcbn07XG5cbi8vIFBhcnNlcyBJQ0UgaW5mb3JtYXRpb24gZnJvbSBTRFAgbWVkaWEgc2VjdGlvbiBvciBzZXNzaW9ucGFydC5cbi8vIEZJWE1FOiBmb3IgY29uc2lzdGVuY3kgd2l0aCBvdGhlciBmdW5jdGlvbnMgdGhpcyBzaG91bGQgb25seVxuLy8gICBnZXQgdGhlIGljZS11ZnJhZyBhbmQgaWNlLXB3ZCBsaW5lcyBhcyBpbnB1dC5cblNEUFV0aWxzLmdldEljZVBhcmFtZXRlcnMgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KSB7XG4gIHZhciB1ZnJhZyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiArIHNlc3Npb25wYXJ0LFxuICAgICdhPWljZS11ZnJhZzonKVswXTtcbiAgdmFyIHB3ZCA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiArIHNlc3Npb25wYXJ0LFxuICAgICdhPWljZS1wd2Q6JylbMF07XG4gIGlmICghKHVmcmFnICYmIHB3ZCkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICByZXR1cm4ge1xuICAgIHVzZXJuYW1lRnJhZ21lbnQ6IHVmcmFnLnN1YnN0cigxMiksXG4gICAgcGFzc3dvcmQ6IHB3ZC5zdWJzdHIoMTApLFxuICB9O1xufTtcblxuLy8gU2VyaWFsaXplcyBJQ0UgcGFyYW1ldGVycyB0byBTRFAuXG5TRFBVdGlscy53cml0ZUljZVBhcmFtZXRlcnMgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgcmV0dXJuICdhPWljZS11ZnJhZzonICsgcGFyYW1zLnVzZXJuYW1lRnJhZ21lbnQgKyAnXFxyXFxuJyArXG4gICAgICAnYT1pY2UtcHdkOicgKyBwYXJhbXMucGFzc3dvcmQgKyAnXFxyXFxuJztcbn07XG5cbi8vIFBhcnNlcyB0aGUgU0RQIG1lZGlhIHNlY3Rpb24gYW5kIHJldHVybnMgUlRDUnRwUGFyYW1ldGVycy5cblNEUFV0aWxzLnBhcnNlUnRwUGFyYW1ldGVycyA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbikge1xuICB2YXIgZGVzY3JpcHRpb24gPSB7XG4gICAgY29kZWNzOiBbXSxcbiAgICBoZWFkZXJFeHRlbnNpb25zOiBbXSxcbiAgICBmZWNNZWNoYW5pc21zOiBbXSxcbiAgICBydGNwOiBbXVxuICB9O1xuICB2YXIgbGluZXMgPSBTRFBVdGlscy5zcGxpdExpbmVzKG1lZGlhU2VjdGlvbik7XG4gIHZhciBtbGluZSA9IGxpbmVzWzBdLnNwbGl0KCcgJyk7XG4gIGZvciAodmFyIGkgPSAzOyBpIDwgbWxpbmUubGVuZ3RoOyBpKyspIHsgLy8gZmluZCBhbGwgY29kZWNzIGZyb20gbWxpbmVbMy4uXVxuICAgIHZhciBwdCA9IG1saW5lW2ldO1xuICAgIHZhciBydHBtYXBsaW5lID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgoXG4gICAgICBtZWRpYVNlY3Rpb24sICdhPXJ0cG1hcDonICsgcHQgKyAnICcpWzBdO1xuICAgIGlmIChydHBtYXBsaW5lKSB7XG4gICAgICB2YXIgY29kZWMgPSBTRFBVdGlscy5wYXJzZVJ0cE1hcChydHBtYXBsaW5lKTtcbiAgICAgIHZhciBmbXRwcyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KFxuICAgICAgICBtZWRpYVNlY3Rpb24sICdhPWZtdHA6JyArIHB0ICsgJyAnKTtcbiAgICAgIC8vIE9ubHkgdGhlIGZpcnN0IGE9Zm10cDo8cHQ+IGlzIGNvbnNpZGVyZWQuXG4gICAgICBjb2RlYy5wYXJhbWV0ZXJzID0gZm10cHMubGVuZ3RoID8gU0RQVXRpbHMucGFyc2VGbXRwKGZtdHBzWzBdKSA6IHt9O1xuICAgICAgY29kZWMucnRjcEZlZWRiYWNrID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgoXG4gICAgICAgIG1lZGlhU2VjdGlvbiwgJ2E9cnRjcC1mYjonICsgcHQgKyAnICcpXG4gICAgICAgIC5tYXAoU0RQVXRpbHMucGFyc2VSdGNwRmIpO1xuICAgICAgZGVzY3JpcHRpb24uY29kZWNzLnB1c2goY29kZWMpO1xuICAgICAgLy8gcGFyc2UgRkVDIG1lY2hhbmlzbXMgZnJvbSBydHBtYXAgbGluZXMuXG4gICAgICBzd2l0Y2ggKGNvZGVjLm5hbWUudG9VcHBlckNhc2UoKSkge1xuICAgICAgICBjYXNlICdSRUQnOlxuICAgICAgICBjYXNlICdVTFBGRUMnOlxuICAgICAgICAgIGRlc2NyaXB0aW9uLmZlY01lY2hhbmlzbXMucHVzaChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiAvLyBvbmx5IFJFRCBhbmQgVUxQRkVDIGFyZSByZWNvZ25pemVkIGFzIEZFQyBtZWNoYW5pc21zLlxuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPWV4dG1hcDonKS5mb3JFYWNoKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICBkZXNjcmlwdGlvbi5oZWFkZXJFeHRlbnNpb25zLnB1c2goU0RQVXRpbHMucGFyc2VFeHRtYXAobGluZSkpO1xuICB9KTtcbiAgLy8gRklYTUU6IHBhcnNlIHJ0Y3AuXG4gIHJldHVybiBkZXNjcmlwdGlvbjtcbn07XG5cbi8vIEdlbmVyYXRlcyBwYXJ0cyBvZiB0aGUgU0RQIG1lZGlhIHNlY3Rpb24gZGVzY3JpYmluZyB0aGUgY2FwYWJpbGl0aWVzIC9cbi8vIHBhcmFtZXRlcnMuXG5TRFBVdGlscy53cml0ZVJ0cERlc2NyaXB0aW9uID0gZnVuY3Rpb24oa2luZCwgY2Fwcykge1xuICB2YXIgc2RwID0gJyc7XG5cbiAgLy8gQnVpbGQgdGhlIG1saW5lLlxuICBzZHAgKz0gJ209JyArIGtpbmQgKyAnICc7XG4gIHNkcCArPSBjYXBzLmNvZGVjcy5sZW5ndGggPiAwID8gJzknIDogJzAnOyAvLyByZWplY3QgaWYgbm8gY29kZWNzLlxuICBzZHAgKz0gJyBVRFAvVExTL1JUUC9TQVZQRiAnO1xuICBzZHAgKz0gY2Fwcy5jb2RlY3MubWFwKGZ1bmN0aW9uKGNvZGVjKSB7XG4gICAgaWYgKGNvZGVjLnByZWZlcnJlZFBheWxvYWRUeXBlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBjb2RlYy5wcmVmZXJyZWRQYXlsb2FkVHlwZTtcbiAgICB9XG4gICAgcmV0dXJuIGNvZGVjLnBheWxvYWRUeXBlO1xuICB9KS5qb2luKCcgJykgKyAnXFxyXFxuJztcblxuICBzZHAgKz0gJ2M9SU4gSVA0IDAuMC4wLjBcXHJcXG4nO1xuICBzZHAgKz0gJ2E9cnRjcDo5IElOIElQNCAwLjAuMC4wXFxyXFxuJztcblxuICAvLyBBZGQgYT1ydHBtYXAgbGluZXMgZm9yIGVhY2ggY29kZWMuIEFsc28gZm10cCBhbmQgcnRjcC1mYi5cbiAgY2Fwcy5jb2RlY3MuZm9yRWFjaChmdW5jdGlvbihjb2RlYykge1xuICAgIHNkcCArPSBTRFBVdGlscy53cml0ZVJ0cE1hcChjb2RlYyk7XG4gICAgc2RwICs9IFNEUFV0aWxzLndyaXRlRm10cChjb2RlYyk7XG4gICAgc2RwICs9IFNEUFV0aWxzLndyaXRlUnRjcEZiKGNvZGVjKTtcbiAgfSk7XG4gIHZhciBtYXhwdGltZSA9IDA7XG4gIGNhcHMuY29kZWNzLmZvckVhY2goZnVuY3Rpb24oY29kZWMpIHtcbiAgICBpZiAoY29kZWMubWF4cHRpbWUgPiBtYXhwdGltZSkge1xuICAgICAgbWF4cHRpbWUgPSBjb2RlYy5tYXhwdGltZTtcbiAgICB9XG4gIH0pO1xuICBpZiAobWF4cHRpbWUgPiAwKSB7XG4gICAgc2RwICs9ICdhPW1heHB0aW1lOicgKyBtYXhwdGltZSArICdcXHJcXG4nO1xuICB9XG4gIHNkcCArPSAnYT1ydGNwLW11eFxcclxcbic7XG5cbiAgaWYgKGNhcHMuaGVhZGVyRXh0ZW5zaW9ucykge1xuICAgIGNhcHMuaGVhZGVyRXh0ZW5zaW9ucy5mb3JFYWNoKGZ1bmN0aW9uKGV4dGVuc2lvbikge1xuICAgICAgc2RwICs9IFNEUFV0aWxzLndyaXRlRXh0bWFwKGV4dGVuc2lvbik7XG4gICAgfSk7XG4gIH1cbiAgLy8gRklYTUU6IHdyaXRlIGZlY01lY2hhbmlzbXMuXG4gIHJldHVybiBzZHA7XG59O1xuXG4vLyBQYXJzZXMgdGhlIFNEUCBtZWRpYSBzZWN0aW9uIGFuZCByZXR1cm5zIGFuIGFycmF5IG9mXG4vLyBSVENSdHBFbmNvZGluZ1BhcmFtZXRlcnMuXG5TRFBVdGlscy5wYXJzZVJ0cEVuY29kaW5nUGFyYW1ldGVycyA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbikge1xuICB2YXIgZW5jb2RpbmdQYXJhbWV0ZXJzID0gW107XG4gIHZhciBkZXNjcmlwdGlvbiA9IFNEUFV0aWxzLnBhcnNlUnRwUGFyYW1ldGVycyhtZWRpYVNlY3Rpb24pO1xuICB2YXIgaGFzUmVkID0gZGVzY3JpcHRpb24uZmVjTWVjaGFuaXNtcy5pbmRleE9mKCdSRUQnKSAhPT0gLTE7XG4gIHZhciBoYXNVbHBmZWMgPSBkZXNjcmlwdGlvbi5mZWNNZWNoYW5pc21zLmluZGV4T2YoJ1VMUEZFQycpICE9PSAtMTtcblxuICAvLyBmaWx0ZXIgYT1zc3JjOi4uLiBjbmFtZTosIGlnbm9yZSBQbGFuQi1tc2lkXG4gIHZhciBzc3JjcyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiwgJ2E9c3NyYzonKVxuICAgIC5tYXAoZnVuY3Rpb24obGluZSkge1xuICAgICAgcmV0dXJuIFNEUFV0aWxzLnBhcnNlU3NyY01lZGlhKGxpbmUpO1xuICAgIH0pXG4gICAgLmZpbHRlcihmdW5jdGlvbihwYXJ0cykge1xuICAgICAgcmV0dXJuIHBhcnRzLmF0dHJpYnV0ZSA9PT0gJ2NuYW1lJztcbiAgICB9KTtcbiAgdmFyIHByaW1hcnlTc3JjID0gc3NyY3MubGVuZ3RoID4gMCAmJiBzc3Jjc1swXS5zc3JjO1xuICB2YXIgc2Vjb25kYXJ5U3NyYztcblxuICB2YXIgZmxvd3MgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXNzcmMtZ3JvdXA6RklEJylcbiAgICAubWFwKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgIHZhciBwYXJ0cyA9IGxpbmUuc3Vic3RyKDE3KS5zcGxpdCgnICcpO1xuICAgICAgcmV0dXJuIHBhcnRzLm1hcChmdW5jdGlvbihwYXJ0KSB7XG4gICAgICAgIHJldHVybiBwYXJzZUludChwYXJ0LCAxMCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgaWYgKGZsb3dzLmxlbmd0aCA+IDAgJiYgZmxvd3NbMF0ubGVuZ3RoID4gMSAmJiBmbG93c1swXVswXSA9PT0gcHJpbWFyeVNzcmMpIHtcbiAgICBzZWNvbmRhcnlTc3JjID0gZmxvd3NbMF1bMV07XG4gIH1cblxuICBkZXNjcmlwdGlvbi5jb2RlY3MuZm9yRWFjaChmdW5jdGlvbihjb2RlYykge1xuICAgIGlmIChjb2RlYy5uYW1lLnRvVXBwZXJDYXNlKCkgPT09ICdSVFgnICYmIGNvZGVjLnBhcmFtZXRlcnMuYXB0KSB7XG4gICAgICB2YXIgZW5jUGFyYW0gPSB7XG4gICAgICAgIHNzcmM6IHByaW1hcnlTc3JjLFxuICAgICAgICBjb2RlY1BheWxvYWRUeXBlOiBwYXJzZUludChjb2RlYy5wYXJhbWV0ZXJzLmFwdCwgMTApXG4gICAgICB9O1xuICAgICAgaWYgKHByaW1hcnlTc3JjICYmIHNlY29uZGFyeVNzcmMpIHtcbiAgICAgICAgZW5jUGFyYW0ucnR4ID0ge3NzcmM6IHNlY29uZGFyeVNzcmN9O1xuICAgICAgfVxuICAgICAgZW5jb2RpbmdQYXJhbWV0ZXJzLnB1c2goZW5jUGFyYW0pO1xuICAgICAgaWYgKGhhc1JlZCkge1xuICAgICAgICBlbmNQYXJhbSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZW5jUGFyYW0pKTtcbiAgICAgICAgZW5jUGFyYW0uZmVjID0ge1xuICAgICAgICAgIHNzcmM6IHByaW1hcnlTc3JjLFxuICAgICAgICAgIG1lY2hhbmlzbTogaGFzVWxwZmVjID8gJ3JlZCt1bHBmZWMnIDogJ3JlZCdcbiAgICAgICAgfTtcbiAgICAgICAgZW5jb2RpbmdQYXJhbWV0ZXJzLnB1c2goZW5jUGFyYW0pO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIGlmIChlbmNvZGluZ1BhcmFtZXRlcnMubGVuZ3RoID09PSAwICYmIHByaW1hcnlTc3JjKSB7XG4gICAgZW5jb2RpbmdQYXJhbWV0ZXJzLnB1c2goe1xuICAgICAgc3NyYzogcHJpbWFyeVNzcmNcbiAgICB9KTtcbiAgfVxuXG4gIC8vIHdlIHN1cHBvcnQgYm90aCBiPUFTIGFuZCBiPVRJQVMgYnV0IGludGVycHJldCBBUyBhcyBUSUFTLlxuICB2YXIgYmFuZHdpZHRoID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYj0nKTtcbiAgaWYgKGJhbmR3aWR0aC5sZW5ndGgpIHtcbiAgICBpZiAoYmFuZHdpZHRoWzBdLmluZGV4T2YoJ2I9VElBUzonKSA9PT0gMCkge1xuICAgICAgYmFuZHdpZHRoID0gcGFyc2VJbnQoYmFuZHdpZHRoWzBdLnN1YnN0cig3KSwgMTApO1xuICAgIH0gZWxzZSBpZiAoYmFuZHdpZHRoWzBdLmluZGV4T2YoJ2I9QVM6JykgPT09IDApIHtcbiAgICAgIC8vIHVzZSBmb3JtdWxhIGZyb20gSlNFUCB0byBjb252ZXJ0IGI9QVMgdG8gVElBUyB2YWx1ZS5cbiAgICAgIGJhbmR3aWR0aCA9IHBhcnNlSW50KGJhbmR3aWR0aFswXS5zdWJzdHIoNSksIDEwKSAqIDEwMDAgKiAwLjk1XG4gICAgICAgICAgLSAoNTAgKiA0MCAqIDgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBiYW5kd2lkdGggPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGVuY29kaW5nUGFyYW1ldGVycy5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgcGFyYW1zLm1heEJpdHJhdGUgPSBiYW5kd2lkdGg7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIGVuY29kaW5nUGFyYW1ldGVycztcbn07XG5cbi8vIHBhcnNlcyBodHRwOi8vZHJhZnQub3J0Yy5vcmcvI3J0Y3J0Y3BwYXJhbWV0ZXJzKlxuU0RQVXRpbHMucGFyc2VSdGNwUGFyYW1ldGVycyA9IGZ1bmN0aW9uKG1lZGlhU2VjdGlvbikge1xuICB2YXIgcnRjcFBhcmFtZXRlcnMgPSB7fTtcblxuICAvLyBHZXRzIHRoZSBmaXJzdCBTU1JDLiBOb3RlIHRoYSB3aXRoIFJUWCB0aGVyZSBtaWdodCBiZSBtdWx0aXBsZVxuICAvLyBTU1JDcy5cbiAgdmFyIHJlbW90ZVNzcmMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXNzcmM6JylcbiAgICAubWFwKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgIHJldHVybiBTRFBVdGlscy5wYXJzZVNzcmNNZWRpYShsaW5lKTtcbiAgICB9KVxuICAgIC5maWx0ZXIoZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqLmF0dHJpYnV0ZSA9PT0gJ2NuYW1lJztcbiAgICB9KVswXTtcbiAgaWYgKHJlbW90ZVNzcmMpIHtcbiAgICBydGNwUGFyYW1ldGVycy5jbmFtZSA9IHJlbW90ZVNzcmMudmFsdWU7XG4gICAgcnRjcFBhcmFtZXRlcnMuc3NyYyA9IHJlbW90ZVNzcmMuc3NyYztcbiAgfVxuXG4gIC8vIEVkZ2UgdXNlcyB0aGUgY29tcG91bmQgYXR0cmlidXRlIGluc3RlYWQgb2YgcmVkdWNlZFNpemVcbiAgLy8gY29tcG91bmQgaXMgIXJlZHVjZWRTaXplXG4gIHZhciByc2l6ZSA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiwgJ2E9cnRjcC1yc2l6ZScpO1xuICBydGNwUGFyYW1ldGVycy5yZWR1Y2VkU2l6ZSA9IHJzaXplLmxlbmd0aCA+IDA7XG4gIHJ0Y3BQYXJhbWV0ZXJzLmNvbXBvdW5kID0gcnNpemUubGVuZ3RoID09PSAwO1xuXG4gIC8vIHBhcnNlcyB0aGUgcnRjcC1tdXggYXR0ctGWYnV0ZS5cbiAgLy8gTm90ZSB0aGF0IEVkZ2UgZG9lcyBub3Qgc3VwcG9ydCB1bm11eGVkIFJUQ1AuXG4gIHZhciBtdXggPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXJ0Y3AtbXV4Jyk7XG4gIHJ0Y3BQYXJhbWV0ZXJzLm11eCA9IG11eC5sZW5ndGggPiAwO1xuXG4gIHJldHVybiBydGNwUGFyYW1ldGVycztcbn07XG5cbi8vIHBhcnNlcyBlaXRoZXIgYT1tc2lkOiBvciBhPXNzcmM6Li4uIG1zaWQgbGluZXMgYW5kIHJldHVybnNcbi8vIHRoZSBpZCBvZiB0aGUgTWVkaWFTdHJlYW0gYW5kIE1lZGlhU3RyZWFtVHJhY2suXG5TRFBVdGlscy5wYXJzZU1zaWQgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHtcbiAgdmFyIHBhcnRzO1xuICB2YXIgc3BlYyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiwgJ2E9bXNpZDonKTtcbiAgaWYgKHNwZWMubGVuZ3RoID09PSAxKSB7XG4gICAgcGFydHMgPSBzcGVjWzBdLnN1YnN0cig3KS5zcGxpdCgnICcpO1xuICAgIHJldHVybiB7c3RyZWFtOiBwYXJ0c1swXSwgdHJhY2s6IHBhcnRzWzFdfTtcbiAgfVxuICB2YXIgcGxhbkIgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXNzcmM6JylcbiAgICAubWFwKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgIHJldHVybiBTRFBVdGlscy5wYXJzZVNzcmNNZWRpYShsaW5lKTtcbiAgICB9KVxuICAgIC5maWx0ZXIoZnVuY3Rpb24obXNpZFBhcnRzKSB7XG4gICAgICByZXR1cm4gbXNpZFBhcnRzLmF0dHJpYnV0ZSA9PT0gJ21zaWQnO1xuICAgIH0pO1xuICBpZiAocGxhbkIubGVuZ3RoID4gMCkge1xuICAgIHBhcnRzID0gcGxhbkJbMF0udmFsdWUuc3BsaXQoJyAnKTtcbiAgICByZXR1cm4ge3N0cmVhbTogcGFydHNbMF0sIHRyYWNrOiBwYXJ0c1sxXX07XG4gIH1cbn07XG5cbi8vIFNDVFBcbi8vIHBhcnNlcyBkcmFmdC1pZXRmLW1tdXNpYy1zY3RwLXNkcC0yNiBmaXJzdCBhbmQgZmFsbHMgYmFja1xuLy8gdG8gZHJhZnQtaWV0Zi1tbXVzaWMtc2N0cC1zZHAtMDVcblNEUFV0aWxzLnBhcnNlU2N0cERlc2NyaXB0aW9uID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uKSB7XG4gIHZhciBtbGluZSA9IFNEUFV0aWxzLnBhcnNlTUxpbmUobWVkaWFTZWN0aW9uKTtcbiAgdmFyIG1heFNpemVMaW5lID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1tYXgtbWVzc2FnZS1zaXplOicpO1xuICB2YXIgbWF4TWVzc2FnZVNpemU7XG4gIGlmIChtYXhTaXplTGluZS5sZW5ndGggPiAwKSB7XG4gICAgbWF4TWVzc2FnZVNpemUgPSBwYXJzZUludChtYXhTaXplTGluZVswXS5zdWJzdHIoMTkpLCAxMCk7XG4gIH1cbiAgaWYgKGlzTmFOKG1heE1lc3NhZ2VTaXplKSkge1xuICAgIG1heE1lc3NhZ2VTaXplID0gNjU1MzY7XG4gIH1cbiAgdmFyIHNjdHBQb3J0ID0gU0RQVXRpbHMubWF0Y2hQcmVmaXgobWVkaWFTZWN0aW9uLCAnYT1zY3RwLXBvcnQ6Jyk7XG4gIGlmIChzY3RwUG9ydC5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBvcnQ6IHBhcnNlSW50KHNjdHBQb3J0WzBdLnN1YnN0cigxMiksIDEwKSxcbiAgICAgIHByb3RvY29sOiBtbGluZS5mbXQsXG4gICAgICBtYXhNZXNzYWdlU2l6ZTogbWF4TWVzc2FnZVNpemVcbiAgICB9O1xuICB9XG4gIHZhciBzY3RwTWFwTGluZXMgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdhPXNjdHBtYXA6Jyk7XG4gIGlmIChzY3RwTWFwTGluZXMubGVuZ3RoID4gMCkge1xuICAgIHZhciBwYXJ0cyA9IFNEUFV0aWxzLm1hdGNoUHJlZml4KG1lZGlhU2VjdGlvbiwgJ2E9c2N0cG1hcDonKVswXVxuICAgICAgLnN1YnN0cigxMClcbiAgICAgIC5zcGxpdCgnICcpO1xuICAgIHJldHVybiB7XG4gICAgICBwb3J0OiBwYXJzZUludChwYXJ0c1swXSwgMTApLFxuICAgICAgcHJvdG9jb2w6IHBhcnRzWzFdLFxuICAgICAgbWF4TWVzc2FnZVNpemU6IG1heE1lc3NhZ2VTaXplXG4gICAgfTtcbiAgfVxufTtcblxuLy8gU0NUUFxuLy8gb3V0cHV0cyB0aGUgZHJhZnQtaWV0Zi1tbXVzaWMtc2N0cC1zZHAtMjYgdmVyc2lvbiB0aGF0IGFsbCBicm93c2Vyc1xuLy8gc3VwcG9ydCBieSBub3cgcmVjZWl2aW5nIGluIHRoaXMgZm9ybWF0LCB1bmxlc3Mgd2Ugb3JpZ2luYWxseSBwYXJzZWRcbi8vIGFzIHRoZSBkcmFmdC1pZXRmLW1tdXNpYy1zY3RwLXNkcC0wNSBmb3JtYXQgKGluZGljYXRlZCBieSB0aGUgbS1saW5lXG4vLyBwcm90b2NvbCBvZiBEVExTL1NDVFAgLS0gd2l0aG91dCBVRFAvIG9yIFRDUC8pXG5TRFBVdGlscy53cml0ZVNjdHBEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKG1lZGlhLCBzY3RwKSB7XG4gIHZhciBvdXRwdXQgPSBbXTtcbiAgaWYgKG1lZGlhLnByb3RvY29sICE9PSAnRFRMUy9TQ1RQJykge1xuICAgIG91dHB1dCA9IFtcbiAgICAgICdtPScgKyBtZWRpYS5raW5kICsgJyA5ICcgKyBtZWRpYS5wcm90b2NvbCArICcgJyArIHNjdHAucHJvdG9jb2wgKyAnXFxyXFxuJyxcbiAgICAgICdjPUlOIElQNCAwLjAuMC4wXFxyXFxuJyxcbiAgICAgICdhPXNjdHAtcG9ydDonICsgc2N0cC5wb3J0ICsgJ1xcclxcbidcbiAgICBdO1xuICB9IGVsc2Uge1xuICAgIG91dHB1dCA9IFtcbiAgICAgICdtPScgKyBtZWRpYS5raW5kICsgJyA5ICcgKyBtZWRpYS5wcm90b2NvbCArICcgJyArIHNjdHAucG9ydCArICdcXHJcXG4nLFxuICAgICAgJ2M9SU4gSVA0IDAuMC4wLjBcXHJcXG4nLFxuICAgICAgJ2E9c2N0cG1hcDonICsgc2N0cC5wb3J0ICsgJyAnICsgc2N0cC5wcm90b2NvbCArICcgNjU1MzVcXHJcXG4nXG4gICAgXTtcbiAgfVxuICBpZiAoc2N0cC5tYXhNZXNzYWdlU2l6ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgb3V0cHV0LnB1c2goJ2E9bWF4LW1lc3NhZ2Utc2l6ZTonICsgc2N0cC5tYXhNZXNzYWdlU2l6ZSArICdcXHJcXG4nKTtcbiAgfVxuICByZXR1cm4gb3V0cHV0LmpvaW4oJycpO1xufTtcblxuLy8gR2VuZXJhdGUgYSBzZXNzaW9uIElEIGZvciBTRFAuXG4vLyBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvZHJhZnQtaWV0Zi1ydGN3ZWItanNlcC0yMCNzZWN0aW9uLTUuMi4xXG4vLyByZWNvbW1lbmRzIHVzaW5nIGEgY3J5cHRvZ3JhcGhpY2FsbHkgcmFuZG9tICt2ZSA2NC1iaXQgdmFsdWVcbi8vIGJ1dCByaWdodCBub3cgdGhpcyBzaG91bGQgYmUgYWNjZXB0YWJsZSBhbmQgd2l0aGluIHRoZSByaWdodCByYW5nZVxuU0RQVXRpbHMuZ2VuZXJhdGVTZXNzaW9uSWQgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKS5zdWJzdHIoMiwgMjEpO1xufTtcblxuLy8gV3JpdGUgYm9pbGRlciBwbGF0ZSBmb3Igc3RhcnQgb2YgU0RQXG4vLyBzZXNzSWQgYXJndW1lbnQgaXMgb3B0aW9uYWwgLSBpZiBub3Qgc3VwcGxpZWQgaXQgd2lsbFxuLy8gYmUgZ2VuZXJhdGVkIHJhbmRvbWx5XG4vLyBzZXNzVmVyc2lvbiBpcyBvcHRpb25hbCBhbmQgZGVmYXVsdHMgdG8gMlxuLy8gc2Vzc1VzZXIgaXMgb3B0aW9uYWwgYW5kIGRlZmF1bHRzIHRvICd0aGlzaXNhZGFwdGVyb3J0YydcblNEUFV0aWxzLndyaXRlU2Vzc2lvbkJvaWxlcnBsYXRlID0gZnVuY3Rpb24oc2Vzc0lkLCBzZXNzVmVyLCBzZXNzVXNlcikge1xuICB2YXIgc2Vzc2lvbklkO1xuICB2YXIgdmVyc2lvbiA9IHNlc3NWZXIgIT09IHVuZGVmaW5lZCA/IHNlc3NWZXIgOiAyO1xuICBpZiAoc2Vzc0lkKSB7XG4gICAgc2Vzc2lvbklkID0gc2Vzc0lkO1xuICB9IGVsc2Uge1xuICAgIHNlc3Npb25JZCA9IFNEUFV0aWxzLmdlbmVyYXRlU2Vzc2lvbklkKCk7XG4gIH1cbiAgdmFyIHVzZXIgPSBzZXNzVXNlciB8fCAndGhpc2lzYWRhcHRlcm9ydGMnO1xuICAvLyBGSVhNRTogc2Vzcy1pZCBzaG91bGQgYmUgYW4gTlRQIHRpbWVzdGFtcC5cbiAgcmV0dXJuICd2PTBcXHJcXG4nICtcbiAgICAgICdvPScgKyB1c2VyICsgJyAnICsgc2Vzc2lvbklkICsgJyAnICsgdmVyc2lvbiArXG4gICAgICAgICcgSU4gSVA0IDEyNy4wLjAuMVxcclxcbicgK1xuICAgICAgJ3M9LVxcclxcbicgK1xuICAgICAgJ3Q9MCAwXFxyXFxuJztcbn07XG5cblNEUFV0aWxzLndyaXRlTWVkaWFTZWN0aW9uID0gZnVuY3Rpb24odHJhbnNjZWl2ZXIsIGNhcHMsIHR5cGUsIHN0cmVhbSkge1xuICB2YXIgc2RwID0gU0RQVXRpbHMud3JpdGVSdHBEZXNjcmlwdGlvbih0cmFuc2NlaXZlci5raW5kLCBjYXBzKTtcblxuICAvLyBNYXAgSUNFIHBhcmFtZXRlcnMgKHVmcmFnLCBwd2QpIHRvIFNEUC5cbiAgc2RwICs9IFNEUFV0aWxzLndyaXRlSWNlUGFyYW1ldGVycyhcbiAgICB0cmFuc2NlaXZlci5pY2VHYXRoZXJlci5nZXRMb2NhbFBhcmFtZXRlcnMoKSk7XG5cbiAgLy8gTWFwIERUTFMgcGFyYW1ldGVycyB0byBTRFAuXG4gIHNkcCArPSBTRFBVdGlscy53cml0ZUR0bHNQYXJhbWV0ZXJzKFxuICAgIHRyYW5zY2VpdmVyLmR0bHNUcmFuc3BvcnQuZ2V0TG9jYWxQYXJhbWV0ZXJzKCksXG4gICAgdHlwZSA9PT0gJ29mZmVyJyA/ICdhY3RwYXNzJyA6ICdhY3RpdmUnKTtcblxuICBzZHAgKz0gJ2E9bWlkOicgKyB0cmFuc2NlaXZlci5taWQgKyAnXFxyXFxuJztcblxuICBpZiAodHJhbnNjZWl2ZXIuZGlyZWN0aW9uKSB7XG4gICAgc2RwICs9ICdhPScgKyB0cmFuc2NlaXZlci5kaXJlY3Rpb24gKyAnXFxyXFxuJztcbiAgfSBlbHNlIGlmICh0cmFuc2NlaXZlci5ydHBTZW5kZXIgJiYgdHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHtcbiAgICBzZHAgKz0gJ2E9c2VuZHJlY3ZcXHJcXG4nO1xuICB9IGVsc2UgaWYgKHRyYW5zY2VpdmVyLnJ0cFNlbmRlcikge1xuICAgIHNkcCArPSAnYT1zZW5kb25seVxcclxcbic7XG4gIH0gZWxzZSBpZiAodHJhbnNjZWl2ZXIucnRwUmVjZWl2ZXIpIHtcbiAgICBzZHAgKz0gJ2E9cmVjdm9ubHlcXHJcXG4nO1xuICB9IGVsc2Uge1xuICAgIHNkcCArPSAnYT1pbmFjdGl2ZVxcclxcbic7XG4gIH1cblxuICBpZiAodHJhbnNjZWl2ZXIucnRwU2VuZGVyKSB7XG4gICAgLy8gc3BlYy5cbiAgICB2YXIgbXNpZCA9ICdtc2lkOicgKyBzdHJlYW0uaWQgKyAnICcgK1xuICAgICAgICB0cmFuc2NlaXZlci5ydHBTZW5kZXIudHJhY2suaWQgKyAnXFxyXFxuJztcbiAgICBzZHAgKz0gJ2E9JyArIG1zaWQ7XG5cbiAgICAvLyBmb3IgQ2hyb21lLlxuICAgIHNkcCArPSAnYT1zc3JjOicgKyB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnNzcmMgK1xuICAgICAgICAnICcgKyBtc2lkO1xuICAgIGlmICh0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eCkge1xuICAgICAgc2RwICs9ICdhPXNzcmM6JyArIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0ucnR4LnNzcmMgK1xuICAgICAgICAgICcgJyArIG1zaWQ7XG4gICAgICBzZHAgKz0gJ2E9c3NyYy1ncm91cDpGSUQgJyArXG4gICAgICAgICAgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5zc3JjICsgJyAnICtcbiAgICAgICAgICB0cmFuc2NlaXZlci5zZW5kRW5jb2RpbmdQYXJhbWV0ZXJzWzBdLnJ0eC5zc3JjICtcbiAgICAgICAgICAnXFxyXFxuJztcbiAgICB9XG4gIH1cbiAgLy8gRklYTUU6IHRoaXMgc2hvdWxkIGJlIHdyaXR0ZW4gYnkgd3JpdGVSdHBEZXNjcmlwdGlvbi5cbiAgc2RwICs9ICdhPXNzcmM6JyArIHRyYW5zY2VpdmVyLnNlbmRFbmNvZGluZ1BhcmFtZXRlcnNbMF0uc3NyYyArXG4gICAgICAnIGNuYW1lOicgKyBTRFBVdGlscy5sb2NhbENOYW1lICsgJ1xcclxcbic7XG4gIGlmICh0cmFuc2NlaXZlci5ydHBTZW5kZXIgJiYgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHgpIHtcbiAgICBzZHAgKz0gJ2E9c3NyYzonICsgdHJhbnNjZWl2ZXIuc2VuZEVuY29kaW5nUGFyYW1ldGVyc1swXS5ydHguc3NyYyArXG4gICAgICAgICcgY25hbWU6JyArIFNEUFV0aWxzLmxvY2FsQ05hbWUgKyAnXFxyXFxuJztcbiAgfVxuICByZXR1cm4gc2RwO1xufTtcblxuLy8gR2V0cyB0aGUgZGlyZWN0aW9uIGZyb20gdGhlIG1lZGlhU2VjdGlvbiBvciB0aGUgc2Vzc2lvbnBhcnQuXG5TRFBVdGlscy5nZXREaXJlY3Rpb24gPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24sIHNlc3Npb25wYXJ0KSB7XG4gIC8vIExvb2sgZm9yIHNlbmRyZWN2LCBzZW5kb25seSwgcmVjdm9ubHksIGluYWN0aXZlLCBkZWZhdWx0IHRvIHNlbmRyZWN2LlxuICB2YXIgbGluZXMgPSBTRFBVdGlscy5zcGxpdExpbmVzKG1lZGlhU2VjdGlvbik7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICBzd2l0Y2ggKGxpbmVzW2ldKSB7XG4gICAgICBjYXNlICdhPXNlbmRyZWN2JzpcbiAgICAgIGNhc2UgJ2E9c2VuZG9ubHknOlxuICAgICAgY2FzZSAnYT1yZWN2b25seSc6XG4gICAgICBjYXNlICdhPWluYWN0aXZlJzpcbiAgICAgICAgcmV0dXJuIGxpbmVzW2ldLnN1YnN0cigyKTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIC8vIEZJWE1FOiBXaGF0IHNob3VsZCBoYXBwZW4gaGVyZT9cbiAgICB9XG4gIH1cbiAgaWYgKHNlc3Npb25wYXJ0KSB7XG4gICAgcmV0dXJuIFNEUFV0aWxzLmdldERpcmVjdGlvbihzZXNzaW9ucGFydCk7XG4gIH1cbiAgcmV0dXJuICdzZW5kcmVjdic7XG59O1xuXG5TRFBVdGlscy5nZXRLaW5kID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uKSB7XG4gIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTtcbiAgdmFyIG1saW5lID0gbGluZXNbMF0uc3BsaXQoJyAnKTtcbiAgcmV0dXJuIG1saW5lWzBdLnN1YnN0cigyKTtcbn07XG5cblNEUFV0aWxzLmlzUmVqZWN0ZWQgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHtcbiAgcmV0dXJuIG1lZGlhU2VjdGlvbi5zcGxpdCgnICcsIDIpWzFdID09PSAnMCc7XG59O1xuXG5TRFBVdGlscy5wYXJzZU1MaW5lID0gZnVuY3Rpb24obWVkaWFTZWN0aW9uKSB7XG4gIHZhciBsaW5lcyA9IFNEUFV0aWxzLnNwbGl0TGluZXMobWVkaWFTZWN0aW9uKTtcbiAgdmFyIHBhcnRzID0gbGluZXNbMF0uc3Vic3RyKDIpLnNwbGl0KCcgJyk7XG4gIHJldHVybiB7XG4gICAga2luZDogcGFydHNbMF0sXG4gICAgcG9ydDogcGFyc2VJbnQocGFydHNbMV0sIDEwKSxcbiAgICBwcm90b2NvbDogcGFydHNbMl0sXG4gICAgZm10OiBwYXJ0cy5zbGljZSgzKS5qb2luKCcgJylcbiAgfTtcbn07XG5cblNEUFV0aWxzLnBhcnNlT0xpbmUgPSBmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHtcbiAgdmFyIGxpbmUgPSBTRFBVdGlscy5tYXRjaFByZWZpeChtZWRpYVNlY3Rpb24sICdvPScpWzBdO1xuICB2YXIgcGFydHMgPSBsaW5lLnN1YnN0cigyKS5zcGxpdCgnICcpO1xuICByZXR1cm4ge1xuICAgIHVzZXJuYW1lOiBwYXJ0c1swXSxcbiAgICBzZXNzaW9uSWQ6IHBhcnRzWzFdLFxuICAgIHNlc3Npb25WZXJzaW9uOiBwYXJzZUludChwYXJ0c1syXSwgMTApLFxuICAgIG5ldFR5cGU6IHBhcnRzWzNdLFxuICAgIGFkZHJlc3NUeXBlOiBwYXJ0c1s0XSxcbiAgICBhZGRyZXNzOiBwYXJ0c1s1XVxuICB9O1xufTtcblxuLy8gYSB2ZXJ5IG5haXZlIGludGVycHJldGF0aW9uIG9mIGEgdmFsaWQgU0RQLlxuU0RQVXRpbHMuaXNWYWxpZFNEUCA9IGZ1bmN0aW9uKGJsb2IpIHtcbiAgaWYgKHR5cGVvZiBibG9iICE9PSAnc3RyaW5nJyB8fCBibG9iLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICB2YXIgbGluZXMgPSBTRFBVdGlscy5zcGxpdExpbmVzKGJsb2IpO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGxpbmVzW2ldLmxlbmd0aCA8IDIgfHwgbGluZXNbaV0uY2hhckF0KDEpICE9PSAnPScpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gVE9ETzogY2hlY2sgdGhlIG1vZGlmaWVyIGEgYml0IG1vcmUuXG4gIH1cbiAgcmV0dXJuIHRydWU7XG59O1xuXG4vLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuXG5pZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSBTRFBVdGlscztcbn1cbiIsIi8qKlxuICogQ29udmVydCBhcnJheSBvZiAxNiBieXRlIHZhbHVlcyB0byBVVUlEIHN0cmluZyBmb3JtYXQgb2YgdGhlIGZvcm06XG4gKiBYWFhYWFhYWC1YWFhYLVhYWFgtWFhYWC1YWFhYWFhYWFhYWFhcbiAqL1xudmFyIGJ5dGVUb0hleCA9IFtdO1xuZm9yICh2YXIgaSA9IDA7IGkgPCAyNTY7ICsraSkge1xuICBieXRlVG9IZXhbaV0gPSAoaSArIDB4MTAwKS50b1N0cmluZygxNikuc3Vic3RyKDEpO1xufVxuXG5mdW5jdGlvbiBieXRlc1RvVXVpZChidWYsIG9mZnNldCkge1xuICB2YXIgaSA9IG9mZnNldCB8fCAwO1xuICB2YXIgYnRoID0gYnl0ZVRvSGV4O1xuICAvLyBqb2luIHVzZWQgdG8gZml4IG1lbW9yeSBpc3N1ZSBjYXVzZWQgYnkgY29uY2F0ZW5hdGlvbjogaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9MzE3NSNjNFxuICByZXR1cm4gKFtcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLFxuICAgIGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sICctJyxcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLCAnLScsXG4gICAgYnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXSwgJy0nLFxuICAgIGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sICctJyxcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLFxuICAgIGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sXG4gICAgYnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXVxuICBdKS5qb2luKCcnKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBieXRlc1RvVXVpZDtcbiIsIi8vIFVuaXF1ZSBJRCBjcmVhdGlvbiByZXF1aXJlcyBhIGhpZ2ggcXVhbGl0eSByYW5kb20gIyBnZW5lcmF0b3IuICBJbiB0aGVcbi8vIGJyb3dzZXIgdGhpcyBpcyBhIGxpdHRsZSBjb21wbGljYXRlZCBkdWUgdG8gdW5rbm93biBxdWFsaXR5IG9mIE1hdGgucmFuZG9tKClcbi8vIGFuZCBpbmNvbnNpc3RlbnQgc3VwcG9ydCBmb3IgdGhlIGBjcnlwdG9gIEFQSS4gIFdlIGRvIHRoZSBiZXN0IHdlIGNhbiB2aWFcbi8vIGZlYXR1cmUtZGV0ZWN0aW9uXG5cbi8vIGdldFJhbmRvbVZhbHVlcyBuZWVkcyB0byBiZSBpbnZva2VkIGluIGEgY29udGV4dCB3aGVyZSBcInRoaXNcIiBpcyBhIENyeXB0b1xuLy8gaW1wbGVtZW50YXRpb24uIEFsc28sIGZpbmQgdGhlIGNvbXBsZXRlIGltcGxlbWVudGF0aW9uIG9mIGNyeXB0byBvbiBJRTExLlxudmFyIGdldFJhbmRvbVZhbHVlcyA9ICh0eXBlb2YoY3J5cHRvKSAhPSAndW5kZWZpbmVkJyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMuYmluZChjcnlwdG8pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICh0eXBlb2YobXNDcnlwdG8pICE9ICd1bmRlZmluZWQnICYmIHR5cGVvZiB3aW5kb3cubXNDcnlwdG8uZ2V0UmFuZG9tVmFsdWVzID09ICdmdW5jdGlvbicgJiYgbXNDcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQobXNDcnlwdG8pKTtcblxuaWYgKGdldFJhbmRvbVZhbHVlcykge1xuICAvLyBXSEFUV0cgY3J5cHRvIFJORyAtIGh0dHA6Ly93aWtpLndoYXR3Zy5vcmcvd2lraS9DcnlwdG9cbiAgdmFyIHJuZHM4ID0gbmV3IFVpbnQ4QXJyYXkoMTYpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmXG5cbiAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiB3aGF0d2dSTkcoKSB7XG4gICAgZ2V0UmFuZG9tVmFsdWVzKHJuZHM4KTtcbiAgICByZXR1cm4gcm5kczg7XG4gIH07XG59IGVsc2Uge1xuICAvLyBNYXRoLnJhbmRvbSgpLWJhc2VkIChSTkcpXG4gIC8vXG4gIC8vIElmIGFsbCBlbHNlIGZhaWxzLCB1c2UgTWF0aC5yYW5kb20oKS4gIEl0J3MgZmFzdCwgYnV0IGlzIG9mIHVuc3BlY2lmaWVkXG4gIC8vIHF1YWxpdHkuXG4gIHZhciBybmRzID0gbmV3IEFycmF5KDE2KTtcblxuICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIG1hdGhSTkcoKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIHI7IGkgPCAxNjsgaSsrKSB7XG4gICAgICBpZiAoKGkgJiAweDAzKSA9PT0gMCkgciA9IE1hdGgucmFuZG9tKCkgKiAweDEwMDAwMDAwMDtcbiAgICAgIHJuZHNbaV0gPSByID4+PiAoKGkgJiAweDAzKSA8PCAzKSAmIDB4ZmY7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJuZHM7XG4gIH07XG59XG4iLCJ2YXIgcm5nID0gcmVxdWlyZSgnLi9saWIvcm5nJyk7XG52YXIgYnl0ZXNUb1V1aWQgPSByZXF1aXJlKCcuL2xpYi9ieXRlc1RvVXVpZCcpO1xuXG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICB2YXIgaSA9IGJ1ZiAmJiBvZmZzZXQgfHwgMDtcblxuICBpZiAodHlwZW9mKG9wdGlvbnMpID09ICdzdHJpbmcnKSB7XG4gICAgYnVmID0gb3B0aW9ucyA9PT0gJ2JpbmFyeScgPyBuZXcgQXJyYXkoMTYpIDogbnVsbDtcbiAgICBvcHRpb25zID0gbnVsbDtcbiAgfVxuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICB2YXIgcm5kcyA9IG9wdGlvbnMucmFuZG9tIHx8IChvcHRpb25zLnJuZyB8fCBybmcpKCk7XG5cbiAgLy8gUGVyIDQuNCwgc2V0IGJpdHMgZm9yIHZlcnNpb24gYW5kIGBjbG9ja19zZXFfaGlfYW5kX3Jlc2VydmVkYFxuICBybmRzWzZdID0gKHJuZHNbNl0gJiAweDBmKSB8IDB4NDA7XG4gIHJuZHNbOF0gPSAocm5kc1s4XSAmIDB4M2YpIHwgMHg4MDtcblxuICAvLyBDb3B5IGJ5dGVzIHRvIGJ1ZmZlciwgaWYgcHJvdmlkZWRcbiAgaWYgKGJ1Zikge1xuICAgIGZvciAodmFyIGlpID0gMDsgaWkgPCAxNjsgKytpaSkge1xuICAgICAgYnVmW2kgKyBpaV0gPSBybmRzW2lpXTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gYnVmIHx8IGJ5dGVzVG9VdWlkKHJuZHMpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHY0O1xuIiwiLypcbiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlIGxpY2Vuc2VcbiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2VcbiAqICB0cmVlLlxuICovXG4gLyogZXNsaW50LWVudiBub2RlICovXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIGFkYXB0ZXJGYWN0b3J5ID0gcmVxdWlyZSgnLi9hZGFwdGVyX2ZhY3RvcnkuanMnKTtcbm1vZHVsZS5leHBvcnRzID0gYWRhcHRlckZhY3Rvcnkoe3dpbmRvdzogZ2xvYmFsLndpbmRvd30pO1xuIiwiLypcbiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlIGxpY2Vuc2VcbiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2VcbiAqICB0cmVlLlxuICovXG4gLyogZXNsaW50LWVudiBub2RlICovXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi91dGlscycpO1xuLy8gU2hpbW1pbmcgc3RhcnRzIGhlcmUuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGRlcGVuZGVuY2llcywgb3B0cykge1xuICB2YXIgd2luZG93ID0gZGVwZW5kZW5jaWVzICYmIGRlcGVuZGVuY2llcy53aW5kb3c7XG5cbiAgdmFyIG9wdGlvbnMgPSB7XG4gICAgc2hpbUNocm9tZTogdHJ1ZSxcbiAgICBzaGltRmlyZWZveDogdHJ1ZSxcbiAgICBzaGltRWRnZTogdHJ1ZSxcbiAgICBzaGltU2FmYXJpOiB0cnVlLFxuICB9O1xuXG4gIGZvciAodmFyIGtleSBpbiBvcHRzKSB7XG4gICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwob3B0cywga2V5KSkge1xuICAgICAgb3B0aW9uc1trZXldID0gb3B0c1trZXldO1xuICAgIH1cbiAgfVxuXG4gIC8vIFV0aWxzLlxuICB2YXIgbG9nZ2luZyA9IHV0aWxzLmxvZztcbiAgdmFyIGJyb3dzZXJEZXRhaWxzID0gdXRpbHMuZGV0ZWN0QnJvd3Nlcih3aW5kb3cpO1xuXG4gIC8vIFVuY29tbWVudCB0aGUgbGluZSBiZWxvdyBpZiB5b3Ugd2FudCBsb2dnaW5nIHRvIG9jY3VyLCBpbmNsdWRpbmcgbG9nZ2luZ1xuICAvLyBmb3IgdGhlIHN3aXRjaCBzdGF0ZW1lbnQgYmVsb3cuIENhbiBhbHNvIGJlIHR1cm5lZCBvbiBpbiB0aGUgYnJvd3NlciB2aWFcbiAgLy8gYWRhcHRlci5kaXNhYmxlTG9nKGZhbHNlKSwgYnV0IHRoZW4gbG9nZ2luZyBmcm9tIHRoZSBzd2l0Y2ggc3RhdGVtZW50IGJlbG93XG4gIC8vIHdpbGwgbm90IGFwcGVhci5cbiAgLy8gcmVxdWlyZSgnLi91dGlscycpLmRpc2FibGVMb2coZmFsc2UpO1xuXG4gIC8vIEJyb3dzZXIgc2hpbXMuXG4gIHZhciBjaHJvbWVTaGltID0gcmVxdWlyZSgnLi9jaHJvbWUvY2hyb21lX3NoaW0nKSB8fCBudWxsO1xuICB2YXIgZWRnZVNoaW0gPSByZXF1aXJlKCcuL2VkZ2UvZWRnZV9zaGltJykgfHwgbnVsbDtcbiAgdmFyIGZpcmVmb3hTaGltID0gcmVxdWlyZSgnLi9maXJlZm94L2ZpcmVmb3hfc2hpbScpIHx8IG51bGw7XG4gIHZhciBzYWZhcmlTaGltID0gcmVxdWlyZSgnLi9zYWZhcmkvc2FmYXJpX3NoaW0nKSB8fCBudWxsO1xuICB2YXIgY29tbW9uU2hpbSA9IHJlcXVpcmUoJy4vY29tbW9uX3NoaW0nKSB8fCBudWxsO1xuXG4gIC8vIEV4cG9ydCB0byB0aGUgYWRhcHRlciBnbG9iYWwgb2JqZWN0IHZpc2libGUgaW4gdGhlIGJyb3dzZXIuXG4gIHZhciBhZGFwdGVyID0ge1xuICAgIGJyb3dzZXJEZXRhaWxzOiBicm93c2VyRGV0YWlscyxcbiAgICBjb21tb25TaGltOiBjb21tb25TaGltLFxuICAgIGV4dHJhY3RWZXJzaW9uOiB1dGlscy5leHRyYWN0VmVyc2lvbixcbiAgICBkaXNhYmxlTG9nOiB1dGlscy5kaXNhYmxlTG9nLFxuICAgIGRpc2FibGVXYXJuaW5nczogdXRpbHMuZGlzYWJsZVdhcm5pbmdzXG4gIH07XG5cbiAgLy8gU2hpbSBicm93c2VyIGlmIGZvdW5kLlxuICBzd2l0Y2ggKGJyb3dzZXJEZXRhaWxzLmJyb3dzZXIpIHtcbiAgICBjYXNlICdjaHJvbWUnOlxuICAgICAgaWYgKCFjaHJvbWVTaGltIHx8ICFjaHJvbWVTaGltLnNoaW1QZWVyQ29ubmVjdGlvbiB8fFxuICAgICAgICAgICFvcHRpb25zLnNoaW1DaHJvbWUpIHtcbiAgICAgICAgbG9nZ2luZygnQ2hyb21lIHNoaW0gaXMgbm90IGluY2x1ZGVkIGluIHRoaXMgYWRhcHRlciByZWxlYXNlLicpO1xuICAgICAgICByZXR1cm4gYWRhcHRlcjtcbiAgICAgIH1cbiAgICAgIGxvZ2dpbmcoJ2FkYXB0ZXIuanMgc2hpbW1pbmcgY2hyb21lLicpO1xuICAgICAgLy8gRXhwb3J0IHRvIHRoZSBhZGFwdGVyIGdsb2JhbCBvYmplY3QgdmlzaWJsZSBpbiB0aGUgYnJvd3Nlci5cbiAgICAgIGFkYXB0ZXIuYnJvd3NlclNoaW0gPSBjaHJvbWVTaGltO1xuICAgICAgY29tbW9uU2hpbS5zaGltQ3JlYXRlT2JqZWN0VVJMKHdpbmRvdyk7XG5cbiAgICAgIGNocm9tZVNoaW0uc2hpbUdldFVzZXJNZWRpYSh3aW5kb3cpO1xuICAgICAgY2hyb21lU2hpbS5zaGltTWVkaWFTdHJlYW0od2luZG93KTtcbiAgICAgIGNocm9tZVNoaW0uc2hpbVNvdXJjZU9iamVjdCh3aW5kb3cpO1xuICAgICAgY2hyb21lU2hpbS5zaGltUGVlckNvbm5lY3Rpb24od2luZG93KTtcbiAgICAgIGNocm9tZVNoaW0uc2hpbU9uVHJhY2sod2luZG93KTtcbiAgICAgIGNocm9tZVNoaW0uc2hpbUFkZFRyYWNrUmVtb3ZlVHJhY2sod2luZG93KTtcbiAgICAgIGNocm9tZVNoaW0uc2hpbUdldFNlbmRlcnNXaXRoRHRtZih3aW5kb3cpO1xuICAgICAgY2hyb21lU2hpbS5zaGltU2VuZGVyUmVjZWl2ZXJHZXRTdGF0cyh3aW5kb3cpO1xuICAgICAgY2hyb21lU2hpbS5maXhOZWdvdGlhdGlvbk5lZWRlZCh3aW5kb3cpO1xuXG4gICAgICBjb21tb25TaGltLnNoaW1SVENJY2VDYW5kaWRhdGUod2luZG93KTtcbiAgICAgIGNvbW1vblNoaW0uc2hpbU1heE1lc3NhZ2VTaXplKHdpbmRvdyk7XG4gICAgICBjb21tb25TaGltLnNoaW1TZW5kVGhyb3dUeXBlRXJyb3Iod2luZG93KTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2ZpcmVmb3gnOlxuICAgICAgaWYgKCFmaXJlZm94U2hpbSB8fCAhZmlyZWZveFNoaW0uc2hpbVBlZXJDb25uZWN0aW9uIHx8XG4gICAgICAgICAgIW9wdGlvbnMuc2hpbUZpcmVmb3gpIHtcbiAgICAgICAgbG9nZ2luZygnRmlyZWZveCBzaGltIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGlzIGFkYXB0ZXIgcmVsZWFzZS4nKTtcbiAgICAgICAgcmV0dXJuIGFkYXB0ZXI7XG4gICAgICB9XG4gICAgICBsb2dnaW5nKCdhZGFwdGVyLmpzIHNoaW1taW5nIGZpcmVmb3guJyk7XG4gICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLlxuICAgICAgYWRhcHRlci5icm93c2VyU2hpbSA9IGZpcmVmb3hTaGltO1xuICAgICAgY29tbW9uU2hpbS5zaGltQ3JlYXRlT2JqZWN0VVJMKHdpbmRvdyk7XG5cbiAgICAgIGZpcmVmb3hTaGltLnNoaW1HZXRVc2VyTWVkaWEod2luZG93KTtcbiAgICAgIGZpcmVmb3hTaGltLnNoaW1Tb3VyY2VPYmplY3Qod2luZG93KTtcbiAgICAgIGZpcmVmb3hTaGltLnNoaW1QZWVyQ29ubmVjdGlvbih3aW5kb3cpO1xuICAgICAgZmlyZWZveFNoaW0uc2hpbU9uVHJhY2sod2luZG93KTtcbiAgICAgIGZpcmVmb3hTaGltLnNoaW1SZW1vdmVTdHJlYW0od2luZG93KTtcbiAgICAgIGZpcmVmb3hTaGltLnNoaW1TZW5kZXJHZXRTdGF0cyh3aW5kb3cpO1xuICAgICAgZmlyZWZveFNoaW0uc2hpbVJlY2VpdmVyR2V0U3RhdHMod2luZG93KTtcbiAgICAgIGZpcmVmb3hTaGltLnNoaW1SVENEYXRhQ2hhbm5lbCh3aW5kb3cpO1xuXG4gICAgICBjb21tb25TaGltLnNoaW1SVENJY2VDYW5kaWRhdGUod2luZG93KTtcbiAgICAgIGNvbW1vblNoaW0uc2hpbU1heE1lc3NhZ2VTaXplKHdpbmRvdyk7XG4gICAgICBjb21tb25TaGltLnNoaW1TZW5kVGhyb3dUeXBlRXJyb3Iod2luZG93KTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2VkZ2UnOlxuICAgICAgaWYgKCFlZGdlU2hpbSB8fCAhZWRnZVNoaW0uc2hpbVBlZXJDb25uZWN0aW9uIHx8ICFvcHRpb25zLnNoaW1FZGdlKSB7XG4gICAgICAgIGxvZ2dpbmcoJ01TIGVkZ2Ugc2hpbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhpcyBhZGFwdGVyIHJlbGVhc2UuJyk7XG4gICAgICAgIHJldHVybiBhZGFwdGVyO1xuICAgICAgfVxuICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBlZGdlLicpO1xuICAgICAgLy8gRXhwb3J0IHRvIHRoZSBhZGFwdGVyIGdsb2JhbCBvYmplY3QgdmlzaWJsZSBpbiB0aGUgYnJvd3Nlci5cbiAgICAgIGFkYXB0ZXIuYnJvd3NlclNoaW0gPSBlZGdlU2hpbTtcbiAgICAgIGNvbW1vblNoaW0uc2hpbUNyZWF0ZU9iamVjdFVSTCh3aW5kb3cpO1xuXG4gICAgICBlZGdlU2hpbS5zaGltR2V0VXNlck1lZGlhKHdpbmRvdyk7XG4gICAgICBlZGdlU2hpbS5zaGltUGVlckNvbm5lY3Rpb24od2luZG93KTtcbiAgICAgIGVkZ2VTaGltLnNoaW1SZXBsYWNlVHJhY2sod2luZG93KTtcbiAgICAgIGVkZ2VTaGltLnNoaW1HZXREaXNwbGF5TWVkaWEod2luZG93KTtcblxuICAgICAgLy8gdGhlIGVkZ2Ugc2hpbSBpbXBsZW1lbnRzIHRoZSBmdWxsIFJUQ0ljZUNhbmRpZGF0ZSBvYmplY3QuXG5cbiAgICAgIGNvbW1vblNoaW0uc2hpbU1heE1lc3NhZ2VTaXplKHdpbmRvdyk7XG4gICAgICBjb21tb25TaGltLnNoaW1TZW5kVGhyb3dUeXBlRXJyb3Iod2luZG93KTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3NhZmFyaSc6XG4gICAgICBpZiAoIXNhZmFyaVNoaW0gfHwgIW9wdGlvbnMuc2hpbVNhZmFyaSkge1xuICAgICAgICBsb2dnaW5nKCdTYWZhcmkgc2hpbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhpcyBhZGFwdGVyIHJlbGVhc2UuJyk7XG4gICAgICAgIHJldHVybiBhZGFwdGVyO1xuICAgICAgfVxuICAgICAgbG9nZ2luZygnYWRhcHRlci5qcyBzaGltbWluZyBzYWZhcmkuJyk7XG4gICAgICAvLyBFeHBvcnQgdG8gdGhlIGFkYXB0ZXIgZ2xvYmFsIG9iamVjdCB2aXNpYmxlIGluIHRoZSBicm93c2VyLlxuICAgICAgYWRhcHRlci5icm93c2VyU2hpbSA9IHNhZmFyaVNoaW07XG4gICAgICBjb21tb25TaGltLnNoaW1DcmVhdGVPYmplY3RVUkwod2luZG93KTtcblxuICAgICAgc2FmYXJpU2hpbS5zaGltUlRDSWNlU2VydmVyVXJscyh3aW5kb3cpO1xuICAgICAgc2FmYXJpU2hpbS5zaGltQ3JlYXRlT2ZmZXJMZWdhY3kod2luZG93KTtcbiAgICAgIHNhZmFyaVNoaW0uc2hpbUNhbGxiYWNrc0FQSSh3aW5kb3cpO1xuICAgICAgc2FmYXJpU2hpbS5zaGltTG9jYWxTdHJlYW1zQVBJKHdpbmRvdyk7XG4gICAgICBzYWZhcmlTaGltLnNoaW1SZW1vdGVTdHJlYW1zQVBJKHdpbmRvdyk7XG4gICAgICBzYWZhcmlTaGltLnNoaW1UcmFja0V2ZW50VHJhbnNjZWl2ZXIod2luZG93KTtcbiAgICAgIHNhZmFyaVNoaW0uc2hpbUdldFVzZXJNZWRpYSh3aW5kb3cpO1xuXG4gICAgICBjb21tb25TaGltLnNoaW1SVENJY2VDYW5kaWRhdGUod2luZG93KTtcbiAgICAgIGNvbW1vblNoaW0uc2hpbU1heE1lc3NhZ2VTaXplKHdpbmRvdyk7XG4gICAgICBjb21tb25TaGltLnNoaW1TZW5kVGhyb3dUeXBlRXJyb3Iod2luZG93KTtcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICBsb2dnaW5nKCdVbnN1cHBvcnRlZCBicm93c2VyIScpO1xuICAgICAgYnJlYWs7XG4gIH1cblxuICByZXR1cm4gYWRhcHRlcjtcbn07XG4iLCJcbi8qXG4gKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlXG4gKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlXG4gKiAgdHJlZS5cbiAqL1xuIC8qIGVzbGludC1lbnYgbm9kZSAqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKTtcbnZhciBsb2dnaW5nID0gdXRpbHMubG9nO1xuXG4vKiBpdGVyYXRlcyB0aGUgc3RhdHMgZ3JhcGggcmVjdXJzaXZlbHkuICovXG5mdW5jdGlvbiB3YWxrU3RhdHMoc3RhdHMsIGJhc2UsIHJlc3VsdFNldCkge1xuICBpZiAoIWJhc2UgfHwgcmVzdWx0U2V0LmhhcyhiYXNlLmlkKSkge1xuICAgIHJldHVybjtcbiAgfVxuICByZXN1bHRTZXQuc2V0KGJhc2UuaWQsIGJhc2UpO1xuICBPYmplY3Qua2V5cyhiYXNlKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBpZiAobmFtZS5lbmRzV2l0aCgnSWQnKSkge1xuICAgICAgd2Fsa1N0YXRzKHN0YXRzLCBzdGF0cy5nZXQoYmFzZVtuYW1lXSksIHJlc3VsdFNldCk7XG4gICAgfSBlbHNlIGlmIChuYW1lLmVuZHNXaXRoKCdJZHMnKSkge1xuICAgICAgYmFzZVtuYW1lXS5mb3JFYWNoKGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgIHdhbGtTdGF0cyhzdGF0cywgc3RhdHMuZ2V0KGlkKSwgcmVzdWx0U2V0KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59XG5cbi8qIGZpbHRlciBnZXRTdGF0cyBmb3IgYSBzZW5kZXIvcmVjZWl2ZXIgdHJhY2suICovXG5mdW5jdGlvbiBmaWx0ZXJTdGF0cyhyZXN1bHQsIHRyYWNrLCBvdXRib3VuZCkge1xuICB2YXIgc3RyZWFtU3RhdHNUeXBlID0gb3V0Ym91bmQgPyAnb3V0Ym91bmQtcnRwJyA6ICdpbmJvdW5kLXJ0cCc7XG4gIHZhciBmaWx0ZXJlZFJlc3VsdCA9IG5ldyBNYXAoKTtcbiAgaWYgKHRyYWNrID09PSBudWxsKSB7XG4gICAgcmV0dXJuIGZpbHRlcmVkUmVzdWx0O1xuICB9XG4gIHZhciB0cmFja1N0YXRzID0gW107XG4gIHJlc3VsdC5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlLnR5cGUgPT09ICd0cmFjaycgJiZcbiAgICAgICAgdmFsdWUudHJhY2tJZGVudGlmaWVyID09PSB0cmFjay5pZCkge1xuICAgICAgdHJhY2tTdGF0cy5wdXNoKHZhbHVlKTtcbiAgICB9XG4gIH0pO1xuICB0cmFja1N0YXRzLmZvckVhY2goZnVuY3Rpb24odHJhY2tTdGF0KSB7XG4gICAgcmVzdWx0LmZvckVhY2goZnVuY3Rpb24oc3RhdHMpIHtcbiAgICAgIGlmIChzdGF0cy50eXBlID09PSBzdHJlYW1TdGF0c1R5cGUgJiYgc3RhdHMudHJhY2tJZCA9PT0gdHJhY2tTdGF0LmlkKSB7XG4gICAgICAgIHdhbGtTdGF0cyhyZXN1bHQsIHN0YXRzLCBmaWx0ZXJlZFJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuICByZXR1cm4gZmlsdGVyZWRSZXN1bHQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBzaGltR2V0VXNlck1lZGlhOiByZXF1aXJlKCcuL2dldHVzZXJtZWRpYScpLFxuICBzaGltTWVkaWFTdHJlYW06IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIHdpbmRvdy5NZWRpYVN0cmVhbSA9IHdpbmRvdy5NZWRpYVN0cmVhbSB8fCB3aW5kb3cud2Via2l0TWVkaWFTdHJlYW07XG4gIH0sXG5cbiAgc2hpbU9uVHJhY2s6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JyAmJiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gJiYgISgnb250cmFjaycgaW5cbiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLCAnb250cmFjaycsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fb250cmFjaztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbihmKSB7XG4gICAgICAgICAgaWYgKHRoaXMuX29udHJhY2spIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCd0cmFjaycsIHRoaXMuX29udHJhY2sgPSBmKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIHZhciBvcmlnU2V0UmVtb3RlRGVzY3JpcHRpb24gPVxuICAgICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuc2V0UmVtb3RlRGVzY3JpcHRpb247XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldFJlbW90ZURlc2NyaXB0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgIGlmICghcGMuX29udHJhY2twb2x5KSB7XG4gICAgICAgICAgcGMuX29udHJhY2twb2x5ID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgLy8gb25hZGRzdHJlYW0gZG9lcyBub3QgZmlyZSB3aGVuIGEgdHJhY2sgaXMgYWRkZWQgdG8gYW4gZXhpc3RpbmdcbiAgICAgICAgICAgIC8vIHN0cmVhbS4gQnV0IHN0cmVhbS5vbmFkZHRyYWNrIGlzIGltcGxlbWVudGVkIHNvIHdlIHVzZSB0aGF0LlxuICAgICAgICAgICAgZS5zdHJlYW0uYWRkRXZlbnRMaXN0ZW5lcignYWRkdHJhY2snLCBmdW5jdGlvbih0ZSkge1xuICAgICAgICAgICAgICB2YXIgcmVjZWl2ZXI7XG4gICAgICAgICAgICAgIGlmICh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFJlY2VpdmVycykge1xuICAgICAgICAgICAgICAgIHJlY2VpdmVyID0gcGMuZ2V0UmVjZWl2ZXJzKCkuZmluZChmdW5jdGlvbihyKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gci50cmFjayAmJiByLnRyYWNrLmlkID09PSB0ZS50cmFjay5pZDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWNlaXZlciA9IHt0cmFjazogdGUudHJhY2t9O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IEV2ZW50KCd0cmFjaycpO1xuICAgICAgICAgICAgICBldmVudC50cmFjayA9IHRlLnRyYWNrO1xuICAgICAgICAgICAgICBldmVudC5yZWNlaXZlciA9IHJlY2VpdmVyO1xuICAgICAgICAgICAgICBldmVudC50cmFuc2NlaXZlciA9IHtyZWNlaXZlcjogcmVjZWl2ZXJ9O1xuICAgICAgICAgICAgICBldmVudC5zdHJlYW1zID0gW2Uuc3RyZWFtXTtcbiAgICAgICAgICAgICAgcGMuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGUuc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHtcbiAgICAgICAgICAgICAgdmFyIHJlY2VpdmVyO1xuICAgICAgICAgICAgICBpZiAod2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRSZWNlaXZlcnMpIHtcbiAgICAgICAgICAgICAgICByZWNlaXZlciA9IHBjLmdldFJlY2VpdmVycygpLmZpbmQoZnVuY3Rpb24ocikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHIudHJhY2sgJiYgci50cmFjay5pZCA9PT0gdHJhY2suaWQ7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVjZWl2ZXIgPSB7dHJhY2s6IHRyYWNrfTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgZXZlbnQgPSBuZXcgRXZlbnQoJ3RyYWNrJyk7XG4gICAgICAgICAgICAgIGV2ZW50LnRyYWNrID0gdHJhY2s7XG4gICAgICAgICAgICAgIGV2ZW50LnJlY2VpdmVyID0gcmVjZWl2ZXI7XG4gICAgICAgICAgICAgIGV2ZW50LnRyYW5zY2VpdmVyID0ge3JlY2VpdmVyOiByZWNlaXZlcn07XG4gICAgICAgICAgICAgIGV2ZW50LnN0cmVhbXMgPSBbZS5zdHJlYW1dO1xuICAgICAgICAgICAgICBwYy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH07XG4gICAgICAgICAgcGMuYWRkRXZlbnRMaXN0ZW5lcignYWRkc3RyZWFtJywgcGMuX29udHJhY2twb2x5KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3JpZ1NldFJlbW90ZURlc2NyaXB0aW9uLmFwcGx5KHBjLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gZXZlbiBpZiBSVENSdHBUcmFuc2NlaXZlciBpcyBpbiB3aW5kb3csIGl0IGlzIG9ubHkgdXNlZCBhbmRcbiAgICAgIC8vIGVtaXR0ZWQgaW4gdW5pZmllZC1wbGFuLiBVbmZvcnR1bmF0ZWx5IHRoaXMgbWVhbnMgd2UgbmVlZFxuICAgICAgLy8gdG8gdW5jb25kaXRpb25hbGx5IHdyYXAgdGhlIGV2ZW50LlxuICAgICAgdXRpbHMud3JhcFBlZXJDb25uZWN0aW9uRXZlbnQod2luZG93LCAndHJhY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGlmICghZS50cmFuc2NlaXZlcikge1xuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCAndHJhbnNjZWl2ZXInLFxuICAgICAgICAgICAge3ZhbHVlOiB7cmVjZWl2ZXI6IGUucmVjZWl2ZXJ9fSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGU7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgc2hpbUdldFNlbmRlcnNXaXRoRHRtZjogZnVuY3Rpb24od2luZG93KSB7XG4gICAgLy8gT3ZlcnJpZGVzIGFkZFRyYWNrL3JlbW92ZVRyYWNrLCBkZXBlbmRzIG9uIHNoaW1BZGRUcmFja1JlbW92ZVRyYWNrLlxuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JyAmJiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gJiZcbiAgICAgICAgISgnZ2V0U2VuZGVycycgaW4gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkgJiZcbiAgICAgICAgJ2NyZWF0ZURUTUZTZW5kZXInIGluIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpIHtcbiAgICAgIHZhciBzaGltU2VuZGVyV2l0aER0bWYgPSBmdW5jdGlvbihwYywgdHJhY2spIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0cmFjazogdHJhY2ssXG4gICAgICAgICAgZ2V0IGR0bWYoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fZHRtZiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIGlmICh0cmFjay5raW5kID09PSAnYXVkaW8nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZHRtZiA9IHBjLmNyZWF0ZURUTUZTZW5kZXIodHJhY2spO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2R0bWYgPSBudWxsO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZHRtZjtcbiAgICAgICAgICB9LFxuICAgICAgICAgIF9wYzogcGNcbiAgICAgICAgfTtcbiAgICAgIH07XG5cbiAgICAgIC8vIGF1Z21lbnQgYWRkVHJhY2sgd2hlbiBnZXRTZW5kZXJzIGlzIG5vdCBhdmFpbGFibGUuXG4gICAgICBpZiAoIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U2VuZGVycykge1xuICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFNlbmRlcnMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9zZW5kZXJzID0gdGhpcy5fc2VuZGVycyB8fCBbXTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fc2VuZGVycy5zbGljZSgpOyAvLyByZXR1cm4gYSBjb3B5IG9mIHRoZSBpbnRlcm5hbCBzdGF0ZS5cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG9yaWdBZGRUcmFjayA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkVHJhY2s7XG4gICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkVHJhY2sgPSBmdW5jdGlvbih0cmFjaywgc3RyZWFtKSB7XG4gICAgICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgICAgICB2YXIgc2VuZGVyID0gb3JpZ0FkZFRyYWNrLmFwcGx5KHBjLCBhcmd1bWVudHMpO1xuICAgICAgICAgIGlmICghc2VuZGVyKSB7XG4gICAgICAgICAgICBzZW5kZXIgPSBzaGltU2VuZGVyV2l0aER0bWYocGMsIHRyYWNrKTtcbiAgICAgICAgICAgIHBjLl9zZW5kZXJzLnB1c2goc2VuZGVyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHNlbmRlcjtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgb3JpZ1JlbW92ZVRyYWNrID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVUcmFjaztcbiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVUcmFjayA9IGZ1bmN0aW9uKHNlbmRlcikge1xuICAgICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgICAgb3JpZ1JlbW92ZVRyYWNrLmFwcGx5KHBjLCBhcmd1bWVudHMpO1xuICAgICAgICAgIHZhciBpZHggPSBwYy5fc2VuZGVycy5pbmRleE9mKHNlbmRlcik7XG4gICAgICAgICAgaWYgKGlkeCAhPT0gLTEpIHtcbiAgICAgICAgICAgIHBjLl9zZW5kZXJzLnNwbGljZShpZHgsIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHZhciBvcmlnQWRkU3RyZWFtID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5hZGRTdHJlYW07XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgICBwYy5fc2VuZGVycyA9IHBjLl9zZW5kZXJzIHx8IFtdO1xuICAgICAgICBvcmlnQWRkU3RyZWFtLmFwcGx5KHBjLCBbc3RyZWFtXSk7XG4gICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7XG4gICAgICAgICAgcGMuX3NlbmRlcnMucHVzaChzaGltU2VuZGVyV2l0aER0bWYocGMsIHRyYWNrKSk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgdmFyIG9yaWdSZW1vdmVTdHJlYW0gPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVN0cmVhbTtcbiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUucmVtb3ZlU3RyZWFtID0gZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgIHBjLl9zZW5kZXJzID0gcGMuX3NlbmRlcnMgfHwgW107XG4gICAgICAgIG9yaWdSZW1vdmVTdHJlYW0uYXBwbHkocGMsIFtzdHJlYW1dKTtcblxuICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykge1xuICAgICAgICAgIHZhciBzZW5kZXIgPSBwYy5fc2VuZGVycy5maW5kKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgIHJldHVybiBzLnRyYWNrID09PSB0cmFjaztcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoc2VuZGVyKSB7XG4gICAgICAgICAgICBwYy5fc2VuZGVycy5zcGxpY2UocGMuX3NlbmRlcnMuaW5kZXhPZihzZW5kZXIpLCAxKTsgLy8gcmVtb3ZlIHNlbmRlclxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmXG4gICAgICAgICAgICAgICAnZ2V0U2VuZGVycycgaW4gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSAmJlxuICAgICAgICAgICAgICAgJ2NyZWF0ZURUTUZTZW5kZXInIGluIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgJiZcbiAgICAgICAgICAgICAgIHdpbmRvdy5SVENSdHBTZW5kZXIgJiZcbiAgICAgICAgICAgICAgICEoJ2R0bWYnIGluIHdpbmRvdy5SVENSdHBTZW5kZXIucHJvdG90eXBlKSkge1xuICAgICAgdmFyIG9yaWdHZXRTZW5kZXJzID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTZW5kZXJzO1xuICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTZW5kZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgIHZhciBzZW5kZXJzID0gb3JpZ0dldFNlbmRlcnMuYXBwbHkocGMsIFtdKTtcbiAgICAgICAgc2VuZGVycy5mb3JFYWNoKGZ1bmN0aW9uKHNlbmRlcikge1xuICAgICAgICAgIHNlbmRlci5fcGMgPSBwYztcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzZW5kZXJzO1xuICAgICAgfTtcblxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENSdHBTZW5kZXIucHJvdG90eXBlLCAnZHRtZicsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAodGhpcy5fZHRtZiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAodGhpcy50cmFjay5raW5kID09PSAnYXVkaW8nKSB7XG4gICAgICAgICAgICAgIHRoaXMuX2R0bWYgPSB0aGlzLl9wYy5jcmVhdGVEVE1GU2VuZGVyKHRoaXMudHJhY2spO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5fZHRtZiA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aGlzLl9kdG1mO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgc2hpbVNlbmRlclJlY2VpdmVyR2V0U3RhdHM6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIGlmICghKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnICYmIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiAmJlxuICAgICAgICB3aW5kb3cuUlRDUnRwU2VuZGVyICYmIHdpbmRvdy5SVENSdHBSZWNlaXZlcikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBzaGltIHNlbmRlciBzdGF0cy5cbiAgICBpZiAoISgnZ2V0U3RhdHMnIGluIHdpbmRvdy5SVENSdHBTZW5kZXIucHJvdG90eXBlKSkge1xuICAgICAgdmFyIG9yaWdHZXRTZW5kZXJzID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTZW5kZXJzO1xuICAgICAgaWYgKG9yaWdHZXRTZW5kZXJzKSB7XG4gICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U2VuZGVycyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgICAgdmFyIHNlbmRlcnMgPSBvcmlnR2V0U2VuZGVycy5hcHBseShwYywgW10pO1xuICAgICAgICAgIHNlbmRlcnMuZm9yRWFjaChmdW5jdGlvbihzZW5kZXIpIHtcbiAgICAgICAgICAgIHNlbmRlci5fcGMgPSBwYztcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gc2VuZGVycztcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgdmFyIG9yaWdBZGRUcmFjayA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkVHJhY2s7XG4gICAgICBpZiAob3JpZ0FkZFRyYWNrKSB7XG4gICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkVHJhY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgc2VuZGVyID0gb3JpZ0FkZFRyYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgc2VuZGVyLl9wYyA9IHRoaXM7XG4gICAgICAgICAgcmV0dXJuIHNlbmRlcjtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHdpbmRvdy5SVENSdHBTZW5kZXIucHJvdG90eXBlLmdldFN0YXRzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZW5kZXIgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdGhpcy5fcGMuZ2V0U3RhdHMoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgIC8qIE5vdGU6IHRoaXMgd2lsbCBpbmNsdWRlIHN0YXRzIG9mIGFsbCBzZW5kZXJzIHRoYXRcbiAgICAgICAgICAgKiAgIHNlbmQgYSB0cmFjayB3aXRoIHRoZSBzYW1lIGlkIGFzIHNlbmRlci50cmFjayBhc1xuICAgICAgICAgICAqICAgaXQgaXMgbm90IHBvc3NpYmxlIHRvIGlkZW50aWZ5IHRoZSBSVENSdHBTZW5kZXIuXG4gICAgICAgICAgICovXG4gICAgICAgICAgcmV0dXJuIGZpbHRlclN0YXRzKHJlc3VsdCwgc2VuZGVyLnRyYWNrLCB0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIHNoaW0gcmVjZWl2ZXIgc3RhdHMuXG4gICAgaWYgKCEoJ2dldFN0YXRzJyBpbiB3aW5kb3cuUlRDUnRwUmVjZWl2ZXIucHJvdG90eXBlKSkge1xuICAgICAgdmFyIG9yaWdHZXRSZWNlaXZlcnMgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFJlY2VpdmVycztcbiAgICAgIGlmIChvcmlnR2V0UmVjZWl2ZXJzKSB7XG4gICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0UmVjZWl2ZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgICAgICB2YXIgcmVjZWl2ZXJzID0gb3JpZ0dldFJlY2VpdmVycy5hcHBseShwYywgW10pO1xuICAgICAgICAgIHJlY2VpdmVycy5mb3JFYWNoKGZ1bmN0aW9uKHJlY2VpdmVyKSB7XG4gICAgICAgICAgICByZWNlaXZlci5fcGMgPSBwYztcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gcmVjZWl2ZXJzO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgdXRpbHMud3JhcFBlZXJDb25uZWN0aW9uRXZlbnQod2luZG93LCAndHJhY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGUucmVjZWl2ZXIuX3BjID0gZS5zcmNFbGVtZW50O1xuICAgICAgICByZXR1cm4gZTtcbiAgICAgIH0pO1xuICAgICAgd2luZG93LlJUQ1J0cFJlY2VpdmVyLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcmVjZWl2ZXIgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdGhpcy5fcGMuZ2V0U3RhdHMoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgIHJldHVybiBmaWx0ZXJTdGF0cyhyZXN1bHQsIHJlY2VpdmVyLnRyYWNrLCBmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoISgnZ2V0U3RhdHMnIGluIHdpbmRvdy5SVENSdHBTZW5kZXIucHJvdG90eXBlICYmXG4gICAgICAgICdnZXRTdGF0cycgaW4gd2luZG93LlJUQ1J0cFJlY2VpdmVyLnByb3RvdHlwZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBzaGltIFJUQ1BlZXJDb25uZWN0aW9uLmdldFN0YXRzKHRyYWNrKS5cbiAgICB2YXIgb3JpZ0dldFN0YXRzID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cztcbiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFN0YXRzID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwICYmXG4gICAgICAgICAgYXJndW1lbnRzWzBdIGluc3RhbmNlb2Ygd2luZG93Lk1lZGlhU3RyZWFtVHJhY2spIHtcbiAgICAgICAgdmFyIHRyYWNrID0gYXJndW1lbnRzWzBdO1xuICAgICAgICB2YXIgc2VuZGVyO1xuICAgICAgICB2YXIgcmVjZWl2ZXI7XG4gICAgICAgIHZhciBlcnI7XG4gICAgICAgIHBjLmdldFNlbmRlcnMoKS5mb3JFYWNoKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICBpZiAocy50cmFjayA9PT0gdHJhY2spIHtcbiAgICAgICAgICAgIGlmIChzZW5kZXIpIHtcbiAgICAgICAgICAgICAgZXJyID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHNlbmRlciA9IHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcGMuZ2V0UmVjZWl2ZXJzKCkuZm9yRWFjaChmdW5jdGlvbihyKSB7XG4gICAgICAgICAgaWYgKHIudHJhY2sgPT09IHRyYWNrKSB7XG4gICAgICAgICAgICBpZiAocmVjZWl2ZXIpIHtcbiAgICAgICAgICAgICAgZXJyID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJlY2VpdmVyID0gcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHIudHJhY2sgPT09IHRyYWNrO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGVyciB8fCAoc2VuZGVyICYmIHJlY2VpdmVyKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRE9NRXhjZXB0aW9uKFxuICAgICAgICAgICAgJ1RoZXJlIGFyZSBtb3JlIHRoYW4gb25lIHNlbmRlciBvciByZWNlaXZlciBmb3IgdGhlIHRyYWNrLicsXG4gICAgICAgICAgICAnSW52YWxpZEFjY2Vzc0Vycm9yJykpO1xuICAgICAgICB9IGVsc2UgaWYgKHNlbmRlcikge1xuICAgICAgICAgIHJldHVybiBzZW5kZXIuZ2V0U3RhdHMoKTtcbiAgICAgICAgfSBlbHNlIGlmIChyZWNlaXZlcikge1xuICAgICAgICAgIHJldHVybiByZWNlaXZlci5nZXRTdGF0cygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRE9NRXhjZXB0aW9uKFxuICAgICAgICAgICdUaGVyZSBpcyBubyBzZW5kZXIgb3IgcmVjZWl2ZXIgZm9yIHRoZSB0cmFjay4nLFxuICAgICAgICAgICdJbnZhbGlkQWNjZXNzRXJyb3InKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gb3JpZ0dldFN0YXRzLmFwcGx5KHBjLCBhcmd1bWVudHMpO1xuICAgIH07XG4gIH0sXG5cbiAgc2hpbVNvdXJjZU9iamVjdDogZnVuY3Rpb24od2luZG93KSB7XG4gICAgdmFyIFVSTCA9IHdpbmRvdyAmJiB3aW5kb3cuVVJMO1xuXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSB7XG4gICAgICBpZiAod2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiZcbiAgICAgICAgISgnc3JjT2JqZWN0JyBpbiB3aW5kb3cuSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUpKSB7XG4gICAgICAgIC8vIFNoaW0gdGhlIHNyY09iamVjdCBwcm9wZXJ0eSwgb25jZSwgd2hlbiBIVE1MTWVkaWFFbGVtZW50IGlzIGZvdW5kLlxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLCAnc3JjT2JqZWN0Jywge1xuICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3JjT2JqZWN0O1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc2V0OiBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIC8vIFVzZSBfc3JjT2JqZWN0IGFzIGEgcHJpdmF0ZSBwcm9wZXJ0eSBmb3IgdGhpcyBzaGltXG4gICAgICAgICAgICB0aGlzLl9zcmNPYmplY3QgPSBzdHJlYW07XG4gICAgICAgICAgICBpZiAodGhpcy5zcmMpIHtcbiAgICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTCh0aGlzLnNyYyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghc3RyZWFtKSB7XG4gICAgICAgICAgICAgIHRoaXMuc3JjID0gJyc7XG4gICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTtcbiAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gcmVjcmVhdGUgdGhlIGJsb2IgdXJsIHdoZW4gYSB0cmFjayBpcyBhZGRlZCBvclxuICAgICAgICAgICAgLy8gcmVtb3ZlZC4gRG9pbmcgaXQgbWFudWFsbHkgc2luY2Ugd2Ugd2FudCB0byBhdm9pZCBhIHJlY3Vyc2lvbi5cbiAgICAgICAgICAgIHN0cmVhbS5hZGRFdmVudExpc3RlbmVyKCdhZGR0cmFjaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBpZiAoc2VsZi5zcmMpIHtcbiAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHNlbGYuc3JjKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBzZWxmLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc3RyZWFtLmFkZEV2ZW50TGlzdGVuZXIoJ3JlbW92ZXRyYWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGlmIChzZWxmLnNyYykge1xuICAgICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwoc2VsZi5zcmMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHNlbGYuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgc2hpbUFkZFRyYWNrUmVtb3ZlVHJhY2tXaXRoTmF0aXZlOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICAvLyBzaGltIGFkZFRyYWNrL3JlbW92ZVRyYWNrIHdpdGggbmF0aXZlIHZhcmlhbnRzIGluIG9yZGVyIHRvIG1ha2VcbiAgICAvLyB0aGUgaW50ZXJhY3Rpb25zIHdpdGggbGVnYWN5IGdldExvY2FsU3RyZWFtcyBiZWhhdmUgYXMgaW4gb3RoZXIgYnJvd3NlcnMuXG4gICAgLy8gS2VlcHMgYSBtYXBwaW5nIHN0cmVhbS5pZCA9PiBbc3RyZWFtLCBydHBzZW5kZXJzLi4uXVxuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0TG9jYWxTdHJlYW1zID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgdGhpcy5fc2hpbW1lZExvY2FsU3RyZWFtcyA9IHRoaXMuX3NoaW1tZWRMb2NhbFN0cmVhbXMgfHwge307XG4gICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5fc2hpbW1lZExvY2FsU3RyZWFtcykubWFwKGZ1bmN0aW9uKHN0cmVhbUlkKSB7XG4gICAgICAgIHJldHVybiBwYy5fc2hpbW1lZExvY2FsU3RyZWFtc1tzdHJlYW1JZF1bMF07XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdmFyIG9yaWdBZGRUcmFjayA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkVHJhY2s7XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5hZGRUcmFjayA9IGZ1bmN0aW9uKHRyYWNrLCBzdHJlYW0pIHtcbiAgICAgIGlmICghc3RyZWFtKSB7XG4gICAgICAgIHJldHVybiBvcmlnQWRkVHJhY2suYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3NoaW1tZWRMb2NhbFN0cmVhbXMgPSB0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zIHx8IHt9O1xuXG4gICAgICB2YXIgc2VuZGVyID0gb3JpZ0FkZFRyYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBpZiAoIXRoaXMuX3NoaW1tZWRMb2NhbFN0cmVhbXNbc3RyZWFtLmlkXSkge1xuICAgICAgICB0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zW3N0cmVhbS5pZF0gPSBbc3RyZWFtLCBzZW5kZXJdO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zW3N0cmVhbS5pZF0uaW5kZXhPZihzZW5kZXIpID09PSAtMSkge1xuICAgICAgICB0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zW3N0cmVhbS5pZF0ucHVzaChzZW5kZXIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNlbmRlcjtcbiAgICB9O1xuXG4gICAgdmFyIG9yaWdBZGRTdHJlYW0gPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFN0cmVhbTtcbiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgIHRoaXMuX3NoaW1tZWRMb2NhbFN0cmVhbXMgPSB0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zIHx8IHt9O1xuXG4gICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykge1xuICAgICAgICB2YXIgYWxyZWFkeUV4aXN0cyA9IHBjLmdldFNlbmRlcnMoKS5maW5kKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICByZXR1cm4gcy50cmFjayA9PT0gdHJhY2s7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoYWxyZWFkeUV4aXN0cykge1xuICAgICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oJ1RyYWNrIGFscmVhZHkgZXhpc3RzLicsXG4gICAgICAgICAgICAgICdJbnZhbGlkQWNjZXNzRXJyb3InKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICB2YXIgZXhpc3RpbmdTZW5kZXJzID0gcGMuZ2V0U2VuZGVycygpO1xuICAgICAgb3JpZ0FkZFN0cmVhbS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgdmFyIG5ld1NlbmRlcnMgPSBwYy5nZXRTZW5kZXJzKCkuZmlsdGVyKGZ1bmN0aW9uKG5ld1NlbmRlcikge1xuICAgICAgICByZXR1cm4gZXhpc3RpbmdTZW5kZXJzLmluZGV4T2YobmV3U2VuZGVyKSA9PT0gLTE7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuX3NoaW1tZWRMb2NhbFN0cmVhbXNbc3RyZWFtLmlkXSA9IFtzdHJlYW1dLmNvbmNhdChuZXdTZW5kZXJzKTtcbiAgICB9O1xuXG4gICAgdmFyIG9yaWdSZW1vdmVTdHJlYW0gPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVN0cmVhbTtcbiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgdGhpcy5fc2hpbW1lZExvY2FsU3RyZWFtcyA9IHRoaXMuX3NoaW1tZWRMb2NhbFN0cmVhbXMgfHwge307XG4gICAgICBkZWxldGUgdGhpcy5fc2hpbW1lZExvY2FsU3RyZWFtc1tzdHJlYW0uaWRdO1xuICAgICAgcmV0dXJuIG9yaWdSZW1vdmVTdHJlYW0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuXG4gICAgdmFyIG9yaWdSZW1vdmVUcmFjayA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUucmVtb3ZlVHJhY2s7XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVUcmFjayA9IGZ1bmN0aW9uKHNlbmRlcikge1xuICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgIHRoaXMuX3NoaW1tZWRMb2NhbFN0cmVhbXMgPSB0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zIHx8IHt9O1xuICAgICAgaWYgKHNlbmRlcikge1xuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLl9zaGltbWVkTG9jYWxTdHJlYW1zKS5mb3JFYWNoKGZ1bmN0aW9uKHN0cmVhbUlkKSB7XG4gICAgICAgICAgdmFyIGlkeCA9IHBjLl9zaGltbWVkTG9jYWxTdHJlYW1zW3N0cmVhbUlkXS5pbmRleE9mKHNlbmRlcik7XG4gICAgICAgICAgaWYgKGlkeCAhPT0gLTEpIHtcbiAgICAgICAgICAgIHBjLl9zaGltbWVkTG9jYWxTdHJlYW1zW3N0cmVhbUlkXS5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHBjLl9zaGltbWVkTG9jYWxTdHJlYW1zW3N0cmVhbUlkXS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBwYy5fc2hpbW1lZExvY2FsU3RyZWFtc1tzdHJlYW1JZF07XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvcmlnUmVtb3ZlVHJhY2suYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9LFxuXG4gIHNoaW1BZGRUcmFja1JlbW92ZVRyYWNrOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICBpZiAoIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgYnJvd3NlckRldGFpbHMgPSB1dGlscy5kZXRlY3RCcm93c2VyKHdpbmRvdyk7XG4gICAgLy8gc2hpbSBhZGRUcmFjayBhbmQgcmVtb3ZlVHJhY2suXG4gICAgaWYgKHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkVHJhY2sgJiZcbiAgICAgICAgYnJvd3NlckRldGFpbHMudmVyc2lvbiA+PSA2NSkge1xuICAgICAgcmV0dXJuIHRoaXMuc2hpbUFkZFRyYWNrUmVtb3ZlVHJhY2tXaXRoTmF0aXZlKHdpbmRvdyk7XG4gICAgfVxuXG4gICAgLy8gYWxzbyBzaGltIHBjLmdldExvY2FsU3RyZWFtcyB3aGVuIGFkZFRyYWNrIGlzIHNoaW1tZWRcbiAgICAvLyB0byByZXR1cm4gdGhlIG9yaWdpbmFsIHN0cmVhbXMuXG4gICAgdmFyIG9yaWdHZXRMb2NhbFN0cmVhbXMgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlXG4gICAgICAgIC5nZXRMb2NhbFN0cmVhbXM7XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRMb2NhbFN0cmVhbXMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICB2YXIgbmF0aXZlU3RyZWFtcyA9IG9yaWdHZXRMb2NhbFN0cmVhbXMuYXBwbHkodGhpcyk7XG4gICAgICBwYy5fcmV2ZXJzZVN0cmVhbXMgPSBwYy5fcmV2ZXJzZVN0cmVhbXMgfHwge307XG4gICAgICByZXR1cm4gbmF0aXZlU3RyZWFtcy5tYXAoZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICAgIHJldHVybiBwYy5fcmV2ZXJzZVN0cmVhbXNbc3RyZWFtLmlkXTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgb3JpZ0FkZFN0cmVhbSA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkU3RyZWFtO1xuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkU3RyZWFtID0gZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgcGMuX3N0cmVhbXMgPSBwYy5fc3RyZWFtcyB8fCB7fTtcbiAgICAgIHBjLl9yZXZlcnNlU3RyZWFtcyA9IHBjLl9yZXZlcnNlU3RyZWFtcyB8fCB7fTtcblxuICAgICAgc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHtcbiAgICAgICAgdmFyIGFscmVhZHlFeGlzdHMgPSBwYy5nZXRTZW5kZXJzKCkuZmluZChmdW5jdGlvbihzKSB7XG4gICAgICAgICAgcmV0dXJuIHMudHJhY2sgPT09IHRyYWNrO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGFscmVhZHlFeGlzdHMpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRE9NRXhjZXB0aW9uKCdUcmFjayBhbHJlYWR5IGV4aXN0cy4nLFxuICAgICAgICAgICAgICAnSW52YWxpZEFjY2Vzc0Vycm9yJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgLy8gQWRkIGlkZW50aXR5IG1hcHBpbmcgZm9yIGNvbnNpc3RlbmN5IHdpdGggYWRkVHJhY2suXG4gICAgICAvLyBVbmxlc3MgdGhpcyBpcyBiZWluZyB1c2VkIHdpdGggYSBzdHJlYW0gZnJvbSBhZGRUcmFjay5cbiAgICAgIGlmICghcGMuX3JldmVyc2VTdHJlYW1zW3N0cmVhbS5pZF0pIHtcbiAgICAgICAgdmFyIG5ld1N0cmVhbSA9IG5ldyB3aW5kb3cuTWVkaWFTdHJlYW0oc3RyZWFtLmdldFRyYWNrcygpKTtcbiAgICAgICAgcGMuX3N0cmVhbXNbc3RyZWFtLmlkXSA9IG5ld1N0cmVhbTtcbiAgICAgICAgcGMuX3JldmVyc2VTdHJlYW1zW25ld1N0cmVhbS5pZF0gPSBzdHJlYW07XG4gICAgICAgIHN0cmVhbSA9IG5ld1N0cmVhbTtcbiAgICAgIH1cbiAgICAgIG9yaWdBZGRTdHJlYW0uYXBwbHkocGMsIFtzdHJlYW1dKTtcbiAgICB9O1xuXG4gICAgdmFyIG9yaWdSZW1vdmVTdHJlYW0gPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVN0cmVhbTtcbiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnJlbW92ZVN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgIHBjLl9zdHJlYW1zID0gcGMuX3N0cmVhbXMgfHwge307XG4gICAgICBwYy5fcmV2ZXJzZVN0cmVhbXMgPSBwYy5fcmV2ZXJzZVN0cmVhbXMgfHwge307XG5cbiAgICAgIG9yaWdSZW1vdmVTdHJlYW0uYXBwbHkocGMsIFsocGMuX3N0cmVhbXNbc3RyZWFtLmlkXSB8fCBzdHJlYW0pXSk7XG4gICAgICBkZWxldGUgcGMuX3JldmVyc2VTdHJlYW1zWyhwYy5fc3RyZWFtc1tzdHJlYW0uaWRdID9cbiAgICAgICAgICBwYy5fc3RyZWFtc1tzdHJlYW0uaWRdLmlkIDogc3RyZWFtLmlkKV07XG4gICAgICBkZWxldGUgcGMuX3N0cmVhbXNbc3RyZWFtLmlkXTtcbiAgICB9O1xuXG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5hZGRUcmFjayA9IGZ1bmN0aW9uKHRyYWNrLCBzdHJlYW0pIHtcbiAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICBpZiAocGMuc2lnbmFsaW5nU3RhdGUgPT09ICdjbG9zZWQnKSB7XG4gICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oXG4gICAgICAgICAgJ1RoZSBSVENQZWVyQ29ubmVjdGlvblxcJ3Mgc2lnbmFsaW5nU3RhdGUgaXMgXFwnY2xvc2VkXFwnLicsXG4gICAgICAgICAgJ0ludmFsaWRTdGF0ZUVycm9yJyk7XG4gICAgICB9XG4gICAgICB2YXIgc3RyZWFtcyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgICAgIGlmIChzdHJlYW1zLmxlbmd0aCAhPT0gMSB8fFxuICAgICAgICAgICFzdHJlYW1zWzBdLmdldFRyYWNrcygpLmZpbmQoZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIHQgPT09IHRyYWNrO1xuICAgICAgICAgIH0pKSB7XG4gICAgICAgIC8vIHRoaXMgaXMgbm90IGZ1bGx5IGNvcnJlY3QgYnV0IGFsbCB3ZSBjYW4gbWFuYWdlIHdpdGhvdXRcbiAgICAgICAgLy8gW1thc3NvY2lhdGVkIE1lZGlhU3RyZWFtc11dIGludGVybmFsIHNsb3QuXG4gICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oXG4gICAgICAgICAgJ1RoZSBhZGFwdGVyLmpzIGFkZFRyYWNrIHBvbHlmaWxsIG9ubHkgc3VwcG9ydHMgYSBzaW5nbGUgJyArXG4gICAgICAgICAgJyBzdHJlYW0gd2hpY2ggaXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdHJhY2suJyxcbiAgICAgICAgICAnTm90U3VwcG9ydGVkRXJyb3InKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGFscmVhZHlFeGlzdHMgPSBwYy5nZXRTZW5kZXJzKCkuZmluZChmdW5jdGlvbihzKSB7XG4gICAgICAgIHJldHVybiBzLnRyYWNrID09PSB0cmFjaztcbiAgICAgIH0pO1xuICAgICAgaWYgKGFscmVhZHlFeGlzdHMpIHtcbiAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignVHJhY2sgYWxyZWFkeSBleGlzdHMuJyxcbiAgICAgICAgICAgICdJbnZhbGlkQWNjZXNzRXJyb3InKTtcbiAgICAgIH1cblxuICAgICAgcGMuX3N0cmVhbXMgPSBwYy5fc3RyZWFtcyB8fCB7fTtcbiAgICAgIHBjLl9yZXZlcnNlU3RyZWFtcyA9IHBjLl9yZXZlcnNlU3RyZWFtcyB8fCB7fTtcbiAgICAgIHZhciBvbGRTdHJlYW0gPSBwYy5fc3RyZWFtc1tzdHJlYW0uaWRdO1xuICAgICAgaWYgKG9sZFN0cmVhbSkge1xuICAgICAgICAvLyB0aGlzIGlzIHVzaW5nIG9kZCBDaHJvbWUgYmVoYXZpb3VyLCB1c2Ugd2l0aCBjYXV0aW9uOlxuICAgICAgICAvLyBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3Avd2VicnRjL2lzc3Vlcy9kZXRhaWw/aWQ9NzgxNVxuICAgICAgICAvLyBOb3RlOiB3ZSByZWx5IG9uIHRoZSBoaWdoLWxldmVsIGFkZFRyYWNrL2R0bWYgc2hpbSB0b1xuICAgICAgICAvLyBjcmVhdGUgdGhlIHNlbmRlciB3aXRoIGEgZHRtZiBzZW5kZXIuXG4gICAgICAgIG9sZFN0cmVhbS5hZGRUcmFjayh0cmFjayk7XG5cbiAgICAgICAgLy8gVHJpZ2dlciBPTk4gYXN5bmMuXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcGMuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ25lZ290aWF0aW9ubmVlZGVkJykpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBuZXdTdHJlYW0gPSBuZXcgd2luZG93Lk1lZGlhU3RyZWFtKFt0cmFja10pO1xuICAgICAgICBwYy5fc3RyZWFtc1tzdHJlYW0uaWRdID0gbmV3U3RyZWFtO1xuICAgICAgICBwYy5fcmV2ZXJzZVN0cmVhbXNbbmV3U3RyZWFtLmlkXSA9IHN0cmVhbTtcbiAgICAgICAgcGMuYWRkU3RyZWFtKG5ld1N0cmVhbSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcGMuZ2V0U2VuZGVycygpLmZpbmQoZnVuY3Rpb24ocykge1xuICAgICAgICByZXR1cm4gcy50cmFjayA9PT0gdHJhY2s7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLy8gcmVwbGFjZSB0aGUgaW50ZXJuYWwgc3RyZWFtIGlkIHdpdGggdGhlIGV4dGVybmFsIG9uZSBhbmRcbiAgICAvLyB2aWNlIHZlcnNhLlxuICAgIGZ1bmN0aW9uIHJlcGxhY2VJbnRlcm5hbFN0cmVhbUlkKHBjLCBkZXNjcmlwdGlvbikge1xuICAgICAgdmFyIHNkcCA9IGRlc2NyaXB0aW9uLnNkcDtcbiAgICAgIE9iamVjdC5rZXlzKHBjLl9yZXZlcnNlU3RyZWFtcyB8fCBbXSkuZm9yRWFjaChmdW5jdGlvbihpbnRlcm5hbElkKSB7XG4gICAgICAgIHZhciBleHRlcm5hbFN0cmVhbSA9IHBjLl9yZXZlcnNlU3RyZWFtc1tpbnRlcm5hbElkXTtcbiAgICAgICAgdmFyIGludGVybmFsU3RyZWFtID0gcGMuX3N0cmVhbXNbZXh0ZXJuYWxTdHJlYW0uaWRdO1xuICAgICAgICBzZHAgPSBzZHAucmVwbGFjZShuZXcgUmVnRXhwKGludGVybmFsU3RyZWFtLmlkLCAnZycpLFxuICAgICAgICAgICAgZXh0ZXJuYWxTdHJlYW0uaWQpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gbmV3IFJUQ1Nlc3Npb25EZXNjcmlwdGlvbih7XG4gICAgICAgIHR5cGU6IGRlc2NyaXB0aW9uLnR5cGUsXG4gICAgICAgIHNkcDogc2RwXG4gICAgICB9KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gcmVwbGFjZUV4dGVybmFsU3RyZWFtSWQocGMsIGRlc2NyaXB0aW9uKSB7XG4gICAgICB2YXIgc2RwID0gZGVzY3JpcHRpb24uc2RwO1xuICAgICAgT2JqZWN0LmtleXMocGMuX3JldmVyc2VTdHJlYW1zIHx8IFtdKS5mb3JFYWNoKGZ1bmN0aW9uKGludGVybmFsSWQpIHtcbiAgICAgICAgdmFyIGV4dGVybmFsU3RyZWFtID0gcGMuX3JldmVyc2VTdHJlYW1zW2ludGVybmFsSWRdO1xuICAgICAgICB2YXIgaW50ZXJuYWxTdHJlYW0gPSBwYy5fc3RyZWFtc1tleHRlcm5hbFN0cmVhbS5pZF07XG4gICAgICAgIHNkcCA9IHNkcC5yZXBsYWNlKG5ldyBSZWdFeHAoZXh0ZXJuYWxTdHJlYW0uaWQsICdnJyksXG4gICAgICAgICAgICBpbnRlcm5hbFN0cmVhbS5pZCk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBuZXcgUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKHtcbiAgICAgICAgdHlwZTogZGVzY3JpcHRpb24udHlwZSxcbiAgICAgICAgc2RwOiBzZHBcbiAgICAgIH0pO1xuICAgIH1cbiAgICBbJ2NyZWF0ZU9mZmVyJywgJ2NyZWF0ZUFuc3dlciddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgICB2YXIgbmF0aXZlTWV0aG9kID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdO1xuICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgICB2YXIgaXNMZWdhY3lDYWxsID0gYXJndW1lbnRzLmxlbmd0aCAmJlxuICAgICAgICAgICAgdHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ2Z1bmN0aW9uJztcbiAgICAgICAgaWYgKGlzTGVnYWN5Q2FsbCkge1xuICAgICAgICAgIHJldHVybiBuYXRpdmVNZXRob2QuYXBwbHkocGMsIFtcbiAgICAgICAgICAgIGZ1bmN0aW9uKGRlc2NyaXB0aW9uKSB7XG4gICAgICAgICAgICAgIHZhciBkZXNjID0gcmVwbGFjZUludGVybmFsU3RyZWFtSWQocGMsIGRlc2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgYXJnc1swXS5hcHBseShudWxsLCBbZGVzY10pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICBpZiAoYXJnc1sxXSkge1xuICAgICAgICAgICAgICAgIGFyZ3NbMV0uYXBwbHkobnVsbCwgZXJyKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgYXJndW1lbnRzWzJdXG4gICAgICAgICAgXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseShwYywgYXJndW1lbnRzKVxuICAgICAgICAudGhlbihmdW5jdGlvbihkZXNjcmlwdGlvbikge1xuICAgICAgICAgIHJldHVybiByZXBsYWNlSW50ZXJuYWxTdHJlYW1JZChwYywgZGVzY3JpcHRpb24pO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICB2YXIgb3JpZ1NldExvY2FsRGVzY3JpcHRpb24gPVxuICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldExvY2FsRGVzY3JpcHRpb247XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXRMb2NhbERlc2NyaXB0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoIHx8ICFhcmd1bWVudHNbMF0udHlwZSkge1xuICAgICAgICByZXR1cm4gb3JpZ1NldExvY2FsRGVzY3JpcHRpb24uYXBwbHkocGMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgICBhcmd1bWVudHNbMF0gPSByZXBsYWNlRXh0ZXJuYWxTdHJlYW1JZChwYywgYXJndW1lbnRzWzBdKTtcbiAgICAgIHJldHVybiBvcmlnU2V0TG9jYWxEZXNjcmlwdGlvbi5hcHBseShwYywgYXJndW1lbnRzKTtcbiAgICB9O1xuXG4gICAgLy8gVE9ETzogbWFuZ2xlIGdldFN0YXRzOiBodHRwczovL3czYy5naXRodWIuaW8vd2VicnRjLXN0YXRzLyNkb20tcnRjbWVkaWFzdHJlYW1zdGF0cy1zdHJlYW1pZGVudGlmaWVyXG5cbiAgICB2YXIgb3JpZ0xvY2FsRGVzY3JpcHRpb24gPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKFxuICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLCAnbG9jYWxEZXNjcmlwdGlvbicpO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLFxuICAgICAgICAnbG9jYWxEZXNjcmlwdGlvbicsIHtcbiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IG9yaWdMb2NhbERlc2NyaXB0aW9uLmdldC5hcHBseSh0aGlzKTtcbiAgICAgICAgICAgIGlmIChkZXNjcmlwdGlvbi50eXBlID09PSAnJykge1xuICAgICAgICAgICAgICByZXR1cm4gZGVzY3JpcHRpb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVwbGFjZUludGVybmFsU3RyZWFtSWQocGMsIGRlc2NyaXB0aW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVUcmFjayA9IGZ1bmN0aW9uKHNlbmRlcikge1xuICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgIGlmIChwYy5zaWduYWxpbmdTdGF0ZSA9PT0gJ2Nsb3NlZCcpIHtcbiAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbihcbiAgICAgICAgICAnVGhlIFJUQ1BlZXJDb25uZWN0aW9uXFwncyBzaWduYWxpbmdTdGF0ZSBpcyBcXCdjbG9zZWRcXCcuJyxcbiAgICAgICAgICAnSW52YWxpZFN0YXRlRXJyb3InKTtcbiAgICAgIH1cbiAgICAgIC8vIFdlIGNhbiBub3QgeWV0IGNoZWNrIGZvciBzZW5kZXIgaW5zdGFuY2VvZiBSVENSdHBTZW5kZXJcbiAgICAgIC8vIHNpbmNlIHdlIHNoaW0gUlRQU2VuZGVyLiBTbyB3ZSBjaGVjayBpZiBzZW5kZXIuX3BjIGlzIHNldC5cbiAgICAgIGlmICghc2VuZGVyLl9wYykge1xuICAgICAgICB0aHJvdyBuZXcgRE9NRXhjZXB0aW9uKCdBcmd1bWVudCAxIG9mIFJUQ1BlZXJDb25uZWN0aW9uLnJlbW92ZVRyYWNrICcgK1xuICAgICAgICAgICAgJ2RvZXMgbm90IGltcGxlbWVudCBpbnRlcmZhY2UgUlRDUnRwU2VuZGVyLicsICdUeXBlRXJyb3InKTtcbiAgICAgIH1cbiAgICAgIHZhciBpc0xvY2FsID0gc2VuZGVyLl9wYyA9PT0gcGM7XG4gICAgICBpZiAoIWlzTG9jYWwpIHtcbiAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignU2VuZGVyIHdhcyBub3QgY3JlYXRlZCBieSB0aGlzIGNvbm5lY3Rpb24uJyxcbiAgICAgICAgICAgICdJbnZhbGlkQWNjZXNzRXJyb3InKTtcbiAgICAgIH1cblxuICAgICAgLy8gU2VhcmNoIGZvciB0aGUgbmF0aXZlIHN0cmVhbSB0aGUgc2VuZGVycyB0cmFjayBiZWxvbmdzIHRvLlxuICAgICAgcGMuX3N0cmVhbXMgPSBwYy5fc3RyZWFtcyB8fCB7fTtcbiAgICAgIHZhciBzdHJlYW07XG4gICAgICBPYmplY3Qua2V5cyhwYy5fc3RyZWFtcykuZm9yRWFjaChmdW5jdGlvbihzdHJlYW1pZCkge1xuICAgICAgICB2YXIgaGFzVHJhY2sgPSBwYy5fc3RyZWFtc1tzdHJlYW1pZF0uZ2V0VHJhY2tzKCkuZmluZChmdW5jdGlvbih0cmFjaykge1xuICAgICAgICAgIHJldHVybiBzZW5kZXIudHJhY2sgPT09IHRyYWNrO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGhhc1RyYWNrKSB7XG4gICAgICAgICAgc3RyZWFtID0gcGMuX3N0cmVhbXNbc3RyZWFtaWRdO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKHN0cmVhbSkge1xuICAgICAgICBpZiAoc3RyZWFtLmdldFRyYWNrcygpLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIC8vIGlmIHRoaXMgaXMgdGhlIGxhc3QgdHJhY2sgb2YgdGhlIHN0cmVhbSwgcmVtb3ZlIHRoZSBzdHJlYW0uIFRoaXNcbiAgICAgICAgICAvLyB0YWtlcyBjYXJlIG9mIGFueSBzaGltbWVkIF9zZW5kZXJzLlxuICAgICAgICAgIHBjLnJlbW92ZVN0cmVhbShwYy5fcmV2ZXJzZVN0cmVhbXNbc3RyZWFtLmlkXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gcmVseWluZyBvbiB0aGUgc2FtZSBvZGQgY2hyb21lIGJlaGF2aW91ciBhcyBhYm92ZS5cbiAgICAgICAgICBzdHJlYW0ucmVtb3ZlVHJhY2soc2VuZGVyLnRyYWNrKTtcbiAgICAgICAgfVxuICAgICAgICBwYy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnbmVnb3RpYXRpb25uZWVkZWQnKSk7XG4gICAgICB9XG4gICAgfTtcbiAgfSxcblxuICBzaGltUGVlckNvbm5lY3Rpb246IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIHZhciBicm93c2VyRGV0YWlscyA9IHV0aWxzLmRldGVjdEJyb3dzZXIod2luZG93KTtcblxuICAgIC8vIFRoZSBSVENQZWVyQ29ubmVjdGlvbiBvYmplY3QuXG4gICAgaWYgKCF3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gJiYgd2luZG93LndlYmtpdFJUQ1BlZXJDb25uZWN0aW9uKSB7XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gPSBmdW5jdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cykge1xuICAgICAgICAvLyBUcmFuc2xhdGUgaWNlVHJhbnNwb3J0UG9saWN5IHRvIGljZVRyYW5zcG9ydHMsXG4gICAgICAgIC8vIHNlZSBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL3dlYnJ0Yy9pc3N1ZXMvZGV0YWlsP2lkPTQ4NjlcbiAgICAgICAgLy8gdGhpcyB3YXMgZml4ZWQgaW4gTTU2IGFsb25nIHdpdGggdW5wcmVmaXhpbmcgUlRDUGVlckNvbm5lY3Rpb24uXG4gICAgICAgIGxvZ2dpbmcoJ1BlZXJDb25uZWN0aW9uJyk7XG4gICAgICAgIGlmIChwY0NvbmZpZyAmJiBwY0NvbmZpZy5pY2VUcmFuc3BvcnRQb2xpY3kpIHtcbiAgICAgICAgICBwY0NvbmZpZy5pY2VUcmFuc3BvcnRzID0gcGNDb25maWcuaWNlVHJhbnNwb3J0UG9saWN5O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyB3aW5kb3cud2Via2l0UlRDUGVlckNvbm5lY3Rpb24ocGNDb25maWcsIHBjQ29uc3RyYWludHMpO1xuICAgICAgfTtcbiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPVxuICAgICAgICAgIHdpbmRvdy53ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7XG4gICAgICAvLyB3cmFwIHN0YXRpYyBtZXRob2RzLiBDdXJyZW50bHkganVzdCBnZW5lcmF0ZUNlcnRpZmljYXRlLlxuICAgICAgaWYgKHdpbmRvdy53ZWJraXRSVENQZWVyQ29ubmVjdGlvbi5nZW5lcmF0ZUNlcnRpZmljYXRlKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24sICdnZW5lcmF0ZUNlcnRpZmljYXRlJywge1xuICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93LndlYmtpdFJUQ1BlZXJDb25uZWN0aW9uLmdlbmVyYXRlQ2VydGlmaWNhdGU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCF3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgb3JpZ0dldFN0YXRzID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cztcbiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFN0YXRzID0gZnVuY3Rpb24oc2VsZWN0b3IsXG4gICAgICAgIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykge1xuICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuXG4gICAgICAvLyBJZiBzZWxlY3RvciBpcyBhIGZ1bmN0aW9uIHRoZW4gd2UgYXJlIGluIHRoZSBvbGQgc3R5bGUgc3RhdHMgc28ganVzdFxuICAgICAgLy8gcGFzcyBiYWNrIHRoZSBvcmlnaW5hbCBnZXRTdGF0cyBmb3JtYXQgdG8gYXZvaWQgYnJlYWtpbmcgb2xkIHVzZXJzLlxuICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm4gb3JpZ0dldFN0YXRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFdoZW4gc3BlYy1zdHlsZSBnZXRTdGF0cyBpcyBzdXBwb3J0ZWQsIHJldHVybiB0aG9zZSB3aGVuIGNhbGxlZCB3aXRoXG4gICAgICAvLyBlaXRoZXIgbm8gYXJndW1lbnRzIG9yIHRoZSBzZWxlY3RvciBhcmd1bWVudCBpcyBudWxsLlxuICAgICAgaWYgKG9yaWdHZXRTdGF0cy5sZW5ndGggPT09IDAgJiYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDAgfHxcbiAgICAgICAgICB0eXBlb2YgYXJndW1lbnRzWzBdICE9PSAnZnVuY3Rpb24nKSkge1xuICAgICAgICByZXR1cm4gb3JpZ0dldFN0YXRzLmFwcGx5KHRoaXMsIFtdKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGZpeENocm9tZVN0YXRzXyA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIHZhciBzdGFuZGFyZFJlcG9ydCA9IHt9O1xuICAgICAgICB2YXIgcmVwb3J0cyA9IHJlc3BvbnNlLnJlc3VsdCgpO1xuICAgICAgICByZXBvcnRzLmZvckVhY2goZnVuY3Rpb24ocmVwb3J0KSB7XG4gICAgICAgICAgdmFyIHN0YW5kYXJkU3RhdHMgPSB7XG4gICAgICAgICAgICBpZDogcmVwb3J0LmlkLFxuICAgICAgICAgICAgdGltZXN0YW1wOiByZXBvcnQudGltZXN0YW1wLFxuICAgICAgICAgICAgdHlwZToge1xuICAgICAgICAgICAgICBsb2NhbGNhbmRpZGF0ZTogJ2xvY2FsLWNhbmRpZGF0ZScsXG4gICAgICAgICAgICAgIHJlbW90ZWNhbmRpZGF0ZTogJ3JlbW90ZS1jYW5kaWRhdGUnXG4gICAgICAgICAgICB9W3JlcG9ydC50eXBlXSB8fCByZXBvcnQudHlwZVxuICAgICAgICAgIH07XG4gICAgICAgICAgcmVwb3J0Lm5hbWVzKCkuZm9yRWFjaChmdW5jdGlvbihuYW1lKSB7XG4gICAgICAgICAgICBzdGFuZGFyZFN0YXRzW25hbWVdID0gcmVwb3J0LnN0YXQobmFtZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgc3RhbmRhcmRSZXBvcnRbc3RhbmRhcmRTdGF0cy5pZF0gPSBzdGFuZGFyZFN0YXRzO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gc3RhbmRhcmRSZXBvcnQ7XG4gICAgICB9O1xuXG4gICAgICAvLyBzaGltIGdldFN0YXRzIHdpdGggbWFwbGlrZSBzdXBwb3J0XG4gICAgICB2YXIgbWFrZU1hcFN0YXRzID0gZnVuY3Rpb24oc3RhdHMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXAoT2JqZWN0LmtleXMoc3RhdHMpLm1hcChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICByZXR1cm4gW2tleSwgc3RhdHNba2V5XV07XG4gICAgICAgIH0pKTtcbiAgICAgIH07XG5cbiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID49IDIpIHtcbiAgICAgICAgdmFyIHN1Y2Nlc3NDYWxsYmFja1dyYXBwZXJfID0gZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICBhcmdzWzFdKG1ha2VNYXBTdGF0cyhmaXhDaHJvbWVTdGF0c18ocmVzcG9uc2UpKSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIG9yaWdHZXRTdGF0cy5hcHBseSh0aGlzLCBbc3VjY2Vzc0NhbGxiYWNrV3JhcHBlcl8sXG4gICAgICAgICAgYXJndW1lbnRzWzBdXSk7XG4gICAgICB9XG5cbiAgICAgIC8vIHByb21pc2Utc3VwcG9ydFxuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBvcmlnR2V0U3RhdHMuYXBwbHkocGMsIFtcbiAgICAgICAgICBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgcmVzb2x2ZShtYWtlTWFwU3RhdHMoZml4Q2hyb21lU3RhdHNfKHJlc3BvbnNlKSkpO1xuICAgICAgICAgIH0sIHJlamVjdF0pO1xuICAgICAgfSkudGhlbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spO1xuICAgIH07XG5cbiAgICAvLyBhZGQgcHJvbWlzZSBzdXBwb3J0IC0tIG5hdGl2ZWx5IGF2YWlsYWJsZSBpbiBDaHJvbWUgNTFcbiAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDUxKSB7XG4gICAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ11cbiAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHtcbiAgICAgICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlW21ldGhvZF07XG4gICAgICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgICAgICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlTWV0aG9kLmFwcGx5KHBjLCBbYXJnc1swXSwgcmVzb2x2ZSwgcmVqZWN0XSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBhcmdzWzFdLmFwcGx5KG51bGwsIFtdKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID49IDMpIHtcbiAgICAgICAgICAgICAgICAgIGFyZ3NbMl0uYXBwbHkobnVsbCwgW2Vycl0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIHByb21pc2Ugc3VwcG9ydCBmb3IgY3JlYXRlT2ZmZXIgYW5kIGNyZWF0ZUFuc3dlci4gQXZhaWxhYmxlICh3aXRob3V0XG4gICAgLy8gYnVncykgc2luY2UgTTUyOiBjcmJ1Zy82MTkyODlcbiAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDUyKSB7XG4gICAgICBbJ2NyZWF0ZU9mZmVyJywgJ2NyZWF0ZUFuc3dlciddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgICAgIHZhciBuYXRpdmVNZXRob2QgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlW21ldGhvZF07XG4gICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAxIHx8IChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmXG4gICAgICAgICAgICAgIHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdvYmplY3QnKSkge1xuICAgICAgICAgICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID09PSAxID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICBuYXRpdmVNZXRob2QuYXBwbHkocGMsIFtyZXNvbHZlLCByZWplY3QsIG9wdHNdKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbmF0aXZlTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBzaGltIGltcGxpY2l0IGNyZWF0aW9uIG9mIFJUQ1Nlc3Npb25EZXNjcmlwdGlvbi9SVENJY2VDYW5kaWRhdGVcbiAgICBbJ3NldExvY2FsRGVzY3JpcHRpb24nLCAnc2V0UmVtb3RlRGVzY3JpcHRpb24nLCAnYWRkSWNlQ2FuZGlkYXRlJ11cbiAgICAgICAgLmZvckVhY2goZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgICAgICAgdmFyIG5hdGl2ZU1ldGhvZCA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXTtcbiAgICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGFyZ3VtZW50c1swXSA9IG5ldyAoKG1ldGhvZCA9PT0gJ2FkZEljZUNhbmRpZGF0ZScpID9cbiAgICAgICAgICAgICAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlIDpcbiAgICAgICAgICAgICAgICB3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKShhcmd1bWVudHNbMF0pO1xuICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZU1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgLy8gc3VwcG9ydCBmb3IgYWRkSWNlQ2FuZGlkYXRlKG51bGwgb3IgdW5kZWZpbmVkKVxuICAgIHZhciBuYXRpdmVBZGRJY2VDYW5kaWRhdGUgPVxuICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZTtcbiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCFhcmd1bWVudHNbMF0pIHtcbiAgICAgICAgaWYgKGFyZ3VtZW50c1sxXSkge1xuICAgICAgICAgIGFyZ3VtZW50c1sxXS5hcHBseShudWxsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmF0aXZlQWRkSWNlQ2FuZGlkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfSxcblxuICBmaXhOZWdvdGlhdGlvbk5lZWRlZDogZnVuY3Rpb24od2luZG93KSB7XG4gICAgdXRpbHMud3JhcFBlZXJDb25uZWN0aW9uRXZlbnQod2luZG93LCAnbmVnb3RpYXRpb25uZWVkZWQnLCBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgcGMgPSBlLnRhcmdldDtcbiAgICAgIGlmIChwYy5zaWduYWxpbmdTdGF0ZSAhPT0gJ3N0YWJsZScpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGU7XG4gICAgfSk7XG4gIH0sXG5cbiAgc2hpbUdldERpc3BsYXlNZWRpYTogZnVuY3Rpb24od2luZG93LCBnZXRTb3VyY2VJZCkge1xuICAgIGlmICghd2luZG93Lm5hdmlnYXRvciB8fCAhd2luZG93Lm5hdmlnYXRvci5tZWRpYURldmljZXMgfHxcbiAgICAgICAgJ2dldERpc3BsYXlNZWRpYScgaW4gd2luZG93Lm5hdmlnYXRvci5tZWRpYURldmljZXMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gZ2V0U291cmNlSWQgaXMgYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBwcm9taXNlIHJlc29sdmluZyB3aXRoXG4gICAgLy8gdGhlIHNvdXJjZUlkIG9mIHRoZSBzY3JlZW4vd2luZG93L3RhYiB0byBiZSBzaGFyZWQuXG4gICAgaWYgKHR5cGVvZiBnZXRTb3VyY2VJZCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY29uc29sZS5lcnJvcignc2hpbUdldERpc3BsYXlNZWRpYTogZ2V0U291cmNlSWQgYXJndW1lbnQgaXMgbm90ICcgK1xuICAgICAgICAgICdhIGZ1bmN0aW9uJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHdpbmRvdy5uYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldERpc3BsYXlNZWRpYSA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7XG4gICAgICByZXR1cm4gZ2V0U291cmNlSWQoY29uc3RyYWludHMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHNvdXJjZUlkKSB7XG4gICAgICAgICAgdmFyIHdpZHRoU3BlY2lmaWVkID0gY29uc3RyYWludHMudmlkZW8gJiYgY29uc3RyYWludHMudmlkZW8ud2lkdGg7XG4gICAgICAgICAgdmFyIGhlaWdodFNwZWNpZmllZCA9IGNvbnN0cmFpbnRzLnZpZGVvICYmIGNvbnN0cmFpbnRzLnZpZGVvLmhlaWdodDtcbiAgICAgICAgICB2YXIgZnJhbWVSYXRlU3BlY2lmaWVkID0gY29uc3RyYWludHMudmlkZW8gJiZcbiAgICAgICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvLmZyYW1lUmF0ZTtcbiAgICAgICAgICBjb25zdHJhaW50cy52aWRlbyA9IHtcbiAgICAgICAgICAgIG1hbmRhdG9yeToge1xuICAgICAgICAgICAgICBjaHJvbWVNZWRpYVNvdXJjZTogJ2Rlc2t0b3AnLFxuICAgICAgICAgICAgICBjaHJvbWVNZWRpYVNvdXJjZUlkOiBzb3VyY2VJZCxcbiAgICAgICAgICAgICAgbWF4RnJhbWVSYXRlOiBmcmFtZVJhdGVTcGVjaWZpZWQgfHwgM1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKHdpZHRoU3BlY2lmaWVkKSB7XG4gICAgICAgICAgICBjb25zdHJhaW50cy52aWRlby5tYW5kYXRvcnkubWF4V2lkdGggPSB3aWR0aFNwZWNpZmllZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGhlaWdodFNwZWNpZmllZCkge1xuICAgICAgICAgICAgY29uc3RyYWludHMudmlkZW8ubWFuZGF0b3J5Lm1heEhlaWdodCA9IGhlaWdodFNwZWNpZmllZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHdpbmRvdy5uYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYShjb25zdHJhaW50cyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgd2luZG93Lm5hdmlnYXRvci5nZXREaXNwbGF5TWVkaWEgPSBmdW5jdGlvbihjb25zdHJhaW50cykge1xuICAgICAgdXRpbHMuZGVwcmVjYXRlZCgnbmF2aWdhdG9yLmdldERpc3BsYXlNZWRpYScsXG4gICAgICAgICAgJ25hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0RGlzcGxheU1lZGlhJyk7XG4gICAgICByZXR1cm4gd2luZG93Lm5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0RGlzcGxheU1lZGlhKGNvbnN0cmFpbnRzKTtcbiAgICB9O1xuICB9XG59O1xuIiwiLypcbiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlIGxpY2Vuc2VcbiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2VcbiAqICB0cmVlLlxuICovXG4gLyogZXNsaW50LWVudiBub2RlICovXG4ndXNlIHN0cmljdCc7XG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLi91dGlscy5qcycpO1xudmFyIGxvZ2dpbmcgPSB1dGlscy5sb2c7XG5cbi8vIEV4cG9zZSBwdWJsaWMgbWV0aG9kcy5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24od2luZG93KSB7XG4gIHZhciBicm93c2VyRGV0YWlscyA9IHV0aWxzLmRldGVjdEJyb3dzZXIod2luZG93KTtcbiAgdmFyIG5hdmlnYXRvciA9IHdpbmRvdyAmJiB3aW5kb3cubmF2aWdhdG9yO1xuXG4gIHZhciBjb25zdHJhaW50c1RvQ2hyb21lXyA9IGZ1bmN0aW9uKGMpIHtcbiAgICBpZiAodHlwZW9mIGMgIT09ICdvYmplY3QnIHx8IGMubWFuZGF0b3J5IHx8IGMub3B0aW9uYWwpIHtcbiAgICAgIHJldHVybiBjO1xuICAgIH1cbiAgICB2YXIgY2MgPSB7fTtcbiAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgICAgaWYgKGtleSA9PT0gJ3JlcXVpcmUnIHx8IGtleSA9PT0gJ2FkdmFuY2VkJyB8fCBrZXkgPT09ICdtZWRpYVNvdXJjZScpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIHIgPSAodHlwZW9mIGNba2V5XSA9PT0gJ29iamVjdCcpID8gY1trZXldIDoge2lkZWFsOiBjW2tleV19O1xuICAgICAgaWYgKHIuZXhhY3QgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygci5leGFjdCA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgci5taW4gPSByLm1heCA9IHIuZXhhY3Q7XG4gICAgICB9XG4gICAgICB2YXIgb2xkbmFtZV8gPSBmdW5jdGlvbihwcmVmaXgsIG5hbWUpIHtcbiAgICAgICAgaWYgKHByZWZpeCkge1xuICAgICAgICAgIHJldHVybiBwcmVmaXggKyBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKG5hbWUgPT09ICdkZXZpY2VJZCcpID8gJ3NvdXJjZUlkJyA6IG5hbWU7XG4gICAgICB9O1xuICAgICAgaWYgKHIuaWRlYWwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjYy5vcHRpb25hbCA9IGNjLm9wdGlvbmFsIHx8IFtdO1xuICAgICAgICB2YXIgb2MgPSB7fTtcbiAgICAgICAgaWYgKHR5cGVvZiByLmlkZWFsID09PSAnbnVtYmVyJykge1xuICAgICAgICAgIG9jW29sZG5hbWVfKCdtaW4nLCBrZXkpXSA9IHIuaWRlYWw7XG4gICAgICAgICAgY2Mub3B0aW9uYWwucHVzaChvYyk7XG4gICAgICAgICAgb2MgPSB7fTtcbiAgICAgICAgICBvY1tvbGRuYW1lXygnbWF4Jywga2V5KV0gPSByLmlkZWFsO1xuICAgICAgICAgIGNjLm9wdGlvbmFsLnB1c2gob2MpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9jW29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuaWRlYWw7XG4gICAgICAgICAgY2Mub3B0aW9uYWwucHVzaChvYyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHIuZXhhY3QgIT09ICdudW1iZXInKSB7XG4gICAgICAgIGNjLm1hbmRhdG9yeSA9IGNjLm1hbmRhdG9yeSB8fCB7fTtcbiAgICAgICAgY2MubWFuZGF0b3J5W29sZG5hbWVfKCcnLCBrZXkpXSA9IHIuZXhhY3Q7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBbJ21pbicsICdtYXgnXS5mb3JFYWNoKGZ1bmN0aW9uKG1peCkge1xuICAgICAgICAgIGlmIChyW21peF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY2MubWFuZGF0b3J5ID0gY2MubWFuZGF0b3J5IHx8IHt9O1xuICAgICAgICAgICAgY2MubWFuZGF0b3J5W29sZG5hbWVfKG1peCwga2V5KV0gPSByW21peF07XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoYy5hZHZhbmNlZCkge1xuICAgICAgY2Mub3B0aW9uYWwgPSAoY2Mub3B0aW9uYWwgfHwgW10pLmNvbmNhdChjLmFkdmFuY2VkKTtcbiAgICB9XG4gICAgcmV0dXJuIGNjO1xuICB9O1xuXG4gIHZhciBzaGltQ29uc3RyYWludHNfID0gZnVuY3Rpb24oY29uc3RyYWludHMsIGZ1bmMpIHtcbiAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA+PSA2MSkge1xuICAgICAgcmV0dXJuIGZ1bmMoY29uc3RyYWludHMpO1xuICAgIH1cbiAgICBjb25zdHJhaW50cyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTtcbiAgICBpZiAoY29uc3RyYWludHMgJiYgdHlwZW9mIGNvbnN0cmFpbnRzLmF1ZGlvID09PSAnb2JqZWN0Jykge1xuICAgICAgdmFyIHJlbWFwID0gZnVuY3Rpb24ob2JqLCBhLCBiKSB7XG4gICAgICAgIGlmIChhIGluIG9iaiAmJiAhKGIgaW4gb2JqKSkge1xuICAgICAgICAgIG9ialtiXSA9IG9ialthXTtcbiAgICAgICAgICBkZWxldGUgb2JqW2FdO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgY29uc3RyYWludHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKSk7XG4gICAgICByZW1hcChjb25zdHJhaW50cy5hdWRpbywgJ2F1dG9HYWluQ29udHJvbCcsICdnb29nQXV0b0dhaW5Db250cm9sJyk7XG4gICAgICByZW1hcChjb25zdHJhaW50cy5hdWRpbywgJ25vaXNlU3VwcHJlc3Npb24nLCAnZ29vZ05vaXNlU3VwcHJlc3Npb24nKTtcbiAgICAgIGNvbnN0cmFpbnRzLmF1ZGlvID0gY29uc3RyYWludHNUb0Nocm9tZV8oY29uc3RyYWludHMuYXVkaW8pO1xuICAgIH1cbiAgICBpZiAoY29uc3RyYWludHMgJiYgdHlwZW9mIGNvbnN0cmFpbnRzLnZpZGVvID09PSAnb2JqZWN0Jykge1xuICAgICAgLy8gU2hpbSBmYWNpbmdNb2RlIGZvciBtb2JpbGUgJiBzdXJmYWNlIHByby5cbiAgICAgIHZhciBmYWNlID0gY29uc3RyYWludHMudmlkZW8uZmFjaW5nTW9kZTtcbiAgICAgIGZhY2UgPSBmYWNlICYmICgodHlwZW9mIGZhY2UgPT09ICdvYmplY3QnKSA/IGZhY2UgOiB7aWRlYWw6IGZhY2V9KTtcbiAgICAgIHZhciBnZXRTdXBwb3J0ZWRGYWNpbmdNb2RlTGllcyA9IGJyb3dzZXJEZXRhaWxzLnZlcnNpb24gPCA2NjtcblxuICAgICAgaWYgKChmYWNlICYmIChmYWNlLmV4YWN0ID09PSAndXNlcicgfHwgZmFjZS5leGFjdCA9PT0gJ2Vudmlyb25tZW50JyB8fFxuICAgICAgICAgICAgICAgICAgICBmYWNlLmlkZWFsID09PSAndXNlcicgfHwgZmFjZS5pZGVhbCA9PT0gJ2Vudmlyb25tZW50JykpICYmXG4gICAgICAgICAgIShuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFN1cHBvcnRlZENvbnN0cmFpbnRzICYmXG4gICAgICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFN1cHBvcnRlZENvbnN0cmFpbnRzKCkuZmFjaW5nTW9kZSAmJlxuICAgICAgICAgICAgIWdldFN1cHBvcnRlZEZhY2luZ01vZGVMaWVzKSkge1xuICAgICAgICBkZWxldGUgY29uc3RyYWludHMudmlkZW8uZmFjaW5nTW9kZTtcbiAgICAgICAgdmFyIG1hdGNoZXM7XG4gICAgICAgIGlmIChmYWNlLmV4YWN0ID09PSAnZW52aXJvbm1lbnQnIHx8IGZhY2UuaWRlYWwgPT09ICdlbnZpcm9ubWVudCcpIHtcbiAgICAgICAgICBtYXRjaGVzID0gWydiYWNrJywgJ3JlYXInXTtcbiAgICAgICAgfSBlbHNlIGlmIChmYWNlLmV4YWN0ID09PSAndXNlcicgfHwgZmFjZS5pZGVhbCA9PT0gJ3VzZXInKSB7XG4gICAgICAgICAgbWF0Y2hlcyA9IFsnZnJvbnQnXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobWF0Y2hlcykge1xuICAgICAgICAgIC8vIExvb2sgZm9yIG1hdGNoZXMgaW4gbGFiZWwsIG9yIHVzZSBsYXN0IGNhbSBmb3IgYmFjayAodHlwaWNhbCkuXG4gICAgICAgICAgcmV0dXJuIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcygpXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZGV2aWNlcykge1xuICAgICAgICAgICAgZGV2aWNlcyA9IGRldmljZXMuZmlsdGVyKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGQua2luZCA9PT0gJ3ZpZGVvaW5wdXQnO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgZGV2ID0gZGV2aWNlcy5maW5kKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXMuc29tZShmdW5jdGlvbihtYXRjaCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkLmxhYmVsLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihtYXRjaCkgIT09IC0xO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKCFkZXYgJiYgZGV2aWNlcy5sZW5ndGggJiYgbWF0Y2hlcy5pbmRleE9mKCdiYWNrJykgIT09IC0xKSB7XG4gICAgICAgICAgICAgIGRldiA9IGRldmljZXNbZGV2aWNlcy5sZW5ndGggLSAxXTsgLy8gbW9yZSBsaWtlbHkgdGhlIGJhY2sgY2FtXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGV2KSB7XG4gICAgICAgICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvLmRldmljZUlkID0gZmFjZS5leGFjdCA/IHtleGFjdDogZGV2LmRldmljZUlkfSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtpZGVhbDogZGV2LmRldmljZUlkfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0cmFpbnRzLnZpZGVvID0gY29uc3RyYWludHNUb0Nocm9tZV8oY29uc3RyYWludHMudmlkZW8pO1xuICAgICAgICAgICAgbG9nZ2luZygnY2hyb21lOiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jKGNvbnN0cmFpbnRzKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29uc3RyYWludHMudmlkZW8gPSBjb25zdHJhaW50c1RvQ2hyb21lXyhjb25zdHJhaW50cy52aWRlbyk7XG4gICAgfVxuICAgIGxvZ2dpbmcoJ2Nocm9tZTogJyArIEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKSk7XG4gICAgcmV0dXJuIGZ1bmMoY29uc3RyYWludHMpO1xuICB9O1xuXG4gIHZhciBzaGltRXJyb3JfID0gZnVuY3Rpb24oZSkge1xuICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uID49IDY0KSB7XG4gICAgICByZXR1cm4gZTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHtcbiAgICAgICAgUGVybWlzc2lvbkRlbmllZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJyxcbiAgICAgICAgUGVybWlzc2lvbkRpc21pc3NlZEVycm9yOiAnTm90QWxsb3dlZEVycm9yJyxcbiAgICAgICAgSW52YWxpZFN0YXRlRXJyb3I6ICdOb3RBbGxvd2VkRXJyb3InLFxuICAgICAgICBEZXZpY2VzTm90Rm91bmRFcnJvcjogJ05vdEZvdW5kRXJyb3InLFxuICAgICAgICBDb25zdHJhaW50Tm90U2F0aXNmaWVkRXJyb3I6ICdPdmVyY29uc3RyYWluZWRFcnJvcicsXG4gICAgICAgIFRyYWNrU3RhcnRFcnJvcjogJ05vdFJlYWRhYmxlRXJyb3InLFxuICAgICAgICBNZWRpYURldmljZUZhaWxlZER1ZVRvU2h1dGRvd246ICdOb3RBbGxvd2VkRXJyb3InLFxuICAgICAgICBNZWRpYURldmljZUtpbGxTd2l0Y2hPbjogJ05vdEFsbG93ZWRFcnJvcicsXG4gICAgICAgIFRhYkNhcHR1cmVFcnJvcjogJ0Fib3J0RXJyb3InLFxuICAgICAgICBTY3JlZW5DYXB0dXJlRXJyb3I6ICdBYm9ydEVycm9yJyxcbiAgICAgICAgRGV2aWNlQ2FwdHVyZUVycm9yOiAnQWJvcnRFcnJvcidcbiAgICAgIH1bZS5uYW1lXSB8fCBlLm5hbWUsXG4gICAgICBtZXNzYWdlOiBlLm1lc3NhZ2UsXG4gICAgICBjb25zdHJhaW50OiBlLmNvbnN0cmFpbnQgfHwgZS5jb25zdHJhaW50TmFtZSxcbiAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZSArICh0aGlzLm1lc3NhZ2UgJiYgJzogJykgKyB0aGlzLm1lc3NhZ2U7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcblxuICB2YXIgZ2V0VXNlck1lZGlhXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzLCBvblN1Y2Nlc3MsIG9uRXJyb3IpIHtcbiAgICBzaGltQ29uc3RyYWludHNfKGNvbnN0cmFpbnRzLCBmdW5jdGlvbihjKSB7XG4gICAgICBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKGMsIG9uU3VjY2VzcywgZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgIG9uRXJyb3Ioc2hpbUVycm9yXyhlKSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEgPSBnZXRVc2VyTWVkaWFfO1xuXG4gIC8vIFJldHVybnMgdGhlIHJlc3VsdCBvZiBnZXRVc2VyTWVkaWEgYXMgYSBQcm9taXNlLlxuICB2YXIgZ2V0VXNlck1lZGlhUHJvbWlzZV8gPSBmdW5jdGlvbihjb25zdHJhaW50cykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgfSk7XG4gIH07XG5cbiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKSB7XG4gICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcyA9IHtcbiAgICAgIGdldFVzZXJNZWRpYTogZ2V0VXNlck1lZGlhUHJvbWlzZV8sXG4gICAgICBlbnVtZXJhdGVEZXZpY2VzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICAgICAgICB2YXIga2luZHMgPSB7YXVkaW86ICdhdWRpb2lucHV0JywgdmlkZW86ICd2aWRlb2lucHV0J307XG4gICAgICAgICAgcmV0dXJuIHdpbmRvdy5NZWRpYVN0cmVhbVRyYWNrLmdldFNvdXJjZXMoZnVuY3Rpb24oZGV2aWNlcykge1xuICAgICAgICAgICAgcmVzb2x2ZShkZXZpY2VzLm1hcChmdW5jdGlvbihkZXZpY2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHtsYWJlbDogZGV2aWNlLmxhYmVsLFxuICAgICAgICAgICAgICAgIGtpbmQ6IGtpbmRzW2RldmljZS5raW5kXSxcbiAgICAgICAgICAgICAgICBkZXZpY2VJZDogZGV2aWNlLmlkLFxuICAgICAgICAgICAgICAgIGdyb3VwSWQ6ICcnfTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgZ2V0U3VwcG9ydGVkQ29uc3RyYWludHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGRldmljZUlkOiB0cnVlLCBlY2hvQ2FuY2VsbGF0aW9uOiB0cnVlLCBmYWNpbmdNb2RlOiB0cnVlLFxuICAgICAgICAgIGZyYW1lUmF0ZTogdHJ1ZSwgaGVpZ2h0OiB0cnVlLCB3aWR0aDogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvLyBBIHNoaW0gZm9yIGdldFVzZXJNZWRpYSBtZXRob2Qgb24gdGhlIG1lZGlhRGV2aWNlcyBvYmplY3QuXG4gIC8vIFRPRE8oS2FwdGVuSmFuc3NvbikgcmVtb3ZlIG9uY2UgaW1wbGVtZW50ZWQgaW4gQ2hyb21lIHN0YWJsZS5cbiAgaWYgKCFuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSkge1xuICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY29uc3RyYWludHMpIHtcbiAgICAgIHJldHVybiBnZXRVc2VyTWVkaWFQcm9taXNlXyhjb25zdHJhaW50cyk7XG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICAvLyBFdmVuIHRob3VnaCBDaHJvbWUgNDUgaGFzIG5hdmlnYXRvci5tZWRpYURldmljZXMgYW5kIGEgZ2V0VXNlck1lZGlhXG4gICAgLy8gZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhIFByb21pc2UsIGl0IGRvZXMgbm90IGFjY2VwdCBzcGVjLXN0eWxlXG4gICAgLy8gY29uc3RyYWludHMuXG4gICAgdmFyIG9yaWdHZXRVc2VyTWVkaWEgPSBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYS5cbiAgICAgICAgYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTtcbiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSA9IGZ1bmN0aW9uKGNzKSB7XG4gICAgICByZXR1cm4gc2hpbUNvbnN0cmFpbnRzXyhjcywgZnVuY3Rpb24oYykge1xuICAgICAgICByZXR1cm4gb3JpZ0dldFVzZXJNZWRpYShjKS50aGVuKGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgICAgIGlmIChjLmF1ZGlvICYmICFzdHJlYW0uZ2V0QXVkaW9UcmFja3MoKS5sZW5ndGggfHxcbiAgICAgICAgICAgICAgYy52aWRlbyAmJiAhc3RyZWFtLmdldFZpZGVvVHJhY2tzKCkubGVuZ3RoKSB7XG4gICAgICAgICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0cmFjaykge1xuICAgICAgICAgICAgICB0cmFjay5zdG9wKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oJycsICdOb3RGb3VuZEVycm9yJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBzdHJlYW07XG4gICAgICAgIH0sIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3Qoc2hpbUVycm9yXyhlKSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfVxuXG4gIC8vIER1bW15IGRldmljZWNoYW5nZSBldmVudCBtZXRob2RzLlxuICAvLyBUT0RPKEthcHRlbkphbnNzb24pIHJlbW92ZSBvbmNlIGltcGxlbWVudGVkIGluIENocm9tZSBzdGFibGUuXG4gIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5hZGRFdmVudExpc3RlbmVyID09PSAndW5kZWZpbmVkJykge1xuICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uKCkge1xuICAgICAgbG9nZ2luZygnRHVtbXkgbWVkaWFEZXZpY2VzLmFkZEV2ZW50TGlzdGVuZXIgY2FsbGVkLicpO1xuICAgIH07XG4gIH1cbiAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLnJlbW92ZUV2ZW50TGlzdGVuZXIgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oKSB7XG4gICAgICBsb2dnaW5nKCdEdW1teSBtZWRpYURldmljZXMucmVtb3ZlRXZlbnRMaXN0ZW5lciBjYWxsZWQuJyk7XG4gICAgfTtcbiAgfVxufTtcbiIsIi8qXG4gKiAgQ29weXJpZ2h0IChjKSAyMDE3IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlXG4gKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlXG4gKiAgdHJlZS5cbiAqL1xuIC8qIGVzbGludC1lbnYgbm9kZSAqL1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgU0RQVXRpbHMgPSByZXF1aXJlKCdzZHAnKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vdXRpbHMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHNoaW1SVENJY2VDYW5kaWRhdGU6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIC8vIGZvdW5kYXRpb24gaXMgYXJiaXRyYXJpbHkgY2hvc2VuIGFzIGFuIGluZGljYXRvciBmb3IgZnVsbCBzdXBwb3J0IGZvclxuICAgIC8vIGh0dHBzOi8vdzNjLmdpdGh1Yi5pby93ZWJydGMtcGMvI3J0Y2ljZWNhbmRpZGF0ZS1pbnRlcmZhY2VcbiAgICBpZiAoIXdpbmRvdy5SVENJY2VDYW5kaWRhdGUgfHwgKHdpbmRvdy5SVENJY2VDYW5kaWRhdGUgJiYgJ2ZvdW5kYXRpb24nIGluXG4gICAgICAgIHdpbmRvdy5SVENJY2VDYW5kaWRhdGUucHJvdG90eXBlKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBOYXRpdmVSVENJY2VDYW5kaWRhdGUgPSB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlO1xuICAgIHdpbmRvdy5SVENJY2VDYW5kaWRhdGUgPSBmdW5jdGlvbihhcmdzKSB7XG4gICAgICAvLyBSZW1vdmUgdGhlIGE9IHdoaWNoIHNob3VsZG4ndCBiZSBwYXJ0IG9mIHRoZSBjYW5kaWRhdGUgc3RyaW5nLlxuICAgICAgaWYgKHR5cGVvZiBhcmdzID09PSAnb2JqZWN0JyAmJiBhcmdzLmNhbmRpZGF0ZSAmJlxuICAgICAgICAgIGFyZ3MuY2FuZGlkYXRlLmluZGV4T2YoJ2E9JykgPT09IDApIHtcbiAgICAgICAgYXJncyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXJncykpO1xuICAgICAgICBhcmdzLmNhbmRpZGF0ZSA9IGFyZ3MuY2FuZGlkYXRlLnN1YnN0cigyKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGFyZ3MuY2FuZGlkYXRlICYmIGFyZ3MuY2FuZGlkYXRlLmxlbmd0aCkge1xuICAgICAgICAvLyBBdWdtZW50IHRoZSBuYXRpdmUgY2FuZGlkYXRlIHdpdGggdGhlIHBhcnNlZCBmaWVsZHMuXG4gICAgICAgIHZhciBuYXRpdmVDYW5kaWRhdGUgPSBuZXcgTmF0aXZlUlRDSWNlQ2FuZGlkYXRlKGFyZ3MpO1xuICAgICAgICB2YXIgcGFyc2VkQ2FuZGlkYXRlID0gU0RQVXRpbHMucGFyc2VDYW5kaWRhdGUoYXJncy5jYW5kaWRhdGUpO1xuICAgICAgICB2YXIgYXVnbWVudGVkQ2FuZGlkYXRlID0gT2JqZWN0LmFzc2lnbihuYXRpdmVDYW5kaWRhdGUsXG4gICAgICAgICAgICBwYXJzZWRDYW5kaWRhdGUpO1xuXG4gICAgICAgIC8vIEFkZCBhIHNlcmlhbGl6ZXIgdGhhdCBkb2VzIG5vdCBzZXJpYWxpemUgdGhlIGV4dHJhIGF0dHJpYnV0ZXMuXG4gICAgICAgIGF1Z21lbnRlZENhbmRpZGF0ZS50b0pTT04gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2FuZGlkYXRlOiBhdWdtZW50ZWRDYW5kaWRhdGUuY2FuZGlkYXRlLFxuICAgICAgICAgICAgc2RwTWlkOiBhdWdtZW50ZWRDYW5kaWRhdGUuc2RwTWlkLFxuICAgICAgICAgICAgc2RwTUxpbmVJbmRleDogYXVnbWVudGVkQ2FuZGlkYXRlLnNkcE1MaW5lSW5kZXgsXG4gICAgICAgICAgICB1c2VybmFtZUZyYWdtZW50OiBhdWdtZW50ZWRDYW5kaWRhdGUudXNlcm5hbWVGcmFnbWVudCxcbiAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gYXVnbWVudGVkQ2FuZGlkYXRlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5ldyBOYXRpdmVSVENJY2VDYW5kaWRhdGUoYXJncyk7XG4gICAgfTtcbiAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlLnByb3RvdHlwZSA9IE5hdGl2ZVJUQ0ljZUNhbmRpZGF0ZS5wcm90b3R5cGU7XG5cbiAgICAvLyBIb29rIHVwIHRoZSBhdWdtZW50ZWQgY2FuZGlkYXRlIGluIG9uaWNlY2FuZGlkYXRlIGFuZFxuICAgIC8vIGFkZEV2ZW50TGlzdGVuZXIoJ2ljZWNhbmRpZGF0ZScsIC4uLilcbiAgICB1dGlscy53cmFwUGVlckNvbm5lY3Rpb25FdmVudCh3aW5kb3csICdpY2VjYW5kaWRhdGUnLCBmdW5jdGlvbihlKSB7XG4gICAgICBpZiAoZS5jYW5kaWRhdGUpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsICdjYW5kaWRhdGUnLCB7XG4gICAgICAgICAgdmFsdWU6IG5ldyB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlKGUuY2FuZGlkYXRlKSxcbiAgICAgICAgICB3cml0YWJsZTogJ2ZhbHNlJ1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBlO1xuICAgIH0pO1xuICB9LFxuXG4gIC8vIHNoaW1DcmVhdGVPYmplY3RVUkwgbXVzdCBiZSBjYWxsZWQgYmVmb3JlIHNoaW1Tb3VyY2VPYmplY3QgdG8gYXZvaWQgbG9vcC5cblxuICBzaGltQ3JlYXRlT2JqZWN0VVJMOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICB2YXIgVVJMID0gd2luZG93ICYmIHdpbmRvdy5VUkw7XG5cbiAgICBpZiAoISh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JyAmJiB3aW5kb3cuSFRNTE1lZGlhRWxlbWVudCAmJlxuICAgICAgICAgICdzcmNPYmplY3QnIGluIHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSAmJlxuICAgICAgICBVUkwuY3JlYXRlT2JqZWN0VVJMICYmIFVSTC5yZXZva2VPYmplY3RVUkwpKSB7XG4gICAgICAvLyBPbmx5IHNoaW0gQ3JlYXRlT2JqZWN0VVJMIHVzaW5nIHNyY09iamVjdCBpZiBzcmNPYmplY3QgZXhpc3RzLlxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB2YXIgbmF0aXZlQ3JlYXRlT2JqZWN0VVJMID0gVVJMLmNyZWF0ZU9iamVjdFVSTC5iaW5kKFVSTCk7XG4gICAgdmFyIG5hdGl2ZVJldm9rZU9iamVjdFVSTCA9IFVSTC5yZXZva2VPYmplY3RVUkwuYmluZChVUkwpO1xuICAgIHZhciBzdHJlYW1zID0gbmV3IE1hcCgpLCBuZXdJZCA9IDA7XG5cbiAgICBVUkwuY3JlYXRlT2JqZWN0VVJMID0gZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICBpZiAoJ2dldFRyYWNrcycgaW4gc3RyZWFtKSB7XG4gICAgICAgIHZhciB1cmwgPSAncG9seWJsb2I6JyArICgrK25ld0lkKTtcbiAgICAgICAgc3RyZWFtcy5zZXQodXJsLCBzdHJlYW0pO1xuICAgICAgICB1dGlscy5kZXByZWNhdGVkKCdVUkwuY3JlYXRlT2JqZWN0VVJMKHN0cmVhbSknLFxuICAgICAgICAgICAgJ2VsZW0uc3JjT2JqZWN0ID0gc3RyZWFtJyk7XG4gICAgICAgIHJldHVybiB1cmw7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmF0aXZlQ3JlYXRlT2JqZWN0VVJMKHN0cmVhbSk7XG4gICAgfTtcbiAgICBVUkwucmV2b2tlT2JqZWN0VVJMID0gZnVuY3Rpb24odXJsKSB7XG4gICAgICBuYXRpdmVSZXZva2VPYmplY3RVUkwodXJsKTtcbiAgICAgIHN0cmVhbXMuZGVsZXRlKHVybCk7XG4gICAgfTtcblxuICAgIHZhciBkc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc3JjJyk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5IVE1MTWVkaWFFbGVtZW50LnByb3RvdHlwZSwgJ3NyYycsIHtcbiAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBkc2MuZ2V0LmFwcGx5KHRoaXMpO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24odXJsKSB7XG4gICAgICAgIHRoaXMuc3JjT2JqZWN0ID0gc3RyZWFtcy5nZXQodXJsKSB8fCBudWxsO1xuICAgICAgICByZXR1cm4gZHNjLnNldC5hcHBseSh0aGlzLCBbdXJsXSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB2YXIgbmF0aXZlU2V0QXR0cmlidXRlID0gd2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLnNldEF0dHJpYnV0ZTtcbiAgICB3aW5kb3cuSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUuc2V0QXR0cmlidXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMiAmJlxuICAgICAgICAgICgnJyArIGFyZ3VtZW50c1swXSkudG9Mb3dlckNhc2UoKSA9PT0gJ3NyYycpIHtcbiAgICAgICAgdGhpcy5zcmNPYmplY3QgPSBzdHJlYW1zLmdldChhcmd1bWVudHNbMV0pIHx8IG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmF0aXZlU2V0QXR0cmlidXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfSxcblxuICBzaGltTWF4TWVzc2FnZVNpemU6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIGlmICh3aW5kb3cuUlRDU2N0cFRyYW5zcG9ydCB8fCAhd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBicm93c2VyRGV0YWlscyA9IHV0aWxzLmRldGVjdEJyb3dzZXIod2luZG93KTtcblxuICAgIGlmICghKCdzY3RwJyBpbiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlKSkge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUsICdzY3RwJywge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0eXBlb2YgdGhpcy5fc2N0cCA9PT0gJ3VuZGVmaW5lZCcgPyBudWxsIDogdGhpcy5fc2N0cDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdmFyIHNjdHBJbkRlc2NyaXB0aW9uID0gZnVuY3Rpb24oZGVzY3JpcHRpb24pIHtcbiAgICAgIHZhciBzZWN0aW9ucyA9IFNEUFV0aWxzLnNwbGl0U2VjdGlvbnMoZGVzY3JpcHRpb24uc2RwKTtcbiAgICAgIHNlY3Rpb25zLnNoaWZ0KCk7XG4gICAgICByZXR1cm4gc2VjdGlvbnMuc29tZShmdW5jdGlvbihtZWRpYVNlY3Rpb24pIHtcbiAgICAgICAgdmFyIG1MaW5lID0gU0RQVXRpbHMucGFyc2VNTGluZShtZWRpYVNlY3Rpb24pO1xuICAgICAgICByZXR1cm4gbUxpbmUgJiYgbUxpbmUua2luZCA9PT0gJ2FwcGxpY2F0aW9uJ1xuICAgICAgICAgICAgJiYgbUxpbmUucHJvdG9jb2wuaW5kZXhPZignU0NUUCcpICE9PSAtMTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgZ2V0UmVtb3RlRmlyZWZveFZlcnNpb24gPSBmdW5jdGlvbihkZXNjcmlwdGlvbikge1xuICAgICAgLy8gVE9ETzogSXMgdGhlcmUgYSBiZXR0ZXIgc29sdXRpb24gZm9yIGRldGVjdGluZyBGaXJlZm94P1xuICAgICAgdmFyIG1hdGNoID0gZGVzY3JpcHRpb24uc2RwLm1hdGNoKC9tb3ppbGxhLi4uVEhJU19JU19TRFBBUlRBLShcXGQrKS8pO1xuICAgICAgaWYgKG1hdGNoID09PSBudWxsIHx8IG1hdGNoLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfVxuICAgICAgdmFyIHZlcnNpb24gPSBwYXJzZUludChtYXRjaFsxXSwgMTApO1xuICAgICAgLy8gVGVzdCBmb3IgTmFOICh5ZXMsIHRoaXMgaXMgdWdseSlcbiAgICAgIHJldHVybiB2ZXJzaW9uICE9PSB2ZXJzaW9uID8gLTEgOiB2ZXJzaW9uO1xuICAgIH07XG5cbiAgICB2YXIgZ2V0Q2FuU2VuZE1heE1lc3NhZ2VTaXplID0gZnVuY3Rpb24ocmVtb3RlSXNGaXJlZm94KSB7XG4gICAgICAvLyBFdmVyeSBpbXBsZW1lbnRhdGlvbiB3ZSBrbm93IGNhbiBzZW5kIGF0IGxlYXN0IDY0IEtpQi5cbiAgICAgIC8vIE5vdGU6IEFsdGhvdWdoIENocm9tZSBpcyB0ZWNobmljYWxseSBhYmxlIHRvIHNlbmQgdXAgdG8gMjU2IEtpQiwgdGhlXG4gICAgICAvLyAgICAgICBkYXRhIGRvZXMgbm90IHJlYWNoIHRoZSBvdGhlciBwZWVyIHJlbGlhYmx5LlxuICAgICAgLy8gICAgICAgU2VlOiBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3Avd2VicnRjL2lzc3Vlcy9kZXRhaWw/aWQ9ODQxOVxuICAgICAgdmFyIGNhblNlbmRNYXhNZXNzYWdlU2l6ZSA9IDY1NTM2O1xuICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLmJyb3dzZXIgPT09ICdmaXJlZm94Jykge1xuICAgICAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDU3KSB7XG4gICAgICAgICAgaWYgKHJlbW90ZUlzRmlyZWZveCA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vIEZGIDwgNTcgd2lsbCBzZW5kIGluIDE2IEtpQiBjaHVua3MgdXNpbmcgdGhlIGRlcHJlY2F0ZWQgUFBJRFxuICAgICAgICAgICAgLy8gZnJhZ21lbnRhdGlvbi5cbiAgICAgICAgICAgIGNhblNlbmRNYXhNZXNzYWdlU2l6ZSA9IDE2Mzg0O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBIb3dldmVyLCBvdGhlciBGRiAoYW5kIFJBV1JUQykgY2FuIHJlYXNzZW1ibGUgUFBJRC1mcmFnbWVudGVkXG4gICAgICAgICAgICAvLyBtZXNzYWdlcy4gVGh1cywgc3VwcG9ydGluZyB+MiBHaUIgd2hlbiBzZW5kaW5nLlxuICAgICAgICAgICAgY2FuU2VuZE1heE1lc3NhZ2VTaXplID0gMjE0NzQ4MzYzNztcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDYwKSB7XG4gICAgICAgICAgLy8gQ3VycmVudGx5LCBhbGwgRkYgPj0gNTcgd2lsbCByZXNldCB0aGUgcmVtb3RlIG1heGltdW0gbWVzc2FnZSBzaXplXG4gICAgICAgICAgLy8gdG8gdGhlIGRlZmF1bHQgdmFsdWUgd2hlbiBhIGRhdGEgY2hhbm5lbCBpcyBjcmVhdGVkIGF0IGEgbGF0ZXJcbiAgICAgICAgICAvLyBzdGFnZS4gOihcbiAgICAgICAgICAvLyBTZWU6IGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTE0MjY4MzFcbiAgICAgICAgICBjYW5TZW5kTWF4TWVzc2FnZVNpemUgPVxuICAgICAgICAgICAgYnJvd3NlckRldGFpbHMudmVyc2lvbiA9PT0gNTcgPyA2NTUzNSA6IDY1NTM2O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEZGID49IDYwIHN1cHBvcnRzIHNlbmRpbmcgfjIgR2lCXG4gICAgICAgICAgY2FuU2VuZE1heE1lc3NhZ2VTaXplID0gMjE0NzQ4MzYzNztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGNhblNlbmRNYXhNZXNzYWdlU2l6ZTtcbiAgICB9O1xuXG4gICAgdmFyIGdldE1heE1lc3NhZ2VTaXplID0gZnVuY3Rpb24oZGVzY3JpcHRpb24sIHJlbW90ZUlzRmlyZWZveCkge1xuICAgICAgLy8gTm90ZTogNjU1MzYgYnl0ZXMgaXMgdGhlIGRlZmF1bHQgdmFsdWUgZnJvbSB0aGUgU0RQIHNwZWMuIEFsc28sXG4gICAgICAvLyAgICAgICBldmVyeSBpbXBsZW1lbnRhdGlvbiB3ZSBrbm93IHN1cHBvcnRzIHJlY2VpdmluZyA2NTUzNiBieXRlcy5cbiAgICAgIHZhciBtYXhNZXNzYWdlU2l6ZSA9IDY1NTM2O1xuXG4gICAgICAvLyBGRiA1NyBoYXMgYSBzbGlnaHRseSBpbmNvcnJlY3QgZGVmYXVsdCByZW1vdGUgbWF4IG1lc3NhZ2Ugc2l6ZSwgc29cbiAgICAgIC8vIHdlIG5lZWQgdG8gYWRqdXN0IGl0IGhlcmUgdG8gYXZvaWQgYSBmYWlsdXJlIHdoZW4gc2VuZGluZy5cbiAgICAgIC8vIFNlZTogaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTQyNTY5N1xuICAgICAgaWYgKGJyb3dzZXJEZXRhaWxzLmJyb3dzZXIgPT09ICdmaXJlZm94J1xuICAgICAgICAgICAmJiBicm93c2VyRGV0YWlscy52ZXJzaW9uID09PSA1Nykge1xuICAgICAgICBtYXhNZXNzYWdlU2l6ZSA9IDY1NTM1O1xuICAgICAgfVxuXG4gICAgICB2YXIgbWF0Y2ggPSBTRFBVdGlscy5tYXRjaFByZWZpeChkZXNjcmlwdGlvbi5zZHAsICdhPW1heC1tZXNzYWdlLXNpemU6Jyk7XG4gICAgICBpZiAobWF0Y2gubGVuZ3RoID4gMCkge1xuICAgICAgICBtYXhNZXNzYWdlU2l6ZSA9IHBhcnNlSW50KG1hdGNoWzBdLnN1YnN0cigxOSksIDEwKTtcbiAgICAgIH0gZWxzZSBpZiAoYnJvd3NlckRldGFpbHMuYnJvd3NlciA9PT0gJ2ZpcmVmb3gnICYmXG4gICAgICAgICAgICAgICAgICByZW1vdGVJc0ZpcmVmb3ggIT09IC0xKSB7XG4gICAgICAgIC8vIElmIHRoZSBtYXhpbXVtIG1lc3NhZ2Ugc2l6ZSBpcyBub3QgcHJlc2VudCBpbiB0aGUgcmVtb3RlIFNEUCBhbmRcbiAgICAgICAgLy8gYm90aCBsb2NhbCBhbmQgcmVtb3RlIGFyZSBGaXJlZm94LCB0aGUgcmVtb3RlIHBlZXIgY2FuIHJlY2VpdmVcbiAgICAgICAgLy8gfjIgR2lCLlxuICAgICAgICBtYXhNZXNzYWdlU2l6ZSA9IDIxNDc0ODM2Mzc7XG4gICAgICB9XG4gICAgICByZXR1cm4gbWF4TWVzc2FnZVNpemU7XG4gICAgfTtcblxuICAgIHZhciBvcmlnU2V0UmVtb3RlRGVzY3JpcHRpb24gPVxuICAgICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLnNldFJlbW90ZURlc2NyaXB0aW9uO1xuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuc2V0UmVtb3RlRGVzY3JpcHRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICBwYy5fc2N0cCA9IG51bGw7XG5cbiAgICAgIGlmIChzY3RwSW5EZXNjcmlwdGlvbihhcmd1bWVudHNbMF0pKSB7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSByZW1vdGUgaXMgRkYuXG4gICAgICAgIHZhciBpc0ZpcmVmb3ggPSBnZXRSZW1vdGVGaXJlZm94VmVyc2lvbihhcmd1bWVudHNbMF0pO1xuXG4gICAgICAgIC8vIEdldCB0aGUgbWF4aW11bSBtZXNzYWdlIHNpemUgdGhlIGxvY2FsIHBlZXIgaXMgY2FwYWJsZSBvZiBzZW5kaW5nXG4gICAgICAgIHZhciBjYW5TZW5kTU1TID0gZ2V0Q2FuU2VuZE1heE1lc3NhZ2VTaXplKGlzRmlyZWZveCk7XG5cbiAgICAgICAgLy8gR2V0IHRoZSBtYXhpbXVtIG1lc3NhZ2Ugc2l6ZSBvZiB0aGUgcmVtb3RlIHBlZXIuXG4gICAgICAgIHZhciByZW1vdGVNTVMgPSBnZXRNYXhNZXNzYWdlU2l6ZShhcmd1bWVudHNbMF0sIGlzRmlyZWZveCk7XG5cbiAgICAgICAgLy8gRGV0ZXJtaW5lIGZpbmFsIG1heGltdW0gbWVzc2FnZSBzaXplXG4gICAgICAgIHZhciBtYXhNZXNzYWdlU2l6ZTtcbiAgICAgICAgaWYgKGNhblNlbmRNTVMgPT09IDAgJiYgcmVtb3RlTU1TID09PSAwKSB7XG4gICAgICAgICAgbWF4TWVzc2FnZVNpemUgPSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFk7XG4gICAgICAgIH0gZWxzZSBpZiAoY2FuU2VuZE1NUyA9PT0gMCB8fCByZW1vdGVNTVMgPT09IDApIHtcbiAgICAgICAgICBtYXhNZXNzYWdlU2l6ZSA9IE1hdGgubWF4KGNhblNlbmRNTVMsIHJlbW90ZU1NUyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbWF4TWVzc2FnZVNpemUgPSBNYXRoLm1pbihjYW5TZW5kTU1TLCByZW1vdGVNTVMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ3JlYXRlIGEgZHVtbXkgUlRDU2N0cFRyYW5zcG9ydCBvYmplY3QgYW5kIHRoZSAnbWF4TWVzc2FnZVNpemUnXG4gICAgICAgIC8vIGF0dHJpYnV0ZS5cbiAgICAgICAgdmFyIHNjdHAgPSB7fTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNjdHAsICdtYXhNZXNzYWdlU2l6ZScsIHtcbiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIG1heE1lc3NhZ2VTaXplO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHBjLl9zY3RwID0gc2N0cDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG9yaWdTZXRSZW1vdGVEZXNjcmlwdGlvbi5hcHBseShwYywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9LFxuXG4gIHNoaW1TZW5kVGhyb3dUeXBlRXJyb3I6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIGlmICghKHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiAmJlxuICAgICAgICAnY3JlYXRlRGF0YUNoYW5uZWwnIGluIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gTm90ZTogQWx0aG91Z2ggRmlyZWZveCA+PSA1NyBoYXMgYSBuYXRpdmUgaW1wbGVtZW50YXRpb24sIHRoZSBtYXhpbXVtXG4gICAgLy8gICAgICAgbWVzc2FnZSBzaXplIGNhbiBiZSByZXNldCBmb3IgYWxsIGRhdGEgY2hhbm5lbHMgYXQgYSBsYXRlciBzdGFnZS5cbiAgICAvLyAgICAgICBTZWU6IGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTE0MjY4MzFcblxuICAgIGZ1bmN0aW9uIHdyYXBEY1NlbmQoZGMsIHBjKSB7XG4gICAgICB2YXIgb3JpZ0RhdGFDaGFubmVsU2VuZCA9IGRjLnNlbmQ7XG4gICAgICBkYy5zZW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBkYXRhID0gYXJndW1lbnRzWzBdO1xuICAgICAgICB2YXIgbGVuZ3RoID0gZGF0YS5sZW5ndGggfHwgZGF0YS5zaXplIHx8IGRhdGEuYnl0ZUxlbmd0aDtcbiAgICAgICAgaWYgKGRjLnJlYWR5U3RhdGUgPT09ICdvcGVuJyAmJlxuICAgICAgICAgICAgcGMuc2N0cCAmJiBsZW5ndGggPiBwYy5zY3RwLm1heE1lc3NhZ2VTaXplKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignTWVzc2FnZSB0b28gbGFyZ2UgKGNhbiBzZW5kIGEgbWF4aW11bSBvZiAnICtcbiAgICAgICAgICAgIHBjLnNjdHAubWF4TWVzc2FnZVNpemUgKyAnIGJ5dGVzKScpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvcmlnRGF0YUNoYW5uZWxTZW5kLmFwcGx5KGRjLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9XG4gICAgdmFyIG9yaWdDcmVhdGVEYXRhQ2hhbm5lbCA9XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmNyZWF0ZURhdGFDaGFubmVsO1xuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY3JlYXRlRGF0YUNoYW5uZWwgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICB2YXIgZGF0YUNoYW5uZWwgPSBvcmlnQ3JlYXRlRGF0YUNoYW5uZWwuYXBwbHkocGMsIGFyZ3VtZW50cyk7XG4gICAgICB3cmFwRGNTZW5kKGRhdGFDaGFubmVsLCBwYyk7XG4gICAgICByZXR1cm4gZGF0YUNoYW5uZWw7XG4gICAgfTtcbiAgICB1dGlscy53cmFwUGVlckNvbm5lY3Rpb25FdmVudCh3aW5kb3csICdkYXRhY2hhbm5lbCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIHdyYXBEY1NlbmQoZS5jaGFubmVsLCBlLnRhcmdldCk7XG4gICAgICByZXR1cm4gZTtcbiAgICB9KTtcbiAgfVxufTtcbiIsIi8qXG4gKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlXG4gKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlXG4gKiAgdHJlZS5cbiAqL1xuIC8qIGVzbGludC1lbnYgbm9kZSAqL1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLi91dGlscycpO1xudmFyIGZpbHRlckljZVNlcnZlcnMgPSByZXF1aXJlKCcuL2ZpbHRlcmljZXNlcnZlcnMnKTtcbnZhciBzaGltUlRDUGVlckNvbm5lY3Rpb24gPSByZXF1aXJlKCdydGNwZWVyY29ubmVjdGlvbi1zaGltJyk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBzaGltR2V0VXNlck1lZGlhOiByZXF1aXJlKCcuL2dldHVzZXJtZWRpYScpLFxuICBzaGltUGVlckNvbm5lY3Rpb246IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIHZhciBicm93c2VyRGV0YWlscyA9IHV0aWxzLmRldGVjdEJyb3dzZXIod2luZG93KTtcblxuICAgIGlmICh3aW5kb3cuUlRDSWNlR2F0aGVyZXIpIHtcbiAgICAgIGlmICghd2luZG93LlJUQ0ljZUNhbmRpZGF0ZSkge1xuICAgICAgICB3aW5kb3cuUlRDSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oYXJncykge1xuICAgICAgICAgIHJldHVybiBhcmdzO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgaWYgKCF3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uKSB7XG4gICAgICAgIHdpbmRvdy5SVENTZXNzaW9uRGVzY3JpcHRpb24gPSBmdW5jdGlvbihhcmdzKSB7XG4gICAgICAgICAgcmV0dXJuIGFyZ3M7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICAvLyB0aGlzIGFkZHMgYW4gYWRkaXRpb25hbCBldmVudCBsaXN0ZW5lciB0byBNZWRpYVN0cmFja1RyYWNrIHRoYXQgc2lnbmFsc1xuICAgICAgLy8gd2hlbiBhIHRyYWNrcyBlbmFibGVkIHByb3BlcnR5IHdhcyBjaGFuZ2VkLiBXb3JrYXJvdW5kIGZvciBhIGJ1ZyBpblxuICAgICAgLy8gYWRkU3RyZWFtLCBzZWUgYmVsb3cuIE5vIGxvbmdlciByZXF1aXJlZCBpbiAxNTAyNStcbiAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgMTUwMjUpIHtcbiAgICAgICAgdmFyIG9yaWdNU1RFbmFibGVkID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihcbiAgICAgICAgICAgIHdpbmRvdy5NZWRpYVN0cmVhbVRyYWNrLnByb3RvdHlwZSwgJ2VuYWJsZWQnKTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5NZWRpYVN0cmVhbVRyYWNrLnByb3RvdHlwZSwgJ2VuYWJsZWQnLCB7XG4gICAgICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgb3JpZ01TVEVuYWJsZWQuc2V0LmNhbGwodGhpcywgdmFsdWUpO1xuICAgICAgICAgICAgdmFyIGV2ID0gbmV3IEV2ZW50KCdlbmFibGVkJyk7XG4gICAgICAgICAgICBldi5lbmFibGVkID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gT1JUQyBkZWZpbmVzIHRoZSBEVE1GIHNlbmRlciBhIGJpdCBkaWZmZXJlbnQuXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3czYy9vcnRjL2lzc3Vlcy83MTRcbiAgICBpZiAod2luZG93LlJUQ1J0cFNlbmRlciAmJiAhKCdkdG1mJyBpbiB3aW5kb3cuUlRDUnRwU2VuZGVyLnByb3RvdHlwZSkpIHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUnRwU2VuZGVyLnByb3RvdHlwZSwgJ2R0bWYnLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHRoaXMuX2R0bWYgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMudHJhY2sua2luZCA9PT0gJ2F1ZGlvJykge1xuICAgICAgICAgICAgICB0aGlzLl9kdG1mID0gbmV3IHdpbmRvdy5SVENEdG1mU2VuZGVyKHRoaXMpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRyYWNrLmtpbmQgPT09ICd2aWRlbycpIHtcbiAgICAgICAgICAgICAgdGhpcy5fZHRtZiA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aGlzLl9kdG1mO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgLy8gRWRnZSBjdXJyZW50bHkgb25seSBpbXBsZW1lbnRzIHRoZSBSVENEdG1mU2VuZGVyLCBub3QgdGhlXG4gICAgLy8gUlRDRFRNRlNlbmRlciBhbGlhcy4gU2VlIGh0dHA6Ly9kcmFmdC5vcnRjLm9yZy8jcnRjZHRtZnNlbmRlcjIqXG4gICAgaWYgKHdpbmRvdy5SVENEdG1mU2VuZGVyICYmICF3aW5kb3cuUlRDRFRNRlNlbmRlcikge1xuICAgICAgd2luZG93LlJUQ0RUTUZTZW5kZXIgPSB3aW5kb3cuUlRDRHRtZlNlbmRlcjtcbiAgICB9XG5cbiAgICB2YXIgUlRDUGVlckNvbm5lY3Rpb25TaGltID0gc2hpbVJUQ1BlZXJDb25uZWN0aW9uKHdpbmRvdyxcbiAgICAgICAgYnJvd3NlckRldGFpbHMudmVyc2lvbik7XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uID0gZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICBpZiAoY29uZmlnICYmIGNvbmZpZy5pY2VTZXJ2ZXJzKSB7XG4gICAgICAgIGNvbmZpZy5pY2VTZXJ2ZXJzID0gZmlsdGVySWNlU2VydmVycyhjb25maWcuaWNlU2VydmVycyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3IFJUQ1BlZXJDb25uZWN0aW9uU2hpbShjb25maWcpO1xuICAgIH07XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSA9IFJUQ1BlZXJDb25uZWN0aW9uU2hpbS5wcm90b3R5cGU7XG4gIH0sXG4gIHNoaW1SZXBsYWNlVHJhY2s6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIC8vIE9SVEMgaGFzIHJlcGxhY2VUcmFjayAtLSBodHRwczovL2dpdGh1Yi5jb20vdzNjL29ydGMvaXNzdWVzLzYxNFxuICAgIGlmICh3aW5kb3cuUlRDUnRwU2VuZGVyICYmXG4gICAgICAgICEoJ3JlcGxhY2VUcmFjaycgaW4gd2luZG93LlJUQ1J0cFNlbmRlci5wcm90b3R5cGUpKSB7XG4gICAgICB3aW5kb3cuUlRDUnRwU2VuZGVyLnByb3RvdHlwZS5yZXBsYWNlVHJhY2sgPVxuICAgICAgICAgIHdpbmRvdy5SVENSdHBTZW5kZXIucHJvdG90eXBlLnNldFRyYWNrO1xuICAgIH1cbiAgfSxcbiAgc2hpbUdldERpc3BsYXlNZWRpYTogZnVuY3Rpb24od2luZG93LCBwcmVmZXJyZWRNZWRpYVNvdXJjZSkge1xuICAgIGlmICghKCdnZXREaXNwbGF5TWVkaWEnIGluIHdpbmRvdy5uYXZpZ2F0b3IpIHx8XG4gICAgICAgICF3aW5kb3cubmF2aWdhdG9yLm1lZGlhRGV2aWNlcyB8fFxuICAgICAgICAnZ2V0RGlzcGxheU1lZGlhJyBpbiB3aW5kb3cubmF2aWdhdG9yLm1lZGlhRGV2aWNlcykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgb3JpZ0dldERpc3BsYXlNZWRpYSA9IHdpbmRvdy5uYXZpZ2F0b3IuZ2V0RGlzcGxheU1lZGlhO1xuICAgIHdpbmRvdy5uYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldERpc3BsYXlNZWRpYSA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7XG4gICAgICByZXR1cm4gb3JpZ0dldERpc3BsYXlNZWRpYS5jYWxsKHdpbmRvdy5uYXZpZ2F0b3IsIGNvbnN0cmFpbnRzKTtcbiAgICB9O1xuICAgIHdpbmRvdy5uYXZpZ2F0b3IuZ2V0RGlzcGxheU1lZGlhID0gZnVuY3Rpb24oY29uc3RyYWludHMpIHtcbiAgICAgIHV0aWxzLmRlcHJlY2F0ZWQoJ25hdmlnYXRvci5nZXREaXNwbGF5TWVkaWEnLFxuICAgICAgICAgICduYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldERpc3BsYXlNZWRpYScpO1xuICAgICAgcmV0dXJuIG9yaWdHZXREaXNwbGF5TWVkaWEuY2FsbCh3aW5kb3cubmF2aWdhdG9yLCBjb25zdHJhaW50cyk7XG4gICAgfTtcbiAgfVxufTtcbiIsIi8qXG4gKiAgQ29weXJpZ2h0IChjKSAyMDE4IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlXG4gKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlXG4gKiAgdHJlZS5cbiAqL1xuIC8qIGVzbGludC1lbnYgbm9kZSAqL1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLi91dGlscycpO1xuLy8gRWRnZSBkb2VzIG5vdCBsaWtlXG4vLyAxKSBzdHVuOiBmaWx0ZXJlZCBhZnRlciAxNDM5MyB1bmxlc3MgP3RyYW5zcG9ydD11ZHAgaXMgcHJlc2VudFxuLy8gMikgdHVybjogdGhhdCBkb2VzIG5vdCBoYXZlIGFsbCBvZiB0dXJuOmhvc3Q6cG9ydD90cmFuc3BvcnQ9dWRwXG4vLyAzKSB0dXJuOiB3aXRoIGlwdjYgYWRkcmVzc2VzXG4vLyA0KSB0dXJuOiBvY2N1cnJpbmcgbXVsaXBsZSB0aW1lc1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpY2VTZXJ2ZXJzLCBlZGdlVmVyc2lvbikge1xuICB2YXIgaGFzVHVybiA9IGZhbHNlO1xuICBpY2VTZXJ2ZXJzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShpY2VTZXJ2ZXJzKSk7XG4gIHJldHVybiBpY2VTZXJ2ZXJzLmZpbHRlcihmdW5jdGlvbihzZXJ2ZXIpIHtcbiAgICBpZiAoc2VydmVyICYmIChzZXJ2ZXIudXJscyB8fCBzZXJ2ZXIudXJsKSkge1xuICAgICAgdmFyIHVybHMgPSBzZXJ2ZXIudXJscyB8fCBzZXJ2ZXIudXJsO1xuICAgICAgaWYgKHNlcnZlci51cmwgJiYgIXNlcnZlci51cmxzKSB7XG4gICAgICAgIHV0aWxzLmRlcHJlY2F0ZWQoJ1JUQ0ljZVNlcnZlci51cmwnLCAnUlRDSWNlU2VydmVyLnVybHMnKTtcbiAgICAgIH1cbiAgICAgIHZhciBpc1N0cmluZyA9IHR5cGVvZiB1cmxzID09PSAnc3RyaW5nJztcbiAgICAgIGlmIChpc1N0cmluZykge1xuICAgICAgICB1cmxzID0gW3VybHNdO1xuICAgICAgfVxuICAgICAgdXJscyA9IHVybHMuZmlsdGVyKGZ1bmN0aW9uKHVybCkge1xuICAgICAgICB2YXIgdmFsaWRUdXJuID0gdXJsLmluZGV4T2YoJ3R1cm46JykgPT09IDAgJiZcbiAgICAgICAgICAgIHVybC5pbmRleE9mKCd0cmFuc3BvcnQ9dWRwJykgIT09IC0xICYmXG4gICAgICAgICAgICB1cmwuaW5kZXhPZigndHVybjpbJykgPT09IC0xICYmXG4gICAgICAgICAgICAhaGFzVHVybjtcblxuICAgICAgICBpZiAodmFsaWRUdXJuKSB7XG4gICAgICAgICAgaGFzVHVybiA9IHRydWU7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVybC5pbmRleE9mKCdzdHVuOicpID09PSAwICYmIGVkZ2VWZXJzaW9uID49IDE0MzkzICYmXG4gICAgICAgICAgICB1cmwuaW5kZXhPZignP3RyYW5zcG9ydD11ZHAnKSA9PT0gLTE7XG4gICAgICB9KTtcblxuICAgICAgZGVsZXRlIHNlcnZlci51cmw7XG4gICAgICBzZXJ2ZXIudXJscyA9IGlzU3RyaW5nID8gdXJsc1swXSA6IHVybHM7XG4gICAgICByZXR1cm4gISF1cmxzLmxlbmd0aDtcbiAgICB9XG4gIH0pO1xufTtcbiIsIi8qXG4gKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlXG4gKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlXG4gKiAgdHJlZS5cbiAqL1xuIC8qIGVzbGludC1lbnYgbm9kZSAqL1xuJ3VzZSBzdHJpY3QnO1xuXG4vLyBFeHBvc2UgcHVibGljIG1ldGhvZHMuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHdpbmRvdykge1xuICB2YXIgbmF2aWdhdG9yID0gd2luZG93ICYmIHdpbmRvdy5uYXZpZ2F0b3I7XG5cbiAgdmFyIHNoaW1FcnJvcl8gPSBmdW5jdGlvbihlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHtQZXJtaXNzaW9uRGVuaWVkRXJyb3I6ICdOb3RBbGxvd2VkRXJyb3InfVtlLm5hbWVdIHx8IGUubmFtZSxcbiAgICAgIG1lc3NhZ2U6IGUubWVzc2FnZSxcbiAgICAgIGNvbnN0cmFpbnQ6IGUuY29uc3RyYWludCxcbiAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuXG4gIC8vIGdldFVzZXJNZWRpYSBlcnJvciBzaGltLlxuICB2YXIgb3JpZ0dldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhLlxuICAgICAgYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTtcbiAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjKSB7XG4gICAgcmV0dXJuIG9yaWdHZXRVc2VyTWVkaWEoYykuY2F0Y2goZnVuY3Rpb24oZSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHNoaW1FcnJvcl8oZSkpO1xuICAgIH0pO1xuICB9O1xufTtcbiIsIi8qXG4gKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlXG4gKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlXG4gKiAgdHJlZS5cbiAqL1xuIC8qIGVzbGludC1lbnYgbm9kZSAqL1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLi91dGlscycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgc2hpbUdldFVzZXJNZWRpYTogcmVxdWlyZSgnLi9nZXR1c2VybWVkaWEnKSxcbiAgc2hpbU9uVHJhY2s6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JyAmJiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gJiYgISgnb250cmFjaycgaW5cbiAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLCAnb250cmFjaycsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fb250cmFjaztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbihmKSB7XG4gICAgICAgICAgaWYgKHRoaXMuX29udHJhY2spIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigndHJhY2snLCB0aGlzLl9vbnRyYWNrKTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignYWRkc3RyZWFtJywgdGhpcy5fb250cmFja3BvbHkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYWNrJywgdGhpcy5fb250cmFjayA9IGYpO1xuICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcignYWRkc3RyZWFtJywgdGhpcy5fb250cmFja3BvbHkgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBlLnN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7XG4gICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgndHJhY2snKTtcbiAgICAgICAgICAgICAgZXZlbnQudHJhY2sgPSB0cmFjaztcbiAgICAgICAgICAgICAgZXZlbnQucmVjZWl2ZXIgPSB7dHJhY2s6IHRyYWNrfTtcbiAgICAgICAgICAgICAgZXZlbnQudHJhbnNjZWl2ZXIgPSB7cmVjZWl2ZXI6IGV2ZW50LnJlY2VpdmVyfTtcbiAgICAgICAgICAgICAgZXZlbnQuc3RyZWFtcyA9IFtlLnN0cmVhbV07XG4gICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JyAmJiB3aW5kb3cuUlRDVHJhY2tFdmVudCAmJlxuICAgICAgICAoJ3JlY2VpdmVyJyBpbiB3aW5kb3cuUlRDVHJhY2tFdmVudC5wcm90b3R5cGUpICYmXG4gICAgICAgICEoJ3RyYW5zY2VpdmVyJyBpbiB3aW5kb3cuUlRDVHJhY2tFdmVudC5wcm90b3R5cGUpKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LlJUQ1RyYWNrRXZlbnQucHJvdG90eXBlLCAndHJhbnNjZWl2ZXInLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHtyZWNlaXZlcjogdGhpcy5yZWNlaXZlcn07XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSxcblxuICBzaGltU291cmNlT2JqZWN0OiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICAvLyBGaXJlZm94IGhhcyBzdXBwb3J0ZWQgbW96U3JjT2JqZWN0IHNpbmNlIEZGMjIsIHVucHJlZml4ZWQgaW4gNDIuXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSB7XG4gICAgICBpZiAod2luZG93LkhUTUxNZWRpYUVsZW1lbnQgJiZcbiAgICAgICAgISgnc3JjT2JqZWN0JyBpbiB3aW5kb3cuSFRNTE1lZGlhRWxlbWVudC5wcm90b3R5cGUpKSB7XG4gICAgICAgIC8vIFNoaW0gdGhlIHNyY09iamVjdCBwcm9wZXJ0eSwgb25jZSwgd2hlbiBIVE1MTWVkaWFFbGVtZW50IGlzIGZvdW5kLlxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LkhUTUxNZWRpYUVsZW1lbnQucHJvdG90eXBlLCAnc3JjT2JqZWN0Jywge1xuICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tb3pTcmNPYmplY3Q7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBzZXQ6IGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgICAgICAgdGhpcy5tb3pTcmNPYmplY3QgPSBzdHJlYW07XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgc2hpbVBlZXJDb25uZWN0aW9uOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICB2YXIgYnJvd3NlckRldGFpbHMgPSB1dGlscy5kZXRlY3RCcm93c2VyKHdpbmRvdyk7XG5cbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ29iamVjdCcgfHwgISh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gfHxcbiAgICAgICAgd2luZG93Lm1velJUQ1BlZXJDb25uZWN0aW9uKSkge1xuICAgICAgcmV0dXJuOyAvLyBwcm9iYWJseSBtZWRpYS5wZWVyY29ubmVjdGlvbi5lbmFibGVkPWZhbHNlIGluIGFib3V0OmNvbmZpZ1xuICAgIH1cbiAgICAvLyBUaGUgUlRDUGVlckNvbm5lY3Rpb24gb2JqZWN0LlxuICAgIGlmICghd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uKSB7XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gPSBmdW5jdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cykge1xuICAgICAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDM4KSB7XG4gICAgICAgICAgLy8gLnVybHMgaXMgbm90IHN1cHBvcnRlZCBpbiBGRiA8IDM4LlxuICAgICAgICAgIC8vIGNyZWF0ZSBSVENJY2VTZXJ2ZXJzIHdpdGggYSBzaW5nbGUgdXJsLlxuICAgICAgICAgIGlmIChwY0NvbmZpZyAmJiBwY0NvbmZpZy5pY2VTZXJ2ZXJzKSB7XG4gICAgICAgICAgICB2YXIgbmV3SWNlU2VydmVycyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwY0NvbmZpZy5pY2VTZXJ2ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgIHZhciBzZXJ2ZXIgPSBwY0NvbmZpZy5pY2VTZXJ2ZXJzW2ldO1xuICAgICAgICAgICAgICBpZiAoc2VydmVyLmhhc093blByb3BlcnR5KCd1cmxzJykpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlcnZlci51cmxzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgbmV3U2VydmVyID0ge1xuICAgICAgICAgICAgICAgICAgICB1cmw6IHNlcnZlci51cmxzW2pdXG4gICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgaWYgKHNlcnZlci51cmxzW2pdLmluZGV4T2YoJ3R1cm4nKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdTZXJ2ZXIudXNlcm5hbWUgPSBzZXJ2ZXIudXNlcm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIG5ld1NlcnZlci5jcmVkZW50aWFsID0gc2VydmVyLmNyZWRlbnRpYWw7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBuZXdJY2VTZXJ2ZXJzLnB1c2gobmV3U2VydmVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3SWNlU2VydmVycy5wdXNoKHBjQ29uZmlnLmljZVNlcnZlcnNbaV0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwY0NvbmZpZy5pY2VTZXJ2ZXJzID0gbmV3SWNlU2VydmVycztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyB3aW5kb3cubW96UlRDUGVlckNvbm5lY3Rpb24ocGNDb25maWcsIHBjQ29uc3RyYWludHMpO1xuICAgICAgfTtcbiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUgPVxuICAgICAgICAgIHdpbmRvdy5tb3pSVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGU7XG5cbiAgICAgIC8vIHdyYXAgc3RhdGljIG1ldGhvZHMuIEN1cnJlbnRseSBqdXN0IGdlbmVyYXRlQ2VydGlmaWNhdGUuXG4gICAgICBpZiAod2luZG93Lm1velJUQ1BlZXJDb25uZWN0aW9uLmdlbmVyYXRlQ2VydGlmaWNhdGUpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbiwgJ2dlbmVyYXRlQ2VydGlmaWNhdGUnLCB7XG4gICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cubW96UlRDUGVlckNvbm5lY3Rpb24uZ2VuZXJhdGVDZXJ0aWZpY2F0ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB3aW5kb3cuUlRDU2Vzc2lvbkRlc2NyaXB0aW9uID0gd2luZG93Lm1velJUQ1Nlc3Npb25EZXNjcmlwdGlvbjtcbiAgICAgIHdpbmRvdy5SVENJY2VDYW5kaWRhdGUgPSB3aW5kb3cubW96UlRDSWNlQ2FuZGlkYXRlO1xuICAgIH1cblxuICAgIC8vIHNoaW0gYXdheSBuZWVkIGZvciBvYnNvbGV0ZSBSVENJY2VDYW5kaWRhdGUvUlRDU2Vzc2lvbkRlc2NyaXB0aW9uLlxuICAgIFsnc2V0TG9jYWxEZXNjcmlwdGlvbicsICdzZXRSZW1vdGVEZXNjcmlwdGlvbicsICdhZGRJY2VDYW5kaWRhdGUnXVxuICAgICAgICAuZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHtcbiAgICAgICAgICB2YXIgbmF0aXZlTWV0aG9kID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZVttZXRob2RdO1xuICAgICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgYXJndW1lbnRzWzBdID0gbmV3ICgobWV0aG9kID09PSAnYWRkSWNlQ2FuZGlkYXRlJykgP1xuICAgICAgICAgICAgICAgIHdpbmRvdy5SVENJY2VDYW5kaWRhdGUgOlxuICAgICAgICAgICAgICAgIHdpbmRvdy5SVENTZXNzaW9uRGVzY3JpcHRpb24pKGFyZ3VtZW50c1swXSk7XG4gICAgICAgICAgICByZXR1cm4gbmF0aXZlTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAvLyBzdXBwb3J0IGZvciBhZGRJY2VDYW5kaWRhdGUobnVsbCBvciB1bmRlZmluZWQpXG4gICAgdmFyIG5hdGl2ZUFkZEljZUNhbmRpZGF0ZSA9XG4gICAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlO1xuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkSWNlQ2FuZGlkYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoIWFyZ3VtZW50c1swXSkge1xuICAgICAgICBpZiAoYXJndW1lbnRzWzFdKSB7XG4gICAgICAgICAgYXJndW1lbnRzWzFdLmFwcGx5KG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuYXRpdmVBZGRJY2VDYW5kaWRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuXG4gICAgLy8gc2hpbSBnZXRTdGF0cyB3aXRoIG1hcGxpa2Ugc3VwcG9ydFxuICAgIHZhciBtYWtlTWFwU3RhdHMgPSBmdW5jdGlvbihzdGF0cykge1xuICAgICAgdmFyIG1hcCA9IG5ldyBNYXAoKTtcbiAgICAgIE9iamVjdC5rZXlzKHN0YXRzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICBtYXAuc2V0KGtleSwgc3RhdHNba2V5XSk7XG4gICAgICAgIG1hcFtrZXldID0gc3RhdHNba2V5XTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG1hcDtcbiAgICB9O1xuXG4gICAgdmFyIG1vZGVyblN0YXRzVHlwZXMgPSB7XG4gICAgICBpbmJvdW5kcnRwOiAnaW5ib3VuZC1ydHAnLFxuICAgICAgb3V0Ym91bmRydHA6ICdvdXRib3VuZC1ydHAnLFxuICAgICAgY2FuZGlkYXRlcGFpcjogJ2NhbmRpZGF0ZS1wYWlyJyxcbiAgICAgIGxvY2FsY2FuZGlkYXRlOiAnbG9jYWwtY2FuZGlkYXRlJyxcbiAgICAgIHJlbW90ZWNhbmRpZGF0ZTogJ3JlbW90ZS1jYW5kaWRhdGUnXG4gICAgfTtcblxuICAgIHZhciBuYXRpdmVHZXRTdGF0cyA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHM7XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRTdGF0cyA9IGZ1bmN0aW9uKFxuICAgICAgc2VsZWN0b3IsXG4gICAgICBvblN1Y2MsXG4gICAgICBvbkVyclxuICAgICkge1xuICAgICAgcmV0dXJuIG5hdGl2ZUdldFN0YXRzLmFwcGx5KHRoaXMsIFtzZWxlY3RvciB8fCBudWxsXSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oc3RhdHMpIHtcbiAgICAgICAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDQ4KSB7XG4gICAgICAgICAgICBzdGF0cyA9IG1ha2VNYXBTdGF0cyhzdGF0cyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNTMgJiYgIW9uU3VjYykge1xuICAgICAgICAgICAgLy8gU2hpbSBvbmx5IHByb21pc2UgZ2V0U3RhdHMgd2l0aCBzcGVjLWh5cGhlbnMgaW4gdHlwZSBuYW1lc1xuICAgICAgICAgICAgLy8gTGVhdmUgY2FsbGJhY2sgdmVyc2lvbiBhbG9uZTsgbWlzYyBvbGQgdXNlcyBvZiBmb3JFYWNoIGJlZm9yZSBNYXBcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHN0YXRzLmZvckVhY2goZnVuY3Rpb24oc3RhdCkge1xuICAgICAgICAgICAgICAgIHN0YXQudHlwZSA9IG1vZGVyblN0YXRzVHlwZXNbc3RhdC50eXBlXSB8fCBzdGF0LnR5cGU7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICBpZiAoZS5uYW1lICE9PSAnVHlwZUVycm9yJykge1xuICAgICAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLy8gQXZvaWQgVHlwZUVycm9yOiBcInR5cGVcIiBpcyByZWFkLW9ubHksIGluIG9sZCB2ZXJzaW9ucy4gMzQtNDNpc2hcbiAgICAgICAgICAgICAgc3RhdHMuZm9yRWFjaChmdW5jdGlvbihzdGF0LCBpKSB7XG4gICAgICAgICAgICAgICAgc3RhdHMuc2V0KGksIE9iamVjdC5hc3NpZ24oe30sIHN0YXQsIHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IG1vZGVyblN0YXRzVHlwZXNbc3RhdC50eXBlXSB8fCBzdGF0LnR5cGVcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gc3RhdHM7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKG9uU3VjYywgb25FcnIpO1xuICAgIH07XG4gIH0sXG5cbiAgc2hpbVNlbmRlckdldFN0YXRzOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICBpZiAoISh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JyAmJiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gJiZcbiAgICAgICAgd2luZG93LlJUQ1J0cFNlbmRlcikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHdpbmRvdy5SVENSdHBTZW5kZXIgJiYgJ2dldFN0YXRzJyBpbiB3aW5kb3cuUlRDUnRwU2VuZGVyLnByb3RvdHlwZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgb3JpZ0dldFNlbmRlcnMgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFNlbmRlcnM7XG4gICAgaWYgKG9yaWdHZXRTZW5kZXJzKSB7XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFNlbmRlcnMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgICAgdmFyIHNlbmRlcnMgPSBvcmlnR2V0U2VuZGVycy5hcHBseShwYywgW10pO1xuICAgICAgICBzZW5kZXJzLmZvckVhY2goZnVuY3Rpb24oc2VuZGVyKSB7XG4gICAgICAgICAgc2VuZGVyLl9wYyA9IHBjO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHNlbmRlcnM7XG4gICAgICB9O1xuICAgIH1cblxuICAgIHZhciBvcmlnQWRkVHJhY2sgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFRyYWNrO1xuICAgIGlmIChvcmlnQWRkVHJhY2spIHtcbiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkVHJhY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbmRlciA9IG9yaWdBZGRUcmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICBzZW5kZXIuX3BjID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHNlbmRlcjtcbiAgICAgIH07XG4gICAgfVxuICAgIHdpbmRvdy5SVENSdHBTZW5kZXIucHJvdG90eXBlLmdldFN0YXRzID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy50cmFjayA/IHRoaXMuX3BjLmdldFN0YXRzKHRoaXMudHJhY2spIDpcbiAgICAgICAgICBQcm9taXNlLnJlc29sdmUobmV3IE1hcCgpKTtcbiAgICB9O1xuICB9LFxuXG4gIHNoaW1SZWNlaXZlckdldFN0YXRzOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICBpZiAoISh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JyAmJiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24gJiZcbiAgICAgICAgd2luZG93LlJUQ1J0cFNlbmRlcikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHdpbmRvdy5SVENSdHBTZW5kZXIgJiYgJ2dldFN0YXRzJyBpbiB3aW5kb3cuUlRDUnRwUmVjZWl2ZXIucHJvdG90eXBlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBvcmlnR2V0UmVjZWl2ZXJzID0gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRSZWNlaXZlcnM7XG4gICAgaWYgKG9yaWdHZXRSZWNlaXZlcnMpIHtcbiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0UmVjZWl2ZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICAgIHZhciByZWNlaXZlcnMgPSBvcmlnR2V0UmVjZWl2ZXJzLmFwcGx5KHBjLCBbXSk7XG4gICAgICAgIHJlY2VpdmVycy5mb3JFYWNoKGZ1bmN0aW9uKHJlY2VpdmVyKSB7XG4gICAgICAgICAgcmVjZWl2ZXIuX3BjID0gcGM7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVjZWl2ZXJzO1xuICAgICAgfTtcbiAgICB9XG4gICAgdXRpbHMud3JhcFBlZXJDb25uZWN0aW9uRXZlbnQod2luZG93LCAndHJhY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICBlLnJlY2VpdmVyLl9wYyA9IGUuc3JjRWxlbWVudDtcbiAgICAgIHJldHVybiBlO1xuICAgIH0pO1xuICAgIHdpbmRvdy5SVENSdHBSZWNlaXZlci5wcm90b3R5cGUuZ2V0U3RhdHMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9wYy5nZXRTdGF0cyh0aGlzLnRyYWNrKTtcbiAgICB9O1xuICB9LFxuXG4gIHNoaW1SZW1vdmVTdHJlYW06IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIGlmICghd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uIHx8XG4gICAgICAgICdyZW1vdmVTdHJlYW0nIGluIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVTdHJlYW0gPSBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICB1dGlscy5kZXByZWNhdGVkKCdyZW1vdmVTdHJlYW0nLCAncmVtb3ZlVHJhY2snKTtcbiAgICAgIHRoaXMuZ2V0U2VuZGVycygpLmZvckVhY2goZnVuY3Rpb24oc2VuZGVyKSB7XG4gICAgICAgIGlmIChzZW5kZXIudHJhY2sgJiYgc3RyZWFtLmdldFRyYWNrcygpLmluZGV4T2Yoc2VuZGVyLnRyYWNrKSAhPT0gLTEpIHtcbiAgICAgICAgICBwYy5yZW1vdmVUcmFjayhzZW5kZXIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuICB9LFxuXG4gIHNoaW1SVENEYXRhQ2hhbm5lbDogZnVuY3Rpb24od2luZG93KSB7XG4gICAgLy8gcmVuYW1lIERhdGFDaGFubmVsIHRvIFJUQ0RhdGFDaGFubmVsIChuYXRpdmUgZml4IGluIEZGNjApOlxuICAgIC8vIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTExNzM4NTFcbiAgICBpZiAod2luZG93LkRhdGFDaGFubmVsICYmICF3aW5kb3cuUlRDRGF0YUNoYW5uZWwpIHtcbiAgICAgIHdpbmRvdy5SVENEYXRhQ2hhbm5lbCA9IHdpbmRvdy5EYXRhQ2hhbm5lbDtcbiAgICB9XG4gIH0sXG5cbiAgc2hpbUdldERpc3BsYXlNZWRpYTogZnVuY3Rpb24od2luZG93LCBwcmVmZXJyZWRNZWRpYVNvdXJjZSkge1xuICAgIGlmICghd2luZG93Lm5hdmlnYXRvciB8fCAhd2luZG93Lm5hdmlnYXRvci5tZWRpYURldmljZXMgfHxcbiAgICAgICAgJ2dldERpc3BsYXlNZWRpYScgaW4gd2luZG93Lm5hdmlnYXRvci5tZWRpYURldmljZXMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgd2luZG93Lm5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0RGlzcGxheU1lZGlhID0gZnVuY3Rpb24oY29uc3RyYWludHMpIHtcbiAgICAgIGlmICghKGNvbnN0cmFpbnRzICYmIGNvbnN0cmFpbnRzLnZpZGVvKSkge1xuICAgICAgICB2YXIgZXJyID0gbmV3IERPTUV4Y2VwdGlvbignZ2V0RGlzcGxheU1lZGlhIHdpdGhvdXQgdmlkZW8gJyArXG4gICAgICAgICAgICAnY29uc3RyYWludHMgaXMgdW5kZWZpbmVkJyk7XG4gICAgICAgIGVyci5uYW1lID0gJ05vdEZvdW5kRXJyb3InO1xuICAgICAgICAvLyBmcm9tIGh0dHBzOi8vaGV5Y2FtLmdpdGh1Yi5pby93ZWJpZGwvI2lkbC1ET01FeGNlcHRpb24tZXJyb3ItbmFtZXNcbiAgICAgICAgZXJyLmNvZGUgPSA4O1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICAgIH1cbiAgICAgIGlmIChjb25zdHJhaW50cy52aWRlbyA9PT0gdHJ1ZSkge1xuICAgICAgICBjb25zdHJhaW50cy52aWRlbyA9IHttZWRpYVNvdXJjZTogcHJlZmVycmVkTWVkaWFTb3VyY2V9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3RyYWludHMudmlkZW8ubWVkaWFTb3VyY2UgPSBwcmVmZXJyZWRNZWRpYVNvdXJjZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB3aW5kb3cubmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpO1xuICAgIH07XG4gICAgd2luZG93Lm5hdmlnYXRvci5nZXREaXNwbGF5TWVkaWEgPSBmdW5jdGlvbihjb25zdHJhaW50cykge1xuICAgICAgdXRpbHMuZGVwcmVjYXRlZCgnbmF2aWdhdG9yLmdldERpc3BsYXlNZWRpYScsXG4gICAgICAgICAgJ25hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0RGlzcGxheU1lZGlhJyk7XG4gICAgICByZXR1cm4gd2luZG93Lm5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0RGlzcGxheU1lZGlhKGNvbnN0cmFpbnRzKTtcbiAgICB9O1xuICB9XG59O1xuIiwiLypcbiAqICBDb3B5cmlnaHQgKGMpIDIwMTYgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlIGxpY2Vuc2VcbiAqICB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSByb290IG9mIHRoZSBzb3VyY2VcbiAqICB0cmVlLlxuICovXG4gLyogZXNsaW50LWVudiBub2RlICovXG4ndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XG52YXIgbG9nZ2luZyA9IHV0aWxzLmxvZztcblxuLy8gRXhwb3NlIHB1YmxpYyBtZXRob2RzLlxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih3aW5kb3cpIHtcbiAgdmFyIGJyb3dzZXJEZXRhaWxzID0gdXRpbHMuZGV0ZWN0QnJvd3Nlcih3aW5kb3cpO1xuICB2YXIgbmF2aWdhdG9yID0gd2luZG93ICYmIHdpbmRvdy5uYXZpZ2F0b3I7XG4gIHZhciBNZWRpYVN0cmVhbVRyYWNrID0gd2luZG93ICYmIHdpbmRvdy5NZWRpYVN0cmVhbVRyYWNrO1xuXG4gIHZhciBzaGltRXJyb3JfID0gZnVuY3Rpb24oZSkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB7XG4gICAgICAgIEludGVybmFsRXJyb3I6ICdOb3RSZWFkYWJsZUVycm9yJyxcbiAgICAgICAgTm90U3VwcG9ydGVkRXJyb3I6ICdUeXBlRXJyb3InLFxuICAgICAgICBQZXJtaXNzaW9uRGVuaWVkRXJyb3I6ICdOb3RBbGxvd2VkRXJyb3InLFxuICAgICAgICBTZWN1cml0eUVycm9yOiAnTm90QWxsb3dlZEVycm9yJ1xuICAgICAgfVtlLm5hbWVdIHx8IGUubmFtZSxcbiAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgJ1RoZSBvcGVyYXRpb24gaXMgaW5zZWN1cmUuJzogJ1RoZSByZXF1ZXN0IGlzIG5vdCBhbGxvd2VkIGJ5IHRoZSAnICtcbiAgICAgICAgJ3VzZXIgYWdlbnQgb3IgdGhlIHBsYXRmb3JtIGluIHRoZSBjdXJyZW50IGNvbnRleHQuJ1xuICAgICAgfVtlLm1lc3NhZ2VdIHx8IGUubWVzc2FnZSxcbiAgICAgIGNvbnN0cmFpbnQ6IGUuY29uc3RyYWludCxcbiAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZSArICh0aGlzLm1lc3NhZ2UgJiYgJzogJykgKyB0aGlzLm1lc3NhZ2U7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcblxuICAvLyBnZXRVc2VyTWVkaWEgY29uc3RyYWludHMgc2hpbS5cbiAgdmFyIGdldFVzZXJNZWRpYV8gPSBmdW5jdGlvbihjb25zdHJhaW50cywgb25TdWNjZXNzLCBvbkVycm9yKSB7XG4gICAgdmFyIGNvbnN0cmFpbnRzVG9GRjM3XyA9IGZ1bmN0aW9uKGMpIHtcbiAgICAgIGlmICh0eXBlb2YgYyAhPT0gJ29iamVjdCcgfHwgYy5yZXF1aXJlKSB7XG4gICAgICAgIHJldHVybiBjO1xuICAgICAgfVxuICAgICAgdmFyIHJlcXVpcmUgPSBbXTtcbiAgICAgIE9iamVjdC5rZXlzKGMpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgIGlmIChrZXkgPT09ICdyZXF1aXJlJyB8fCBrZXkgPT09ICdhZHZhbmNlZCcgfHwga2V5ID09PSAnbWVkaWFTb3VyY2UnKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciByID0gY1trZXldID0gKHR5cGVvZiBjW2tleV0gPT09ICdvYmplY3QnKSA/XG4gICAgICAgICAgICBjW2tleV0gOiB7aWRlYWw6IGNba2V5XX07XG4gICAgICAgIGlmIChyLm1pbiAhPT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICByLm1heCAhPT0gdW5kZWZpbmVkIHx8IHIuZXhhY3QgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHJlcXVpcmUucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyLmV4YWN0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIHIuZXhhY3QgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICByLiBtaW4gPSByLm1heCA9IHIuZXhhY3Q7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNba2V5XSA9IHIuZXhhY3Q7XG4gICAgICAgICAgfVxuICAgICAgICAgIGRlbGV0ZSByLmV4YWN0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChyLmlkZWFsICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBjLmFkdmFuY2VkID0gYy5hZHZhbmNlZCB8fCBbXTtcbiAgICAgICAgICB2YXIgb2MgPSB7fTtcbiAgICAgICAgICBpZiAodHlwZW9mIHIuaWRlYWwgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICBvY1trZXldID0ge21pbjogci5pZGVhbCwgbWF4OiByLmlkZWFsfTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb2Nba2V5XSA9IHIuaWRlYWw7XG4gICAgICAgICAgfVxuICAgICAgICAgIGMuYWR2YW5jZWQucHVzaChvYyk7XG4gICAgICAgICAgZGVsZXRlIHIuaWRlYWw7XG4gICAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhyKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBjW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmIChyZXF1aXJlLmxlbmd0aCkge1xuICAgICAgICBjLnJlcXVpcmUgPSByZXF1aXJlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGM7XG4gICAgfTtcbiAgICBjb25zdHJhaW50cyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTtcbiAgICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDM4KSB7XG4gICAgICBsb2dnaW5nKCdzcGVjOiAnICsgSlNPTi5zdHJpbmdpZnkoY29uc3RyYWludHMpKTtcbiAgICAgIGlmIChjb25zdHJhaW50cy5hdWRpbykge1xuICAgICAgICBjb25zdHJhaW50cy5hdWRpbyA9IGNvbnN0cmFpbnRzVG9GRjM3Xyhjb25zdHJhaW50cy5hdWRpbyk7XG4gICAgICB9XG4gICAgICBpZiAoY29uc3RyYWludHMudmlkZW8pIHtcbiAgICAgICAgY29uc3RyYWludHMudmlkZW8gPSBjb25zdHJhaW50c1RvRkYzN18oY29uc3RyYWludHMudmlkZW8pO1xuICAgICAgfVxuICAgICAgbG9nZ2luZygnZmYzNzogJyArIEpTT04uc3RyaW5naWZ5KGNvbnN0cmFpbnRzKSk7XG4gICAgfVxuICAgIHJldHVybiBuYXZpZ2F0b3IubW96R2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzLCBvblN1Y2Nlc3MsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIG9uRXJyb3Ioc2hpbUVycm9yXyhlKSk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gUmV0dXJucyB0aGUgcmVzdWx0IG9mIGdldFVzZXJNZWRpYSBhcyBhIFByb21pc2UuXG4gIHZhciBnZXRVc2VyTWVkaWFQcm9taXNlXyA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgZ2V0VXNlck1lZGlhXyhjb25zdHJhaW50cywgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBTaGltIGZvciBtZWRpYURldmljZXMgb24gb2xkZXIgdmVyc2lvbnMuXG4gIGlmICghbmF2aWdhdG9yLm1lZGlhRGV2aWNlcykge1xuICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMgPSB7Z2V0VXNlck1lZGlhOiBnZXRVc2VyTWVkaWFQcm9taXNlXyxcbiAgICAgIGFkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKCkgeyB9LFxuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24oKSB7IH1cbiAgICB9O1xuICB9XG4gIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcyA9XG4gICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMgfHwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICAgICAgdmFyIGluZm9zID0gW1xuICAgICAgICAgICAge2tpbmQ6ICdhdWRpb2lucHV0JywgZGV2aWNlSWQ6ICdkZWZhdWx0JywgbGFiZWw6ICcnLCBncm91cElkOiAnJ30sXG4gICAgICAgICAgICB7a2luZDogJ3ZpZGVvaW5wdXQnLCBkZXZpY2VJZDogJ2RlZmF1bHQnLCBsYWJlbDogJycsIGdyb3VwSWQ6ICcnfVxuICAgICAgICAgIF07XG4gICAgICAgICAgcmVzb2x2ZShpbmZvcyk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICBpZiAoYnJvd3NlckRldGFpbHMudmVyc2lvbiA8IDQxKSB7XG4gICAgLy8gV29yayBhcm91bmQgaHR0cDovL2J1Z3ppbC5sYS8xMTY5NjY1XG4gICAgdmFyIG9yZ0VudW1lcmF0ZURldmljZXMgPVxuICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMuYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTtcbiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBvcmdFbnVtZXJhdGVEZXZpY2VzKCkudGhlbih1bmRlZmluZWQsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKGUubmFtZSA9PT0gJ05vdEZvdW5kRXJyb3InKSB7XG4gICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGU7XG4gICAgICB9KTtcbiAgICB9O1xuICB9XG4gIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNDkpIHtcbiAgICB2YXIgb3JpZ0dldFVzZXJNZWRpYSA9IG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhLlxuICAgICAgICBiaW5kKG5hdmlnYXRvci5tZWRpYURldmljZXMpO1xuICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oYykge1xuICAgICAgcmV0dXJuIG9yaWdHZXRVc2VyTWVkaWEoYykudGhlbihmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgICAgLy8gV29yayBhcm91bmQgaHR0cHM6Ly9idWd6aWwubGEvODAyMzI2XG4gICAgICAgIGlmIChjLmF1ZGlvICYmICFzdHJlYW0uZ2V0QXVkaW9UcmFja3MoKS5sZW5ndGggfHxcbiAgICAgICAgICAgIGMudmlkZW8gJiYgIXN0cmVhbS5nZXRWaWRlb1RyYWNrcygpLmxlbmd0aCkge1xuICAgICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7XG4gICAgICAgICAgICB0cmFjay5zdG9wKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignVGhlIG9iamVjdCBjYW4gbm90IGJlIGZvdW5kIGhlcmUuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdOb3RGb3VuZEVycm9yJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0cmVhbTtcbiAgICAgIH0sIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHNoaW1FcnJvcl8oZSkpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfVxuICBpZiAoIShicm93c2VyRGV0YWlscy52ZXJzaW9uID4gNTUgJiZcbiAgICAgICdhdXRvR2FpbkNvbnRyb2wnIGluIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0U3VwcG9ydGVkQ29uc3RyYWludHMoKSkpIHtcbiAgICB2YXIgcmVtYXAgPSBmdW5jdGlvbihvYmosIGEsIGIpIHtcbiAgICAgIGlmIChhIGluIG9iaiAmJiAhKGIgaW4gb2JqKSkge1xuICAgICAgICBvYmpbYl0gPSBvYmpbYV07XG4gICAgICAgIGRlbGV0ZSBvYmpbYV07XG4gICAgICB9XG4gICAgfTtcblxuICAgIHZhciBuYXRpdmVHZXRVc2VyTWVkaWEgPSBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYS5cbiAgICAgICAgYmluZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKTtcbiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSA9IGZ1bmN0aW9uKGMpIHtcbiAgICAgIGlmICh0eXBlb2YgYyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIGMuYXVkaW8gPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGMpKTtcbiAgICAgICAgcmVtYXAoYy5hdWRpbywgJ2F1dG9HYWluQ29udHJvbCcsICdtb3pBdXRvR2FpbkNvbnRyb2wnKTtcbiAgICAgICAgcmVtYXAoYy5hdWRpbywgJ25vaXNlU3VwcHJlc3Npb24nLCAnbW96Tm9pc2VTdXBwcmVzc2lvbicpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5hdGl2ZUdldFVzZXJNZWRpYShjKTtcbiAgICB9O1xuXG4gICAgaWYgKE1lZGlhU3RyZWFtVHJhY2sgJiYgTWVkaWFTdHJlYW1UcmFjay5wcm90b3R5cGUuZ2V0U2V0dGluZ3MpIHtcbiAgICAgIHZhciBuYXRpdmVHZXRTZXR0aW5ncyA9IE1lZGlhU3RyZWFtVHJhY2sucHJvdG90eXBlLmdldFNldHRpbmdzO1xuICAgICAgTWVkaWFTdHJlYW1UcmFjay5wcm90b3R5cGUuZ2V0U2V0dGluZ3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9iaiA9IG5hdGl2ZUdldFNldHRpbmdzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIHJlbWFwKG9iaiwgJ21vekF1dG9HYWluQ29udHJvbCcsICdhdXRvR2FpbkNvbnRyb2wnKTtcbiAgICAgICAgcmVtYXAob2JqLCAnbW96Tm9pc2VTdXBwcmVzc2lvbicsICdub2lzZVN1cHByZXNzaW9uJyk7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9O1xuICAgIH1cblxuICAgIGlmIChNZWRpYVN0cmVhbVRyYWNrICYmIE1lZGlhU3RyZWFtVHJhY2sucHJvdG90eXBlLmFwcGx5Q29uc3RyYWludHMpIHtcbiAgICAgIHZhciBuYXRpdmVBcHBseUNvbnN0cmFpbnRzID0gTWVkaWFTdHJlYW1UcmFjay5wcm90b3R5cGUuYXBwbHlDb25zdHJhaW50cztcbiAgICAgIE1lZGlhU3RyZWFtVHJhY2sucHJvdG90eXBlLmFwcGx5Q29uc3RyYWludHMgPSBmdW5jdGlvbihjKSB7XG4gICAgICAgIGlmICh0aGlzLmtpbmQgPT09ICdhdWRpbycgJiYgdHlwZW9mIGMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgYyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYykpO1xuICAgICAgICAgIHJlbWFwKGMsICdhdXRvR2FpbkNvbnRyb2wnLCAnbW96QXV0b0dhaW5Db250cm9sJyk7XG4gICAgICAgICAgcmVtYXAoYywgJ25vaXNlU3VwcHJlc3Npb24nLCAnbW96Tm9pc2VTdXBwcmVzc2lvbicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuYXRpdmVBcHBseUNvbnN0cmFpbnRzLmFwcGx5KHRoaXMsIFtjXSk7XG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24oY29uc3RyYWludHMsIG9uU3VjY2Vzcywgb25FcnJvcikge1xuICAgIGlmIChicm93c2VyRGV0YWlscy52ZXJzaW9uIDwgNDQpIHtcbiAgICAgIHJldHVybiBnZXRVc2VyTWVkaWFfKGNvbnN0cmFpbnRzLCBvblN1Y2Nlc3MsIG9uRXJyb3IpO1xuICAgIH1cbiAgICAvLyBSZXBsYWNlIEZpcmVmb3ggNDQrJ3MgZGVwcmVjYXRpb24gd2FybmluZyB3aXRoIHVucHJlZml4ZWQgdmVyc2lvbi5cbiAgICB1dGlscy5kZXByZWNhdGVkKCduYXZpZ2F0b3IuZ2V0VXNlck1lZGlhJyxcbiAgICAgICAgJ25hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhJyk7XG4gICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4ob25TdWNjZXNzLCBvbkVycm9yKTtcbiAgfTtcbn07XG4iLCIvKlxuICogIENvcHlyaWdodCAoYykgMjAxNiBUaGUgV2ViUlRDIHByb2plY3QgYXV0aG9ycy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiAgVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYSBCU0Qtc3R5bGUgbGljZW5zZVxuICogIHRoYXQgY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3Qgb2YgdGhlIHNvdXJjZVxuICogIHRyZWUuXG4gKi9cbid1c2Ugc3RyaWN0JztcbnZhciB1dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBzaGltTG9jYWxTdHJlYW1zQVBJOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ29iamVjdCcgfHwgIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoISgnZ2V0TG9jYWxTdHJlYW1zJyBpbiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlKSkge1xuICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5nZXRMb2NhbFN0cmVhbXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9sb2NhbFN0cmVhbXMpIHtcbiAgICAgICAgICB0aGlzLl9sb2NhbFN0cmVhbXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fbG9jYWxTdHJlYW1zO1xuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKCEoJ2dldFN0cmVhbUJ5SWQnIGluIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUpKSB7XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmdldFN0cmVhbUJ5SWQgPSBmdW5jdGlvbihpZCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMuX2xvY2FsU3RyZWFtcykge1xuICAgICAgICAgIHRoaXMuX2xvY2FsU3RyZWFtcy5mb3JFYWNoKGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgICAgICAgaWYgKHN0cmVhbS5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgcmVzdWx0ID0gc3RyZWFtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9yZW1vdGVTdHJlYW1zKSB7XG4gICAgICAgICAgdGhpcy5fcmVtb3RlU3RyZWFtcy5mb3JFYWNoKGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgICAgICAgaWYgKHN0cmVhbS5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgICAgcmVzdWx0ID0gc3RyZWFtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAoISgnYWRkU3RyZWFtJyBpbiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlKSkge1xuICAgICAgdmFyIF9hZGRUcmFjayA9IHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuYWRkVHJhY2s7XG4gICAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmFkZFN0cmVhbSA9IGZ1bmN0aW9uKHN0cmVhbSkge1xuICAgICAgICBpZiAoIXRoaXMuX2xvY2FsU3RyZWFtcykge1xuICAgICAgICAgIHRoaXMuX2xvY2FsU3RyZWFtcyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9sb2NhbFN0cmVhbXMuaW5kZXhPZihzdHJlYW0pID09PSAtMSkge1xuICAgICAgICAgIHRoaXMuX2xvY2FsU3RyZWFtcy5wdXNoKHN0cmVhbSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgICAgc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goZnVuY3Rpb24odHJhY2spIHtcbiAgICAgICAgICBfYWRkVHJhY2suY2FsbChwYywgdHJhY2ssIHN0cmVhbSk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5hZGRUcmFjayA9IGZ1bmN0aW9uKHRyYWNrLCBzdHJlYW0pIHtcbiAgICAgICAgaWYgKHN0cmVhbSkge1xuICAgICAgICAgIGlmICghdGhpcy5fbG9jYWxTdHJlYW1zKSB7XG4gICAgICAgICAgICB0aGlzLl9sb2NhbFN0cmVhbXMgPSBbc3RyZWFtXTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2xvY2FsU3RyZWFtcy5pbmRleE9mKHN0cmVhbSkgPT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLl9sb2NhbFN0cmVhbXMucHVzaChzdHJlYW0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX2FkZFRyYWNrLmNhbGwodGhpcywgdHJhY2ssIHN0cmVhbSk7XG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAoISgncmVtb3ZlU3RyZWFtJyBpbiB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlKSkge1xuICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVTdHJlYW0gPSBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgICAgaWYgKCF0aGlzLl9sb2NhbFN0cmVhbXMpIHtcbiAgICAgICAgICB0aGlzLl9sb2NhbFN0cmVhbXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLl9sb2NhbFN0cmVhbXMuaW5kZXhPZihzdHJlYW0pO1xuICAgICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xvY2FsU3RyZWFtcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB2YXIgcGMgPSB0aGlzO1xuICAgICAgICB2YXIgdHJhY2tzID0gc3RyZWFtLmdldFRyYWNrcygpO1xuICAgICAgICB0aGlzLmdldFNlbmRlcnMoKS5mb3JFYWNoKGZ1bmN0aW9uKHNlbmRlcikge1xuICAgICAgICAgIGlmICh0cmFja3MuaW5kZXhPZihzZW5kZXIudHJhY2spICE9PSAtMSkge1xuICAgICAgICAgICAgcGMucmVtb3ZlVHJhY2soc2VuZGVyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9XG4gIH0sXG4gIHNoaW1SZW1vdGVTdHJlYW1zQVBJOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ29iamVjdCcgfHwgIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoISgnZ2V0UmVtb3RlU3RyZWFtcycgaW4gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHtcbiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuZ2V0UmVtb3RlU3RyZWFtcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVtb3RlU3RyZWFtcyA/IHRoaXMuX3JlbW90ZVN0cmVhbXMgOiBbXTtcbiAgICAgIH07XG4gICAgfVxuICAgIGlmICghKCdvbmFkZHN0cmVhbScgaW4gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZSkpIHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLCAnb25hZGRzdHJlYW0nLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX29uYWRkc3RyZWFtO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKGYpIHtcbiAgICAgICAgICBpZiAodGhpcy5fb25hZGRzdHJlYW0pIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignYWRkc3RyZWFtJywgdGhpcy5fb25hZGRzdHJlYW0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2FkZHN0cmVhbScsIHRoaXMuX29uYWRkc3RyZWFtID0gZik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgdmFyIG9yaWdTZXRSZW1vdGVEZXNjcmlwdGlvbiA9XG4gICAgICAgICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZS5zZXRSZW1vdGVEZXNjcmlwdGlvbjtcbiAgICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuc2V0UmVtb3RlRGVzY3JpcHRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHBjID0gdGhpcztcbiAgICAgICAgaWYgKCF0aGlzLl9vbmFkZHN0cmVhbXBvbHkpIHtcbiAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYWNrJywgdGhpcy5fb25hZGRzdHJlYW1wb2x5ID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgZS5zdHJlYW1zLmZvckVhY2goZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICAgICAgICAgIGlmICghcGMuX3JlbW90ZVN0cmVhbXMpIHtcbiAgICAgICAgICAgICAgICBwYy5fcmVtb3RlU3RyZWFtcyA9IFtdO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChwYy5fcmVtb3RlU3RyZWFtcy5pbmRleE9mKHN0cmVhbSkgPj0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBwYy5fcmVtb3RlU3RyZWFtcy5wdXNoKHN0cmVhbSk7XG4gICAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBFdmVudCgnYWRkc3RyZWFtJyk7XG4gICAgICAgICAgICAgIGV2ZW50LnN0cmVhbSA9IHN0cmVhbTtcbiAgICAgICAgICAgICAgcGMuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3JpZ1NldFJlbW90ZURlc2NyaXB0aW9uLmFwcGx5KHBjLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9XG4gIH0sXG4gIHNoaW1DYWxsYmFja3NBUEk6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAnb2JqZWN0JyB8fCAhd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBwcm90b3R5cGUgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlO1xuICAgIHZhciBjcmVhdGVPZmZlciA9IHByb3RvdHlwZS5jcmVhdGVPZmZlcjtcbiAgICB2YXIgY3JlYXRlQW5zd2VyID0gcHJvdG90eXBlLmNyZWF0ZUFuc3dlcjtcbiAgICB2YXIgc2V0TG9jYWxEZXNjcmlwdGlvbiA9IHByb3RvdHlwZS5zZXRMb2NhbERlc2NyaXB0aW9uO1xuICAgIHZhciBzZXRSZW1vdGVEZXNjcmlwdGlvbiA9IHByb3RvdHlwZS5zZXRSZW1vdGVEZXNjcmlwdGlvbjtcbiAgICB2YXIgYWRkSWNlQ2FuZGlkYXRlID0gcHJvdG90eXBlLmFkZEljZUNhbmRpZGF0ZTtcblxuICAgIHByb3RvdHlwZS5jcmVhdGVPZmZlciA9IGZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjaywgZmFpbHVyZUNhbGxiYWNrKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IChhcmd1bWVudHMubGVuZ3RoID49IDIpID8gYXJndW1lbnRzWzJdIDogYXJndW1lbnRzWzBdO1xuICAgICAgdmFyIHByb21pc2UgPSBjcmVhdGVPZmZlci5hcHBseSh0aGlzLCBbb3B0aW9uc10pO1xuICAgICAgaWYgKCFmYWlsdXJlQ2FsbGJhY2spIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9XG4gICAgICBwcm9taXNlLnRoZW4oc3VjY2Vzc0NhbGxiYWNrLCBmYWlsdXJlQ2FsbGJhY2spO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH07XG5cbiAgICBwcm90b3R5cGUuY3JlYXRlQW5zd2VyID0gZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLCBmYWlsdXJlQ2FsbGJhY2spIHtcbiAgICAgIHZhciBvcHRpb25zID0gKGFyZ3VtZW50cy5sZW5ndGggPj0gMikgPyBhcmd1bWVudHNbMl0gOiBhcmd1bWVudHNbMF07XG4gICAgICB2YXIgcHJvbWlzZSA9IGNyZWF0ZUFuc3dlci5hcHBseSh0aGlzLCBbb3B0aW9uc10pO1xuICAgICAgaWYgKCFmYWlsdXJlQ2FsbGJhY2spIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9XG4gICAgICBwcm9taXNlLnRoZW4oc3VjY2Vzc0NhbGxiYWNrLCBmYWlsdXJlQ2FsbGJhY2spO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH07XG5cbiAgICB2YXIgd2l0aENhbGxiYWNrID0gZnVuY3Rpb24oZGVzY3JpcHRpb24sIHN1Y2Nlc3NDYWxsYmFjaywgZmFpbHVyZUNhbGxiYWNrKSB7XG4gICAgICB2YXIgcHJvbWlzZSA9IHNldExvY2FsRGVzY3JpcHRpb24uYXBwbHkodGhpcywgW2Rlc2NyaXB0aW9uXSk7XG4gICAgICBpZiAoIWZhaWx1cmVDYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH1cbiAgICAgIHByb21pc2UudGhlbihzdWNjZXNzQ2FsbGJhY2ssIGZhaWx1cmVDYWxsYmFjayk7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfTtcbiAgICBwcm90b3R5cGUuc2V0TG9jYWxEZXNjcmlwdGlvbiA9IHdpdGhDYWxsYmFjaztcblxuICAgIHdpdGhDYWxsYmFjayA9IGZ1bmN0aW9uKGRlc2NyaXB0aW9uLCBzdWNjZXNzQ2FsbGJhY2ssIGZhaWx1cmVDYWxsYmFjaykge1xuICAgICAgdmFyIHByb21pc2UgPSBzZXRSZW1vdGVEZXNjcmlwdGlvbi5hcHBseSh0aGlzLCBbZGVzY3JpcHRpb25dKTtcbiAgICAgIGlmICghZmFpbHVyZUNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfVxuICAgICAgcHJvbWlzZS50aGVuKHN1Y2Nlc3NDYWxsYmFjaywgZmFpbHVyZUNhbGxiYWNrKTtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9O1xuICAgIHByb3RvdHlwZS5zZXRSZW1vdGVEZXNjcmlwdGlvbiA9IHdpdGhDYWxsYmFjaztcblxuICAgIHdpdGhDYWxsYmFjayA9IGZ1bmN0aW9uKGNhbmRpZGF0ZSwgc3VjY2Vzc0NhbGxiYWNrLCBmYWlsdXJlQ2FsbGJhY2spIHtcbiAgICAgIHZhciBwcm9taXNlID0gYWRkSWNlQ2FuZGlkYXRlLmFwcGx5KHRoaXMsIFtjYW5kaWRhdGVdKTtcbiAgICAgIGlmICghZmFpbHVyZUNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgfVxuICAgICAgcHJvbWlzZS50aGVuKHN1Y2Nlc3NDYWxsYmFjaywgZmFpbHVyZUNhbGxiYWNrKTtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9O1xuICAgIHByb3RvdHlwZS5hZGRJY2VDYW5kaWRhdGUgPSB3aXRoQ2FsbGJhY2s7XG4gIH0sXG4gIHNoaW1HZXRVc2VyTWVkaWE6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIHZhciBuYXZpZ2F0b3IgPSB3aW5kb3cgJiYgd2luZG93Lm5hdmlnYXRvcjtcblxuICAgIGlmICghbmF2aWdhdG9yLmdldFVzZXJNZWRpYSkge1xuICAgICAgaWYgKG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEpIHtcbiAgICAgICAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSA9IG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEuYmluZChuYXZpZ2F0b3IpO1xuICAgICAgfSBlbHNlIGlmIChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzICYmXG4gICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEpIHtcbiAgICAgICAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYSA9IGZ1bmN0aW9uKGNvbnN0cmFpbnRzLCBjYiwgZXJyY2IpIHtcbiAgICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYShjb25zdHJhaW50cylcbiAgICAgICAgICAudGhlbihjYiwgZXJyY2IpO1xuICAgICAgICB9LmJpbmQobmF2aWdhdG9yKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIHNoaW1SVENJY2VTZXJ2ZXJVcmxzOiBmdW5jdGlvbih3aW5kb3cpIHtcbiAgICAvLyBtaWdyYXRlIGZyb20gbm9uLXNwZWMgUlRDSWNlU2VydmVyLnVybCB0byBSVENJY2VTZXJ2ZXIudXJsc1xuICAgIHZhciBPcmlnUGVlckNvbm5lY3Rpb24gPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb247XG4gICAgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uID0gZnVuY3Rpb24ocGNDb25maWcsIHBjQ29uc3RyYWludHMpIHtcbiAgICAgIGlmIChwY0NvbmZpZyAmJiBwY0NvbmZpZy5pY2VTZXJ2ZXJzKSB7XG4gICAgICAgIHZhciBuZXdJY2VTZXJ2ZXJzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGNDb25maWcuaWNlU2VydmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciBzZXJ2ZXIgPSBwY0NvbmZpZy5pY2VTZXJ2ZXJzW2ldO1xuICAgICAgICAgIGlmICghc2VydmVyLmhhc093blByb3BlcnR5KCd1cmxzJykgJiZcbiAgICAgICAgICAgICAgc2VydmVyLmhhc093blByb3BlcnR5KCd1cmwnKSkge1xuICAgICAgICAgICAgdXRpbHMuZGVwcmVjYXRlZCgnUlRDSWNlU2VydmVyLnVybCcsICdSVENJY2VTZXJ2ZXIudXJscycpO1xuICAgICAgICAgICAgc2VydmVyID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzZXJ2ZXIpKTtcbiAgICAgICAgICAgIHNlcnZlci51cmxzID0gc2VydmVyLnVybDtcbiAgICAgICAgICAgIGRlbGV0ZSBzZXJ2ZXIudXJsO1xuICAgICAgICAgICAgbmV3SWNlU2VydmVycy5wdXNoKHNlcnZlcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ld0ljZVNlcnZlcnMucHVzaChwY0NvbmZpZy5pY2VTZXJ2ZXJzW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcGNDb25maWcuaWNlU2VydmVycyA9IG5ld0ljZVNlcnZlcnM7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3IE9yaWdQZWVyQ29ubmVjdGlvbihwY0NvbmZpZywgcGNDb25zdHJhaW50cyk7XG4gICAgfTtcbiAgICB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlID0gT3JpZ1BlZXJDb25uZWN0aW9uLnByb3RvdHlwZTtcbiAgICAvLyB3cmFwIHN0YXRpYyBtZXRob2RzLiBDdXJyZW50bHkganVzdCBnZW5lcmF0ZUNlcnRpZmljYXRlLlxuICAgIGlmICgnZ2VuZXJhdGVDZXJ0aWZpY2F0ZScgaW4gd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LlJUQ1BlZXJDb25uZWN0aW9uLCAnZ2VuZXJhdGVDZXJ0aWZpY2F0ZScsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gT3JpZ1BlZXJDb25uZWN0aW9uLmdlbmVyYXRlQ2VydGlmaWNhdGU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSxcbiAgc2hpbVRyYWNrRXZlbnRUcmFuc2NlaXZlcjogZnVuY3Rpb24od2luZG93KSB7XG4gICAgLy8gQWRkIGV2ZW50LnRyYW5zY2VpdmVyIG1lbWJlciBvdmVyIGRlcHJlY2F0ZWQgZXZlbnQucmVjZWl2ZXJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgJiYgd2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmXG4gICAgICAgICgncmVjZWl2ZXInIGluIHdpbmRvdy5SVENUcmFja0V2ZW50LnByb3RvdHlwZSkgJiZcbiAgICAgICAgLy8gY2FuJ3QgY2hlY2sgJ3RyYW5zY2VpdmVyJyBpbiB3aW5kb3cuUlRDVHJhY2tFdmVudC5wcm90b3R5cGUsIGFzIGl0IGlzXG4gICAgICAgIC8vIGRlZmluZWQgZm9yIHNvbWUgcmVhc29uIGV2ZW4gd2hlbiB3aW5kb3cuUlRDVHJhbnNjZWl2ZXIgaXMgbm90LlxuICAgICAgICAhd2luZG93LlJUQ1RyYW5zY2VpdmVyKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LlJUQ1RyYWNrRXZlbnQucHJvdG90eXBlLCAndHJhbnNjZWl2ZXInLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHtyZWNlaXZlcjogdGhpcy5yZWNlaXZlcn07XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSxcblxuICBzaGltQ3JlYXRlT2ZmZXJMZWdhY3k6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIHZhciBvcmlnQ3JlYXRlT2ZmZXIgPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlLmNyZWF0ZU9mZmVyO1xuICAgIHdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbi5wcm90b3R5cGUuY3JlYXRlT2ZmZXIgPSBmdW5jdGlvbihvZmZlck9wdGlvbnMpIHtcbiAgICAgIHZhciBwYyA9IHRoaXM7XG4gICAgICBpZiAob2ZmZXJPcHRpb25zKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygb2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW8gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgLy8gc3VwcG9ydCBiaXQgdmFsdWVzXG4gICAgICAgICAgb2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW8gPSAhIW9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZUF1ZGlvO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhdWRpb1RyYW5zY2VpdmVyID0gcGMuZ2V0VHJhbnNjZWl2ZXJzKCkuZmluZChmdW5jdGlvbih0cmFuc2NlaXZlcikge1xuICAgICAgICAgIHJldHVybiB0cmFuc2NlaXZlci5zZW5kZXIudHJhY2sgJiZcbiAgICAgICAgICAgICAgdHJhbnNjZWl2ZXIuc2VuZGVyLnRyYWNrLmtpbmQgPT09ICdhdWRpbyc7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAob2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlQXVkaW8gPT09IGZhbHNlICYmIGF1ZGlvVHJhbnNjZWl2ZXIpIHtcbiAgICAgICAgICBpZiAoYXVkaW9UcmFuc2NlaXZlci5kaXJlY3Rpb24gPT09ICdzZW5kcmVjdicpIHtcbiAgICAgICAgICAgIGlmIChhdWRpb1RyYW5zY2VpdmVyLnNldERpcmVjdGlvbikge1xuICAgICAgICAgICAgICBhdWRpb1RyYW5zY2VpdmVyLnNldERpcmVjdGlvbignc2VuZG9ubHknKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGF1ZGlvVHJhbnNjZWl2ZXIuZGlyZWN0aW9uID0gJ3NlbmRvbmx5JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKGF1ZGlvVHJhbnNjZWl2ZXIuZGlyZWN0aW9uID09PSAncmVjdm9ubHknKSB7XG4gICAgICAgICAgICBpZiAoYXVkaW9UcmFuc2NlaXZlci5zZXREaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgYXVkaW9UcmFuc2NlaXZlci5zZXREaXJlY3Rpb24oJ2luYWN0aXZlJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBhdWRpb1RyYW5zY2VpdmVyLmRpcmVjdGlvbiA9ICdpbmFjdGl2ZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZUF1ZGlvID09PSB0cnVlICYmXG4gICAgICAgICAgICAhYXVkaW9UcmFuc2NlaXZlcikge1xuICAgICAgICAgIHBjLmFkZFRyYW5zY2VpdmVyKCdhdWRpbycpO1xuICAgICAgICB9XG5cblxuICAgICAgICBpZiAodHlwZW9mIG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgIC8vIHN1cHBvcnQgYml0IHZhbHVlc1xuICAgICAgICAgIG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvID0gISFvZmZlck9wdGlvbnMub2ZmZXJUb1JlY2VpdmVWaWRlbztcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmlkZW9UcmFuc2NlaXZlciA9IHBjLmdldFRyYW5zY2VpdmVycygpLmZpbmQoZnVuY3Rpb24odHJhbnNjZWl2ZXIpIHtcbiAgICAgICAgICByZXR1cm4gdHJhbnNjZWl2ZXIuc2VuZGVyLnRyYWNrICYmXG4gICAgICAgICAgICAgIHRyYW5zY2VpdmVyLnNlbmRlci50cmFjay5raW5kID09PSAndmlkZW8nO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKG9mZmVyT3B0aW9ucy5vZmZlclRvUmVjZWl2ZVZpZGVvID09PSBmYWxzZSAmJiB2aWRlb1RyYW5zY2VpdmVyKSB7XG4gICAgICAgICAgaWYgKHZpZGVvVHJhbnNjZWl2ZXIuZGlyZWN0aW9uID09PSAnc2VuZHJlY3YnKSB7XG4gICAgICAgICAgICB2aWRlb1RyYW5zY2VpdmVyLnNldERpcmVjdGlvbignc2VuZG9ubHknKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHZpZGVvVHJhbnNjZWl2ZXIuZGlyZWN0aW9uID09PSAncmVjdm9ubHknKSB7XG4gICAgICAgICAgICB2aWRlb1RyYW5zY2VpdmVyLnNldERpcmVjdGlvbignaW5hY3RpdmUnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAob2ZmZXJPcHRpb25zLm9mZmVyVG9SZWNlaXZlVmlkZW8gPT09IHRydWUgJiZcbiAgICAgICAgICAgICF2aWRlb1RyYW5zY2VpdmVyKSB7XG4gICAgICAgICAgcGMuYWRkVHJhbnNjZWl2ZXIoJ3ZpZGVvJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBvcmlnQ3JlYXRlT2ZmZXIuYXBwbHkocGMsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfVxufTtcbiIsIi8qXG4gKiAgQ29weXJpZ2h0IChjKSAyMDE2IFRoZSBXZWJSVEMgcHJvamVjdCBhdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqICBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIEJTRC1zdHlsZSBsaWNlbnNlXG4gKiAgdGhhdCBjYW4gYmUgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBvZiB0aGUgc291cmNlXG4gKiAgdHJlZS5cbiAqL1xuIC8qIGVzbGludC1lbnYgbm9kZSAqL1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgbG9nRGlzYWJsZWRfID0gdHJ1ZTtcbnZhciBkZXByZWNhdGlvbldhcm5pbmdzXyA9IHRydWU7XG5cbi8qKlxuICogRXh0cmFjdCBicm93c2VyIHZlcnNpb24gb3V0IG9mIHRoZSBwcm92aWRlZCB1c2VyIGFnZW50IHN0cmluZy5cbiAqXG4gKiBAcGFyYW0geyFzdHJpbmd9IHVhc3RyaW5nIHVzZXJBZ2VudCBzdHJpbmcuXG4gKiBAcGFyYW0geyFzdHJpbmd9IGV4cHIgUmVndWxhciBleHByZXNzaW9uIHVzZWQgYXMgbWF0Y2ggY3JpdGVyaWEuXG4gKiBAcGFyYW0geyFudW1iZXJ9IHBvcyBwb3NpdGlvbiBpbiB0aGUgdmVyc2lvbiBzdHJpbmcgdG8gYmUgcmV0dXJuZWQuXG4gKiBAcmV0dXJuIHshbnVtYmVyfSBicm93c2VyIHZlcnNpb24uXG4gKi9cbmZ1bmN0aW9uIGV4dHJhY3RWZXJzaW9uKHVhc3RyaW5nLCBleHByLCBwb3MpIHtcbiAgdmFyIG1hdGNoID0gdWFzdHJpbmcubWF0Y2goZXhwcik7XG4gIHJldHVybiBtYXRjaCAmJiBtYXRjaC5sZW5ndGggPj0gcG9zICYmIHBhcnNlSW50KG1hdGNoW3Bvc10sIDEwKTtcbn1cblxuLy8gV3JhcHMgdGhlIHBlZXJjb25uZWN0aW9uIGV2ZW50IGV2ZW50TmFtZVRvV3JhcCBpbiBhIGZ1bmN0aW9uXG4vLyB3aGljaCByZXR1cm5zIHRoZSBtb2RpZmllZCBldmVudCBvYmplY3QgKG9yIGZhbHNlIHRvIHByZXZlbnRcbi8vIHRoZSBldmVudCkuXG5mdW5jdGlvbiB3cmFwUGVlckNvbm5lY3Rpb25FdmVudCh3aW5kb3csIGV2ZW50TmFtZVRvV3JhcCwgd3JhcHBlcikge1xuICBpZiAoIXdpbmRvdy5SVENQZWVyQ29ubmVjdGlvbikge1xuICAgIHJldHVybjtcbiAgfVxuICB2YXIgcHJvdG8gPSB3aW5kb3cuUlRDUGVlckNvbm5lY3Rpb24ucHJvdG90eXBlO1xuICB2YXIgbmF0aXZlQWRkRXZlbnRMaXN0ZW5lciA9IHByb3RvLmFkZEV2ZW50TGlzdGVuZXI7XG4gIHByb3RvLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbihuYXRpdmVFdmVudE5hbWUsIGNiKSB7XG4gICAgaWYgKG5hdGl2ZUV2ZW50TmFtZSAhPT0gZXZlbnROYW1lVG9XcmFwKSB7XG4gICAgICByZXR1cm4gbmF0aXZlQWRkRXZlbnRMaXN0ZW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgICB2YXIgd3JhcHBlZENhbGxiYWNrID0gZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIG1vZGlmaWVkRXZlbnQgPSB3cmFwcGVyKGUpO1xuICAgICAgaWYgKG1vZGlmaWVkRXZlbnQpIHtcbiAgICAgICAgY2IobW9kaWZpZWRFdmVudCk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLl9ldmVudE1hcCA9IHRoaXMuX2V2ZW50TWFwIHx8IHt9O1xuICAgIHRoaXMuX2V2ZW50TWFwW2NiXSA9IHdyYXBwZWRDYWxsYmFjaztcbiAgICByZXR1cm4gbmF0aXZlQWRkRXZlbnRMaXN0ZW5lci5hcHBseSh0aGlzLCBbbmF0aXZlRXZlbnROYW1lLFxuICAgICAgd3JhcHBlZENhbGxiYWNrXSk7XG4gIH07XG5cbiAgdmFyIG5hdGl2ZVJlbW92ZUV2ZW50TGlzdGVuZXIgPSBwcm90by5yZW1vdmVFdmVudExpc3RlbmVyO1xuICBwcm90by5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24obmF0aXZlRXZlbnROYW1lLCBjYikge1xuICAgIGlmIChuYXRpdmVFdmVudE5hbWUgIT09IGV2ZW50TmFtZVRvV3JhcCB8fCAhdGhpcy5fZXZlbnRNYXBcbiAgICAgICAgfHwgIXRoaXMuX2V2ZW50TWFwW2NiXSkge1xuICAgICAgcmV0dXJuIG5hdGl2ZVJlbW92ZUV2ZW50TGlzdGVuZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG4gICAgdmFyIHVud3JhcHBlZENiID0gdGhpcy5fZXZlbnRNYXBbY2JdO1xuICAgIGRlbGV0ZSB0aGlzLl9ldmVudE1hcFtjYl07XG4gICAgcmV0dXJuIG5hdGl2ZVJlbW92ZUV2ZW50TGlzdGVuZXIuYXBwbHkodGhpcywgW25hdGl2ZUV2ZW50TmFtZSxcbiAgICAgIHVud3JhcHBlZENiXSk7XG4gIH07XG5cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvLCAnb24nICsgZXZlbnROYW1lVG9XcmFwLCB7XG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzWydfb24nICsgZXZlbnROYW1lVG9XcmFwXTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24oY2IpIHtcbiAgICAgIGlmICh0aGlzWydfb24nICsgZXZlbnROYW1lVG9XcmFwXSkge1xuICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lVG9XcmFwLFxuICAgICAgICAgICAgdGhpc1snX29uJyArIGV2ZW50TmFtZVRvV3JhcF0pO1xuICAgICAgICBkZWxldGUgdGhpc1snX29uJyArIGV2ZW50TmFtZVRvV3JhcF07XG4gICAgICB9XG4gICAgICBpZiAoY2IpIHtcbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZVRvV3JhcCxcbiAgICAgICAgICAgIHRoaXNbJ19vbicgKyBldmVudE5hbWVUb1dyYXBdID0gY2IpO1xuICAgICAgfVxuICAgIH0sXG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBjb25maWd1cmFibGU6IHRydWVcbiAgfSk7XG59XG5cbi8vIFV0aWxpdHkgbWV0aG9kcy5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBleHRyYWN0VmVyc2lvbjogZXh0cmFjdFZlcnNpb24sXG4gIHdyYXBQZWVyQ29ubmVjdGlvbkV2ZW50OiB3cmFwUGVlckNvbm5lY3Rpb25FdmVudCxcbiAgZGlzYWJsZUxvZzogZnVuY3Rpb24oYm9vbCkge1xuICAgIGlmICh0eXBlb2YgYm9vbCAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICByZXR1cm4gbmV3IEVycm9yKCdBcmd1bWVudCB0eXBlOiAnICsgdHlwZW9mIGJvb2wgK1xuICAgICAgICAgICcuIFBsZWFzZSB1c2UgYSBib29sZWFuLicpO1xuICAgIH1cbiAgICBsb2dEaXNhYmxlZF8gPSBib29sO1xuICAgIHJldHVybiAoYm9vbCkgPyAnYWRhcHRlci5qcyBsb2dnaW5nIGRpc2FibGVkJyA6XG4gICAgICAgICdhZGFwdGVyLmpzIGxvZ2dpbmcgZW5hYmxlZCc7XG4gIH0sXG5cbiAgLyoqXG4gICAqIERpc2FibGUgb3IgZW5hYmxlIGRlcHJlY2F0aW9uIHdhcm5pbmdzXG4gICAqIEBwYXJhbSB7IWJvb2xlYW59IGJvb2wgc2V0IHRvIHRydWUgdG8gZGlzYWJsZSB3YXJuaW5ncy5cbiAgICovXG4gIGRpc2FibGVXYXJuaW5nczogZnVuY3Rpb24oYm9vbCkge1xuICAgIGlmICh0eXBlb2YgYm9vbCAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICByZXR1cm4gbmV3IEVycm9yKCdBcmd1bWVudCB0eXBlOiAnICsgdHlwZW9mIGJvb2wgK1xuICAgICAgICAgICcuIFBsZWFzZSB1c2UgYSBib29sZWFuLicpO1xuICAgIH1cbiAgICBkZXByZWNhdGlvbldhcm5pbmdzXyA9ICFib29sO1xuICAgIHJldHVybiAnYWRhcHRlci5qcyBkZXByZWNhdGlvbiB3YXJuaW5ncyAnICsgKGJvb2wgPyAnZGlzYWJsZWQnIDogJ2VuYWJsZWQnKTtcbiAgfSxcblxuICBsb2c6IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0Jykge1xuICAgICAgaWYgKGxvZ0Rpc2FibGVkXykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBjb25zb2xlLmxvZyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmd1bWVudHMpO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogU2hvd3MgYSBkZXByZWNhdGlvbiB3YXJuaW5nIHN1Z2dlc3RpbmcgdGhlIG1vZGVybiBhbmQgc3BlYy1jb21wYXRpYmxlIEFQSS5cbiAgICovXG4gIGRlcHJlY2F0ZWQ6IGZ1bmN0aW9uKG9sZE1ldGhvZCwgbmV3TWV0aG9kKSB7XG4gICAgaWYgKCFkZXByZWNhdGlvbldhcm5pbmdzXykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zb2xlLndhcm4ob2xkTWV0aG9kICsgJyBpcyBkZXByZWNhdGVkLCBwbGVhc2UgdXNlICcgKyBuZXdNZXRob2QgK1xuICAgICAgICAnIGluc3RlYWQuJyk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEJyb3dzZXIgZGV0ZWN0b3IuXG4gICAqXG4gICAqIEByZXR1cm4ge29iamVjdH0gcmVzdWx0IGNvbnRhaW5pbmcgYnJvd3NlciBhbmQgdmVyc2lvblxuICAgKiAgICAgcHJvcGVydGllcy5cbiAgICovXG4gIGRldGVjdEJyb3dzZXI6IGZ1bmN0aW9uKHdpbmRvdykge1xuICAgIHZhciBuYXZpZ2F0b3IgPSB3aW5kb3cgJiYgd2luZG93Lm5hdmlnYXRvcjtcblxuICAgIC8vIFJldHVybmVkIHJlc3VsdCBvYmplY3QuXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIHJlc3VsdC5icm93c2VyID0gbnVsbDtcbiAgICByZXN1bHQudmVyc2lvbiA9IG51bGw7XG5cbiAgICAvLyBGYWlsIGVhcmx5IGlmIGl0J3Mgbm90IGEgYnJvd3NlclxuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyB8fCAhd2luZG93Lm5hdmlnYXRvcikge1xuICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnTm90IGEgYnJvd3Nlci4nO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICBpZiAobmF2aWdhdG9yLm1vekdldFVzZXJNZWRpYSkgeyAvLyBGaXJlZm94LlxuICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnZmlyZWZveCc7XG4gICAgICByZXN1bHQudmVyc2lvbiA9IGV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsXG4gICAgICAgICAgL0ZpcmVmb3hcXC8oXFxkKylcXC4vLCAxKTtcbiAgICB9IGVsc2UgaWYgKG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEpIHtcbiAgICAgIC8vIENocm9tZSwgQ2hyb21pdW0sIFdlYnZpZXcsIE9wZXJhLlxuICAgICAgLy8gVmVyc2lvbiBtYXRjaGVzIENocm9tZS9XZWJSVEMgdmVyc2lvbi5cbiAgICAgIHJlc3VsdC5icm93c2VyID0gJ2Nocm9tZSc7XG4gICAgICByZXN1bHQudmVyc2lvbiA9IGV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsXG4gICAgICAgICAgL0Nocm9tKGV8aXVtKVxcLyhcXGQrKVxcLi8sIDIpO1xuICAgIH0gZWxzZSBpZiAobmF2aWdhdG9yLm1lZGlhRGV2aWNlcyAmJlxuICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9FZGdlXFwvKFxcZCspLihcXGQrKSQvKSkgeyAvLyBFZGdlLlxuICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnZWRnZSc7XG4gICAgICByZXN1bHQudmVyc2lvbiA9IGV4dHJhY3RWZXJzaW9uKG5hdmlnYXRvci51c2VyQWdlbnQsXG4gICAgICAgICAgL0VkZ2VcXC8oXFxkKykuKFxcZCspJC8sIDIpO1xuICAgIH0gZWxzZSBpZiAod2luZG93LlJUQ1BlZXJDb25uZWN0aW9uICYmXG4gICAgICAgIG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FwcGxlV2ViS2l0XFwvKFxcZCspXFwuLykpIHsgLy8gU2FmYXJpLlxuICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnc2FmYXJpJztcbiAgICAgIHJlc3VsdC52ZXJzaW9uID0gZXh0cmFjdFZlcnNpb24obmF2aWdhdG9yLnVzZXJBZ2VudCxcbiAgICAgICAgICAvQXBwbGVXZWJLaXRcXC8oXFxkKylcXC4vLCAxKTtcbiAgICB9IGVsc2UgeyAvLyBEZWZhdWx0IGZhbGx0aHJvdWdoOiBub3Qgc3VwcG9ydGVkLlxuICAgICAgcmVzdWx0LmJyb3dzZXIgPSAnTm90IGEgc3VwcG9ydGVkIGJyb3dzZXIuJztcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxufTtcbiIsIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogTGljZW5zZSBpbmZvIGZvciB3ZWJydGMtYWRhcHRlciBtb2R1bGUgYXNzZW1ibGVkIGludG8ganMgYnVuZGxlOlxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxNCwgVGhlIFdlYlJUQyBwcm9qZWN0IGF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0IG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuICpcbiAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci5cbiAqXG4gKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhlIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uXG4gKlxuICogTmVpdGhlciB0aGUgbmFtZSBvZiBHb29nbGUgbm9yIHRoZSBuYW1lcyBvZiBpdHMgY29udHJpYnV0b3JzIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0IHNwZWNpZmljIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi5cbiAqXG4gKiBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTIFwiQVMgSVNcIiBBTkQgQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQ09QWVJJR0hUIEhPTERFUiBPUiBDT05UUklCVVRPUlMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTIE9GIFVTRSwgREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQgT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksIE9SIFRPUlQgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVMgU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIExpY2Vuc2UgaW5mbyBmb3Igc2RwIG1vZHVsZSBhc3NlbWJsZWQgaW50byBqcyBidW5kbGU6XG4gKlxuICogU2VlIGh0dHBzOi8vd3d3Lm5wbWpzLmNvbS9wYWNrYWdlL3NkcFxuICovXG5pbXBvcnQgJ3dlYnJ0Yy1hZGFwdGVyJztcbi8qKlxuICogQGxpY2Vuc2VcbiAqIExpY2Vuc2UgaW5mbyBmb3IgdXVpZCBtb2R1bGUgYXNzZW1ibGVkIGludG8ganMgYnVuZGxlOlxuICpcbiAqIFRoZSBNSVQgTGljZW5zZSAoTUlUKVxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxMC0yMDE2IFJvYmVydCBLaWVmZmVyIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICpcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICpcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuICovXG5pbXBvcnQgUnRjU2Vzc2lvbiBmcm9tICcuL3J0Y19zZXNzaW9uJztcbmltcG9ydCB7UlRDX0VSUk9SU30gZnJvbSAnLi9ydGNfY29uc3QnO1xuaW1wb3J0IFJ0Y1BlZXJDb25uZWN0aW9uRmFjdG9yeSBmcm9tICcuL3J0Y19wZWVyX2Nvbm5lY3Rpb25fZmFjdG9yeSdcbmltcG9ydCB1dWlkIGZyb20gJ3V1aWQvdjQnO1xuaW1wb3J0IFN0YW5kYXJkU3RyYXRlZ3kgZnJvbSBcIi4vc3RyYXRlZ2llcy9TdGFuZGFyZFN0cmF0ZWd5XCI7XG5pbXBvcnQgQ2l0cml4VkRJU3RyYXRlZ3kgZnJvbSBcIi4vc3RyYXRlZ2llcy9DaXRyaXhWRElTdHJhdGVneVwiO1xuXG5nbG9iYWwuY29ubmVjdCA9IGdsb2JhbC5jb25uZWN0IHx8IHt9O1xuZ2xvYmFsLmNvbm5lY3QuUlRDU2Vzc2lvbiA9IFJ0Y1Nlc3Npb247XG5nbG9iYWwuY29ubmVjdC5SVENFcnJvcnMgPSBSVENfRVJST1JTO1xuZ2xvYmFsLmNvbm5lY3QuUnRjUGVlckNvbm5lY3Rpb25GYWN0b3J5ID0gUnRjUGVlckNvbm5lY3Rpb25GYWN0b3J5O1xuZ2xvYmFsLmNvbm5lY3QudXVpZCA9IHV1aWQ7XG5nbG9iYWwuY29ubmVjdC5TdGFuZGFyZFN0cmF0ZWd5ID0gU3RhbmRhcmRTdHJhdGVneTtcbmdsb2JhbC5jb25uZWN0LkNpdHJpeFZESVN0cmF0ZWd5ID0gQ2l0cml4VkRJU3RyYXRlZ3k7XG5cbmdsb2JhbC5saWx5ID0gZ2xvYmFsLmxpbHkgfHwge307XG5nbG9iYWwubGlseS5SVENTZXNzaW9uID0gUnRjU2Vzc2lvbjtcbmdsb2JhbC5saWx5LlJUQ0Vycm9ycyA9IFJUQ19FUlJPUlM7XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiAqL1xuZXhwb3J0IGNvbnN0IFRpbWVvdXRFeGNlcHRpb25OYW1lID0gJ1RpbWVvdXQnO1xuZXhwb3J0IGNsYXNzIFRpbWVvdXQgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IobXNnKSB7XG4gICAgICAgIHN1cGVyKG1zZyk7XG4gICAgICAgIHRoaXMubmFtZSA9IFRpbWVvdXRFeGNlcHRpb25OYW1lO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IEd1bVRpbWVvdXRFeGNlcHRpb25OYW1lID0gJ0d1bVRpbWVvdXQnO1xuZXhwb3J0IGNsYXNzIEd1bVRpbWVvdXQgZXh0ZW5kcyBUaW1lb3V0IHtcbiAgICBjb25zdHJ1Y3Rvcihtc2cpIHtcbiAgICAgICAgc3VwZXIobXNnKTtcbiAgICAgICAgdGhpcy5uYW1lID0gR3VtVGltZW91dEV4Y2VwdGlvbk5hbWU7XG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgSWxsZWdhbFBhcmFtZXRlcnNFeGNlcHRpb25OYW1lID0gJ0lsbGVnYWxQYXJhbWV0ZXJzJztcbmV4cG9ydCBjbGFzcyBJbGxlZ2FsUGFyYW1ldGVycyBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3Rvcihtc2cpIHtcbiAgICAgICAgc3VwZXIobXNnKTtcbiAgICAgICAgdGhpcy5uYW1lID0gSWxsZWdhbFBhcmFtZXRlcnNFeGNlcHRpb25OYW1lO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbk5hbWUgPSAnSWxsZWdhbFN0YXRlJztcbmV4cG9ydCBjbGFzcyBJbGxlZ2FsU3RhdGUgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IobXNnKSB7XG4gICAgICAgIHN1cGVyKG1zZyk7XG4gICAgICAgIHRoaXMubmFtZSA9IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbk5hbWU7XG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25OYW1lID0gJ1Vuc3VwcG9ydGVkT3BlcmF0aW9uJztcbmV4cG9ydCBjbGFzcyBVbnN1cHBvcnRlZE9wZXJhdGlvbiBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3Rvcihtc2cpIHtcbiAgICAgICAgc3VwZXIobXNnKTtcbiAgICAgICAgdGhpcy5uYW1lID0gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25OYW1lO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IEJ1c3lFeGNlcHRpb25OYW1lID0gJ0J1c3lFeGNlcHRpb24nO1xuZXhwb3J0IGNsYXNzIEJ1c3lFeGNlcHRpb24gZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IobXNnKSB7XG4gICAgICAgIHN1cGVyKG1zZyk7XG4gICAgICAgIHRoaXMubmFtZSA9IEJ1c3lFeGNlcHRpb25OYW1lO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IENhbGxOb3RGb3VuZEV4Y2VwdGlvbk5hbWUgPSAnQ2FsbE5vdEZvdW5kRXhjZXB0aW9uJztcbmV4cG9ydCBjbGFzcyBDYWxsTm90Rm91bmRFeGNlcHRpb24gZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IobXNnKSB7XG4gICAgICAgIHN1cGVyKG1zZyk7XG4gICAgICAgIHRoaXMubmFtZSA9IENhbGxOb3RGb3VuZEV4Y2VwdGlvbk5hbWU7XG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgVW5rbm93blNpZ25hbGluZ0Vycm9yTmFtZSA9ICdVbmtub3duU2lnbmFsaW5nRXJyb3InO1xuZXhwb3J0IGNsYXNzIFVua25vd25TaWduYWxpbmdFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5uYW1lID0gVW5rbm93blNpZ25hbGluZ0Vycm9yTmFtZTtcbiAgICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiAqL1xuXG4vKipcbiAqIFRpbWVvdXQgd2FpdGluZyBmb3Igc2VydmVyIHJlc3BvbnNlIHRvIGFjY2VwdC9oYW5ndXAgcmVxdWVzdC5cbiAqL1xuZXhwb3J0IGNvbnN0IE1BWF9BQ0NFUFRfQllFX0RFTEFZX01TID0gMjAwMDtcbi8qKlxuICogVGltZW91dCB3YWl0aW5nIGZvciBzZXJ2ZXIgcmVzcG9uc2UgdG8gaW52aXRlLlxuICovXG5leHBvcnQgY29uc3QgTUFYX0lOVklURV9ERUxBWV9NUyA9IDUwMDA7XG4vKipcbiAqICBEZWZhdWx0IHRpbWVvdXQgb24gb3BlbmluZyBXZWJTb2NrZXQgY29ubmVjdGlvbi5cbiAqL1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfQ09OTkVDVF9USU1FT1VUX01TID0gMTAwMDA7XG4vKipcbiAqIERlZmF1bHQgaWNlIGNvbGxlY3Rpb24gdGltZW91dCBpbiBtaWxsaXNlY29uZHMuXG4gKi9cbmV4cG9ydCBjb25zdCBERUZBVUxUX0lDRV9USU1FT1VUX01TID0gODAwMDtcbi8qKlxuICogRGVmYXVsdCBndW0gdGltZW91dCBpbiBtaWxsaXNlY29uZHMgdG8gYmUgZW5mb3JjZWQgZHVyaW5nIHN0YXJ0IG9mIGEgY2FsbC5cbiAqL1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfR1VNX1RJTUVPVVRfTVMgPSAxMDAwMDtcblxuZXhwb3J0IGNvbnN0IFNPRlRQSE9ORV9ST1VURV9LRVkgPSBcImF3cy9zb2Z0cGhvbmVcIjtcblxuZXhwb3J0IGNvbnN0IElOVklURV9NRVRIT0RfTkFNRSA9IFwiaW52aXRlXCI7XG5leHBvcnQgY29uc3QgQUNDRVBUX01FVEhPRF9OQU1FID0gXCJhY2NlcHRcIjtcbmV4cG9ydCBjb25zdCBCWUVfTUVUSE9EX05BTUUgPSBcImJ5ZVwiO1xuXG5leHBvcnQgY29uc3QgUlRDX1BFRVJfQ09OTkVDVElPTl9DT05GSUcgPSB7XG4gICAgaWNlVHJhbnNwb3J0UG9saWN5OiAncmVsYXknLFxuICAgIHJ0Y3BNdXhQb2xpY3k6ICdyZXF1aXJlJyxcbiAgICBidW5kbGVQb2xpY3k6ICdiYWxhbmNlZCcsXG4gICAgc2RwU2VtYW50aWNzOiAndW5pZmllZC1wbGFuJyxcbiAgICBlbmFibGVEdGxzU3J0cDogdHJ1ZVxufTtcblxuZXhwb3J0IGNvbnN0IFJUQ19QRUVSX0NPTk5FQ1RJT05fT1BUSU9OQUxfQ09ORklHID0ge1xuICAgIG9wdGlvbmFsOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvb2dEc2NwOiB0cnVlXG5cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgRHRsc1NydHBLZXlBZ3JlZW1lbnQ6IHRydWVcbiAgICAgICAgfVxuICAgIF1cbn07XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX0lDRV9DQU5ESURBVEVfUE9PTF9TSVpFID0gMTtcblxuZXhwb3J0IGNvbnN0IFJUQ19QRUVSX0NPTk5FQ1RJT05fSURMRV9USU1FT1VUX01TID0gMSo2MCoxMDAwO1xuXG5leHBvcnQgY29uc3QgTkVUV09SS19DT05ORUNUSVZJVFlfQ0hFQ0tfSU5URVJWQUxfTVMgPSAyNTA7XG5cbmV4cG9ydCBjb25zdCBDSFJPTUVfU1VQUE9SVEVEX1ZFUlNJT04gPSA1OTtcblxuLyoqXG4gKiBSVEMgZXJyb3IgbmFtZXMuXG4gKi9cbmV4cG9ydCBjb25zdCBSVENfRVJST1JTID0ge1xuICAgIElDRV9DT0xMRUNUSU9OX1RJTUVPVVQgOiAnSWNlIENvbGxlY3Rpb24gVGltZW91dCcsXG4gICAgVVNFUl9CVVNZIDogJ1VzZXIgQnVzeScsXG4gICAgU0lHTkFMTElOR19DT05ORUNUSU9OX0ZBSUxVUkUgOiAnU2lnbmFsbGluZyBDb25uZWN0aW9uIEZhaWx1cmUnLFxuICAgIFNJR05BTExJTkdfSEFORFNIQUtFX0ZBSUxVUkUgOiAnU2lnbmFsbGluZyBIYW5kc2hha2UgRmFpbHVyZScsXG4gICAgU0VUX1JFTU9URV9ERVNDUklQVElPTl9GQUlMVVJFIDogJ1NldCBSZW1vdGUgRGVzY3JpcHRpb24gRmFpbHVyZScsXG4gICAgQ1JFQVRFX09GRkVSX0ZBSUxVUkUgOiAnQ3JlYXRlIE9mZmVyIEZhaWx1cmUnLFxuICAgIFNFVF9MT0NBTF9ERVNDUklQVElPTl9GQUlMVVJFIDogJ1NldCBMb2NhbCBEZXNjcmlwdGlvbiBGYWlsdXJlJyxcbiAgICBJTlZBTElEX1JFTU9URV9TRFAgOiAnSW52YWxpZCBSZW1vdGUgU0RQJyxcbiAgICBOT19SRU1PVEVfSUNFX0NBTkRJREFURSA6ICdObyBSZW1vdGUgSUNFIENhbmRpZGF0ZScsXG4gICAgR1VNX1RJTUVPVVRfRkFJTFVSRSA6ICdHVU0gVGltZW91dCBGYWlsdXJlJyxcbiAgICBHVU1fT1RIRVJfRkFJTFVSRSA6ICdHVU0gT3RoZXIgRmFpbHVyZScsXG4gICAgQ0FMTF9OT1RfRk9VTkQ6ICdDYWxsIE5vdCBGb3VuZCdcbn07XG5cbmV4cG9ydCBjb25zdCBJQ0VfQ09OTkVDVElPTl9TVEFURSA9IHtcbiAgICBORVcgOiAnbmV3JyxcbiAgICBDSEVDS0lORyA6ICdjaGVja2luZycsXG4gICAgQ09OTkVDVEVEIDogJ2Nvbm5lY3RlZCcsXG4gICAgQ09NUExFVEVEIDogJ2NvbXBsZXRlZCcsXG4gICAgRkFJTEVEIDogJ2ZhaWxlZCcsXG4gICAgRElTQ09OTkVDVEVEIDogJ2Rpc2Nvbm5lY3RlZCcsXG4gICAgQ0xPU0VEIDogJ2Nsb3NlZCdcbn07XG5cbmV4cG9ydCBjb25zdCBQRUVSX0NPTk5FQ1RJT05fU1RBVEUgPSB7XG4gICAgTkVXIDogJ25ldycsXG4gICAgQ09OTkVDVElORyA6ICdjb25uZWN0aW5nJyxcbiAgICBDT05ORUNURUQgOiAnY29ubmVjdGVkJyxcbiAgICBGQUlMRUQgOiAnZmFpbGVkJyxcbiAgICBESVNDT05ORUNURUQgOiAnZGlzY29ubmVjdGVkJyxcbiAgICBDTE9TRUQgOiAnY2xvc2VkJ1xufTsiLCJpbXBvcnQge2Fzc2VydFRydWUsIGhpdGNoLCBpc0Z1bmN0aW9ufSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7XG4gICAgREVGQVVMVF9JQ0VfQ0FORElEQVRFX1BPT0xfU0laRSxcbiAgICBORVRXT1JLX0NPTk5FQ1RJVklUWV9DSEVDS19JTlRFUlZBTF9NUyxcbiAgICBSVENfUEVFUl9DT05ORUNUSU9OX0NPTkZJRyxcbiAgICBSVENfUEVFUl9DT05ORUNUSU9OX0lETEVfVElNRU9VVF9NUyxcbiAgICBSVENfUEVFUl9DT05ORUNUSU9OX09QVElPTkFMX0NPTkZJRyxcbiAgICBTT0ZUUEhPTkVfUk9VVEVfS0VZXG59IGZyb20gJy4vcnRjX2NvbnN0J1xuaW1wb3J0IENDUEluaXRpYXRpb25TdHJhdGVneUludGVyZmFjZSBmcm9tIFwiLi9zdHJhdGVnaWVzL0NDUEluaXRpYXRpb25TdHJhdGVneUludGVyZmFjZVwiO1xuaW1wb3J0IFN0YW5kYXJkU3RyYXRlZ3kgZnJvbSBcIi4vc3RyYXRlZ2llcy9TdGFuZGFyZFN0cmF0ZWd5XCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJ0Y1BlZXJDb25uZWN0aW9uRmFjdG9yeSB7XG5cbiAgICAvL3RyYW5zcG9ydEhhbmRsZSBtdXN0IGJlIGEgY2FsbGJhY2sgZnVuY3Rpb24gd2hpY2ggc2hvdWxkIHJldHVybiBhIHByb21pc2Ugd2hpY2ggaXMgZ29pbmcgdG8gcmV0dXJuIHRoZSBpY2VTZXJ2ZXJzLiBQbGVhc2UgcmVmZXIgaHR0cHM6Ly93d3cudzMub3JnL1RSL3dlYnJ0Yy8jcnRjaWNlc2VydmVyLWRpY3Rpb25hcnkgZm9yIGljZVNlcnZlciBleGFtcGxlXG4gICAgLy9wdWJsaXNoRXJyb3IoZXJyb3JUeXBlLCBlcnJvck1lc3NhZ2UpIG11c3QgYmUgYSBjYWxsYmFjayBmdW5jdGlvbiB3aGljaCB3aWxsIHB1Ymxpc2ggdGhlIHBhc3NlZCBlcnJvciBtZXNzYWdlIHRvIGNsaWVudCBicm93c2VyXG4gICAgY29uc3RydWN0b3IobG9nZ2VyLCB3c3NNYW5hZ2VyLCBjbGllbnRJZCwgdHJhbnNwb3J0SGFuZGxlLCBwdWJsaXNoRXJyb3IsIHN0cmF0ZWd5ID0gbmV3IFN0YW5kYXJkU3RyYXRlZ3koKSkge1xuICAgICAgICBpZiAoIShzdHJhdGVneSBpbnN0YW5jZW9mIENDUEluaXRpYXRpb25TdHJhdGVneUludGVyZmFjZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgYSBzdHJhdGVneSBvZiB0eXBlIENDUEluaXRpYXRpb25TdHJhdGVneUludGVyZmFjZScpO1xuICAgICAgICB9XG4gICAgICAgIGFzc2VydFRydWUoaXNGdW5jdGlvbih0cmFuc3BvcnRIYW5kbGUpLCAndHJhbnNwb3J0SGFuZGxlIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgICAgICBhc3NlcnRUcnVlKGlzRnVuY3Rpb24ocHVibGlzaEVycm9yKSwgJ3B1Ymxpc2hFcnJvciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICAgICAgdGhpcy5fc3RyYXRlZ3kgPSBzdHJhdGVneTtcbiAgICAgICAgdGhpcy5fbG9nZ2VyID0gbG9nZ2VyO1xuICAgICAgICB0aGlzLl9jbGllbnRJZCA9IGNsaWVudElkO1xuICAgICAgICB0aGlzLl93c3NNYW5hZ2VyID0gd3NzTWFuYWdlcjtcbiAgICAgICAgdGhpcy5fcmVxdWVzdEljZUFjY2VzcyA9IHRyYW5zcG9ydEhhbmRsZTtcbiAgICAgICAgdGhpcy5fcHVibGlzaEVycm9yID0gcHVibGlzaEVycm9yO1xuICAgICAgICB0aGlzLl9lYXJseU1lZGlhQ29ubmVjdGlvblN1cHBvcnRlZCA9IHRoaXMuX2lzRWFybHlNZWRpYUNvbm5lY3Rpb25TdXBwb3J0ZWQoKTtcbiAgICAgICAgdGhpcy5faW5pdGlhbGl6ZVdlYlNvY2tldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIHRoaXMuX3JlcXVlc3RQZWVyQ29ubmVjdGlvbigpO1xuICAgICAgICB0aGlzLl9uZXR3b3JrQ29ubmVjdGl2aXR5Q2hlY2tlcigpO1xuXG4gICAgICAgIHRoaXMuX2xvZ2dlci5sb2coXCJSVEMuanMgaXMgdXNpbmcgXCIgKyBzdHJhdGVneS5nZXRTdHJhdGVneU5hbWUoKSk7XG4gICAgfVxuXG4gICAgX2lzRWFybHlNZWRpYUNvbm5lY3Rpb25TdXBwb3J0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdHJhdGVneS5faXNFYXJseU1lZGlhQ29ubmVjdGlvblN1cHBvcnRlZCgpO1xuICAgIH1cblxuICAgIC8vVGhpcyB3aWxsIGhhbmRsZSB0aGUgaWRsZUNvbm5lY3Rpb24gYW5kIHF1b3RhIGxpbWl0cyBub3RpZmljYXRpb24gZnJvbSB0aGUgc2VydmVyXG4gICAgX3dlYlNvY2tldE1hbmFnZXJPbk1lc3NhZ2UoZXZlbnQpIHtcbiAgICAgICAgbGV0IGNvbnRlbnQ7XG4gICAgICAgIGlmIChldmVudC5jb250ZW50KSB7XG4gICAgICAgICAgICBjb250ZW50ID0gSlNPTi5wYXJzZShldmVudC5jb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29udGVudCAmJiB0aGlzLl9jbGllbnRJZCA9PT0gY29udGVudC5jbGllbnRJZCkge1xuICAgICAgICAgICAgaWYgKGNvbnRlbnQuanNvblJwY01zZy5tZXRob2QgPT09IFwiaWRsZUNvbm5lY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NsZWFySWRsZVJ0Y1BlZXJDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRlbnQuanNvblJwY01zZy5tZXRob2QgPT09IFwicXVvdGFCcmVhY2hlZFwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9nZ2VyLmxvZyhcIk51bWJlciBvZiBhY3RpdmUgc2Vzc2lvbnMgYXJlIG1vcmUgdGhlbiBhbGxvd2VkIGxpbWl0IGZvciB0aGUgY2xpZW50IFwiICsgdGhpcy5fY2xpZW50SWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2Nsb3NlUlRDUGVlckNvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9wdWJsaXNoRXJyb3IoXCJtdWx0aXBsZV9zb2Z0cGhvbmVfYWN0aXZlX3Nlc3Npb25zXCIsIFwiTnVtYmVyIG9mIGFjdGl2ZSBzZXNzaW9ucyBhcmUgbW9yZSB0aGVuIGFsbG93ZWQgbGltaXQuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2luaXRpYWxpemVXZWJTb2NrZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5fd3NzTWFuYWdlci5zdWJzY3JpYmVUb3BpY3MoW1NPRlRQSE9ORV9ST1VURV9LRVldKTtcbiAgICAgICAgdGhpcy5fdW5TdWJzY3JpYmUgPSB0aGlzLl93c3NNYW5hZ2VyLm9uTWVzc2FnZShTT0ZUUEhPTkVfUk9VVEVfS0VZLCBoaXRjaCh0aGlzLCB0aGlzLl93ZWJTb2NrZXRNYW5hZ2VyT25NZXNzYWdlKSk7XG4gICAgfVxuXG4gICAgLy8gVGhpcyBtZXRob2Qgd2lsbCBjcmVhdGUgYW5kIHJldHVybiBuZXcgcGVlciBjb25uZWN0aW9uIGlmIGJyb3dzZXIgaXMgbm90IHN1cHBvcnRpbmcgZWFybHkgaWNlIGNvbGxlY3Rpb24uXG4gICAgLy8gRm9yIHRoZSBzdXBwb3J0ZWQgYnJvd3NlciwgdGhpcyBtZXRob2Qgd2lsbCByZXF1ZXN0IGZvciBuZXcgcGVlckNvbm5lY3Rpb24gYWZ0ZXIgcmV0dXJuaW5nIHRoZSBleGlzdGluZyBwZWVyQ29ubmVjdGlvblxuICAgIGdldChpY2VTZXJ2ZXJzKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIHBjID0gc2VsZi5fcGM7XG4gICAgICAgIHNlbGYuX3BjID0gbnVsbDtcbiAgICAgICAgaWYgKHBjID09IG51bGwpIHtcbiAgICAgICAgICAgIHBjID0gc2VsZi5fY3JlYXRlUnRjUGVlckNvbm5lY3Rpb24oaWNlU2VydmVycyk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5jbGVhcklkbGVSdGNQZWVyQ29ubmVjdGlvblRpbWVySWQoKTtcbiAgICAgICAgc2VsZi5fcmVxdWVzdFBlZXJDb25uZWN0aW9uKCk7XG4gICAgICAgIHJldHVybiBwYztcbiAgICB9XG5cbiAgICBjbGVhcklkbGVSdGNQZWVyQ29ubmVjdGlvblRpbWVySWQoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgaWYgKHNlbGYuX2lkbGVSdGNQZWVyQ29ubmVjdGlvblRpbWVySWQpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dChzZWxmLl9pZGxlUnRjUGVlckNvbm5lY3Rpb25UaW1lcklkKTtcbiAgICAgICAgICAgIHNlbGYuX2lkbGVSdGNQZWVyQ29ubmVjdGlvblRpbWVySWQgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX3JlcXVlc3RQZWVyQ29ubmVjdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBpZiAoIXNlbGYuX3BlZXJDb25uZWN0aW9uUmVxdWVzdEluRmxpZ2h0ICYmIHNlbGYuX2Vhcmx5TWVkaWFDb25uZWN0aW9uU3VwcG9ydGVkKSB7XG4gICAgICAgICAgICBzZWxmLl9wZWVyQ29ubmVjdGlvblJlcXVlc3RJbkZsaWdodCA9IHRydWU7XG4gICAgICAgICAgICBzZWxmLl9yZXF1ZXN0SWNlQWNjZXNzKCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fcGMgPSBzZWxmLl9jcmVhdGVSdGNQZWVyQ29ubmVjdGlvbihyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3BlZXJDb25uZWN0aW9uUmVxdWVzdEluRmxpZ2h0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2lkbGVSdGNQZWVyQ29ubmVjdGlvblRpbWVySWQgPSBzZXRUaW1lb3V0KGhpdGNoKHNlbGYsIHNlbGYuX3JlZnJlc2hSdGNQZWVyQ29ubmVjdGlvbiksIFJUQ19QRUVSX0NPTk5FQ1RJT05fSURMRV9USU1FT1VUX01TKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fcGVlckNvbm5lY3Rpb25SZXF1ZXN0SW5GbGlnaHQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9uZXR3b3JrQ29ubmVjdGl2aXR5Q2hlY2tlcigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIW5hdmlnYXRvci5vbkxpbmUgJiYgc2VsZi5fcGMpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9sb2dnZXIubG9nKFwiTmV0d29yayBvZmZsaW5lLiBDbGVhbmluZyB1cCBlYXJseSBjb25uZWN0aW9uXCIpO1xuICAgICAgICAgICAgICAgIHNlbGYuX3BjLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgc2VsZi5fcGMgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBORVRXT1JLX0NPTk5FQ1RJVklUWV9DSEVDS19JTlRFUlZBTF9NUyk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZVJ0Y1BlZXJDb25uZWN0aW9uKGljZVNlcnZlcnMpIHtcbiAgICAgICAgdmFyIHJ0Y1BlZXJDb25uZWN0aW9uQ29uZmlnID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShSVENfUEVFUl9DT05ORUNUSU9OX0NPTkZJRykpO1xuICAgICAgICBydGNQZWVyQ29ubmVjdGlvbkNvbmZpZy5pY2VTZXJ2ZXJzID0gaWNlU2VydmVycztcbiAgICAgICAgcnRjUGVlckNvbm5lY3Rpb25Db25maWcuaWNlQ2FuZGlkYXRlUG9vbFNpemUgPSBERUZBVUxUX0lDRV9DQU5ESURBVEVfUE9PTF9TSVpFO1xuICAgICAgICByZXR1cm4gdGhpcy5fc3RyYXRlZ3kuX2NyZWF0ZVJ0Y1BlZXJDb25uZWN0aW9uKHJ0Y1BlZXJDb25uZWN0aW9uQ29uZmlnLCBSVENfUEVFUl9DT05ORUNUSU9OX09QVElPTkFMX0NPTkZJRyk7XG4gICAgfVxuXG4gICAgX2NsZWFySWRsZVJ0Y1BlZXJDb25uZWN0aW9uKCkge1xuICAgICAgICB0aGlzLl9sb2dnZXIubG9nKFwic2Vzc2lvbiBpcyBpZGxlIGZyb20gbG9uZyB0aW1lLiBjbG9zaW5nIHRoZSBwZWVyIGNvbm5lY3Rpb24gZm9yIGNsaWVudCBcIiArIHRoaXMuX2NsaWVudElkKTtcbiAgICAgICAgdGhpcy5fY2xvc2VSVENQZWVyQ29ubmVjdGlvbigpO1xuICAgIH1cblxuICAgIF9yZWZyZXNoUnRjUGVlckNvbm5lY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX2lkbGVSdGNQZWVyQ29ubmVjdGlvblRpbWVySWQgPSBudWxsO1xuICAgICAgICB0aGlzLl9jbGVhcklkbGVSdGNQZWVyQ29ubmVjdGlvbigpO1xuICAgICAgICB0aGlzLl9sb2dnZXIubG9nKFwicmVmcmVzaGluZyBwZWVyIGNvbm5lY3Rpb24gZm9yIGNsaWVudCBcIiArIHRoaXMuX2NsaWVudElkKTtcbiAgICAgICAgdGhpcy5fcmVxdWVzdFBlZXJDb25uZWN0aW9uKCk7XG4gICAgfVxuXG4gICAgX2Nsb3NlUlRDUGVlckNvbm5lY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLl9wYykge1xuICAgICAgICAgICAgdGhpcy5fcGMuY2xvc2UoKTtcbiAgICAgICAgICAgIHRoaXMuX3BjID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn0iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiAqL1xuaW1wb3J0IHtjbG9zZVN0cmVhbSwgaGl0Y2gsIGlzTGVnYWN5U3RhdHNSZXBvcnRTdXBwb3J0ZWQsIFNkcE9wdGlvbnMsIHRyYW5zZm9ybVNkcCwgd3JhcExvZ2dlcn0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQge1Nlc3Npb25SZXBvcnR9IGZyb20gJy4vc2Vzc2lvbl9yZXBvcnQnO1xuaW1wb3J0IHtcbiAgICBERUZBVUxUX0dVTV9USU1FT1VUX01TLFxuICAgIERFRkFVTFRfSUNFX1RJTUVPVVRfTVMsXG4gICAgUlRDX0VSUk9SUyxcbiAgICBSVENfUEVFUl9DT05ORUNUSU9OX0NPTkZJRyxcbiAgICBSVENfUEVFUl9DT05ORUNUSU9OX09QVElPTkFMX0NPTkZJRyxcbiAgICBJQ0VfQ09OTkVDVElPTl9TVEFURSxcbiAgICBQRUVSX0NPTk5FQ1RJT05fU1RBVEVcbn0gZnJvbSAnLi9ydGNfY29uc3QnO1xuaW1wb3J0IHtcbiAgICBCdXN5RXhjZXB0aW9uTmFtZSxcbiAgICBDYWxsTm90Rm91bmRFeGNlcHRpb25OYW1lLFxuICAgIEd1bVRpbWVvdXQsXG4gICAgSWxsZWdhbFBhcmFtZXRlcnMsXG4gICAgSWxsZWdhbFN0YXRlLFxuICAgIFVuc3VwcG9ydGVkT3BlcmF0aW9uXG59IGZyb20gJy4vZXhjZXB0aW9ucyc7XG5pbXBvcnQgUnRjU2lnbmFsaW5nIGZyb20gJy4vc2lnbmFsaW5nJztcbmltcG9ydCB1dWlkIGZyb20gJ3V1aWQvdjQnO1xuaW1wb3J0IHtleHRyYWN0TWVkaWFTdGF0c0Zyb21TdGF0c30gZnJvbSAnLi9ydHAtc3RhdHMnO1xuaW1wb3J0IHtwYXJzZUNhbmRpZGF0ZX0gZnJvbSAnc2RwJztcbmltcG9ydCBDQ1BJbml0aWF0aW9uU3RyYXRlZ3lJbnRlcmZhY2UgZnJvbSBcIi4vc3RyYXRlZ2llcy9DQ1BJbml0aWF0aW9uU3RyYXRlZ3lJbnRlcmZhY2VcIjtcbmltcG9ydCBTdGFuZGFyZFN0cmF0ZWd5IGZyb20gXCIuL3N0cmF0ZWdpZXMvU3RhbmRhcmRTdHJhdGVneVwiO1xuXG5leHBvcnQgY2xhc3MgUlRDU2Vzc2lvblN0YXRlIHtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UnRjU2Vzc2lvbn0gcnRjU2Vzc2lvblxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJ0Y1Nlc3Npb24pIHtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbiA9IHJ0Y1Nlc3Npb247XG4gICAgfVxuICAgIG9uRW50ZXIoKSB7XG4gICAgfVxuICAgIG9uRXhpdCgpIHtcbiAgICB9XG4gICAgX2lzQ3VycmVudFN0YXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcnRjU2Vzc2lvbi5fc3RhdGUgPT09IHRoaXM7XG4gICAgfVxuICAgIHRyYW5zaXQobmV4dFN0YXRlKSB7XG4gICAgICAgIGlmICh0aGlzLl9pc0N1cnJlbnRTdGF0ZSgpKSB7XG4gICAgICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLnRyYW5zaXQobmV4dFN0YXRlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbG9nZ2VyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcnRjU2Vzc2lvbi5fbG9nZ2VyO1xuICAgIH1cbiAgICBoYW5ndXAoKSB7XG4gICAgICAgIHRoaXMudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUodGhpcy5fcnRjU2Vzc2lvbikpO1xuICAgIH1cbiAgICBvbkljZUNhbmRpZGF0ZShldnQpIHsvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXG4gICAgICAgIC8vaWdub3JlIGNhbmRpZGF0ZSBieSBkZWZhdWx0LCBDb25uZWN0U2lnbmFsaW5nQW5kSWNlQ29sbGVjdGlvblN0YXRlIHdpbGwgb3ZlcnJpZGUgdG8gY29sbGVjdCBjYW5kaWRhdGVzLCBidXQgY29sbGVjdGluZyBwcm9jZXNzIGNvdWxkIGxhc3QgbXVjaCBsb25nZXIgdGhhbiBDb25uZWN0U2lnbmFsaW5nQW5kSWNlQ29sbGVjdGlvblN0YXRlXG4gICAgICAgIC8vd2UgZG9uJ3Qgd2FudCB0byBzcGFtIHRoZSBjb25zb2xlIGxvZ1xuICAgIH1cbiAgICBvblJlbW90ZUh1bmd1cCgpIHtcbiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uKCdvblJlbW90ZUh1bmd1cCBub3QgaW1wbGVtZW50ZWQgYnkgJyArIHRoaXMubmFtZSk7XG4gICAgfVxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJSVENTZXNzaW9uU3RhdGVcIjtcbiAgICB9XG4gICAgb25TaWduYWxpbmdDb25uZWN0ZWQoKSB7XG4gICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbignb25TaWduYWxpbmdDb25uZWN0ZWQgbm90IGltcGxlbWVudGVkIGJ5ICcgKyB0aGlzLm5hbWUpO1xuICAgIH1cbiAgICBvblNpZ25hbGluZ0hhbmRzaGFrZWQoKSB7XG4gICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbignb25TaWduYWxpbmdIYW5kc2hha2VkIG5vdCBpbXBsZW1lbnRlZCBieSAnICsgdGhpcy5uYW1lKTtcbiAgICB9XG4gICAgb25TaWduYWxpbmdGYWlsZWQoZSkgey8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uKCdvblNpZ25hbGluZ0ZhaWxlZCBub3QgaW1wbGVtZW50ZWQgYnkgJyArIHRoaXMubmFtZSk7XG4gICAgfVxuICAgIG9uSWNlU3RhdGVDaGFuZ2UoZXZ0KSB7Ly8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBHcmFiTG9jYWxNZWRpYVN0YXRlIGV4dGVuZHMgUlRDU2Vzc2lvblN0YXRlIHtcbiAgICBvbkVudGVyKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICBpZiAoc2VsZi5fcnRjU2Vzc2lvbi5faXNVc2VyUHJvdmlkZWRTdHJlYW0pIHtcbiAgICAgICAgICAgIHNlbGYudHJhbnNpdChuZXcgQ3JlYXRlT2ZmZXJTdGF0ZShzZWxmLl9ydGNTZXNzaW9uKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgZ3VtVGltZW91dFByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgR3VtVGltZW91dCgnTG9jYWwgbWVkaWEgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkIHlldC4nKSk7XG4gICAgICAgICAgICAgICAgfSwgc2VsZi5fcnRjU2Vzc2lvbi5fZ3VtVGltZW91dE1pbGxpcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBzZXNzaW9uR3VtUHJvbWlzZSA9IHNlbGYuX2dVTShzZWxmLl9ydGNTZXNzaW9uLl9idWlsZE1lZGlhQ29uc3RyYWludHMoKSk7XG5cbiAgICAgICAgICAgIFByb21pc2UucmFjZShbc2Vzc2lvbkd1bVByb21pc2UsIGd1bVRpbWVvdXRQcm9taXNlXSlcbiAgICAgICAgICAgICAgICAudGhlbihzdHJlYW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0Lmd1bVRpbWVNaWxsaXMgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9vbkd1bVN1Y2Nlc3Moc2VsZi5fcnRjU2Vzc2lvbik7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX2xvY2FsU3RyZWFtID0gc3RyZWFtO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0Lmd1bU90aGVyRmFpbHVyZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0Lmd1bVRpbWVvdXRGYWlsdXJlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYudHJhbnNpdChuZXcgQ3JlYXRlT2ZmZXJTdGF0ZShzZWxmLl9ydGNTZXNzaW9uKSk7XG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuZ3VtVGltZU1pbGxpcyA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvclJlYXNvbjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBHdW1UaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvclJlYXNvbiA9IFJUQ19FUlJPUlMuR1VNX1RJTUVPVVRfRkFJTFVSRTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuZ3VtVGltZW91dEZhaWx1cmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5ndW1PdGhlckZhaWx1cmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yUmVhc29uID0gUlRDX0VSUk9SUy5HVU1fT1RIRVJfRkFJTFVSRTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuZ3VtT3RoZXJGYWlsdXJlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuZ3VtVGltZW91dEZhaWx1cmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ2dlci5lcnJvcignTG9jYWwgbWVkaWEgaW5pdGlhbGl6YXRpb24gZmFpbGVkJywgZSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX29uR3VtRXJyb3Ioc2VsZi5fcnRjU2Vzc2lvbik7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUoc2VsZi5fcnRjU2Vzc2lvbiwgZXJyb3JSZWFzb24pKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiR3JhYkxvY2FsTWVkaWFTdGF0ZVwiO1xuICAgIH1cbiAgICBfZ1VNKGNvbnN0cmFpbnRzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ydGNTZXNzaW9uLl9zdHJhdGVneS5fZ1VNKGNvbnN0cmFpbnRzKTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQ3JlYXRlT2ZmZXJTdGF0ZSBleHRlbmRzIFJUQ1Nlc3Npb25TdGF0ZSB7XG4gICAgb25FbnRlcigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgc3RyZWFtID0gc2VsZi5fcnRjU2Vzc2lvbi5fbG9jYWxTdHJlYW07XG4gICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX3N0cmF0ZWd5LmFkZFN0cmVhbShzZWxmLl9ydGNTZXNzaW9uLl9wYywgc3RyZWFtKTtcbiAgICAgICAgc2VsZi5fcnRjU2Vzc2lvbi5fb25Mb2NhbFN0cmVhbUFkZGVkKHNlbGYuX3J0Y1Nlc3Npb24sIHN0cmVhbSk7XG4gICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX3BjLmNyZWF0ZU9mZmVyKCkudGhlbihydGNTZXNzaW9uRGVzY3JpcHRpb24gPT4ge1xuICAgICAgICAgICAgc2VsZi5fcnRjU2Vzc2lvbi5fbG9jYWxTZXNzaW9uRGVzY3JpcHRpb24gPSBydGNTZXNzaW9uRGVzY3JpcHRpb247XG4gICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LmNyZWF0ZU9mZmVyRmFpbHVyZSA9IGZhbHNlO1xuICAgICAgICAgICAgc2VsZi50cmFuc2l0KG5ldyBTZXRMb2NhbFNlc3Npb25EZXNjcmlwdGlvblN0YXRlKHNlbGYuX3J0Y1Nlc3Npb24pKTtcbiAgICAgICAgfSkuY2F0Y2goZSA9PiB7XG4gICAgICAgICAgICBzZWxmLmxvZ2dlci5lcnJvcignQ3JlYXRlT2ZmZXIgZmFpbGVkJywgZSk7XG4gICAgICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LmNyZWF0ZU9mZmVyRmFpbHVyZSA9IHRydWU7XG4gICAgICAgICAgICBzZWxmLnRyYW5zaXQobmV3IEZhaWxlZFN0YXRlKHNlbGYuX3J0Y1Nlc3Npb24sIFJUQ19FUlJPUlMuQ1JFQVRFX09GRkVSX0ZBSUxVUkUpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJDcmVhdGVPZmZlclN0YXRlXCI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFNldExvY2FsU2Vzc2lvbkRlc2NyaXB0aW9uU3RhdGUgZXh0ZW5kcyBSVENTZXNzaW9uU3RhdGUge1xuICAgIG9uRW50ZXIoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICAvLyBmaXgvbW9kaWZ5IFNEUCBhcyBuZWVkZWQgaGVyZSwgYmVmb3JlIHNldExvY2FsRGVzY3JpcHRpb25cbiAgICAgICAgdmFyIGxvY2FsRGVzY3JpcHRpb24gPSBzZWxmLl9ydGNTZXNzaW9uLl9sb2NhbFNlc3Npb25EZXNjcmlwdGlvbjtcbiAgICAgICAgdmFyIHNkcE9wdGlvbnMgPSBuZXcgU2RwT3B0aW9ucygpO1xuICAgICAgICAvLyBTZXQgYXVkaW8gY29kZWMuXG4gICAgICAgIGlmIChzZWxmLl9ydGNTZXNzaW9uLl9mb3JjZUF1ZGlvQ29kZWMpIHtcbiAgICAgICAgICAgIHNkcE9wdGlvbnMuZm9yY2VDb2RlY1snYXVkaW8nXSA9IHNlbGYuX3J0Y1Nlc3Npb24uX2ZvcmNlQXVkaW9Db2RlYztcbiAgICAgICAgfVxuICAgICAgICAvLyBTZXQgdmlkZW8gY29kZWMuXG4gICAgICAgIGlmIChzZWxmLl9ydGNTZXNzaW9uLl9mb3JjZVZpZGVvQ29kZWMpIHtcbiAgICAgICAgICAgIHNkcE9wdGlvbnMuZm9yY2VDb2RlY1sndmlkZW8nXSA9IHNlbGYuX3J0Y1Nlc3Npb24uX2ZvcmNlVmlkZW9Db2RlYztcbiAgICAgICAgfVxuICAgICAgICBzZHBPcHRpb25zLmVuYWJsZU9wdXNEdHggPSBzZWxmLl9ydGNTZXNzaW9uLl9lbmFibGVPcHVzRHR4O1xuXG4gICAgICAgIHZhciB0cmFuc2Zvcm1lZFNkcCA9IHRyYW5zZm9ybVNkcChsb2NhbERlc2NyaXB0aW9uLnNkcCwgc2RwT3B0aW9ucyk7XG4gICAgICAgIGxvY2FsRGVzY3JpcHRpb24uc2RwID0gdHJhbnNmb3JtZWRTZHAuc2RwO1xuICAgICAgICBsb2NhbERlc2NyaXB0aW9uLnNkcCArPSAnYT1wdGltZToyMFxcclxcbic7XG4gICAgICAgIGxvY2FsRGVzY3JpcHRpb24uc2RwICs9ICdhPW1heHB0aW1lOjIwXFxyXFxuJztcbiAgICAgICAgbG9jYWxEZXNjcmlwdGlvbi5zZHAgPSBsb2NhbERlc2NyaXB0aW9uLnNkcC5yZXBsYWNlKFwibWlucHRpbWU9MTBcIiwgXCJtaW5wdGltZT0yMFwiKTtcblxuICAgICAgICBzZWxmLmxvZ2dlci5pbmZvKCdMb2NhbFNEJywgc2VsZi5fcnRjU2Vzc2lvbi5fbG9jYWxTZXNzaW9uRGVzY3JpcHRpb24pO1xuICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9wYy5zZXRMb2NhbERlc2NyaXB0aW9uKHNlbGYuX3J0Y1Nlc3Npb24uX2xvY2FsU2Vzc2lvbkRlc2NyaXB0aW9uKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHZhciBpbml0aWFsaXphdGlvblRpbWUgPSBEYXRlLm5vdygpIC0gc2VsZi5fcnRjU2Vzc2lvbi5fY29ubmVjdFRpbWVTdGFtcDtcbiAgICAgICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuaW5pdGlhbGl6YXRpb25UaW1lTWlsbGlzID0gaW5pdGlhbGl6YXRpb25UaW1lO1xuICAgICAgICAgICAgc2VsZi5fcnRjU2Vzc2lvbi5fb25TZXNzaW9uSW5pdGlhbGl6ZWQoc2VsZi5fcnRjU2Vzc2lvbiwgaW5pdGlhbGl6YXRpb25UaW1lKTtcbiAgICAgICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuc2V0TG9jYWxEZXNjcmlwdGlvbkZhaWx1cmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHNlbGYudHJhbnNpdChuZXcgQ29ubmVjdFNpZ25hbGluZ0FuZEljZUNvbGxlY3Rpb25TdGF0ZShzZWxmLl9ydGNTZXNzaW9uLCB0cmFuc2Zvcm1lZFNkcC5tTGluZXMpKTtcbiAgICAgICAgfSkuY2F0Y2goZSA9PiB7XG4gICAgICAgICAgICBzZWxmLmxvZ2dlci5lcnJvcignU2V0TG9jYWxEZXNjcmlwdGlvbiBmYWlsZWQnLCBlKTtcbiAgICAgICAgICAgIHNlbGYuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuc2V0TG9jYWxEZXNjcmlwdGlvbkZhaWx1cmUgPSB0cnVlO1xuICAgICAgICAgICAgc2VsZi50cmFuc2l0KG5ldyBGYWlsZWRTdGF0ZShzZWxmLl9ydGNTZXNzaW9uLCBSVENfRVJST1JTLlNFVF9MT0NBTF9ERVNDUklQVElPTl9GQUlMVVJFKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiU2V0TG9jYWxTZXNzaW9uRGVzY3JpcHRpb25TdGF0ZVwiO1xuICAgIH1cbn1cblxuLyoqXG4gKiBLaWNrIG9mZiBzaWduYWxpbmcgY29ubmVjdGlvbi4gV2FpdCB1bnRpbCBzaWduYWxpbmcgY29ubmVjdHMgYW5kIElDRSBjb2xsZWN0aW9uICh3aGljaCBhbHJlYWR5IHN0YXJ0ZWQgaW4gcHJldmlvdXMgc3RhdGUpIGNvbXBsZXRlcy5cbiAqIElDRSBjb2xsZWN0aW9uIHRpbWVzIG91dCBhZnRlciB1c2VyIHNwZWNpZmllZCBhbW91bnQgb2YgdGltZSAoZGVmYXVsdCB0byBERUZBVUxUX0lDRV9USU1FT1VUX01TKSBpbiBjYXNlIHVzZXIgaGFzIGNvbXBsZXggbmV0d29yayBlbnZpcm9ubWVudCB0aGF0IGJsYWNraG9sZXMgU1RVTi9UVVJOIHJlcXVlc3RzLiBJbiB0aGlzIGNhc2UgYXQgbGVhc3Qgb25lIGNhbmRpZGF0ZSBpcyByZXF1aXJlZCB0byBtb3ZlIGZvcndhcmQuXG4gKiBJQ0UgY29sbGVjdGlvbiBjb3VsZCBhbHNvIHdyYXAgdXAgYmVmb3JlIHRpbWVvdXQgaWYgaXQncyBkZXRlcm1pbmVkIHRoYXQgUlRQIGNhbmRpZGF0ZXMgZnJvbSBzYW1lIFRVUk4gc2VydmVyIGhhdmUgYmVlbiBjb2xsZWN0ZWQgZm9yIGFsbCBtIGxpbmVzLlxuICovXG5leHBvcnQgY2xhc3MgQ29ubmVjdFNpZ25hbGluZ0FuZEljZUNvbGxlY3Rpb25TdGF0ZSBleHRlbmRzIFJUQ1Nlc3Npb25TdGF0ZSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIENvbm5lY3RTaWduYWxpbmdBbmRJY2VDb2xsZWN0aW9uU3RhdGUgb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7UnRjU2Vzc2lvbn0gcnRjU2Vzc2lvblxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtTGluZXMgTnVtYmVyIG9mIG0gbGluZXMgaW4gU0RQXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocnRjU2Vzc2lvbiwgbUxpbmVzKSB7XG4gICAgICAgIHN1cGVyKHJ0Y1Nlc3Npb24pO1xuICAgICAgICB0aGlzLl9pY2VDYW5kaWRhdGVzID0gW107XG4gICAgICAgIHRoaXMuX2ljZUNhbmRpZGF0ZUZvdW5kYXRpb25zTWFwID0ge307XG4gICAgICAgIHRoaXMuX21MaW5lcyA9IG1MaW5lcztcbiAgICB9XG4gICAgb25FbnRlcigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBzZWxmLl9zdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGlmIChzZWxmLl9pc0N1cnJlbnRTdGF0ZSgpICYmICFzZWxmLl9pY2VDb21wbGV0ZWQpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmxvZ2dlci53YXJuKCdJQ0UgY29sbGVjdGlvbiB0aW1lZCBvdXQnKTtcbiAgICAgICAgICAgICAgICBzZWxmLl9yZXBvcnRJY2VDb21wbGV0ZWQodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHNlbGYuX3J0Y1Nlc3Npb24uX2ljZVRpbWVvdXRNaWxsaXMpO1xuICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9jcmVhdGVTaWduYWxpbmdDaGFubmVsKCkuY29ubmVjdCgpO1xuICAgIH1cbiAgICBvblNpZ25hbGluZ0Nvbm5lY3RlZCgpIHtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2lnbmFsbGluZ0Nvbm5lY3RUaW1lc3RhbXAgPSBEYXRlLm5vdygpO1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LnNpZ25hbGxpbmdDb25uZWN0VGltZU1pbGxpcyA9IHRoaXMuX3J0Y1Nlc3Npb24uX3NpZ25hbGxpbmdDb25uZWN0VGltZXN0YW1wIC0gdGhpcy5fc3RhcnRUaW1lO1xuICAgICAgICB0aGlzLl9zaWduYWxpbmdDb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9vblNpZ25hbGluZ0Nvbm5lY3RlZCh0aGlzLl9ydGNTZXNzaW9uKTtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5zaWduYWxsaW5nQ29ubmVjdGlvbkZhaWx1cmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY2hlY2tBbmRUcmFuc2l0KCk7XG4gICAgfVxuICAgIG9uU2lnbmFsaW5nRmFpbGVkKGUpIHtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5zaWduYWxsaW5nQ29ubmVjdFRpbWVNaWxsaXMgPSBEYXRlLm5vdygpIC0gdGhpcy5fc3RhcnRUaW1lO1xuICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcignRmFpbGVkIGNvbm5lY3RpbmcgdG8gc2lnbmFsaW5nIHNlcnZlcicsIGUpO1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LnNpZ25hbGxpbmdDb25uZWN0aW9uRmFpbHVyZSA9IHRydWU7XG4gICAgICAgIHRoaXMudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUodGhpcy5fcnRjU2Vzc2lvbiwgUlRDX0VSUk9SUy5TSUdOQUxMSU5HX0NPTk5FQ1RJT05fRkFJTFVSRSkpO1xuICAgIH1cbiAgICBfY3JlYXRlTG9jYWxDYW5kaWRhdGUoaW5pdERpY3QpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSVENJY2VDYW5kaWRhdGUoaW5pdERpY3QpO1xuICAgIH1cbiAgICBvbkljZUNhbmRpZGF0ZShldnQpIHtcbiAgICAgICAgdmFyIGNhbmRpZGF0ZSA9IGV2dC5jYW5kaWRhdGU7XG4gICAgICAgIHRoaXMubG9nZ2VyLmxvZygnb25pY2VjYW5kaWRhdGUgJyArIEpTT04uc3RyaW5naWZ5KGNhbmRpZGF0ZSkpO1xuICAgICAgICBpZiAoY2FuZGlkYXRlKSB7XG4gICAgICAgICAgICBpZiAoY2FuZGlkYXRlLmNhbmRpZGF0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ljZUNhbmRpZGF0ZXMucHVzaCh0aGlzLl9jcmVhdGVMb2NhbENhbmRpZGF0ZShjYW5kaWRhdGUpKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2ljZUNvbXBsZXRlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0NhbmRpZGF0ZXNTdWZmaWNpZW50KGNhbmRpZGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yZXBvcnRJY2VDb21wbGV0ZWQoZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9jaGVja0NhbmRpZGF0ZXNTdWZmaWNpZW50KGNhbmRpZGF0ZSkge1xuICAgICAgICAvL2NoZWNrIGlmIHdlIGNvbGxlY3RlZCBzdWZmaWNpZW50IGNhbmRpZGF0ZXMgZnJvbSBzaW5nbGUgbWVkaWEgc2VydmVyIHRvIHN0YXJ0IHRoZSBjYWxsXG4gICAgICAgIHZhciBjYW5kaWRhdGVPYmogPSBwYXJzZUNhbmRpZGF0ZShjYW5kaWRhdGUuY2FuZGlkYXRlKTtcbiAgICAgICAgaWYgKGNhbmRpZGF0ZU9iai5jb21wb25lbnQgIT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjYW5kaWRhdGVGb3VuZGF0aW9uID0gY2FuZGlkYXRlT2JqLmZvdW5kYXRpb247XG4gICAgICAgIHZhciBjYW5kaWRhdGVNTGluZUluZGV4ID0gY2FuZGlkYXRlLnNkcE1MaW5lSW5kZXg7XG4gICAgICAgIGlmIChjYW5kaWRhdGVGb3VuZGF0aW9uICYmIGNhbmRpZGF0ZU1MaW5lSW5kZXggPj0gMCAmJiBjYW5kaWRhdGVNTGluZUluZGV4IDwgdGhpcy5fbUxpbmVzKSB7XG4gICAgICAgICAgICB2YXIgbUluZGV4TGlzdCA9IHRoaXMuX2ljZUNhbmRpZGF0ZUZvdW5kYXRpb25zTWFwW2NhbmRpZGF0ZUZvdW5kYXRpb25dIHx8IFtdO1xuICAgICAgICAgICAgaWYgKCFtSW5kZXhMaXN0LmluY2x1ZGVzKGNhbmRpZGF0ZU1MaW5lSW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgbUluZGV4TGlzdC5wdXNoKGNhbmRpZGF0ZU1MaW5lSW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5faWNlQ2FuZGlkYXRlRm91bmRhdGlvbnNNYXBbY2FuZGlkYXRlRm91bmRhdGlvbl0gPSBtSW5kZXhMaXN0O1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fbUxpbmVzID09IG1JbmRleExpc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVwb3J0SWNlQ29tcGxldGVkKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBfcmVwb3J0SWNlQ29tcGxldGVkKGlzVGltZW91dCkge1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LmljZUNvbGxlY3Rpb25UaW1lTWlsbGlzID0gRGF0ZS5ub3coKSAtIHRoaXMuX3N0YXJ0VGltZTtcbiAgICAgICAgdGhpcy5faWNlQ29tcGxldGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fb25JY2VDb2xsZWN0aW9uQ29tcGxldGUodGhpcy5fcnRjU2Vzc2lvbiwgaXNUaW1lb3V0LCB0aGlzLl9pY2VDYW5kaWRhdGVzLmxlbmd0aCk7XG4gICAgICAgIGlmICh0aGlzLl9pY2VDYW5kaWRhdGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuaWNlQ29sbGVjdGlvbkZhaWx1cmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX2NoZWNrQW5kVHJhbnNpdCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoJ05vIElDRSBjYW5kaWRhdGUnKTtcbiAgICAgICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuaWNlQ29sbGVjdGlvbkZhaWx1cmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBGYWlsZWRTdGF0ZSh0aGlzLl9ydGNTZXNzaW9uLCBSVENfRVJST1JTLklDRV9DT0xMRUNUSU9OX1RJTUVPVVQpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBfY2hlY2tBbmRUcmFuc2l0KCkge1xuICAgICAgICBpZiAodGhpcy5faWNlQ29tcGxldGVkICYmIHRoaXMuX3NpZ25hbGluZ0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBJbnZpdGVBbnN3ZXJTdGF0ZSh0aGlzLl9ydGNTZXNzaW9uLCB0aGlzLl9pY2VDYW5kaWRhdGVzKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoIXRoaXMuX2ljZUNvbXBsZXRlZCkge1xuICAgICAgICAgICAgdGhpcy5sb2dnZXIubG9nKCdQZW5kaW5nIElDRSBjb2xsZWN0aW9uJyk7XG4gICAgICAgIH0gZWxzZSB7Ly9pbXBsaWVzIF9zaWduYWxpbmdDb25uZWN0ZWQgPT0gZmFsc2VcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmxvZygnUGVuZGluZyBzaWduYWxpbmcgY29ubmVjdGlvbicpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJDb25uZWN0U2lnbmFsaW5nQW5kSWNlQ29sbGVjdGlvblN0YXRlXCI7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgSW52aXRlQW5zd2VyU3RhdGUgZXh0ZW5kcyBSVENTZXNzaW9uU3RhdGUge1xuICAgIGNvbnN0cnVjdG9yKHJ0Y1Nlc3Npb24sIGljZUNhbmRpZGF0ZXMpIHtcbiAgICAgICAgc3VwZXIocnRjU2Vzc2lvbik7XG4gICAgICAgIHRoaXMuX2ljZUNhbmRpZGF0ZXMgPSBpY2VDYW5kaWRhdGVzO1xuICAgIH1cbiAgICBvbkVudGVyKCkge1xuICAgICAgICB2YXIgcnRjU2Vzc2lvbiA9IHRoaXMuX3J0Y1Nlc3Npb247XG4gICAgICAgIHJ0Y1Nlc3Npb24uX29uU2lnbmFsaW5nU3RhcnRlZChydGNTZXNzaW9uKTtcbiAgICAgICAgcnRjU2Vzc2lvbi5fc2lnbmFsaW5nQ2hhbm5lbC5pbnZpdGUocnRjU2Vzc2lvbi5fbG9jYWxTZXNzaW9uRGVzY3JpcHRpb24uc2RwLFxuICAgICAgICAgICAgdGhpcy5faWNlQ2FuZGlkYXRlcyk7XG4gICAgfVxuICAgIG9uU2lnbmFsaW5nQW5zd2VyZWQoc2RwLCBjYW5kaWRhdGVzKSB7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQudXNlckJ1c3lGYWlsdXJlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuaGFuZHNoYWtpbmdGYWlsdXJlID0gZmFsc2U7XG4gICAgICAgIHRoaXMudHJhbnNpdChuZXcgQWNjZXB0U3RhdGUodGhpcy5fcnRjU2Vzc2lvbiwgc2RwLCBjYW5kaWRhdGVzKSk7XG4gICAgfVxuICAgIG9uU2lnbmFsaW5nRmFpbGVkKGUpIHtcbiAgICAgICAgdmFyIHJlYXNvbjtcbiAgICAgICAgaWYgKGUubmFtZSA9PSBCdXN5RXhjZXB0aW9uTmFtZSkge1xuICAgICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoJ1VzZXIgQnVzeSwgcG9zc2libHkgbXVsdGlwbGUgQ0NQIHdpbmRvd3Mgb3BlbicsIGUpO1xuICAgICAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC51c2VyQnVzeUZhaWx1cmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5oYW5kc2hha2luZ0ZhaWx1cmUgPSB0cnVlO1xuICAgICAgICAgICAgcmVhc29uID0gUlRDX0VSUk9SUy5VU0VSX0JVU1k7XG4gICAgICAgIH0gZWxzZSBpZiAoZS5uYW1lID09IENhbGxOb3RGb3VuZEV4Y2VwdGlvbk5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKCdDYWxsIG5vdCBmb3VuZC4gT25lIG9mIHRoZSBwYXJ0aWNpcGFudCBwcm9iYWJseSBodW5ndXAuJywgZSk7XG4gICAgICAgICAgICByZWFzb24gPSBSVENfRVJST1JTLkNBTExfTk9UX0ZPVU5EO1xuICAgICAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5oYW5kc2hha2luZ0ZhaWx1cmUgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoJ0ZhaWxlZCBoYW5kc2hha2luZyB3aXRoIHNpZ25hbGluZyBzZXJ2ZXInLCBlKTtcbiAgICAgICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQudXNlckJ1c3lGYWlsdXJlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LmhhbmRzaGFraW5nRmFpbHVyZSA9IHRydWU7XG4gICAgICAgICAgICByZWFzb24gPSBSVENfRVJST1JTLlNJR05BTExJTkdfSEFORFNIQUtFX0ZBSUxVUkU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBGYWlsZWRTdGF0ZSh0aGlzLl9ydGNTZXNzaW9uLCByZWFzb24pKTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIkludml0ZUFuc3dlclN0YXRlXCI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEFjY2VwdFN0YXRlIGV4dGVuZHMgUlRDU2Vzc2lvblN0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcihydGNTZXNzaW9uLCBzZHAsIGNhbmRpZGF0ZXMpIHtcbiAgICAgICAgc3VwZXIocnRjU2Vzc2lvbik7XG4gICAgICAgIHRoaXMuX3NkcCA9IHNkcDtcbiAgICAgICAgdGhpcy5fY2FuZGlkYXRlcyA9IGNhbmRpZGF0ZXM7XG4gICAgfVxuICAgIF9jcmVhdGVTZXNzaW9uRGVzY3JpcHRpb24oaW5pdERpY3QpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oaW5pdERpY3QpO1xuICAgIH1cbiAgICBfY3JlYXRlUmVtb3RlQ2FuZGlkYXRlKGluaXREaWN0KSB7XG4gICAgICAgIHJldHVybiBuZXcgUlRDSWNlQ2FuZGlkYXRlKGluaXREaWN0KTtcbiAgICB9XG4gICAgb25FbnRlcigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgcnRjU2Vzc2lvbiA9IHNlbGYuX3J0Y1Nlc3Npb247XG5cbiAgICAgICAgaWYgKCFzZWxmLl9zZHApIHtcbiAgICAgICAgICAgIHNlbGYubG9nZ2VyLmVycm9yKCdJbnZhbGlkIHJlbW90ZSBTRFAnKTtcbiAgICAgICAgICAgIHJ0Y1Nlc3Npb24uX3N0b3BTZXNzaW9uKCk7XG4gICAgICAgICAgICBydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LmludmFsaWRSZW1vdGVTRFBGYWlsdXJlID0gdHJ1ZTtcbiAgICAgICAgICAgIHNlbGYudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUocnRjU2Vzc2lvbiwgUlRDX0VSUk9SUy5JTlZBTElEX1JFTU9URV9TRFApKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIGlmICghc2VsZi5fY2FuZGlkYXRlcyB8fCBzZWxmLl9jYW5kaWRhdGVzLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgICAgIHNlbGYubG9nZ2VyLmVycm9yKCdObyByZW1vdGUgSUNFIGNhbmRpZGF0ZScpO1xuICAgICAgICAgICAgcnRjU2Vzc2lvbi5fc3RvcFNlc3Npb24oKTtcbiAgICAgICAgICAgIHJ0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQubm9SZW1vdGVJY2VDYW5kaWRhdGVGYWlsdXJlID0gdHJ1ZTtcbiAgICAgICAgICAgIHNlbGYudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUocnRjU2Vzc2lvbiwgUlRDX0VSUk9SUy5OT19SRU1PVEVfSUNFX0NBTkRJREFURSkpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5pbnZhbGlkUmVtb3RlU0RQRmFpbHVyZSA9IGZhbHNlO1xuICAgICAgICBydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0Lm5vUmVtb3RlSWNlQ2FuZGlkYXRlRmFpbHVyZSA9IGZhbHNlO1xuICAgICAgICBzZWxmLl9ydGNTZXNzaW9uLl9zdHJhdGVneS5zZXRSZW1vdGVEZXNjcmlwdGlvbihzZWxmLCBydGNTZXNzaW9uKTtcbiAgICB9XG4gICAgb25TaWduYWxpbmdIYW5kc2hha2VkKCkge1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LmhhbmRzaGFraW5nVGltZU1pbGxpcyA9IERhdGUubm93KCkgLSB0aGlzLl9ydGNTZXNzaW9uLl9zaWduYWxsaW5nQ29ubmVjdFRpbWVzdGFtcDtcbiAgICAgICAgdGhpcy5fc2lnbmFsaW5nSGFuZHNoYWtlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuX2NoZWNrQW5kVHJhbnNpdCgpO1xuICAgIH1cbiAgICBfY2hlY2tBbmRUcmFuc2l0KCkge1xuICAgICAgICBpZiAodGhpcy5fc2lnbmFsaW5nSGFuZHNoYWtlZCAmJiB0aGlzLl9yZW1vdGVEZXNjcmlwdGlvblNldCkge1xuICAgICAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBUYWxraW5nU3RhdGUodGhpcy5fcnRjU2Vzc2lvbikpO1xuICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLl9zaWduYWxpbmdIYW5kc2hha2VkKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ1BlbmRpbmcgaGFuZHNoYWtpbmcnKTtcbiAgICAgICAgfSBlbHNlIHsvL2ltcGxpZXMgX3JlbW90ZURlc2NyaXB0aW9uU2V0ID09IGZhbHNlXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci5sb2coJ1BlbmRpbmcgc2V0dGluZyByZW1vdGUgZGVzY3JpcHRpb24nKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiQWNjZXB0U3RhdGVcIjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgVGFsa2luZ1N0YXRlIGV4dGVuZHMgUlRDU2Vzc2lvblN0YXRlIHtcblxuICAgIG9uRW50ZXIoKSB7XG4gICAgICAgIHRoaXMuX3N0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQucHJlVGFsa2luZ1RpbWVNaWxsaXMgPSB0aGlzLl9zdGFydFRpbWUgLSB0aGlzLl9ydGNTZXNzaW9uLl9jb25uZWN0VGltZVN0YW1wO1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9vblNlc3Npb25Db25uZWN0ZWQodGhpcy5fcnRjU2Vzc2lvbik7XG4gICAgfVxuICAgIG9uU2lnbmFsaW5nUmVjb25uZWN0ZWQoKSB7XG4gICAgfVxuICAgIG9uUmVtb3RlSHVuZ3VwKCkge1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zaWduYWxpbmdDaGFubmVsLmhhbmd1cCgpO1xuICAgICAgICB0aGlzLnRyYW5zaXQobmV3IERpc2Nvbm5lY3RlZFN0YXRlKHRoaXMuX3J0Y1Nlc3Npb24pKTtcbiAgICB9XG4gICAgaGFuZ3VwKCkge1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zaWduYWxpbmdDaGFubmVsLmhhbmd1cCgpO1xuICAgICAgICB0aGlzLnRyYW5zaXQobmV3IERpc2Nvbm5lY3RlZFN0YXRlKHRoaXMuX3J0Y1Nlc3Npb24pKTtcbiAgICB9XG4gICAgb25JY2VTdGF0ZUNoYW5nZShldnQpIHtcbiAgICAgICAgdmFyIGljZVN0YXRlID0gdGhpcy5fcnRjU2Vzc2lvbi5fc3RyYXRlZ3kub25JY2VTdGF0ZUNoYW5nZShldnQsIHRoaXMuX3J0Y1Nlc3Npb24uX3BjKTtcbiAgICAgICAgdGhpcy5sb2dnZXIuaW5mbygnSUNFIENvbm5lY3Rpb24gU3RhdGU6ICcsIGljZVN0YXRlKTtcblxuICAgICAgICBpZiAoaWNlU3RhdGUgPT0gSUNFX0NPTk5FQ1RJT05fU1RBVEUuRElTQ09OTkVDVEVEKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKCdMb3N0IElDRSBjb25uZWN0aW9uJyk7XG4gICAgICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LmljZUNvbm5lY3Rpb25zTG9zdCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpY2VTdGF0ZSA9PSBJQ0VfQ09OTkVDVElPTl9TVEFURS5GQUlMRUQpIHtcbiAgICAgICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuaWNlQ29ubmVjdGlvbnNGYWlsZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25QZWVyQ29ubmVjdGlvblN0YXRlQ2hhbmdlKCkge1xuICAgICAgICB2YXIgcGVlckNvbm5lY3Rpb25TdGF0ZSA9IHRoaXMuX3J0Y1Nlc3Npb24uX3N0cmF0ZWd5Lm9uUGVlckNvbm5lY3Rpb25TdGF0ZUNoYW5nZSh0aGlzLl9ydGNTZXNzaW9uLl9wYyk7XG4gICAgICAgIHRoaXMubG9nZ2VyLmluZm8oJ1BlZXIgQ29ubmVjdGlvbiBTdGF0ZTogJywgcGVlckNvbm5lY3Rpb25TdGF0ZSk7XG5cbiAgICAgICAgaWYgKHBlZXJDb25uZWN0aW9uU3RhdGUgPT0gUEVFUl9DT05ORUNUSU9OX1NUQVRFLkZBSUxFRCkge1xuICAgICAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5wZWVyQ29ubmVjdGlvbkZhaWxlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkV4aXQoKSB7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQudGFsa2luZ1RpbWVNaWxsaXMgPSBEYXRlLm5vdygpIC0gdGhpcy5fc3RhcnRUaW1lO1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9kZXRhY2hNZWRpYSgpO1xuICAgICAgICB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LnNlc3Npb25FbmRUaW1lID0gbmV3IERhdGUoKTtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fb25TZXNzaW9uQ29tcGxldGVkKHRoaXMuX3J0Y1Nlc3Npb24pO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiVGFsa2luZ1N0YXRlXCI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIENsZWFuVXBTdGF0ZSBleHRlbmRzIFJUQ1Nlc3Npb25TdGF0ZSB7XG4gICAgb25FbnRlcigpIHtcbiAgICAgICAgdGhpcy5fc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc3RvcFNlc3Npb24oKTtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5jbGVhbnVwVGltZU1pbGxpcyA9IERhdGUubm93KCkgLSB0aGlzLl9zdGFydFRpbWU7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX29uU2Vzc2lvbkRlc3Ryb3llZCh0aGlzLl9ydGNTZXNzaW9uLCB0aGlzLl9ydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0KTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIkNsZWFuVXBTdGF0ZVwiO1xuICAgIH1cbiAgICBoYW5ndXAoKSB7XG4gICAgICAgIC8vZG8gbm90aGluZywgYWxyZWFkeSBhdCB0aGUgZW5kIG9mIGxpZmVjeWNsZVxuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBEaXNjb25uZWN0ZWRTdGF0ZSBleHRlbmRzIENsZWFuVXBTdGF0ZSB7XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIkRpc2Nvbm5lY3RlZFN0YXRlXCI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEZhaWxlZFN0YXRlIGV4dGVuZHMgQ2xlYW5VcFN0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcihydGNTZXNzaW9uLCBmYWlsdXJlUmVhc29uKSB7XG4gICAgICAgIHN1cGVyKHJ0Y1Nlc3Npb24pO1xuICAgICAgICB0aGlzLl9mYWlsdXJlUmVhc29uID0gZmFpbHVyZVJlYXNvbjtcbiAgICB9XG4gICAgb25FbnRlcigpIHtcbiAgICAgICAgdGhpcy5fcnRjU2Vzc2lvbi5fc2Vzc2lvblJlcG9ydC5zZXNzaW9uRW5kVGltZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHRoaXMuX3J0Y1Nlc3Npb24uX29uU2Vzc2lvbkZhaWxlZCh0aGlzLl9ydGNTZXNzaW9uLCB0aGlzLl9mYWlsdXJlUmVhc29uKTtcbiAgICAgICAgc3VwZXIub25FbnRlcigpO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiRmFpbGVkU3RhdGVcIjtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJ0Y1Nlc3Npb24ge1xuICAgIC8qKlxuICAgICAqIEJ1aWxkIGFuIEFtYXpvbkNvbm5lY3QgUlRDIHNlc3Npb24uXG4gICAgICogQHBhcmFtIHsqfSBzaWduYWxpbmdVcmlcbiAgICAgKiBAcGFyYW0geyp9IGljZVNlcnZlcnMgQXJyYXkgb2YgaWNlIHNlcnZlcnNcbiAgICAgKiBAcGFyYW0geyp9IGNvbnRhY3RUb2tlbiBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGNvbnRhY3QgdG9rZW4gKG9wdGlvbmFsKVxuICAgICAqIEBwYXJhbSB7Kn0gbG9nZ2VyIEFuIG9iamVjdCBwcm92aWRlcyBsb2dnaW5nIGZ1bmN0aW9ucywgc3VjaCBhcyBjb25zb2xlXG4gICAgICogQHBhcmFtIHsqfSBjb250YWN0SWQgTXVzdCBiZSBVVUlELCB1bmlxdWVseSBpZGVudGlmaWVzIHRoZSBzZXNzaW9uLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNpZ25hbGluZ1VyaSwgaWNlU2VydmVycywgY29udGFjdFRva2VuLCBsb2dnZXIsIGNvbnRhY3RJZCwgY29ubmVjdGlvbklkLCB3c3NNYW5hZ2VyLCBzdHJhdGVneSA9IG5ldyBTdGFuZGFyZFN0cmF0ZWd5KCkpIHtcbiAgICAgICAgaWYgKCEoc3RyYXRlZ3kgaW5zdGFuY2VvZiBDQ1BJbml0aWF0aW9uU3RyYXRlZ3lJbnRlcmZhY2UpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIGEgc3RyYXRlZ3kgb2YgdHlwZSBDQ1BJbml0aWF0aW9uU3RyYXRlZ3lJbnRlcmZhY2UnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHNpZ25hbGluZ1VyaSAhPT0gJ3N0cmluZycgfHwgc2lnbmFsaW5nVXJpLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsUGFyYW1ldGVycygnc2lnbmFsaW5nVXJpIHJlcXVpcmVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpY2VTZXJ2ZXJzKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFBhcmFtZXRlcnMoJ2ljZVNlcnZlcnMgcmVxdWlyZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGxvZ2dlciAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsUGFyYW1ldGVycygnbG9nZ2VyIHJlcXVpcmVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFjb250YWN0SWQpIHtcbiAgICAgICAgICAgIHRoaXMuX2NhbGxJZCA9IHV1aWQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2NhbGxJZCA9IGNvbnRhY3RJZDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zdHJhdGVneSA9IHN0cmF0ZWd5O1xuICAgICAgICB0aGlzLl9jb25uZWN0aW9uSWQgPSBjb25uZWN0aW9uSWQ7XG4gICAgICAgIHRoaXMuX3dzc01hbmFnZXIgPSB3c3NNYW5hZ2VyO1xuICAgICAgICB0aGlzLl9zZXNzaW9uUmVwb3J0ID0gbmV3IFNlc3Npb25SZXBvcnQoKTtcbiAgICAgICAgdGhpcy5fc2lnbmFsaW5nVXJpID0gc2lnbmFsaW5nVXJpO1xuICAgICAgICB0aGlzLl9pY2VTZXJ2ZXJzID0gaWNlU2VydmVycztcbiAgICAgICAgdGhpcy5fY29udGFjdFRva2VuID0gY29udGFjdFRva2VuO1xuICAgICAgICB0aGlzLl9vcmlnaW5hbExvZ2dlciA9IGxvZ2dlcjtcbiAgICAgICAgdGhpcy5fbG9nZ2VyID0gd3JhcExvZ2dlcih0aGlzLl9vcmlnaW5hbExvZ2dlciwgdGhpcy5fY2FsbElkLCAnU0VTU0lPTicpO1xuICAgICAgICB0aGlzLl9pY2VUaW1lb3V0TWlsbGlzID0gREVGQVVMVF9JQ0VfVElNRU9VVF9NUztcbiAgICAgICAgdGhpcy5fZ3VtVGltZW91dE1pbGxpcyA9IERFRkFVTFRfR1VNX1RJTUVPVVRfTVM7XG5cbiAgICAgICAgdGhpcy5fZW5hYmxlQXVkaW8gPSB0cnVlO1xuICAgICAgICB0aGlzLl9lbmFibGVWaWRlbyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9mYWNpbmdNb2RlID0gJ3VzZXInO1xuICAgICAgICB0aGlzLl9sZWdhY3lTdGF0c1JlcG9ydFN1cHBvcnQgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHVzZXIgbWF5IHByb3ZpZGUgdGhlIHN0cmVhbSB0byB0aGUgUnRjU2Vzc2lvbiBkaXJlY3RseSB0byBjb25uZWN0IHRvIHRoZSBvdGhlciBlbmQuXG4gICAgICAgICAqIHVzZXIgbWF5IGFsc28gYWNxdWlyZSB0aGUgc3RyZWFtIGZyb20gdGhlIGxvY2FsIGRldmljZS5cbiAgICAgICAgICogVGhpcyBmbGFnIGlzIHVzZWQgdG8gdHJhY2sgd2hlcmUgdGhlIHN0cmVhbSBpcyBhY3F1aXJlZC5cbiAgICAgICAgICogSWYgaXQncyBhY3F1aXJlZCBmcm9tIGxvY2FsIGRldmljZXMsIHRoZW4gd2UgbXVzdCBjbG9zZSB0aGUgc3RyZWFtIHdoZW4gdGhlIHNlc3Npb24gZW5kcy5cbiAgICAgICAgICogSWYgaXQncyBwcm92aWRlZCBieSB1c2VyIChyYXRoZXIgdGhhbiBsb2NhbCBjYW1lcmEvbWljcm9waG9uZSksIHRoZW4gd2Ugc2hvdWxkIGxlYXZlIGl0IG9wZW4gd2hlbiB0aGVcbiAgICAgICAgICogc2Vzc2lvbiBlbmRzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5faXNVc2VyUHJvdmlkZWRTdHJlYW0gPSBmYWxzZTtcblxuICAgICAgICB0aGlzLl9vbkd1bUVycm9yID1cbiAgICAgICAgdGhpcy5fb25HdW1TdWNjZXNzID1cbiAgICAgICAgdGhpcy5fb25Mb2NhbFN0cmVhbUFkZGVkID1cbiAgICAgICAgdGhpcy5fb25TZXNzaW9uRmFpbGVkID1cbiAgICAgICAgdGhpcy5fb25TZXNzaW9uSW5pdGlhbGl6ZWQgPVxuICAgICAgICB0aGlzLl9vblNpZ25hbGluZ0Nvbm5lY3RlZCA9XG4gICAgICAgIHRoaXMuX29uSWNlQ29sbGVjdGlvbkNvbXBsZXRlID1cbiAgICAgICAgdGhpcy5fb25TaWduYWxpbmdTdGFydGVkID1cbiAgICAgICAgdGhpcy5fb25TZXNzaW9uQ29ubmVjdGVkID1cbiAgICAgICAgdGhpcy5fb25SZW1vdGVTdHJlYW1BZGRlZCA9XG4gICAgICAgIHRoaXMuX29uU2Vzc2lvbkNvbXBsZXRlZCA9XG4gICAgICAgIHRoaXMuX29uU2Vzc2lvbkRlc3Ryb3llZCA9ICgpID0+IHtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0IHNlc3Npb25SZXBvcnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXNzaW9uUmVwb3J0O1xuICAgIH1cbiAgICBnZXQgY2FsbElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2FsbElkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBnZXRNZWRpYVN0cmVhbSByZXR1cm5zIHRoZSBsb2NhbCBzdHJlYW0sIHdoaWNoIG1heSBiZSBhY3F1aXJlZCBmcm9tIGxvY2FsIGRldmljZSBvciBmcm9tIHVzZXIgcHJvdmlkZWQgc3RyZWFtLlxuICAgICAqIFJhdGhlciB0aGFuIGdldHRpbmcgYSBzdHJlYW0gYnkgY2FsbGluZyBnZXRVc2VyTWVkaWEgKHdoaWNoIGdldHMgYSBzdHJlYW0gZnJvbSBsb2NhbCBkZXZpY2Ugc3VjaCBhcyBjYW1lcmEpLFxuICAgICAqIHVzZXIgY291bGQgYWxzbyBwcm92aWRlIHRoZSBzdHJlYW0gdG8gdGhlIFJ0Y1Nlc3Npb24gZGlyZWN0bHkgdG8gY29ubmVjdCB0byB0aGUgb3RoZXIgZW5kLlxuICAgICAqL1xuICAgIGdldCBtZWRpYVN0cmVhbSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvY2FsU3RyZWFtO1xuICAgIH1cbiAgICBnZXQgcmVtb3RlVmlkZW9TdHJlYW0oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZW1vdGVWaWRlb1N0cmVhbTtcbiAgICB9XG4gICAgcGF1c2VMb2NhbFZpZGVvKCkge1xuICAgICAgICBpZih0aGlzLl9sb2NhbFN0cmVhbSkge1xuICAgICAgICAgICAgdmFyIHZpZGVvVHJhY2sgPSB0aGlzLl9sb2NhbFN0cmVhbS5nZXRWaWRlb1RyYWNrcygpWzBdO1xuICAgICAgICAgICAgaWYodmlkZW9UcmFjaykge1xuICAgICAgICAgICAgICAgIHZpZGVvVHJhY2suZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJlc3VtZUxvY2FsVmlkZW8oKSB7XG4gICAgICAgIGlmKHRoaXMuX2xvY2FsU3RyZWFtKSB7XG4gICAgICAgICAgICB2YXIgdmlkZW9UcmFjayA9IHRoaXMuX2xvY2FsU3RyZWFtLmdldFZpZGVvVHJhY2tzKClbMF07XG4gICAgICAgICAgICBpZih2aWRlb1RyYWNrKSB7XG4gICAgICAgICAgICAgICAgdmlkZW9UcmFjay5lbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwYXVzZVJlbW90ZVZpZGVvKCkge1xuICAgICAgICBpZiAodGhpcy5fcmVtb3RlVmlkZW9TdHJlYW0pIHtcbiAgICAgICAgICAgIHZhciB2aWRlb1RyYWNrID0gdGhpcy5fcmVtb3RlVmlkZW9TdHJlYW0uZ2V0VHJhY2tzKClbMV07XG4gICAgICAgICAgICBpZih2aWRlb1RyYWNrKSB7XG4gICAgICAgICAgICAgICAgdmlkZW9UcmFjay5lbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVzdW1lUmVtb3RlVmlkZW8oKSB7XG4gICAgICAgIGlmICh0aGlzLl9yZW1vdGVWaWRlb1N0cmVhbSkge1xuICAgICAgICAgICAgdmFyIHZpZGVvVHJhY2sgPSB0aGlzLl9yZW1vdGVWaWRlb1N0cmVhbS5nZXRUcmFja3MoKVsxXTtcbiAgICAgICAgICAgIGlmKHZpZGVvVHJhY2spIHtcbiAgICAgICAgICAgICAgICB2aWRlb1RyYWNrLmVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHBhdXNlTG9jYWxBdWRpbygpIHtcbiAgICAgICAgaWYgKHRoaXMuX2xvY2FsU3RyZWFtKSB7XG4gICAgICAgICAgICB2YXIgYXVkaW9UcmFjayA9IHRoaXMuX2xvY2FsU3RyZWFtLmdldEF1ZGlvVHJhY2tzKClbMF07XG4gICAgICAgICAgICBpZihhdWRpb1RyYWNrKSB7XG4gICAgICAgICAgICAgICAgYXVkaW9UcmFjay5lbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVzdW1lTG9jYWxBdWRpbygpIHtcbiAgICAgICAgaWYgKHRoaXMuX2xvY2FsU3RyZWFtKSB7XG4gICAgICAgICAgICB2YXIgYXVkaW9UcmFjayA9IHRoaXMuX2xvY2FsU3RyZWFtLmdldEF1ZGlvVHJhY2tzKClbMF07XG4gICAgICAgICAgICBpZihhdWRpb1RyYWNrKSB7XG4gICAgICAgICAgICAgICAgYXVkaW9UcmFjay5lbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwYXVzZVJlbW90ZUF1ZGlvKCkge1xuICAgICAgICBpZiAodGhpcy5fcmVtb3RlQXVkaW9TdHJlYW0pIHtcbiAgICAgICAgICAgIHZhciBhdWRpb1RyYWNrID0gdGhpcy5fcmVtb3RlQXVkaW9TdHJlYW0uZ2V0VHJhY2tzKClbMF07XG4gICAgICAgICAgICBpZihhdWRpb1RyYWNrKSB7XG4gICAgICAgICAgICAgICAgYXVkaW9UcmFjay5lbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVzdW1lUmVtb3RlQXVkaW8oKSB7XG4gICAgICAgIGlmICh0aGlzLl9yZW1vdGVBdWRpb1N0cmVhbSkge1xuICAgICAgICAgICAgdmFyIGF1ZGlvVHJhY2sgPSB0aGlzLl9yZW1vdGVBdWRpb1N0cmVhbS5nZXRUcmFja3MoKVswXTtcbiAgICAgICAgICAgIGlmKGF1ZGlvVHJhY2spIHtcbiAgICAgICAgICAgICAgICBhdWRpb1RyYWNrLmVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIHdoZW4gZ1VNIHN1Y2NlZWRzLlxuICAgICAqIEZpcnN0IHBhcmFtIGlzIFJ0Y1Nlc3Npb24gb2JqZWN0LlxuICAgICAqL1xuICAgIHNldCBvbkd1bVN1Y2Nlc3MoaGFuZGxlcikge1xuICAgICAgICB0aGlzLl9vbkd1bVN1Y2Nlc3MgPSBoYW5kbGVyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsYmFjayB3aGVuIGdVTSBmYWlscy5cbiAgICAgKiBGaXJzdCBwYXJhbSBpcyBSdGNTZXNzaW9uIG9iamVjdC5cbiAgICAgKiBTZWNvbmQgcGFyYW0gaXMgdGhlIGVycm9yLlxuICAgICAqL1xuICAgIHNldCBvbkd1bUVycm9yKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fb25HdW1FcnJvciA9IGhhbmRsZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIGlmIGZhaWxlZCBpbml0aWFsaXppbmcgbG9jYWwgcmVzb3VyY2VzXG4gICAgICogRmlyc3QgcGFyYW0gaXMgUnRjU2Vzc2lvbiBvYmplY3QuXG4gICAgICovXG4gICAgc2V0IG9uU2Vzc2lvbkZhaWxlZChoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX29uU2Vzc2lvbkZhaWxlZCA9IGhhbmRsZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIGFmdGVyIGxvY2FsIHVzZXIgbWVkaWEgc3RyZWFtIGlzIGFkZGVkIHRvIHRoZSBzZXNzaW9uLlxuICAgICAqIEZpcnN0IHBhcmFtIGlzIFJ0Y1Nlc3Npb24gb2JqZWN0LlxuICAgICAqIFNlY29uZCBwYXJhbSBpcyBtZWRpYSBzdHJlYW1cbiAgICAgKi9cbiAgICBzZXQgb25Mb2NhbFN0cmVhbUFkZGVkKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fb25Mb2NhbFN0cmVhbUFkZGVkID0gaGFuZGxlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGJhY2sgd2hlbiBhbGwgbG9jYWwgcmVzb3VyY2VzIGFyZSByZWFkeS4gRXN0YWJsaXNoaW5nIHNpZ25hbGluZyBjaGFuZWwgYW5kIElDRSBjb2xsZWN0aW9uIGhhcHBlbnMgYXQgdGhlIHNhbWUgdGltZSBhZnRlciB0aGlzLlxuICAgICAqIEZpcnN0IHBhcmFtIGlzIFJ0Y1Nlc3Npb24gb2JqZWN0LlxuICAgICAqL1xuICAgIHNldCBvblNlc3Npb25Jbml0aWFsaXplZChoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX29uU2Vzc2lvbkluaXRpYWxpemVkID0gaGFuZGxlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGJhY2sgd2hlbiBzaWduYWxpbmcgY2hhbm5lbCBpcyBlc3RhYmxpc2hlZC5cbiAgICAgKiBSVEMgc2Vzc2lvbiB3aWxsIG1vdmUgZm9yd2FyZCBvbmx5IGlmIG9uU2lnbmFsaW5nQ29ubmVjdGVkIGFuZCBvbkljZUNvbGxlY3Rpb25Db21wbGV0ZSBhcmUgYm90aCBjYWxsZWQuXG4gICAgICpcbiAgICAgKiBGaXJzdCBwYXJhbSBpcyBSdGNTZXNzaW9uIG9iamVjdC5cbiAgICAgKi9cbiAgICBzZXQgb25TaWduYWxpbmdDb25uZWN0ZWQoaGFuZGxlcikge1xuICAgICAgICB0aGlzLl9vblNpZ25hbGluZ0Nvbm5lY3RlZCA9IGhhbmRsZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIHdoZW4gSUNFIGNvbGxlY3Rpb24gY29tcGxldGVzIGVpdGhlciBiZWNhdXNlIHRoZXJlIGlzIG5vIG1vcmUgY2FuZGlkYXRlIG9yIGNvbGxlY3Rpb24gdGltZWQgb3V0LlxuICAgICAqIFJUQyBzZXNzaW9uIHdpbGwgbW92ZSBmb3J3YXJkIG9ubHkgaWYgb25TaWduYWxpbmdDb25uZWN0ZWQgYW5kIG9uSWNlQ29sbGVjdGlvbkNvbXBsZXRlIGFyZSBib3RoIGNhbGxlZC5cbiAgICAgKlxuICAgICAqIEZpcnN0IHBhcmFtIGlzIFJ0Y1Nlc3Npb24gb2JqZWN0LlxuICAgICAqIFNlY29uZCBwYXJhbSBpcyBib29sZWFuLCBUUlVFIC0gSUNFIGNvbGxlY3Rpb24gdGltZWQgb3V0LlxuICAgICAqIFRoaXJkIHBhcmFtIGlzIG51bWJlciBvZiBjYW5kaWRhdGVzIGNvbGxlY3RlZC5cbiAgICAgKi9cbiAgICBzZXQgb25JY2VDb2xsZWN0aW9uQ29tcGxldGUoaGFuZGxlcikge1xuICAgICAgICB0aGlzLl9vbkljZUNvbGxlY3Rpb25Db21wbGV0ZSA9IGhhbmRsZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIHdoZW4gc2lnbmFsaW5nIGNoYW5uZWwgaXMgZXN0YWJsaXNoZWQgYW5kIElDRSBjb2xsZWN0aW9uIGNvbXBsZXRlZCB3aXRoIGF0IGxlYXN0IG9uZSBjYW5kaWRhdGUuXG4gICAgICogRmlyc3QgcGFyYW0gaXMgUnRjU2Vzc2lvbiBvYmplY3QuXG4gICAgICovXG4gICAgc2V0IG9uU2lnbmFsaW5nU3RhcnRlZChoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX29uU2lnbmFsaW5nU3RhcnRlZCA9IGhhbmRsZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIHdoZW4gdGhlIGNhbGwgaXMgZXN0YWJsaXNoZWQgKGhhbmRzaGFrZWQgYW5kIG1lZGlhIHN0cmVhbSBzaG91bGQgYmUgZmxvd2luZylcbiAgICAgKiBGaXJzdCBwYXJhbSBpcyBSdGNTZXNzaW9uIG9iamVjdC5cbiAgICAgKi9cbiAgICBzZXQgb25TZXNzaW9uQ29ubmVjdGVkKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fb25TZXNzaW9uQ29ubmVjdGVkID0gaGFuZGxlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGJhY2sgYWZ0ZXIgcmVtb3RlIG1lZGlhIHN0cmVhbSBpcyBhZGRlZCB0byB0aGUgc2Vzc2lvbi5cbiAgICAgKiBUaGlzIGNvdWxkIGJlIGNhbGxlZCBtdWx0aXBsZSB0aW1lcyB3aXRoIHRoZSBzYW1lIHN0cmVhbSBpZiBtdWx0aXBsZSB0cmFja3MgYXJlIGluY2x1ZGVkIGluIHRoZSBzYW1lIHN0cmVhbS5cbiAgICAgKlxuICAgICAqIEZpcnN0IHBhcmFtIGlzIFJ0Y1Nlc3Npb24gb2JqZWN0LlxuICAgICAqIFNlY29uZCBwYXJhbSBpcyBtZWRpYSBzdHJlYW0gdHJhY2suXG4gICAgICovXG4gICAgc2V0IG9uUmVtb3RlU3RyZWFtQWRkZWQoaGFuZGxlcikge1xuICAgICAgICB0aGlzLl9vblJlbW90ZVN0cmVhbUFkZGVkID0gaGFuZGxlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGJhY2sgd2hlbiB0aGUgaGFuZ3VwIGlzIGluaXRpYXRlZCAoaW1wbGllcyB0aGUgY2FsbCB3YXMgc3VjY2Vzc2Z1bGx5IGVzdGFibGlzaGVkKS5cbiAgICAgKiBGaXJzdCBwYXJhbSBpcyBSdGNTZXNzaW9uIG9iamVjdC5cbiAgICAgKi9cbiAgICBzZXQgb25TZXNzaW9uQ29tcGxldGVkKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fb25TZXNzaW9uQ29tcGxldGVkID0gaGFuZGxlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGJhY2sgYWZ0ZXIgc2Vzc2lvbiBpcyBjbGVhbmVkIHVwLCBubyBtYXR0ZXIgaWYgdGhlIGNhbGwgd2FzIHN1Y2Nlc3NmdWxseSBlc3RhYmxpc2hlZCBvciBub3QuXG4gICAgICogRmlyc3QgcGFyYW0gaXMgUnRjU2Vzc2lvbiBvYmplY3QuXG4gICAgICogU2Vjb25kIHBhcmFtIGlzIFNlc3Npb25SZXBvcnQgb2JqZWN0LlxuICAgICAqL1xuICAgIHNldCBvblNlc3Npb25EZXN0cm95ZWQoaGFuZGxlcikge1xuICAgICAgICB0aGlzLl9vblNlc3Npb25EZXN0cm95ZWQgPSBoYW5kbGVyO1xuICAgIH1cbiAgICBzZXQgZW5hYmxlQXVkaW8oZmxhZykge1xuICAgICAgICB0aGlzLl9lbmFibGVBdWRpbyA9IGZsYWc7XG4gICAgfVxuICAgIHNldCBlY2hvQ2FuY2VsbGF0aW9uKGZsYWcpIHtcbiAgICAgICAgdGhpcy5fZWNob0NhbmNlbGxhdGlvbiA9IGZsYWc7XG4gICAgfVxuICAgIHNldCBlbmFibGVWaWRlbyhmbGFnKSB7XG4gICAgICAgIHRoaXMuX2VuYWJsZVZpZGVvID0gZmxhZztcbiAgICB9XG4gICAgc2V0IG1heFZpZGVvRnJhbWVSYXRlKGZyYW1lUmF0ZSkge1xuICAgICAgICB0aGlzLl9tYXhWaWRlb0ZyYW1lUmF0ZSA9IGZyYW1lUmF0ZTtcbiAgICB9XG4gICAgc2V0IG1pblZpZGVvRnJhbWVSYXRlKGZyYW1lUmF0ZSkge1xuICAgICAgICB0aGlzLl9taW5WaWRlb0ZyYW1lUmF0ZSA9IGZyYW1lUmF0ZTtcbiAgICB9XG4gICAgc2V0IHZpZGVvRnJhbWVSYXRlKGZyYW1lUmF0ZSkge1xuICAgICAgICB0aGlzLl92aWRlb0ZyYW1lUmF0ZSA9IGZyYW1lUmF0ZTtcbiAgICB9XG4gICAgc2V0IG1heFZpZGVvV2lkdGgod2lkdGgpIHtcbiAgICAgICAgdGhpcy5fbWF4VmlkZW9XaWR0aCA9IHdpZHRoO1xuICAgIH1cbiAgICBzZXQgbWluVmlkZW9XaWR0aCh3aWR0aCkge1xuICAgICAgICB0aGlzLl9taW5WaWRlb1dpZHRoID0gd2lkdGg7XG4gICAgfVxuICAgIHNldCBpZGVhbFZpZGVvV2lkdGgod2lkdGgpIHtcbiAgICAgICAgdGhpcy5faWRlYWxWaWRlb1dpZHRoID0gd2lkdGg7XG4gICAgfVxuICAgIHNldCBtYXhWaWRlb0hlaWdodChoZWlnaHQpIHtcbiAgICAgICAgdGhpcy5fbWF4VmlkZW9IZWlnaHQgPSBoZWlnaHQ7XG4gICAgfVxuICAgIHNldCBtaW5WaWRlb0hlaWdodChoZWlnaHQpIHtcbiAgICAgICAgdGhpcy5fbWluVmlkZW9IZWlnaHQgPSBoZWlnaHQ7XG4gICAgfVxuICAgIHNldCBpZGVhbFZpZGVvSGVpZ2h0KGhlaWdodCkge1xuICAgICAgICB0aGlzLl9pZGVhbFZpZGVvSGVpZ2h0ID0gaGVpZ2h0O1xuICAgIH1cbiAgICBzZXQgZmFjaW5nTW9kZShtb2RlKSB7XG4gICAgICAgIHRoaXMuX2ZhY2luZ01vZGUgPSBtb2RlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPcHRpb25hbC4gUnRjU2Vzc2lvbiB3aWxsIGdyYWIgaW5wdXQgZGV2aWNlIGlmIHRoaXMgaXMgbm90IHNwZWNpZmllZC5cbiAgICAgKiBQbGVhc2Ugbm90ZTogdGhpcyBSdGNTZXNzaW9uIGNsYXNzIG9ubHkgc3VwcG9ydCBzaW5nbGUgYXVkaW8gdHJhY2sgYW5kL29yIHNpbmdsZSB2aWRlbyB0cmFjay5cbiAgICAgKi9cbiAgICBzZXQgbWVkaWFTdHJlYW0oaW5wdXQpIHtcbiAgICAgICAgdGhpcy5fbG9jYWxTdHJlYW0gPSBpbnB1dDtcbiAgICAgICAgdGhpcy5faXNVc2VyUHJvdmlkZWRTdHJlYW0gPSB0cnVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOZWVkZWQsIGV4cGVjdCBhbiBhdWRpbyBlbGVtZW50IHRoYXQgY2FuIGJlIHVzZWQgdG8gcGxheSByZW1vdGUgYXVkaW8gc3RyZWFtLlxuICAgICAqL1xuICAgIHNldCByZW1vdGVBdWRpb0VsZW1lbnQoZWxlbWVudCkge1xuICAgICAgICB0aGlzLl9yZW1vdGVBdWRpb0VsZW1lbnQgPSBlbGVtZW50O1xuICAgIH1cbiAgICBzZXQgcmVtb3RlVmlkZW9FbGVtZW50KGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5fcmVtb3RlVmlkZW9FbGVtZW50ID0gZWxlbWVudDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogT3ZlcnJpZGUgdGhlIGRlZmF1bHQgc2lnbmFsaW5nIGNvbm5lY3QgdGltZSBvdXQuXG4gICAgICovXG4gICAgc2V0IHNpZ25hbGluZ0Nvbm5lY3RUaW1lb3V0KG1zKSB7XG4gICAgICAgIHRoaXMuX3NpZ25hbGluZ0Nvbm5lY3RUaW1lb3V0ID0gbXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE92ZXJyaWRlIHRoZSBkZWZhdWx0IElDRSBjb2xsZWN0aW9uIHRpbWUgbGltaXQuXG4gICAgICovXG4gICAgc2V0IGljZVRpbWVvdXRNaWxsaXModGltZW91dE1pbGxpcykge1xuICAgICAgICB0aGlzLl9pY2VUaW1lb3V0TWlsbGlzID0gdGltZW91dE1pbGxpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogT3ZlcnJpZGUgdGhlIGRlZmF1bHQgR1VNIHRpbWVvdXQgdGltZSBsaW1pdC5cbiAgICAgKi9cbiAgICBzZXQgZ3VtVGltZW91dE1pbGxpcyh0aW1lb3V0TWlsbGlzKSB7XG4gICAgICAgIHRoaXMuX2d1bVRpbWVvdXRNaWxsaXMgPSB0aW1lb3V0TWlsbGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBjb25uZWN0LXJ0Yy1qcyBpbml0aWF0ZSB0aGUgaGFuZHNoYWtpbmcgd2l0aCBhbGwgYnJvd3NlciBzdXBwb3J0ZWQgY29kZWMgYnkgZGVmYXVsdCwgQW1hem9uIENvbm5lY3Qgc2VydmljZSB3aWxsIGNob29zZSB0aGUgY29kZWMgYWNjb3JkaW5nIHRvIGl0cyBwcmVmZXJlbmNlIHNldHRpbmcuXG4gICAgICogU2V0dGluZyB0aGlzIGF0dHJpYnV0ZSB3aWxsIGZvcmNlIGNvbm5lY3QtcnRjLWpzIHRvIG9ubHkgdXNlIHNwZWNpZmllZCBjb2RlYy5cbiAgICAgKiBXQVJOSU5HOiBTZXR0aW5nIHRoaXMgdG8gdW5zdXBwb3J0ZWQgY29kZWMgd2lsbCBjYXVzZSB0aGUgZmFpbHVyZSBvZiBoYW5kc2hha2luZy5cbiAgICAgKiBTdXBwb3J0ZWQgYXVkaW8gY29kZWNzOiBvcHVzLlxuICAgICAqL1xuICAgIHNldCBmb3JjZUF1ZGlvQ29kZWMoYXVkaW9Db2RlYykge1xuICAgICAgICB0aGlzLl9mb3JjZUF1ZGlvQ29kZWMgPSBhdWRpb0NvZGVjO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNvbm5lY3QtcnRjLWpzIGluaXRpYXRlIHRoZSBoYW5kc2hha2luZyB3aXRoIGFsbCBicm93c2VyIHN1cHBvcnRlZCBjb2RlYyBieSBkZWZhdWx0LCBBbWF6b24gQ29ubmVjdCBzZXJ2aWNlIHdpbGwgY2hvb3NlIHRoZSBjb2RlYyBhY2NvcmRpbmcgdG8gaXRzIHByZWZlcmVuY2Ugc2V0dGluZy5cbiAgICAgKiBTZXR0aW5nIHRoaXMgYXR0cmlidXRlIHdpbGwgZm9yY2UgY29ubmVjdC1ydGMtanMgdG8gb25seSB1c2Ugc3BlY2lmaWVkIGNvZGVjLlxuICAgICAqIFdBUk5JTkc6IFNldHRpbmcgdGhpcyB0byB1bnN1cHBvcnRlZCBjb2RlYyB3aWxsIGNhdXNlIHRoZSBmYWlsdXJlIG9mIGhhbmRzaGFraW5nLlxuICAgICAqIFN1cHBvcnRlZCB2aWRlbyBjb2RlY3M6IFZQOCwgVlA5LCBIMjY0LlxuICAgICAqL1xuICAgIHNldCBmb3JjZVZpZGVvQ29kZWModmlkZW9Db2RlYykge1xuICAgICAgICB0aGlzLl9mb3JjZVZpZGVvQ29kZWMgPSB2aWRlb0NvZGVjO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNvbm5lY3QtcnRjLWpzIGRpc2FibGVzIE9QVVMgRFRYIGJ5IGRlZmF1bHQgYmVjYXVzZSBpdCBoYXJtcyBhdWRpbyBxdWFsaXR5LlxuICAgICAqIEBwYXJhbSBmbGFnIGJvb2xlYW5cbiAgICAgKi9cbiAgICBzZXQgZW5hYmxlT3B1c0R0eChmbGFnKSB7XG4gICAgICAgIHRoaXMuX2VuYWJsZU9wdXNEdHggPSBmbGFnO1xuICAgIH1cblxuICAgIHRyYW5zaXQobmV4dFN0YXRlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLl9sb2dnZXIuaW5mbygodGhpcy5fc3RhdGUgPyB0aGlzLl9zdGF0ZS5uYW1lIDogJ251bGwnKSArICcgPT4gJyArIG5leHRTdGF0ZS5uYW1lKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0ZSAmJiB0aGlzLl9zdGF0ZS5vbkV4aXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZS5vbkV4aXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gbmV4dFN0YXRlO1xuICAgICAgICAgICAgaWYgKG5leHRTdGF0ZS5vbkVudGVyKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgbmV4dFN0YXRlLm9uRW50ZXIoKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2xvZ2dlci53YXJuKG5leHRTdGF0ZS5uYW1lICsgJyNvbkVudGVyIGZhaWxlZCcsIGUpO1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuc2FmZS1maW5hbGx5XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2NyZWF0ZVNpZ25hbGluZ0NoYW5uZWwoKSB7XG4gICAgICAgIHZhciBzaWduYWxpbmdDaGFubmVsID0gbmV3IFJ0Y1NpZ25hbGluZyh0aGlzLl9jYWxsSWQsIHRoaXMuX3NpZ25hbGluZ1VyaSwgdGhpcy5fY29udGFjdFRva2VuLCB0aGlzLl9vcmlnaW5hbExvZ2dlciwgdGhpcy5fc2lnbmFsaW5nQ29ubmVjdFRpbWVvdXQsIHRoaXMuX2Nvbm5lY3Rpb25JZCwgdGhpcy5fd3NzTWFuYWdlcik7XG4gICAgICAgIHNpZ25hbGluZ0NoYW5uZWwub25Db25uZWN0ZWQgPSBoaXRjaCh0aGlzLCB0aGlzLl9zaWduYWxpbmdDb25uZWN0ZWQpO1xuICAgICAgICBzaWduYWxpbmdDaGFubmVsLm9uQW5zd2VyZWQgPSBoaXRjaCh0aGlzLCB0aGlzLl9zaWduYWxpbmdBbnN3ZXJlZCk7XG4gICAgICAgIHNpZ25hbGluZ0NoYW5uZWwub25IYW5kc2hha2VkID0gaGl0Y2godGhpcywgdGhpcy5fc2lnbmFsaW5nSGFuZHNoYWtlZCk7XG4gICAgICAgIHNpZ25hbGluZ0NoYW5uZWwub25SZW1vdGVIdW5ndXAgPSBoaXRjaCh0aGlzLCB0aGlzLl9zaWduYWxpbmdSZW1vdGVIdW5ndXApO1xuICAgICAgICBzaWduYWxpbmdDaGFubmVsLm9uRmFpbGVkID0gaGl0Y2godGhpcywgdGhpcy5fc2lnbmFsaW5nRmFpbGVkKTtcbiAgICAgICAgc2lnbmFsaW5nQ2hhbm5lbC5vbkRpc2Nvbm5lY3RlZCA9IGhpdGNoKHRoaXMsIHRoaXMuX3NpZ25hbGluZ0Rpc2Nvbm5lY3RlZCk7XG5cbiAgICAgICAgdGhpcy5fc2lnbmFsaW5nQ2hhbm5lbCA9IHNpZ25hbGluZ0NoYW5uZWw7XG5cbiAgICAgICAgcmV0dXJuIHNpZ25hbGluZ0NoYW5uZWw7XG4gICAgfVxuXG4gICAgX3NpZ25hbGluZ0Nvbm5lY3RlZCgpIHtcbiAgICAgICAgdGhpcy5fc3RhdGUub25TaWduYWxpbmdDb25uZWN0ZWQoKTtcbiAgICB9XG4gICAgX3NpZ25hbGluZ0Fuc3dlcmVkKHNkcCwgY2FuZGlkYXRlcykge1xuICAgICAgICB0aGlzLl9zdGF0ZS5vblNpZ25hbGluZ0Fuc3dlcmVkKHNkcCwgY2FuZGlkYXRlcyk7XG4gICAgfVxuICAgIF9zaWduYWxpbmdIYW5kc2hha2VkKCkge1xuICAgICAgICB0aGlzLl9zdGF0ZS5vblNpZ25hbGluZ0hhbmRzaGFrZWQoKTtcbiAgICB9XG4gICAgX3NpZ25hbGluZ1JlbW90ZUh1bmd1cCgpIHtcbiAgICAgICAgdGhpcy5fc3RhdGUub25SZW1vdGVIdW5ndXAoKTtcbiAgICB9XG4gICAgX3NpZ25hbGluZ0ZhaWxlZChlKSB7XG4gICAgICAgIHRoaXMuX3N0YXRlLm9uU2lnbmFsaW5nRmFpbGVkKGUpO1xuICAgIH1cbiAgICBfc2lnbmFsaW5nRGlzY29ubmVjdGVkKCkge1xuICAgIH1cbiAgICBfY3JlYXRlUGVlckNvbm5lY3Rpb24oY29uZmlndXJhdGlvbiwgb3B0aW9uYWxDb25maWd1cmF0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdHJhdGVneS5fY3JlYXRlUGVlckNvbm5lY3Rpb24oY29uZmlndXJhdGlvbiwgb3B0aW9uYWxDb25maWd1cmF0aW9uKTtcbiAgICB9XG4gICAgY29ubmVjdChwYykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBzZWxmLl9zZXNzaW9uUmVwb3J0LnNlc3Npb25TdGFydFRpbWUgPSBub3c7XG4gICAgICAgIHNlbGYuX2Nvbm5lY3RUaW1lU3RhbXAgPSBub3cuZ2V0VGltZSgpO1xuICAgICAgICBpZiAocGMgJiYgcGMuc2lnbmFsaW5nU3RhdGUgIT0gJ2Nsb3NlZCcpIHtcbiAgICAgICAgICAgIHNlbGYuX3BjID0gcGM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAocGMpIHtcbiAgICAgICAgICAgICAgICBwYy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIHBjID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFJUQ19QRUVSX0NPTk5FQ1RJT05fQ09ORklHLmljZVNlcnZlcnMgPSBzZWxmLl9pY2VTZXJ2ZXJzO1xuICAgICAgICAgICAgc2VsZi5fcGMgPSBzZWxmLl9jcmVhdGVQZWVyQ29ubmVjdGlvbihSVENfUEVFUl9DT05ORUNUSU9OX0NPTkZJRywgUlRDX1BFRVJfQ09OTkVDVElPTl9PUFRJT05BTF9DT05GSUcpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuX3BjLm9udHJhY2sgPSBoaXRjaChzZWxmLCBzZWxmLl9vbnRyYWNrKTtcbiAgICAgICAgc2VsZi5fcGMub25pY2VjYW5kaWRhdGUgPSBoaXRjaChzZWxmLCBzZWxmLl9vbkljZUNhbmRpZGF0ZSk7XG4gICAgICAgIHNlbGYuX3BjLm9uY29ubmVjdGlvbnN0YXRlY2hhbmdlID0gaGl0Y2goc2VsZiwgc2VsZi5fb25QZWVyQ29ubmVjdGlvblN0YXRlQ2hhbmdlKTtcbiAgICAgICAgc2VsZi5fcGMub25pY2Vjb25uZWN0aW9uc3RhdGVjaGFuZ2UgPSBoaXRjaChzZWxmLCBzZWxmLl9vbkljZVN0YXRlQ2hhbmdlKTtcblxuICAgICAgICBpc0xlZ2FjeVN0YXRzUmVwb3J0U3VwcG9ydGVkKHNlbGYuX3BjKS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICAgICAgICBzZWxmLl9sZWdhY3lTdGF0c1JlcG9ydFN1cHBvcnQgPSByZXN1bHQ7XG4gICAgICAgICAgICBzZWxmLnRyYW5zaXQobmV3IEdyYWJMb2NhbE1lZGlhU3RhdGUoc2VsZikpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgYWNjZXB0KCkge1xuICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb24oJ2FjY2VwdCBkb2VzIG5vdCBnbyB0aHJvdWdoIHNpZ25hbGluZyBjaGFubmVsIGF0IHRoaXMgbW9tZW50Jyk7XG4gICAgfVxuICAgIGhhbmd1cCgpIHtcbiAgICAgICAgdGhpcy5fc3RhdGUuaGFuZ3VwKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGEgcHJvbWlzZSBjb250YWluaW5nIGFuIG9iamVjdCB3aXRoIHR3byBuYW1lZCBsaXN0cyBvZiBhdWRpbyBzdGF0cywgb25lIGZvciBlYWNoIGNoYW5uZWwgb24gZWFjaFxuICAgICAqIG1lZGlhIHR5cGUgb2YgJ3ZpZGVvJyBhbmQgJ2F1ZGlvJy5cbiAgICAgKiBAcmV0dXJuIFJlamVjdGVkIHByb21pc2UgaWYgZmFpbGVkIHRvIGdldCBNZWRpYVJ0cFN0YXRzLiBUaGUgcHJvbWlzZSBpcyBuZXZlciByZXNvbHZlZCB3aXRoIG51bGwgdmFsdWUuXG4gICAgICovXG4gICAgYXN5bmMgZ2V0U3RhdHMoKSB7XG4gICAgICAgIHZhciB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgIHZhciBpbXBsID0gYXN5bmMgKHN0cmVhbSwgc3RyZWFtVHlwZSkgPT4ge1xuICAgICAgICAgICAgdmFyIHRyYWNrcyA9IFtdO1xuXG4gICAgICAgICAgICBpZiAoIXN0cmVhbSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc3dpdGNoIChzdHJlYW1UeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnYXVkaW9faW5wdXQnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2F1ZGlvX291dHB1dCc6XG4gICAgICAgICAgICAgICAgICAgIHRyYWNrcyA9IHN0cmVhbS5nZXRBdWRpb1RyYWNrcygpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICd2aWRlb19pbnB1dCc6XG4gICAgICAgICAgICAgICAgY2FzZSAndmlkZW9fb3V0cHV0JzpcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tzID0gc3RyZWFtLmdldFZpZGVvVHJhY2tzKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5zdXBwb3J0ZWQgc3RyZWFtIHR5cGUgd2hpbGUgdHJ5aW5nIHRvIGdldCBzdGF0czogJyArIHN0cmVhbVR5cGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwodHJhY2tzLm1hcChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IHN0YW5kYXJkaXplZCByZXBvcnRcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcGMuZ2V0U3RhdHMoKS50aGVuKGZ1bmN0aW9uIChyYXdTdGF0cykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGlnZXN0ZWRTdGF0cyA9IGV4dHJhY3RNZWRpYVN0YXRzRnJvbVN0YXRzKHRpbWVzdGFtcCwgcmF3U3RhdHMsIHN0cmVhbVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWRpZ2VzdGVkU3RhdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGV4dHJhY3QgTWVkaWFSdHBTdGF0cyBmcm9tIFJUQ1N0YXRzUmVwb3J0IGZvciBzdHJlYW0gdHlwZSAnICsgc3RyZWFtVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRpZ2VzdGVkU3RhdHM7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAodGhpcy5fcGMgJiYgdGhpcy5fcGMuc2lnbmFsaW5nU3RhdGUgPT09ICdzdGFibGUnKSB7XG4gICAgICAgICAgICB2YXIgc3RhdHNSZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgYXVkaW86IHtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQ6IGF3YWl0IGltcGwodGhpcy5fcmVtb3RlQXVkaW9TdHJlYW0sICdhdWRpb19pbnB1dCcpLFxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQ6IGF3YWl0IGltcGwodGhpcy5fbG9jYWxTdHJlYW0sICdhdWRpb19vdXRwdXQnKVxuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICB2aWRlbzoge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dDogYXdhaXQgaW1wbCh0aGlzLl9yZW1vdGVWaWRlb1N0cmVhbSwgJ3ZpZGVvX2lucHV0JyksXG4gICAgICAgICAgICAgICAgICAgIG91dHB1dDogYXdhaXQgaW1wbCh0aGlzLl9sb2NhbFN0cmVhbSwgJ3ZpZGVvX291dHB1dCcpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gRm9yIGNvbnNpc3RlbmN5J3Mgc2FrZSwgY29hbGVzY2UgcnR0TWlsbGlzZWNvbmRzIGludG8gdGhlIG91dHB1dCBmb3IgYXVkaW8gYW5kIHZpZGVvLlxuICAgICAgICAgICAgdmFyIHJ0dFJlZHVjZXIgPSAoYWNjLCBzdGF0cykgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChzdGF0cy5ydHRNaWxsaXNlY29uZHMgIT09IG51bGwgJiYgKGFjYyA9PT0gbnVsbCB8fCBzdGF0cy5ydHRNaWxsaXNlY29uZHMgPiBhY2MpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjYyA9IHN0YXRzLnJ0dE1pbGxpc2Vjb25kcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdHMuX3J0dE1pbGxpc2Vjb25kcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBhdWRpb0lucHV0UnR0TWlsbGlzZWNvbmRzID0gc3RhdHNSZXN1bHQuYXVkaW8uaW5wdXQucmVkdWNlKHJ0dFJlZHVjZXIsIG51bGwpO1xuICAgICAgICAgICAgdmFyIHZpZGVvSW5wdXRSdHRNaWxsaXNlY29uZHMgPSBzdGF0c1Jlc3VsdC52aWRlby5pbnB1dC5yZWR1Y2UocnR0UmVkdWNlciwgbnVsbCk7XG5cbiAgICAgICAgICAgIGlmIChhdWRpb0lucHV0UnR0TWlsbGlzZWNvbmRzICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgc3RhdHNSZXN1bHQuYXVkaW8ub3V0cHV0LmZvckVhY2goKHN0YXRzKSA9PiB7IHN0YXRzLl9ydHRNaWxsaXNlY29uZHMgPSBhdWRpb0lucHV0UnR0TWlsbGlzZWNvbmRzOyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHZpZGVvSW5wdXRSdHRNaWxsaXNlY29uZHMgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBzdGF0c1Jlc3VsdC52aWRlby5vdXRwdXQuZm9yRWFjaCgoc3RhdHMpID0+IHsgc3RhdHMuX3J0dE1pbGxpc2Vjb25kcyA9IHZpZGVvSW5wdXRSdHRNaWxsaXNlY29uZHM7IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gc3RhdHNSZXN1bHQ7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgSWxsZWdhbFN0YXRlKCkpO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgYSBwcm9taXNlIG9mIE1lZGlhUnRwU3RhdHMgb2JqZWN0IGZvciByZW1vdGUgYXVkaW8gKGZyb20gQW1hem9uIENvbm5lY3QgdG8gY2xpZW50KS5cbiAgICAgKiBAcmV0dXJuIFJlamVjdGVkIHByb21pc2UgaWYgZmFpbGVkIHRvIGdldCBNZWRpYVJ0cFN0YXRzLiBUaGUgcHJvbWlzZSBpcyBuZXZlciByZXNvbHZlZCB3aXRoIG51bGwgdmFsdWUuXG4gICAgICogQGRlcHJlY2F0ZWQgaW4gZmF2b3Igb2YgZ2V0U3RhdHMoKVxuICAgICAqL1xuICAgIGdldFJlbW90ZUF1ZGlvU3RhdHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFN0YXRzKCkudGhlbihmdW5jdGlvbihzdGF0cykge1xuICAgICAgICAgICAgaWYgKHN0YXRzLmF1ZGlvLm91dHB1dC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRzLmF1ZGlvLm91dHB1dFswXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBJbGxlZ2FsU3RhdGUoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhIHByb21pc2Ugb2YgTWVkaWFSdHBTdGF0cyBvYmplY3QgZm9yIHVzZXIgYXVkaW8gKGZyb20gY2xpZW50IHRvIEFtYXpvbiBDb25uZWN0KS5cbiAgICAgKiBAcmV0dXJuIFJlamVjdGVkIHByb21pc2UgaWYgZmFpbGVkIHRvIGdldCBNZWRpYVJ0cFN0YXRzLiBUaGUgcHJvbWlzZSBpcyBuZXZlciByZXNvbHZlZCB3aXRoIG51bGwgdmFsdWUuXG4gICAgICogQGRlcHJlY2F0ZWQgaW4gZmF2b3Igb2YgZ2V0U3RhdHMoKVxuICAgICAqL1xuICAgIGdldFVzZXJBdWRpb1N0YXRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTdGF0cygpLnRoZW4oZnVuY3Rpb24oc3RhdHMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0cy5hdWRpby5pbnB1dC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRzLmF1ZGlvLmlucHV0WzBdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IElsbGVnYWxTdGF0ZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGEgcHJvbWlzZSBvZiBNZWRpYVJ0cFN0YXRzIG9iamVjdCBmb3IgdXNlciB2aWRlbyAoZnJvbSBjbGllbnQgdG8gQW1hem9uIENvbm5lY3QpLlxuICAgICAqIEByZXR1cm4gUmVqZWN0ZWQgcHJvbWlzZSBpZiBmYWlsZWQgdG8gZ2V0IE1lZGlhUnRwU3RhdHMuIFRoZSBwcm9taXNlIGlzIG5ldmVyIHJlc29sdmVkIHdpdGggbnVsbCB2YWx1ZS5cbiAgICAgKiBAZGVwcmVjYXRlZCBpbiBmYXZvciBvZiBnZXRTdGF0cygpXG4gICAgICovXG4gICAgZ2V0UmVtb3RlVmlkZW9TdGF0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3RhdHMoKS50aGVuKGZ1bmN0aW9uKHN0YXRzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHMudmlkZW8ub3V0cHV0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdHMudmlkZW8ub3V0cHV0WzBdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IElsbGVnYWxTdGF0ZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGEgcHJvbWlzZSBvZiBNZWRpYVJ0cFN0YXRzIG9iamVjdCBmb3IgdXNlciB2aWRlbyAoZnJvbSBjbGllbnQgdG8gQW1hem9uIENvbm5lY3QpLlxuICAgICAqIEByZXR1cm4gUmVqZWN0ZWQgcHJvbWlzZSBpZiBmYWlsZWQgdG8gZ2V0IE1lZGlhUnRwU3RhdHMuIFRoZSBwcm9taXNlIGlzIG5ldmVyIHJlc29sdmVkIHdpdGggbnVsbCB2YWx1ZS5cbiAgICAgKiBAZGVwcmVjYXRlZCBpbiBmYXZvciBvZiBnZXRTdGF0cygpXG4gICAgICovXG4gICAgZ2V0VXNlclZpZGVvU3RhdHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFN0YXRzKCkudGhlbihmdW5jdGlvbihzdGF0cykge1xuICAgICAgICAgICAgaWYgKHN0YXRzLnZpZGVvLmlucHV0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdHMudmlkZW8uaW5wdXRbMF07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgSWxsZWdhbFN0YXRlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBfb25JY2VDYW5kaWRhdGUoZXZ0KSB7XG4gICAgICAgIHRoaXMuX3N0YXRlLm9uSWNlQ2FuZGlkYXRlKGV2dCk7XG4gICAgfVxuXG4gICAgX29uUGVlckNvbm5lY3Rpb25TdGF0ZUNoYW5nZSgpIHtcbiAgICAgICAgdGhpcy5fc3RhdGUub25QZWVyQ29ubmVjdGlvblN0YXRlQ2hhbmdlKCk7XG4gICAgfVxuXG4gICAgX29uSWNlU3RhdGVDaGFuZ2UoZXZ0KSB7XG4gICAgICAgIHRoaXMuX3N0YXRlLm9uSWNlU3RhdGVDaGFuZ2UoZXZ0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBdHRhY2ggcmVtb3RlIG1lZGlhIHN0cmVhbSB0byB3ZWIgZWxlbWVudC5cbiAgICAgKi9cbiAgICBfb250cmFjayhldnQpIHtcbiAgICAgICAgdGhpcy5fc3RyYXRlZ3kuX29udHJhY2sodGhpcywgZXZ0KTtcbiAgICAgICAgdGhpcy5fb25SZW1vdGVTdHJlYW1BZGRlZCh0aGlzLCBldnQuc3RyZWFtc1swXSk7XG4gICAgfVxuICAgIF9kZXRhY2hNZWRpYSgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlbW90ZVZpZGVvRWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5fcmVtb3RlVmlkZW9FbGVtZW50LnNyY09iamVjdCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3JlbW90ZUF1ZGlvRWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5fcmVtb3RlQXVkaW9FbGVtZW50LnNyY09iamVjdCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9yZW1vdGVBdWRpb1N0cmVhbSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX3N0b3BTZXNzaW9uKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2xvY2FsU3RyZWFtICYmICF0aGlzLl9pc1VzZXJQcm92aWRlZFN0cmVhbSkge1xuICAgICAgICAgICAgICAgIGNsb3NlU3RyZWFtKHRoaXMuX2xvY2FsU3RyZWFtKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2NhbFN0cmVhbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5faXNVc2VyUHJvdmlkZWRTdHJlYW0gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3BjKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BjLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIGVhdCBleGNlcHRpb25cbiAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGMgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2J1aWxkTWVkaWFDb25zdHJhaW50cygpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgbWVkaWFDb25zdHJhaW50cyA9IHt9O1xuXG4gICAgICAgIHNlbGYuX3N0cmF0ZWd5Ll9idWlsZE1lZGlhQ29uc3RyYWludHMoc2VsZiwgbWVkaWFDb25zdHJhaW50cyk7XG5cbiAgICAgICAgaWYgKHNlbGYuX2VuYWJsZVZpZGVvKSB7XG4gICAgICAgICAgICB2YXIgdmlkZW9Db25zdHJhaW50cyA9IHt9O1xuICAgICAgICAgICAgdmFyIHdpZHRoQ29uc3RyYWludHMgPSB7fTtcbiAgICAgICAgICAgIHZhciBoZWlnaHRDb25zdHJhaW50cyA9IHt9O1xuICAgICAgICAgICAgdmFyIGZyYW1lUmF0ZUNvbnN0cmFpbnRzID0ge307XG5cbiAgICAgICAgICAgIC8vYnVpbGQgdmlkZW8gd2lkdGggY29uc3RyYWludHNcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc2VsZi5faWRlYWxWaWRlb1dpZHRoICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHdpZHRoQ29uc3RyYWludHMuaWRlYWwgPSBzZWxmLl9pZGVhbFZpZGVvV2lkdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYuX21heFZpZGVvV2lkdGggIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgd2lkdGhDb25zdHJhaW50cy5tYXggPSBzZWxmLl9tYXhWaWRlb1dpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLl9taW5WaWRlb1dpZHRoICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHdpZHRoQ29uc3RyYWludHMubWluID0gc2VsZi5fbWluVmlkZW9XaWR0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGJ1aWxkIHZpZGVvIGhlaWdodCBjb25zdHJhaW50c1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLl9pZGVhbFZpZGVvSGVpZ2h0ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGhlaWdodENvbnN0cmFpbnRzLmlkZWFsID0gc2VsZi5faWRlYWxWaWRlb0hlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc2VsZi5fbWF4VmlkZW9IZWlnaHQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgaGVpZ2h0Q29uc3RyYWludHMubWF4ID0gc2VsZi5fbWF4VmlkZW9IZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYuX21pblZpZGVvSGVpZ2h0ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGhlaWdodENvbnN0cmFpbnRzLm1pbiA9IHNlbGYuX21pblZpZGVvSGVpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoT2JqZWN0LmtleXMod2lkdGhDb25zdHJhaW50cykubGVuZ3RoID4gMCAmJiBPYmplY3Qua2V5cyhoZWlnaHRDb25zdHJhaW50cykubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZpZGVvQ29uc3RyYWludHMud2lkdGggPSB3aWR0aENvbnN0cmFpbnRzO1xuICAgICAgICAgICAgICAgIHZpZGVvQ29uc3RyYWludHMuaGVpZ2h0ID0gaGVpZ2h0Q29uc3RyYWludHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBidWlsZCBmcmFtZSByYXRlIGNvbnN0cmFpbnRzXG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYuX3ZpZGVvRnJhbWVSYXRlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGZyYW1lUmF0ZUNvbnN0cmFpbnRzLmlkZWFsID0gc2VsZi5fdmlkZW9GcmFtZVJhdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYuX21pblZpZGVvRnJhbWVSYXRlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGZyYW1lUmF0ZUNvbnN0cmFpbnRzLm1pbiA9IHNlbGYuX21pblZpZGVvRnJhbWVSYXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLl9tYXhWaWRlb0ZyYW1lUmF0ZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICBmcmFtZVJhdGVDb25zdHJhaW50cy5tYXggPSBzZWxmLl9tYXhWaWRlb0ZyYW1lUmF0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKE9iamVjdC5rZXlzKGZyYW1lUmF0ZUNvbnN0cmFpbnRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdmlkZW9Db25zdHJhaW50cy5mcmFtZVJhdGUgPSBmcmFtZVJhdGVDb25zdHJhaW50cztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYnVpbGQgZmFjaW5nIG1vZGUgY29uc3RyYWludHNcbiAgICAgICAgICAgIGlmKHNlbGYuX2ZhY2luZ01vZGUgIT09ICd1c2VyJyAmJiBzZWxmLl9mYWNpbmdNb2RlICE9PSBcImVudmlyb25tZW50XCIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9mYWNpbmdNb2RlID0gJ3VzZXInO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmlkZW9Db25zdHJhaW50cy5mYWNpbmdNb2RlID0gc2VsZi5fZmFjaW5nTW9kZTtcblxuICAgICAgICAgICAgLy8gc2V0IHZpZGVvIGNvbnN0cmFpbnRzXG4gICAgICAgICAgICBpZiAoT2JqZWN0LmtleXModmlkZW9Db25zdHJhaW50cykubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIG1lZGlhQ29uc3RyYWludHMudmlkZW8gPSB2aWRlb0NvbnN0cmFpbnRzO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtZWRpYUNvbnN0cmFpbnRzLnZpZGVvID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBtZWRpYUNvbnN0cmFpbnRzO1xuICAgIH1cbn1cbiIsIi8qKlxuICogRXh0cmFjdCBydHAgc3RhdHMgb2Ygc3BlY2lmaWVkIHN0cmVhbSBmcm9tIFJUQ1N0YXRzUmVwb3J0XG4gKiBDaHJvbWUgcmVwb3J0cyBhbGwgc3RyZWFtIHN0YXRzIGluIHN0YXRzUmVwb3J0cyB3aGVyZWFzIGZpcmVmb3ggcmVwb3J0cyBvbmx5IHNpbmdsZSBzdHJlYW0gc3RhdHMgaW4gcmVwb3J0XG4gKiBTdHJlYW1UeXBlIGlzIHBhc3NlZCBvbmx5IHRvIHB1bGwgcmlnaHQgc3RyZWFtIHN0YXRzIGF1ZGlvX2lucHV0IG9yIGF1ZGlvX291dHB1dC5cbiAqL1xuXG5pbXBvcnQgeyBpc19kZWZpbmVkLCB3aGVuX2RlZmluZWQgfSBmcm9tICcuL3V0aWxzJztcbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0TWVkaWFTdGF0c0Zyb21TdGF0cyh0aW1lc3RhbXAsIHN0YXRzLCBzdHJlYW1UeXBlKSB7XG4gICAgdmFyIGV4dHJhY3RlZFN0YXRzID0gbnVsbDtcbiAgICB2YXIgcmVwb3J0VHlwZSA9IG51bGw7XG5cbiAgICBzdGF0cy5mb3JFYWNoKHN0YXRzUmVwb3J0ID0+IHtcbiAgICAgICAgaWYgKHN0YXRzUmVwb3J0KSB7XG4gICAgICAgICAgICBpZiAoc3RhdHNSZXBvcnQudHlwZSA9PT0gJ2luYm91bmQtcnRwJyAmJiBzdHJlYW1UeXBlID09PSAnYXVkaW9faW5wdXQnKSB7XG4gICAgICAgICAgICAgICAgLy8gaW5ib3VuZC1ydHA6IFN0YXRzIGZvciBzdHJlYW0gZnJvbSBTZXJ2ZXIgdG8gQ0NQLCBhcyBzZWVuIG9uIHRoZSBicm93c2VyXG4gICAgICAgICAgICAgICAgcmVwb3J0VHlwZSA9IHN0YXRzUmVwb3J0LnR5cGU7XG4gICAgICAgICAgICAgICAgZXh0cmFjdGVkU3RhdHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogdGltZXN0YW1wLFxuICAgICAgICAgICAgICAgICAgICBwYWNrZXRzTG9zdDogc3RhdHNSZXBvcnQucGFja2V0c0xvc3QsXG4gICAgICAgICAgICAgICAgICAgIC8vIHBhY2tldHNDb3VudDogbnVtYmVyIG9mIHBhY2tldCByZWNlaXZlZCBieSBDQ1AsIGFzIHNlZW4gb24gdGhlIGJyb3dzZXJcbiAgICAgICAgICAgICAgICAgICAgcGFja2V0c0NvdW50OiBzdGF0c1JlcG9ydC5wYWNrZXRzUmVjZWl2ZWQsXG4gICAgICAgICAgICAgICAgICAgIGpiTWlsbGlzZWNvbmRzOiBNYXRoLmZsb29yKHdoZW5fZGVmaW5lZChzdGF0c1JlcG9ydC5qaXR0ZXIsIDApICogMTAwMCksXG4gICAgICAgICAgICAgICAgICAgIC8vIE11bHRpcGx5aW5nIGF1ZGlvTGV2ZWwgYnkgMzI3NjggYWxpZ25zIGl0cyB2YWx1ZSB3aXRoIHRoZSBsZWdhY3kgZ2V0U3RhdHMgQVBJLlxuICAgICAgICAgICAgICAgICAgICBhdWRpb0xldmVsOiBpc19kZWZpbmVkKHN0YXRzUmVwb3J0LmF1ZGlvTGV2ZWwpID8gTWF0aC5mbG9vcihzdGF0c1JlcG9ydC5hdWRpb0xldmVsICogMzI3NjgpIDogbnVsbFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRzUmVwb3J0LnR5cGUgPT09ICdvdXRib3VuZC1ydHAnICYmIHN0cmVhbVR5cGUgPT09ICdhdWRpb19vdXRwdXQnKSB7XG4gICAgICAgICAgICAgICAgLy8gb3V0Ym91bmQtcnRwOiBTdGF0cyBmb3Igc3RyZWFtIGZyb20gQ0NQIHRvIFNlcnZlciwgYXMgc2VlbiBvbiB0aGUgYnJvd3NlclxuICAgICAgICAgICAgICAgIGV4dHJhY3RlZFN0YXRzID0gZXh0cmFjdGVkU3RhdHMgfHwge307XG4gICAgICAgICAgICAgICAgLy8gcGFja2V0c0NvdW50OiBudW1iZXIgb2YgcGFja2V0IHNlbnQgYnkgQ0NQLCBhcyBzZWVuIG9uIHRoZSBicm93c2VyXG4gICAgICAgICAgICAgICAgZXh0cmFjdGVkU3RhdHMucGFja2V0c0NvdW50ID0gc3RhdHNSZXBvcnQucGFja2V0c1NlbnQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRzUmVwb3J0LnR5cGUgPT09ICdtZWRpYS1zb3VyY2UnICYmIHN0cmVhbVR5cGUgPT09ICdhdWRpb19vdXRwdXQnKSB7XG4gICAgICAgICAgICAgICAgZXh0cmFjdGVkU3RhdHMgPSBleHRyYWN0ZWRTdGF0cyB8fCB7fTtcbiAgICAgICAgICAgICAgICAvLyBNdWx0aXBseWluZyBhdWRpb0xldmVsIGJ5IDMyNzY4IGFsaWducyBpdHMgdmFsdWUgd2l0aCB0aGUgbGVnYWN5IGdldFN0YXRzIEFQSS5cbiAgICAgICAgICAgICAgICBleHRyYWN0ZWRTdGF0cy5hdWRpb0xldmVsID0gaXNfZGVmaW5lZChzdGF0c1JlcG9ydC5hdWRpb0xldmVsKSA/IE1hdGguZmxvb3Ioc3RhdHNSZXBvcnQuYXVkaW9MZXZlbCAqIDMyNzY4KSA6IG51bGw7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXRzUmVwb3J0LnR5cGUgPT09ICdyZW1vdGUtaW5ib3VuZC1ydHAnICYmIHN0cmVhbVR5cGUgPT09ICdhdWRpb19vdXRwdXQnKSB7XG4gICAgICAgICAgICAgICAgLy8gcmVtb3RlLWluYm91bmQtcnRwOiBTdGF0cyBmb3Igc3RyZWFtIGZyb20gQ0NQIHRvIFNlcnZlciwgYXMgc2VlbiBvbiBTZXJ2ZXIgc2lkZVxuICAgICAgICAgICAgICAgIHJlcG9ydFR5cGUgPSBzdGF0c1JlcG9ydC50eXBlO1xuICAgICAgICAgICAgICAgIGV4dHJhY3RlZFN0YXRzID0gZXh0cmFjdGVkU3RhdHMgfHwge307XG4gICAgICAgICAgICAgICAgZXh0cmFjdGVkU3RhdHMudGltZXN0YW1wID0gdGltZXN0YW1wO1xuICAgICAgICAgICAgICAgIGV4dHJhY3RlZFN0YXRzLnBhY2tldHNMb3N0ID0gc3RhdHNSZXBvcnQucGFja2V0c0xvc3Q7XG4gICAgICAgICAgICAgICAgZXh0cmFjdGVkU3RhdHMucnR0TWlsbGlzZWNvbmRzID0gaXNfZGVmaW5lZChzdGF0c1JlcG9ydC5yb3VuZFRyaXBUaW1lKSA/IE1hdGguZmxvb3Ioc3RhdHNSZXBvcnQucm91bmRUcmlwVGltZSAqIDEwMDApIDogbnVsbDtcbiAgICAgICAgICAgICAgICBleHRyYWN0ZWRTdGF0cy5qYk1pbGxpc2Vjb25kcyA9IE1hdGguZmxvb3Iod2hlbl9kZWZpbmVkKHN0YXRzUmVwb3J0LmppdHRlciwgMCkgKiAxMDAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGV4dHJhY3RlZFN0YXRzID8gbmV3IE1lZGlhUnRwU3RhdHMoZXh0cmFjdGVkU3RhdHMsIHJlcG9ydFR5cGUsIHN0cmVhbVR5cGUpIDogbnVsbDtcbn1cblxuLyoqXG4gKiBCYXNpYyBSVFAgc3RhdGlzdGljcyBvYmplY3QsIHJlcHJlc2VudHMgc3RhdGlzdGljcyBvZiBhbiBhdWRpbyBvciB2aWRlbyBzdHJlYW0uXG4gKi9cbmNsYXNzIE1lZGlhUnRwU3RhdHMge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtc0luLCBzdGF0c1JlcG9ydFR5cGUsIHN0cmVhbVR5cGUpIHtcbiAgICAgICAgdmFyIHBhcmFtcyA9IHBhcmFtc0luIHx8IHt9O1xuXG4gICAgICAgIHRoaXMuX3RpbWVzdGFtcCAgICAgICAgID0gcGFyYW1zLnRpbWVzdGFtcCB8fCBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICAgdGhpcy5fcGFja2V0c0xvc3QgICAgICAgPSB3aGVuX2RlZmluZWQocGFyYW1zLnBhY2tldHNMb3N0KTtcbiAgICAgICAgdGhpcy5fcGFja2V0c0NvdW50ICAgICAgPSB3aGVuX2RlZmluZWQocGFyYW1zLnBhY2tldHNDb3VudCk7XG4gICAgICAgIHRoaXMuX2F1ZGlvTGV2ZWwgICAgICAgID0gd2hlbl9kZWZpbmVkKHBhcmFtcy5hdWRpb0xldmVsKTtcbiAgICAgICAgdGhpcy5fcHJvY01pbGxpc2Vjb25kcyAgPSB3aGVuX2RlZmluZWQocGFyYW1zLnByb2NNaWxsaXNlY29uZHMpO1xuICAgICAgICB0aGlzLl9ydHRNaWxsaXNlY29uZHMgICA9IHdoZW5fZGVmaW5lZChwYXJhbXMucnR0TWlsbGlzZWNvbmRzKTtcbiAgICAgICAgdGhpcy5famJNaWxsaXNlY29uZHMgICAgPSB3aGVuX2RlZmluZWQocGFyYW1zLmpiTWlsbGlzZWNvbmRzKTtcbiAgICAgICAgdGhpcy5fYnl0ZXNTZW50ICAgICAgICAgPSB3aGVuX2RlZmluZWQocGFyYW1zLmJ5dGVzU2VudCk7XG4gICAgICAgIHRoaXMuX2J5dGVzUmVjZWl2ZWQgICAgID0gd2hlbl9kZWZpbmVkKHBhcmFtcy5ieXRlc1JlY2VpdmVkKTtcbiAgICAgICAgdGhpcy5fZnJhbWVzRW5jb2RlZCAgICAgPSB3aGVuX2RlZmluZWQocGFyYW1zLmZyYW1lc0VuY29kZWQpO1xuICAgICAgICB0aGlzLl9mcmFtZXNEZWNvZGVkICAgICA9IHdoZW5fZGVmaW5lZChwYXJhbXMuZnJhbWVzRGVjb2RlZCk7XG4gICAgICAgIHRoaXMuX2ZyYW1lUmF0ZVNlbnQgICAgID0gd2hlbl9kZWZpbmVkKHBhcmFtcy5mcmFtZVJhdGVTZW50KTtcbiAgICAgICAgdGhpcy5fZnJhbWVSYXRlUmVjZWl2ZWQgPSB3aGVuX2RlZmluZWQocGFyYW1zLmZyYW1lUmF0ZVJlY2VpdmVkKTtcbiAgICAgICAgdGhpcy5fc3RhdHNSZXBvcnRUeXBlICAgPSBzdGF0c1JlcG9ydFR5cGUgfHwgcGFyYW1zLl9zdGF0c1JlcG9ydFR5cGUgfHwgXCJ1bmtub3duXCI7XG4gICAgICAgIHRoaXMuX3N0cmVhbVR5cGUgICAgICAgID0gc3RyZWFtVHlwZSB8fCBwYXJhbXMuc3RyZWFtVHlwZSB8fCBcInVua25vd25cIjtcbiAgICB9XG5cbiAgICAvKioge251bWJlcn0gbnVtYmVyIG9mIHBhY2tldHMgc2VudCB0byB0aGUgY2hhbm5lbCAqL1xuICAgIGdldCBwYWNrZXRzQ291bnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYWNrZXRzQ291bnQ7XG4gICAgfVxuICAgIC8qKiB7bnVtYmVyfSBudW1iZXIgb2YgcGFja2V0cyBsb3N0IGFmdGVyIHRyYXZlbGxpbmcgdGhyb3VnaCB0aGUgY2hhbm5lbCAqL1xuICAgIGdldCBwYWNrZXRzTG9zdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhY2tldHNMb3N0O1xuICAgIH1cbiAgICAvKioge251bWJlcn0gbnVtYmVyIG9mIHBhY2tldHMgbG9zdCBhZnRlciB0cmF2ZWxsaW5nIHRocm91Z2ggdGhlIGNoYW5uZWwgKi9cbiAgICBnZXQgcGFja2V0TG9zc1BlcmNlbnRhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYWNrZXRzQ291bnQgPiAwID8gdGhpcy5fcGFja2V0c0xvc3QgLyB0aGlzLl9wYWNrZXRzQ291bnQgOiAwO1xuICAgIH1cbiAgICAvKiogQXVkaW8gdm9sdW1lIGxldmVsXG4gICAgICogQ3VycmVudGx5IGZpcmVmb3ggZG9lc24ndCBwcm92aWRlIGF1ZGlvIGxldmVsIGluIHJ0cCBzdGF0cy5cbiAgICAgKi9cbiAgICBnZXQgYXVkaW9MZXZlbCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2F1ZGlvTGV2ZWw7XG4gICAgfVxuICAgIC8qKiBUaW1lc3RhbXAgd2hlbiBzdGF0cyBhcmUgY29sbGVjdGVkLiAqL1xuICAgIGdldCB0aW1lc3RhbXAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90aW1lc3RhbXA7XG4gICAgfVxuICAgIC8qKiB7bnVtYmVyfSBQcm9jZXNzaW5nIGRlbGF5IGNhbGN1bGF0ZWQgYnkgdGltZSB0byBwcm9jZXNzIHBhY2tldCBoZWFkZXIgKi9cbiAgICBnZXQgcHJvY01pbGxpc2Vjb25kcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Byb2NNaWxsaXNlY29uZHNcbiAgICB9XG4gICAgLyoqIHtudW1iZXJ9IFJvdW5kIHRyaXAgdGltZSBjYWxjdWxhdGVkIHdpdGggUlRDUCByZXBvcnRzICovXG4gICAgZ2V0IHJ0dE1pbGxpc2Vjb25kcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3J0dE1pbGxpc2Vjb25kcztcbiAgICB9XG4gICAgLyoqIHtudW1iZXJ9IFN0YXRpc3RpY2FsIHZhcmlhbmNlIG9mIFJUUCBkYXRhIHBhY2tldCBpbnRlci1hcnJpdmFsIHRpbWUgKi9cbiAgICBnZXQgamJNaWxsaXNlY29uZHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9qYk1pbGxpc2Vjb25kcztcbiAgICB9XG4gICAgLyoqIHtudW1iZXJ9IG51bWJlciBvZiBieXRlcyBzZW50IHRvIHRoZSBjaGFubmVsKi9cbiAgICBnZXQgYnl0ZXNTZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnl0ZXNTZW50O1xuICAgIH1cbiAgICAvKioge251bWJlcn0gbnVtYmVyIG9mIGJ5dGVzIHJlY2VpdmVkIGZyb20gdGhlIGNoYW5uZWwqL1xuICAgIGdldCBieXRlc1JlY2VpdmVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnl0ZXNSZWNlaXZlZDtcbiAgICB9XG4gICAgLyoqIHtudW1iZXJ9IG51bWJlciBvZiB2aWRlbyBmcmFtZXMgZW5jb2RlZCovXG4gICAgZ2V0IGZyYW1lc0VuY29kZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mcmFtZXNFbmNvZGVkO1xuICAgIH1cbiAgICAvKioge251bWJlcn0gbnVtYmVyIG9mIHZpZGVvIGZyYW1lcyBkZWNvZGVkKi9cbiAgICBnZXQgZnJhbWVzRGVjb2RlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZyYW1lc0RlY29kZWQ7XG4gICAgfVxuICAgIC8qKiB7bnVtYmVyfSBmcmFtZXMgcGVyIHNlY29uZCBzZW50IHRvIHRoZSBjaGFubmVsKi9cbiAgICBnZXQgZnJhbWVSYXRlU2VudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZyYW1lUmF0ZVNlbnQ7XG4gICAgfVxuICAgIC8qKiB7bnVtYmVyfSBmcmFtZXMgcGVyIHNlY29uZCByZWNlaXZlZCBmcm9tIHRoZSBjaGFubmVsKi9cbiAgICBnZXQgZnJhbWVSYXRlUmVjZWl2ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mcmFtZVJhdGVSZWNlaXZlZDtcbiAgICB9XG4gICAgLyoqIHtzdHJpbmd9IHRoZSB0eXBlIG9mIHRoZSBzdGF0cyByZXBvcnQgKi9cbiAgICBnZXQgc3RhdHNSZXBvcnRUeXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3RhdHNSZXBvcnRUeXBlO1xuICAgIH1cbiAgICAvKioge3N0cmluZ30gdGhlIHR5cGUgb2YgdGhlIHN0cmVhbSAqL1xuICAgIGdldCBzdHJlYW1UeXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3RyZWFtVHlwZTtcbiAgICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiAqL1xuXG5leHBvcnQgY2xhc3MgU2Vzc2lvblJlcG9ydCB7XG4gICAgLyoqXG4gICAgICogQGNsYXNzIFByb3RvdHlwZSBmb3IgdHJhY2tpbmcgdmFyaW91cyBSVEMgc2Vzc2lvbiByZXBvcnRcbiAgICAgKiBAY29uc3RydWN0c1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLl9zZXNzaW9uU3RhcnRUaW1lID0gbnVsbDtcbiAgICAgICAgdGhpcy5fc2Vzc2lvbkVuZFRpbWUgPSBudWxsO1xuICAgICAgICB0aGlzLl9ndW1UaW1lTWlsbGlzID0gbnVsbDtcbiAgICAgICAgdGhpcy5faW5pdGlhbGl6YXRpb25UaW1lTWlsbGlzID0gbnVsbDtcbiAgICAgICAgdGhpcy5faWNlQ29sbGVjdGlvblRpbWVNaWxsaXMgPSBudWxsO1xuICAgICAgICB0aGlzLl9zaWduYWxsaW5nQ29ubmVjdFRpbWVNaWxsaXMgPSBudWxsO1xuICAgICAgICB0aGlzLl9oYW5kc2hha2luZ1RpbWVNaWxsaXMgPSBudWxsO1xuICAgICAgICB0aGlzLl9wcmVUYWxraW5nVGltZU1pbGxpcyA9IG51bGw7XG4gICAgICAgIHRoaXMuX3RhbGtpbmdUaW1lTWlsbGlzID0gbnVsbDtcbiAgICAgICAgdGhpcy5faWNlQ29ubmVjdGlvbnNMb3N0ID0gMDtcbiAgICAgICAgdGhpcy5faWNlQ29ubmVjdGlvbnNGYWlsZWQgPSBudWxsO1xuICAgICAgICB0aGlzLl9wZWVyQ29ubmVjdGlvbkZhaWxlZCA9IG51bGw7XG4gICAgICAgIHRoaXMuX2NsZWFudXBUaW1lTWlsbGlzID0gbnVsbDtcbiAgICAgICAgdGhpcy5faWNlQ29sbGVjdGlvbkZhaWx1cmUgPSBudWxsO1xuICAgICAgICB0aGlzLl9zaWduYWxsaW5nQ29ubmVjdGlvbkZhaWx1cmUgPSBudWxsO1xuICAgICAgICB0aGlzLl9oYW5kc2hha2luZ0ZhaWx1cmUgPSBudWxsO1xuICAgICAgICB0aGlzLl9ndW1PdGhlckZhaWx1cmUgPSBudWxsO1xuICAgICAgICB0aGlzLl9ndW1UaW1lb3V0RmFpbHVyZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2NyZWF0ZU9mZmVyRmFpbHVyZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3NldExvY2FsRGVzY3JpcHRpb25GYWlsdXJlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdXNlckJ1c3lGYWlsdXJlID0gbnVsbDtcbiAgICAgICAgdGhpcy5faW52YWxpZFJlbW90ZVNEUEZhaWx1cmUgPSBudWxsO1xuICAgICAgICB0aGlzLl9ub1JlbW90ZUljZUNhbmRpZGF0ZUZhaWx1cmUgPSBudWxsO1xuICAgICAgICB0aGlzLl9zZXRSZW1vdGVEZXNjcmlwdGlvbkZhaWx1cmUgPSBudWxsO1xuICAgICAgICB0aGlzLl9zdHJlYW1TdGF0cyA9IFtdO1xuICAgICAgICB0aGlzLl9ydGNKc1ZlcnNpb24gPSBcIkBAUlRDX0pTX1ZFUlNJT05cIlxuICAgIH1cbiAgICAvKipcbiAgICAgKlRpbWVzdGFtcCB3aGVuIFJUQ1Nlc3Npb24gc3RhcnRlZC5cbiAgICAgKi9cbiAgICBnZXQgc2Vzc2lvblN0YXJ0VGltZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Nlc3Npb25TdGFydFRpbWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRpbWVzdGFtcCB3aGVuIFJUQ1Nlc3Npb24gZW5kZWQuXG4gICAgICovXG4gICAgZ2V0IHNlc3Npb25FbmRUaW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2Vzc2lvbkVuZFRpbWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRpbWUgdGFrZW4gZm9yIGdyYWJiaW5nIHVzZXIgbWljcm9waG9uZSBhdCB0aGUgdGltZSBvZiBjb25uZWN0aW5nIFJUQ1Nlc3Npb24uXG4gICAgICovXG4gICAgZ2V0IGd1bVRpbWVNaWxsaXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ndW1UaW1lTWlsbGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaW1lIHRha2VuIGZvciBzZXNzaW9uIGluaXRpYWxpemF0aW9uIGluIG1pbGxpcy4gSW5jbHVkZXMgdGltZSBzcGVudCBpbiBHcmFiTG9jYWxNZWRpYSwgU2V0TG9jYWxTRFAgc3RhdGVzLlxuICAgICAqL1xuICAgIGdldCBpbml0aWFsaXphdGlvblRpbWVNaWxsaXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbml0aWFsaXphdGlvblRpbWVNaWxsaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRpbWUgc3BlbnQgb24gSUNFQ29sbGVjdGlvbiBpbiBtaWxsaXMuXG4gICAgICovXG4gICAgZ2V0IGljZUNvbGxlY3Rpb25UaW1lTWlsbGlzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faWNlQ29sbGVjdGlvblRpbWVNaWxsaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRpbWUgdGFrZW4gZm9yIGNvbm5lY3RpbmcgdGhlIHNpZ25hbGxpbmcgaW4gbWlsbGlzLlxuICAgICAqL1xuICAgIGdldCBzaWduYWxsaW5nQ29ubmVjdFRpbWVNaWxsaXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zaWduYWxsaW5nQ29ubmVjdFRpbWVNaWxsaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRpbWVzIHNwZW50IGZyb20gUlRDU2Vzc2lvbiBjb25uZWN0aW9uIHVudGlsIGVudGVyaW5nIFRhbGtpbmcgc3RhdGUgaW4gbWlsbGlzLlxuICAgICAqL1xuICAgIGdldCBwcmVUYWxraW5nVGltZU1pbGxpcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ByZVRhbGtpbmdUaW1lTWlsbGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiAgVGltZXMgc3BlbnQgaW4gY29tcGxldGluZyBoYW5kc2hha2luZyBwcm9jZXNzIG9mIHRoZSBSVENTZXNzaW9uIGluIG1pbGxpcy5cbiAgICAgKi9cbiAgICBnZXQgaGFuZHNoYWtpbmdUaW1lTWlsbGlzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faGFuZHNoYWtpbmdUaW1lTWlsbGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiAgVGltZXMgc3BlbnQgaW4gVGFsa2luZyBzdGF0ZSBpbiBtaWxsaXMuXG4gICAgICovXG4gICAgZ2V0IHRhbGtpbmdUaW1lTWlsbGlzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGFsa2luZ1RpbWVNaWxsaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEhvdyBtYW55IHRpbWVzIHRoZSBSVENTZXNzaW9uIGhhcyBsb3N0IElDRSBjb25uZWN0aW9uIGluIHRhbGtpbmcgc3RhdGUuXG4gICAgICovXG4gICAgZ2V0IGljZUNvbm5lY3Rpb25zTG9zdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ljZUNvbm5lY3Rpb25zTG9zdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGVsbHMgaWYgdGhlIFJUQ1Nlc3Npb24gaGFzIGZhaWxlZCBSVENQZWVyQ29ubmVjdGlvbi5pY2VDb25uZWN0aW9uU3RhdGVcbiAgICAgKi9cbiAgICBnZXQgaWNlQ29ubmVjdGlvbnNGYWlsZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pY2VDb25uZWN0aW9uc0ZhaWxlZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGVsbHMgaWYgdGhlIFJUQ1Nlc3Npb24gaGFzIGZhaWxlZCBSVENQZWVyQ29ubmVjdGlvbi5jb25uZWN0aW9uU3RhdGVcbiAgICAgKi9cbiAgICBnZXQgcGVlckNvbm5lY3Rpb25GYWlsZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wZWVyQ29ubmVjdGlvbkZhaWxlZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGltZXMgc3BlbnQgaW4gQ2xlYW51cCBzdGF0ZSBpbiBtaWxsaXNcbiAgICAgKi9cbiAgICBnZXQgY2xlYW51cFRpbWVNaWxsaXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jbGVhbnVwVGltZU1pbGxpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGVsbHMgaWYgdGhlIFJUQ1Nlc3Npb24gZmFpbHMgaW4gSUNFQ29sbGVjdGlvbi5cbiAgICAgKi9cbiAgICBnZXQgaWNlQ29sbGVjdGlvbkZhaWx1cmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pY2VDb2xsZWN0aW9uRmFpbHVyZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGVsbHMgaWYgdGhlIFJUQ1Nlc3Npb24gZmFpbGVkIGluIHNpZ25hbGxpbmcgY29ubmVjdCBzdGFnZS5cbiAgICAgKi9cbiAgICBnZXQgc2lnbmFsbGluZ0Nvbm5lY3Rpb25GYWlsdXJlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2lnbmFsbGluZ0Nvbm5lY3Rpb25GYWlsdXJlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIYW5kc2hha2luZyBmYWlsdXJlIG9mIHRoZSBSVENTZXNzaW9uXG4gICAgICovXG4gICAgZ2V0IGhhbmRzaGFraW5nRmFpbHVyZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hhbmRzaGFraW5nRmFpbHVyZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR3VtIGZhaWxlZCBkdWUgdG8gdGltZW91dCBhdCB0aGUgdGltZSBvZiBuZXcgUlRDU2Vzc2lvbiBjb25uZWN0aW9uXG4gICAgICovXG4gICAgZ2V0IGd1bVRpbWVvdXRGYWlsdXJlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ3VtVGltZW91dEZhaWx1cmU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEd1bSBmYWlsZWQgZHVlIHRvIG90aGVyIHJlYXNvbnMgKG90aGVyIHRoYW4gVGltZW91dClcbiAgICAgKi9cbiAgICBnZXQgZ3VtT3RoZXJGYWlsdXJlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ3VtT3RoZXJGYWlsdXJlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSVEMgU2Vzc2lvbiBmYWlsZWQgaW4gY3JlYXRlIE9mZmVyIHN0YXRlLlxuICAgICAqL1xuICAgIGdldCBjcmVhdGVPZmZlckZhaWx1cmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVPZmZlckZhaWx1cmU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRlbGxzIGlmIHNldExvY2FsRGVzY3JpcHRpb24gZmFpbGVkIGZvciB0aGUgUlRDIFNlc3Npb24uXG4gICAgICovXG4gICAgZ2V0IHNldExvY2FsRGVzY3JpcHRpb25GYWlsdXJlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2V0TG9jYWxEZXNjcmlwdGlvbkZhaWx1cmU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRlbGxzIGlmIGhhbmRzaGFraW5nIGZhaWxlZCBkdWUgdG8gdXNlciBidXN5IGNhc2UsXG4gICAgICogaGFwcGVucyB3aGVuIG11bHRpcGxlIHNvZnRwaG9uZSBjYWxscyBhcmUgaW5pdGlhdGVkIGF0IHNhbWUgdGltZS5cbiAgICAgKi9cbiAgICBnZXQgdXNlckJ1c3lGYWlsdXJlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdXNlckJ1c3lGYWlsdXJlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUZWxscyBpdCByZW1vdGUgU0RQIGlzIGludmFsaWQuXG4gICAgICovXG4gICAgZ2V0IGludmFsaWRSZW1vdGVTRFBGYWlsdXJlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faW52YWxpZFJlbW90ZVNEUEZhaWx1cmU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRlbGxzIGlmIHRoZSBzZXRSZW1vdGVEZXNjcmlwdGlvbiBmYWlsZWQgZm9yIHRoZSBSVEMgU2Vzc2lvbi5cbiAgICAgKi9cbiAgICBnZXQgc2V0UmVtb3RlRGVzY3JpcHRpb25GYWlsdXJlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2V0UmVtb3RlRGVzY3JpcHRpb25GYWlsdXJlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIGZhaWx1cmUgY2FzZSB3aGVuIHRoZXJlIGlzIG5vIFJlbW90ZUljZUNhbmRpZGF0ZS5cbiAgICAgKi9cbiAgICBnZXQgbm9SZW1vdGVJY2VDYW5kaWRhdGVGYWlsdXJlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbm9SZW1vdGVJY2VDYW5kaWRhdGVGYWlsdXJlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGF0aXN0aWNzIGZvciBlYWNoIHN0cmVhbShhdWRpby1pbiwgYXVkaW8tb3V0LCB2aWRlby1pbiwgdmlkZW8tb3V0KSBvZiB0aGUgUlRDU2Vzc2lvbi5cbiAgICAgKi9cbiAgICBnZXQgc3RyZWFtU3RhdHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdHJlYW1TdGF0cztcbiAgICB9XG4gICAgLyoqXG4gICAgICogZ2V0IGN1cnJlbnQgY29ubmVjdC1ydGMtanMgdmVyc2lvblxuICAgICAqL1xuICAgIGdldCBydGNKc1ZlcnNpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ydGNKc1ZlcnNpb247XG4gICAgfVxuXG4gICAgc2V0IHNlc3Npb25TdGFydFRpbWUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fc2Vzc2lvblN0YXJ0VGltZSA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgc2Vzc2lvbkVuZFRpbWUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fc2Vzc2lvbkVuZFRpbWUgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IGd1bVRpbWVNaWxsaXModmFsdWUpIHtcbiAgICAgICAgdGhpcy5fZ3VtVGltZU1pbGxpcyA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgaW5pdGlhbGl6YXRpb25UaW1lTWlsbGlzKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2luaXRpYWxpemF0aW9uVGltZU1pbGxpcyA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgaWNlQ29sbGVjdGlvblRpbWVNaWxsaXModmFsdWUpIHtcbiAgICAgICAgdGhpcy5faWNlQ29sbGVjdGlvblRpbWVNaWxsaXMgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IHNpZ25hbGxpbmdDb25uZWN0VGltZU1pbGxpcyh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zaWduYWxsaW5nQ29ubmVjdFRpbWVNaWxsaXMgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IHByZVRhbGtpbmdUaW1lTWlsbGlzKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3ByZVRhbGtpbmdUaW1lTWlsbGlzID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBoYW5kc2hha2luZ1RpbWVNaWxsaXModmFsdWUpIHtcbiAgICAgICAgdGhpcy5faGFuZHNoYWtpbmdUaW1lTWlsbGlzID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCB0YWxraW5nVGltZU1pbGxpcyh2YWx1ZSkge1xuICAgICAgICB0aGlzLl90YWxraW5nVGltZU1pbGxpcyA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgaWNlQ29ubmVjdGlvbnNMb3N0KHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2ljZUNvbm5lY3Rpb25zTG9zdCA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgaWNlQ29ubmVjdGlvbnNGYWlsZWQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5faWNlQ29ubmVjdGlvbnNGYWlsZWQgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IHBlZXJDb25uZWN0aW9uRmFpbGVkKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3BlZXJDb25uZWN0aW9uRmFpbGVkID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBjbGVhbnVwVGltZU1pbGxpcyh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9jbGVhbnVwVGltZU1pbGxpcyA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgaWNlQ29sbGVjdGlvbkZhaWx1cmUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5faWNlQ29sbGVjdGlvbkZhaWx1cmUgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IHNpZ25hbGxpbmdDb25uZWN0aW9uRmFpbHVyZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zaWduYWxsaW5nQ29ubmVjdGlvbkZhaWx1cmUgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IGhhbmRzaGFraW5nRmFpbHVyZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9oYW5kc2hha2luZ0ZhaWx1cmUgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IGd1bVRpbWVvdXRGYWlsdXJlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2d1bVRpbWVvdXRGYWlsdXJlID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBndW1PdGhlckZhaWx1cmUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fZ3VtT3RoZXJGYWlsdXJlID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBjcmVhdGVPZmZlckZhaWx1cmUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fY3JlYXRlT2ZmZXJGYWlsdXJlID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBzZXRMb2NhbERlc2NyaXB0aW9uRmFpbHVyZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zZXRMb2NhbERlc2NyaXB0aW9uRmFpbHVyZSA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgdXNlckJ1c3lGYWlsdXJlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3VzZXJCdXN5RmFpbHVyZSA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgaW52YWxpZFJlbW90ZVNEUEZhaWx1cmUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5faW52YWxpZFJlbW90ZVNEUEZhaWx1cmUgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IG5vUmVtb3RlSWNlQ2FuZGlkYXRlRmFpbHVyZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9ub1JlbW90ZUljZUNhbmRpZGF0ZUZhaWx1cmUgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IHNldFJlbW90ZURlc2NyaXB0aW9uRmFpbHVyZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zZXRSZW1vdGVEZXNjcmlwdGlvbkZhaWx1cmUgPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IHN0cmVhbVN0YXRzKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3N0cmVhbVN0YXRzID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBydGNKc1ZlcnNpb24odmFsdWUpIHtcbiAgICAgICAgdGhpcy5fcnRjSnNWZXJzaW9uID0gdmFsdWU7XG4gICAgfVxufVxuIiwiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNyBBbWF6b24uY29tLCBJbmMuIG9yIGl0cyBhZmZpbGlhdGVzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICpcbiAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4gKi9cblxuaW1wb3J0IHsgZ2V0UmVkYWN0ZWRTZHAsIGhpdGNoLCB3cmFwTG9nZ2VyfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IE1BWF9JTlZJVEVfREVMQVlfTVMsIE1BWF9BQ0NFUFRfQllFX0RFTEFZX01TLCBERUZBVUxUX0NPTk5FQ1RfVElNRU9VVF9NUywgSU5WSVRFX01FVEhPRF9OQU1FLCBBQ0NFUFRfTUVUSE9EX05BTUUsIEJZRV9NRVRIT0RfTkFNRSB9IGZyb20gJy4vcnRjX2NvbnN0JztcbmltcG9ydCB7IFVuc3VwcG9ydGVkT3BlcmF0aW9uLCBUaW1lb3V0LCBCdXN5RXhjZXB0aW9uLCBDYWxsTm90Rm91bmRFeGNlcHRpb24sIFVua25vd25TaWduYWxpbmdFcnJvciB9IGZyb20gJy4vZXhjZXB0aW9ucyc7XG5pbXBvcnQgdXVpZCBmcm9tICd1dWlkL3Y0JztcbmltcG9ydCBWaXJ0dWFsV3NzQ29ubmVjdGlvbk1hbmFnZXIgZnJvbSBcIi4vdmlydHVhbF93c3NfY29ubmVjdGlvbl9tYW5hZ2VyXCI7XG5cbnZhciBDT05ORUNUX01BWF9SRVRSSUVTID0gMztcblxuLyoqXG4gKiBBYnN0cmFjdCBzaWduYWxpbmcgc3RhdGUgY2xhc3MuXG4gKi9cbmV4cG9ydCBjbGFzcyBTaWduYWxpbmdTdGF0ZSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtBbXpuUnRjU2lnbmFsaW5nfSBzaWduYWxpbmcgU2lnbmFsaW5nIG9iamVjdC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzaWduYWxpbmcpIHtcbiAgICAgICAgdGhpcy5fc2lnbmFsaW5nID0gc2lnbmFsaW5nO1xuICAgICAgICB0aGlzLl9jcmVhdGVUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgfVxuICAgIHNldFN0YXRlVGltZW91dCh0aW1lb3V0TXMpIHtcbiAgICAgICAgc2V0VGltZW91dChoaXRjaCh0aGlzLCB0aGlzLl9vblRpbWVvdXRDaGVja2VkKSwgdGltZW91dE1zKTtcbiAgICB9XG4gICAgZ2V0IGlzQ3VycmVudFN0YXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcyA9PT0gdGhpcy5fc2lnbmFsaW5nLnN0YXRlO1xuICAgIH1cbiAgICBvbkVudGVyKCkge31cbiAgICBfb25UaW1lb3V0Q2hlY2tlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNDdXJyZW50U3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMub25UaW1lb3V0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25UaW1lb3V0KCkge1xuICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb24oKTtcbiAgICB9XG4gICAgdHJhbnNpdChuZXdTdGF0ZSkge1xuICAgICAgICB0aGlzLl9zaWduYWxpbmcudHJhbnNpdChuZXdTdGF0ZSk7XG4gICAgfVxuICAgIG9uRXhpdCgpIHt9XG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb24oJ29uT3BlbiBub3Qgc3VwcG9ydGVkIGJ5ICcgKyB0aGlzLm5hbWUpO1xuICAgIH1cbiAgICBvbkVycm9yKCkge1xuICAgICAgICB0aGlzLmNoYW5uZWxEb3duKCk7XG4gICAgfVxuICAgIG9uQ2xvc2UoKSB7XG4gICAgICAgIHRoaXMuY2hhbm5lbERvd24oKTtcbiAgICB9XG4gICAgY2hhbm5lbERvd24oKSB7XG4gICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbignY2hhbm5lbERvd24gbm90IHN1cHBvcnRlZCBieSAnICsgdGhpcy5uYW1lKTtcbiAgICB9XG4gICAgb25ScGNNc2cocnBjTXNnKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uKCdvblJwY01zZyBub3Qgc3VwcG9ydGVkIGJ5ICcgKyB0aGlzLm5hbWUpO1xuICAgIH1cbiAgICBpbnZpdGUoc2RwLCBpY2VDYW5kaWRhdGVzKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uKCdpbnZpdGUgbm90IHN1cHBvcnRlZCBieSAnICsgdGhpcy5uYW1lKTtcbiAgICB9XG4gICAgYWNjZXB0KCkge1xuICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb24oJ2FjY2VwdCBub3Qgc3VwcG9ydGVkIGJ5ICcgKyB0aGlzLm5hbWUpO1xuICAgIH1cbiAgICBoYW5ndXAoKSB7XG4gICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbignaGFuZ3VwIG5vdCBzdXBwb3J0ZWQgYnkgJyArIHRoaXMubmFtZSk7XG4gICAgfVxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJTaWduYWxpbmdTdGF0ZVwiO1xuICAgIH1cbiAgICBnZXQgbG9nZ2VyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2lnbmFsaW5nLl9sb2dnZXI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEZhaWxPblRpbWVvdXRTdGF0ZSBleHRlbmRzIFNpZ25hbGluZ1N0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcihzaWduYWxpbmcsIHRpbWVvdXRNcykge1xuICAgICAgICBzdXBlcihzaWduYWxpbmcpO1xuICAgICAgICB0aGlzLl90aW1lb3V0TXMgPSB0aW1lb3V0TXM7XG4gICAgfVxuICAgIG9uRW50ZXIoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGVUaW1lb3V0KHRoaXMuX3RpbWVvdXRNcyk7XG4gICAgfVxuICAgIG9uVGltZW91dCgpIHtcbiAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBGYWlsZWRTdGF0ZSh0aGlzLl9zaWduYWxpbmcsIG5ldyBUaW1lb3V0KCkpKTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIkZhaWxPblRpbWVvdXRTdGF0ZVwiO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBQZW5kaW5nQ29ubmVjdFN0YXRlIGV4dGVuZHMgRmFpbE9uVGltZW91dFN0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcihzaWduYWxpbmcsIHRpbWVvdXRNcywgaW5pdGlhbFN0YXJ0VGltZUluLCByZXRyaWVzSW4pIHtcbiAgICAgICAgc3VwZXIoc2lnbmFsaW5nLCB0aW1lb3V0TXMpO1xuICAgICAgICB0aGlzLl9pbml0aWFsU3RhcnRUaW1lID0gaW5pdGlhbFN0YXJ0VGltZUluIHx8IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgICAgICB0aGlzLl9yZXRyaWVzID0gcmV0cmllc0luIHx8IDA7XG4gICAgfVxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBQZW5kaW5nSW52aXRlU3RhdGUodGhpcy5fc2lnbmFsaW5nKSk7XG4gICAgfVxuICAgIGNoYW5uZWxEb3duKCkge1xuICAgICAgICB2YXIgbm93ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgIHZhciB1bnRpbFRpbWVvdXRNcyA9ICh0aGlzLl9pbml0aWFsU3RhcnRUaW1lICsgdGhpcy5fdGltZW91dE1zKSAtIG5vdztcbiAgICAgICAgaWYgKHVudGlsVGltZW91dE1zID4gMCAmJiArK3RoaXMuX3JldHJpZXMgPCBDT05ORUNUX01BWF9SRVRSSUVTKSB7XG4gICAgICAgICAgICB0aGlzLl9zaWduYWxpbmcuX2Nvbm5lY3QoKTtcbiAgICAgICAgICAgIHRoaXMudHJhbnNpdChuZXcgUGVuZGluZ0Nvbm5lY3RTdGF0ZSh0aGlzLl9zaWduYWxpbmcsIHVudGlsVGltZW91dE1zLCB0aGlzLl9pbml0aWFsU3RhcnRUaW1lLCB0aGlzLl9yZXRyaWVzKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRyYW5zaXQobmV3IEZhaWxlZFN0YXRlKHRoaXMuX3NpZ25hbGluZywgbmV3IEVycm9yKCdjaGFubmVsRG93bicpKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIlBlbmRpbmdDb25uZWN0U3RhdGVcIjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgUGVuZGluZ0ludml0ZVN0YXRlIGV4dGVuZHMgU2lnbmFsaW5nU3RhdGUge1xuICAgIG9uRW50ZXIoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gbm90aWZ5Q29ubmVjdGVkKHJlc29sdmUpIHtcbiAgICAgICAgICAgIHNlbGYuX3NpZ25hbGluZy5fY29ubmVjdGVkSGFuZGxlcigpO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgaW52aXRlKHNkcCwgaWNlQ2FuZGlkYXRlcykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBpbnZpdGVJZCA9IHV1aWQoKTtcblxuICAgICAgICB2YXIgaW52aXRlUGFyYW1zID0ge1xuICAgICAgICAgICAgc2RwOiBzZHAsXG4gICAgICAgICAgICBjYW5kaWRhdGVzOiBpY2VDYW5kaWRhdGVzLFxuICAgICAgICAgICAgY2FsbENvbnRleHRUb2tlbiA6IHNlbGYuX3NpZ25hbGluZy5fY29udGFjdFRva2VuXG4gICAgICAgIH07XG4gICAgICAgIHNlbGYubG9nZ2VyLmxvZygnU2VuZGluZyBTRFAnLCBnZXRSZWRhY3RlZFNkcChzZHApKTtcbiAgICAgICAgc2VsZi5fc2lnbmFsaW5nLl93c3Muc2VuZChKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBqc29ucnBjOiAnMi4wJyxcbiAgICAgICAgICAgIG1ldGhvZDogSU5WSVRFX01FVEhPRF9OQU1FLFxuICAgICAgICAgICAgcGFyYW1zOiBpbnZpdGVQYXJhbXMsXG4gICAgICAgICAgICBpZDogaW52aXRlSWRcbiAgICAgICAgfSkpO1xuICAgICAgICBzZWxmLnRyYW5zaXQobmV3IFBlbmRpbmdBbnN3ZXJTdGF0ZShzZWxmLl9zaWduYWxpbmcsIGludml0ZUlkKSk7XG4gICAgfVxuICAgIGNoYW5uZWxEb3duKCkge1xuICAgICAgICB0aGlzLnRyYW5zaXQobmV3IEZhaWxlZFN0YXRlKHRoaXMuX3NpZ25hbGluZykpO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiUGVuZGluZ0ludml0ZVN0YXRlXCI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFBlbmRpbmdBbnN3ZXJTdGF0ZSBleHRlbmRzIEZhaWxPblRpbWVvdXRTdGF0ZSB7XG4gICAgY29uc3RydWN0b3Ioc2lnbmFsaW5nLCBpbnZpdGVJZCkge1xuICAgICAgICBzdXBlcihzaWduYWxpbmcsIE1BWF9JTlZJVEVfREVMQVlfTVMpO1xuICAgICAgICB0aGlzLl9pbnZpdGVJZCA9IGludml0ZUlkO1xuICAgIH1cbiAgICBvblJwY01zZyhtc2cpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBpZiAobXNnLmlkID09PSB0aGlzLl9pbnZpdGVJZCkge1xuICAgICAgICAgICAgaWYgKG1zZy5lcnJvciB8fCAhbXNnLnJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHRoaXMudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUodGhpcy5fc2lnbmFsaW5nLCBzZWxmLnRyYW5zbGF0ZUludml0ZUVycm9yKG1zZykpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gbm90aWZ5QW5zd2VyZWQocmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ2dlci5sb2coJ1JlY2VpdmVkIFNEUCcsIGdldFJlZGFjdGVkU2RwKG1zZy5yZXN1bHQuc2RwKSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3NpZ25hbGluZy5fYW5zd2VyZWRIYW5kbGVyKG1zZy5yZXN1bHQuc2RwLCBtc2cucmVzdWx0LmNhbmRpZGF0ZXMpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBQZW5kaW5nQWNjZXB0U3RhdGUodGhpcy5fc2lnbmFsaW5nLCB0aGlzLl9zaWduYWxpbmcuX2F1dG9BbnN3ZXIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB0cmFuc2xhdGVJbnZpdGVFcnJvcihtc2cpIHtcbiAgICAgICAgaWYgKG1zZy5lcnJvciAmJiBtc2cuZXJyb3IuY29kZSA9PSA0ODYpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQnVzeUV4Y2VwdGlvbihtc2cuZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIH0gZWxzZSBpZiAobXNnLmVycm9yICYmIG1zZy5lcnJvci5jb2RlID09IDQwNCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBDYWxsTm90Rm91bmRFeGNlcHRpb24obXNnLmVycm9yLm1lc3NhZ2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBVbmtub3duU2lnbmFsaW5nRXJyb3IoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJQZW5kaW5nQW5zd2VyU3RhdGVcIjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgUGVuZGluZ0FjY2VwdFN0YXRlIGV4dGVuZHMgU2lnbmFsaW5nU3RhdGUge1xuICAgIGNvbnN0cnVjdG9yKHNpZ25hbGluZywgYXV0b0Fuc3dlcikge1xuICAgICAgICBzdXBlcihzaWduYWxpbmcpO1xuICAgICAgICB0aGlzLl9hdXRvQW5zd2VyID0gYXV0b0Fuc3dlcjtcbiAgICB9XG4gICAgb25FbnRlcigpIHtcbiAgICAgICAgaWYgKHRoaXMuX2F1dG9BbnN3ZXIpIHtcbiAgICAgICAgICAgIHRoaXMuYWNjZXB0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWNjZXB0KCkge1xuICAgICAgICB0aGlzLnNlbmRBY2NlcHRSZXF1ZXN0KCk7XG4gICAgICAgIHRoaXMudHJhbnNpdChuZXcgVGFsa2luZ1N0YXRlKHRoaXMuX3NpZ25hbGluZykpO1xuICAgIH1cbiAgICBjaGFubmVsRG93bigpIHtcbiAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBGYWlsZWRTdGF0ZSh0aGlzLl9zaWduYWxpbmcpKTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIlBlbmRpbmdBY2NlcHRTdGF0ZVwiO1xuICAgIH1cbiAgICBhc3luYyBzZW5kQWNjZXB0UmVxdWVzdCgpIHtcbiAgICAgICAgdmFyIGFjY2VwdElkID0gdXVpZCgpO1xuICAgICAgICB0aGlzLl9zaWduYWxpbmcuX3dzcy5zZW5kKEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICAgICAgbWV0aG9kOiBBQ0NFUFRfTUVUSE9EX05BTUUsXG4gICAgICAgICAgICBwYXJhbXM6IHt9LFxuICAgICAgICAgICAgaWQ6IGFjY2VwdElkXG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgUGVuZGluZ0FjY2VwdEFja1N0YXRlIGV4dGVuZHMgRmFpbE9uVGltZW91dFN0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcihzaWduYWxpbmcsIGFjY2VwdElkKSB7XG4gICAgICAgIHN1cGVyKHNpZ25hbGluZywgTUFYX0FDQ0VQVF9CWUVfREVMQVlfTVMpO1xuICAgICAgICB0aGlzLl9hY2NlcHRJZCA9IGFjY2VwdElkO1xuICAgIH1cbiAgICBvblJwY01zZyhtc2cpIHtcbiAgICAgICAgaWYgKG1zZy5pZCA9PT0gdGhpcy5fYWNjZXB0SWQpIHtcbiAgICAgICAgICAgIGlmIChtc2cuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zaXQobmV3IEZhaWxlZFN0YXRlKHRoaXMuX3NpZ25hbGluZykpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zaWduYWxpbmcuX2NsaWVudFRva2VuID0gbXNnLnJlc3VsdC5jbGllbnRUb2tlbjtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zaXQobmV3IFRhbGtpbmdTdGF0ZSh0aGlzLl9zaWduYWxpbmcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiUGVuZGluZ0FjY2VwdEFja1N0YXRlXCI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFRhbGtpbmdTdGF0ZSBleHRlbmRzIFNpZ25hbGluZ1N0YXRlIHtcbiAgICBvbkVudGVyKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIG5vdGlmeUhhbmRzaGFrZWQocmVzb2x2ZSkge1xuICAgICAgICAgICAgc2VsZi5fc2lnbmFsaW5nLl9oYW5kc2hha2VkSGFuZGxlcigpO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgaGFuZ3VwKCkge1xuICAgICAgICB2YXIgYnllSWQgPSB1dWlkKCk7XG4gICAgICAgIHRoaXMuX3NpZ25hbGluZy5fd3NzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgICAgICBtZXRob2Q6IEJZRV9NRVRIT0RfTkFNRSxcbiAgICAgICAgICAgIHBhcmFtczoge2NhbGxDb250ZXh0VG9rZW46IHRoaXMuX3NpZ25hbGluZy5fY29udGFjdFRva2VufSxcbiAgICAgICAgICAgIGlkOiBieWVJZFxuICAgICAgICB9KSk7XG4gICAgICAgIHRoaXMudHJhbnNpdChuZXcgUGVuZGluZ1JlbW90ZUhhbmd1cFN0YXRlKHRoaXMuX3NpZ25hbGluZywgYnllSWQpKTtcbiAgICB9XG4gICAgb25ScGNNc2cobXNnKSB7XG4gICAgICAgIGlmIChtc2cubWV0aG9kID09PSBCWUVfTUVUSE9EX05BTUUpIHtcbiAgICAgICAgICAgIHRoaXMudHJhbnNpdChuZXcgUGVuZGluZ0xvY2FsSGFuZ3VwU3RhdGUodGhpcy5fc2lnbmFsaW5nLCBtc2cuaWQpKTtcbiAgICAgICAgfSBlbHNlIGlmIChtc2cubWV0aG9kID09PSAncmVuZXdDbGllbnRUb2tlbicpIHtcbiAgICAgICAgICAgIHRoaXMuX3NpZ25hbGluZy5fY2xpZW50VG9rZW4gPSBtc2cucGFyYW1zLmNsaWVudFRva2VuO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNoYW5uZWxEb3duKCkge1xuICAgICAgICB0aGlzLl9zaWduYWxpbmcuX3JlY29ubmVjdCgpO1xuICAgICAgICB0aGlzLl9zaWduYWxpbmcudHJhbnNpdChuZXcgUGVuZGluZ1JlY29ubmVjdFN0YXRlKHRoaXMuX3NpZ25hbGluZykpO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiVGFsa2luZ1N0YXRlXCI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFBlbmRpbmdSZWNvbm5lY3RTdGF0ZSBleHRlbmRzIEZhaWxPblRpbWVvdXRTdGF0ZSB7XG4gICAgY29uc3RydWN0b3Ioc2lnbmFsaW5nKSB7XG4gICAgICAgIHN1cGVyKHNpZ25hbGluZywgREVGQVVMVF9DT05ORUNUX1RJTUVPVVRfTVMpO1xuICAgIH1cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHRoaXMudHJhbnNpdChuZXcgVGFsa2luZ1N0YXRlKHRoaXMuX3NpZ25hbGluZykpO1xuICAgIH1cbiAgICBjaGFubmVsRG93bigpIHtcbiAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBGYWlsZWRTdGF0ZSh0aGlzLl9zaWduYWxpbmcpKTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIlBlbmRpbmdSZWNvbm5lY3RTdGF0ZVwiO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBQZW5kaW5nUmVtb3RlSGFuZ3VwU3RhdGUgZXh0ZW5kcyBGYWlsT25UaW1lb3V0U3RhdGUge1xuICAgIGNvbnN0cnVjdG9yKHNpZ25hbGluZywgYnllSWQpIHtcbiAgICAgICAgc3VwZXIoc2lnbmFsaW5nLCBNQVhfQUNDRVBUX0JZRV9ERUxBWV9NUyk7XG4gICAgICAgIHRoaXMuX2J5ZUlkID0gYnllSWQ7XG4gICAgfVxuICAgIG9uUnBjTXNnKG1zZykge1xuICAgICAgICBpZiAobXNnLmlkID09PSB0aGlzLl9ieWVJZCB8fCBtc2cubWV0aG9kID09PSBCWUVfTUVUSE9EX05BTUUpIHtcbiAgICAgICAgICAgIHRoaXMudHJhbnNpdChuZXcgRGlzY29ubmVjdGVkU3RhdGUodGhpcy5fc2lnbmFsaW5nKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIlBlbmRpbmdSZW1vdGVIYW5ndXBTdGF0ZVwiO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBQZW5kaW5nTG9jYWxIYW5ndXBTdGF0ZSBleHRlbmRzIFNpZ25hbGluZ1N0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcihzaWduYWxpbmcsIGJ5ZUlkKSB7XG4gICAgICAgIHN1cGVyKHNpZ25hbGluZyk7XG4gICAgICAgIHRoaXMuX2J5ZUlkID0gYnllSWQ7XG4gICAgfVxuICAgIG9uRW50ZXIoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gbm90aWZ5UmVtb3RlSHVuZ3VwKHJlc29sdmUpIHtcbiAgICAgICAgICAgIHNlbGYuX3NpZ25hbGluZy5fcmVtb3RlSHVuZ3VwSGFuZGxlcigpO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgaGFuZ3VwKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHNlbGYuX3NpZ25hbGluZy5fd3NzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgICAgICByZXN1bHQ6IHt9LFxuICAgICAgICAgICAgaWQ6IHNlbGYuX2J5ZUlkXG4gICAgICAgIH0pKTtcbiAgICAgICAgc2VsZi50cmFuc2l0KG5ldyBEaXNjb25uZWN0ZWRTdGF0ZShzZWxmLl9zaWduYWxpbmcpKTtcbiAgICB9XG4gICAgb25ScGNNc2coKSB7XG4gICAgICAgIC8vRG8gbm90aGluZ1xuICAgIH1cbiAgICBjaGFubmVsRG93bigpIHtcbiAgICAgICAgdGhpcy50cmFuc2l0KG5ldyBEaXNjb25uZWN0ZWRTdGF0ZSh0aGlzLl9zaWduYWxpbmcpKTtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiBcIlBlbmRpbmdMb2NhbEhhbmd1cFN0YXRlXCI7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIERpc2Nvbm5lY3RlZFN0YXRlIGV4dGVuZHMgU2lnbmFsaW5nU3RhdGUge1xuICAgIG9uRW50ZXIoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gbm90aWZ5RGlzY29ubmVjdGVkKHJlc29sdmUpIHtcbiAgICAgICAgICAgIHNlbGYuX3NpZ25hbGluZy5fZGlzY29ubmVjdGVkSGFuZGxlcigpO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fc2lnbmFsaW5nLl93c3MuY2xvc2UoKTtcbiAgICB9XG4gICAgY2hhbm5lbERvd24oKSB7XG4gICAgICAgIC8vRG8gbm90aGluZ1xuICAgIH1cbiAgICBvblJwY01zZygpIHtcbiAgICAgICAgLy9EbyBub3RoaW5nXG4gICAgfVxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJEaXNjb25uZWN0ZWRTdGF0ZVwiO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBGYWlsZWRTdGF0ZSBleHRlbmRzIFNpZ25hbGluZ1N0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcihzaWduYWxpbmcsIGV4Y2VwdGlvbikge1xuICAgICAgICBzdXBlcihzaWduYWxpbmcpO1xuICAgICAgICB0aGlzLl9leGNlcHRpb24gPSBleGNlcHRpb247XG4gICAgfVxuICAgIG9uRW50ZXIoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gbm90aWZ5RmFpbGVkKHJlc29sdmUpIHtcbiAgICAgICAgICAgIHNlbGYuX3NpZ25hbGluZy5fZmFpbGVkSGFuZGxlcihzZWxmLl9leGNlcHRpb24pO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fc2lnbmFsaW5nLl93c3MuY2xvc2UoKTtcbiAgICB9XG4gICAgY2hhbm5lbERvd24oKSB7XG4gICAgICAgIC8vRG8gbm90aGluZ1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiRmFpbGVkU3RhdGVcIjtcbiAgICB9XG4gICAgZ2V0IGV4Y2VwdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2V4Y2VwdGlvbjtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFtem5SdGNTaWduYWxpbmcge1xuICAgIGNvbnN0cnVjdG9yKGNhbGxJZCwgc2lnbmFsaW5nVXJpLCBjb250YWN0VG9rZW4sIGxvZ2dlciwgY29ubmVjdFRpbWVvdXRNcywgY29ubmVjdGlvbklkLCB3c3NNYW5hZ2VyKSB7XG4gICAgICAgIHRoaXMuX2NhbGxJZCA9IGNhbGxJZDtcbiAgICAgICAgdGhpcy5fY29ubmVjdFRpbWVvdXRNcyA9IGNvbm5lY3RUaW1lb3V0TXMgfHwgREVGQVVMVF9DT05ORUNUX1RJTUVPVVRfTVM7XG4gICAgICAgIHRoaXMuX2F1dG9BbnN3ZXIgPSB0cnVlO1xuICAgICAgICB0aGlzLl9zaWduYWxpbmdVcmkgPSBzaWduYWxpbmdVcmk7XG4gICAgICAgIHRoaXMuX2NvbnRhY3RUb2tlbiA9IGNvbnRhY3RUb2tlbjtcbiAgICAgICAgdGhpcy5fbG9nZ2VyID0gd3JhcExvZ2dlcihsb2dnZXIsIGNhbGxJZCwgJ1NJR05BTElORycpO1xuICAgICAgICB0aGlzLl9jb25uZWN0aW9uSWQgPSBjb25uZWN0aW9uSWQ7XG4gICAgICAgIHRoaXMuX3dzc01hbmFnZXIgPSB3c3NNYW5hZ2VyO1xuXG4gICAgICAgIC8vZW1wdHkgZXZlbnQgaGFuZGxlcnNcbiAgICAgICAgdGhpcy5fY29ubmVjdGVkSGFuZGxlciA9XG4gICAgICAgIHRoaXMuX2Fuc3dlcmVkSGFuZGxlciA9XG4gICAgICAgIHRoaXMuX2hhbmRzaGFrZWRIYW5kbGVyID1cbiAgICAgICAgdGhpcy5fcmVjb25uZWN0ZWRIYW5kbGVyID1cbiAgICAgICAgdGhpcy5fcmVtb3RlSHVuZ3VwSGFuZGxlciA9XG4gICAgICAgIHRoaXMuX2Rpc2Nvbm5lY3RlZEhhbmRsZXIgPVxuICAgICAgICB0aGlzLl9mYWlsZWRIYW5kbGVyID0gZnVuY3Rpb24gbm9PcCgpIHt9O1xuICAgIH1cbiAgICBnZXQgY2FsbElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2FsbElkO1xuICAgIH1cbiAgICBzZXQgb25Db25uZWN0ZWQoY29ubmVjdGVkSGFuZGxlcikge1xuICAgICAgICB0aGlzLl9jb25uZWN0ZWRIYW5kbGVyID0gY29ubmVjdGVkSGFuZGxlcjtcbiAgICB9XG4gICAgc2V0IG9uQW5zd2VyZWQoYW5zd2VyZWRIYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX2Fuc3dlcmVkSGFuZGxlciA9IGFuc3dlcmVkSGFuZGxlcjtcbiAgICB9XG4gICAgc2V0IG9uSGFuZHNoYWtlZChoYW5kc2hha2VkSGFuZGxlcikge1xuICAgICAgICB0aGlzLl9oYW5kc2hha2VkSGFuZGxlciA9IGhhbmRzaGFrZWRIYW5kbGVyO1xuICAgIH1cbiAgICBzZXQgb25SZWNvbm5lY3RlZChyZWNvbm5lY3RlZEhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fcmVjb25uZWN0ZWRIYW5kbGVyID0gcmVjb25uZWN0ZWRIYW5kbGVyO1xuICAgIH1cbiAgICBzZXQgb25SZW1vdGVIdW5ndXAocmVtb3RlSHVuZ3VwSGFuZGxlcikge1xuICAgICAgICB0aGlzLl9yZW1vdGVIdW5ndXBIYW5kbGVyID0gcmVtb3RlSHVuZ3VwSGFuZGxlcjtcbiAgICB9XG4gICAgc2V0IG9uRGlzY29ubmVjdGVkKGRpc2Nvbm5lY3RlZEhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fZGlzY29ubmVjdGVkSGFuZGxlciA9IGRpc2Nvbm5lY3RlZEhhbmRsZXI7XG4gICAgfVxuICAgIHNldCBvbkZhaWxlZChmYWlsZWRIYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX2ZhaWxlZEhhbmRsZXIgPSBmYWlsZWRIYW5kbGVyO1xuICAgIH1cbiAgICBnZXQgc3RhdGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdGF0ZTtcbiAgICB9XG5cbiAgICBjb25uZWN0KCkge1xuICAgICAgICB0aGlzLl9jb25uZWN0KCk7XG4gICAgICAgIHRoaXMudHJhbnNpdChuZXcgUGVuZGluZ0Nvbm5lY3RTdGF0ZSh0aGlzLCB0aGlzLl9jb25uZWN0VGltZW91dE1zKSk7XG4gICAgfVxuXG4gICAgX2Nvbm5lY3QoKSB7XG4gICAgICAgIHRoaXMuX3dzcyA9IHRoaXMuX2Nvbm5lY3RXZWJTb2NrZXQodGhpcy5fYnVpbGRJbnZpdGVVcmkoKSk7XG4gICAgfVxuICAgIHRyYW5zaXQobmV4dFN0YXRlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLl9sb2dnZXIuaW5mbygodGhpcy5fc3RhdGUgPyB0aGlzLl9zdGF0ZS5uYW1lIDogJ251bGwnKSArICcgPT4gJyArIG5leHRTdGF0ZS5uYW1lKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlICYmIHRoaXMuc3RhdGUub25FeGl0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5vbkV4aXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gbmV4dFN0YXRlO1xuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRlLm9uRW50ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZS5vbkVudGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgX2Nvbm5lY3RXZWJTb2NrZXQodXJpKSB7XG4gICAgICAgIGxldCB3c0Nvbm5lY3Rpb247XG4gICAgICAgIGlmICh0aGlzLl93c3NNYW5hZ2VyKSB7XG4gICAgICAgICAgICB3c0Nvbm5lY3Rpb24gPSBuZXcgVmlydHVhbFdzc0Nvbm5lY3Rpb25NYW5hZ2VyKHRoaXMuX2xvZ2dlciwgdGhpcy5fY29ubmVjdGlvbklkLCB0aGlzLl93c3NNYW5hZ2VyKTtcbiAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgd3NDb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldCh1cmkpO1xuICAgICAgICB9XG4gICAgICAgIHdzQ29ubmVjdGlvbi5vbm9wZW4gPSBoaXRjaCh0aGlzLCB0aGlzLl9vbk9wZW4pO1xuICAgICAgICB3c0Nvbm5lY3Rpb24ub25tZXNzYWdlID0gaGl0Y2godGhpcywgdGhpcy5fb25NZXNzYWdlKTtcbiAgICAgICAgd3NDb25uZWN0aW9uLm9uZXJyb3IgPSBoaXRjaCh0aGlzLCB0aGlzLl9vbkVycm9yKTtcbiAgICAgICAgd3NDb25uZWN0aW9uLm9uY2xvc2UgPSBoaXRjaCh0aGlzLCB0aGlzLl9vbkNsb3NlKTtcbiAgICAgICAgcmV0dXJuIHdzQ29ubmVjdGlvbjtcbiAgICB9XG4gICAgX2J1aWxkSW52aXRlVXJpKCkge1xuICAgICAgICBpZiAodGhpcy5fY29udGFjdFRva2VuKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYnVpbGRVcmlCYXNlKCkgKyAnJmNvbnRhY3RDdHg9JyArIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLl9jb250YWN0VG9rZW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2J1aWxkVXJpQmFzZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9idWlsZFJlY29ubmVjdFVyaSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2J1aWxkVXJpQmFzZSgpICsgJyZjbGllbnRUb2tlbj0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuX2NsaWVudFRva2VuKTtcbiAgICB9XG4gICAgX2J1aWxkVXJpQmFzZSgpIHtcbiAgICAgICAgdmFyIHNlcGFyYXRvciA9ICc/JztcbiAgICAgICAgaWYgKHRoaXMuX3NpZ25hbGluZ1VyaS5pbmRleE9mKHNlcGFyYXRvcikgPiAtMSkge1xuICAgICAgICAgICAgc2VwYXJhdG9yID0gJyYnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9zaWduYWxpbmdVcmkgKyBzZXBhcmF0b3IgKyAnY2FsbElkPScgKyBlbmNvZGVVUklDb21wb25lbnQodGhpcy5fY2FsbElkKTtcbiAgICB9XG4gICAgX29uTWVzc2FnZShldnQpIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5vblJwY01zZyhKU09OLnBhcnNlKGV2dC5kYXRhKSk7XG4gICAgfVxuICAgIF9vbk9wZW4oZXZ0KSB7XG4gICAgICAgIHRoaXMuc3RhdGUub25PcGVuKGV2dCk7XG4gICAgfVxuICAgIF9vbkVycm9yKGV2dCkge1xuICAgICAgICB0aGlzLnN0YXRlLm9uRXJyb3IoZXZ0KTtcbiAgICB9XG4gICAgX29uQ2xvc2UoZXZ0KSB7XG4gICAgICAgIHRoaXMuX2xvZ2dlci5sb2coJ1dlYlNvY2tldCBvbmNsb3NlIGNvZGU9JyArIGV2dC5jb2RlICsgJywgcmVhc29uPScgKyBldnQucmVhc29uKTtcbiAgICAgICAgdGhpcy5zdGF0ZS5vbkNsb3NlKGV2dCk7XG4gICAgfVxuICAgIF9yZWNvbm5lY3QoKSB7XG4gICAgICAgIHRoaXMuX3dzcyA9IHRoaXMuX2Nvbm5lY3RXZWJTb2NrZXQodGhpcy5fYnVpbGRSZWNvbm5lY3RVcmkoKSk7XG4gICAgfVxuICAgIGludml0ZShzZHAsIGljZUNhbmRpZGF0ZXMpIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5pbnZpdGUoc2RwLCBpY2VDYW5kaWRhdGVzKTtcbiAgICB9XG4gICAgYWNjZXB0KCkge1xuICAgICAgICB0aGlzLnN0YXRlLmFjY2VwdCgpO1xuICAgIH1cbiAgICBoYW5ndXAoKSB7XG4gICAgICAgIHRoaXMuc3RhdGUuaGFuZ3VwKCk7XG4gICAgfVxufSIsIlxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ0NQSW5pdGlhdGlvblN0cmF0ZWd5SW50ZXJmYWNlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJDQ1BJbml0aWF0aW9uU3RyYXRlZ3lJbnRlcmZhY2UgaW5pdGlhbGl6ZWRcIik7XG4gICAgfVxuXG4gICAgZ2V0U3RyYXRlZ3lOYW1lKCl7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJnZXRTdHJhdGVneU5hbWUgbmVlZHMgdG8gYmUgb3ZlcnJpZGRlblwiKTtcbiAgICB9XG5cbiAgICAvLyB0aGUgZm9sbG93aW5nIGZ1bmN0aW9ucyBhcmUgcnRjX3BlZXJfY29ubmVjdGlvbl9mYWN0b3J5IHJlbGF0ZWQgZnVuY3Rpb25zXG4gICAgLy8gY2hlY2sgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgZWFybHkgbWVkaWEgY29ubmVjdGlvblxuICAgIF9pc0Vhcmx5TWVkaWFDb25uZWN0aW9uU3VwcG9ydGVkKCl7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJfaXNFYXJseU1lZGlhQ29ubmVjdGlvblN1cHBvcnRlZCBuZWVkcyB0byBiZSBvdmVycmlkZGVuXCIpO1xuICAgIH1cblxuICAgIF9jcmVhdGVSdGNQZWVyQ29ubmVjdGlvbigpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIl9jcmVhdGVSdGNQZWVyQ29ubmVjdGlvbiBuZWVkcyB0byBiZSBvdmVycmlkZGVuXCIpO1xuICAgIH1cblxuICAgIC8vIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb25zIGFyZSBydGNfc2Vzc2lvbiByZWxhdGVkIGZ1bmN0aW9uc1xuICAgIF9ndU0oKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJfZ3VNIG5lZWRzIHRvIGJlIG92ZXJyaWRkZW5cIik7XG4gICAgfVxuXG4gICAgYWRkU3RyZWFtKCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiYWRkU3RyZWFtIG5lZWRzIHRvIGJlIG92ZXJyaWRkZW5cIik7XG4gICAgfVxuXG4gICAgc2V0UmVtb3RlRGVzY3JpcHRpb24oKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJzZXRSZW1vdGVEZXNjcmlwdGlvbiBuZWVkcyB0byBiZSBvdmVycmlkZGVuXCIpO1xuICAgIH1cblxuICAgIG9uSWNlU3RhdGVDaGFuZ2UoKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJvbkljZVN0YXRlQ2hhbmdlIG5lZWRzIHRvIGJlIG92ZXJyaWRkZW5cIik7XG4gICAgfVxuXG4gICAgb25QZWVyQ29ubmVjdGlvblN0YXRlQ2hhbmdlKCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwib25QZWVyQ29ubmVjdGlvblN0YXRlQ2hhbmdlIG5lZWRzIHRvIGJlIG92ZXJyaWRkZW5cIik7XG4gICAgfVxuXG4gICAgX2NyZWF0ZVBlZXJDb25uZWN0aW9uKCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiX2NyZWF0ZVBlZXJDb25uZWN0aW9uIG5lZWRzIHRvIGJlIG92ZXJyaWRkZW5cIik7XG4gICAgfVxuXG4gICAgY29ubmVjdCgpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcImNvbm5lY3QgbmVlZHMgdG8gYmUgb3ZlcnJpZGRlblwiKTtcbiAgICB9XG5cbiAgICBfb250cmFjaygpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIl9vbnRyYWNrIG5lZWRzIHRvIGJlIG92ZXJyaWRkZW5cIik7XG4gICAgfVxuXG4gICAgX2J1aWxkTWVkaWFDb25zdHJhaW50cygpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIl9idWlsZE1lZGlhQ29uc3RyYWludHMgbmVlZHMgdG8gYmUgb3ZlcnJpZGRlblwiKTtcbiAgICB9XG59XG4iLCIvKipcbiAqIEJ5IHVzaW5nIHRoZSBDaXRyaXggdWNzZGsgKGh0dHBzOi8vd3d3Lm5wbWpzLmNvbS9wYWNrYWdlL0BjaXRyaXgvdWNzZGspLCB5b3UgYXJlIGFjY2VwdGluZyB0aGUgQ2l0cml4IERldmVsb3BlciBUZXJtcyBvZiBVc2UgIGxvY2F0ZWQgaGVyZTogaHR0cHM6Ly93d3cuY2xvdWQuY29tL3Rlcm1zLW9mLXVzZS5cbiAqL1xuXG5pbXBvcnQgQ0NQSW5pdGlhdGlvblN0cmF0ZWd5SW50ZXJmYWNlIGZyb20gXCIuL0NDUEluaXRpYXRpb25TdHJhdGVneUludGVyZmFjZVwiO1xuaW1wb3J0IHtGYWlsZWRTdGF0ZX0gZnJvbSBcIi4uL3J0Y19zZXNzaW9uXCI7XG5pbXBvcnQge1JUQ19FUlJPUlN9IGZyb20gXCIuLi9ydGNfY29uc3RcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2l0cml4VkRJU3RyYXRlZ3kgZXh0ZW5kcyBDQ1BJbml0aWF0aW9uU3RyYXRlZ3lJbnRlcmZhY2Uge1xuXG4gICAgY29uc3RydWN0b3IodXNlUmVhbENpdHJpeCA9IHRydWUpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYodXNlUmVhbENpdHJpeCl7XG4gICAgICAgICAgICByZXF1aXJlKFwiQGNpdHJpeC91Y3Nkay9DaXRyaXhXZWJSVENcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coXCJDaXRyaXhWRElTdHJhdGVneSBpbml0aWFsaXppbmdcIik7XG4gICAgICAgIHRoaXMuaW5pdENpdHJpeFdlYlJUQygpO1xuICAgICAgICB0aGlzLmluaXRHZXRDaXRyaXhXZWJydGNSZWRpcigpO1xuICAgICAgICB0aGlzLmluaXRMb2coKTtcbiAgICB9XG5cbiAgICBpbml0Q2l0cml4V2ViUlRDKCkge1xuICAgICAgICB3aW5kb3cuQ2l0cml4V2ViUlRDLnNldFZNRXZlbnRDYWxsYmFjaygoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldmVudC5ldmVudCA9PT0gJ3ZkaUNsaWVudENvbm5lY3RlZCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXdpbmRvdy5DaXRyaXhXZWJSVEMuaXNGZWF0dXJlT24oXCJ3ZWJydGMxLjBcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDaXRyaXggV2ViUlRDIHJlZGlyZWN0aW9uIGZlYXR1cmUgaXMgTk9UIHN1cHBvcnRlZCEnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJDaXRyaXhWRElTdHJhdGVneSBpbml0aWFsaXplZFwiKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuZXZlbnQgPT09ICd2ZGlDbGllbnREaXNjb25uZWN0ZWQnKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ2ZGlDbGllbnREaXNjb25uZWN0ZWRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB3aW5kb3cuQ2l0cml4V2ViUlRDLmluaXRVQ1NESyhcIkFtYXpvbkNvbm5lY3RcIik7XG4gICAgfVxuICAgIGluaXRHZXRDaXRyaXhXZWJydGNSZWRpcigpIHtcbiAgICAgICAgd2luZG93LmdldENpdHJpeFdlYnJ0Y1JlZGlyID0gKCkgPT4gUHJvbWlzZS5yZXNvbHZlKDEpO1xuICAgIH1cblxuICAgIGluaXRMb2coKSB7XG4gICAgICAgIHdpbmRvdy5DaXRyaXhXZWJSVEMuaW5pdExvZyhnbG9iYWwuY29ubmVjdC5nZXRMb2coKSk7XG4gICAgfVxuXG4gICAgLy8gdGhlIGZvbGxvd2luZyBmdW5jdGlvbnMgYXJlIHJ0Y19wZWVyX2Nvbm5lY3Rpb25fZmFjdG9yeSByZWxhdGVkIGZ1bmN0aW9uc1xuICAgIC8vIGNoZWNrIGlmIHRoZSBicm93c2VyIHN1cHBvcnRzIGVhcmx5IG1lZGlhIGNvbm5lY3Rpb25cbiAgICBfaXNFYXJseU1lZGlhQ29ubmVjdGlvblN1cHBvcnRlZCgpIHtcbiAgICAgICAgLy8gQ2l0cml4IFdlYlJUQyBTREsgZG9lc24ndCBzdXBwb3J0IGVhcmx5IG1lZGlhIGNvbm5lY3Rpb25cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIF9jcmVhdGVSdGNQZWVyQ29ubmVjdGlvbihydGNQZWVyQ29ubmVjdGlvbkNvbmZpZywgcnRjUGVlckNvbm5lY3Rpb25PcHRpb25hbENvbmZpZykge1xuICAgICAgICByZXR1cm4gbmV3IHdpbmRvdy5DaXRyaXhXZWJSVEMuQ2l0cml4UGVlckNvbm5lY3Rpb24ocnRjUGVlckNvbm5lY3Rpb25Db25maWcsIHJ0Y1BlZXJDb25uZWN0aW9uT3B0aW9uYWxDb25maWcpO1xuICAgIH1cblxuICAgIC8vIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb25zIGFyZSBydGNfc2Vzc2lvbiByZWxhdGVkIGZ1bmN0aW9uc1xuICAgIF9nVU0oY29uc3RyYWludHMpIHtcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5DaXRyaXhXZWJSVEMuZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKTtcbiAgICB9XG5cbiAgICBhZGRTdHJlYW0oX3BjLCBzdHJlYW0pIHtcbiAgICAgICAgc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2godHJhY2sgPT4ge1xuICAgICAgICAgICAgX3BjLmFkZFRyYW5zY2VpdmVyKHRyYWNrLCB7fSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNldFJlbW90ZURlc2NyaXB0aW9uKHNlbGYsIHJ0Y1Nlc3Npb24pIHtcbiAgICAgICAgY29uc3QgYW5zd2VyU2Vzc2lvbkRlc2NyaXB0aW9uID0gc2VsZi5fY3JlYXRlU2Vzc2lvbkRlc2NyaXB0aW9uKHt0eXBlOiAnYW5zd2VyJywgc2RwOiBzZWxmLl9zZHB9KTtcblxuICAgICAgICBydGNTZXNzaW9uLl9wYy5zZXRSZW1vdGVEZXNjcmlwdGlvbihhbnN3ZXJTZXNzaW9uRGVzY3JpcHRpb24sICgpID0+IHtcbiAgICAgICAgICAgIHZhciByZW1vdGVDYW5kaWRhdGVQcm9taXNlcyA9IFByb21pc2UuYWxsKHNlbGYuX2NhbmRpZGF0ZXMubWFwKGZ1bmN0aW9uIChjYW5kaWRhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlQ2FuZGlkYXRlID0gc2VsZi5fY3JlYXRlUmVtb3RlQ2FuZGlkYXRlKGNhbmRpZGF0ZSk7XG4gICAgICAgICAgICAgICAgc2VsZi5sb2dnZXIuaW5mbygnQWRkaW5nIHJlbW90ZSBjYW5kaWRhdGUnLCByZW1vdGVDYW5kaWRhdGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBydGNTZXNzaW9uLl9wYy5hZGRJY2VDYW5kaWRhdGUocmVtb3RlQ2FuZGlkYXRlKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHJlbW90ZUNhbmRpZGF0ZVByb21pc2VzLmNhdGNoKHJlYXNvbiA9PiB7XG4gICAgICAgICAgICAgICAgc2VsZi5sb2dnZXIud2FybignRXJyb3IgYWRkaW5nIHJlbW90ZSBjYW5kaWRhdGUnLCByZWFzb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LnNldFJlbW90ZURlc2NyaXB0aW9uRmFpbHVyZSA9IGZhbHNlO1xuICAgICAgICAgICAgc2VsZi5fcmVtb3RlRGVzY3JpcHRpb25TZXQgPSB0cnVlO1xuICAgICAgICAgICAgc2VsZi5fY2hlY2tBbmRUcmFuc2l0KCk7XG4gICAgICAgIH0sICgpID0+IHtcbiAgICAgICAgICAgIHJ0Y1Nlc3Npb24uX3N0b3BTZXNzaW9uKCk7XG4gICAgICAgICAgICBydGNTZXNzaW9uLl9zZXNzaW9uUmVwb3J0LnNldFJlbW90ZURlc2NyaXB0aW9uRmFpbHVyZSA9IHRydWU7XG4gICAgICAgICAgICBzZWxmLnRyYW5zaXQobmV3IEZhaWxlZFN0YXRlKHJ0Y1Nlc3Npb24sIFJUQ19FUlJPUlMuU0VUX1JFTU9URV9ERVNDUklQVElPTl9GQUlMVVJFKSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uSWNlU3RhdGVDaGFuZ2UoZXZ0LCBfcGMpIHtcbiAgICAgICAgcmV0dXJuIF9wYy5pY2VDb25uZWN0aW9uU3RhdGU7XG4gICAgfVxuXG4gICAgb25QZWVyQ29ubmVjdGlvblN0YXRlQ2hhbmdlKF9wYykge1xuICAgICAgICByZXR1cm4gX3BjLmNvbm5lY3Rpb25TdGF0ZV87XG4gICAgfVxuXG4gICAgX2NyZWF0ZVBlZXJDb25uZWN0aW9uKGNvbmZpZ3VyYXRpb24sIG9wdGlvbmFsQ29uZmlndXJhdGlvbikge1xuICAgICAgICByZXR1cm4gbmV3IHdpbmRvdy5DaXRyaXhXZWJSVEMuQ2l0cml4UGVlckNvbm5lY3Rpb24oY29uZmlndXJhdGlvbiwgb3B0aW9uYWxDb25maWd1cmF0aW9uKTtcbiAgICB9XG5cbiAgICBfb250cmFjayhzZWxmLCBldnQpIHtcbiAgICAgICAgd2luZG93LkNpdHJpeFdlYlJUQy5tYXBBdWRpb0VsZW1lbnQoc2VsZi5fcmVtb3RlQXVkaW9FbGVtZW50KTtcbiAgICAgICAgaWYgKGV2dC5zdHJlYW1zLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHNlbGYuX2xvZ2dlci53YXJuKCdGb3VuZCBtb3JlIHRoYW4gMSBzdHJlYW1zIGZvciAnICsgZXZ0LnRyYWNrLmtpbmQgKyAnIHRyYWNrICcgKyBldnQudHJhY2suaWQgKyAnIDogJyArXG4gICAgICAgICAgICAgICAgZXZ0LnN0cmVhbXMubWFwKHN0cmVhbSA9PiBzdHJlYW0uaWQpLmpvaW4oJywnKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2dC50cmFjay5raW5kID09PSAndmlkZW8nICYmIHNlbGYuX3JlbW90ZVZpZGVvRWxlbWVudCkge1xuICAgICAgICAgICAgc2VsZi5fcmVtb3RlVmlkZW9FbGVtZW50LnNyY09iamVjdCA9IGV2dC5zdHJlYW1zWzBdO1xuICAgICAgICAgICAgc2VsZi5fcmVtb3RlVmlkZW9TdHJlYW0gPSBldnQuc3RyZWFtc1swXTtcbiAgICAgICAgfSBlbHNlIGlmIChldnQudHJhY2sua2luZCA9PT0gJ2F1ZGlvJyAmJiBzZWxmLl9yZW1vdGVBdWRpb0VsZW1lbnQpIHtcbiAgICAgICAgICAgIHNlbGYuX3JlbW90ZUF1ZGlvRWxlbWVudC5zcmNPYmplY3QgPSBldnQuc3RyZWFtc1swXTtcbiAgICAgICAgICAgIHNlbGYuX3JlbW90ZUF1ZGlvU3RyZWFtID0gZXZ0LnN0cmVhbXNbMF07XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5fcmVtb3RlQXVkaW9FbGVtZW50LnBsYXkoKTtcbiAgICB9XG5cbiAgICBfYnVpbGRNZWRpYUNvbnN0cmFpbnRzKHNlbGYsIG1lZGlhQ29uc3RyYWludHMpIHtcbiAgICAgICAgaWYgKHNlbGYuX2VuYWJsZUF1ZGlvKSB7XG4gICAgICAgICAgICB2YXIgYXVkaW9Db25zdHJhaW50cyA9IHt9O1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLl9lY2hvQ2FuY2VsbGF0aW9uICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGF1ZGlvQ29uc3RyYWludHMuZWNob0NhbmNlbGxhdGlvbiA9ICEhc2VsZi5fZWNob0NhbmNlbGxhdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh3aW5kb3cuYXVkaW9faW5wdXQpIHtcbiAgICAgICAgICAgICAgICBhdWRpb0NvbnN0cmFpbnRzLmRldmljZUlkID0gd2luZG93LmF1ZGlvX2lucHV0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKGF1ZGlvQ29uc3RyYWludHMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBtZWRpYUNvbnN0cmFpbnRzLmF1ZGlvID0gYXVkaW9Db25zdHJhaW50cztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWVkaWFDb25zdHJhaW50cy5hdWRpbyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtZWRpYUNvbnN0cmFpbnRzLmF1ZGlvID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRTdHJhdGVneU5hbWUoKSB7XG4gICAgICAgIHJldHVybiAnQ2l0cml4VkRJU3RyYXRlZ3knO1xuICAgIH1cbn0iLCJpbXBvcnQgQ0NQSW5pdGlhdGlvblN0cmF0ZWd5SW50ZXJmYWNlIGZyb20gXCIuL0NDUEluaXRpYXRpb25TdHJhdGVneUludGVyZmFjZVwiO1xuaW1wb3J0IHtDSFJPTUVfU1VQUE9SVEVEX1ZFUlNJT04sIFJUQ19FUlJPUlN9IGZyb20gXCIuLi9ydGNfY29uc3RcIjtcbmltcG9ydCB7Z2V0Q2hyb21lQnJvd3NlclZlcnNpb24sIGlzQ2hyb21lQnJvd3Nlcn0gZnJvbSBcIi4uL3V0aWxzXCI7XG5pbXBvcnQge0ZhaWxlZFN0YXRlfSBmcm9tIFwiLi4vcnRjX3Nlc3Npb25cIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3RhbmRhcmRTdHJhdGVneSBleHRlbmRzIENDUEluaXRpYXRpb25TdHJhdGVneUludGVyZmFjZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiU3RhbmRhcmRTdHJhdGVneSBpbml0aWFsaXplZFwiKTtcbiAgICB9XG5cbiAgICAvLyB0aGUgZm9sbG93aW5nIGZ1bmN0aW9ucyBhcmUgcnRjX3BlZXJfY29ubmVjdGlvbl9mYWN0b3J5IHJlbGF0ZWQgZnVuY3Rpb25zXG4gICAgLy8gY2hlY2sgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgZWFybHkgbWVkaWEgY29ubmVjdGlvblxuICAgIF9pc0Vhcmx5TWVkaWFDb25uZWN0aW9uU3VwcG9ydGVkKCl7XG4gICAgICAgIHJldHVybiBpc0Nocm9tZUJyb3dzZXIoKSAmJiBnZXRDaHJvbWVCcm93c2VyVmVyc2lvbigpID49IENIUk9NRV9TVVBQT1JURURfVkVSU0lPTjtcbiAgICB9XG5cbiAgICBfY3JlYXRlUnRjUGVlckNvbm5lY3Rpb24ocnRjUGVlckNvbm5lY3Rpb25Db25maWcsIHJ0Y1BlZXJDb25uZWN0aW9uT3B0aW9uYWxDb25maWcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSVENQZWVyQ29ubmVjdGlvbihydGNQZWVyQ29ubmVjdGlvbkNvbmZpZywgcnRjUGVlckNvbm5lY3Rpb25PcHRpb25hbENvbmZpZyk7XG4gICAgfVxuXG4gICAgLy8gdGhlIGZvbGxvd2luZyBmdW5jdGlvbnMgYXJlIHJ0Y19zZXNzaW9uIHJlbGF0ZWQgZnVuY3Rpb25zXG4gICAgX2dVTShjb25zdHJhaW50cykge1xuICAgICAgICByZXR1cm4gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpO1xuICAgIH1cblxuICAgIGFkZFN0cmVhbShfcGMsIHN0cmVhbSkge1xuICAgICAgICBfcGMuYWRkU3RyZWFtKHN0cmVhbSk7XG4gICAgfVxuXG4gICAgc2V0UmVtb3RlRGVzY3JpcHRpb24oc2VsZiwgcnRjU2Vzc2lvbikge1xuICAgICAgICB2YXIgc2V0UmVtb3RlRGVzY3JpcHRpb25Qcm9taXNlID0gcnRjU2Vzc2lvbi5fcGMuc2V0UmVtb3RlRGVzY3JpcHRpb24oc2VsZi5fY3JlYXRlU2Vzc2lvbkRlc2NyaXB0aW9uKHtcbiAgICAgICAgICAgIHR5cGU6ICdhbnN3ZXInLFxuICAgICAgICAgICAgc2RwOiBzZWxmLl9zZHBcbiAgICAgICAgfSkpO1xuICAgICAgICBzZXRSZW1vdGVEZXNjcmlwdGlvblByb21pc2UuY2F0Y2goZSA9PiB7XG4gICAgICAgICAgICBzZWxmLmxvZ2dlci5lcnJvcignU2V0UmVtb3RlRGVzY3JpcHRpb24gZmFpbGVkJywgZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBzZXRSZW1vdGVEZXNjcmlwdGlvblByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB2YXIgcmVtb3RlQ2FuZGlkYXRlUHJvbWlzZXMgPSBQcm9taXNlLmFsbChzZWxmLl9jYW5kaWRhdGVzLm1hcChmdW5jdGlvbiAoY2FuZGlkYXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlbW90ZUNhbmRpZGF0ZSA9IHNlbGYuX2NyZWF0ZVJlbW90ZUNhbmRpZGF0ZShjYW5kaWRhdGUpO1xuICAgICAgICAgICAgICAgIHNlbGYubG9nZ2VyLmluZm8oJ0FkZGluZyByZW1vdGUgY2FuZGlkYXRlJywgcmVtb3RlQ2FuZGlkYXRlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcnRjU2Vzc2lvbi5fcGMuYWRkSWNlQ2FuZGlkYXRlKHJlbW90ZUNhbmRpZGF0ZSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZW1vdGVDYW5kaWRhdGVQcm9taXNlcy5jYXRjaChyZWFzb24gPT4ge1xuICAgICAgICAgICAgICAgIHNlbGYubG9nZ2VyLndhcm4oJ0Vycm9yIGFkZGluZyByZW1vdGUgY2FuZGlkYXRlJywgcmVhc29uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlbW90ZUNhbmRpZGF0ZVByb21pc2VzO1xuICAgICAgICB9KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHJ0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuc2V0UmVtb3RlRGVzY3JpcHRpb25GYWlsdXJlID0gZmFsc2U7XG4gICAgICAgICAgICBzZWxmLl9yZW1vdGVEZXNjcmlwdGlvblNldCA9IHRydWU7XG4gICAgICAgICAgICBzZWxmLl9jaGVja0FuZFRyYW5zaXQoKTtcbiAgICAgICAgfSkuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgcnRjU2Vzc2lvbi5fc3RvcFNlc3Npb24oKTtcbiAgICAgICAgICAgIHJ0Y1Nlc3Npb24uX3Nlc3Npb25SZXBvcnQuc2V0UmVtb3RlRGVzY3JpcHRpb25GYWlsdXJlID0gdHJ1ZTtcbiAgICAgICAgICAgIHNlbGYudHJhbnNpdChuZXcgRmFpbGVkU3RhdGUocnRjU2Vzc2lvbiwgUlRDX0VSUk9SUy5TRVRfUkVNT1RFX0RFU0NSSVBUSU9OX0ZBSUxVUkUpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25JY2VTdGF0ZUNoYW5nZShldnQsIF9wYykgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXG4gICAgICAgIHJldHVybiBldnQuY3VycmVudFRhcmdldC5pY2VDb25uZWN0aW9uU3RhdGU7XG4gICAgfVxuXG4gICAgb25QZWVyQ29ubmVjdGlvblN0YXRlQ2hhbmdlKF9wYykge1xuICAgICAgICByZXR1cm4gX3BjLmNvbm5lY3Rpb25TdGF0ZTtcbiAgICB9XG5cbiAgICBfY3JlYXRlUGVlckNvbm5lY3Rpb24oY29uZmlndXJhdGlvbiwgb3B0aW9uYWxDb25maWd1cmF0aW9uKSB7XG4gICAgICAgIHJldHVybiBuZXcgUlRDUGVlckNvbm5lY3Rpb24oY29uZmlndXJhdGlvbiwgb3B0aW9uYWxDb25maWd1cmF0aW9uKTtcbiAgICB9XG5cbiAgICBfb250cmFjayhzZWxmLCBldnQpIHtcbiAgICAgICAgaWYgKGV2dC5zdHJlYW1zLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHNlbGYuX2xvZ2dlci53YXJuKCdGb3VuZCBtb3JlIHRoYW4gMSBzdHJlYW1zIGZvciAnICsgZXZ0LnRyYWNrLmtpbmQgKyAnIHRyYWNrICcgKyBldnQudHJhY2suaWQgKyAnIDogJyArXG4gICAgICAgICAgICAgICAgZXZ0LnN0cmVhbXMubWFwKHN0cmVhbSA9PiBzdHJlYW0uaWQpLmpvaW4oJywnKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2dC50cmFjay5raW5kID09PSAndmlkZW8nICYmIHNlbGYuX3JlbW90ZVZpZGVvRWxlbWVudCkge1xuICAgICAgICAgICAgc2VsZi5fcmVtb3RlVmlkZW9FbGVtZW50LnNyY09iamVjdCA9IGV2dC5zdHJlYW1zWzBdO1xuICAgICAgICAgICAgc2VsZi5fcmVtb3RlVmlkZW9TdHJlYW0gPSBldnQuc3RyZWFtc1swXTtcbiAgICAgICAgfSBlbHNlIGlmIChldnQudHJhY2sua2luZCA9PT0gJ2F1ZGlvJyAmJiBzZWxmLl9yZW1vdGVBdWRpb0VsZW1lbnQpIHtcbiAgICAgICAgICAgIHNlbGYuX3JlbW90ZUF1ZGlvRWxlbWVudC5zcmNPYmplY3QgPSBldnQuc3RyZWFtc1swXTtcbiAgICAgICAgICAgIHNlbGYuX3JlbW90ZUF1ZGlvU3RyZWFtID0gZXZ0LnN0cmVhbXNbMF07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfYnVpbGRNZWRpYUNvbnN0cmFpbnRzKHNlbGYsIG1lZGlhQ29uc3RyYWludHMpIHtcbiAgICAgICAgaWYgKHNlbGYuX2VuYWJsZUF1ZGlvKSB7XG4gICAgICAgICAgICB2YXIgYXVkaW9Db25zdHJhaW50cyA9IHt9O1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLl9lY2hvQ2FuY2VsbGF0aW9uICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGF1ZGlvQ29uc3RyYWludHMuZWNob0NhbmNlbGxhdGlvbiA9ICEhc2VsZi5fZWNob0NhbmNlbGxhdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhhdWRpb0NvbnN0cmFpbnRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgbWVkaWFDb25zdHJhaW50cy5hdWRpbyA9IGF1ZGlvQ29uc3RyYWludHM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1lZGlhQ29uc3RyYWludHMuYXVkaW8gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWVkaWFDb25zdHJhaW50cy5hdWRpbyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0U3RyYXRlZ3lOYW1lKCkge1xuICAgICAgICByZXR1cm4gJ1N0YW5kYXJkU3RyYXRlZ3knO1xuICAgIH1cbn0iLCIvKipcbiAqIENvcHlyaWdodCAyMDE3IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjBcbiAqL1xuXG5pbXBvcnQge0lsbGVnYWxQYXJhbWV0ZXJzfSBmcm9tICcuL2V4Y2VwdGlvbnMnO1xuaW1wb3J0IHtnZXRLaW5kLCBwYXJzZVJ0cE1hcCwgcGFyc2VSdHBQYXJhbWV0ZXJzLCBzcGxpdExpbmVzLCBzcGxpdFNlY3Rpb25zLCB3cml0ZUZtdHB9IGZyb20gJ3NkcCc7XG5cbi8qKlxuICogQWxsIGxvZ2dpbmcgbWV0aG9kcyB1c2VkIGJ5IGNvbm5lY3QtcnRjLlxuICovXG52YXIgbG9nTWV0aG9kcyA9IFsnbG9nJywgJ2luZm8nLCAnd2FybicsICdlcnJvciddO1xuXG4vKipcbiAqIEJpbmRzIHRoZSBnaXZlbiBpbnN0YW5jZSBvYmplY3QgYXMgdGhlIGNvbnRleHQgZm9yXG4gKiB0aGUgbWV0aG9kIHByb3ZpZGVkLlxuICpcbiAqIEBwYXJhbSBzY29wZSBUaGUgaW5zdGFuY2Ugb2JqZWN0IHRvIGJlIHNldCBhcyB0aGUgc2NvcGVcbiAqICAgIG9mIHRoZSBmdW5jdGlvbi5cbiAqIEBwYXJhbSBtZXRob2QgVGhlIG1ldGhvZCB0byBiZSBlbmNhcHN1bGF0ZWQuXG4gKlxuICogQWxsIG90aGVyIGFyZ3VtZW50cywgaWYgYW55LCBhcmUgYm91bmQgdG8gdGhlIG1ldGhvZFxuICogaW52b2NhdGlvbiBpbnNpZGUgdGhlIGNsb3N1cmUuXG4gKlxuICogQHJldHVybiBBIGNsb3N1cmUgZW5jYXBzdWxhdGluZyB0aGUgaW52b2NhdGlvbiBvZiB0aGVcbiAqICAgIG1ldGhvZCBwcm92aWRlZCBpbiBjb250ZXh0IG9mIHRoZSBnaXZlbiBpbnN0YW5jZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhpdGNoKCkge1xuICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcbiAgICB2YXIgc2NvcGUgPSBhcmdzLnNoaWZ0KCk7XG4gICAgdmFyIG1ldGhvZCA9IGFyZ3Muc2hpZnQoKTtcblxuICAgIGlmICghc2NvcGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxQYXJhbWV0ZXJzKCd1dGlscy5oaXRjaCgpOiBzY29wZSBpcyByZXF1aXJlZCEnKTtcbiAgICB9XG5cbiAgICBpZiAoIW1ldGhvZCkge1xuICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFBhcmFtZXRlcnMoJ3V0aWxzLmhpdGNoKCk6IG1ldGhvZCBpcyByZXF1aXJlZCEnKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIG1ldGhvZCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFBhcmFtZXRlcnMoJ3V0aWxzLmhpdGNoKCk6IG1ldGhvZCBpcyBub3QgYSBmdW5jdGlvbiEnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gX2hpdGNoZWRGdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNsb3N1cmVBcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcbiAgICAgICAgcmV0dXJuIG1ldGhvZC5hcHBseShzY29wZSwgYXJncy5jb25jYXQoY2xvc3VyZUFyZ3MpKTtcbiAgICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gd3JhcExvZ2dlcihsb2dnZXIsIGNhbGxJZCwgbG9nQ2F0ZWdvcnkpIHtcbiAgICB2YXIgX2xvZ2dlciA9IHt9O1xuICAgIGxvZ01ldGhvZHMuZm9yRWFjaChmdW5jdGlvbiAobG9nTWV0aG9kKSB7XG4gICAgICAgIGlmICghbG9nZ2VyW2xvZ01ldGhvZF0pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTG9nZ2luZyBtZXRob2QgJyArIGxvZ01ldGhvZCArICcgcmVxdWlyZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBfbG9nZ2VyW2xvZ01ldGhvZF0gPSBoaXRjaChsb2dnZXIsIGxvZ2dlcltsb2dNZXRob2RdLCBjYWxsSWQsIGxvZ0NhdGVnb3J5KTtcbiAgICB9KTtcbiAgICByZXR1cm4gX2xvZ2dlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsb3NlU3RyZWFtKHN0cmVhbSkge1xuICAgIGlmIChzdHJlYW0pIHtcbiAgICAgICAgdmFyIHRyYWNrcyA9IHN0cmVhbS5nZXRUcmFja3MoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0cmFja3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0cmFjayA9IHRyYWNrc1tpXTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdHJhY2suc3RvcCgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIGVhdCBleGNlcHRpb25cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBBIHBhcmFtZXRlciBvZiB0cmFuc2Zvcm1TZHAuXG4gKiBUaGlzIGRlZmluZXMgYWxsIHRoZSBTRFAgb3B0aW9ucyBjb25uZWN0LXJ0Yy1qcyBzdXBwb3J0cy5cbiAqL1xuZXhwb3J0IGNsYXNzIFNkcE9wdGlvbnMge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLl9mb3JjZUNvZGVjID0ge307XG4gICAgfVxuXG4gICAgZ2V0IGVuYWJsZU9wdXNEdHgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9lbmFibGVPcHVzRHR4O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ5IGRlZmF1bHQgdHJhbnNmb3JtU2RwIGRpc2FibGVzIGR0eCBmb3IgT1BVUyBjb2RlYy5cbiAgICAgKiBTZXR0aW5nIHRoaXMgdG8gdHJ1ZSB3b3VsZCBmb3JjZSBpdCB0byB0dXJuIG9uIERUWC5cbiAgICAgKi9cbiAgICBzZXQgZW5hYmxlT3B1c0R0eChmbGFnKSB7XG4gICAgICAgIHRoaXMuX2VuYWJsZU9wdXNEdHggPSBmbGFnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgbWFwIGZyb20gbWVkaWEgdHlwZSAoYXVkaW8vdmlkZW8pIHRvIGNvZGVjIChjYXNlIGluc2Vuc2l0aXZlKS5cbiAgICAgKiBBZGQgZW50cnkgZm9yIGZvcmNlIGNvbm5lY3QtcnRjLWpzIHRvIHVzZSBzcGVjaWZpZWQgY29kZWMgZm9yIGNlcnRhaW4gbWVkaWEgdHlwZS5cbiAgICAgKiBGb3IgZXhhbXBsZTogc2RwT3B0aW9ucy5mb3JjZUNvZGVjWydhdWRpbyddID0gJ29wdXMnO1xuICAgICAqL1xuICAgIGdldCBmb3JjZUNvZGVjKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZm9yY2VDb2RlYztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUZXN0IGlmIGdpdmVuIGNvZGVjIHNob3VsZCBiZSByZW1vdmVkIGZyb20gU0RQLlxuICAgICAqIEBwYXJhbSBtZWRpYVR5cGUgYXVkaW98dmlkZW9cbiAgICAgKiBAcGFyYW0gY29kZWNOYW1lIGNhc2UgaW5zZW5zaXRpdmVcbiAgICAgKiBAcmV0dXJuIFRSVUUgLSBzaG91bGQgcmVtb3ZlXG4gICAgICovXG4gICAgX3Nob3VsZERlbGV0ZUNvZGVjKG1lZGlhVHlwZSwgY29kZWNOYW1lKSB7XG4gICAgICAgIHZhciB1cHBlckNhc2VDb2RlY05hbWUgPSBjb2RlY05hbWUudG9VcHBlckNhc2UoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZvcmNlQ29kZWNbbWVkaWFUeXBlXSAmJiB1cHBlckNhc2VDb2RlY05hbWUgIT09IHRoaXMuX2ZvcmNlQ29kZWNbbWVkaWFUeXBlXS50b1VwcGVyQ2FzZSgpICYmIHVwcGVyQ2FzZUNvZGVjTmFtZSAhPT0gJ1RFTEVQSE9ORS1FVkVOVCc7XG4gICAgfVxufVxuXG4vKipcbiAqIE1vZGlmaWVzIGlucHV0IFNEUCBhY2NvcmRpbmcgdG8gc2RwT3B0aW9ucy5cbiAqIFNlZSBTZHBPcHRpb25zIGZvciBhdmFpbGFibGUgb3B0aW9ucy5cbiAqIEBwYXJhbSBzZHAgb3JpZ2luYWwgU0RQXG4gKiBAcGFyYW0gc2RwT3B0aW9ucyBkZWZpbmVzIGNoYW5nZXMgdG8gYmUgYXBwbGllZCB0byBTRFBcbiAqIEByZXR1cm5zIGEgbWFwIHdpdGggJ3NkcCcgY29udGFpbmluZyB0aGUgdHJhbnNmb3JtZWQgU0RQIGFuZCAnbUxpbmVzJyBjb250YWluaW5nIHRoZSBudW1iZXIgb2YgbSBsaW5lcyBpbiBTRFBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyYW5zZm9ybVNkcChzZHAsIHNkcE9wdGlvbnMpIHtcbiAgICB2YXIgc2VjdGlvbnMgPSBzcGxpdFNlY3Rpb25zKHNkcCk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBzZWN0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgbWVkaWFUeXBlID0gZ2V0S2luZChzZWN0aW9uc1tpXSk7XG4gICAgICAgIHZhciBydHBQYXJhbXMgPSBwYXJzZVJ0cFBhcmFtZXRlcnMoc2VjdGlvbnNbaV0pO1xuICAgICAgICAvLyBhIG1hcCBmcm9tIHBheWxvYWQgdHlwZSAoc3RyaW5nKSB0byBjb2RlYyBvYmplY3RcbiAgICAgICAgdmFyIGNvZGVjTWFwID0gcnRwUGFyYW1zLmNvZGVjcy5yZWR1Y2UoKG1hcCwgY29kZWMpID0+IHtcbiAgICAgICAgICAgIG1hcFsnJyArIGNvZGVjLnBheWxvYWRUeXBlXSA9IGNvZGVjO1xuICAgICAgICAgICAgcmV0dXJuIG1hcDtcbiAgICAgICAgfSwge30pO1xuICAgICAgICBzZWN0aW9uc1tpXSA9IHNwbGl0TGluZXMoc2VjdGlvbnNbaV0pLm1hcChsaW5lID0+IHtcbiAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoJ209JykpIHtcbiAgICAgICAgICAgICAgICAvLyBtb2RpZnkgbT0gbGluZSBpZiBTZHBPcHRpb25zI2ZvcmNlQ29kZWMgc3BlY2lmaWVzIGNvZGVjIGZvciBjdXJyZW50IG1lZGlhIHR5cGVcbiAgICAgICAgICAgICAgICBpZiAoc2RwT3B0aW9ucy5mb3JjZUNvZGVjW21lZGlhVHlwZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldENvZGVjUHRzID0gT2JqZWN0LmtleXMoY29kZWNNYXApLmZpbHRlcihwdCA9PiAhc2RwT3B0aW9ucy5fc2hvdWxkRGVsZXRlQ29kZWMobWVkaWFUeXBlLCBjb2RlY01hcFtwdF0ubmFtZSkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLy4qUlRQXFwvUz9BVlBGPyAvLmV4ZWMobGluZSkgKyB0YXJnZXRDb2RlY1B0cy5qb2luKCcgJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5lLnN0YXJ0c1dpdGgoJ2E9cnRwbWFwOicpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJ0cE1hcCA9IHBhcnNlUnRwTWFwKGxpbmUpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50Q29kZWMgPSBjb2RlY01hcFtydHBNYXAucGF5bG9hZFR5cGVdO1xuXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHRoaXMgY29kZWMgaWYgU2RwT3B0aW9ucyNmb3JjZUNvZGVjIHNwZWNpZmllcyBhIGRpZmZlcmVudCBjb2RlYyBmb3IgY3VycmVudCBtZWRpYSB0eXBlXG4gICAgICAgICAgICAgICAgaWYgKGlzX2RlZmluZWQoY3VycmVudENvZGVjKSAmJiBzZHBPcHRpb25zLl9zaG91bGREZWxldGVDb2RlYyhtZWRpYVR5cGUsIGN1cnJlbnRDb2RlYy5uYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBhcHBlbmQgYT1mbXRwIGxpbmUgaW1tZWRpYXRlbHkgaWYgY3VycmVudCBjb2RlYyBpcyBPUFVTICh0byBleHBsaWNpdGx5IHNwZWNpZnkgT1BVUyBwYXJhbWV0ZXJzKVxuICAgICAgICAgICAgICAgIGlmIChpc19kZWZpbmVkKGN1cnJlbnRDb2RlYykgJiYgY3VycmVudENvZGVjLm5hbWUudG9VcHBlckNhc2UoKSA9PT0gJ09QVVMnKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDb2RlYy5wYXJhbWV0ZXJzLnVzZWR0eCA9IHNkcE9wdGlvbnMuZW5hYmxlT3B1c0R0eCA/IFwiMVwiIDogXCIwXCI7XG4gICAgICAgICAgICAgICAgICAgIC8vIGdlbmVyYXRlIGZtdHAgbGluZSBpbW1lZGlhdGVseSBhZnRlciBydHBtYXAgbGluZSwgYW5kIHJlbW92ZSBvcmlnaW5hbCBmbXRwIGxpbmUgb25jZSB3ZSBzZWUgaXRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChsaW5lICsgXCJcXHJcXG5cIiArIHdyaXRlRm10cChjdXJyZW50Q29kZWMpKS50cmltKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5lLnN0YXJ0c1dpdGgoJ2E9Zm10cDonKSkge1xuICAgICAgICAgICAgICAgIHZhciBwdCA9IGxpbmUuc3Vic3RyaW5nKCdhPWZtdHA6Jy5sZW5ndGgsIGxpbmUuaW5kZXhPZignICcpKTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudENvZGVjID0gY29kZWNNYXBbcHRdOy8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVkZWNsYXJlXG5cbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgdGhpcyBjb2RlYyBpZiBTZHBPcHRpb25zI2ZvcmNlQ29kZWMgc3BlY2lmaWVzIGEgZGlmZmVyZW50IGNvZGVjIGZvciBjdXJyZW50IG1lZGlhIHR5cGVcbiAgICAgICAgICAgICAgICBpZiAoaXNfZGVmaW5lZChjdXJyZW50Q29kZWMpICYmIHNkcE9wdGlvbnMuX3Nob3VsZERlbGV0ZUNvZGVjKG1lZGlhVHlwZSwgY3VycmVudENvZGVjLm5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpc19kZWZpbmVkKGN1cnJlbnRDb2RlYykgJiYgY3VycmVudENvZGVjLm5hbWUudG9VcHBlckNhc2UoKSA9PT0gJ09QVVMnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgaXMgYSBsaW5lIGZvciBPUFVTLCByZW1vdmUgaXQgYmVjYXVzZSBGTVRQIGxpbmUgaXMgYWxyZWFkeSBnZW5lcmF0ZWQgd2hlbiBydHBtYXAgbGluZSBpcyBwcm9jZXNzZWRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5lLnN0YXJ0c1dpdGgoJ2E9cnRjcC1mYjonKSkge1xuICAgICAgICAgICAgICAgIHZhciBwdCA9IGxpbmUuc3Vic3RyaW5nKGxpbmUuaW5kZXhPZignOicpICsgMSwgbGluZS5pbmRleE9mKCcgJykpOy8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVkZWNsYXJlXG4gICAgICAgICAgICAgICAgaWYgKHB0ID09PSAnKicpIHsgLy9hbHdheXMgYWxsb3cgd2lsZGNhcmQgaW4gcnRjLWZiXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsaW5lO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50Q29kZWMgPSBjb2RlY01hcFtwdF07Ly8gZXNsaW50LWRpc2FibGUtbGluZSBuby1yZWRlY2xhcmVcblxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgdGhpcyBjb2RlYyBpZiBTZHBPcHRpb25zI2ZvcmNlQ29kZWMgc3BlY2lmaWVzIGEgZGlmZmVyZW50IGNvZGVjIGZvciBjdXJyZW50IG1lZGlhIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzX2RlZmluZWQoY3VycmVudENvZGVjKSAmJiBzZHBPcHRpb25zLl9zaG91bGREZWxldGVDb2RlYyhtZWRpYVR5cGUsIGN1cnJlbnRDb2RlYy5uYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLmZpbHRlcihsaW5lID0+IGxpbmUgIT09IG51bGwpLmpvaW4oJ1xcclxcbicpO1xuXG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHNkcDogc2VjdGlvbnMubWFwKHNlY3Rpb24gPT4gc2VjdGlvbi50cmltKCkpLmpvaW4oJ1xcclxcbicpICsgJ1xcclxcbicsXG4gICAgICAgIG1MaW5lczogc2VjdGlvbnMubGVuZ3RoIC0gMSAvLyBmaXJzdCBzZWN0aW9uIGlzIHNlc3Npb24gZGVzY3JpcHRpb24sIHRoZSByZXN0IGFyZSBtZWRpYSBkZXNjcmlwdGlvbnNcbiAgICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNfZGVmaW5lZCh2KSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2ICE9PSAndW5kZWZpbmVkJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHdoZW5fZGVmaW5lZCh2LCBhbHRlcm5hdGl2ZUluKSB7XG4gICAgdmFyIGFsdGVybmF0aXZlID0gaXNfZGVmaW5lZChhbHRlcm5hdGl2ZUluKSA/IGFsdGVybmF0aXZlSW4gOiBudWxsO1xuICAgIHJldHVybiBpc19kZWZpbmVkKHYpID8gdiA6IGFsdGVybmF0aXZlO1xufVxuXG4vKipcbiAqIENoZWNrIGlmIHRoZSBnZXRTdGF0cyBBUEkgZm9yIHJldHJpZXZpbmcgbGVnYWN5IHN0YXRzIHJlcG9ydCBpcyBzdXBwb3J0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTGVnYWN5U3RhdHNSZXBvcnRTdXBwb3J0ZWQocGMpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICBwYy5nZXRTdGF0cyhmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gRXhjZXB0aW9uIHRocm93biBpZiBicm93c2VyIGRvZXMgbm90IHN1cHBvcnQgbGVnYWN5IHN0YXRzIHJlcG9ydFxuICAgICAgICAgICAgcmVzb2x2ZShmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiB0aGUgZ2l2ZW4gdmFsdWUgaXMgYSBjYWxsYWJsZSBmdW5jdGlvbiB0eXBlLlxuICogQm9ycm93ZWQgZnJvbSBVbmRlcnNjb3JlLmpzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNGdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gISEob2JqICYmIG9iai5jb25zdHJ1Y3RvciAmJiBvYmouY2FsbCAmJiBvYmouYXBwbHkpO1xufVxuXG4vKipcbiAqIEFzc2VydHMgdGhhdCBhIHByZW1pc2UgaXMgdHJ1ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydFRydWUocHJlbWlzZSwgbWVzc2FnZSkge1xuICAgIGlmICghcHJlbWlzZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IobWVzc2FnZSk7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNDaHJvbWVCcm93c2VyKCl7XG4gICAgcmV0dXJuIG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIkNocm9tZVwiKSAhPT0gLTE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDaHJvbWVCcm93c2VyVmVyc2lvbigpe1xuICAgIHZhciB1c2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xuICAgIHZhciBjaHJvbWVWZXJzaW9uID0gdXNlckFnZW50LnN1YnN0cmluZyh1c2VyQWdlbnQuaW5kZXhPZihcIkNocm9tZVwiKSs3KTtcbiAgICBpZiAoY2hyb21lVmVyc2lvbikge1xuICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChjaHJvbWVWZXJzaW9uKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmVkYWN0ZWRTZHAoc2RwKSB7XG4gICAgLy8gcGF0dGVybiB0byBmaW5kIGFuZCByZWRhY3QgdGhlIHZhbHVlIGFmdGVyICdhPWljZS1wd2Q6J1xuICAgIHZhciBwYXR0ZXJuID0gL2E9aWNlLXB3ZDpbXlxcclxcbl0qLztcblxuICAgIC8vIFVzZSB0aGUgcmVwbGFjZSBtZXRob2QgdG8gcmVkYWN0IHRoZSB2YWx1ZSB3aXRoICdbcmVkYWN0ZWRdJ1xuICAgIHJldHVybiBzZHAucmVwbGFjZShwYXR0ZXJuLCAnYT1pY2UtcHdkOltyZWRhY3RlZF0nKTtcbn1cbiIsImltcG9ydCB7aGl0Y2h9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHtTT0ZUUEhPTkVfUk9VVEVfS0VZfSBmcm9tICcuL3J0Y19jb25zdCdcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmlydHVhbFdzc0Nvbm5lY3Rpb25NYW5hZ2VyIHtcbiAgICBjb25zdHJ1Y3Rvcihsb2dnZXIsIGNvbm5lY3Rpb25JZCwgd3NzTWFuYWdlcikge1xuICAgICAgICB0aGlzLl9sb2dnZXIgPSBsb2dnZXI7XG4gICAgICAgIHRoaXMuX2Nvbm5lY3Rpb25JZCA9IGNvbm5lY3Rpb25JZDtcbiAgICAgICAgdGhpcy5fd3NzTWFuYWdlciA9IHdzc01hbmFnZXJcbiAgICAgICAgdGhpcy5faW5pdGlhbGl6ZVdlYlNvY2tldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgX2luaXRpYWxpemVXZWJTb2NrZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5fd3NzTWFuYWdlci5zdWJzY3JpYmVUb3BpY3MoW1NPRlRQSE9ORV9ST1VURV9LRVldKTtcbiAgICAgICAgdGhpcy5fdW5TdWJzY3JpYmUgPSB0aGlzLl93c3NNYW5hZ2VyLm9uTWVzc2FnZShTT0ZUUEhPTkVfUk9VVEVfS0VZLCBoaXRjaCh0aGlzLCB0aGlzLl93ZWJTb2NrZXRNYW5hZ2VyT25NZXNzYWdlKSk7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fb25PcGVuKCk7XG4gICAgICAgIH0sIDApO1xuICAgIH1cblxuICAgIF93ZWJTb2NrZXRNYW5hZ2VyT25NZXNzYWdlKGV2ZW50KSB7XG4gICAgICAgIGxldCBjb250ZW50O1xuICAgICAgICBpZiAoZXZlbnQuY29udGVudCkge1xuICAgICAgICAgICAgY29udGVudCA9IEpTT04ucGFyc2UoZXZlbnQuY29udGVudCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX29uTWVzc2FnZSAmJiBjb250ZW50ICYmIHRoaXMuX2Nvbm5lY3Rpb25JZCA9PT0gY29udGVudC5jb25uZWN0aW9uSWQpIHtcbiAgICAgICAgICAgIHRoaXMuX29uTWVzc2FnZSh7ZGF0YTogSlNPTi5zdHJpbmdpZnkoY29udGVudC5qc29uUnBjTXNnKX0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0IG9ubWVzc2FnZShjYWxsQmFjaykge1xuICAgICAgICB0aGlzLl9vbk1lc3NhZ2UgPSBjYWxsQmFjaztcbiAgICB9XG5cbiAgICBzZXQgb25vcGVuKGNhbGxCYWNrKSB7XG4gICAgICAgIHRoaXMuX29uT3BlbiA9IGNhbGxCYWNrO1xuICAgIH1cblxuICAgIHNlbmQod2ViU29ja2V0UGF5bG9hZCkge1xuICAgICAgICBjb25zdCBwYXlsb2FkID0ge307XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBwYXlsb2FkLnRvcGljID0gU09GVFBIT05FX1JPVVRFX0tFWTtcbiAgICAgICAgICAgIHBheWxvYWQuY29ubmVjdGlvbklkID0gdGhpcy5fY29ubmVjdGlvbklkO1xuICAgICAgICAgICAgcGF5bG9hZC5qc29uUnBjTXNnID0gSlNPTi5wYXJzZSh3ZWJTb2NrZXRQYXlsb2FkKTtcbiAgICAgICAgICAgIHRoaXMuX3dzc01hbmFnZXIuc2VuZE1lc3NhZ2UocGF5bG9hZCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLl9sb2dnZXIuZXJyb3IoXCJFcnJvciBpbiBzZW5kTWVzc2FnZSBcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX2xvZ2dlci5pbmZvKFwiY2xvc2luZyB2aXJ0dWFsIGNvbm5lY3Rpb25cIik7XG4gICAgICAgIHRoaXMuX3VuU3Vic2NyaWJlKCk7XG4gICAgfVxufSJdfQ==
