!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.dcvwebrtcredir=t():e.dcvwebrtcredir=t()}(self,(()=>(()=>{var e={114:function(e,t){!function(e){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="undefined"==typeof Uint8Array?[]:new Uint8Array(256),n=0;n<t.length;n++)r[t.charCodeAt(n)]=n;var i=function(e){var r,n=new Uint8Array(e),i=n.length,s="";for(r=0;r<i;r+=3)s+=t[n[r]>>2],s+=t[(3&n[r])<<4|n[r+1]>>4],s+=t[(15&n[r+1])<<2|n[r+2]>>6],s+=t[63&n[r+2]];return i%3==2?s=s.substring(0,s.length-1)+"=":i%3==1&&(s=s.substring(0,s.length-2)+"=="),s},s=function(e){var t,n,i,s,a,o=.75*e.length,c=e.length,d=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var l=new ArrayBuffer(o),p=new Uint8Array(l);for(t=0;t<c;t+=4)n=r[e.charCodeAt(t)],i=r[e.charCodeAt(t+1)],s=r[e.charCodeAt(t+2)],a=r[e.charCodeAt(t+3)],p[d++]=n<<2|i>>4,p[d++]=(15&i)<<4|s>>2,p[d++]=(3&s)<<6|63&a;return l};e.decode=s,e.encode=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},43:function(e,t,r){var n,i;!function(s,a){"use strict";n=function(){var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function i(e,t){var r=e[t];if("function"==typeof r.bind)return r.bind(e);try{return Function.prototype.bind.call(r,e)}catch(t){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(n){return"debug"===n&&(n="log"),typeof console!==t&&("trace"===n&&r?s:void 0!==console[n]?i(console,n):void 0!==console.log?i(console,"log"):e)}function o(t,r){for(var i=0;i<n.length;i++){var s=n[i];this[s]=i<t?e:this.methodFactory(s,t,r)}this.log=this.debug}function c(e,r,n){return function(){typeof console!==t&&(o.call(this,r,n),this[e].apply(this,arguments))}}function d(e,t,r){return a(e)||c.apply(this,arguments)}function l(e,r,i){var s,a=this;r=null==r?"WARN":r;var c="loglevel";function l(e){var r=(n[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=r)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+r+";"}catch(e){}}}function p(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var r=window.document.cookie,n=r.indexOf(encodeURIComponent(c)+"=");-1!==n&&(e=/^([^;]+)/.exec(r.slice(n))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}function h(){if(typeof window!==t&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}"string"==typeof e?c+=":"+e:"symbol"==typeof e&&(c=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=i||d,a.getLevel=function(){return s},a.setLevel=function(r,n){if("string"==typeof r&&void 0!==a.levels[r.toUpperCase()]&&(r=a.levels[r.toUpperCase()]),!("number"==typeof r&&r>=0&&r<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+r;if(s=r,!1!==n&&l(r),o.call(a,r,e),typeof console===t&&r<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){r=e,p()||a.setLevel(e,!1)},a.resetLevel=function(){a.setLevel(r,!1),h()},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var u=p();null==u&&(u=r),a.setLevel(u,!1)}var p=new l,h={};p.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=h[e];return t||(t=h[e]=new l(e,p.getLevel(),p.methodFactory)),t};var u=typeof window!==t?window.log:void 0;return p.noConflict=function(){return typeof window!==t&&window.log===p&&(window.log=u),p},p.getLoggers=function(){return h},p.default=p,p},void 0===(i="function"==typeof n?n.call(t,r,t,e):n)||(e.exports=i)}()},591:(e,t,r)=>{"use strict";const{Deflate:n,deflate:i,deflateRaw:s,gzip:a}=r(555),{Inflate:o,inflate:c,inflateRaw:d,ungzip:l}=r(843),p=r(619);e.exports.Deflate=n,e.exports.deflate=i,e.exports.deflateRaw=s,e.exports.gzip=a,e.exports.Inflate=o,e.exports.inflate=c,e.exports.inflateRaw=d,e.exports.ungzip=l,e.exports.constants=p},555:(e,t,r)=>{"use strict";const n=r(405),i=r(236),s=r(373),a=r(898),o=r(292),c=Object.prototype.toString,{Z_NO_FLUSH:d,Z_SYNC_FLUSH:l,Z_FULL_FLUSH:p,Z_FINISH:h,Z_OK:u,Z_STREAM_END:f,Z_DEFAULT_COMPRESSION:m,Z_DEFAULT_STRATEGY:_,Z_DEFLATED:g}=r(619);function v(e){this.options=i.assign({level:m,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:_},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;let r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==u)throw new Error(a[r]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,r=n.deflateSetDictionary(this.strm,e),r!==u)throw new Error(a[r]);this._dict_set=!0}}function E(e,t){const r=new v(t);if(r.push(e,!0),r.err)throw r.msg||a[r.err];return r.result}v.prototype.push=function(e,t){const r=this.strm,i=this.options.chunkSize;let a,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?h:d,"string"==typeof e?r.input=s.string2buf(e):"[object ArrayBuffer]"===c.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),(o===l||o===p)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(a=n.deflate(r,o),a===f)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),a=n.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===u;if(0!==r.avail_out){if(o>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},v.prototype.onData=function(e){this.chunks.push(e)},v.prototype.onEnd=function(e){e===u&&(this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Deflate=v,e.exports.deflate=E,e.exports.deflateRaw=function(e,t){return(t=t||{}).raw=!0,E(e,t)},e.exports.gzip=function(e,t){return(t=t||{}).gzip=!0,E(e,t)},e.exports.constants=r(619)},843:(e,t,r)=>{"use strict";const n=r(948),i=r(236),s=r(373),a=r(898),o=r(292),c=r(188),d=Object.prototype.toString,{Z_NO_FLUSH:l,Z_FINISH:p,Z_OK:h,Z_STREAM_END:u,Z_NEED_DICT:f,Z_STREAM_ERROR:m,Z_DATA_ERROR:_,Z_MEM_ERROR:g}=r(619);function v(e){this.options=i.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;let r=n.inflateInit2(this.strm,t.windowBits);if(r!==h)throw new Error(a[r]);if(this.header=new c,n.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=s.string2buf(t.dictionary):"[object ArrayBuffer]"===d.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=n.inflateSetDictionary(this.strm,t.dictionary),r!==h)))throw new Error(a[r])}function E(e,t){const r=new v(t);if(r.push(e),r.err)throw r.msg||a[r.err];return r.result}v.prototype.push=function(e,t){const r=this.strm,i=this.options.chunkSize,a=this.options.dictionary;let o,c,v;if(this.ended)return!1;for(c=t===~~t?t:!0===t?p:l,"[object ArrayBuffer]"===d.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),o=n.inflate(r,c),o===f&&a&&(o=n.inflateSetDictionary(r,a),o===h?o=n.inflate(r,c):o===_&&(o=f));r.avail_in>0&&o===u&&r.state.wrap>0&&0!==e[r.next_in];)n.inflateReset(r),o=n.inflate(r,c);switch(o){case m:case _:case f:case g:return this.onEnd(o),this.ended=!0,!1}if(v=r.avail_out,r.next_out&&(0===r.avail_out||o===u))if("string"===this.options.to){let e=s.utf8border(r.output,r.next_out),t=r.next_out-e,n=s.buf2string(r.output,e);r.next_out=t,r.avail_out=i-t,t&&r.output.set(r.output.subarray(e,e+t),0),this.onData(n)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(o!==h||0!==v){if(o===u)return o=n.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},v.prototype.onData=function(e){this.chunks.push(e)},v.prototype.onEnd=function(e){e===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Inflate=v,e.exports.inflate=E,e.exports.inflateRaw=function(e,t){return(t=t||{}).raw=!0,E(e,t)},e.exports.ungzip=E,e.exports.constants=r(619)},236:e=>{"use strict";const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);e.exports.assign=function(e){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const n=r.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const r in n)t(n,r)&&(e[r]=n[r])}}return e},e.exports.flattenChunks=e=>{let t=0;for(let r=0,n=e.length;r<n;r++)t+=e[r].length;const r=new Uint8Array(t);for(let t=0,n=0,i=e.length;t<i;t++){let i=e[t];r.set(i,n),n+=i.length}return r}},373:e=>{"use strict";let t=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){t=!1}const r=new Uint8Array(256);for(let e=0;e<256;e++)r[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;r[254]=r[254]=1,e.exports.string2buf=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,r,n,i,s,a=e.length,o=0;for(i=0;i<a;i++)r=e.charCodeAt(i),55296==(64512&r)&&i+1<a&&(n=e.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),s=0,i=0;s<o;i++)r=e.charCodeAt(i),55296==(64512&r)&&i+1<a&&(n=e.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|63&r):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|63&r):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|63&r);return t};e.exports.buf2string=(e,n)=>{const i=n||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,n));let s,a;const o=new Array(2*i);for(a=0,s=0;s<i;){let t=e[s++];if(t<128){o[a++]=t;continue}let n=r[t];if(n>4)o[a++]=65533,s+=n-1;else{for(t&=2===n?31:3===n?15:7;n>1&&s<i;)t=t<<6|63&e[s++],n--;n>1?o[a++]=65533:t<65536?o[a++]=t:(t-=65536,o[a++]=55296|t>>10&1023,o[a++]=56320|1023&t)}}return((e,r)=>{if(r<65534&&e.subarray&&t)return String.fromCharCode.apply(null,e.length===r?e:e.subarray(0,r));let n="";for(let t=0;t<r;t++)n+=String.fromCharCode(e[t]);return n})(o,a)},e.exports.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+r[e[n]]>t?n:t}},69:e=>{"use strict";e.exports=(e,t,r,n)=>{let i=65535&e|0,s=e>>>16&65535|0,a=0;for(;0!==r;){a=r>2e3?2e3:r,r-=a;do{i=i+t[n++]|0,s=s+i|0}while(--a);i%=65521,s%=65521}return i|s<<16|0}},619:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},869:e=>{"use strict";const t=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})());e.exports=(e,r,n,i)=>{const s=t,a=i+n;e^=-1;for(let t=i;t<a;t++)e=e>>>8^s[255&(e^r[t])];return-1^e}},405:(e,t,r)=>{"use strict";const{_tr_init:n,_tr_stored_block:i,_tr_flush_block:s,_tr_tally:a,_tr_align:o}=r(342),c=r(69),d=r(869),l=r(898),{Z_NO_FLUSH:p,Z_PARTIAL_FLUSH:h,Z_FULL_FLUSH:u,Z_FINISH:f,Z_BLOCK:m,Z_OK:_,Z_STREAM_END:g,Z_STREAM_ERROR:v,Z_DATA_ERROR:E,Z_BUF_ERROR:y,Z_DEFAULT_COMPRESSION:T,Z_FILTERED:C,Z_HUFFMAN_ONLY:b,Z_RLE:w,Z_FIXED:A,Z_DEFAULT_STRATEGY:R,Z_UNKNOWN:S,Z_DEFLATED:P}=r(619),k=258,x=262,I=42,D=113,O=666,N=(e,t)=>(e.msg=l[t],t),M=e=>2*e-(e>4?9:0),L=e=>{let t=e.length;for(;--t>=0;)e[t]=0},U=e=>{let t,r,n,i=e.w_size;t=e.hash_size,n=t;do{r=e.head[--n],e.head[n]=r>=i?r-i:0}while(--t);t=i,n=t;do{r=e.prev[--n],e.prev[n]=r>=i?r-i:0}while(--t)};let j=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask;const z=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))},G=(e,t)=>{s(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,z(e.strm)},F=(e,t)=>{e.pending_buf[e.pending++]=t},V=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},W=(e,t,r,n)=>{let i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),1===e.state.wrap?e.adler=c(e.adler,t,i,r):2===e.state.wrap&&(e.adler=d(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},q=(e,t)=>{let r,n,i=e.max_chain_length,s=e.strstart,a=e.prev_length,o=e.nice_match;const c=e.strstart>e.w_size-x?e.strstart-(e.w_size-x):0,d=e.window,l=e.w_mask,p=e.prev,h=e.strstart+k;let u=d[s+a-1],f=d[s+a];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do{if(r=t,d[r+a]===f&&d[r+a-1]===u&&d[r]===d[s]&&d[++r]===d[s+1]){s+=2,r++;do{}while(d[++s]===d[++r]&&d[++s]===d[++r]&&d[++s]===d[++r]&&d[++s]===d[++r]&&d[++s]===d[++r]&&d[++s]===d[++r]&&d[++s]===d[++r]&&d[++s]===d[++r]&&s<h);if(n=k-(h-s),s=h-k,n>a){if(e.match_start=t,a=n,n>=o)break;u=d[s+a-1],f=d[s+a]}}}while((t=p[t&l])>c&&0!=--i);return a<=e.lookahead?a:e.lookahead},Z=e=>{const t=e.w_size;let r,n,i;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-x)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),U(e),n+=t),0===e.strm.avail_in)break;if(r=W(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=j(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=j(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<x&&0!==e.strm.avail_in)},B=(e,t)=>{let r,n,s,a=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,o=0,c=e.strm.avail_in;do{if(r=65535,s=e.bi_valid+42>>3,e.strm.avail_out<s)break;if(s=e.strm.avail_out-s,n=e.strstart-e.block_start,r>n+e.strm.avail_in&&(r=n+e.strm.avail_in),r>s&&(r=s),r<a&&(0===r&&t!==f||t===p||r!==n+e.strm.avail_in))break;o=t===f&&r===n+e.strm.avail_in?1:0,i(e,0,0,o),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,z(e.strm),n&&(n>r&&(n=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,r-=n),r&&(W(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(0===o);return c-=e.strm.avail_in,c&&(c>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=c&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-c,e.strm.next_in),e.strstart),e.strstart+=c,e.insert+=c>e.w_size-e.insert?e.w_size-e.insert:c),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?4:t!==p&&t!==f&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(s=e.window_size-e.strstart,e.strm.avail_in>s&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,s+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),s>e.strm.avail_in&&(s=e.strm.avail_in),s&&(W(e.strm,e.window,e.strstart,s),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.high_water<e.strstart&&(e.high_water=e.strstart),s=e.bi_valid+42>>3,s=e.pending_buf_size-s>65535?65535:e.pending_buf_size-s,a=s>e.w_size?e.w_size:s,n=e.strstart-e.block_start,(n>=a||(n||t===f)&&t!==p&&0===e.strm.avail_in&&n<=s)&&(r=n>s?s:n,o=t===f&&0===e.strm.avail_in&&r===n?1:0,i(e,e.block_start,r,o),e.block_start+=r,z(e.strm)),o?3:1)},H=(e,t)=>{let r,n;for(;;){if(e.lookahead<x){if(Z(e),e.lookahead<x&&t===p)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=j(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-x&&(e.match_length=q(e,r)),e.match_length>=3)if(n=a(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=j(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=j(e,e.ins_h,e.window[e.strstart+1]);else n=a(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(G(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===f?(G(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(G(e,!1),0===e.strm.avail_out)?1:2},K=(e,t)=>{let r,n,i;for(;;){if(e.lookahead<x){if(Z(e),e.lookahead<x&&t===p)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=j(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-x&&(e.match_length=q(e,r),e.match_length<=5&&(e.strategy===C||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,n=a(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=j(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(G(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(n=a(e,0,e.window[e.strstart-1]),n&&G(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=a(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===f?(G(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(G(e,!1),0===e.strm.avail_out)?1:2};function J(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}const $=[new J(0,0,0,0,B),new J(4,4,8,4,H),new J(4,5,16,8,H),new J(4,6,32,32,H),new J(4,4,16,16,K),new J(8,16,32,32,K),new J(8,16,128,128,K),new J(8,32,128,256,K),new J(32,128,258,1024,K),new J(32,258,258,4096,K)];function Y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=P,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),L(this.dyn_ltree),L(this.dyn_dtree),L(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),L(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),L(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const X=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==I&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==D&&t.status!==O?1:0},Q=e=>{if(X(e))return N(e,v);e.total_in=e.total_out=0,e.data_type=S;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?I:D,e.adler=2===t.wrap?0:1,t.last_flush=-2,n(t),_},ee=e=>{const t=Q(e);var r;return t===_&&((r=e.state).window_size=2*r.w_size,L(r.head),r.max_lazy_match=$[r.level].max_lazy,r.good_match=$[r.level].good_length,r.nice_match=$[r.level].nice_length,r.max_chain_length=$[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0),t},te=(e,t,r,n,i,s)=>{if(!e)return v;let a=1;if(t===T&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>9||r!==P||n<8||n>15||t<0||t>9||s<0||s>A||8===n&&1!==a)return N(e,v);8===n&&(n=9);const o=new Y;return e.state=o,o.strm=e,o.status=I,o.wrap=a,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=s,o.method=r,ee(e)};e.exports.deflateInit=(e,t)=>te(e,t,P,15,8,R),e.exports.deflateInit2=te,e.exports.deflateReset=ee,e.exports.deflateResetKeep=Q,e.exports.deflateSetHeader=(e,t)=>X(e)||2!==e.state.wrap?v:(e.state.gzhead=t,_),e.exports.deflate=(e,t)=>{if(X(e)||t>m||t<0)return e?N(e,v):v;const r=e.state;if(!e.output||0!==e.avail_in&&!e.input||r.status===O&&t!==f)return N(e,0===e.avail_out?y:v);const n=r.last_flush;if(r.last_flush=t,0!==r.pending){if(z(e),0===e.avail_out)return r.last_flush=-1,_}else if(0===e.avail_in&&M(t)<=M(n)&&t!==f)return N(e,y);if(r.status===O&&0!==e.avail_in)return N(e,y);if(r.status===I&&0===r.wrap&&(r.status=D),r.status===I){let t=P+(r.w_bits-8<<4)<<8,n=-1;if(n=r.strategy>=b||r.level<2?0:r.level<6?1:6===r.level?2:3,t|=n<<6,0!==r.strstart&&(t|=32),t+=31-t%31,V(r,t),0!==r.strstart&&(V(r,e.adler>>>16),V(r,65535&e.adler)),e.adler=1,r.status=D,z(e),0!==r.pending)return r.last_flush=-1,_}if(57===r.status)if(e.adler=0,F(r,31),F(r,139),F(r,8),r.gzhead)F(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),F(r,255&r.gzhead.time),F(r,r.gzhead.time>>8&255),F(r,r.gzhead.time>>16&255),F(r,r.gzhead.time>>24&255),F(r,9===r.level?2:r.strategy>=b||r.level<2?4:0),F(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(F(r,255&r.gzhead.extra.length),F(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=d(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(F(r,0),F(r,0),F(r,0),F(r,0),F(r,0),F(r,9===r.level?2:r.strategy>=b||r.level<2?4:0),F(r,3),r.status=D,z(e),0!==r.pending)return r.last_flush=-1,_;if(69===r.status){if(r.gzhead.extra){let t=r.pending,n=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+n>r.pending_buf_size;){let i=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>t&&(e.adler=d(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex+=i,z(e),0!==r.pending)return r.last_flush=-1,_;t=0,n-=i}let i=new Uint8Array(r.gzhead.extra);r.pending_buf.set(i.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending+=n,r.gzhead.hcrc&&r.pending>t&&(e.adler=d(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex=0}r.status=73}if(73===r.status){if(r.gzhead.name){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=d(e.adler,r.pending_buf,r.pending-n,n)),z(e),0!==r.pending)return r.last_flush=-1,_;n=0}t=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,F(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=d(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=91}if(91===r.status){if(r.gzhead.comment){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=d(e.adler,r.pending_buf,r.pending-n,n)),z(e),0!==r.pending)return r.last_flush=-1,_;n=0}t=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,F(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=d(e.adler,r.pending_buf,r.pending-n,n))}r.status=103}if(103===r.status){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(z(e),0!==r.pending))return r.last_flush=-1,_;F(r,255&e.adler),F(r,e.adler>>8&255),e.adler=0}if(r.status=D,z(e),0!==r.pending)return r.last_flush=-1,_}if(0!==e.avail_in||0!==r.lookahead||t!==p&&r.status!==O){let n=0===r.level?B(r,t):r.strategy===b?((e,t)=>{let r;for(;;){if(0===e.lookahead&&(Z(e),0===e.lookahead)){if(t===p)return 1;break}if(e.match_length=0,r=a(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(G(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===f?(G(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(G(e,!1),0===e.strm.avail_out)?1:2})(r,t):r.strategy===w?((e,t)=>{let r,n,i,s;const o=e.window;for(;;){if(e.lookahead<=k){if(Z(e),e.lookahead<=k&&t===p)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,n=o[i],n===o[++i]&&n===o[++i]&&n===o[++i])){s=e.strstart+k;do{}while(n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&i<s);e.match_length=k-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=a(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=a(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(G(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===f?(G(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(G(e,!1),0===e.strm.avail_out)?1:2})(r,t):$[r.level].func(r,t);if(3!==n&&4!==n||(r.status=O),1===n||3===n)return 0===e.avail_out&&(r.last_flush=-1),_;if(2===n&&(t===h?o(r):t!==m&&(i(r,0,0,!1),t===u&&(L(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),z(e),0===e.avail_out))return r.last_flush=-1,_}return t!==f?_:r.wrap<=0?g:(2===r.wrap?(F(r,255&e.adler),F(r,e.adler>>8&255),F(r,e.adler>>16&255),F(r,e.adler>>24&255),F(r,255&e.total_in),F(r,e.total_in>>8&255),F(r,e.total_in>>16&255),F(r,e.total_in>>24&255)):(V(r,e.adler>>>16),V(r,65535&e.adler)),z(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?_:g)},e.exports.deflateEnd=e=>{if(X(e))return v;const t=e.state.status;return e.state=null,t===D?N(e,E):_},e.exports.deflateSetDictionary=(e,t)=>{let r=t.length;if(X(e))return v;const n=e.state,i=n.wrap;if(2===i||1===i&&n.status!==I||n.lookahead)return v;if(1===i&&(e.adler=c(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){0===i&&(L(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(r-n.w_size,r),0),t=e,r=n.w_size}const s=e.avail_in,a=e.next_in,o=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Z(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do{n.ins_h=j(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=2,Z(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=a,e.input=o,e.avail_in=s,n.wrap=i,_},e.exports.deflateInfo="pako deflate (from Nodeca project)"},188:e=>{"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},264:e=>{"use strict";const t=16209;e.exports=function(e,r){let n,i,s,a,o,c,d,l,p,h,u,f,m,_,g,v,E,y,T,C,b,w,A,R;const S=e.state;n=e.next_in,A=e.input,i=n+(e.avail_in-5),s=e.next_out,R=e.output,a=s-(r-e.avail_out),o=s+(e.avail_out-257),c=S.dmax,d=S.wsize,l=S.whave,p=S.wnext,h=S.window,u=S.hold,f=S.bits,m=S.lencode,_=S.distcode,g=(1<<S.lenbits)-1,v=(1<<S.distbits)-1;e:do{f<15&&(u+=A[n++]<<f,f+=8,u+=A[n++]<<f,f+=8),E=m[u&g];t:for(;;){if(y=E>>>24,u>>>=y,f-=y,y=E>>>16&255,0===y)R[s++]=65535&E;else{if(!(16&y)){if(0==(64&y)){E=m[(65535&E)+(u&(1<<y)-1)];continue t}if(32&y){S.mode=16191;break e}e.msg="invalid literal/length code",S.mode=t;break e}T=65535&E,y&=15,y&&(f<y&&(u+=A[n++]<<f,f+=8),T+=u&(1<<y)-1,u>>>=y,f-=y),f<15&&(u+=A[n++]<<f,f+=8,u+=A[n++]<<f,f+=8),E=_[u&v];r:for(;;){if(y=E>>>24,u>>>=y,f-=y,y=E>>>16&255,!(16&y)){if(0==(64&y)){E=_[(65535&E)+(u&(1<<y)-1)];continue r}e.msg="invalid distance code",S.mode=t;break e}if(C=65535&E,y&=15,f<y&&(u+=A[n++]<<f,f+=8,f<y&&(u+=A[n++]<<f,f+=8)),C+=u&(1<<y)-1,C>c){e.msg="invalid distance too far back",S.mode=t;break e}if(u>>>=y,f-=y,y=s-a,C>y){if(y=C-y,y>l&&S.sane){e.msg="invalid distance too far back",S.mode=t;break e}if(b=0,w=h,0===p){if(b+=d-y,y<T){T-=y;do{R[s++]=h[b++]}while(--y);b=s-C,w=R}}else if(p<y){if(b+=d+p-y,y-=p,y<T){T-=y;do{R[s++]=h[b++]}while(--y);if(b=0,p<T){y=p,T-=y;do{R[s++]=h[b++]}while(--y);b=s-C,w=R}}}else if(b+=p-y,y<T){T-=y;do{R[s++]=h[b++]}while(--y);b=s-C,w=R}for(;T>2;)R[s++]=w[b++],R[s++]=w[b++],R[s++]=w[b++],T-=3;T&&(R[s++]=w[b++],T>1&&(R[s++]=w[b++]))}else{b=s-C;do{R[s++]=R[b++],R[s++]=R[b++],R[s++]=R[b++],T-=3}while(T>2);T&&(R[s++]=R[b++],T>1&&(R[s++]=R[b++]))}break}}break}}while(n<i&&s<o);T=f>>3,n-=T,f-=T<<3,u&=(1<<f)-1,e.next_in=n,e.next_out=s,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=s<o?o-s+257:257-(s-o),S.hold=u,S.bits=f}},948:(e,t,r)=>{"use strict";const n=r(69),i=r(869),s=r(264),a=r(241),{Z_FINISH:o,Z_BLOCK:c,Z_TREES:d,Z_OK:l,Z_STREAM_END:p,Z_NEED_DICT:h,Z_STREAM_ERROR:u,Z_DATA_ERROR:f,Z_MEM_ERROR:m,Z_BUF_ERROR:_,Z_DEFLATED:g}=r(619),v=16180,E=16190,y=16191,T=16192,C=16194,b=16199,w=16200,A=16206,R=16209,S=16210,P=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function k(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const x=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<v||t.mode>16211?1:0},I=e=>{if(x(e))return u;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=v,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,l},D=e=>{if(x(e))return u;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,I(e)},O=(e,t)=>{let r;if(x(e))return u;const n=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?u:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,D(e))},N=(e,t)=>{if(!e)return u;const r=new k;e.state=r,r.strm=e,r.window=null,r.mode=v;const n=O(e,t);return n!==l&&(e.state=null),n};let M,L,U=!0;const j=e=>{if(U){M=new Int32Array(512),L=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(1,e.lens,0,288,M,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(2,e.lens,0,32,L,0,e.work,{bits:5}),U=!1}e.lencode=M,e.lenbits=9,e.distcode=L,e.distbits=5},z=(e,t,r,n)=>{let i;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>n&&(i=n),s.window.set(t.subarray(r-n,r-n+i),s.wnext),(n-=i)?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0};e.exports.inflateReset=D,e.exports.inflateReset2=O,e.exports.inflateResetKeep=I,e.exports.inflateInit=e=>N(e,15),e.exports.inflateInit2=N,e.exports.inflate=(e,t)=>{let r,k,I,D,O,N,M,L,U,G,F,V,W,q,Z,B,H,K,J,$,Y,X,Q=0;const ee=new Uint8Array(4);let te,re;const ne=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(x(e)||!e.output||!e.input&&0!==e.avail_in)return u;r=e.state,r.mode===y&&(r.mode=T),O=e.next_out,I=e.output,M=e.avail_out,D=e.next_in,k=e.input,N=e.avail_in,L=r.hold,U=r.bits,G=N,F=M,X=l;e:for(;;)switch(r.mode){case v:if(0===r.wrap){r.mode=T;break}for(;U<16;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}if(2&r.wrap&&35615===L){0===r.wbits&&(r.wbits=15),r.check=0,ee[0]=255&L,ee[1]=L>>>8&255,r.check=i(r.check,ee,2,0),L=0,U=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&L)<<8)+(L>>8))%31){e.msg="incorrect header check",r.mode=R;break}if((15&L)!==g){e.msg="unknown compression method",r.mode=R;break}if(L>>>=4,U-=4,Y=8+(15&L),0===r.wbits&&(r.wbits=Y),Y>15||Y>r.wbits){e.msg="invalid window size",r.mode=R;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&L?16189:y,L=0,U=0;break;case 16181:for(;U<16;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}if(r.flags=L,(255&r.flags)!==g){e.msg="unknown compression method",r.mode=R;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=R;break}r.head&&(r.head.text=L>>8&1),512&r.flags&&4&r.wrap&&(ee[0]=255&L,ee[1]=L>>>8&255,r.check=i(r.check,ee,2,0)),L=0,U=0,r.mode=16182;case 16182:for(;U<32;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}r.head&&(r.head.time=L),512&r.flags&&4&r.wrap&&(ee[0]=255&L,ee[1]=L>>>8&255,ee[2]=L>>>16&255,ee[3]=L>>>24&255,r.check=i(r.check,ee,4,0)),L=0,U=0,r.mode=16183;case 16183:for(;U<16;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}r.head&&(r.head.xflags=255&L,r.head.os=L>>8),512&r.flags&&4&r.wrap&&(ee[0]=255&L,ee[1]=L>>>8&255,r.check=i(r.check,ee,2,0)),L=0,U=0,r.mode=16184;case 16184:if(1024&r.flags){for(;U<16;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}r.length=L,r.head&&(r.head.extra_len=L),512&r.flags&&4&r.wrap&&(ee[0]=255&L,ee[1]=L>>>8&255,r.check=i(r.check,ee,2,0)),L=0,U=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(V=r.length,V>N&&(V=N),V&&(r.head&&(Y=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(k.subarray(D,D+V),Y)),512&r.flags&&4&r.wrap&&(r.check=i(r.check,k,V,D)),N-=V,D+=V,r.length-=V),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===N)break e;V=0;do{Y=k[D+V++],r.head&&Y&&r.length<65536&&(r.head.name+=String.fromCharCode(Y))}while(Y&&V<N);if(512&r.flags&&4&r.wrap&&(r.check=i(r.check,k,V,D)),N-=V,D+=V,Y)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===N)break e;V=0;do{Y=k[D+V++],r.head&&Y&&r.length<65536&&(r.head.comment+=String.fromCharCode(Y))}while(Y&&V<N);if(512&r.flags&&4&r.wrap&&(r.check=i(r.check,k,V,D)),N-=V,D+=V,Y)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;U<16;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}if(4&r.wrap&&L!==(65535&r.check)){e.msg="header crc mismatch",r.mode=R;break}L=0,U=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=y;break;case 16189:for(;U<32;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}e.adler=r.check=P(L),L=0,U=0,r.mode=E;case E:if(0===r.havedict)return e.next_out=O,e.avail_out=M,e.next_in=D,e.avail_in=N,r.hold=L,r.bits=U,h;e.adler=r.check=1,r.mode=y;case y:if(t===c||t===d)break e;case T:if(r.last){L>>>=7&U,U-=7&U,r.mode=A;break}for(;U<3;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}switch(r.last=1&L,L>>>=1,U-=1,3&L){case 0:r.mode=16193;break;case 1:if(j(r),r.mode=b,t===d){L>>>=2,U-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=R}L>>>=2,U-=2;break;case 16193:for(L>>>=7&U,U-=7&U;U<32;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}if((65535&L)!=(L>>>16^65535)){e.msg="invalid stored block lengths",r.mode=R;break}if(r.length=65535&L,L=0,U=0,r.mode=C,t===d)break e;case C:r.mode=16195;case 16195:if(V=r.length,V){if(V>N&&(V=N),V>M&&(V=M),0===V)break e;I.set(k.subarray(D,D+V),O),N-=V,D+=V,M-=V,O+=V,r.length-=V;break}r.mode=y;break;case 16196:for(;U<14;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}if(r.nlen=257+(31&L),L>>>=5,U-=5,r.ndist=1+(31&L),L>>>=5,U-=5,r.ncode=4+(15&L),L>>>=4,U-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=R;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;U<3;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}r.lens[ne[r.have++]]=7&L,L>>>=3,U-=3}for(;r.have<19;)r.lens[ne[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,te={bits:r.lenbits},X=a(0,r.lens,0,19,r.lencode,0,r.work,te),r.lenbits=te.bits,X){e.msg="invalid code lengths set",r.mode=R;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;Q=r.lencode[L&(1<<r.lenbits)-1],Z=Q>>>24,B=Q>>>16&255,H=65535&Q,!(Z<=U);){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}if(H<16)L>>>=Z,U-=Z,r.lens[r.have++]=H;else{if(16===H){for(re=Z+2;U<re;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}if(L>>>=Z,U-=Z,0===r.have){e.msg="invalid bit length repeat",r.mode=R;break}Y=r.lens[r.have-1],V=3+(3&L),L>>>=2,U-=2}else if(17===H){for(re=Z+3;U<re;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}L>>>=Z,U-=Z,Y=0,V=3+(7&L),L>>>=3,U-=3}else{for(re=Z+7;U<re;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}L>>>=Z,U-=Z,Y=0,V=11+(127&L),L>>>=7,U-=7}if(r.have+V>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=R;break}for(;V--;)r.lens[r.have++]=Y}}if(r.mode===R)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=R;break}if(r.lenbits=9,te={bits:r.lenbits},X=a(1,r.lens,0,r.nlen,r.lencode,0,r.work,te),r.lenbits=te.bits,X){e.msg="invalid literal/lengths set",r.mode=R;break}if(r.distbits=6,r.distcode=r.distdyn,te={bits:r.distbits},X=a(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,te),r.distbits=te.bits,X){e.msg="invalid distances set",r.mode=R;break}if(r.mode=b,t===d)break e;case b:r.mode=w;case w:if(N>=6&&M>=258){e.next_out=O,e.avail_out=M,e.next_in=D,e.avail_in=N,r.hold=L,r.bits=U,s(e,F),O=e.next_out,I=e.output,M=e.avail_out,D=e.next_in,k=e.input,N=e.avail_in,L=r.hold,U=r.bits,r.mode===y&&(r.back=-1);break}for(r.back=0;Q=r.lencode[L&(1<<r.lenbits)-1],Z=Q>>>24,B=Q>>>16&255,H=65535&Q,!(Z<=U);){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}if(B&&0==(240&B)){for(K=Z,J=B,$=H;Q=r.lencode[$+((L&(1<<K+J)-1)>>K)],Z=Q>>>24,B=Q>>>16&255,H=65535&Q,!(K+Z<=U);){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}L>>>=K,U-=K,r.back+=K}if(L>>>=Z,U-=Z,r.back+=Z,r.length=H,0===B){r.mode=16205;break}if(32&B){r.back=-1,r.mode=y;break}if(64&B){e.msg="invalid literal/length code",r.mode=R;break}r.extra=15&B,r.mode=16201;case 16201:if(r.extra){for(re=r.extra;U<re;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}r.length+=L&(1<<r.extra)-1,L>>>=r.extra,U-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;Q=r.distcode[L&(1<<r.distbits)-1],Z=Q>>>24,B=Q>>>16&255,H=65535&Q,!(Z<=U);){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}if(0==(240&B)){for(K=Z,J=B,$=H;Q=r.distcode[$+((L&(1<<K+J)-1)>>K)],Z=Q>>>24,B=Q>>>16&255,H=65535&Q,!(K+Z<=U);){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}L>>>=K,U-=K,r.back+=K}if(L>>>=Z,U-=Z,r.back+=Z,64&B){e.msg="invalid distance code",r.mode=R;break}r.offset=H,r.extra=15&B,r.mode=16203;case 16203:if(r.extra){for(re=r.extra;U<re;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}r.offset+=L&(1<<r.extra)-1,L>>>=r.extra,U-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=R;break}r.mode=16204;case 16204:if(0===M)break e;if(V=F-M,r.offset>V){if(V=r.offset-V,V>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=R;break}V>r.wnext?(V-=r.wnext,W=r.wsize-V):W=r.wnext-V,V>r.length&&(V=r.length),q=r.window}else q=I,W=O-r.offset,V=r.length;V>M&&(V=M),M-=V,r.length-=V;do{I[O++]=q[W++]}while(--V);0===r.length&&(r.mode=w);break;case 16205:if(0===M)break e;I[O++]=r.length,M--,r.mode=w;break;case A:if(r.wrap){for(;U<32;){if(0===N)break e;N--,L|=k[D++]<<U,U+=8}if(F-=M,e.total_out+=F,r.total+=F,4&r.wrap&&F&&(e.adler=r.check=r.flags?i(r.check,I,F,O-F):n(r.check,I,F,O-F)),F=M,4&r.wrap&&(r.flags?L:P(L))!==r.check){e.msg="incorrect data check",r.mode=R;break}L=0,U=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;U<32;){if(0===N)break e;N--,L+=k[D++]<<U,U+=8}if(4&r.wrap&&L!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=R;break}L=0,U=0}r.mode=16208;case 16208:X=p;break e;case R:X=f;break e;case S:return m;default:return u}return e.next_out=O,e.avail_out=M,e.next_in=D,e.avail_in=N,r.hold=L,r.bits=U,(r.wsize||F!==e.avail_out&&r.mode<R&&(r.mode<A||t!==o))&&z(e,e.output,e.next_out,F-e.avail_out)?(r.mode=S,m):(G-=e.avail_in,F-=e.avail_out,e.total_in+=G,e.total_out+=F,r.total+=F,4&r.wrap&&F&&(e.adler=r.check=r.flags?i(r.check,I,F,e.next_out-F):n(r.check,I,F,e.next_out-F)),e.data_type=r.bits+(r.last?64:0)+(r.mode===y?128:0)+(r.mode===b||r.mode===C?256:0),(0===G&&0===F||t===o)&&X===l&&(X=_),X)},e.exports.inflateEnd=e=>{if(x(e))return u;let t=e.state;return t.window&&(t.window=null),e.state=null,l},e.exports.inflateGetHeader=(e,t)=>{if(x(e))return u;const r=e.state;return 0==(2&r.wrap)?u:(r.head=t,t.done=!1,l)},e.exports.inflateSetDictionary=(e,t)=>{const r=t.length;let i,s,a;return x(e)?u:(i=e.state,0!==i.wrap&&i.mode!==E?u:i.mode===E&&(s=1,s=n(s,t,r,0),s!==i.check)?f:(a=z(e,t,r,r),a?(i.mode=S,m):(i.havedict=1,l)))},e.exports.inflateInfo="pako inflate (from Nodeca project)"},241:e=>{"use strict";const t=15,r=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),n=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),i=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),s=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);e.exports=(e,a,o,c,d,l,p,h)=>{const u=h.bits;let f,m,_,g,v,E,y=0,T=0,C=0,b=0,w=0,A=0,R=0,S=0,P=0,k=0,x=null;const I=new Uint16Array(16),D=new Uint16Array(16);let O,N,M,L=null;for(y=0;y<=t;y++)I[y]=0;for(T=0;T<c;T++)I[a[o+T]]++;for(w=u,b=t;b>=1&&0===I[b];b--);if(w>b&&(w=b),0===b)return d[l++]=20971520,d[l++]=20971520,h.bits=1,0;for(C=1;C<b&&0===I[C];C++);for(w<C&&(w=C),S=1,y=1;y<=t;y++)if(S<<=1,S-=I[y],S<0)return-1;if(S>0&&(0===e||1!==b))return-1;for(D[1]=0,y=1;y<t;y++)D[y+1]=D[y]+I[y];for(T=0;T<c;T++)0!==a[o+T]&&(p[D[a[o+T]]++]=T);if(0===e?(x=L=p,E=20):1===e?(x=r,L=n,E=257):(x=i,L=s,E=0),k=0,T=0,y=C,v=l,A=w,R=0,_=-1,P=1<<w,g=P-1,1===e&&P>852||2===e&&P>592)return 1;for(;;){O=y-R,p[T]+1<E?(N=0,M=p[T]):p[T]>=E?(N=L[p[T]-E],M=x[p[T]-E]):(N=96,M=0),f=1<<y-R,m=1<<A,C=m;do{m-=f,d[v+(k>>R)+m]=O<<24|N<<16|M|0}while(0!==m);for(f=1<<y-1;k&f;)f>>=1;if(0!==f?(k&=f-1,k+=f):k=0,T++,0==--I[y]){if(y===b)break;y=a[o+p[T]]}if(y>w&&(k&g)!==_){for(0===R&&(R=w),v+=C,A=y-R,S=1<<A;A+R<b&&(S-=I[A+R],!(S<=0));)A++,S<<=1;if(P+=1<<A,1===e&&P>852||2===e&&P>592)return 1;_=k&g,d[_]=w<<24|A<<16|v-l|0}}return 0!==k&&(d[v+k]=y-R<<24|64<<16|0),h.bits=w,0}},898:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},342:e=>{"use strict";function t(e){let t=e.length;for(;--t>=0;)e[t]=0}const r=256,n=286,i=30,s=15,a=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),o=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),c=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),d=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=new Array(576);t(l);const p=new Array(60);t(p);const h=new Array(512);t(h);const u=new Array(256);t(u);const f=new Array(29);t(f);const m=new Array(i);function _(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}let g,v,E;function y(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}t(m);const T=e=>e<256?h[e]:h[256+(e>>>7)],C=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},b=(e,t,r)=>{e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,C(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},w=(e,t,r)=>{b(e,r[2*t],r[2*t+1])},A=(e,t)=>{let r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1},R=(e,t,r)=>{const n=new Array(16);let i,a,o=0;for(i=1;i<=s;i++)o=o+r[i-1]<<1,n[i]=o;for(a=0;a<=t;a++){let t=e[2*a+1];0!==t&&(e[2*a]=A(n[t]++,t))}},S=e=>{let t;for(t=0;t<n;t++)e.dyn_ltree[2*t]=0;for(t=0;t<i;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},P=e=>{e.bi_valid>8?C(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},k=(e,t,r,n)=>{const i=2*t,s=2*r;return e[i]<e[s]||e[i]===e[s]&&n[t]<=n[r]},x=(e,t,r)=>{const n=e.heap[r];let i=r<<1;for(;i<=e.heap_len&&(i<e.heap_len&&k(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!k(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n},I=(e,t,n)=>{let i,s,c,d,l=0;if(0!==e.sym_next)do{i=255&e.pending_buf[e.sym_buf+l++],i+=(255&e.pending_buf[e.sym_buf+l++])<<8,s=e.pending_buf[e.sym_buf+l++],0===i?w(e,s,t):(c=u[s],w(e,c+r+1,t),d=a[c],0!==d&&(s-=f[c],b(e,s,d)),i--,c=T(i),w(e,c,n),d=o[c],0!==d&&(i-=m[c],b(e,i,d)))}while(l<e.sym_next);w(e,256,t)},D=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.elems;let o,c,d,l=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<a;o++)0!==r[2*o]?(e.heap[++e.heap_len]=l=o,e.depth[o]=0):r[2*o+1]=0;for(;e.heap_len<2;)d=e.heap[++e.heap_len]=l<2?++l:0,r[2*d]=1,e.depth[d]=0,e.opt_len--,i&&(e.static_len-=n[2*d+1]);for(t.max_code=l,o=e.heap_len>>1;o>=1;o--)x(e,r,o);d=a;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],x(e,r,1),c=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=c,r[2*d]=r[2*o]+r[2*c],e.depth[d]=(e.depth[o]>=e.depth[c]?e.depth[o]:e.depth[c])+1,r[2*o+1]=r[2*c+1]=d,e.heap[1]=d++,x(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const r=t.dyn_tree,n=t.max_code,i=t.stat_desc.static_tree,a=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,c=t.stat_desc.extra_base,d=t.stat_desc.max_length;let l,p,h,u,f,m,_=0;for(u=0;u<=s;u++)e.bl_count[u]=0;for(r[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)p=e.heap[l],u=r[2*r[2*p+1]+1]+1,u>d&&(u=d,_++),r[2*p+1]=u,p>n||(e.bl_count[u]++,f=0,p>=c&&(f=o[p-c]),m=r[2*p],e.opt_len+=m*(u+f),a&&(e.static_len+=m*(i[2*p+1]+f)));if(0!==_){do{for(u=d-1;0===e.bl_count[u];)u--;e.bl_count[u]--,e.bl_count[u+1]+=2,e.bl_count[d]--,_-=2}while(_>0);for(u=d;0!==u;u--)for(p=e.bl_count[u];0!==p;)h=e.heap[--l],h>n||(r[2*h+1]!==u&&(e.opt_len+=(u-r[2*h+1])*r[2*h],r[2*h+1]=u),p--)}})(e,t),R(r,l,e.bl_count)},O=(e,t,r)=>{let n,i,s=-1,a=t[1],o=0,c=7,d=4;for(0===a&&(c=138,d=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++o<c&&i===a||(o<d?e.bl_tree[2*i]+=o:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,s=i,0===a?(c=138,d=3):i===a?(c=6,d=3):(c=7,d=4))},N=(e,t,r)=>{let n,i,s=-1,a=t[1],o=0,c=7,d=4;for(0===a&&(c=138,d=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++o<c&&i===a)){if(o<d)do{w(e,i,e.bl_tree)}while(0!=--o);else 0!==i?(i!==s&&(w(e,i,e.bl_tree),o--),w(e,16,e.bl_tree),b(e,o-3,2)):o<=10?(w(e,17,e.bl_tree),b(e,o-3,3)):(w(e,18,e.bl_tree),b(e,o-11,7));o=0,s=i,0===a?(c=138,d=3):i===a?(c=6,d=3):(c=7,d=4)}};let M=!1;const L=(e,t,r,n)=>{b(e,0+(n?1:0),3),P(e),C(e,r),C(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r};e.exports._tr_init=e=>{M||((()=>{let e,t,r,d,y;const T=new Array(16);for(r=0,d=0;d<28;d++)for(f[d]=r,e=0;e<1<<a[d];e++)u[r++]=d;for(u[r-1]=d,y=0,d=0;d<16;d++)for(m[d]=y,e=0;e<1<<o[d];e++)h[y++]=d;for(y>>=7;d<i;d++)for(m[d]=y<<7,e=0;e<1<<o[d]-7;e++)h[256+y++]=d;for(t=0;t<=s;t++)T[t]=0;for(e=0;e<=143;)l[2*e+1]=8,e++,T[8]++;for(;e<=255;)l[2*e+1]=9,e++,T[9]++;for(;e<=279;)l[2*e+1]=7,e++,T[7]++;for(;e<=287;)l[2*e+1]=8,e++,T[8]++;for(R(l,287,T),e=0;e<i;e++)p[2*e+1]=5,p[2*e]=A(e,5);g=new _(l,a,257,n,s),v=new _(p,o,0,i,s),E=new _(new Array(0),c,0,19,7)})(),M=!0),e.l_desc=new y(e.dyn_ltree,g),e.d_desc=new y(e.dyn_dtree,v),e.bl_desc=new y(e.bl_tree,E),e.bi_buf=0,e.bi_valid=0,S(e)},e.exports._tr_stored_block=L,e.exports._tr_flush_block=(e,t,n,i)=>{let s,a,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<r;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),D(e,e.l_desc),D(e,e.d_desc),o=(e=>{let t;for(O(e,e.dyn_ltree,e.l_desc.max_code),O(e,e.dyn_dtree,e.d_desc.max_code),D(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*d[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),s=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=s&&(s=a)):s=a=n+5,n+4<=s&&-1!==t?L(e,t,n,i):4===e.strategy||a===s?(b(e,2+(i?1:0),3),I(e,l,p)):(b(e,4+(i?1:0),3),((e,t,r,n)=>{let i;for(b(e,t-257,5),b(e,r-1,5),b(e,n-4,4),i=0;i<n;i++)b(e,e.bl_tree[2*d[i]+1],3);N(e,e.dyn_ltree,t-1),N(e,e.dyn_dtree,r-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),I(e,e.dyn_ltree,e.dyn_dtree)),S(e),i&&P(e)},e.exports._tr_tally=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(u[n]+r+1)]++,e.dyn_dtree[2*T(t)]++),e.sym_next===e.sym_end),e.exports._tr_align=e=>{b(e,2,3),w(e,256,l),(e=>{16===e.bi_valid?(C(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},292:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},539:e=>{"use strict";const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const r=t.splitSections(e);return r&&r[0]},t.getMediaSections=function(e){const r=t.splitSections(e);return r.shift(),r},t.matchPrefix=function(e,r){return t.splitLines(e).filter((e=>0===e.indexOf(r)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const r={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let e=8;e<t.length;e+=2)switch(t[e]){case"raddr":r.relatedAddress=t[e+1];break;case"rport":r.relatedPort=parseInt(t[e+1],10);break;case"tcptype":r.tcpType=t[e+1];break;case"ufrag":r.ufrag=t[e+1],r.usernameFragment=t[e+1];break;default:void 0===r[t[e]]&&(r[t[e]]=t[e+1])}return r},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const r=e.component;"rtp"===r?t.push(1):"rtcp"===r?t.push(2):t.push(r),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let r;const n=e.substring(e.indexOf(" ")+1).split(";");for(let e=0;e<n.length;e++)r=n[e].trim().split("="),t[r[0].trim()]=r[1];return t},t.writeFmtp=function(e){let t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const n=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),r={ssrc:parseInt(e.substring(7,t),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substring(t+1,n),r.value=e.substring(n+1)):r.attribute=e.substring(t+1),r},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const r=t.matchPrefix(e,"a=mid:")[0];if(r)return r.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,r){return{role:"auto",fingerprints:t.matchPrefix(e+r,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,r){return t.matchPrefix(e+r,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,r){const n=t.matchPrefix(e+r,"a=ice-ufrag:")[0],i=t.matchPrefix(e+r,"a=ice-pwd:")[0];return n&&i?{usernameFragment:n.substring(12),password:i.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(e)[0].split(" ");r.profile=n[2];for(let i=3;i<n.length;i++){const s=n[i],a=t.matchPrefix(e,"a=rtpmap:"+s+" ")[0];if(a){const n=t.parseRtpMap(a),i=t.matchPrefix(e,"a=fmtp:"+s+" ");switch(n.parameters=i.length?t.parseFmtp(i[0]):{},n.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+s+" ").map(t.parseRtcpFb),r.codecs.push(n),n.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(n.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach((e=>{r.headerExtensions.push(t.parseExtmap(e))}));const i=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return r.codecs.forEach((e=>{i.forEach((t=>{e.rtcpFeedback.find((e=>e.type===t.type&&e.parameter===t.parameter))||e.rtcpFeedback.push(t)}))})),r},t.writeRtpDescription=function(e,r){let n="";n+="m="+e+" ",n+=r.codecs.length>0?"9":"0",n+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",n+=r.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",r.codecs.forEach((e=>{n+=t.writeRtpMap(e),n+=t.writeFmtp(e),n+=t.writeRtcpFb(e)}));let i=0;return r.codecs.forEach((e=>{e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),r.headerExtensions&&r.headerExtensions.forEach((e=>{n+=t.writeExtmap(e)})),n},t.parseRtpEncodingParameters=function(e){const r=[],n=t.parseRtpParameters(e),i=-1!==n.fecMechanisms.indexOf("RED"),s=-1!==n.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),o=a.length>0&&a[0].ssrc;let c;const d=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substring(17).split(" ").map((e=>parseInt(e,10)))));d.length>0&&d[0].length>1&&d[0][0]===o&&(c=d[0][1]),n.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:o,codecPayloadType:parseInt(e.parameters.apt,10)};o&&c&&(t.rtx={ssrc:c}),r.push(t),i&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:o,mechanism:s?"red+ulpfec":"red"},r.push(t))}})),0===r.length&&o&&r.push({ssrc:o});let l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substring(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substring(5),10)*.95-16e3:void 0,r.forEach((e=>{e.maxBitrate=l}))),r},t.parseRtcpParameters=function(e){const r={},n=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];n&&(r.cname=n.value,r.ssrc=n.ssrc);const i=t.matchPrefix(e,"a=rtcp-rsize");r.reducedSize=i.length>0,r.compound=0===i.length;const s=t.matchPrefix(e,"a=rtcp-mux");return r.mux=s.length>0,r},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let r;const n=t.matchPrefix(e,"a=msid:");if(1===n.length)return r=n[0].substring(7).split(" "),{stream:r[0],track:r[1]};const i=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return i.length>0?(r=i[0].value.split(" "),{stream:r[0],track:r[1]}):void 0},t.parseSctpDescription=function(e){const r=t.parseMLine(e),n=t.matchPrefix(e,"a=max-message-size:");let i;n.length>0&&(i=parseInt(n[0].substring(19),10)),isNaN(i)&&(i=65536);const s=t.matchPrefix(e,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:r.fmt,maxMessageSize:i};const a=t.matchPrefix(e,"a=sctpmap:");if(a.length>0){const e=a[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:i}}},t.writeSctpDescription=function(e,t){let r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,r,n){let i;const s=void 0!==r?r:2;i=e||t.generateSessionId();return"v=0\r\no="+(n||"thisisadapterortc")+" "+i+" "+s+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,r){const n=t.splitLines(e);for(let e=0;e<n.length;e++)switch(n[e]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[e].substring(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const r=t.splitLines(e)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},t.parseOLine=function(e){const r=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const r=t.splitLines(e);for(let e=0;e<r.length;e++)if(r[e].length<2||"="!==r[e].charAt(1))return!1;return!0},e.exports=t},86:(e,t,r)=>{"use strict";t.Z=void 0;var n=(0,r(338).adapterFactory)({window:"undefined"==typeof window?void 0:window});t.Z=n},338:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.adapterFactory=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},r=i.log,n=i.detectBrowser(e),l={browserDetails:n,commonShim:c,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings,sdp:d};switch(n.browser){case"chrome":if(!s||!s.shimPeerConnection||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),l;if(null===n.version)return r("Chrome shim can not determine version, not shimming."),l;r("adapter.js shimming chrome."),l.browserShim=s,c.shimAddIceCandidateNullOrEmpty(e,n),c.shimParameterlessSetLocalDescription(e,n),s.shimGetUserMedia(e,n),s.shimMediaStream(e,n),s.shimPeerConnection(e,n),s.shimOnTrack(e,n),s.shimAddTrackRemoveTrack(e,n),s.shimGetSendersWithDtmf(e,n),s.shimGetStats(e,n),s.shimSenderReceiverGetStats(e,n),s.fixNegotiationNeeded(e,n),c.shimRTCIceCandidate(e,n),c.shimRTCIceCandidateRelayProtocol(e,n),c.shimConnectionState(e,n),c.shimMaxMessageSize(e,n),c.shimSendThrowTypeError(e,n),c.removeExtmapAllowMixed(e,n);break;case"firefox":if(!a||!a.shimPeerConnection||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),l;r("adapter.js shimming firefox."),l.browserShim=a,c.shimAddIceCandidateNullOrEmpty(e,n),c.shimParameterlessSetLocalDescription(e,n),a.shimGetUserMedia(e,n),a.shimPeerConnection(e,n),a.shimOnTrack(e,n),a.shimRemoveStream(e,n),a.shimSenderGetStats(e,n),a.shimReceiverGetStats(e,n),a.shimRTCDataChannel(e,n),a.shimAddTransceiver(e,n),a.shimGetParameters(e,n),a.shimCreateOffer(e,n),a.shimCreateAnswer(e,n),c.shimRTCIceCandidate(e,n),c.shimConnectionState(e,n),c.shimMaxMessageSize(e,n),c.shimSendThrowTypeError(e,n);break;case"safari":if(!o||!t.shimSafari)return r("Safari shim is not included in this adapter release."),l;r("adapter.js shimming safari."),l.browserShim=o,c.shimAddIceCandidateNullOrEmpty(e,n),c.shimParameterlessSetLocalDescription(e,n),o.shimRTCIceServerUrls(e,n),o.shimCreateOfferLegacy(e,n),o.shimCallbacksAPI(e,n),o.shimLocalStreamsAPI(e,n),o.shimRemoteStreamsAPI(e,n),o.shimTrackEventTransceiver(e,n),o.shimGetUserMedia(e,n),o.shimAudioContext(e,n),c.shimRTCIceCandidate(e,n),c.shimRTCIceCandidateRelayProtocol(e,n),c.shimMaxMessageSize(e,n),c.shimSendThrowTypeError(e,n),c.removeExtmapAllowMixed(e,n);break;default:r("Unsupported browser!")}return l};var i=p(r(288)),s=p(r(30)),a=p(r(311)),o=p(r(540)),c=p(r(401)),d=p(r(539));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}function p(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var r=l(t);if(r&&r.has(e))return r.get(e);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=s?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(i,a,o):i[a]=e[a]}return i.default=e,r&&r.set(e,i),i}},30:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fixNegotiationNeeded=function(e,t){n.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){var r=e.target;if(!(t.version<72||r.getConfiguration&&"plan-b"===r.getConfiguration().sdpSemantics)||"stable"===r.signalingState)return e}))},t.shimAddTrackRemoveTrack=function(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return d(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(r.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}n.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;function s(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(i.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:r})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var s=this._streams[r.id];if(s)s.addTrack(t),Promise.resolve().then((function(){n.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new e.MediaStream([t]);this._streams[r.id]=a,this._reverseStreams[a.id]=r,this.addStream(a)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=o({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[function(r){var n=s(e,r);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then((function(t){return s(e,t)}))}));e.RTCPeerConnection.prototype[t]=n[t]}));var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,r=(t=arguments[0]).sdp,Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:r})),a.apply(this,arguments)):a.apply(this,arguments);var e,t,r};var c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=c.get.apply(this);return""===e.type?e:s(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(n){r._streams[n].getTracks().find((function(t){return e.track===t}))&&(t=r._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}},t.shimAddTrackRemoveTrackWithNative=d,Object.defineProperty(t,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}}),t.shimGetSendersWithDtmf=function(e){if("object"===c(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){r._senders.push(t(r,e))}))};var s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],s.apply(this,[e]),e.getTracks().forEach((function(e){var r=t._senders.find((function(t){return t.track===e}));r&&t._senders.splice(t._senders.indexOf(r),1)}))}}else if("object"===c(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},t.shimGetStats=function(e){if(!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,r=Array.prototype.slice.call(arguments),n=r[0],i=r[1],s=r[2];if(arguments.length>0&&"function"==typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof n))return t.apply(this,[]);var a=function(e){var t={};return e.result().forEach((function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){r[t]=e.stat(t)})),t[r.id]=r})),t},o=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){return t.apply(this,[function(e){i(o(a(e)))},n])}return new Promise((function(r,n){t.apply(e,[function(e){r(o(a(e)))},n])})).then(i,s)}},Object.defineProperty(t,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),t.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},t.shimOnTrack=function(e){if("object"===c(e)&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.track.id})):{track:n.track};var s=new Event("track");s.track=n.track,s.receiver=i,s.transceiver={receiver:i},s.streams=[t.stream],r.dispatchEvent(s)})),t.stream.getTracks().forEach((function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.id})):{track:n};var s=new Event("track");s.track=n,s.receiver=i,s.transceiver={receiver:i},s.streams=[t.stream],r.dispatchEvent(s)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else n.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))},t.shimPeerConnection=function(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection);if(!e.RTCPeerConnection)return;t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=o({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]}))},t.shimSenderReceiverGetStats=function(e){if(!("object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return n.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;i&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),n.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return n.filterStats(t,e.track,!1)}))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;var s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,r,n,i=arguments[0];return this.getSenders().forEach((function(e){e.track===i&&(t?n=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===i&&(r?n=!0:r=e),e.track===i})),n||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return s.apply(this,arguments)}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(n,s,o):n[s]=e[s]}n.default=e,r&&r.set(e,n);return n}(r(288)),i=r(87),s=r(688);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}function o(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===c(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function d(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var n=this.getSenders();r.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===n.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]})),i.apply(this,arguments)}}},688:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shimGetDisplayMedia=function(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;if(!e.navigator.mediaDevices)return;if("function"!=typeof t)return void console.error("shimGetDisplayMedia: getSourceId argument is not a function");e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((function(t){var n=r.video&&r.video.width,i=r.video&&r.video.height,s=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:s||3}},n&&(r.video.mandatory.maxWidth=n),i&&(r.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(r)}))}}},87:(e,t,r)=>{"use strict";function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.shimGetUserMedia=function(e,t){var r=e&&e.navigator;if(!r.mediaDevices)return;var n=function(e){if("object"!==i(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n="object"===i(e[r])?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var s=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var a={};"number"==typeof n.ideal?(a[s("min",r)]=n.ideal,t.optional.push(a),(a={})[s("max",r)]=n.ideal,t.optional.push(a)):(a[s("",r)]=n.ideal,t.optional.push(a))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[s("",r)]=n.exact):["min","max"].forEach((function(e){void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[s(e,r)]=n[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},a=function(e,a){if(t.version>=61)return a(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)){var o=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};o((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"===i(e.video)){var c=e.video.facingMode;c=c&&("object"===i(c)?c:{ideal:c});var d,l=t.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||l))if(delete e.video.facingMode,"environment"===c.exact||"environment"===c.ideal?d=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(d=["front"]),d)return r.mediaDevices.enumerateDevices().then((function(t){var r=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return d.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!r&&t.length&&d.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=c.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=n(e.video),s("chrome: "+JSON.stringify(e)),a(e)}));e.video=n(e.video)}return s("chrome: "+JSON.stringify(e)),a(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=function(e,t,n){a(e,(function(e){r.webkitGetUserMedia(e,t,(function(e){n&&n(o(e))}))}))}.bind(r),r.mediaDevices.getUserMedia){var c=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return a(e,(function(e){return c(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(o(e))}))}))}}};var s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var s={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var c=a?Object.getOwnPropertyDescriptor(e,o):null;c&&(c.get||c.set)?Object.defineProperty(s,o,c):s[o]=e[o]}s.default=e,r&&r.set(e,s);return s}(r(288)).log},401:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeExtmapAllowMixed=function(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var n=t.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return r.apply(this,arguments)}},t.shimAddIceCandidateNullOrEmpty=function(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;var r=e.RTCPeerConnection.prototype.addIceCandidate;if(!r||0===r.length)return;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},t.shimConnectionState=function(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))},t.shimMaxMessageSize=function(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e,n;(this._sctp=null,"chrome"===t.browser&&t.version>=76)&&("plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}));if(function(e){if(!e||!e.sdp)return!1;var t=i.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=i.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){var s,a=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),o=(e=a,n=65536,"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n),c=function(e,r){var n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);var s=i.default.matchPrefix(e.sdp,"a=max-message-size:");return s.length>0?n=parseInt(s[0].substring(19),10):"firefox"===t.browser&&-1!==r&&(n=2147483637),n}(arguments[0],a);s=0===o&&0===c?Number.POSITIVE_INFINITY:0===o||0===c?Math.max(o,c):Math.min(o,c);var d={};Object.defineProperty(d,"maxMessageSize",{get:function(){return s}}),this._sctp=d}return r.apply(this,arguments)}},t.shimParameterlessSetLocalDescription=function(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;var r=e.RTCPeerConnection.prototype.setLocalDescription;if(!r||0===r.length)return;e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this,t=arguments[0]||{};if("object"!==o(t)||t.type&&t.sdp)return r.apply(this,arguments);if(!(t={type:t.type,sdp:t.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":t.type="offer";break;default:t.type="answer"}return t.sdp||"offer"!==t.type&&"answer"!==t.type?r.apply(this,[t]):("offer"===t.type?this.createOffer:this.createAnswer).apply(this).then((function(t){return r.apply(e,[t])}))}},t.shimRTCIceCandidate=function(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===o(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){var r=new t(e),n=i.default.parseCandidate(e.candidate);for(var s in n)s in r||Object.defineProperty(r,s,{value:n[s]});return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,s.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))},t.shimRTCIceCandidateRelayProtocol=function(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype)return;s.wrapPeerConnectionEvent(e,"icecandidate",(function(e){if(e.candidate){var t=i.default.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e}))},t.shimSendThrowTypeError=function(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){var r=e.send;e.send=function(){var n=arguments[0],i=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}var r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=r.apply(this,arguments);return t(e,this),e},s.wrapPeerConnectionEvent(e,"datachannel",(function(e){return t(e.channel,e.target),e}))};var n,i=(n=r(539))&&n.__esModule?n:{default:n},s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var c=i?Object.getOwnPropertyDescriptor(e,s):null;c&&(c.get||c.set)?Object.defineProperty(n,s,c):n[s]=e[s]}n.default=e,r&&r.set(e,n);return n}(r(288));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}},311:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shimAddTransceiver=function(e){if("object"!==c(e)||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e,r=arguments[1]&&arguments[1].sendEncodings;void 0===r&&(r=[]);var n=(r=function(e){if(Array.isArray(e))return o(e)}(e=r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).length>0;n&&r.forEach((function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var i=t.apply(this,arguments);if(n){var s=i.sender,a=s.getParameters();(!("encodings"in a)||1===a.encodings.length&&0===Object.keys(a.encodings[0]).length)&&(a.encodings=r,s.sendEncodings=r,this.setParametersPromises.push(s.setParameters(a).then((function(){delete s.sendEncodings})).catch((function(){delete s.sendEncodings}))))}return i})},t.shimCreateAnswer=function(e){if("object"!==c(e)||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,r=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(r,e)})).finally((function(){r.setParametersPromises=[]})):t.apply(this,arguments)}},t.shimCreateOffer=function(e){if("object"!==c(e)||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,r=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(r,e)})).finally((function(){r.setParametersPromises=[]})):t.apply(this,arguments)}},Object.defineProperty(t,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}}),t.shimGetParameters=function(e){if("object"!==c(e)||!e.RTCRtpSender)return;var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})},Object.defineProperty(t,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),t.shimOnTrack=function(e){"object"===c(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},t.shimPeerConnection=function(e,t){if("object"!==c(e)||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection);t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=function(e,t,r){(t=function(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===c(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r;return e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]}));var r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),i=e[0],s=e[1],a=e[2];return n.apply(this,[i||null]).then((function(e){if(t.version<53&&!s)try{e.forEach((function(e){e.type=r[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:r[t.type]||t.type}))}))}return e})).then(s,a)}},t.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},t.shimReceiverGetStats=function(e){if("object"!==c(e)||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});n.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}},t.shimRemoveStream=function(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype)return;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;n.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(r){r.track&&e.getTracks().includes(r.track)&&t.removeTrack(r)}))}},t.shimSenderGetStats=function(e){if("object"!==c(e)||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e});e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==c(e)&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(n,s,o):n[s]=e[s]}n.default=e,r&&r.set(e,n);return n}(r(288)),i=r(532),s=r(143);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}},143:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shimGetDisplayMedia=function(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;if(!e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)}}},532:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shimGetUserMedia=function(e,t){var r=e&&e.navigator,i=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,i){n.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var a=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},o=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"===s(e)&&"object"===s(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),o(e)},i&&i.prototype.getSettings){var c=i.prototype.getSettings;i.prototype.getSettings=function(){var e=c.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(i&&i.prototype.applyConstraints){var d=i.prototype.applyConstraints;i.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===s(e)&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),d.apply(this,[e])}}}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var c=a?Object.getOwnPropertyDescriptor(e,o):null;c&&(c.get||c.set)?Object.defineProperty(n,o,c):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(288));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}},540:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shimAudioContext=function(e){if("object"!==s(e)||e.AudioContext)return;e.AudioContext=e.webkitAudioContext},t.shimCallbacksAPI=function(e){if("object"!==s(e)||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,a=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};var c=function(e,t,r){var n=i.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=c,c=function(e,t,r){var n=a.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=c,c=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=c},t.shimConstraints=a,t.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var n=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}},t.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,n=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return n(a(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t))},t.shimLocalStreamsAPI=function(e){if("object"!==s(e)||!e.RTCPeerConnection)return;"getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams});if(!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(n){return t.call(r,n,e)})),e.getVideoTracks().forEach((function(n){return t.call(r,n,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var r=this,n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return i&&i.forEach((function(e){r._localStreams?r._localStreams.includes(e)||r._localStreams.push(e):r._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var n=e.getTracks();this.getSenders().forEach((function(e){n.includes(e.track)&&t.removeTrack(e)}))}})},t.shimRTCIceServerUrls=function(e){if(!e.RTCPeerConnection)return;var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var i=[],s=0;s<e.iceServers.length;s++){var a=e.iceServers[s];void 0===a.urls&&a.url?(n.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,i.push(a)):i.push(e.iceServers[s])}e.iceServers=i}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},t.shimRemoteStreamsAPI=function(e){if("object"!==s(e)||!e.RTCPeerConnection)return;"getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]});if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}}))}),t.apply(e,arguments)}}},t.shimTrackEventTransceiver=function(e){"object"===s(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!=typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var c=a?Object.getOwnPropertyDescriptor(e,o):null;c&&(c.get||c.set)?Object.defineProperty(n,o,c):n[o]=e[o]}n.default=e,r&&r.set(e,n);return n}(r(288));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function a(e){return e&&void 0!==e.video?Object.assign({},e,{video:n.compactObject(e.video)}):e}},288:(e,t)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.compactObject=function e(t){if(!a(t))return t;return Object.keys(t).reduce((function(n,i){var s=a(t[i]),o=s?e(t[i]):t[i],c=s&&!Object.keys(o).length;return void 0===o||c?n:Object.assign(n,function(e,t,n){t=function(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},i,o))}),{})},t.deprecated=function(e,t){if(!i)return;console.warn(e+" is deprecated, please use "+t+" instead.")},t.detectBrowser=function(e){var t={browser:null,version:null};if(void 0===e||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;var r=e.navigator;if(r.mozGetUserMedia)t.browser="firefox",t.version=s(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=s(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!r.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=s(r.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t},t.disableLog=function(e){if("boolean"!=typeof e)return new Error("Argument type: "+r(e)+". Please use a boolean.");return n=e,e?"adapter.js logging disabled":"adapter.js logging enabled"},t.disableWarnings=function(e){if("boolean"!=typeof e)return new Error("Argument type: "+r(e)+". Please use a boolean.");return i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled")},t.extractVersion=s,t.filterStats=function(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var s=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&s.push(e)})),s.forEach((function(t){e.forEach((function(r){r.type===n&&r.trackId===t.id&&o(e,r,i)}))})),i},t.log=function(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(n)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},t.walkStats=o,t.wrapPeerConnectionEvent=function(e,t,r){if(!e.RTCPeerConnection)return;var n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return i.apply(this,arguments);var s=function(e){var t=r(e);t&&(n.handleEvent?n.handleEvent(t):n(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(n,s),i.apply(this,[e,s])};var s=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[t])return s.apply(this,arguments);if(!this._eventMap[t].has(r))return s.apply(this,arguments);var n=this._eventMap[t].get(r);return this._eventMap[t].delete(r),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,s.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})};var n=!0,i=!0;function s(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function a(e){return"[object Object]"===Object.prototype.toString.call(e)}function o(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((function(n){n.endsWith("Id")?o(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach((function(t){o(e,e.get(t),r)}))})))}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{"use strict";r.r(n),r.d(n,{DCVWebRTCRedirClient:()=>g});const e={major:0,minor:3,patch:1,buildNumber:0,gitHash:"095db5cf9815180fcac836f02dfce117a1d0c60f",versionStr:"0.3.1+build.0"};var t=r(86),i=r(43),s=r.n(i);const a=Object.freeze({HELLO_API_NAME:"hello",GETUSERMEDIA_API_NAME:"navigator.mediaDevices.getUserMedia",ENUMERATEDEVICES_API_NAME:"navigator.mediaDevices.enumerateDevices",GENERATE_CERTIFICATE_API_NAME:"RTCPeerConnection.generateCertificate",NEWRTCPEERCONNECTION_API_NAME:"new.RTCPeerConnection",PC_GET_CONFIGURATION:"pcs.getConfiguration",NEW_AUDIO_CONTEXT:"new.AudioContext",CREATE_WORKER:"new.Worker",WORKER_POST_MESSAGE:"workers.postMessage",WORKER_TERMINATE:"workers.terminate",AUDIO_CTX_CREATE_AUDIO_NODE:"audioContexts.createAudioNode",AUDIO_CTX_CLOSE:"audioContexts.close",AUDIO_NODE_CONNECT:"audioNodes.connect",AUDIO_NODE_DISCONNECT:"audioNodes.disconnect",AUDIO_PARAM_SET_VALUE_AT_TIME:"audioParams.setValueAtTime",AUDIO_PARAM_SET_RAMP_TO_VALUE_AT_TIME:"audioParams.linearRampToValueAtTime",AUDIO_NODE_SET_TYPE:"audioNodes.setType",AUDIO_NODE_START:"audioNodes.start",AUDIO_NODE_STOP:"audioNodes.stop",PC_CLOSE_API_NAME:"pcs.close",ADDSTREAM_API_NAME:"pcs.addStream",STREAM_REMOVE_TRACK:"streams.removeTrack",STREAM_ADD_TRACK:"streams.addTrack",GET_STATS_API_NAME:"pcs.getStats",CREATE_OFFER_API_NAME:"pcs.createOffer",SET_LOCAL_DESCRIPTION_API_NAME:"pcs.setLocalDescription",ADD_PC_EVENT_LISTENER:"pcs.addEventListener",ADD_TRACK_EVENT_LISTENER:"tracks.addEventListener",ADD_DTMF_EVENT_LISTENER:"dtmfs.addEventListener",ADD_WORKER_EVENT_LISTENER:"workers.addEventListener",SET_REMOTE_DESCRIPTION_API_NAME:"pcs.setRemoteDescription",ADD_ICE_CANDIDATE_API_NAME:"pcs.addIceCandidate",CREATE_MEDIA_ELEMENT_API_NAME:"document.createElement",MEDIA_ELEMENT_SET_SINK_ID_API_NAME:"mediaElements.setSinkId",MEDIA_ELEMENT_REMOVE:"mediaElements.remove",CREATE_ANSWER_API_NAME:"pcs.createAnswer",UNLOAD_EVENT_NAME:"unload",TOGGLE_TRACK_ENABLED_API_NAME:"tracks.enabled",TRACK_STOP_API_NAME:"tracks.stop",TRACK_GET_SETTINGS:"tracks.getSettings",GET_RECEIVERS_API_NAME:"pcs.getReceivers",ADD_TRACK_API_NAME:"pcs.addTrack",GET_SENDERS_API_NAME:"pcs.getSenders",GET_SENDER_STATS_API_NAME:"senders.getStats",GET_RECEIVER_STATS_API_NAME:"receivers.getStats",SET_MEDIA_SRC_OBJ_API_NAME:"mediaElements.srcObject",SET_MEDIA_HIDDEN_API_NAME:"mediaElements.hidden",SET_MEDIA_VOLUME_API_NAME:"mediaElements.volume",MEDIA_ELEMENT_PLAY_API_NAME:"mediaElements.play",MEDIA_ELEMENT_PAUSE_API_NAME:"mediaElements.pause",MEDIA_ELEMENT_MUTED:"mediaElements.muted",ADD_TRANSCEIVER_API_NAME:"pcs.addTransceiver",GET_TRANSCEIVERS_API_NAME:"pcs.getTransceivers",TRANSCEIVER_SET_CODEC_PREFS:"transceivers.setCodecPreferences",REPLACE_SENDER_TRACK_API_NAME:"senders.replaceTrack",PC_REMOVE_TRACK_API_NAME:"pcs.removeTrack",INSERT_DTMF_API_NAME:"dtmfSenders.insertDTMF",SENDER_CREATE_ENCODED_STREAMS:"senders.createEncodedStreams",RECEIVER_CREATE_ENCODED_STREAMS:"receivers.createEncodedStreams"}),o=Object.freeze({SIG_STATE_CHANGE:"signalingstatechange",TRACK:"track",CONN_STATE_CHANGE:"connectionstatechange",ICE_CONN_STATE_CHANGE:"iceconnectionstatechange",ICE_GATHER_STATE_CHANGE:"icegatheringstatechange",ICE_CANDIDATE:"icecandidate",NEGOTIATION_NEEDED:"negotiationneeded"}),c=Object.freeze({ENDED:"ended",MUTE:"mute",UNMUTE:"unmute"}),d=Object.freeze({TONECHANGE:"tonechange"}),l=Object.freeze({ERROR:"error",MESSAGE:"message",MESSAGE_ERROR:"messageerror"}),p=Object.freeze({CHROME:"diilpfplcnhehakckkpmcmibmhbingnd",EDGE:"kjbbkjjiecchbcdoollhgffghfjnbhef"});var h=r(114);const u=r(591);function f(){return function(){const e=window.navigator.userAgent.toLowerCase();return e.indexOf("edg/")>-1||e.indexOf("edge")>-1}()?p.EDGE:p.CHROME}class m{constructor(t){if(this.version=e,this.config=t,this.logger=t.logger,this.clientInfo=null,this.certParams={name:"ECDSA",namedCurve:"P-256"},this.extensionId=f(),this.pcProxies=new Map,this.audioContextProxies=new Map,this.audioNodeProxies=new Map,this.workerProxies=new Map,this.streamProxies=new Map,this.eventListeners=new Map,this.mediaElementProxies=new Map,this.transceiverProxies=new Map,this.senderProxies=new Map,this.dtmfProxies=new Map,this.receiverProxies=new Map,this.trackProxies=new Map,this.overridenApis=new Map,this.decoder=new TextDecoder("utf-8"),this.logger.info(`Checking for chrome extension.  Chrome runtime: ${chrome.runtime}`),void 0===chrome.runtime)throw new Error("Chrome runtime not available.  DCV WebRTC chrome extension may not be active.");this.overridenApis.set("navigator.mediaDevices.getUserMedia",navigator.mediaDevices.getUserMedia),this.overridenApis.set("navigator.mediaDevices.enumerateDevices",navigator.mediaDevices.enumerateDevices),this.overridenApis.set("window.RTCPeerConnection",window.RTCPeerConnection),this.overridenApis.set("window.RTCPeerConnection.generateCertificate",window.RTCPeerConnection.generateCertificate),this.overridenApis.set("window.AudioContext",window.AudioContext),this.overridenApis.set("window.Worker",window.Worker)}makeMediaDeviceInfoProxies(e){return e.forEach((e=>{e.toJSON=()=>e})),e}makeTrackProxy(e){if(this.trackProxies.has(e.id)){let t=this.trackProxies.get(e.id);return Object.assign(t,e),t}return this.trackProxies.set(e.id,e),e.pendingEvents=new Map,e.stop=()=>{this.sendApiRequest(a.TRACK_STOP_API_NAME,[e.id])},e.getSettings=()=>(this.sendApiRequest(a.TRACK_GET_SETTINGS,[e.id]).then((t=>{e.settings=t})),e.settings),e.addEventListener=(t,r,n)=>{this.logger.debug("Setting ended event listener via addEventListener."),this.addTrackEventListener(e.id,t,r,n)},e.removeEventListener=(t,r)=>{this.removeEventListener(e.id,t,r)},Object.defineProperty(e,"onended",{set:t=>{this.addTrackEventListener(e.id,c.ENDED,t)},get:()=>null}),Object.defineProperty(e,"onmute",{set:t=>{this.addTrackEventListener(e.id,c.MUTE,t)},get:()=>null}),Object.defineProperty(e,"onunmute",{set:t=>{this.addTrackEventListener(e.id,c.UNMUTE,t)},get:()=>null}),e.trackEnabled=e.enabled,Object.defineProperty(e,"enabled",{set:t=>{e.trackEnabled=t,this.sendApiRequest(a.TOGGLE_TRACK_ENABLED_API_NAME,[e.id,t]).then((t=>{this.trackProxies.get(e.id).trackEnabled=t.enabled}))},get:()=>e.trackEnabled}),this.preRegisterEvents(c,e,this.addTrackEventListener),e}makeStreamProxy(e){this.streamProxies.set(e.id,e);let t=new MediaStream;t.type="proxy",t.proxy=e;let r=e.tracks?e.tracks.map((e=>this.makeTrackProxy(e))):[];return e.tracks=r,t.getTracks=()=>r,t.getAudioTracks=()=>r.filter((e=>"audio"===e.kind)),t.getVideoTracks=()=>r.filter((e=>"video"===e.kind)),t.getTrackById=e=>r.find((t=>t.id===e)),t.createMediaElement=e=>this.createMediaElement(e),t.addTrack=t=>{this.sendApiRequest(a.STREAM_ADD_TRACK,[e.id,t.id])},t.removeTrack=t=>{this.sendApiRequest(a.STREAM_REMOVE_TRACK,[e.id,t.id])},t}updateTransceiverProxy(e){let t=this.transceiverProxies.get(e.id);return t||(t={}),Object.assign(t,e),e.receiver&&"proxy"===e.receiver.type&&(t.receiver=this.updateReceiverProxy(e.receiver)),e.sender&&"proxy"===e.sender.type&&(t.sender=this.updateSenderProxy(e.sender)),this.transceiverProxies.set(e.id,t),t}updatePCSenders(e,t){let r=t.map((e=>this.updateSenderProxy(e)));this.pcProxies.get(e).senders=r}updatePCReceivers(e,t){let r=t.map((e=>this.updateReceiverProxy(e)));this.pcProxies.get(e).receivers=r}updatePCTransceivers(e,t){let r=t;r.forEach((e=>{this.updateTransceiverProxy(e)})),this.pcProxies.get(e).transceivers=r}isValidApi(e){let t=!1;for(const r in a)if(a[r]===e){t=!0;break}return t}async sendApiRequest(e,t,r=crypto.randomUUID()){this.logger.debug(e,t,r);let n={api:e,args:t},i=u.deflateRaw(JSON.stringify(n));const s={requestId:r,message:i,type:"request"};this.logger.debug("Sending request:",JSON.stringify(s));let a=await chrome.runtime.sendMessage(this.extensionId,s);i=a.message;let o=u.inflateRaw(i),c=this.decoder.decode(o);if(a.message=JSON.parse(c),this.logger.debug("Received response: ",JSON.stringify(a)),!a||!a.message||!a.type){let e=`Received empty message or type, extensionResponse: ${JSON.stringify(a)}, request: ${JSON.stringify(s)}, message: ${JSON.stringify(n)}`;throw this.logger.error(e),new Error(e)}if("error"===a.type){let e=`Received error: ${JSON.stringify(a)}, for request: ${JSON.stringify(s)}, message: ${JSON.stringify(n)}`,t=null;throw this.logger.error(e),a.message.error&&a.message.error.message&&(e=a.message.error.message),a.message.error&&a.message.error.name&&(t=a.message.error.name),new DOMException(e,t)}if("response"!==a.type&&"event"!==a.type){let e=`Received invalid message type, type: ${JSON.stringify(a.type)}, event: ${JSON.stringify(a)}, request: ${JSON.stringify(s)}, message: ${JSON.stringify(n)}`;throw this.logger.error(e),new Error(e)}if(!this.isValidApi(a.message.api)){let e=`Received invalid message api, event: ${JSON.stringify(a)}, request: ${JSON.stringify(s)}, message: ${JSON.stringify(n)}`;throw this.logger.error(e),new Error(e)}return"event"===a.type?a.message.event:a.message.response}async getUserMediaInternal(e){let t=await this.sendApiRequest(a.GETUSERMEDIA_API_NAME,[e]);return this.makeStreamProxy(t)}getOverridenApi(e){return this.overridenApis.get(e)}async getUserMedia(e){if(e.audio&&e.video){let t=await navigator.permissions.query({name:"microphone"}),r=await navigator.permissions.query({name:"camera"});if(t&&"granted"===t.state&&r&&"granted"===r.state)return await this.getUserMediaInternal(e)}else if(e.audio){let t=await navigator.permissions.query({name:"microphone"});if(t&&"granted"===t.state)return await this.getUserMediaInternal(e)}else if(e.video){let t=await navigator.permissions.query({name:"camera"});if(t&&"granted"===t.state)return await this.getUserMediaInternal(e)}let t=[];if(e.video&&(t=await this.getOverridenApi("navigator.mediaDevices.enumerateDevices").apply(navigator.mediaDevices),t=t.filter((e=>e.kind&&e.kind.indexOf("video")>-1))),e.audio&&!e.video||e.video&&t.length>0){(await this.getOverridenApi("navigator.mediaDevices.getUserMedia").apply(navigator.mediaDevices,[e])).getTracks().forEach((e=>{e.stop()}))}return await this.getUserMediaInternal(e)}async enumerateDevices(){let e=await this.sendApiRequest(a.ENUMERATEDEVICES_API_NAME,[]);return this.makeMediaDeviceInfoProxies(e)}getVersion(){return e}makeReceiverProxy(e){return e.track&&(e.track=this.makeTrackProxy(e.track)),e.getSynchronizationSources=()=>e.synchronizationSources,e.getStats=async()=>{let t=await this.sendApiRequest(a.GET_RECEIVER_STATS_API_NAME,[e.id]),r=new Map;return t.forEach((e=>{r.set(e.id,e)})),r},e.createEncodedStreams=()=>{let t={id:crypto.randomUUID(),type:"proxy",readable:{id:crypto.randomUUID(),type:"proxy"},writable:{id:crypto.randomUUID(),type:"proxy"}};return this.streamProxies.set(t.id,t),this.sendApiRequest(a.RECEIVER_CREATE_ENCODED_STREAMS,[e.id,t]),t},this.receiverProxies.set(e.id,e),e}makeDTMFProxy(e){let t=e;return this.dtmfProxies.has(t.id)?(t=this.dtmfProxies.get(t.id),Object.assign(t,e)):(this.dtmfProxies.set(t.id,t),t.pendingEvents=new Map,t.insertDTMF=(e,r,n)=>{this.sendApiRequest(a.INSERT_DTMF_API_NAME,[t.id,e,r,n])},t.addEventListener=(e,r,n)=>{this.addDtmfEventListener(t.id,e,r,n)},t.removeEventListener=(e,r)=>{this.removeEventListener(t.id,e,r)},Object.defineProperty(t,"ontonechange",{set:e=>{this.addDtmfEventListener(t.id,d.TONECHANGE,e)},get:()=>null}),this.preRegisterEvents(d,t,this.addDtmfEventListener)),t}makeSenderProxy(e){return e.track&&(e.track=this.makeTrackProxy(e.track)),e.dtmf&&(e.dtmf=this.makeDTMFProxy(e.dtmf)),e.getStats=async()=>{let t=await this.sendApiRequest(a.GET_SENDER_STATS_API_NAME,[e.id]);return t.has=e=>void 0!==t.find((t=>t.id===e)),t.get=e=>t.find((t=>t.id===e)),t},e.replaceTrack=t=>(e.track=t,this.sendApiRequest(a.REPLACE_SENDER_TRACK_API_NAME,[e.id,t])),e.createEncodedStreams=()=>{let t={id:crypto.randomUUID(),type:"proxy",readable:{type:"proxy",id:crypto.randomUUID()},writable:{type:"proxy",id:crypto.randomUUID()}};return this.streamProxies.set(t.id,t),this.sendApiRequest(a.SENDER_CREATE_ENCODED_STREAMS,[e.id,t]),t},e}updateSenderProxy(e){let t=this.senderProxies.get(e.id);return t?Object.assign(t,e):(t=e,this.senderProxies.set(e.id,t)),this.makeSenderProxy(t)}updateReceiverProxy(e){let t=this.receiverProxies.get(e.id);return t?Object.assign(t,e):(t=e,this.receiverProxies.set(e.id,t)),this.makeReceiverProxy(t)}addTrack(e,t){let r=crypto.randomUUID();this.sendApiRequest(a.ADD_TRACK_API_NAME,[r,...arguments]).then((e=>{this.updateSenderProxy(e),this.updatePCSenders(e.pcId,e.senders),this.updatePCReceivers(e.pcId,e.receivers),this.updatePCTransceivers(e.pcId,e.transceivers)}));let n=this.updateSenderProxy({id:r});return this.pcProxies.get(e).senders.push(n),n}updatePeerConnectionProxy(e){let t=this.pcProxies.get(e.pcId);Object.assign(t,e),this.updatePCSenders(e.pcId,e.senders),this.updatePCReceivers(e.pcId,e.receivers),this.updatePCTransceivers(e.pcId,e.transceivers)}createPeerConnection(e,t){let r=crypto.randomUUID(),n=this;this.logger.debug(`Creating RTCPeerConnection with id: ${r}`);let i={type:"proxy",id:r,signalingState:"new",connectionState:"new",iceConnectionState:"new",iceGatheringState:"new",receivers:[],senders:[],transceivers:[],pendingEvents:new Map,configuration:e,close:()=>{this.close(r)},addStream:e=>{this.addStream(r,e)},getConfiguration:()=>(this.sendApiRequest(a.PC_GET_CONFIGURATION,[r]).then((e=>{i.configuration=e})),i.configuration),getStats:e=>this.getStats(r,e),createOffer:e=>this.createOffer(r,e),createAnswer:e=>this.createAnswer(r,e),setLocalDescription:e=>this.setLocalDescription(r,e),addEventListener:(e,t)=>{this.addPeerConnectionEventListener(r,e,t)},removeEventListener:(e,t)=>{this.removeEventListener(r,e,t)},getEventListener:e=>this.eventListeners.get(r).get(e),set onicecandidate(e){this.addEventListener(o.ICE_CANDIDATE,e)},get onicecandidate(){return this.getEventListener(o.ICE_CANDIDATE)},set ontrack(e){this.addEventListener(o.TRACK,e)},get ontrack(){return this.getEventListener(o.TRACK)},get onsignalingstatechange(){return this.getEventListener(o.SIG_STATE_CHANGE)},set onsignalingstatechange(e){this.addEventListener(o.SIG_STATE_CHANGE,e)},get onconnectionstatechange(){return this.getEventListener(o.CONN_STATE_CHANGE)},set onconnectionstatechange(e){this.addEventListener(o.CONN_STATE_CHANGE,e)},get oniceconnectionstatechange(){return this.getEventListener(o.ICE_CONN_STATE_CHANGE)},set oniceconnectionstatechange(e){this.addEventListener(o.ICE_CONN_STATE_CHANGE,e)},get onicegatheringstatechange(){return this.getEventListener(o.ICE_GATHER_STATE_CHANGE)},set onicegatheringstatechange(e){this.addEventListener(o.ICE_GATHER_STATE_CHANGE,e)},get onnegotiationneeded(){return this.getEventListener(o.NEGOTIATION_NEEDED)},set onnegotiationneeded(e){this.addEventListener(o.NEGOTIATION_NEEDED,e)},setRemoteDescription:e=>this.setRemoteDescription(r,e),addIceCandidate:e=>this.addIceCandidate(r,e),getRemoteStreams:()=>(this.logger.warn("getRemoteStreams not implemented on proxy."),[]),getReceivers:()=>this.getReceivers(r),getSenders:()=>this.getSenders(r),addTrack:function(e){let t=[r,...arguments];return n.addTrack.apply(n,t)},addTransceiver:(e,t)=>this.addTransceiver(r,e,t),getTransceivers:()=>this.getTransceivers(r),removeTrack:e=>{this.removeTrack(r,e)}};return this.pcProxies.set(r,i),this.sendApiRequest(a.NEWRTCPEERCONNECTION_API_NAME,[r,e,t],r).then((e=>{this.updatePeerConnectionProxy(e)}),(e=>{this.logger.error(`Error creating proxied RTCPeerConnection: ${e}`)})),this.preRegisterEvents(o,this.pcProxies.get(r),this.addPeerConnectionEventListener),this.pcProxies.get(r)}preRegisterEvents(e,t,r){for(const n in e)"string"==typeof e[n]&&r.apply(this,[t.id,e[n],e=>{t.pendingEvents.has(e.eventName)||t.pendingEvents.set(e.eventName,[]),t.pendingEvents.get(e.eventName).push(e)}])}updateAudioContextProxy(e){let t=this.audioContextProxies.get(e.id);Object.assign(t,e)}updateAudioNodeProxy(e){let t=this.audioNodeProxies.get(e.id);Object.assign(t,e),e.stream&&this.makeStreamProxy(e.stream)}makeAudioNodeProxy(e,t){return{type:"proxy",id:t,context:this.audioContextProxies.get(e),connect:(e,r,n)=>(this.sendApiRequest(a.AUDIO_NODE_CONNECT,[t,e,r,n]),e),disconnect:(e,r,n)=>{this.sendApiRequest(a.AUDIO_NODE_DISCONNECT,[t,e,r,n])}}}createAudioNode(e,t,r){let n=crypto.randomUUID();return this.audioNodeProxies.set(n,this.makeAudioNodeProxy(e,n)),this.sendApiRequest(a.AUDIO_CTX_CREATE_AUDIO_NODE,[e,n,t,r],n).then((e=>{this.updateAudioNodeProxy(e)}),(e=>{this.logger.error(`Error creating proxied ${t}: ${e}`)})),this.audioNodeProxies.get(n)}makeWorkerProxy(e){let t={id:e,pendingEvents:new Map,type:"proxy",postMessage:(t,r)=>{this.sendApiRequest(a.WORKER_POST_MESSAGE,[e,t,r])},terminate:()=>{this.sendApiRequest(a.WORKER_TERMINATE,[e])},addEventListener:(e,r,n)=>{this.addWorkerEventListener(t.id,e,r,n)},removeEventListener:(e,r)=>{this.removeEventListener(t.id,e,r)}};return Object.defineProperty(t,"onerror",{set:e=>{this.addWorkerEventListener(t.id,l.ERROR,e)},get:()=>null}),Object.defineProperty(t,"onmessage",{set:e=>{this.addWorkerEventListener(t.id,l.MESSAGE,e)},get:()=>null}),Object.defineProperty(t,"onmessageerror",{set:e=>{this.addWorkerEventListener(t.id,l.MESSAGE_ERROR,e)},get:()=>null}),t}createWorker(e,t){let r=crypto.randomUUID(),n=this.makeWorkerProxy(r);return this.workerProxies.set(r,n),fetch(e).then((e=>{e.blob().then((e=>{e.arrayBuffer().then((n=>{let i=(0,h.encode)(n);this.sendApiRequest(a.CREATE_WORKER,[r,e.type,i,t]).then((e=>{this.logger.debug(`Created worker: ${JSON.stringify(e)}`)}))}))}))})),this.logger.debug(`Preregistering events for worker: ${JSON.stringify(n)}`),this.preRegisterEvents(l,n,this.addWorkerEventListener),n}createAudioContext(){let e=crypto.randomUUID(),t=crypto.randomUUID();return this.audioContextProxies.set(e,{type:"proxy",id:e,destination:this.makeAudioNodeProxy(e,t),createGain:()=>{let t=this.createAudioNode(e,"Gain",[]),r={setValueAtTime:(e,n)=>(r.currentValue=e,this.sendApiRequest(a.AUDIO_PARAM_SET_VALUE_AT_TIME,[t.id,e,n]),r),linearRampToValueAtTime:(e,n)=>(this.sendApiRequest(a.AUDIO_PARAM_SET_RAMP_TO_VALUE_AT_TIME,[t.id,e,n]),r)};return Object.defineProperty(r,"value",{set:e=>r.setValueAtTime(e,0),get:()=>r.currentValue}),t.gain=r,t},createOscillator:()=>{let t=this.createAudioNode(e,"Oscillator",[]);t.start=(e=0)=>{this.sendApiRequest(a.AUDIO_NODE_START,[t.id,e])},t.stop=(e=0)=>{this.sendApiRequest(a.AUDIO_NODE_STOP,[t.id,e])},Object.defineProperty(t,"type",{set:e=>{t.currentType=e,this.sendApiRequest(a.AUDIO_NODE_SET_TYPE,[t.id,e])},get:()=>t.currentType});let r={setValueAtTime:(e,n)=>(this.sendApiRequest(a.AUDIO_PARAM_SET_VALUE_AT_TIME,[t.id,e,n]),r)};return Object.defineProperty(r,"value",{set:e=>r.setValueAtTime(e,0),get:()=>r.currentValue}),t.frequency=r,t},createMediaStreamSource:t=>this.createAudioNode(e,"MediaStreamSource",[t.proxy]),createAnalyser:()=>this.createAudioNode(e,"Analyser",[]),createMediaStreamDestination:()=>{let t=this.createAudioNode(e,"MediaStreamDestination",[]);return t.stream=this.makeStreamProxy({id:t.id,tracks:[{id:t.id,kind:"audio"}]}),t},close:()=>this.sendApiRequest(a.AUDIO_CTX_CLOSE,[e])}),this.sendApiRequest(a.NEW_AUDIO_CONTEXT,[e,t],e).then((e=>{this.updateAudioContextProxy(e)}),(e=>{this.logger.error(`Error creating proxied AudioContext: ${e}`)})),this.audioContextProxies.get(e)}close(e){this.eventListeners.get(e).clear(),this.sendApiRequest(a.PC_CLOSE_API_NAME,[e])}addStream(e,t){this.sendApiRequest(a.ADDSTREAM_API_NAME,[e,t.proxy])}getStats(e,t){return"function"==typeof t?Promise.reject(new Error("callback based getStats is obsolete.")):this.sendApiRequest(a.GET_STATS_API_NAME,[e,t])}createOffer(e,t){return this.sendApiRequest(a.CREATE_OFFER_API_NAME,[e,t])}createAnswer(e,t){return this.sendApiRequest(a.CREATE_ANSWER_API_NAME,[e,t])}setLocalDescription(e,t){return this.pcProxies.get(e).localDescription=t,this.sendApiRequest(a.SET_LOCAL_DESCRIPTION_API_NAME,[e,t])}setRemoteDescription(e,t){return this.sendApiRequest(a.SET_REMOTE_DESCRIPTION_API_NAME,[e,t])}handleAddEventListenerResponse(e){e.eventName===o.SIG_STATE_CHANGE?this.updatePeerConnectionProxy(e):e.eventName===o.TRACK?(e.streams=e.streams.map((e=>this.makeStreamProxy(e))),e.track=this.makeTrackProxy(e.track),this.updatePeerConnectionProxy(e)):(e.eventName===o.CONN_STATE_CHANGE||e.eventName===o.ICE_CONN_STATE_CHANGE||e.eventName===o.ICE_GATHER_STATE_CHANGE||e.eventName===o.ICE_CANDIDATE||e.eventName===o.NEGOTIATION_NEEDED)&&this.updatePeerConnectionProxy(e),this.fireUpEventHandlers(this.pcProxies.get(e.pcId),e),this.sendApiRequest(a.ADD_PC_EVENT_LISTENER,[e.pcId,e.eventName]).then((e=>{this.handleAddEventListenerResponse(e)}))}fireUpEventHandlers(e,t){if(this.eventListeners.get(e.id).has(t.eventName)){let r=e.pendingEvents;this.eventListeners.get(e.id).get(t.eventName).forEach(((e,n)=>{0===n?e(t):r.get(t.eventName).forEach((t=>{e(t)}))})),r.set(t.eventName,[])}}handleAddTrackEventListenerResponse(e){"mute"!==e.eventName&&"unmute"!==e.eventName||(this.trackProxies.get(e.trackId).muted=e.muted),this.fireUpEventHandlers(this.trackProxies.get(e.trackId),e),this.sendApiRequest(a.ADD_TRACK_EVENT_LISTENER,[e.trackId,e.eventName]).then((e=>{this.handleAddTrackEventListenerResponse(e)}))}handleAddDtmfEventListenerResponse(e){this.fireUpEventHandlers(this.dtmfProxies.get(e.dtmfId),e),this.sendApiRequest(a.ADD_DTMF_EVENT_LISTENER,[e.dtmfId,e.eventName]).then((e=>{this.handleAddDtmfEventListenerResponse(e)}))}handleAddWorkerEventListenerResponse(e){this.fireUpEventHandlers(this.workerProxies.get(e.wId),e),this.sendApiRequest(a.ADD_WORKER_EVENT_LISTENER,[e.wId,e.eventName]).then((e=>{this.handleAddWorkerEventListenerResponse(e)}))}addEventListener(e,t,r){this.eventListeners.has(e)||this.eventListeners.set(e,new Map),this.eventListeners.get(e).has(t)||this.eventListeners.get(e).set(t,[]),this.eventListeners.get(e).get(t).push(r)}addPeerConnectionEventListener(e,t,r){this.addEventListener(e,t,r),this.sendApiRequest(a.ADD_PC_EVENT_LISTENER,[e,t]).then((e=>{this.handleAddEventListenerResponse(e)}))}addTrackEventListener(e,t,r,n){this.addEventListener(e,t,r),this.sendApiRequest(a.ADD_TRACK_EVENT_LISTENER,[e,t,n]).then((e=>{this.handleAddTrackEventListenerResponse(e)}))}addDtmfEventListener(e,t,r,n){this.addEventListener(e,t,r),this.sendApiRequest(a.ADD_DTMF_EVENT_LISTENER,[e,t,n]).then((e=>{this.handleAddDtmfEventListenerResponse(e)}))}addWorkerEventListener(e,t,r){this.addEventListener(e,t,r),this.sendApiRequest(a.ADD_WORKER_EVENT_LISTENER,[e,t]).then((e=>{this.handleAddWorkerEventListenerResponse(e)}))}removeEventListener(e,t,r){let n=this.eventListeners.get(e).get(t);const i=n.indexOf(r);i>-1&&n.splice(i,1)}addIceCandidate(e,t){let r=t?{sdpMLineIndex:t.sdpMLineIndex,sdpMid:t.sdpMid,candidate:t.candidate}:null;return this.sendApiRequest(a.ADD_ICE_CANDIDATE_API_NAME,[e,r])}createMediaElement(e){let t=crypto.randomUUID();this.sendApiRequest(a.CREATE_MEDIA_ELEMENT_API_NAME,[t,e],t).then((e=>{this.mediaElementProxies.get(e.id).sinkId=e.sinkId}));let r={id:t,type:"proxy",classList:new Set,isMuted:!1,play:()=>{this.sendApiRequest(a.MEDIA_ELEMENT_PLAY_API_NAME,[t])},pause:()=>{this.sendApiRequest(a.MEDIA_ELEMENT_PAUSE_API_NAME,[t])},setSinkId:e=>this.sendApiRequest(a.MEDIA_ELEMENT_SET_SINK_ID_API_NAME,[t,e]),remove:()=>this.sendApiRequest(a.MEDIA_ELEMENT_REMOVE,[t])};return this.mediaElementProxies.set(t,r),r.classList.remove=e=>{r.classList.delete(e)},Object.assign(r,e),Object.defineProperty(r,"srcObject",{set:e=>{r.stream=e,this.sendApiRequest(a.SET_MEDIA_SRC_OBJ_API_NAME,[r.id,e&&e.proxy?e.proxy:e])},get:()=>r.stream}),Object.defineProperty(r,"hidden",{set:e=>{this.sendApiRequest(a.SET_MEDIA_HIDDEN_API_NAME,[r.id,e])},get:()=>r.hidden}),Object.defineProperty(r,"volume",{set:e=>{this.sendApiRequest(a.SET_MEDIA_VOLUME_API_NAME,[r.id,e])},get:()=>r.volume}),Object.defineProperty(r,"muted",{set:e=>{r.isMuted=e,this.sendApiRequest(a.MEDIA_ELEMENT_MUTED,[r.id,e]).then((e=>{r.isMuted=e.muted}))},get:()=>r.isMuted}),r}generateCertificate(e){return this.sendApiRequest(a.GENERATE_CERTIFICATE_API_NAME,[e])}getReceivers(e){return this.sendApiRequest(a.GET_RECEIVERS_API_NAME,[e]).then((e=>{this.updatePCReceivers(e.pcId,e.receivers)})),this.pcProxies.get(e).receivers}getSenders(e){return this.sendApiRequest(a.GET_SENDERS_API_NAME,[e]).then((e=>{this.updatePCSenders(e.pcId,e.senders)})),this.pcProxies.get(e).senders}removeTrack(e,t){this.sendApiRequest(a.PC_REMOVE_TRACK_API_NAME,[e,t])}getTransceivers(e){return this.sendApiRequest(a.GET_TRANSCEIVERS_API_NAME,[e]).then((e=>{this.updatePCTransceivers(e.pcId,e.transceivers)})),this.pcProxies.get(e).transceivers}addTransceiver(e,t,r){let n=crypto.randomUUID(),i={type:"proxy",id:n,sender:this.makeSenderProxy({id:crypto.randomUUID()}),receiver:this.makeReceiverProxy({id:crypto.randomUUID()}),setCodecPreferences:e=>{this.sendApiRequest(a.TRANSCEIVER_SET_CODEC_PREFS,[n,e])}};return this.transceiverProxies.set(i.id,i),this.pcProxies.get(e).transceivers.push(i),this.pcProxies.get(e).receivers.push(i.receiver),this.pcProxies.get(e).senders.push(i.sender),this.sendApiRequest(a.ADD_TRANSCEIVER_API_NAME,[e,i,"string"==typeof t?t:this.makeTrackProxy(t),r]).then((e=>{this.updateTransceiverProxy(e),this.updatePCSenders(e.pcId,e.senders),this.updatePCReceivers(e.pcId,e.receivers),this.updatePCTransceivers(e.pcId,e.transceivers)})),i}setLogger(e){this.logger=e}overrideWebRTC(){this.logger.info("Overriding WebRTC interfaces for the current webapp.");let e=this;navigator.mediaDevices.getUserMedia=e=>this.getUserMedia(e),navigator.mediaDevices.enumerateDevices=()=>this.enumerateDevices(),window.RTCPeerConnection=function(t,r){return e.createPeerConnection(t,r)},window.RTCPeerConnection.generateCertificate=function(t){return e.generateCertificate(t)},window.AudioContext=function(){return e.createAudioContext()},window.Worker=function(t,r){return e.createWorker(t,r)}}async sendHelloRequest(){let t=await this.sendApiRequest(a.HELLO_API_NAME,[]);return globalThis.DCVWebRTCRedirProxy||(this.logger.info(`Running in a DCV WebRTC redirection env, proxy version: ${e.versionStr} - ${e.gitHash}`),this.logger.info(`Client info: ${JSON.stringify(t)}`),window.addEventListener("beforeunload",(e=>{let t={pcIds:[],streamIds:[],mediaElementIds:[],transceiverIds:[],senderIds:[],receiverIds:[],trackIds:[],workerIds:[]};this.pcProxies.forEach(((e,r)=>{t.pcIds.push(r)})),this.streamProxies.forEach(((e,r)=>{t.streamIds.push(r)})),this.trackProxies.forEach(((e,r)=>{t.trackIds.push(r)})),this.workerProxies.forEach(((e,r)=>{t.workerIds.push(r)})),this.mediaElementProxies.forEach(((e,r)=>{t.mediaElementIds.push(r)})),this.transceiverProxies.forEach(((e,r)=>{t.transceiverIds.push(r)})),this.senderProxies.forEach(((e,r)=>{t.senderIds.push(r)})),this.receiverProxies.forEach(((e,r)=>{t.receiverIds.push(r)})),this.sendApiRequest(a.UNLOAD_EVENT_NAME,[t])}))),t}static setInitCallback(e,t){let r=globalThis.DCVWebRTCRedirProxy;if(r)e({success:!0,proxy:r});else{m.initCallbacks||(m.initCallbacks=new Map);let r=setTimeout((e=>{e({success:!1,error:`Failed to initialize DCVWebRTCPeerConnectionProxy in ${t}ms`}),m.initCallbacks.delete(e)}),t,e);m.initCallbacks.set(e,r)}}}const _=r(591);class g{constructor(r){this.version=e,this.config=r,this.logger=r.logger?r.logger:s(),this.channel=r.channel,this.decoder=new TextDecoder("utf-8"),this.messageBuffer=null,this.pcs=new Map,this.pcPromises=new Map,this.audioContexts=new Map,this.audioNodes=new Map,this.workers=new Map,this.workerPromises=new Map,this.certs=new Map,this.streams=new Map,this.tracks=new Map,this.offers=new Map,this.answers=new Map,this.remoteDescriptions=new Map,this.mediaElements=new Map,this.audios=new Map,this.senders=new Map,this.dtmfSenders=new Map,this.receivers=new Map,this.transceivers=new Map,this.logger.info(`Created WebRTC Redirection Client version: ${e.versionStr} - ${e.gitHash} - ${JSON.stringify(t.Z.browserDetails)}`)}encodeBase64(e){return(0,h.encode)(e)}decodeBase64(e){return(0,h.decode)(e)}getVersion(){return this.version}concatUint8Arrays(e){const t=e.reduce(((e,t)=>e+t.byteLength),0),r=new Uint8Array(t);let n=0;return e.forEach((e=>{r.set(e,n),n+=e.byteLength})),r}parseHeader(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}onMessageReceived(e){this.logger.debug(`onMessageReceived, binaryPayload.byteLength: ${e.byteLength}`);try{let t=0;for(null===this.messageBuffer?this.messageBuffer=new Uint8Array(e):this.messageBuffer=this.concatUint8Arrays([this.messageBuffer,new Uint8Array(e)]),this.messageBuffer.byteLength>=4&&(t=this.parseHeader(this.messageBuffer));t>0&&this.messageBuffer.byteLength>=t+4;){let e=4,r=4+t,n=this.messageBuffer.slice(e,r);this.logger.debug("Decoding payload: ",n);let i=this.decoder.decode(n);this.logger.debug(`Received message: ${i}`);let s=JSON.parse(i);this.logger.debug("Received json: ",s),this.handleMessage(s),this.messageBuffer=this.messageBuffer.slice(r),t=this.messageBuffer.byteLength>=4?this.parseHeader(this.messageBuffer):0}}catch(e){this.logger.error(`Failed to parse JSON from binaryPayload: ${e}`),this.messageBuffer=null}}getPeerConnection(e){return this.pcs.has(e)?this.pcs.get(e):(this.pcPromises.has(e)||this.pcPromises.set(e,[]),new Promise(((t,r)=>{this.pcPromises.get(e).push({resolve:t,reject:r})})))}getPendingEvent(e,t){return e.pendingEvents.has(t)&&e.pendingEvents.get(t).length>0?e.pendingEvents.get(t).shift():(e.eventPromises.has(t)||e.eventPromises.set(t,[]),new Promise(((r,n)=>{e.eventPromises.get(t).push({resolve:r,reject:n})})))}getStream(e){return this.streams.get(e)}makeTrackTO(e,t=(e.id?e.id:crypto.randomUUID())){return this.tracks.set(t,e),{type:"proxy",contentHint:e.contentHint,enabled:e.enabled,id:t,kind:e.kind,label:e.label,muted:e.muted,readyState:e.readyState,settings:e.getSettings()}}makeStreamTO(e,t=(e.id?e.id:crypto.randomUUID())){this.streams.set(t,e);let r=e.getTracks().map((e=>this.makeTrackTO(e)));return{type:"proxy",id:t,active:e.active,tracks:r}}makeSyncronizationSourceTO(e){return{audioLevel:e.audioLevel,rtpTimestamp:e.rtpTimestamp,source:e.source,timestamp:e.timestamp}}makeReceiverTO(e){let t=e.getSynchronizationSources();t=t.map((e=>this.makeSyncronizationSourceTO(e)));let r={id:e.id?e.id:crypto.randomUUID(),type:"proxy",track:e.track?this.makeTrackTO(e.track):null,synchronizationSources:t,stats:[]};return e.id=r.id,this.receivers.set(r.id,e),r}makeDTMFSenderTO(e){let t={id:e.id?e.id:crypto.randomUUID(),type:"proxy",toneBuffer:e.toneBuffer};return e.id=t.id,this.dtmfSenders.set(t.id,e),t}makeSenderTO(e){let t={id:e.id?e.id:crypto.randomUUID(),type:"proxy",track:e.track?this.makeTrackTO(e.track):null,dtmf:e.dtmf?this.makeDTMFSenderTO(e.dtmf):null};return e.id=t.id,this.senders.set(t.id,e),t}makeTransceiverTO(e){return{id:e.id,type:"proxy",currentDirection:e.currentDirection,direction:e.direction,mid:e.mid,receiver:e.receiver?this.makeReceiverTO(e.receiver):null,sender:e.sender?this.makeSenderTO(e.sender):null,stopped:e.stopped}}findProxySubject(e){return this.pcs.has(e)?this.pcs.get(e):this.audioContexts.has(e)?this.audioContexts.get(e):this.audioNodes.has(e)?this.audioNodes.get(e):this.workers.has(e)?this.workers.get(e):this.certs.has(e)?this.certs.get(e):this.streams.has(e)?this.streams.get(e):this.offers.has(e)?this.offers.get(e):this.answers.has(e)?this.answers.get(e):this.remoteDescriptions.has(e)?this.remoteDescriptions.get(e):this.mediaElements.has(e)?this.mediaElements.get(e):this.audios.has(e)?this.audios.get(e):this.senders.has(e)?this.senders.get(e):this.dtmfSenders.has(e)?this.dtmfSenders.get(e):this.receivers.has(e)?this.recevers.get(e):this.transceivers.has(e)?this.transceivers.get(e):this.tracks.has(e)?this.tracks.get(e):null}traverse(e,t){if("object"==typeof e)for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t.apply(this,[e,r,e[r]]),null!==e[r]&&"object"==typeof e[r]&&this.traverse(e[r],t))}getWorker(e){return this.workers.has(e)?this.workers.get(e):(this.workerPromises.has(e)||this.workerPromises.set(e,[]),new Promise(((t,r)=>{this.workerPromises.get(e).push({resolve:t,reject:r})})))}gatherPeerConnectionState(e,t){e.canTrickleIceCandidates=t.canTrickleIceCandidates,e.connectionState=t.connectionState,e.currentLocalDescription=t.currentLocalDescription,e.currentRemoteDescription=t.currentRemoteDescription,e.iceConnectionState=t.iceConnectionState,e.iceGatheringState=t.iceGatheringState,e.iceGatheringState=t.iceGatheringState,e.localDescription=t.localDescription,e.peerIdentity=t.peerIdentity,e.pendingLocalDescription=t.pendingLocalDescription,e.pendingRemoteDescription=t.pendingRemoteDescription,e.remoteDescription=t.remoteDescription,e.sctp=t.sctp,e.signalingState=t.signalingState,e.configuration=t.getConfiguration(),e.transceivers=t.getTransceivers().map((e=>this.makeTransceiverTO(e))),e.senders=t.getSenders().map((e=>this.makeSenderTO(e))),e.receivers=t.getReceivers().map((e=>this.makeReceiverTO(e)))}async callWebRTCApi(e,r,n){switch(e){case a.HELLO_API_NAME:return{version:this.version,platform:"web",browserDetails:t.Z.browserDetails,userAgent:navigator.userAgent};case a.GETUSERMEDIA_API_NAME:{let[e]=n,t=await navigator.mediaDevices.getUserMedia(e);return this.makeStreamTO(t)}case a.ENUMERATEDEVICES_API_NAME:return(await navigator.mediaDevices.enumerateDevices()).map((e=>e.toJSON()));case a.STREAM_ADD_TRACK:{let[e,t]=n,r=this.streams.get(e),i=this.tracks.get(t);return r.addTrack(i),{}}case a.STREAM_REMOVE_TRACK:{let[e,t]=n,r=this.streams.get(e),i=this.tracks.get(t);return r.removeTrack(i),{}}case a.GENERATE_CERTIFICATE_API_NAME:{let[e]=n,t=await RTCPeerConnection.generateCertificate(e);return this.certs.set(r,t),{type:"proxy",id:r,expires:t.expires,fingerprints:t.getFingerprints()}}case a.NEWRTCPEERCONNECTION_API_NAME:{let[e,t,r]=n;if(t&&t.certificates){let e=t.certificates.map((e=>this.certs.get(e.id)));t.certificates=e}let i=new RTCPeerConnection(t,r);this.pcs.set(e,i),this.pcPromises.has(e)&&(this.pcPromises.get(e).forEach((e=>{e.resolve(e)})),this.pcPromises.set(e,[]));let s={type:"proxy",pcId:e};return this.gatherPeerConnectionState(s,i),s}case a.PC_GET_CONFIGURATION:{let[e]=n;return(await this.getPeerConnection(e)).getConfiguration()}case a.CREATE_WORKER:{let[e,t,r,i]=n,s=(0,h.decode)(r),a=new Blob([s],{type:t}),o=URL.createObjectURL(a),c=new Worker(o,i);return this.workers.set(e,c),this.workerPromises.has(e)&&(this.workerPromises.get(e).forEach((e=>{e.resolve(c)})),this.workerPromises.set(e,[])),{type:"proxy",id:e}}case a.WORKER_POST_MESSAGE:{let[e,t,r]=n,i=await this.getWorker(e);return this.logger.debug("Message before traversing: ",JSON.stringify(t)),this.traverse(t,((e,t,r)=>{"proxy"===r.type&&r.id&&(e[t]=this.findProxySubject(r.id))})),this.logger.debug("Message after traversing: ",t),this.logger.debug("Options before traversing: ",JSON.stringify(r)),this.traverse(r,((e,t,r)=>{"proxy"===r.type&&r.id&&(e[t]=this.findProxySubject(r.id))})),this.logger.debug("Options after traversing: ",r),i.postMessage(t,r),{type:"proxy",id:e}}case a.NEW_AUDIO_CONTEXT:{let[e,t]=n,r=new AudioContext;return this.audioContexts.set(e,r),this.audioNodes.set(t,r.destination),{type:"proxy",id:e,baseLatency:r.baseLatency,currentTime:r.currentTime,outputLatency:r.outputLatency,sampleRate:r.sampleRate,sinkId:r.sinkId,state:r.state}}case a.AUDIO_CTX_CREATE_AUDIO_NODE:{let[e,t,r,i]=n,s=this.audioContexts.get(e),a=s["create"+r];i=i.map((e=>"proxy"===e.type?this.findProxySubject(e.id):e));let o=a.apply(s,i);this.audioNodes.set(t,o);let c=null;if(o.stream){let e=o.stream.getTracks().map((e=>this.makeTrackTO(e,t)));c=this.makeStreamTO(o.stream,t),c.tracks=e}return{id:t,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs,numberOfOutputs:o.numberOfOutputs,fftSize:o.fftSize,frequencyBinCount:o.frequencyBinCount,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant,stream:c}}case a.AUDIO_CTX_CLOSE:{let[e]=n;return this.audioContexts.get(e).close(),{}}case a.AUDIO_NODE_CONNECT:{let[e,t,r,i]=n,s=this.audioNodes.get(e),a=this.findProxySubject(t.id);return s.connect(a,r||0,i||0),{}}case a.AUDIO_NODE_DISCONNECT:{let[e,t,r,i]=n,s=this.audioNodes.get(e),a=this.findProxySubject(t.id);return s.disconnect(a,r||0,i||0),{}}case a.AUDIO_NODE_SET_TYPE:{let[e,t]=n;return this.audioNodes.get(e).type=t,{}}case a.AUDIO_NODE_START:{let[e,t]=n;return this.audioNodes.get(e).start(t),{}}case a.AUDIO_NODE_STOP:{let[e,t]=n;return this.audioNodes.get(e).stop(t),{}}case a.AUDIO_PARAM_SET_VALUE_AT_TIME:{let[e,t,r]=n,i=this.audioNodes.get(e);return i.gain?i.gain.setValueAtTime(t,r||i.context.currentTime):i.frequency&&i.frequency.setValueAtTime(t,r||i.context.currentTime),{}}case a.AUDIO_PARAM_SET_RAMP_TO_VALUE_AT_TIME:{let[e,t,r]=n,i=this.audioNodes.get(e);return i.frequency&&i.frequency.linearRampToValueAtTime(t,r||i.context.currentTime),{}}case a.GET_RECEIVERS_API_NAME:{let[e]=n;return{pcId:e,receivers:(await this.getPeerConnection(e)).getReceivers().map((e=>this.makeReceiverTO(e)))}}case a.GET_SENDERS_API_NAME:{let[e]=n;return{pcId:e,senders:(await this.getPeerConnection(e)).getSenders().map((e=>this.makeSenderTO(e)))}}case a.INSERT_DTMF_API_NAME:{let[e,t,r,i]=n;return this.dtmfSenders.get(e).insertDTMF(t,r,i),{}}case a.GET_TRANSCEIVERS_API_NAME:{let[e]=n,t=(await this.getPeerConnection(e)).getTransceivers();return t=t.map((e=>(e.id=e.id?e.id:crypto.randomUUID(),this.makeTransceiverTO(e)))),{pcId:e,transceivers:t}}case a.TRANSCEIVER_SET_CODEC_PREFS:return{};case a.ADD_TRACK_API_NAME:{let[e,t,r,...i]=n,s=await this.getPeerConnection(t),a=[];i.forEach((e=>{const t=this.streams.get(e.proxy.id);t&&a.push(t)}));let o=[this.tracks.get(r.id),...a],c=s.addTrack.apply(s,o);c.id=e;let d=this.makeSenderTO(c);return d.pcId=t,d.senders=s.getSenders().map((e=>this.makeSenderTO(e))),d.receivers=s.getReceivers().map((e=>this.makeReceiverTO(e))),d.transceivers=s.getTransceivers().map((e=>this.makeTransceiverTO(e))),d}case a.ADD_TRANSCEIVER_API_NAME:{let[e,t,r,i]=n,s=await this.getPeerConnection(e);if("string"!=typeof r&&(r=this.tracks.get(r.id)),i&&i.streams){let e=[];i.streams.forEach((t=>{if(t.proxy){let r=this.streams.get(t.proxy.id);e.push(r)}})),i.streams=e}let a=s.addTransceiver(r,i);a.id=t.id,this.transceivers.set(t.id,a),a.sender&&(a.sender.id=t.sender.id,this.senders.set(t.sender.id,a.sender)),a.receiver&&(a.receiver.id=t.receiver.id,this.receivers.set(t.receiver.id,a.receiver));let o=this.makeTransceiverTO(a);return o.pcId=e,o.senders=s.getSenders().map((e=>this.makeSenderTO(e))),o.receivers=s.getReceivers().map((e=>this.makeReceiverTO(e))),o.transceivers=s.getTransceivers().map((e=>this.makeTransceiverTO(e))),o}case a.PC_CLOSE_API_NAME:{let[e]=n;return(await this.getPeerConnection(e)).close(),{}}case a.ADDSTREAM_API_NAME:{let[e,t]=n,r=this.streams.get(t.id);return(await this.getPeerConnection(e)).addStream(r),t}case a.GET_STATS_API_NAME:{let[e,t]=n,r=await this.getPeerConnection(e),i=await r.getStats(t),s=[];return i.forEach((e=>{let t=Object.assign({},e);s.push(t)})),s}case a.GET_SENDER_STATS_API_NAME:{let[e]=n,t=await this.senders.get(e).getStats(),r=[];return t.forEach((e=>{let t=Object.assign({},e);r.push(t)})),r}case a.GET_RECEIVER_STATS_API_NAME:{let[e]=n,t=await this.receivers.get(e).getStats(),r=[];return t.forEach((e=>{let t={id:e.id?e.id:crypto.randomUUID(),type:e.type,concealedSamples:e.concealedSamples};r.push(t)})),r}case a.REPLACE_SENDER_TRACK_API_NAME:{let[e,t]=n,r=this.senders.get(e),i=t?this.tracks.get(t.id):null;return await r.replaceTrack(i),{}}case a.PC_REMOVE_TRACK_API_NAME:{let[e,t]=n,r=await this.getPeerConnection(e),i=this.senders.get(t.id);return r.removeTrack(i),{}}case a.CREATE_OFFER_API_NAME:{let[e,t]=n,i=await this.getPeerConnection(e),s=await i.createOffer(t);return this.offers.set(r,s),{id:r,type:s.type,sdp:s.sdp}}case a.CREATE_ANSWER_API_NAME:{let[e,t]=n,i=await this.getPeerConnection(e),s=await i.createAnswer(t);return this.answers.set(r,s),{id:r,type:s.type,sdp:s.sdp}}case a.SET_LOCAL_DESCRIPTION_API_NAME:{let[e,t]=n,r="offer"===t.type?this.offers:this.answers,i=t.id?r.get(t.id):t;i.sdp=t.sdp;let s=await this.getPeerConnection(e);return await s.setLocalDescription(i),t}case a.SET_REMOTE_DESCRIPTION_API_NAME:{let[e,t]=n,r=await this.getPeerConnection(e);return await r.setRemoteDescription(t),t}case a.ADD_ICE_CANDIDATE_API_NAME:{let[e,t]=n,r=t?new RTCIceCandidate({sdpMLineIndex:t.sdpMLineIndex,candidate:t.candidate}):null;return(await this.getPeerConnection(e)).addIceCandidate(r),t}case a.ADD_PC_EVENT_LISTENER:{let[e,t]=n,i=await this.getPeerConnection(e);if(i.pendingEvents||(i.pendingEvents=new Map),i.eventPromises||(i.eventPromises=new Map),i.pendingEvents.has(t)){let e=await this.getPendingEvent(i,t);this.sendEvent(a.ADD_PC_EVENT_LISTENER,r,e)}else if(!i[t]){const n=t=>{let n=null;if(t.type===o.ICE_CANDIDATE){this.logger.debug("event: ",t);let r=t.candidate,s=null;r&&(s={sdpMLineIndex:r.sdpMLineIndex,sdpMid:r.sdpMid,candidate:r.candidate,type:r.type,foundation:r.foundation,protocol:r.protocol,address:r.address,port:r.port,priority:r.priority,url:r.url,relayProtocol:r.relayProtocol,component:r.compoonent,relatedAddress:r.relatedAddress,relatedPort:r.relatedPort,tcpType:r.tcpType,usernameFragment:r.usernameFragment}),n={pcId:e,eventName:t.type,type:"proxy",candidate:s},this.gatherPeerConnectionState(n,i)}else t.type===o.SIG_STATE_CHANGE?(n={pcId:e,eventName:t.type,type:"proxy"},this.gatherPeerConnectionState(n,i)):t.type===o.TRACK?(n={pcId:e,eventName:t.type,type:"proxy",streams:[],senders:[],receivers:[],track:this.makeTrackTO(t.track)},n.streams=t.streams.map((e=>this.makeStreamTO(e))),this.gatherPeerConnectionState(n,i)):t.type===o.CONN_STATE_CHANGE||t.type===o.ICE_CONN_STATE_CHANGE||t.type===o.ICE_GATHER_STATE_CHANGE||t.type===o.NEGOTIATION_NEEDED?(n={pcId:e,eventName:t.type,type:"proxy"},this.gatherPeerConnectionState(n,i)):this.logger.warn(`Ignored event, type: ${t.type}, event: ${JSON.stringify(t)}`);n&&this.processPendingEvents(i,t,n,a.ADD_PC_EVENT_LISTENER,r)};i[t]=n,i.addEventListener(t,n)}return null}case a.ADD_TRACK_EVENT_LISTENER:{let[e,t,i]=n,s=this.tracks.get(e);if(s.pendingEvents||(s.pendingEvents=new Map),s.eventPromises||(s.eventPromises=new Map),s.pendingEvents.has(t)){let e=await this.getPendingEvent(s,t);this.sendEvent(a.ADD_TRACK_EVENT_LISTENER,r,e)}else if(!s[t]){const n=n=>{if(Object.values(c).includes(t)){let t={trackId:e,eventName:n.type,type:"proxy"};t&&this.processPendingEvents(s,n,t,a.ADD_TRACK_EVENT_LISTENER,r)}else this.logger.warn(`Ignored event: ${JSON.stringify(n)}`)};s[t]=n,s.addEventListener(t,n,i)}return null}case a.ADD_WORKER_EVENT_LISTENER:{let[e,t]=n,i=await this.getWorker(e);if(i.pendingEvents||(i.pendingEvents=new Map),i.eventPromises||(i.eventPromises=new Map),i.pendingEvents.has(t)){let e=await this.getPendingEvent(i,t);this.sendEvent(a.ADD_WORKER_EVENT_LISTENER,r,e)}else if(!i[t]){const n=n=>{if(this.logger.debug("Received event: ",n),Object.values(l).includes(t)){let t={wId:e,eventName:n.type,type:"proxy",data:n.data};t&&this.processPendingEvents(i,n,t,a.ADD_WORKER_EVENT_LISTENER,r)}else this.logger.warn(`Ignored event: ${JSON.stringify(n)}`,n)};i[t]=n,i.addEventListener(t,n)}return null}case a.ADD_DTMF_EVENT_LISTENER:{let[e,t,i]=n,s=this.dtmfSenders.get(e);if(s.pendingEvents||(s.pendingEvents=new Map),s.eventPromises||(s.eventPromises=new Map),s.pendingEvents.has(t)){let e=await this.getPendingEvent(s,t);this.sendEvent(a.ADD_DTMF_EVENT_LISTENER,r,e)}else if(!s[t]){const n=n=>{if(Object.values(d).includes(t)){let t={dtmfId:e,eventName:n.type,type:n.type,tone:n.tone};this.processPendingEvents(s,n,t,a.ADD_DTMF_EVENT_LISTENER,r)}else this.logger.warn(`Ignored event: ${JSON.stringify(n)}`)};s[t]=n,s.addEventListener(t,n,i)}return null}case a.CREATE_MEDIA_ELEMENT_API_NAME:{let[e,t]=n;if("audio"!==t.kind&&"video"!==t.kind)return this.logger.warn(`Invalid media type: ${JSON.stringify(t)}`),null;let r=document.createElement(t.kind);return Object.assign(r,t),document.body.appendChild(r),this.mediaElements.set(e,r),{id:e,sinkId:r.sinkId}}case a.MEDIA_ELEMENT_SET_SINK_ID_API_NAME:{let[e,t]=n,r=this.mediaElements.get(e);return await r.setSinkId(t),{id:e,sinkId:r.sinkId}}case a.SET_MEDIA_SRC_OBJ_API_NAME:{let[e,t]=n,r=t?this.getStream(t.id):null;return this.mediaElements.get(e).srcObject=r,{}}case a.MEDIA_ELEMENT_MUTED:{let[e,t]=n;return this.mediaElements.get(e).muted=t,{id:e,muted:t}}case a.SET_MEDIA_HIDDEN_API_NAME:{let[e,t]=n,r=this.mediaElements.get(e);return r&&(r.hidden=t),{}}case a.SET_MEDIA_VOLUME_API_NAME:{let[e,t]=n;return this.mediaElements.get(e).volume=t,{}}case a.MEDIA_ELEMENT_PLAY_API_NAME:{let[e]=n;return this.mediaElements.get(e).play(),{}}case a.MEDIA_ELEMENT_PAUSE_API_NAME:{let[e]=n;return this.mediaElements.get(e).pause(),{}}case a.MEDIA_ELEMENT_REMOVE:{let[e]=n;return this.mediaElements.get(e).remove(),{}}case a.TOGGLE_TRACK_ENABLED_API_NAME:{let[e,t]=n,r=this.tracks.get(e);return r.enabled=t,this.makeTrackTO(r)}case a.TRACK_STOP_API_NAME:{let[e]=n,t=this.tracks.get(e);return t&&t.stop(),{}}case a.TRACK_GET_SETTINGS:{let[e]=n;return this.tracks.get(e).getSettings()}case a.SENDER_CREATE_ENCODED_STREAMS:{let[e,t]=n,r=this.senders.get(e).createEncodedStreams();return this.streams.set(t.id,r),this.streams.set(t.readable.id,r.readable),this.streams.set(t.writable.id,r.writable),t}case a.RECEIVER_CREATE_ENCODED_STREAMS:{let[e,t]=n,r=this.receivers.get(e).createEncodedStreams();return this.streams.set(t.id,r),this.streams.set(t.readable.id,r.readable),this.streams.set(t.writable.id,r.writable),t}case a.UNLOAD_EVENT_NAME:{let[e]=n;return e.pcIds.forEach((e=>{this.pcs.delete(e)})),e.streamIds.forEach((e=>{let t=this.streams.get(e);t&&("function"==typeof t.getTracks&&t.getTracks().forEach((e=>{e.stop()})),this.streams.delete(e))})),e.trackIds.forEach((e=>{this.tracks.delete(e)})),e.workerIds.forEach((e=>{let t=this.workers.get(e);t&&t.terminate(),this.workers.delete(e)})),e.mediaElementIds.forEach((e=>{let t=this.mediaElements.get(e);t&&(t.remove(),this.mediaElements.delete(e))})),e.transceiverIds.forEach((e=>{this.transceivers.delete(e)})),e.senderIds.forEach((e=>{this.senders.delete(e)})),e.receiverIds.forEach((e=>{this.receivers.delete(e)})),{}}default:return null}}sendMessage(e){this.logger.debug(`Sending message: ${JSON.stringify(e)}`);let t=e.message,r=_.deflateRaw(JSON.stringify(t));e.message=r;let n=(new TextEncoder).encode(JSON.stringify(e)),i=n.byteLength,s=new Uint8Array([i,i>>8,i>>16,i>>24]);this.channel.sendMessage(s),this.channel.sendMessage(n)}sendEvent(e,t,r){let n={requestId:t,type:"event",message:{api:e,event:r}};this.sendMessage(n)}sendResponse(e,t,r){let n={requestId:t,type:"response",message:{api:e,response:r}};this.sendMessage(n)}sendError(e,t,r){let n={requestId:t,type:"error",message:{api:e,error:r}};this.sendMessage(n)}async handleWebRTCApi(e){try{let t=await this.callWebRTCApi(e.message.api,e.requestId,e.message.args);t&&this.sendResponse(e.message.api,e.requestId,t)}catch(t){this.logger.error(`Error handling WebRTC API: ${JSON.stringify(e)}, message: ${t.message?t.message:"(no message)"}, error: ${JSON.stringify(t)}`),this.logger.trace(t),this.sendError(e.message.api,e.requestId,{name:t.name,message:t.message})}}processPendingEvents(e,t,r,n,i){if(e.pendingEvents.has(t.type)){e.pendingEvents.get(t.type).push(r);let n=e.eventPromises.get(t.type);n&&n.forEach((e=>{e.resolve(r)}))}else this.sendEvent(n,i,r),e.pendingEvents.set(t.type,[])}handleMessage(e){let t=e.message,r=_.inflateRaw(t),n=this.decoder.decode(r);e.message=JSON.parse(n),e.message.api&&e.requestId&&e.message.args?this.handleWebRTCApi(e):(this.logger.error(`Invalid message format: ${JSON.stringify(e)}`),this.logger.trace(e))}onClose(e){this.logger.info(`WebRTC redir custom channel closed: ${JSON.stringify(e)}"`),this.release()}release(){this.streams.forEach((e=>{e.getTracks().forEach((e=>{e.stop()}))})),this.mediaElements.forEach((e=>{e.remove()}))}}function v(e,t,r){globalThis.DCVWebRTCRedirProxy=t,m.initCallbacks?(m.initCallbacks.forEach(((n,i)=>{clearTimeout(n),i({success:e,proxy:t,error:r})})),m.initCallbacks.clear()):s().warn("No DCVWebRTCPeerConnectionProxy.initCallback was specified.")}try{window.DCVWebRTCPeerConnectionProxy=m;let e=new m({logger:s()});e.sendHelloRequest().then((t=>{e.logger.info(`Successfully received hello response from client: ${JSON.stringify(t)}`),e.clientInfo=t,v(!0,e)})).catch((e=>{const t=`Running in an invalid dcv webrtc env, skipping setting up proxy: ${JSON.stringify(e)}`;s().warn(t),v(!1,null,t)}))}catch(e){const t=e.message;v(!1,null,t),s().info(`Skipping setting up proxy in client env: ${t}`)}})(),n})()));